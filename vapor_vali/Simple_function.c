/* Generated by Cython 0.24.1 */

/* BEGIN: Cython Metadata
{
    "distutils": {}, 
    "module_name": "vapor_vali.Simple_function"
}
END: Cython Metadata */

#define PY_SSIZE_T_CLEAN
#include "Python.h"
#ifndef Py_PYTHON_H
    #error Python headers needed to compile C extensions, please install development version of Python.
#elif PY_VERSION_HEX < 0x02060000 || (0x03000000 <= PY_VERSION_HEX && PY_VERSION_HEX < 0x03020000)
    #error Cython requires Python 2.6+ or Python 3.2+.
#else
#define CYTHON_ABI "0_24_1"
#include <stddef.h>
#ifndef offsetof
  #define offsetof(type, member) ( (size_t) & ((type*)0) -> member )
#endif
#if !defined(WIN32) && !defined(MS_WINDOWS)
  #ifndef __stdcall
    #define __stdcall
  #endif
  #ifndef __cdecl
    #define __cdecl
  #endif
  #ifndef __fastcall
    #define __fastcall
  #endif
#endif
#ifndef DL_IMPORT
  #define DL_IMPORT(t) t
#endif
#ifndef DL_EXPORT
  #define DL_EXPORT(t) t
#endif
#ifndef PY_LONG_LONG
  #define PY_LONG_LONG LONG_LONG
#endif
#ifndef Py_HUGE_VAL
  #define Py_HUGE_VAL HUGE_VAL
#endif
#ifdef PYPY_VERSION
  #define CYTHON_COMPILING_IN_PYPY 1
  #define CYTHON_COMPILING_IN_CPYTHON 0
#else
  #define CYTHON_COMPILING_IN_PYPY 0
  #define CYTHON_COMPILING_IN_CPYTHON 1
#endif
#if !defined(CYTHON_USE_PYLONG_INTERNALS) && CYTHON_COMPILING_IN_CPYTHON && PY_VERSION_HEX >= 0x02070000
  #define CYTHON_USE_PYLONG_INTERNALS 1
#endif
#if CYTHON_USE_PYLONG_INTERNALS
  #include "longintrepr.h"
  #undef SHIFT
  #undef BASE
  #undef MASK
#endif
#if CYTHON_COMPILING_IN_PYPY && PY_VERSION_HEX < 0x02070600 && !defined(Py_OptimizeFlag)
  #define Py_OptimizeFlag 0
#endif
#define __PYX_BUILD_PY_SSIZE_T "n"
#define CYTHON_FORMAT_SSIZE_T "z"
#if PY_MAJOR_VERSION < 3
  #define __Pyx_BUILTIN_MODULE_NAME "__builtin__"
  #define __Pyx_PyCode_New(a, k, l, s, f, code, c, n, v, fv, cell, fn, name, fline, lnos)\
          PyCode_New(a+k, l, s, f, code, c, n, v, fv, cell, fn, name, fline, lnos)
  #define __Pyx_DefaultClassType PyClass_Type
#else
  #define __Pyx_BUILTIN_MODULE_NAME "builtins"
  #define __Pyx_PyCode_New(a, k, l, s, f, code, c, n, v, fv, cell, fn, name, fline, lnos)\
          PyCode_New(a, k, l, s, f, code, c, n, v, fv, cell, fn, name, fline, lnos)
  #define __Pyx_DefaultClassType PyType_Type
#endif
#ifndef Py_TPFLAGS_CHECKTYPES
  #define Py_TPFLAGS_CHECKTYPES 0
#endif
#ifndef Py_TPFLAGS_HAVE_INDEX
  #define Py_TPFLAGS_HAVE_INDEX 0
#endif
#ifndef Py_TPFLAGS_HAVE_NEWBUFFER
  #define Py_TPFLAGS_HAVE_NEWBUFFER 0
#endif
#ifndef Py_TPFLAGS_HAVE_FINALIZE
  #define Py_TPFLAGS_HAVE_FINALIZE 0
#endif
#if PY_VERSION_HEX > 0x03030000 && defined(PyUnicode_KIND)
  #define CYTHON_PEP393_ENABLED 1
  #define __Pyx_PyUnicode_READY(op)       (likely(PyUnicode_IS_READY(op)) ?\
                                              0 : _PyUnicode_Ready((PyObject *)(op)))
  #define __Pyx_PyUnicode_GET_LENGTH(u)   PyUnicode_GET_LENGTH(u)
  #define __Pyx_PyUnicode_READ_CHAR(u, i) PyUnicode_READ_CHAR(u, i)
  #define __Pyx_PyUnicode_KIND(u)         PyUnicode_KIND(u)
  #define __Pyx_PyUnicode_DATA(u)         PyUnicode_DATA(u)
  #define __Pyx_PyUnicode_READ(k, d, i)   PyUnicode_READ(k, d, i)
  #define __Pyx_PyUnicode_IS_TRUE(u)      (0 != (likely(PyUnicode_IS_READY(u)) ? PyUnicode_GET_LENGTH(u) : PyUnicode_GET_SIZE(u)))
#else
  #define CYTHON_PEP393_ENABLED 0
  #define __Pyx_PyUnicode_READY(op)       (0)
  #define __Pyx_PyUnicode_GET_LENGTH(u)   PyUnicode_GET_SIZE(u)
  #define __Pyx_PyUnicode_READ_CHAR(u, i) ((Py_UCS4)(PyUnicode_AS_UNICODE(u)[i]))
  #define __Pyx_PyUnicode_KIND(u)         (sizeof(Py_UNICODE))
  #define __Pyx_PyUnicode_DATA(u)         ((void*)PyUnicode_AS_UNICODE(u))
  #define __Pyx_PyUnicode_READ(k, d, i)   ((void)(k), (Py_UCS4)(((Py_UNICODE*)d)[i]))
  #define __Pyx_PyUnicode_IS_TRUE(u)      (0 != PyUnicode_GET_SIZE(u))
#endif
#if CYTHON_COMPILING_IN_PYPY
  #define __Pyx_PyUnicode_Concat(a, b)      PyNumber_Add(a, b)
  #define __Pyx_PyUnicode_ConcatSafe(a, b)  PyNumber_Add(a, b)
#else
  #define __Pyx_PyUnicode_Concat(a, b)      PyUnicode_Concat(a, b)
  #define __Pyx_PyUnicode_ConcatSafe(a, b)  ((unlikely((a) == Py_None) || unlikely((b) == Py_None)) ?\
      PyNumber_Add(a, b) : __Pyx_PyUnicode_Concat(a, b))
#endif
#if CYTHON_COMPILING_IN_PYPY && !defined(PyUnicode_Contains)
  #define PyUnicode_Contains(u, s)  PySequence_Contains(u, s)
#endif
#if CYTHON_COMPILING_IN_PYPY && !defined(PyByteArray_Check)
  #define PyByteArray_Check(obj)  PyObject_TypeCheck(obj, &PyByteArray_Type)
#endif
#if CYTHON_COMPILING_IN_PYPY && !defined(PyObject_Format)
  #define PyObject_Format(obj, fmt)  PyObject_CallMethod(obj, "__format__", "O", fmt)
#endif
#if CYTHON_COMPILING_IN_PYPY && !defined(PyObject_Malloc)
  #define PyObject_Malloc(s)   PyMem_Malloc(s)
  #define PyObject_Free(p)     PyMem_Free(p)
  #define PyObject_Realloc(p)  PyMem_Realloc(p)
#endif
#define __Pyx_PyString_FormatSafe(a, b)   ((unlikely((a) == Py_None)) ? PyNumber_Remainder(a, b) : __Pyx_PyString_Format(a, b))
#define __Pyx_PyUnicode_FormatSafe(a, b)  ((unlikely((a) == Py_None)) ? PyNumber_Remainder(a, b) : PyUnicode_Format(a, b))
#if PY_MAJOR_VERSION >= 3
  #define __Pyx_PyString_Format(a, b)  PyUnicode_Format(a, b)
#else
  #define __Pyx_PyString_Format(a, b)  PyString_Format(a, b)
#endif
#if PY_MAJOR_VERSION < 3 && !defined(PyObject_ASCII)
  #define PyObject_ASCII(o)            PyObject_Repr(o)
#endif
#if PY_MAJOR_VERSION >= 3
  #define PyBaseString_Type            PyUnicode_Type
  #define PyStringObject               PyUnicodeObject
  #define PyString_Type                PyUnicode_Type
  #define PyString_Check               PyUnicode_Check
  #define PyString_CheckExact          PyUnicode_CheckExact
#endif
#if PY_MAJOR_VERSION >= 3
  #define __Pyx_PyBaseString_Check(obj) PyUnicode_Check(obj)
  #define __Pyx_PyBaseString_CheckExact(obj) PyUnicode_CheckExact(obj)
#else
  #define __Pyx_PyBaseString_Check(obj) (PyString_Check(obj) || PyUnicode_Check(obj))
  #define __Pyx_PyBaseString_CheckExact(obj) (PyString_CheckExact(obj) || PyUnicode_CheckExact(obj))
#endif
#ifndef PySet_CheckExact
  #define PySet_CheckExact(obj)        (Py_TYPE(obj) == &PySet_Type)
#endif
#define __Pyx_TypeCheck(obj, type) PyObject_TypeCheck(obj, (PyTypeObject *)type)
#if PY_MAJOR_VERSION >= 3
  #define PyIntObject                  PyLongObject
  #define PyInt_Type                   PyLong_Type
  #define PyInt_Check(op)              PyLong_Check(op)
  #define PyInt_CheckExact(op)         PyLong_CheckExact(op)
  #define PyInt_FromString             PyLong_FromString
  #define PyInt_FromUnicode            PyLong_FromUnicode
  #define PyInt_FromLong               PyLong_FromLong
  #define PyInt_FromSize_t             PyLong_FromSize_t
  #define PyInt_FromSsize_t            PyLong_FromSsize_t
  #define PyInt_AsLong                 PyLong_AsLong
  #define PyInt_AS_LONG                PyLong_AS_LONG
  #define PyInt_AsSsize_t              PyLong_AsSsize_t
  #define PyInt_AsUnsignedLongMask     PyLong_AsUnsignedLongMask
  #define PyInt_AsUnsignedLongLongMask PyLong_AsUnsignedLongLongMask
  #define PyNumber_Int                 PyNumber_Long
#endif
#if PY_MAJOR_VERSION >= 3
  #define PyBoolObject                 PyLongObject
#endif
#if PY_MAJOR_VERSION >= 3 && CYTHON_COMPILING_IN_PYPY
  #ifndef PyUnicode_InternFromString
    #define PyUnicode_InternFromString(s) PyUnicode_FromString(s)
  #endif
#endif
#if PY_VERSION_HEX < 0x030200A4
  typedef long Py_hash_t;
  #define __Pyx_PyInt_FromHash_t PyInt_FromLong
  #define __Pyx_PyInt_AsHash_t   PyInt_AsLong
#else
  #define __Pyx_PyInt_FromHash_t PyInt_FromSsize_t
  #define __Pyx_PyInt_AsHash_t   PyInt_AsSsize_t
#endif
#if PY_MAJOR_VERSION >= 3
  #define __Pyx_PyMethod_New(func, self, klass) ((self) ? PyMethod_New(func, self) : PyInstanceMethod_New(func))
#else
  #define __Pyx_PyMethod_New(func, self, klass) PyMethod_New(func, self, klass)
#endif
#if PY_VERSION_HEX >= 0x030500B1
#define __Pyx_PyAsyncMethodsStruct PyAsyncMethods
#define __Pyx_PyType_AsAsync(obj) (Py_TYPE(obj)->tp_as_async)
#elif CYTHON_COMPILING_IN_CPYTHON && PY_MAJOR_VERSION >= 3
typedef struct {
    unaryfunc am_await;
    unaryfunc am_aiter;
    unaryfunc am_anext;
} __Pyx_PyAsyncMethodsStruct;
#define __Pyx_PyType_AsAsync(obj) ((__Pyx_PyAsyncMethodsStruct*) (Py_TYPE(obj)->tp_reserved))
#else
#define __Pyx_PyType_AsAsync(obj) NULL
#endif
#ifndef CYTHON_RESTRICT
  #if defined(__GNUC__)
    #define CYTHON_RESTRICT __restrict__
  #elif defined(_MSC_VER) && _MSC_VER >= 1400
    #define CYTHON_RESTRICT __restrict
  #elif defined (__STDC_VERSION__) && __STDC_VERSION__ >= 199901L
    #define CYTHON_RESTRICT restrict
  #else
    #define CYTHON_RESTRICT
  #endif
#endif
#define __Pyx_void_to_None(void_result) ((void)(void_result), Py_INCREF(Py_None), Py_None)

#ifndef CYTHON_INLINE
  #if defined(__GNUC__)
    #define CYTHON_INLINE __inline__
  #elif defined(_MSC_VER)
    #define CYTHON_INLINE __inline
  #elif defined (__STDC_VERSION__) && __STDC_VERSION__ >= 199901L
    #define CYTHON_INLINE inline
  #else
    #define CYTHON_INLINE
  #endif
#endif

#if defined(WIN32) || defined(MS_WINDOWS)
  #define _USE_MATH_DEFINES
#endif
#include <math.h>
#ifdef NAN
#define __PYX_NAN() ((float) NAN)
#else
static CYTHON_INLINE float __PYX_NAN() {
  float value;
  memset(&value, 0xFF, sizeof(value));
  return value;
}
#endif
#if defined(__CYGWIN__) && defined(_LDBL_EQ_DBL)
#define __Pyx_truncl trunc
#else
#define __Pyx_truncl truncl
#endif


#define __PYX_ERR(f_index, lineno, Ln_error) \
{ \
  __pyx_filename = __pyx_f[f_index]; __pyx_lineno = lineno; __pyx_clineno = __LINE__; goto Ln_error; \
}

#if PY_MAJOR_VERSION >= 3
  #define __Pyx_PyNumber_Divide(x,y)         PyNumber_TrueDivide(x,y)
  #define __Pyx_PyNumber_InPlaceDivide(x,y)  PyNumber_InPlaceTrueDivide(x,y)
#else
  #define __Pyx_PyNumber_Divide(x,y)         PyNumber_Divide(x,y)
  #define __Pyx_PyNumber_InPlaceDivide(x,y)  PyNumber_InPlaceDivide(x,y)
#endif

#ifndef __PYX_EXTERN_C
  #ifdef __cplusplus
    #define __PYX_EXTERN_C extern "C"
  #else
    #define __PYX_EXTERN_C extern
  #endif
#endif

#define __PYX_HAVE__vapor_vali__Simple_function
#define __PYX_HAVE_API__vapor_vali__Simple_function
#ifdef _OPENMP
#include <omp.h>
#endif /* _OPENMP */

#ifdef PYREX_WITHOUT_ASSERTIONS
#define CYTHON_WITHOUT_ASSERTIONS
#endif

#ifndef CYTHON_UNUSED
# if defined(__GNUC__)
#   if !(defined(__cplusplus)) || (__GNUC__ > 3 || (__GNUC__ == 3 && __GNUC_MINOR__ >= 4))
#     define CYTHON_UNUSED __attribute__ ((__unused__))
#   else
#     define CYTHON_UNUSED
#   endif
# elif defined(__ICC) || (defined(__INTEL_COMPILER) && !defined(_MSC_VER))
#   define CYTHON_UNUSED __attribute__ ((__unused__))
# else
#   define CYTHON_UNUSED
# endif
#endif
#ifndef CYTHON_NCP_UNUSED
# if CYTHON_COMPILING_IN_CPYTHON
#  define CYTHON_NCP_UNUSED
# else
#  define CYTHON_NCP_UNUSED CYTHON_UNUSED
# endif
#endif
typedef struct {PyObject **p; const char *s; const Py_ssize_t n; const char* encoding;
                const char is_unicode; const char is_str; const char intern; } __Pyx_StringTabEntry;

#define __PYX_DEFAULT_STRING_ENCODING_IS_ASCII 0
#define __PYX_DEFAULT_STRING_ENCODING_IS_DEFAULT 0
#define __PYX_DEFAULT_STRING_ENCODING ""
#define __Pyx_PyObject_FromString __Pyx_PyBytes_FromString
#define __Pyx_PyObject_FromStringAndSize __Pyx_PyBytes_FromStringAndSize
#define __Pyx_uchar_cast(c) ((unsigned char)c)
#define __Pyx_long_cast(x) ((long)x)
#define __Pyx_fits_Py_ssize_t(v, type, is_signed)  (\
    (sizeof(type) < sizeof(Py_ssize_t))  ||\
    (sizeof(type) > sizeof(Py_ssize_t) &&\
          likely(v < (type)PY_SSIZE_T_MAX ||\
                 v == (type)PY_SSIZE_T_MAX)  &&\
          (!is_signed || likely(v > (type)PY_SSIZE_T_MIN ||\
                                v == (type)PY_SSIZE_T_MIN)))  ||\
    (sizeof(type) == sizeof(Py_ssize_t) &&\
          (is_signed || likely(v < (type)PY_SSIZE_T_MAX ||\
                               v == (type)PY_SSIZE_T_MAX)))  )
#if defined (__cplusplus) && __cplusplus >= 201103L
    #include <cstdlib>
    #define __Pyx_sst_abs(value) std::abs(value)
#elif SIZEOF_INT >= SIZEOF_SIZE_T
    #define __Pyx_sst_abs(value) abs(value)
#elif SIZEOF_LONG >= SIZEOF_SIZE_T
    #define __Pyx_sst_abs(value) labs(value)
#elif defined (_MSC_VER) && defined (_M_X64)
    #define __Pyx_sst_abs(value) _abs64(value)
#elif defined (__STDC_VERSION__) && __STDC_VERSION__ >= 199901L
    #define __Pyx_sst_abs(value) llabs(value)
#elif defined (__GNUC__)
    #define __Pyx_sst_abs(value) __builtin_llabs(value)
#else
    #define __Pyx_sst_abs(value) ((value<0) ? -value : value)
#endif
static CYTHON_INLINE char* __Pyx_PyObject_AsString(PyObject*);
static CYTHON_INLINE char* __Pyx_PyObject_AsStringAndSize(PyObject*, Py_ssize_t* length);
#define __Pyx_PyByteArray_FromString(s) PyByteArray_FromStringAndSize((const char*)s, strlen((const char*)s))
#define __Pyx_PyByteArray_FromStringAndSize(s, l) PyByteArray_FromStringAndSize((const char*)s, l)
#define __Pyx_PyBytes_FromString        PyBytes_FromString
#define __Pyx_PyBytes_FromStringAndSize PyBytes_FromStringAndSize
static CYTHON_INLINE PyObject* __Pyx_PyUnicode_FromString(const char*);
#if PY_MAJOR_VERSION < 3
    #define __Pyx_PyStr_FromString        __Pyx_PyBytes_FromString
    #define __Pyx_PyStr_FromStringAndSize __Pyx_PyBytes_FromStringAndSize
#else
    #define __Pyx_PyStr_FromString        __Pyx_PyUnicode_FromString
    #define __Pyx_PyStr_FromStringAndSize __Pyx_PyUnicode_FromStringAndSize
#endif
#define __Pyx_PyObject_AsSString(s)    ((signed char*) __Pyx_PyObject_AsString(s))
#define __Pyx_PyObject_AsUString(s)    ((unsigned char*) __Pyx_PyObject_AsString(s))
#define __Pyx_PyObject_FromCString(s)  __Pyx_PyObject_FromString((const char*)s)
#define __Pyx_PyBytes_FromCString(s)   __Pyx_PyBytes_FromString((const char*)s)
#define __Pyx_PyByteArray_FromCString(s)   __Pyx_PyByteArray_FromString((const char*)s)
#define __Pyx_PyStr_FromCString(s)     __Pyx_PyStr_FromString((const char*)s)
#define __Pyx_PyUnicode_FromCString(s) __Pyx_PyUnicode_FromString((const char*)s)
#if PY_MAJOR_VERSION < 3
static CYTHON_INLINE size_t __Pyx_Py_UNICODE_strlen(const Py_UNICODE *u)
{
    const Py_UNICODE *u_end = u;
    while (*u_end++) ;
    return (size_t)(u_end - u - 1);
}
#else
#define __Pyx_Py_UNICODE_strlen Py_UNICODE_strlen
#endif
#define __Pyx_PyUnicode_FromUnicode(u)       PyUnicode_FromUnicode(u, __Pyx_Py_UNICODE_strlen(u))
#define __Pyx_PyUnicode_FromUnicodeAndLength PyUnicode_FromUnicode
#define __Pyx_PyUnicode_AsUnicode            PyUnicode_AsUnicode
#define __Pyx_NewRef(obj) (Py_INCREF(obj), obj)
#define __Pyx_Owned_Py_None(b) __Pyx_NewRef(Py_None)
#define __Pyx_PyBool_FromLong(b) ((b) ? __Pyx_NewRef(Py_True) : __Pyx_NewRef(Py_False))
static CYTHON_INLINE int __Pyx_PyObject_IsTrue(PyObject*);
static CYTHON_INLINE PyObject* __Pyx_PyNumber_IntOrLong(PyObject* x);
static CYTHON_INLINE Py_ssize_t __Pyx_PyIndex_AsSsize_t(PyObject*);
static CYTHON_INLINE PyObject * __Pyx_PyInt_FromSize_t(size_t);
#if CYTHON_COMPILING_IN_CPYTHON
#define __pyx_PyFloat_AsDouble(x) (PyFloat_CheckExact(x) ? PyFloat_AS_DOUBLE(x) : PyFloat_AsDouble(x))
#else
#define __pyx_PyFloat_AsDouble(x) PyFloat_AsDouble(x)
#endif
#define __pyx_PyFloat_AsFloat(x) ((float) __pyx_PyFloat_AsDouble(x))
#if PY_MAJOR_VERSION >= 3
#define __Pyx_PyNumber_Int(x) (PyLong_CheckExact(x) ? __Pyx_NewRef(x) : PyNumber_Long(x))
#else
#define __Pyx_PyNumber_Int(x) (PyInt_CheckExact(x) ? __Pyx_NewRef(x) : PyNumber_Int(x))
#endif
#define __Pyx_PyNumber_Float(x) (PyFloat_CheckExact(x) ? __Pyx_NewRef(x) : PyNumber_Float(x))
#if PY_MAJOR_VERSION < 3 && __PYX_DEFAULT_STRING_ENCODING_IS_ASCII
static int __Pyx_sys_getdefaultencoding_not_ascii;
static int __Pyx_init_sys_getdefaultencoding_params(void) {
    PyObject* sys;
    PyObject* default_encoding = NULL;
    PyObject* ascii_chars_u = NULL;
    PyObject* ascii_chars_b = NULL;
    const char* default_encoding_c;
    sys = PyImport_ImportModule("sys");
    if (!sys) goto bad;
    default_encoding = PyObject_CallMethod(sys, (char*) "getdefaultencoding", NULL);
    Py_DECREF(sys);
    if (!default_encoding) goto bad;
    default_encoding_c = PyBytes_AsString(default_encoding);
    if (!default_encoding_c) goto bad;
    if (strcmp(default_encoding_c, "ascii") == 0) {
        __Pyx_sys_getdefaultencoding_not_ascii = 0;
    } else {
        char ascii_chars[128];
        int c;
        for (c = 0; c < 128; c++) {
            ascii_chars[c] = c;
        }
        __Pyx_sys_getdefaultencoding_not_ascii = 1;
        ascii_chars_u = PyUnicode_DecodeASCII(ascii_chars, 128, NULL);
        if (!ascii_chars_u) goto bad;
        ascii_chars_b = PyUnicode_AsEncodedString(ascii_chars_u, default_encoding_c, NULL);
        if (!ascii_chars_b || !PyBytes_Check(ascii_chars_b) || memcmp(ascii_chars, PyBytes_AS_STRING(ascii_chars_b), 128) != 0) {
            PyErr_Format(
                PyExc_ValueError,
                "This module compiled with c_string_encoding=ascii, but default encoding '%.200s' is not a superset of ascii.",
                default_encoding_c);
            goto bad;
        }
        Py_DECREF(ascii_chars_u);
        Py_DECREF(ascii_chars_b);
    }
    Py_DECREF(default_encoding);
    return 0;
bad:
    Py_XDECREF(default_encoding);
    Py_XDECREF(ascii_chars_u);
    Py_XDECREF(ascii_chars_b);
    return -1;
}
#endif
#if __PYX_DEFAULT_STRING_ENCODING_IS_DEFAULT && PY_MAJOR_VERSION >= 3
#define __Pyx_PyUnicode_FromStringAndSize(c_str, size) PyUnicode_DecodeUTF8(c_str, size, NULL)
#else
#define __Pyx_PyUnicode_FromStringAndSize(c_str, size) PyUnicode_Decode(c_str, size, __PYX_DEFAULT_STRING_ENCODING, NULL)
#if __PYX_DEFAULT_STRING_ENCODING_IS_DEFAULT
static char* __PYX_DEFAULT_STRING_ENCODING;
static int __Pyx_init_sys_getdefaultencoding_params(void) {
    PyObject* sys;
    PyObject* default_encoding = NULL;
    char* default_encoding_c;
    sys = PyImport_ImportModule("sys");
    if (!sys) goto bad;
    default_encoding = PyObject_CallMethod(sys, (char*) (const char*) "getdefaultencoding", NULL);
    Py_DECREF(sys);
    if (!default_encoding) goto bad;
    default_encoding_c = PyBytes_AsString(default_encoding);
    if (!default_encoding_c) goto bad;
    __PYX_DEFAULT_STRING_ENCODING = (char*) malloc(strlen(default_encoding_c));
    if (!__PYX_DEFAULT_STRING_ENCODING) goto bad;
    strcpy(__PYX_DEFAULT_STRING_ENCODING, default_encoding_c);
    Py_DECREF(default_encoding);
    return 0;
bad:
    Py_XDECREF(default_encoding);
    return -1;
}
#endif
#endif


/* Test for GCC > 2.95 */
#if defined(__GNUC__)     && (__GNUC__ > 2 || (__GNUC__ == 2 && (__GNUC_MINOR__ > 95)))
  #define likely(x)   __builtin_expect(!!(x), 1)
  #define unlikely(x) __builtin_expect(!!(x), 0)
#else /* !__GNUC__ or GCC < 2.95 */
  #define likely(x)   (x)
  #define unlikely(x) (x)
#endif /* __GNUC__ */

static PyObject *__pyx_m;
static PyObject *__pyx_d;
static PyObject *__pyx_b;
static PyObject *__pyx_empty_tuple;
static PyObject *__pyx_empty_bytes;
static PyObject *__pyx_empty_unicode;
static int __pyx_lineno;
static int __pyx_clineno = 0;
static const char * __pyx_cfilenm= __FILE__;
static const char *__pyx_filename;


static const char *__pyx_f[] = {
  "vapor_vali/Simple_function.pyx",
};

/*--- Type declarations ---*/
struct __pyx_obj_10vapor_vali_15Simple_function___pyx_scope_struct__eu_y_vs_x_ratio_calcu;

/* "vapor_vali/Simple_function.pyx":758
 *     else:               return abs(float(dot_pos[1])/float(dot_pos[0]))
 * 
 * def eu_y_vs_x_ratio_calcu(ref_clean_dotdata):             # <<<<<<<<<<<<<<
 *     y_x_ratio_list=[round(eu_y_vs_x_ratio_single_dot(i),2) for i in ref_clean_dotdata if eu_dis_single_dot(i)<0.15]
 *     if y_x_ratio_list==[]:  return 1
 */
struct __pyx_obj_10vapor_vali_15Simple_function___pyx_scope_struct__eu_y_vs_x_ratio_calcu {
  PyObject_HEAD
  PyObject *__pyx_v_nparam_density;
};


/* --- Runtime support code (head) --- */
/* Refnanny.proto */
#ifndef CYTHON_REFNANNY
  #define CYTHON_REFNANNY 0
#endif
#if CYTHON_REFNANNY
  typedef struct {
    void (*INCREF)(void*, PyObject*, int);
    void (*DECREF)(void*, PyObject*, int);
    void (*GOTREF)(void*, PyObject*, int);
    void (*GIVEREF)(void*, PyObject*, int);
    void* (*SetupContext)(const char*, int, const char*);
    void (*FinishContext)(void**);
  } __Pyx_RefNannyAPIStruct;
  static __Pyx_RefNannyAPIStruct *__Pyx_RefNanny = NULL;
  static __Pyx_RefNannyAPIStruct *__Pyx_RefNannyImportAPI(const char *modname);
  #define __Pyx_RefNannyDeclarations void *__pyx_refnanny = NULL;
#ifdef WITH_THREAD
  #define __Pyx_RefNannySetupContext(name, acquire_gil)\
          if (acquire_gil) {\
              PyGILState_STATE __pyx_gilstate_save = PyGILState_Ensure();\
              __pyx_refnanny = __Pyx_RefNanny->SetupContext((name), __LINE__, __FILE__);\
              PyGILState_Release(__pyx_gilstate_save);\
          } else {\
              __pyx_refnanny = __Pyx_RefNanny->SetupContext((name), __LINE__, __FILE__);\
          }
#else
  #define __Pyx_RefNannySetupContext(name, acquire_gil)\
          __pyx_refnanny = __Pyx_RefNanny->SetupContext((name), __LINE__, __FILE__)
#endif
  #define __Pyx_RefNannyFinishContext()\
          __Pyx_RefNanny->FinishContext(&__pyx_refnanny)
  #define __Pyx_INCREF(r)  __Pyx_RefNanny->INCREF(__pyx_refnanny, (PyObject *)(r), __LINE__)
  #define __Pyx_DECREF(r)  __Pyx_RefNanny->DECREF(__pyx_refnanny, (PyObject *)(r), __LINE__)
  #define __Pyx_GOTREF(r)  __Pyx_RefNanny->GOTREF(__pyx_refnanny, (PyObject *)(r), __LINE__)
  #define __Pyx_GIVEREF(r) __Pyx_RefNanny->GIVEREF(__pyx_refnanny, (PyObject *)(r), __LINE__)
  #define __Pyx_XINCREF(r)  do { if((r) != NULL) {__Pyx_INCREF(r); }} while(0)
  #define __Pyx_XDECREF(r)  do { if((r) != NULL) {__Pyx_DECREF(r); }} while(0)
  #define __Pyx_XGOTREF(r)  do { if((r) != NULL) {__Pyx_GOTREF(r); }} while(0)
  #define __Pyx_XGIVEREF(r) do { if((r) != NULL) {__Pyx_GIVEREF(r);}} while(0)
#else
  #define __Pyx_RefNannyDeclarations
  #define __Pyx_RefNannySetupContext(name, acquire_gil)
  #define __Pyx_RefNannyFinishContext()
  #define __Pyx_INCREF(r) Py_INCREF(r)
  #define __Pyx_DECREF(r) Py_DECREF(r)
  #define __Pyx_GOTREF(r)
  #define __Pyx_GIVEREF(r)
  #define __Pyx_XINCREF(r) Py_XINCREF(r)
  #define __Pyx_XDECREF(r) Py_XDECREF(r)
  #define __Pyx_XGOTREF(r)
  #define __Pyx_XGIVEREF(r)
#endif
#define __Pyx_XDECREF_SET(r, v) do {\
        PyObject *tmp = (PyObject *) r;\
        r = v; __Pyx_XDECREF(tmp);\
    } while (0)
#define __Pyx_DECREF_SET(r, v) do {\
        PyObject *tmp = (PyObject *) r;\
        r = v; __Pyx_DECREF(tmp);\
    } while (0)
#define __Pyx_CLEAR(r)    do { PyObject* tmp = ((PyObject*)(r)); r = NULL; __Pyx_DECREF(tmp);} while(0)
#define __Pyx_XCLEAR(r)   do { if((r) != NULL) {PyObject* tmp = ((PyObject*)(r)); r = NULL; __Pyx_DECREF(tmp);}} while(0)

/* PyObjectGetAttrStr.proto */
#if CYTHON_COMPILING_IN_CPYTHON
static CYTHON_INLINE PyObject* __Pyx_PyObject_GetAttrStr(PyObject* obj, PyObject* attr_name) {
    PyTypeObject* tp = Py_TYPE(obj);
    if (likely(tp->tp_getattro))
        return tp->tp_getattro(obj, attr_name);
#if PY_MAJOR_VERSION < 3
    if (likely(tp->tp_getattr))
        return tp->tp_getattr(obj, PyString_AS_STRING(attr_name));
#endif
    return PyObject_GetAttr(obj, attr_name);
}
#else
#define __Pyx_PyObject_GetAttrStr(o,n) PyObject_GetAttr(o,n)
#endif

/* GetBuiltinName.proto */
static PyObject *__Pyx_GetBuiltinName(PyObject *name);

/* RaiseArgTupleInvalid.proto */
static void __Pyx_RaiseArgtupleInvalid(const char* func_name, int exact,
    Py_ssize_t num_min, Py_ssize_t num_max, Py_ssize_t num_found);

/* RaiseDoubleKeywords.proto */
static void __Pyx_RaiseDoubleKeywordsError(const char* func_name, PyObject* kw_name);

/* ParseKeywords.proto */
static int __Pyx_ParseOptionalKeywords(PyObject *kwds, PyObject **argnames[],\
    PyObject *kwds2, PyObject *values[], Py_ssize_t num_pos_args,\
    const char* function_name);

/* PyObjectCall.proto */
#if CYTHON_COMPILING_IN_CPYTHON
static CYTHON_INLINE PyObject* __Pyx_PyObject_Call(PyObject *func, PyObject *arg, PyObject *kw);
#else
#define __Pyx_PyObject_Call(func, arg, kw) PyObject_Call(func, arg, kw)
#endif

/* GetItemInt.proto */
#define __Pyx_GetItemInt(o, i, type, is_signed, to_py_func, is_list, wraparound, boundscheck)\
    (__Pyx_fits_Py_ssize_t(i, type, is_signed) ?\
    __Pyx_GetItemInt_Fast(o, (Py_ssize_t)i, is_list, wraparound, boundscheck) :\
    (is_list ? (PyErr_SetString(PyExc_IndexError, "list index out of range"), (PyObject*)NULL) :\
               __Pyx_GetItemInt_Generic(o, to_py_func(i))))
#define __Pyx_GetItemInt_List(o, i, type, is_signed, to_py_func, is_list, wraparound, boundscheck)\
    (__Pyx_fits_Py_ssize_t(i, type, is_signed) ?\
    __Pyx_GetItemInt_List_Fast(o, (Py_ssize_t)i, wraparound, boundscheck) :\
    (PyErr_SetString(PyExc_IndexError, "list index out of range"), (PyObject*)NULL))
static CYTHON_INLINE PyObject *__Pyx_GetItemInt_List_Fast(PyObject *o, Py_ssize_t i,
                                                              int wraparound, int boundscheck);
#define __Pyx_GetItemInt_Tuple(o, i, type, is_signed, to_py_func, is_list, wraparound, boundscheck)\
    (__Pyx_fits_Py_ssize_t(i, type, is_signed) ?\
    __Pyx_GetItemInt_Tuple_Fast(o, (Py_ssize_t)i, wraparound, boundscheck) :\
    (PyErr_SetString(PyExc_IndexError, "tuple index out of range"), (PyObject*)NULL))
static CYTHON_INLINE PyObject *__Pyx_GetItemInt_Tuple_Fast(PyObject *o, Py_ssize_t i,
                                                              int wraparound, int boundscheck);
static CYTHON_INLINE PyObject *__Pyx_GetItemInt_Generic(PyObject *o, PyObject* j);
static CYTHON_INLINE PyObject *__Pyx_GetItemInt_Fast(PyObject *o, Py_ssize_t i,
                                                     int is_list, int wraparound, int boundscheck);

/* PyIntBinop.proto */
#if CYTHON_COMPILING_IN_CPYTHON
static PyObject* __Pyx_PyInt_AddObjC(PyObject *op1, PyObject *op2, long intval, int inplace);
#else
#define __Pyx_PyInt_AddObjC(op1, op2, intval, inplace)\
    (inplace ? PyNumber_InPlaceAdd(op1, op2) : PyNumber_Add(op1, op2))
#endif

/* PyIntBinop.proto */
#if CYTHON_COMPILING_IN_CPYTHON
static PyObject* __Pyx_PyInt_AddCObj(PyObject *op1, PyObject *op2, long intval, int inplace);
#else
#define __Pyx_PyInt_AddCObj(op1, op2, intval, inplace)\
    (inplace ? PyNumber_InPlaceAdd(op1, op2) : PyNumber_Add(op1, op2))
#endif

/* DictGetItem.proto */
#if PY_MAJOR_VERSION >= 3 && !CYTHON_COMPILING_IN_PYPY
static PyObject *__Pyx_PyDict_GetItem(PyObject *d, PyObject* key) {
    PyObject *value;
    value = PyDict_GetItemWithError(d, key);
    if (unlikely(!value)) {
        if (!PyErr_Occurred()) {
            PyObject* args = PyTuple_Pack(1, key);
            if (likely(args))
                PyErr_SetObject(PyExc_KeyError, args);
            Py_XDECREF(args);
        }
        return NULL;
    }
    Py_INCREF(value);
    return value;
}
#else
    #define __Pyx_PyDict_GetItem(d, key) PyObject_GetItem(d, key)
#endif

/* GetModuleGlobalName.proto */
static CYTHON_INLINE PyObject *__Pyx_GetModuleGlobalName(PyObject *name);

/* IncludeStringH.proto */
#include <string.h>

/* BytesEquals.proto */
static CYTHON_INLINE int __Pyx_PyBytes_Equals(PyObject* s1, PyObject* s2, int equals);

/* UnicodeEquals.proto */
static CYTHON_INLINE int __Pyx_PyUnicode_Equals(PyObject* s1, PyObject* s2, int equals);

/* StrEquals.proto */
#if PY_MAJOR_VERSION >= 3
#define __Pyx_PyString_Equals __Pyx_PyUnicode_Equals
#else
#define __Pyx_PyString_Equals __Pyx_PyBytes_Equals
#endif

/* ListAppend.proto */
#if CYTHON_COMPILING_IN_CPYTHON
static CYTHON_INLINE int __Pyx_PyList_Append(PyObject* list, PyObject* x) {
    PyListObject* L = (PyListObject*) list;
    Py_ssize_t len = Py_SIZE(list);
    if (likely(L->allocated > len) & likely(len > (L->allocated >> 1))) {
        Py_INCREF(x);
        PyList_SET_ITEM(list, len, x);
        Py_SIZE(list) = len+1;
        return 0;
    }
    return PyList_Append(list, x);
}
#else
#define __Pyx_PyList_Append(L,x) PyList_Append(L,x)
#endif

/* SetItemInt.proto */
#define __Pyx_SetItemInt(o, i, v, type, is_signed, to_py_func, is_list, wraparound, boundscheck)\
    (__Pyx_fits_Py_ssize_t(i, type, is_signed) ?\
    __Pyx_SetItemInt_Fast(o, (Py_ssize_t)i, v, is_list, wraparound, boundscheck) :\
    (is_list ? (PyErr_SetString(PyExc_IndexError, "list assignment index out of range"), -1) :\
               __Pyx_SetItemInt_Generic(o, to_py_func(i), v)))
static CYTHON_INLINE int __Pyx_SetItemInt_Generic(PyObject *o, PyObject *j, PyObject *v);
static CYTHON_INLINE int __Pyx_SetItemInt_Fast(PyObject *o, Py_ssize_t i, PyObject *v,
                                               int is_list, int wraparound, int boundscheck);

/* PySequenceContains.proto */
static CYTHON_INLINE int __Pyx_PySequence_ContainsTF(PyObject* item, PyObject* seq, int eq) {
    int result = PySequence_Contains(seq, item);
    return unlikely(result < 0) ? result : (result == (eq == Py_EQ));
}

/* PyObjectCallMethO.proto */
#if CYTHON_COMPILING_IN_CPYTHON
static CYTHON_INLINE PyObject* __Pyx_PyObject_CallMethO(PyObject *func, PyObject *arg);
#endif

/* PyObjectCallOneArg.proto */
static CYTHON_INLINE PyObject* __Pyx_PyObject_CallOneArg(PyObject *func, PyObject *arg);

/* StringJoin.proto */
#if PY_MAJOR_VERSION < 3
#define __Pyx_PyString_Join __Pyx_PyBytes_Join
#define __Pyx_PyBaseString_Join(s, v) (PyUnicode_CheckExact(s) ? PyUnicode_Join(s, v) : __Pyx_PyBytes_Join(s, v))
#else
#define __Pyx_PyString_Join PyUnicode_Join
#define __Pyx_PyBaseString_Join PyUnicode_Join
#endif
#if CYTHON_COMPILING_IN_CPYTHON
    #if PY_MAJOR_VERSION < 3
    #define __Pyx_PyBytes_Join _PyString_Join
    #else
    #define __Pyx_PyBytes_Join _PyBytes_Join
    #endif
#else
static CYTHON_INLINE PyObject* __Pyx_PyBytes_Join(PyObject* sep, PyObject* values);
#endif

/* SliceObject.proto */
static CYTHON_INLINE PyObject* __Pyx_PyObject_GetSlice(
        PyObject* obj, Py_ssize_t cstart, Py_ssize_t cstop,
        PyObject** py_start, PyObject** py_stop, PyObject** py_slice,
        int has_cstart, int has_cstop, int wraparound);

/* None.proto */
static CYTHON_INLINE void __Pyx_RaiseUnboundLocalError(const char *varname);

/* PyIntBinop.proto */
#if CYTHON_COMPILING_IN_CPYTHON
static PyObject* __Pyx_PyInt_EqObjC(PyObject *op1, PyObject *op2, long intval, int inplace);
#else
#define __Pyx_PyInt_EqObjC(op1, op2, intval, inplace)\
    PyObject_RichCompare(op1, op2, Py_EQ)
    #endif

/* ListCompAppend.proto */
#if CYTHON_COMPILING_IN_CPYTHON
static CYTHON_INLINE int __Pyx_ListComp_Append(PyObject* list, PyObject* x) {
    PyListObject* L = (PyListObject*) list;
    Py_ssize_t len = Py_SIZE(list);
    if (likely(L->allocated > len)) {
        Py_INCREF(x);
        PyList_SET_ITEM(list, len, x);
        Py_SIZE(list) = len+1;
        return 0;
    }
    return PyList_Append(list, x);
}
#else
#define __Pyx_ListComp_Append(L,x) PyList_Append(L,x)
#endif

/* PyObjectCallMethod1.proto */
static PyObject* __Pyx_PyObject_CallMethod1(PyObject* obj, PyObject* method_name, PyObject* arg);

/* append.proto */
static CYTHON_INLINE int __Pyx_PyObject_Append(PyObject* L, PyObject* x);

/* py_dict_keys.proto */
static CYTHON_INLINE PyObject* __Pyx_PyDict_Keys(PyObject* d);

/* UnpackUnboundCMethod.proto */
typedef struct {
    PyObject *type;
    PyObject **method_name;
    PyCFunction func;
    PyObject *method;
    int flag;
} __Pyx_CachedCFunction;

/* CallUnboundCMethod0.proto */
static PyObject* __Pyx__CallUnboundCMethod0(__Pyx_CachedCFunction* cfunc, PyObject* self);
#if CYTHON_COMPILING_IN_CPYTHON
#define __Pyx_CallUnboundCMethod0(cfunc, self)\
    ((likely((cfunc)->func)) ?\
        (likely((cfunc)->flag == METH_NOARGS) ?  (*((cfunc)->func))(self, NULL) :\
         (likely((cfunc)->flag == (METH_VARARGS | METH_KEYWORDS)) ?  ((*(PyCFunctionWithKeywords)(cfunc)->func)(self, __pyx_empty_tuple, NULL)) :\
             ((cfunc)->flag == METH_VARARGS ?  (*((cfunc)->func))(self, __pyx_empty_tuple) : __Pyx__CallUnboundCMethod0(cfunc, self)))) :\
        __Pyx__CallUnboundCMethod0(cfunc, self))
#else
#define __Pyx_CallUnboundCMethod0(cfunc, self)  __Pyx__CallUnboundCMethod0(cfunc, self)
#endif

/* None.proto */
static CYTHON_INLINE Py_ssize_t __Pyx_div_Py_ssize_t(Py_ssize_t, Py_ssize_t);

/* pyobject_as_double.proto */
static double __Pyx__PyObject_AsDouble(PyObject* obj);
#if CYTHON_COMPILING_IN_PYPY
#define __Pyx_PyObject_AsDouble(obj)\
(likely(PyFloat_CheckExact(obj)) ? PyFloat_AS_DOUBLE(obj) :\
 likely(PyInt_CheckExact(obj)) ?\
 PyFloat_AsDouble(obj) : __Pyx__PyObject_AsDouble(obj))
#else
#define __Pyx_PyObject_AsDouble(obj)\
((likely(PyFloat_CheckExact(obj))) ?\
 PyFloat_AS_DOUBLE(obj) : __Pyx__PyObject_AsDouble(obj))
#endif

/* RaiseTooManyValuesToUnpack.proto */
static CYTHON_INLINE void __Pyx_RaiseTooManyValuesError(Py_ssize_t expected);

/* RaiseNeedMoreValuesToUnpack.proto */
static CYTHON_INLINE void __Pyx_RaiseNeedMoreValuesError(Py_ssize_t index);

/* IterFinish.proto */
static CYTHON_INLINE int __Pyx_IterFinish(void);

/* UnpackItemEndCheck.proto */
static int __Pyx_IternextUnpackEndCheck(PyObject *retval, Py_ssize_t expected);

/* Import.proto */
static PyObject *__Pyx_Import(PyObject *name, PyObject *from_list, int level);

/* PyObjectCallNoArg.proto */
#if CYTHON_COMPILING_IN_CPYTHON
static CYTHON_INLINE PyObject* __Pyx_PyObject_CallNoArg(PyObject *func);
#else
#define __Pyx_PyObject_CallNoArg(func) __Pyx_PyObject_Call(func, __pyx_empty_tuple, NULL)
#endif

/* PyIntBinop.proto */
#if CYTHON_COMPILING_IN_CPYTHON
static PyObject* __Pyx_PyInt_SubtractObjC(PyObject *op1, PyObject *op2, long intval, int inplace);
#else
#define __Pyx_PyInt_SubtractObjC(op1, op2, intval, inplace)\
    (inplace ? PyNumber_InPlaceSubtract(op1, op2) : PyNumber_Subtract(op1, op2))
#endif

/* PyDictContains.proto */
static CYTHON_INLINE int __Pyx_PyDict_ContainsTF(PyObject* item, PyObject* dict, int eq) {
    int result = PyDict_Contains(dict, item);
    return unlikely(result < 0) ? result : (result == (eq == Py_EQ));
}

/* PyFloatBinop.proto */
#if CYTHON_COMPILING_IN_CPYTHON
static PyObject* __Pyx_PyFloat_DivideCObj(PyObject *op1, PyObject *op2, double floatval, int inplace);
#else
#define __Pyx_PyFloat_DivideCObj(op1, op2, floatval, inplace)\
    ((inplace ? __Pyx_PyNumber_InPlaceDivide(op1, op2) : __Pyx_PyNumber_Divide(op1, op2)))
    #endif

/* SliceTupleAndList.proto */
#if CYTHON_COMPILING_IN_CPYTHON
static CYTHON_INLINE PyObject* __Pyx_PyList_GetSlice(PyObject* src, Py_ssize_t start, Py_ssize_t stop);
static CYTHON_INLINE PyObject* __Pyx_PyTuple_GetSlice(PyObject* src, Py_ssize_t start, Py_ssize_t stop);
#else
#define __Pyx_PyList_GetSlice(seq, start, stop)   PySequence_GetSlice(seq, start, stop)
#define __Pyx_PyTuple_GetSlice(seq, start, stop)  PySequence_GetSlice(seq, start, stop)
#endif

/* PyFloatBinop.proto */
#if CYTHON_COMPILING_IN_CPYTHON
static PyObject* __Pyx_PyFloat_DivideObjC(PyObject *op1, PyObject *op2, double floatval, int inplace);
#else
#define __Pyx_PyFloat_DivideObjC(op1, op2, floatval, inplace)\
    ((inplace ? __Pyx_PyNumber_InPlaceDivide(op1, op2) : __Pyx_PyNumber_Divide(op1, op2)))
    #endif

/* UnicodeAsUCS4.proto */
static CYTHON_INLINE Py_UCS4 __Pyx_PyUnicode_AsPy_UCS4(PyObject*);

/* object_ord.proto */
#if PY_MAJOR_VERSION >= 3
#define __Pyx_PyObject_Ord(c)\
    (likely(PyUnicode_Check(c)) ? (long)__Pyx_PyUnicode_AsPy_UCS4(c) : __Pyx__PyObject_Ord(c))
#else
#define __Pyx_PyObject_Ord(c) __Pyx__PyObject_Ord(c)
#endif
static long __Pyx__PyObject_Ord(PyObject* c);

/* PyIntBinop.proto */
#if CYTHON_COMPILING_IN_CPYTHON
static PyObject* __Pyx_PyInt_SubtractCObj(PyObject *op1, PyObject *op2, long intval, int inplace);
#else
#define __Pyx_PyInt_SubtractCObj(op1, op2, intval, inplace)\
    (inplace ? PyNumber_InPlaceSubtract(op1, op2) : PyNumber_Subtract(op1, op2))
#endif

/* None.proto */
static CYTHON_INLINE void __Pyx_RaiseClosureNameError(const char *varname);

/* FetchCommonType.proto */
static PyTypeObject* __Pyx_FetchCommonType(PyTypeObject* type);

/* CythonFunction.proto */
#define __Pyx_CyFunction_USED 1
#include <structmember.h>
#define __Pyx_CYFUNCTION_STATICMETHOD  0x01
#define __Pyx_CYFUNCTION_CLASSMETHOD   0x02
#define __Pyx_CYFUNCTION_CCLASS        0x04
#define __Pyx_CyFunction_GetClosure(f)\
    (((__pyx_CyFunctionObject *) (f))->func_closure)
#define __Pyx_CyFunction_GetClassObj(f)\
    (((__pyx_CyFunctionObject *) (f))->func_classobj)
#define __Pyx_CyFunction_Defaults(type, f)\
    ((type *)(((__pyx_CyFunctionObject *) (f))->defaults))
#define __Pyx_CyFunction_SetDefaultsGetter(f, g)\
    ((__pyx_CyFunctionObject *) (f))->defaults_getter = (g)
typedef struct {
    PyCFunctionObject func;
#if PY_VERSION_HEX < 0x030500A0
    PyObject *func_weakreflist;
#endif
    PyObject *func_dict;
    PyObject *func_name;
    PyObject *func_qualname;
    PyObject *func_doc;
    PyObject *func_globals;
    PyObject *func_code;
    PyObject *func_closure;
    PyObject *func_classobj;
    void *defaults;
    int defaults_pyobjects;
    int flags;
    PyObject *defaults_tuple;
    PyObject *defaults_kwdict;
    PyObject *(*defaults_getter)(PyObject *);
    PyObject *func_annotations;
} __pyx_CyFunctionObject;
static PyTypeObject *__pyx_CyFunctionType = 0;
#define __Pyx_CyFunction_NewEx(ml, flags, qualname, self, module, globals, code)\
    __Pyx_CyFunction_New(__pyx_CyFunctionType, ml, flags, qualname, self, module, globals, code)
static PyObject *__Pyx_CyFunction_New(PyTypeObject *, PyMethodDef *ml,
                                      int flags, PyObject* qualname,
                                      PyObject *self,
                                      PyObject *module, PyObject *globals,
                                      PyObject* code);
static CYTHON_INLINE void *__Pyx_CyFunction_InitDefaults(PyObject *m,
                                                         size_t size,
                                                         int pyobjects);
static CYTHON_INLINE void __Pyx_CyFunction_SetDefaultsTuple(PyObject *m,
                                                            PyObject *tuple);
static CYTHON_INLINE void __Pyx_CyFunction_SetDefaultsKwDict(PyObject *m,
                                                             PyObject *dict);
static CYTHON_INLINE void __Pyx_CyFunction_SetAnnotationsDict(PyObject *m,
                                                              PyObject *dict);
static int __pyx_CyFunction_init(void);

/* PyObjectCallMethod2.proto */
static PyObject* __Pyx_PyObject_CallMethod2(PyObject* obj, PyObject* method_name, PyObject* arg1, PyObject* arg2);

/* dict_setdefault.proto */
static CYTHON_INLINE PyObject *__Pyx_PyDict_SetDefault(PyObject *d, PyObject *key, PyObject *default_value, int is_safe_type);

/* dict_getitem_default.proto */
static PyObject* __Pyx_PyDict_GetItemDefault(PyObject* d, PyObject* key, PyObject* default_value);

/* PyIntBinop.proto */
#if CYTHON_COMPILING_IN_CPYTHON
static PyObject* __Pyx_PyInt_RemainderObjC(PyObject *op1, PyObject *op2, long intval, int inplace);
#else
#define __Pyx_PyInt_RemainderObjC(op1, op2, intval, inplace)\
    (inplace ? PyNumber_InPlaceRemainder(op1, op2) : PyNumber_Remainder(op1, op2))
#endif

/* SliceObject.proto */
#define __Pyx_PyObject_DelSlice(obj, cstart, cstop, py_start, py_stop, py_slice, has_cstart, has_cstop, wraparound)\
    __Pyx_PyObject_SetSlice(obj, (PyObject*)NULL, cstart, cstop, py_start, py_stop, py_slice, has_cstart, has_cstop, wraparound)
static CYTHON_INLINE int __Pyx_PyObject_SetSlice(
        PyObject* obj, PyObject* value, Py_ssize_t cstart, Py_ssize_t cstop,
        PyObject** py_start, PyObject** py_stop, PyObject** py_slice,
        int has_cstart, int has_cstop, int wraparound);

/* ImportFrom.proto */
static PyObject* __Pyx_ImportFrom(PyObject* module, PyObject* name);

/* CodeObjectCache.proto */
typedef struct {
    PyCodeObject* code_object;
    int code_line;
} __Pyx_CodeObjectCacheEntry;
struct __Pyx_CodeObjectCache {
    int count;
    int max_count;
    __Pyx_CodeObjectCacheEntry* entries;
};
static struct __Pyx_CodeObjectCache __pyx_code_cache = {0,0,NULL};
static int __pyx_bisect_code_objects(__Pyx_CodeObjectCacheEntry* entries, int count, int code_line);
static PyCodeObject *__pyx_find_code_object(int code_line);
static void __pyx_insert_code_object(int code_line, PyCodeObject* code_object);

/* AddTraceback.proto */
static void __Pyx_AddTraceback(const char *funcname, int c_line,
                               int py_line, const char *filename);

/* CIntToPy.proto */
static CYTHON_INLINE PyObject* __Pyx_PyInt_From_long(long value);

/* CIntFromPy.proto */
static CYTHON_INLINE long __Pyx_PyInt_As_long(PyObject *);

/* CIntFromPy.proto */
static CYTHON_INLINE int __Pyx_PyInt_As_int(PyObject *);

/* CheckBinaryVersion.proto */
static int __Pyx_check_binary_version(void);

/* InitStrings.proto */
static int __Pyx_InitStrings(__Pyx_StringTabEntry *t);


/* Module declarations from 'vapor_vali.Simple_function' */
static PyTypeObject *__pyx_ptype_10vapor_vali_15Simple_function___pyx_scope_struct__eu_y_vs_x_ratio_calcu = 0;
#define __Pyx_MODULE_NAME "vapor_vali.Simple_function"
int __pyx_module_is_main_vapor_vali__Simple_function = 0;

/* Implementation of 'vapor_vali.Simple_function' */
static PyObject *__pyx_builtin_range;
static PyObject *__pyx_builtin_chr;
static PyObject *__pyx_builtin_print;
static PyObject *__pyx_builtin_open;
static PyObject *__pyx_builtin_min;
static PyObject *__pyx_builtin_max;
static PyObject *__pyx_builtin_sum;
static PyObject *__pyx_builtin_round;
static PyObject *__pyx_builtin_reversed;
static const char __pyx_k_[] = "-";
static const char __pyx_k_2[] = "2";
static const char __pyx_k_A[] = "A";
static const char __pyx_k_B[] = "B";
static const char __pyx_k_C[] = "C";
static const char __pyx_k_D[] = "D";
static const char __pyx_k_G[] = "G";
static const char __pyx_k_H[] = "H";
static const char __pyx_k_I[] = "I";
static const char __pyx_k_K[] = "K";
static const char __pyx_k_M[] = "M";
static const char __pyx_k_N[] = "N";
static const char __pyx_k_R[] = "R";
static const char __pyx_k_S[] = "S";
static const char __pyx_k_T[] = "T";
static const char __pyx_k_V[] = "V";
static const char __pyx_k_W[] = "W";
static const char __pyx_k_X[] = "X";
static const char __pyx_k_Y[] = "Y";
static const char __pyx_k_a[] = "a";
static const char __pyx_k_b[] = "b";
static const char __pyx_k_c[] = "c";
static const char __pyx_k_d[] = "d";
static const char __pyx_k_g[] = "g";
static const char __pyx_k_h[] = "h";
static const char __pyx_k_i[] = "i";
static const char __pyx_k_j[] = "j";
static const char __pyx_k_k[] = "k";
static const char __pyx_k_m[] = "m";
static const char __pyx_k_n[] = "n";
static const char __pyx_k_r[] = "r";
static const char __pyx_k_s[] = "s";
static const char __pyx_k_t[] = "t";
static const char __pyx_k_v[] = "v";
static const char __pyx_k_w[] = "w";
static const char __pyx_k_x[] = "x";
static const char __pyx_k_y[] = "y";
static const char __pyx_k_z[] = "z";
static const char __pyx_k_CN[] = "CN";
static const char __pyx_k_GT[] = "GT";
static const char __pyx_k_ID[] = "ID";
static const char __pyx_k_NA[] = "NA";
static const char __pyx_k__2[] = "+";
static const char __pyx_k__3[] = "/";
static const char __pyx_k__7[] = "^";
static const char __pyx_k_ab[] = "ab";
static const char __pyx_k_fo[] = "fo";
static const char __pyx_k_k1[] = "k1";
static const char __pyx_k_k2[] = "k2";
static const char __pyx_k_ka[] = "ka";
static const char __pyx_k_kb[] = "kb";
static const char __pyx_k_kc[] = "kc";
static const char __pyx_k_kd[] = "kd";
static const char __pyx_k_km[] = "km";
static const char __pyx_k_ks[] = "ks";
static const char __pyx_k_np[] = "np";
static const char __pyx_k_os[] = "os";
static const char __pyx_k_pi[] = "pi";
static const char __pyx_k_re[] = "re";
static const char __pyx_k_vq[] = "vq";
static const char __pyx_k_vs[] = ".vs.";
static const char __pyx_k_ALT[] = "ALT";
static const char __pyx_k_BIC[] = "BIC";
static const char __pyx_k_END[] = "END=";
static const char __pyx_k_POS[] = "POS";
static const char __pyx_k_REF[] = "REF";
static const char __pyx_k_SEQ[] = "SEQ=";
static const char __pyx_k_XXX[] = "XXX";
static const char __pyx_k__14[] = "*";
static const char __pyx_k__19[] = ".";
static const char __pyx_k__24[] = "";
static const char __pyx_k__25[] = "@";
static const char __pyx_k__26[] = ";";
static const char __pyx_k__29[] = "=";
static const char __pyx_k__38[] = ":";
static const char __pyx_k__45[] = "./.";
static const char __pyx_k__47[] = "|";
static const char __pyx_k__48[] = ".|.";
static const char __pyx_k__83[] = ",";
static const char __pyx_k_a_2[] = "a^";
static const char __pyx_k_b_2[] = "b^";
static const char __pyx_k_bps[] = "bps";
static const char __pyx_k_chr[] = "chr";
static const char __pyx_k_col[] = "col";
static const char __pyx_k_del[] = "del";
static const char __pyx_k_end[] = "end";
static const char __pyx_k_fai[] = ".fai";
static const char __pyx_k_fin[] = "fin";
static const char __pyx_k_fit[] = "fit";
static const char __pyx_k_gap[] = "gap";
static const char __pyx_k_get[] = "get";
static const char __pyx_k_hit[] = "hit";
static const char __pyx_k_idx[] = "idx";
static const char __pyx_k_inf[] = "inf";
static const char __pyx_k_inv[] = "inv";
static const char __pyx_k_key[] = "key";
static const char __pyx_k_let[] = "let";
static const char __pyx_k_max[] = "max";
static const char __pyx_k_min[] = "min";
static const char __pyx_k_out[] = "out";
static const char __pyx_k_par[] = "par";
static const char __pyx_k_pch[] = "pch";
static const char __pyx_k_pdf[] = "pdf";
static const char __pyx_k_pin[] = "pin";
static const char __pyx_k_plt[] = "plt";
static const char __pyx_k_png[] = "png";
static const char __pyx_k_rec[] = "rec";
static const char __pyx_k_red[] = "red";
static const char __pyx_k_ref[] = "ref";
static const char __pyx_k_seq[] = "seq";
static const char __pyx_k_std[] = "std";
static const char __pyx_k_sum[] = "sum";
static const char __pyx_k_vec[] = "vec";
static const char __pyx_k_INFO[] = "INFO";
static const char __pyx_k_PASS[] = "PASS";
static const char __pyx_k_QUAL[] = "QUAL";
static const char __pyx_k_TRUE[] = "TRUE";
static const char __pyx_k__100[] = "<";
static const char __pyx_k__102[] = ">";
static const char __pyx_k__115[] = "_";
static const char __pyx_k__157[] = "#";
static const char __pyx_k__159[] = "\t";
static const char __pyx_k__162[] = " ";
static const char __pyx_k_dim1[] = "dim1";
static const char __pyx_k_dim2[] = "dim2";
static const char __pyx_k_fbam[] = "fbam";
static const char __pyx_k_file[] = "file";
static const char __pyx_k_flag[] = "flag";
static const char __pyx_k_fmin[] = "fmin";
static const char __pyx_k_fref[] = "fref";
static const char __pyx_k_full[] = "full";
static const char __pyx_k_geno[] = "geno";
static const char __pyx_k_hits[] = "hits";
static const char __pyx_k_info[] = "info";
static const char __pyx_k_init[] = "init";
static const char __pyx_k_join[] = "join";
static const char __pyx_k_keys[] = "keys";
static const char __pyx_k_line[] = "line";
static const char __pyx_k_list[] = "list";
static const char __pyx_k_main[] = "__main__";
static const char __pyx_k_math[] = "math";
static const char __pyx_k_mean[] = "mean";
static const char __pyx_k_open[] = "open";
static const char __pyx_k_out1[] = "out1";
static const char __pyx_k_out2[] = "out2";
static const char __pyx_k_path[] = "path";
static const char __pyx_k_pbam[] = "pbam";
static const char __pyx_k_plot[] = "plot";
static const char __pyx_k_pref[] = "pref";
static const char __pyx_k_reca[] = "reca";
static const char __pyx_k_recb[] = "recb";
static const char __pyx_k_rpy2[] = "rpy2";
static const char __pyx_k_seq1[] = "seq1";
static const char __pyx_k_seq2[] = "seq2";
static const char __pyx_k_size[] = "size";
static const char __pyx_k_sort[] = "sort";
static const char __pyx_k_sqrt[] = "sqrt";
static const char __pyx_k_sysm[] = "sysm";
static const char __pyx_k_temp[] = "temp";
static const char __pyx_k_test[] = "test";
static const char __pyx_k_type[] = "type";
static const char __pyx_k_vec2[] = "vec2";
static const char __pyx_k_vec3[] = "vec3";
static const char __pyx_k_vec4[] = "vec4";
static const char __pyx_k_xlab[] = "xlab";
static const char __pyx_k_ylab[] = "ylab";
static const char __pyx_k_ATGCN[] = "ATGCN";
static const char __pyx_k_BIC_i[] = "BIC_i";
static const char __pyx_k_CHROM[] = "#CHROM";
static const char __pyx_k_END_2[] = "END";
static const char __pyx_k_Error[] = "Error";
static const char __pyx_k_FALSE[] = "FALSE";
static const char __pyx_k_SVLEN[] = "SVLEN=";
static const char __pyx_k_TACGN[] = "TACGN";
static const char __pyx_k_a_seq[] = "a_seq";
static const char __pyx_k_array[] = "array";
static const char __pyx_k_atgcn[] = "atgcn";
static const char __pyx_k_b_seq[] = "b_seq";
static const char __pyx_k_block[] = "block";
static const char __pyx_k_cdist[] = "cdist";
static const char __pyx_k_chrom[] = "chrom";
static const char __pyx_k_cigar[] = "cigar";
static const char __pyx_k_close[] = "close";
static const char __pyx_k_clu_1[] = "clu_1";
static const char __pyx_k_count[] = "count";
static const char __pyx_k_dCost[] = "dCost";
static const char __pyx_k_dDist[] = "dDist";
static const char __pyx_k_iCost[] = "iCost";
static const char __pyx_k_iDist[] = "iDist";
static const char __pyx_k_index[] = "index";
static const char __pyx_k_isdir[] = "isdir";
static const char __pyx_k_isnan[] = "isnan";
static const char __pyx_k_log10[] = "log10";
static const char __pyx_k_mCost[] = "mCost";
static const char __pyx_k_mDist[] = "mDist";
static const char __pyx_k_mfrow[] = "mfrow";
static const char __pyx_k_numpy[] = "numpy";
static const char __pyx_k_other[] = "other";
static const char __pyx_k_popen[] = "popen";
static const char __pyx_k_print[] = "print";
static const char __pyx_k_range[] = "range";
static const char __pyx_k_ratio[] = "ratio";
static const char __pyx_k_round[] = "round";
static const char __pyx_k_scipy[] = "scipy";
static const char __pyx_k_shape[] = "shape";
static const char __pyx_k_split[] = "split";
static const char __pyx_k_start[] = "start";
static const char __pyx_k_stats[] = "stats";
static const char __pyx_k_strip[] = "strip";
static const char __pyx_k_tacgn[] = "tacgn";
static const char __pyx_k_temp1[] = "temp1";
static const char __pyx_k_vapor[] = ".vapor";
static const char __pyx_k_where[] = "where";
static const char __pyx_k_width[] = "width";
static const char __pyx_k_FILTER[] = "FILTER";
static const char __pyx_k_FORMAT[] = "FORMAT";
static const char __pyx_k_KMeans[] = "KMeans";
static const char __pyx_k_SAMPLE[] = "SAMPLE";
static const char __pyx_k_SVTYPE[] = "SVTYPE";
static const char __pyx_k_alt_sv[] = "alt_sv";
static const char __pyx_k_append[] = "append";
static const char __pyx_k_bam_in[] = "bam_in";
static const char __pyx_k_cigars[] = "cigars";
static const char __pyx_k_cl_var[] = "cl_var";
static const char __pyx_k_flag_y[] = "flag_y";
static const char __pyx_k_group1[] = "group1";
static const char __pyx_k_groups[] = "groups";
static const char __pyx_k_height[] = "height";
static const char __pyx_k_import[] = "__import__";
static const char __pyx_k_isfile[] = "isfile";
static const char __pyx_k_k1_hap[] = "k1_hap";
static const char __pyx_k_k2_hap[] = "k2_hap";
static const char __pyx_k_keylen[] = "keylen";
static const char __pyx_k_kmeans[] = "kmeans";
static const char __pyx_k_labels[] = "labels_";
static const char __pyx_k_length[] = "length";
static const char __pyx_k_lookup[] = "lookup";
static const char __pyx_k_median[] = "median";
static const char __pyx_k_pcigar[] = "pcigar";
static const char __pyx_k_points[] = "points";
static const char __pyx_k_random[] = "random";
static const char __pyx_k_ref_sv[] = "ref_sv";
static const char __pyx_k_subkey[] = "subkey";
static const char __pyx_k_svtype[] = "svtype";
static const char __pyx_k_system[] = "system";
static const char __pyx_k_temp_x[] = "temp_x";
static const char __pyx_k_test_2[] = "__test__";
static const char __pyx_k_vec_in[] = "vec_in";
static const char __pyx_k_whiten[] = "whiten";
static const char __pyx_k_x_axis[] = "x_axis";
static const char __pyx_k_y_axis[] = "y_axis";
static const char __pyx_k_BIC_rec[] = "BIC_rec";
static const char __pyx_k_MEIINFO[] = "MEIINFO=";
static const char __pyx_k_SVLEN_2[] = "SVLEN";
static const char __pyx_k_alt_bps[] = "alt_bps";
static const char __pyx_k_alt_jun[] = "alt_jun";
static const char __pyx_k_alt_seq[] = "alt_seq";
static const char __pyx_k_bp_info[] = "bp_info";
static const char __pyx_k_bp_list[] = "bp_list";
static const char __pyx_k_centers[] = "centers";
static const char __pyx_k_chromos[] = "chromos";
static const char __pyx_k_cluster[] = "cluster";
static const char __pyx_k_compile[] = "compile";
static const char __pyx_k_dev_off[] = "dev_off";
static const char __pyx_k_diagnal[] = "diagnal";
static const char __pyx_k_dis_cff[] = "dis_cff";
static const char __pyx_k_dis_clu[] = "dis_clu";
static const char __pyx_k_dot_pos[] = "dot_pos";
static const char __pyx_k_dotdata[] = "dotdata";
static const char __pyx_k_dup_dis[] = "dup_dis";
static const char __pyx_k_importr[] = "importr";
static const char __pyx_k_ins_pos[] = "ins_pos";
static const char __pyx_k_ins_seq[] = "ins_seq";
static const char __pyx_k_k2_haps[] = "k2_haps";
static const char __pyx_k_k_means[] = "k-means++";
static const char __pyx_k_kmeansi[] = "kmeansi";
static const char __pyx_k_kmerlen[] = "kmerlen";
static const char __pyx_k_listdir[] = "listdir";
static const char __pyx_k_miss_bp[] = "miss_bp";
static const char __pyx_k_mkdir_s[] = "mkdir %s";
static const char __pyx_k_out_new[] = "out_new";
static const char __pyx_k_out_pos[] = "out_pos";
static const char __pyx_k_overlap[] = "overlap";
static const char __pyx_k_pos_rec[] = "pos_rec";
static const char __pyx_k_product[] = "product";
static const char __pyx_k_rec_pos[] = "rec_pos";
static const char __pyx_k_ref_bps[] = "ref_bps";
static const char __pyx_k_ref_seq[] = "ref_seq";
static const char __pyx_k_replace[] = "replace";
static const char __pyx_k_reverse[] = "reverse";
static const char __pyx_k_seq1len[] = "seq1len";
static const char __pyx_k_sklearn[] = "sklearn";
static const char __pyx_k_std_rec[] = "std_rec";
static const char __pyx_k_subhits[] = "subhits";
static const char __pyx_k_subkeys[] = "subkeys";
static const char __pyx_k_sv_info[] = "sv_info";
static const char __pyx_k_POLARITY[] = "POLARITY";
static const char __pyx_k_alt_left[] = "alt_left";
static const char __pyx_k_bincount[] = "bincount";
static const char __pyx_k_cluster1[] = "cluster1";
static const char __pyx_k_cluster2[] = "cluster2";
static const char __pyx_k_distance[] = "distance";
static const char __pyx_k_dup_test[] = "dup_test";
static const char __pyx_k_file_out[] = "file_out";
static const char __pyx_k_finditer[] = "finditer";
static const char __pyx_k_graphics[] = "graphics";
static const char __pyx_k_keep_rec[] = "keep_rec";
static const char __pyx_k_kept_dot[] = "kept_dot";
static const char __pyx_k_kept_dup[] = "kept_dup";
static const char __pyx_k_kmerhits[] = "kmerhits";
static const char __pyx_k_labels_2[] = "labels";
static const char __pyx_k_left_new[] = "left_new";
static const char __pyx_k_let_hash[] = "let_hash";
static const char __pyx_k_list_bps[] = "list_bps";
static const char __pyx_k_list_set[] = "list_set";
static const char __pyx_k_nth_base[] = "nth_base";
static const char __pyx_k_opt_dist[] = "opt_dist";
static const char __pyx_k_optimize[] = "optimize";
static const char __pyx_k_out_dots[] = "out_dots";
static const char __pyx_k_out_hash[] = "out_hash";
static const char __pyx_k_out_list[] = "out_list";
static const char __pyx_k_out_name[] = "out_name";
static const char __pyx_k_plotting[] = "plotting";
static const char __pyx_k_read_rec[] = "read_rec";
static const char __pyx_k_readline[] = "readline";
static const char __pyx_k_ref_left[] = "ref_left";
static const char __pyx_k_reversed[] = "reversed";
static const char __pyx_k_run_flag[] = "run_flag";
static const char __pyx_k_sv_block[] = "sv_block";
static const char __pyx_k_sym_dots[] = "sym_dots";
static const char __pyx_k_whitened[] = "whitened";
static const char __pyx_k_x_modify[] = "x_modify";
static const char __pyx_k_IntVector[] = "IntVector";
static const char __pyx_k_StrVector[] = "StrVector";
static const char __pyx_k_align_rec[] = "align_rec";
static const char __pyx_k_all_reads[] = "all_reads";
static const char __pyx_k_alt_juncs[] = "alt_juncs";
static const char __pyx_k_block_len[] = "block_len";
static const char __pyx_k_block_rec[] = "block_rec";
static const char __pyx_k_centroids[] = "centroids";
static const char __pyx_k_clu_2_sub[] = "clu_2_sub";
static const char __pyx_k_data_hash[] = "data_hash";
static const char __pyx_k_data_list[] = "data_list";
static const char __pyx_k_dis_range[] = "dis_range";
static const char __pyx_k_dup_block[] = "dup_block";
static const char __pyx_k_dup_count[] = "dup_count";
static const char __pyx_k_euclidean[] = "euclidean";
static const char __pyx_k_grDevices[] = "grDevices";
static const char __pyx_k_grdevices[] = "grdevices";
static const char __pyx_k_info_list[] = "info_list";
static const char __pyx_k_ins_point[] = "ins_point";
static const char __pyx_k_ins_seq_2[] = "ins_seq_2";
static const char __pyx_k_intercept[] = "intercept";
static const char __pyx_k_intersect[] = "intersect";
static const char __pyx_k_itertools[] = "itertools";
static const char __pyx_k_kept_list[] = "kept_list";
static const char __pyx_k_ks_picked[] = "ks_picked";
static const char __pyx_k_left_part[] = "left_part";
static const char __pyx_k_new_juncs[] = "new_juncs";
static const char __pyx_k_out_new_2[] = "out_new_2";
static const char __pyx_k_out_total[] = "out_total";
static const char __pyx_k_pos_check[] = "pos_check";
static const char __pyx_k_ratio_new[] = "ratio_new";
static const char __pyx_k_ref_juncs[] = "ref_juncs";
static const char __pyx_k_ref_seq_a[] = "ref_seq_a";
static const char __pyx_k_ref_seq_b[] = "ref_seq_b";
static const char __pyx_k_region_QC[] = "region_QC";
static const char __pyx_k_right_new[] = "right_new";
static const char __pyx_k_size_list[] = "size_list";
static const char __pyx_k_start_dis[] = "start_dis";
static const char __pyx_k_temp_hash[] = "temp_hash";
static const char __pyx_k_vapor_rec[] = "vapor_rec";
static const char __pyx_k_vcf_input[] = "vcf_input";
static const char __pyx_k_VaPoR_geno[] = "VaPoR_geno";
static const char __pyx_k_align_info[] = "align_info";
static const char __pyx_k_alt_allele[] = "alt_allele";
static const char __pyx_k_bam_in_new[] = "bam_in_new";
static const char __pyx_k_block_hash[] = "block_hash";
static const char __pyx_k_bp_let_seq[] = "bp_let_seq";
static const char __pyx_k_const_term[] = "const_term";
static const char __pyx_k_dis_10perc[] = "dis_10perc";
static const char __pyx_k_distortion[] = "distortion";
static const char __pyx_k_eu_dis_abs[] = "eu_dis_abs";
static const char __pyx_k_geno_value[] = "geno_value";
static const char __pyx_k_insert_pos[] = "insert_pos";
static const char __pyx_k_inversions[] = "inversions";
static const char __pyx_k_k2_hap_new[] = "k2_hap_new";
static const char __pyx_k_kept_dot_x[] = "kept_dot_x";
static const char __pyx_k_kept_dot_y[] = "kept_dot_y";
static const char __pyx_k_kept_list1[] = "kept_list1";
static const char __pyx_k_kept_list2[] = "kept_list2";
static const char __pyx_k_key_modify[] = "key_modify";
static const char __pyx_k_let_single[] = "let_single";
static const char __pyx_k_linregress[] = "linregress";
static const char __pyx_k_list_unify[] = "list_unify";
static const char __pyx_k_n_clusters[] = "n_clusters";
static const char __pyx_k_neg_values[] = "neg_values";
static const char __pyx_k_path_mkdir[] = "path_mkdir";
static const char __pyx_k_pos_values[] = "pos_values";
static const char __pyx_k_qual_value[] = "qual_value";
static const char __pyx_k_ref_allele[] = "ref_allele";
static const char __pyx_k_ref_region[] = "ref_region";
static const char __pyx_k_right_part[] = "right_part";
static const char __pyx_k_setdefault[] = "setdefault";
static const char __pyx_k_sub_group1[] = "sub_group1";
static const char __pyx_k_unify_list[] = "unify_list";
static const char __pyx_k_FloatVector[] = "FloatVector";
static const char __pyx_k_PacBio_read[] = "PacBio read";
static const char __pyx_k_VaPoR_value[] = "VaPoR_value";
static const char __pyx_k_Window_size[] = "Window size:";
static const char __pyx_k_align_start[] = "align_start";
static const char __pyx_k_all_reads_a[] = "all_reads_a";
static const char __pyx_k_alt_bps_new[] = "alt_bps_new";
static const char __pyx_k_alt_dotdata[] = "alt_dotdata";
static const char __pyx_k_bam_in_keys[] = "bam_in_keys";
static const char __pyx_k_bam_in_path[] = "bam_in_path";
static const char __pyx_k_bp_let_hash[] = "bp_let_hash";
static const char __pyx_k_calcu_log10[] = "calcu_log10";
static const char __pyx_k_compute_bic[] = "compute_bic";
static const char __pyx_k_cost_matrix[] = "cost_matrix";
static const char __pyx_k_d_MIDNSHP_X[] = "(\\d+)([MIDNSHP=X])";
static const char __pyx_k_dis_cluster[] = "dis_cluster";
static const char __pyx_k_dot_to_line[] = "dot_to_line";
static const char __pyx_k_fit_predict[] = "fit_predict";
static const char __pyx_k_invert_base[] = "invert_base";
static const char __pyx_k_inverted_sv[] = "inverted_sv";
static const char __pyx_k_kept_region[] = "kept_region";
static const char __pyx_k_lenght_list[] = "lenght_list";
static const char __pyx_k_move_matrix[] = "move_matrix";
static const char __pyx_k_path_modify[] = "path_modify";
static const char __pyx_k_pos_compare[] = "pos_compare";
static const char __pyx_k_ref_bps_new[] = "ref_bps_new";
static const char __pyx_k_ref_dotdata[] = "ref_dotdata";
static const char __pyx_k_scipy_stats[] = "scipy.stats";
static const char __pyx_k_sorted_keys[] = "sorted_keys";
static const char __pyx_k_sorted_list[] = "sorted_list";
static const char __pyx_k_square_size[] = "square_size";
static const char __pyx_k_sub_sv_info[] = "sub_sv_info";
static const char __pyx_k_substr_list[] = "substr_list";
static const char __pyx_k_target_read[] = "target_read";
static const char __pyx_k_temp_bam_in[] = "temp_bam_in";
static const char __pyx_k_temp_result[] = "temp_result";
static const char __pyx_k_vapor_input[] = "vapor_input";
static const char __pyx_k_window_size[] = "window_size";
static const char __pyx_k_all_combines[] = "all_combines";
static const char __pyx_k_block_modify[] = "block_modify";
static const char __pyx_k_cigar_record[] = "cigar_record";
static const char __pyx_k_combinations[] = "combinations";
static const char __pyx_k_dot_cluster1[] = "dot_cluster1";
static const char __pyx_k_dot_cluster2[] = "dot_cluster2";
static const char __pyx_k_dotdata_list[] = "dotdata_list";
static const char __pyx_k_editDistance[] = "editDistance";
static const char __pyx_k_flank_length[] = "flank_length";
static const char __pyx_k_gaussian_kde[] = "gaussian_kde";
static const char __pyx_k_insert_block[] = "insert_block";
static const char __pyx_k_insert_point[] = "insert_point=";
static const char __pyx_k_kept_dot_pos[] = "kept_dot_pos";
static const char __pyx_k_letter_split[] = "letter_split";
static const char __pyx_k_list_dotdata[] = "list_dotdata";
static const char __pyx_k_new_read_rec[] = "new_read_rec";
static const char __pyx_k_no_dup_block[] = "no_dup_block";
static const char __pyx_k_original_pos[] = "original_pos";
static const char __pyx_k_ref_left_new[] = "ref_left_new";
static const char __pyx_k_reverse_flag[] = "reverse_flag";
static const char __pyx_k_size_cluster[] = "size_cluster";
static const char __pyx_k_subkeys_info[] = "subkeys_info";
static const char __pyx_k_sv_rec_label[] = "sv_rec_label";
static const char __pyx_k_vcf_rec_hash[] = "vcf_rec_hash";
static const char __pyx_k_x_modify_new[] = "x_modify_new";
static const char __pyx_k_alt_kept_segs[] = "alt_kept_segs";
static const char __pyx_k_alt_structure[] = "alt_structure";
static const char __pyx_k_array_diagnal[] = "array_diagnal";
static const char __pyx_k_bam_in_decide[] = "bam_in_decide";
static const char __pyx_k_best_read_rec[] = "best_read_rec";
static const char __pyx_k_complementary[] = "complementary";
static const char __pyx_k_dis_cluster_2[] = "dis_cluster_2";
static const char __pyx_k_dis_dup_check[] = "dis_dup_check";
static const char __pyx_k_dup_block_bps[] = "dup_block_bps";
static const char __pyx_k_inverted_sv_2[] = "inverted_sv_2";
static const char __pyx_k_inverted_sv_3[] = "inverted_sv_3";
static const char __pyx_k_kept_dot_diag[] = "kept_dot_diag";
static const char __pyx_k_new_start_dis[] = "new_start_dis";
static const char __pyx_k_other_cluster[] = "other_cluster";
static const char __pyx_k_overlap_count[] = "overlap_count";
static const char __pyx_k_range_cluster[] = "range_cluster";
static const char __pyx_k_ref_kept_segs[] = "ref_kept_segs";
static const char __pyx_k_ref_ref_lines[] = "ref_ref_lines";
static const char __pyx_k_ref_structure[] = "ref_structure";
static const char __pyx_k_region_QC_Cff[] = "region_QC_Cff";
static const char __pyx_k_removed_dot_x[] = "removed_dot_x";
static const char __pyx_k_removed_dot_y[] = "removed_dot_y";
static const char __pyx_k_scipy_spatial[] = "scipy.spatial";
static const char __pyx_k_vcf_info_hash[] = "vcf_info_hash";
static const char __pyx_k_KMeans_predict[] = "KMeans_predict";
static const char __pyx_k_SV_description[] = "SV_description";
static const char __pyx_k_alt_seq_readin[] = "alt_seq_readin";
static const char __pyx_k_block_subsplot[] = "block_subsplot";
static const char __pyx_k_bp_to_chr_hash[] = "bp_to_chr_hash";
static const char __pyx_k_chromos_readin[] = "chromos_readin";
static const char __pyx_k_dis_to_diagnal[] = "dis_to_diagnal";
static const char __pyx_k_dotdata_record[] = "dotdata_record";
static const char __pyx_k_edit_dis_setup[] = "edit_dis_setup";
static const char __pyx_k_genoCN_extract[] = "genoCN_extract";
static const char __pyx_k_nparam_density[] = "nparam_density";
static const char __pyx_k_number_cluster[] = "number_cluster";
static const char __pyx_k_ref_left_wings[] = "ref_left_wings";
static const char __pyx_k_ref_seq_readin[] = "ref_seq_readin";
static const char __pyx_k_remove_noise_1[] = "remove_noise_1";
static const char __pyx_k_scipy_optimize[] = "scipy.optimize";
static const char __pyx_k_sv_len_extract[] = "sv_len_extract";
static const char __pyx_k_sv_seq_extract[] = "sv_seq_extract";
static const char __pyx_k_svtype_extract[] = "svtype_extract";
static const char __pyx_k_temp_structure[] = "temp_structure";
static const char __pyx_k_window_size_qc[] = "window_size_qc";
static const char __pyx_k_y_x_ratio_list[] = "y_x_ratio_list";
static const char __pyx_k_X_means_cluster[] = "X_means_cluster";
static const char __pyx_k_bam_in_new_list[] = "bam_in_new_list";
static const char __pyx_k_bp_to_block_len[] = "bp_to_block_len";
static const char __pyx_k_cluster_centers[] = "cluster_centers_";
static const char __pyx_k_inverted_sv_new[] = "inverted_sv_new";
static const char __pyx_k_k_means_cluster[] = "k_means_cluster";
static const char __pyx_k_letter_subgroup[] = "letter_subgroup";
static const char __pyx_k_out_figure_name[] = "out_figure_name";
static const char __pyx_k_overlap_portion[] = "overlap_portion";
static const char __pyx_k_polarity_detect[] = "polarity_detect";
static const char __pyx_k_clean_dotdata_m1[] = "clean_dotdata_m1";
static const char __pyx_k_clean_dotdata_m2[] = "clean_dotdata_m2";
static const char __pyx_k_eu_dis_abs_calcu[] = "eu_dis_abs_calcu";
static const char __pyx_k_eu_dis_dir_calcu[] = "eu_dis_dir_calcu";
static const char __pyx_k_eu_dis_reg_calcu[] = "eu_dis_reg_calcu";
static const char __pyx_k_genotype_extract[] = "genotype_extract";
static const char __pyx_k_kept_dot_cluster[] = "kept_dot_cluster";
static const char __pyx_k_ref_kept_deviate[] = "ref_kept_deviate";
static const char __pyx_k_removed_dot_diag[] = "removed_dot_diag";
static const char __pyx_k_scipy_cluster_vq[] = "scipy.cluster.vq";
static const char __pyx_k_vapor_score_list[] = "vapor_score_list";
static const char __pyx_k_vcf_rec_hash_new[] = "vcf_rec_hash_new";
static const char __pyx_k_vcf_vapor_modify[] = "vcf_vapor_modify";
static const char __pyx_k_INS_length_detect[] = "INS_length_detect";
static const char __pyx_k_alt_clean_dotdata[] = "alt_clean_dotdata";
static const char __pyx_k_alt_new_intercept[] = "alt_new_intercept";
static const char __pyx_k_altered_reference[] = "altered_reference";
static const char __pyx_k_dup_block_combine[] = "dup_block_combine";
static const char __pyx_k_dup_block_kept_qc[] = "dup_block_kept_qc";
static const char __pyx_k_dup_let_recombind[] = "dup_let_recombind";
static const char __pyx_k_eu_dis_single_dot[] = "eu_dis_single_dot";
static const char __pyx_k_find_longest_list[] = "find_longest_list";
static const char __pyx_k_ideal_list_length[] = "ideal_list_length";
static const char __pyx_k_let_to_block_info[] = "let_to_block_info";
static const char __pyx_k_matplotlib_pyplot[] = "matplotlib.pyplot";
static const char __pyx_k_ref_clean_dotdata[] = "ref_clean_dotdata";
static const char __pyx_k_ref_new_intercept[] = "ref_new_intercept";
static const char __pyx_k_write_output_main[] = "write_output_main";
static const char __pyx_k_x_to_x_modify_new[] = "x_to_x_modify_new";
static const char __pyx_k_block_around_check[] = "block_around_check";
static const char __pyx_k_dotdata_qual_check[] = "dotdata_qual_check";
static const char __pyx_k_dup_block_combined[] = "dup_block_combined";
static const char __pyx_k_kept_dot_anti_diag[] = "kept_dot_anti_diag";
static const char __pyx_k_oroginal_reference[] = "oroginal_reference";
static const char __pyx_k_vapor_long_del_inv[] = "vapor_long_del_inv";
static const char __pyx_k_window_size_refine[] = "window_size_refine";
static const char __pyx_k_VaPoR_quality_score[] = "VaPoR_quality_score";
static const char __pyx_k_cluster_size_decide[] = "cluster_size_decide";
static const char __pyx_k_default_max_sv_test[] = "default_max_sv_test";
static const char __pyx_k_default_read_length[] = "default_read_length";
static const char __pyx_k_dis_to_anti_diagnal[] = "dis_to_anti_diagnal";
static const char __pyx_k_dis_to_diagnal_list[] = "dis_to_diagnal_list";
static const char __pyx_k_eu_dis_region_calcu[] = "eu_dis_region_calcu";
static const char __pyx_k_make_event_figure_1[] = "make_event_figure_1";
static const char __pyx_k_result_organize_ins[] = "result_organize_ins";
static const char __pyx_k_vapor_del_inv_Vapor[] = "vapor_del_inv_Vapor";
static const char __pyx_k_vapor_dup_inv_VapoR[] = "vapor_dup_inv_VapoR";
static const char __pyx_k_vapor_vali_plotting[] = "vapor_vali.plotting";
static const char __pyx_k_vcf_rec_hash_modify[] = "vcf_rec_hash_modify";
static const char __pyx_k_VaPoR_genotype_score[] = "VaPoR_genotype_score";
static const char __pyx_k_cluster_range_decide[] = "cluster_range_decide";
static const char __pyx_k_default_flank_length[] = "default_flank_length";
static const char __pyx_k_chr_start_end_extract[] = "chr_start_end_extract";
static const char __pyx_k_clean_dotdata_x_and_y[] = "clean_dotdata_x_and_y";
static const char __pyx_k_dup_block_combined_qc[] = "dup_block_combined_qc";
static const char __pyx_k_eu_y_vs_x_ratio_calcu[] = "eu_y_vs_x_ratio_calcu";
static const char __pyx_k_removed_dot_anti_diag[] = "removed_dot_anti_diag";
static const char __pyx_k_rpy2_robjects_vectors[] = "rpy2.robjects.vectors";
static const char __pyx_k_samtools_view_s_s_d_d[] = "samtools view %s %s:%d-%d";
static const char __pyx_k_write_dotdata_to_file[] = "write_dotdata_to_file";
static const char __pyx_k_write_output_initiate[] = "write_output_initiate";
static const char __pyx_k_flank_length_calculate[] = "flank_length_calculate";
static const char __pyx_k_interval_dis_calcu_max[] = "interval_dis_calcu_max";
static const char __pyx_k_kept_lines_size_filter[] = "kept_lines_size_filter";
static const char __pyx_k_rpy2_robjects_packages[] = "rpy2.robjects.packages";
static const char __pyx_k_samtools_faidx_s_s_d_d[] = "samtools faidx %s %s:%d-%d";
static const char __pyx_k_sv_insert_point_define[] = "sv_insert_point_define";
static const char __pyx_k_vapor_simple_del_Vapor[] = "vapor_simple_del_Vapor";
static const char __pyx_k_vapor_simple_ins_Vapor[] = "vapor_simple_ins_Vapor";
static const char __pyx_k_vapor_simple_inv_Vapor[] = "vapor_simple_inv_Vapor";
static const char __pyx_k_alt_anti_diag_kept_segs[] = "alt_anti_diag_kept_segs";
static const char __pyx_k_chop_pacbio_read_by_pos[] = "chop_pacbio_read_by_pos";
static const char __pyx_k_cigar2alignstart_by_pos[] = "cigar2alignstart_by_pos";
static const char __pyx_k_dup_inv_dup_bps_produce[] = "dup_inv_dup_bps_produce";
static const char __pyx_k_k_means_cluster_Predict[] = "k_means_cluster_Predict";
static const char __pyx_k_ref_anti_diag_kept_segs[] = "ref_anti_diag_kept_segs";
static const char __pyx_k_ref_deviate_lines_calcu[] = "ref_deviate_lines_calcu";
static const char __pyx_k_take_off_symmetric_dots[] = "take_off_symmetric_dots";
static const char __pyx_k_vapor_single_read_score[] = "vapor_single_read_score";
static const char __pyx_k_X_means_cluster_reformat[] = "X_means_cluster_reformat";
static const char __pyx_k_clean_dotdata_diagnal_m1b[] = "clean_dotdata_diagnal_m1b";
static const char __pyx_k_eu_dis_dots_within_10perc[] = "eu_dis_dots_within_10perc";
static const char __pyx_k_minimize_pacbio_read_list[] = "minimize_pacbio_read_list";
static const char __pyx_k_simple_del_diploid_decide[] = "simple_del_diploid_decide";
static const char __pyx_k_simple_del_haploid_decide[] = "simple_del_haploid_decide";
static const char __pyx_k_simple_inv_diploid_decide[] = "simple_inv_diploid_decide";
static const char __pyx_k_simple_inv_haploid_decide[] = "simple_inv_haploid_decide";
static const char __pyx_k_vapor_simple_disdup_Vapor[] = "vapor_simple_disdup_Vapor";
static const char __pyx_k_vapor_simple_tandup_Vapor[] = "vapor_simple_tandup_Vapor";
static const char __pyx_k_eu_dis_reg_dup_block_calcu[] = "eu_dis_reg_dup_block_calcu";
static const char __pyx_k_eu_y_vs_x_ratio_single_dot[] = "eu_y_vs_x_ratio_single_dot";
static const char __pyx_k_vapor_vali_Simple_function[] = "vapor_vali.Simple_function";
static const char __pyx_k_alt_anti_diag_clean_dotdata[] = "alt_anti_diag_clean_dotdata";
static const char __pyx_k_dup_inv_ref_alt_bps_produce[] = "dup_inv_ref_alt_bps_produce";
static const char __pyx_k_ref_anti_diag_clean_dotdata[] = "ref_anti_diag_clean_dotdata";
static const char __pyx_k_ref_ref_deviate_lines_calcu[] = "ref_ref_deviate_lines_calcu";
static const char __pyx_k_vapor_CANNOT_CLASSIFY_VapoR[] = "vapor_CANNOT_CLASSIFY_VapoR";
static const char __pyx_k_one_dimention_cluster_by_gap[] = "one_dimention_cluster_by_gap";
static const char __pyx_k_qual_check_repetitive_region[] = "qual_check_repetitive_region";
static const char __pyx_k_simple_disdup_diploid_decide[] = "simple_disdup_diploid_decide";
static const char __pyx_k_simple_disdup_haploid_decide[] = "simple_disdup_haploid_decide";
static const char __pyx_k_simple_tandup_diploid_decide[] = "simple_tandup_diploid_decide";
static const char __pyx_k_simple_tandup_haploid_decide[] = "simple_tandup_haploid_decide";
static const char __pyx_k_two_dimention_cluster_by_gap[] = "two_dimention_cluster_by_gap";
static const char __pyx_k_clean_dotdata_anti_diagnal_m1b[] = "clean_dotdata_anti_diagnal_m1b";
static const char __pyx_k_ref_ref_deviate_lines_describe[] = "ref_ref_deviate_lines_describe";
static const char __pyx_k_scratch_remills_flux_xuefzhao_a[] = "/scratch/remills_flux/xuefzhao/apps/vapor/vapor_vali/Simple_function.pyx";
static const char __pyx_k_Error_invalid_name_for_pacbio_fi[] = "Error: invalid name for pacbio files !";
static const char __pyx_k_calcu_vapor_single_read_score_ab[] = "calcu_vapor_single_read_score_abs_dis_m1b";
static const char __pyx_k_calcu_vapor_single_read_score_di[] = "calcu_vapor_single_read_score_directed_dis_m1b_redefine_diagnal";
static const char __pyx_k_calcu_vapor_single_read_score_wi[] = "calcu_vapor_single_read_score_within_10Perc_m1b";
static const char __pyx_k_clean_dotdata_diagnal_and_anti_d[] = "clean_dotdata_diagnal_and_anti_diagnal";
static const char __pyx_k_dis_to_diagnal_most_abundant_def[] = "dis_to_diagnal_most_abundant_defined";
static const char __pyx_k_eu_y_vs_x_ratio_calcu_locals_lam[] = "eu_y_vs_x_ratio_calcu.<locals>.<lambda>";
static const char __pyx_k_simple_chop_pacbio_read_simple_s[] = "simple_chop_pacbio_read_simple_short";
static const char __pyx_k_simple_del_chop_pacbio_read_simp[] = "simple_del_chop_pacbio_read_simple_short";
static const char __pyx_k_calcu_vapor_single_read_score_ab_2[] = "calcu_vapor_single_read_score_abs_dis_m1";
static const char __pyx_k_calcu_vapor_single_read_score_ab_3[] = "calcu_vapor_single_read_score_abs_dis_m2";
static const char __pyx_k_calcu_vapor_single_read_score_di_2[] = "calcu_vapor_single_read_score_directed_dis_m1b";
static const char __pyx_k_calcu_vapor_single_read_score_di_3[] = "calcu_vapor_single_read_score_directed_dis_m1b_not_really";
static const char __pyx_k_calcu_vapor_single_read_score_di_4[] = "calcu_vapor_single_read_score_directed_dis_m1b_maybe";
static PyObject *__pyx_kp_s_;
static PyObject *__pyx_kp_s_2;
static PyObject *__pyx_n_s_A;
static PyObject *__pyx_n_s_ALT;
static PyObject *__pyx_n_s_ATGCN;
static PyObject *__pyx_n_s_B;
static PyObject *__pyx_n_s_BIC;
static PyObject *__pyx_n_s_BIC_i;
static PyObject *__pyx_n_s_BIC_rec;
static PyObject *__pyx_n_s_C;
static PyObject *__pyx_kp_s_CHROM;
static PyObject *__pyx_n_s_CN;
static PyObject *__pyx_n_s_D;
static PyObject *__pyx_kp_s_END;
static PyObject *__pyx_n_s_END_2;
static PyObject *__pyx_n_s_Error;
static PyObject *__pyx_kp_s_Error_invalid_name_for_pacbio_fi;
static PyObject *__pyx_n_s_FALSE;
static PyObject *__pyx_n_s_FILTER;
static PyObject *__pyx_n_s_FORMAT;
static PyObject *__pyx_n_s_FloatVector;
static PyObject *__pyx_n_s_G;
static PyObject *__pyx_n_s_GT;
static PyObject *__pyx_n_s_H;
static PyObject *__pyx_n_s_I;
static PyObject *__pyx_n_s_ID;
static PyObject *__pyx_n_s_INFO;
static PyObject *__pyx_n_s_INS_length_detect;
static PyObject *__pyx_n_s_IntVector;
static PyObject *__pyx_n_s_K;
static PyObject *__pyx_n_s_KMeans;
static PyObject *__pyx_n_s_KMeans_predict;
static PyObject *__pyx_n_s_M;
static PyObject *__pyx_kp_s_MEIINFO;
static PyObject *__pyx_n_s_N;
static PyObject *__pyx_n_s_NA;
static PyObject *__pyx_n_s_PASS;
static PyObject *__pyx_n_s_POLARITY;
static PyObject *__pyx_n_s_POS;
static PyObject *__pyx_kp_s_PacBio_read;
static PyObject *__pyx_n_s_QUAL;
static PyObject *__pyx_n_s_R;
static PyObject *__pyx_n_s_REF;
static PyObject *__pyx_n_s_S;
static PyObject *__pyx_n_s_SAMPLE;
static PyObject *__pyx_kp_s_SEQ;
static PyObject *__pyx_kp_s_SVLEN;
static PyObject *__pyx_n_s_SVLEN_2;
static PyObject *__pyx_n_s_SVTYPE;
static PyObject *__pyx_n_s_SV_description;
static PyObject *__pyx_n_s_StrVector;
static PyObject *__pyx_n_s_T;
static PyObject *__pyx_n_s_TACGN;
static PyObject *__pyx_n_s_TRUE;
static PyObject *__pyx_n_s_V;
static PyObject *__pyx_n_s_VaPoR_geno;
static PyObject *__pyx_n_s_VaPoR_genotype_score;
static PyObject *__pyx_n_s_VaPoR_quality_score;
static PyObject *__pyx_n_s_VaPoR_value;
static PyObject *__pyx_n_s_W;
static PyObject *__pyx_kp_s_Window_size;
static PyObject *__pyx_n_s_X;
static PyObject *__pyx_n_s_XXX;
static PyObject *__pyx_n_s_X_means_cluster;
static PyObject *__pyx_n_s_X_means_cluster_reformat;
static PyObject *__pyx_n_s_Y;
static PyObject *__pyx_kp_s__100;
static PyObject *__pyx_kp_s__102;
static PyObject *__pyx_n_s__115;
static PyObject *__pyx_kp_s__14;
static PyObject *__pyx_kp_s__157;
static PyObject *__pyx_kp_s__159;
static PyObject *__pyx_kp_s__162;
static PyObject *__pyx_kp_s__19;
static PyObject *__pyx_kp_s__2;
static PyObject *__pyx_kp_s__24;
static PyObject *__pyx_kp_s__25;
static PyObject *__pyx_kp_s__26;
static PyObject *__pyx_kp_s__29;
static PyObject *__pyx_kp_s__3;
static PyObject *__pyx_kp_s__38;
static PyObject *__pyx_kp_s__45;
static PyObject *__pyx_kp_s__47;
static PyObject *__pyx_kp_s__48;
static PyObject *__pyx_kp_s__7;
static PyObject *__pyx_kp_s__83;
static PyObject *__pyx_n_s_a;
static PyObject *__pyx_kp_s_a_2;
static PyObject *__pyx_n_s_a_seq;
static PyObject *__pyx_n_s_ab;
static PyObject *__pyx_n_s_align_info;
static PyObject *__pyx_n_s_align_rec;
static PyObject *__pyx_n_s_align_start;
static PyObject *__pyx_n_s_all_combines;
static PyObject *__pyx_n_s_all_reads;
static PyObject *__pyx_n_s_all_reads_a;
static PyObject *__pyx_n_s_alt_allele;
static PyObject *__pyx_n_s_alt_anti_diag_clean_dotdata;
static PyObject *__pyx_n_s_alt_anti_diag_kept_segs;
static PyObject *__pyx_n_s_alt_bps;
static PyObject *__pyx_n_s_alt_bps_new;
static PyObject *__pyx_n_s_alt_clean_dotdata;
static PyObject *__pyx_n_s_alt_dotdata;
static PyObject *__pyx_n_s_alt_jun;
static PyObject *__pyx_n_s_alt_juncs;
static PyObject *__pyx_n_s_alt_kept_segs;
static PyObject *__pyx_n_s_alt_left;
static PyObject *__pyx_n_s_alt_new_intercept;
static PyObject *__pyx_n_s_alt_seq;
static PyObject *__pyx_n_s_alt_seq_readin;
static PyObject *__pyx_n_s_alt_structure;
static PyObject *__pyx_n_s_alt_sv;
static PyObject *__pyx_n_s_altered_reference;
static PyObject *__pyx_n_s_append;
static PyObject *__pyx_n_s_array;
static PyObject *__pyx_n_s_array_diagnal;
static PyObject *__pyx_n_s_atgcn;
static PyObject *__pyx_n_s_b;
static PyObject *__pyx_kp_s_b_2;
static PyObject *__pyx_n_s_b_seq;
static PyObject *__pyx_n_s_bam_in;
static PyObject *__pyx_n_s_bam_in_decide;
static PyObject *__pyx_n_s_bam_in_keys;
static PyObject *__pyx_n_s_bam_in_new;
static PyObject *__pyx_n_s_bam_in_new_list;
static PyObject *__pyx_n_s_bam_in_path;
static PyObject *__pyx_n_s_best_read_rec;
static PyObject *__pyx_n_s_bincount;
static PyObject *__pyx_n_s_block;
static PyObject *__pyx_n_s_block_around_check;
static PyObject *__pyx_n_s_block_hash;
static PyObject *__pyx_n_s_block_len;
static PyObject *__pyx_n_s_block_modify;
static PyObject *__pyx_n_s_block_rec;
static PyObject *__pyx_n_s_block_subsplot;
static PyObject *__pyx_n_s_bp_info;
static PyObject *__pyx_n_s_bp_let_hash;
static PyObject *__pyx_n_s_bp_let_seq;
static PyObject *__pyx_n_s_bp_list;
static PyObject *__pyx_n_s_bp_to_block_len;
static PyObject *__pyx_n_s_bp_to_chr_hash;
static PyObject *__pyx_n_s_bps;
static PyObject *__pyx_n_s_c;
static PyObject *__pyx_n_s_calcu_log10;
static PyObject *__pyx_n_s_calcu_vapor_single_read_score_ab;
static PyObject *__pyx_n_s_calcu_vapor_single_read_score_ab_2;
static PyObject *__pyx_n_s_calcu_vapor_single_read_score_ab_3;
static PyObject *__pyx_n_s_calcu_vapor_single_read_score_di;
static PyObject *__pyx_n_s_calcu_vapor_single_read_score_di_2;
static PyObject *__pyx_n_s_calcu_vapor_single_read_score_di_3;
static PyObject *__pyx_n_s_calcu_vapor_single_read_score_di_4;
static PyObject *__pyx_n_s_calcu_vapor_single_read_score_wi;
static PyObject *__pyx_n_s_cdist;
static PyObject *__pyx_n_s_centers;
static PyObject *__pyx_n_s_centroids;
static PyObject *__pyx_n_s_chop_pacbio_read_by_pos;
static PyObject *__pyx_n_s_chr;
static PyObject *__pyx_n_s_chr_start_end_extract;
static PyObject *__pyx_n_s_chrom;
static PyObject *__pyx_n_s_chromos;
static PyObject *__pyx_n_s_chromos_readin;
static PyObject *__pyx_n_s_cigar;
static PyObject *__pyx_n_s_cigar2alignstart_by_pos;
static PyObject *__pyx_n_s_cigar_record;
static PyObject *__pyx_n_s_cigars;
static PyObject *__pyx_n_s_cl_var;
static PyObject *__pyx_n_s_clean_dotdata_anti_diagnal_m1b;
static PyObject *__pyx_n_s_clean_dotdata_diagnal_and_anti_d;
static PyObject *__pyx_n_s_clean_dotdata_diagnal_m1b;
static PyObject *__pyx_n_s_clean_dotdata_m1;
static PyObject *__pyx_n_s_clean_dotdata_m2;
static PyObject *__pyx_n_s_clean_dotdata_x_and_y;
static PyObject *__pyx_n_s_close;
static PyObject *__pyx_n_s_clu_1;
static PyObject *__pyx_n_s_clu_2_sub;
static PyObject *__pyx_n_s_cluster;
static PyObject *__pyx_n_s_cluster1;
static PyObject *__pyx_n_s_cluster2;
static PyObject *__pyx_n_s_cluster_centers;
static PyObject *__pyx_n_s_cluster_range_decide;
static PyObject *__pyx_n_s_cluster_size_decide;
static PyObject *__pyx_n_s_col;
static PyObject *__pyx_n_s_combinations;
static PyObject *__pyx_n_s_compile;
static PyObject *__pyx_n_s_complementary;
static PyObject *__pyx_n_s_compute_bic;
static PyObject *__pyx_n_s_const_term;
static PyObject *__pyx_n_s_cost_matrix;
static PyObject *__pyx_n_s_count;
static PyObject *__pyx_n_s_d;
static PyObject *__pyx_n_s_dCost;
static PyObject *__pyx_n_s_dDist;
static PyObject *__pyx_kp_s_d_MIDNSHP_X;
static PyObject *__pyx_n_s_data_hash;
static PyObject *__pyx_n_s_data_list;
static PyObject *__pyx_n_s_default_flank_length;
static PyObject *__pyx_n_s_default_max_sv_test;
static PyObject *__pyx_n_s_default_read_length;
static PyObject *__pyx_n_s_del;
static PyObject *__pyx_n_s_dev_off;
static PyObject *__pyx_n_s_diagnal;
static PyObject *__pyx_n_s_dim1;
static PyObject *__pyx_n_s_dim2;
static PyObject *__pyx_n_s_dis_10perc;
static PyObject *__pyx_n_s_dis_cff;
static PyObject *__pyx_n_s_dis_clu;
static PyObject *__pyx_n_s_dis_cluster;
static PyObject *__pyx_n_s_dis_cluster_2;
static PyObject *__pyx_n_s_dis_dup_check;
static PyObject *__pyx_n_s_dis_range;
static PyObject *__pyx_n_s_dis_to_anti_diagnal;
static PyObject *__pyx_n_s_dis_to_diagnal;
static PyObject *__pyx_n_s_dis_to_diagnal_list;
static PyObject *__pyx_n_s_dis_to_diagnal_most_abundant_def;
static PyObject *__pyx_n_s_distance;
static PyObject *__pyx_n_s_distortion;
static PyObject *__pyx_n_s_dot_cluster1;
static PyObject *__pyx_n_s_dot_cluster2;
static PyObject *__pyx_n_s_dot_pos;
static PyObject *__pyx_n_s_dot_to_line;
static PyObject *__pyx_n_s_dotdata;
static PyObject *__pyx_n_s_dotdata_list;
static PyObject *__pyx_n_s_dotdata_qual_check;
static PyObject *__pyx_n_s_dotdata_record;
static PyObject *__pyx_n_s_dup_block;
static PyObject *__pyx_n_s_dup_block_bps;
static PyObject *__pyx_n_s_dup_block_combine;
static PyObject *__pyx_n_s_dup_block_combined;
static PyObject *__pyx_n_s_dup_block_combined_qc;
static PyObject *__pyx_n_s_dup_block_kept_qc;
static PyObject *__pyx_n_s_dup_count;
static PyObject *__pyx_n_s_dup_dis;
static PyObject *__pyx_n_s_dup_inv_dup_bps_produce;
static PyObject *__pyx_n_s_dup_inv_ref_alt_bps_produce;
static PyObject *__pyx_n_s_dup_let_recombind;
static PyObject *__pyx_n_s_dup_test;
static PyObject *__pyx_n_s_editDistance;
static PyObject *__pyx_n_s_edit_dis_setup;
static PyObject *__pyx_n_s_end;
static PyObject *__pyx_n_s_eu_dis_abs;
static PyObject *__pyx_n_s_eu_dis_abs_calcu;
static PyObject *__pyx_n_s_eu_dis_dir_calcu;
static PyObject *__pyx_n_s_eu_dis_dots_within_10perc;
static PyObject *__pyx_n_s_eu_dis_reg_calcu;
static PyObject *__pyx_n_s_eu_dis_reg_dup_block_calcu;
static PyObject *__pyx_n_s_eu_dis_region_calcu;
static PyObject *__pyx_n_s_eu_dis_single_dot;
static PyObject *__pyx_n_s_eu_y_vs_x_ratio_calcu;
static PyObject *__pyx_n_s_eu_y_vs_x_ratio_calcu_locals_lam;
static PyObject *__pyx_n_s_eu_y_vs_x_ratio_single_dot;
static PyObject *__pyx_n_s_euclidean;
static PyObject *__pyx_kp_s_fai;
static PyObject *__pyx_n_s_fbam;
static PyObject *__pyx_n_s_file;
static PyObject *__pyx_n_s_file_out;
static PyObject *__pyx_n_s_fin;
static PyObject *__pyx_n_s_find_longest_list;
static PyObject *__pyx_n_s_finditer;
static PyObject *__pyx_n_s_fit;
static PyObject *__pyx_n_s_fit_predict;
static PyObject *__pyx_n_s_flag;
static PyObject *__pyx_n_s_flag_y;
static PyObject *__pyx_n_s_flank_length;
static PyObject *__pyx_n_s_flank_length_calculate;
static PyObject *__pyx_n_s_fmin;
static PyObject *__pyx_n_s_fo;
static PyObject *__pyx_n_s_fref;
static PyObject *__pyx_n_s_full;
static PyObject *__pyx_n_s_g;
static PyObject *__pyx_n_s_gap;
static PyObject *__pyx_n_s_gaussian_kde;
static PyObject *__pyx_n_s_geno;
static PyObject *__pyx_n_s_genoCN_extract;
static PyObject *__pyx_n_s_geno_value;
static PyObject *__pyx_n_s_genotype_extract;
static PyObject *__pyx_n_s_get;
static PyObject *__pyx_n_s_grDevices;
static PyObject *__pyx_n_s_graphics;
static PyObject *__pyx_n_s_grdevices;
static PyObject *__pyx_n_s_group1;
static PyObject *__pyx_n_s_groups;
static PyObject *__pyx_n_s_h;
static PyObject *__pyx_n_s_height;
static PyObject *__pyx_n_s_hit;
static PyObject *__pyx_n_s_hits;
static PyObject *__pyx_n_s_i;
static PyObject *__pyx_n_s_iCost;
static PyObject *__pyx_n_s_iDist;
static PyObject *__pyx_n_s_ideal_list_length;
static PyObject *__pyx_n_s_idx;
static PyObject *__pyx_n_s_import;
static PyObject *__pyx_n_s_importr;
static PyObject *__pyx_n_s_index;
static PyObject *__pyx_n_s_inf;
static PyObject *__pyx_n_s_info;
static PyObject *__pyx_n_s_info_list;
static PyObject *__pyx_n_s_init;
static PyObject *__pyx_n_s_ins_point;
static PyObject *__pyx_n_s_ins_pos;
static PyObject *__pyx_n_s_ins_seq;
static PyObject *__pyx_n_s_ins_seq_2;
static PyObject *__pyx_n_s_insert_block;
static PyObject *__pyx_kp_s_insert_point;
static PyObject *__pyx_n_s_insert_pos;
static PyObject *__pyx_n_s_intercept;
static PyObject *__pyx_n_s_intersect;
static PyObject *__pyx_n_s_interval_dis_calcu_max;
static PyObject *__pyx_n_s_inv;
static PyObject *__pyx_n_s_inversions;
static PyObject *__pyx_n_s_invert_base;
static PyObject *__pyx_n_s_inverted_sv;
static PyObject *__pyx_n_s_inverted_sv_2;
static PyObject *__pyx_n_s_inverted_sv_3;
static PyObject *__pyx_n_s_inverted_sv_new;
static PyObject *__pyx_n_s_isdir;
static PyObject *__pyx_n_s_isfile;
static PyObject *__pyx_n_s_isnan;
static PyObject *__pyx_n_s_itertools;
static PyObject *__pyx_n_s_j;
static PyObject *__pyx_n_s_join;
static PyObject *__pyx_n_s_k;
static PyObject *__pyx_n_s_k1;
static PyObject *__pyx_n_s_k1_hap;
static PyObject *__pyx_n_s_k2;
static PyObject *__pyx_n_s_k2_hap;
static PyObject *__pyx_n_s_k2_hap_new;
static PyObject *__pyx_n_s_k2_haps;
static PyObject *__pyx_kp_s_k_means;
static PyObject *__pyx_n_s_k_means_cluster;
static PyObject *__pyx_n_s_k_means_cluster_Predict;
static PyObject *__pyx_n_s_ka;
static PyObject *__pyx_n_s_kb;
static PyObject *__pyx_n_s_kc;
static PyObject *__pyx_n_s_kd;
static PyObject *__pyx_n_s_keep_rec;
static PyObject *__pyx_n_s_kept_dot;
static PyObject *__pyx_n_s_kept_dot_anti_diag;
static PyObject *__pyx_n_s_kept_dot_cluster;
static PyObject *__pyx_n_s_kept_dot_diag;
static PyObject *__pyx_n_s_kept_dot_pos;
static PyObject *__pyx_n_s_kept_dot_x;
static PyObject *__pyx_n_s_kept_dot_y;
static PyObject *__pyx_n_s_kept_dup;
static PyObject *__pyx_n_s_kept_lines_size_filter;
static PyObject *__pyx_n_s_kept_list;
static PyObject *__pyx_n_s_kept_list1;
static PyObject *__pyx_n_s_kept_list2;
static PyObject *__pyx_n_s_kept_region;
static PyObject *__pyx_n_s_key;
static PyObject *__pyx_n_s_key_modify;
static PyObject *__pyx_n_s_keylen;
static PyObject *__pyx_n_s_keys;
static PyObject *__pyx_n_s_km;
static PyObject *__pyx_n_s_kmeans;
static PyObject *__pyx_n_s_kmeansi;
static PyObject *__pyx_n_s_kmerhits;
static PyObject *__pyx_n_s_kmerlen;
static PyObject *__pyx_n_s_ks;
static PyObject *__pyx_n_s_ks_picked;
static PyObject *__pyx_n_s_labels;
static PyObject *__pyx_n_s_labels_2;
static PyObject *__pyx_n_s_left_new;
static PyObject *__pyx_n_s_left_part;
static PyObject *__pyx_n_s_lenght_list;
static PyObject *__pyx_n_s_length;
static PyObject *__pyx_n_s_let;
static PyObject *__pyx_n_s_let_hash;
static PyObject *__pyx_n_s_let_single;
static PyObject *__pyx_n_s_let_to_block_info;
static PyObject *__pyx_n_s_letter_split;
static PyObject *__pyx_n_s_letter_subgroup;
static PyObject *__pyx_n_s_line;
static PyObject *__pyx_n_s_linregress;
static PyObject *__pyx_n_s_list;
static PyObject *__pyx_n_s_list_bps;
static PyObject *__pyx_n_s_list_dotdata;
static PyObject *__pyx_n_s_list_set;
static PyObject *__pyx_n_s_list_unify;
static PyObject *__pyx_n_s_listdir;
static PyObject *__pyx_n_s_log10;
static PyObject *__pyx_n_s_lookup;
static PyObject *__pyx_n_s_m;
static PyObject *__pyx_n_s_mCost;
static PyObject *__pyx_n_s_mDist;
static PyObject *__pyx_n_s_main;
static PyObject *__pyx_n_s_make_event_figure_1;
static PyObject *__pyx_n_s_math;
static PyObject *__pyx_n_s_matplotlib_pyplot;
static PyObject *__pyx_n_s_max;
static PyObject *__pyx_n_s_mean;
static PyObject *__pyx_n_s_median;
static PyObject *__pyx_n_s_mfrow;
static PyObject *__pyx_n_s_min;
static PyObject *__pyx_n_s_minimize_pacbio_read_list;
static PyObject *__pyx_n_s_miss_bp;
static PyObject *__pyx_kp_s_mkdir_s;
static PyObject *__pyx_n_s_move_matrix;
static PyObject *__pyx_n_s_n;
static PyObject *__pyx_n_s_n_clusters;
static PyObject *__pyx_n_s_neg_values;
static PyObject *__pyx_n_s_new_juncs;
static PyObject *__pyx_n_s_new_read_rec;
static PyObject *__pyx_n_s_new_start_dis;
static PyObject *__pyx_n_s_no_dup_block;
static PyObject *__pyx_n_s_np;
static PyObject *__pyx_n_s_nparam_density;
static PyObject *__pyx_n_s_nth_base;
static PyObject *__pyx_n_s_number_cluster;
static PyObject *__pyx_n_s_numpy;
static PyObject *__pyx_n_s_one_dimention_cluster_by_gap;
static PyObject *__pyx_n_s_open;
static PyObject *__pyx_n_s_opt_dist;
static PyObject *__pyx_n_s_optimize;
static PyObject *__pyx_n_s_original_pos;
static PyObject *__pyx_n_s_oroginal_reference;
static PyObject *__pyx_n_s_os;
static PyObject *__pyx_n_s_other;
static PyObject *__pyx_n_s_other_cluster;
static PyObject *__pyx_n_s_out;
static PyObject *__pyx_n_s_out1;
static PyObject *__pyx_n_s_out2;
static PyObject *__pyx_n_s_out_dots;
static PyObject *__pyx_n_s_out_figure_name;
static PyObject *__pyx_n_s_out_hash;
static PyObject *__pyx_n_s_out_list;
static PyObject *__pyx_n_s_out_name;
static PyObject *__pyx_n_s_out_new;
static PyObject *__pyx_n_s_out_new_2;
static PyObject *__pyx_n_s_out_pos;
static PyObject *__pyx_n_s_out_total;
static PyObject *__pyx_n_s_overlap;
static PyObject *__pyx_n_s_overlap_count;
static PyObject *__pyx_n_s_overlap_portion;
static PyObject *__pyx_n_s_par;
static PyObject *__pyx_n_s_path;
static PyObject *__pyx_n_s_path_mkdir;
static PyObject *__pyx_n_s_path_modify;
static PyObject *__pyx_n_s_pbam;
static PyObject *__pyx_n_s_pch;
static PyObject *__pyx_n_s_pcigar;
static PyObject *__pyx_n_s_pdf;
static PyObject *__pyx_n_s_pi;
static PyObject *__pyx_n_s_pin;
static PyObject *__pyx_n_s_plot;
static PyObject *__pyx_n_s_plotting;
static PyObject *__pyx_n_s_plt;
static PyObject *__pyx_n_s_png;
static PyObject *__pyx_n_s_points;
static PyObject *__pyx_n_s_polarity_detect;
static PyObject *__pyx_n_s_popen;
static PyObject *__pyx_n_s_pos_check;
static PyObject *__pyx_n_s_pos_compare;
static PyObject *__pyx_n_s_pos_rec;
static PyObject *__pyx_n_s_pos_values;
static PyObject *__pyx_n_s_pref;
static PyObject *__pyx_n_s_print;
static PyObject *__pyx_n_s_product;
static PyObject *__pyx_n_s_qual_check_repetitive_region;
static PyObject *__pyx_n_s_qual_value;
static PyObject *__pyx_n_s_r;
static PyObject *__pyx_n_s_random;
static PyObject *__pyx_n_s_range;
static PyObject *__pyx_n_s_range_cluster;
static PyObject *__pyx_n_s_ratio;
static PyObject *__pyx_n_s_ratio_new;
static PyObject *__pyx_n_s_re;
static PyObject *__pyx_n_s_read_rec;
static PyObject *__pyx_n_s_readline;
static PyObject *__pyx_n_s_rec;
static PyObject *__pyx_n_s_rec_pos;
static PyObject *__pyx_n_s_reca;
static PyObject *__pyx_n_s_recb;
static PyObject *__pyx_n_s_red;
static PyObject *__pyx_n_s_ref;
static PyObject *__pyx_n_s_ref_allele;
static PyObject *__pyx_n_s_ref_anti_diag_clean_dotdata;
static PyObject *__pyx_n_s_ref_anti_diag_kept_segs;
static PyObject *__pyx_n_s_ref_bps;
static PyObject *__pyx_n_s_ref_bps_new;
static PyObject *__pyx_n_s_ref_clean_dotdata;
static PyObject *__pyx_n_s_ref_deviate_lines_calcu;
static PyObject *__pyx_n_s_ref_dotdata;
static PyObject *__pyx_n_s_ref_juncs;
static PyObject *__pyx_n_s_ref_kept_deviate;
static PyObject *__pyx_n_s_ref_kept_segs;
static PyObject *__pyx_n_s_ref_left;
static PyObject *__pyx_n_s_ref_left_new;
static PyObject *__pyx_n_s_ref_left_wings;
static PyObject *__pyx_n_s_ref_new_intercept;
static PyObject *__pyx_n_s_ref_ref_deviate_lines_calcu;
static PyObject *__pyx_n_s_ref_ref_deviate_lines_describe;
static PyObject *__pyx_n_s_ref_ref_lines;
static PyObject *__pyx_n_s_ref_region;
static PyObject *__pyx_n_s_ref_seq;
static PyObject *__pyx_n_s_ref_seq_a;
static PyObject *__pyx_n_s_ref_seq_b;
static PyObject *__pyx_n_s_ref_seq_readin;
static PyObject *__pyx_n_s_ref_structure;
static PyObject *__pyx_n_s_ref_sv;
static PyObject *__pyx_n_s_region_QC;
static PyObject *__pyx_n_s_region_QC_Cff;
static PyObject *__pyx_n_s_remove_noise_1;
static PyObject *__pyx_n_s_removed_dot_anti_diag;
static PyObject *__pyx_n_s_removed_dot_diag;
static PyObject *__pyx_n_s_removed_dot_x;
static PyObject *__pyx_n_s_removed_dot_y;
static PyObject *__pyx_n_s_replace;
static PyObject *__pyx_n_s_result_organize_ins;
static PyObject *__pyx_n_s_reverse;
static PyObject *__pyx_n_s_reverse_flag;
static PyObject *__pyx_n_s_reversed;
static PyObject *__pyx_n_s_right_new;
static PyObject *__pyx_n_s_right_part;
static PyObject *__pyx_n_s_round;
static PyObject *__pyx_n_s_rpy2;
static PyObject *__pyx_n_s_rpy2_robjects_packages;
static PyObject *__pyx_n_s_rpy2_robjects_vectors;
static PyObject *__pyx_n_s_run_flag;
static PyObject *__pyx_n_s_s;
static PyObject *__pyx_kp_s_samtools_faidx_s_s_d_d;
static PyObject *__pyx_kp_s_samtools_view_s_s_d_d;
static PyObject *__pyx_n_s_scipy;
static PyObject *__pyx_n_s_scipy_cluster_vq;
static PyObject *__pyx_n_s_scipy_optimize;
static PyObject *__pyx_n_s_scipy_spatial;
static PyObject *__pyx_n_s_scipy_stats;
static PyObject *__pyx_kp_s_scratch_remills_flux_xuefzhao_a;
static PyObject *__pyx_n_s_seq;
static PyObject *__pyx_n_s_seq1;
static PyObject *__pyx_n_s_seq1len;
static PyObject *__pyx_n_s_seq2;
static PyObject *__pyx_n_s_setdefault;
static PyObject *__pyx_n_s_shape;
static PyObject *__pyx_n_s_simple_chop_pacbio_read_simple_s;
static PyObject *__pyx_n_s_simple_del_chop_pacbio_read_simp;
static PyObject *__pyx_n_s_simple_del_diploid_decide;
static PyObject *__pyx_n_s_simple_del_haploid_decide;
static PyObject *__pyx_n_s_simple_disdup_diploid_decide;
static PyObject *__pyx_n_s_simple_disdup_haploid_decide;
static PyObject *__pyx_n_s_simple_inv_diploid_decide;
static PyObject *__pyx_n_s_simple_inv_haploid_decide;
static PyObject *__pyx_n_s_simple_tandup_diploid_decide;
static PyObject *__pyx_n_s_simple_tandup_haploid_decide;
static PyObject *__pyx_n_s_size;
static PyObject *__pyx_n_s_size_cluster;
static PyObject *__pyx_n_s_size_list;
static PyObject *__pyx_n_s_sklearn;
static PyObject *__pyx_n_s_sort;
static PyObject *__pyx_n_s_sorted_keys;
static PyObject *__pyx_n_s_sorted_list;
static PyObject *__pyx_n_s_split;
static PyObject *__pyx_n_s_sqrt;
static PyObject *__pyx_n_s_square_size;
static PyObject *__pyx_n_s_start;
static PyObject *__pyx_n_s_start_dis;
static PyObject *__pyx_n_s_stats;
static PyObject *__pyx_n_s_std;
static PyObject *__pyx_n_s_std_rec;
static PyObject *__pyx_n_s_strip;
static PyObject *__pyx_n_s_sub_group1;
static PyObject *__pyx_n_s_sub_sv_info;
static PyObject *__pyx_n_s_subhits;
static PyObject *__pyx_n_s_subkey;
static PyObject *__pyx_n_s_subkeys;
static PyObject *__pyx_n_s_subkeys_info;
static PyObject *__pyx_n_s_substr_list;
static PyObject *__pyx_n_s_sum;
static PyObject *__pyx_n_s_sv_block;
static PyObject *__pyx_n_s_sv_info;
static PyObject *__pyx_n_s_sv_insert_point_define;
static PyObject *__pyx_n_s_sv_len_extract;
static PyObject *__pyx_n_s_sv_rec_label;
static PyObject *__pyx_n_s_sv_seq_extract;
static PyObject *__pyx_n_s_svtype;
static PyObject *__pyx_n_s_svtype_extract;
static PyObject *__pyx_n_s_sym_dots;
static PyObject *__pyx_n_s_sysm;
static PyObject *__pyx_n_s_system;
static PyObject *__pyx_n_s_t;
static PyObject *__pyx_n_s_tacgn;
static PyObject *__pyx_n_s_take_off_symmetric_dots;
static PyObject *__pyx_n_s_target_read;
static PyObject *__pyx_n_s_temp;
static PyObject *__pyx_n_s_temp1;
static PyObject *__pyx_n_s_temp_bam_in;
static PyObject *__pyx_n_s_temp_hash;
static PyObject *__pyx_n_s_temp_result;
static PyObject *__pyx_n_s_temp_structure;
static PyObject *__pyx_n_s_temp_x;
static PyObject *__pyx_n_s_test;
static PyObject *__pyx_n_s_test_2;
static PyObject *__pyx_n_s_two_dimention_cluster_by_gap;
static PyObject *__pyx_n_s_type;
static PyObject *__pyx_n_s_unify_list;
static PyObject *__pyx_n_s_v;
static PyObject *__pyx_kp_s_vapor;
static PyObject *__pyx_n_s_vapor_CANNOT_CLASSIFY_VapoR;
static PyObject *__pyx_n_s_vapor_del_inv_Vapor;
static PyObject *__pyx_n_s_vapor_dup_inv_VapoR;
static PyObject *__pyx_n_s_vapor_input;
static PyObject *__pyx_n_s_vapor_long_del_inv;
static PyObject *__pyx_n_s_vapor_rec;
static PyObject *__pyx_n_s_vapor_score_list;
static PyObject *__pyx_n_s_vapor_simple_del_Vapor;
static PyObject *__pyx_n_s_vapor_simple_disdup_Vapor;
static PyObject *__pyx_n_s_vapor_simple_ins_Vapor;
static PyObject *__pyx_n_s_vapor_simple_inv_Vapor;
static PyObject *__pyx_n_s_vapor_simple_tandup_Vapor;
static PyObject *__pyx_n_s_vapor_single_read_score;
static PyObject *__pyx_n_s_vapor_vali_Simple_function;
static PyObject *__pyx_n_s_vapor_vali_plotting;
static PyObject *__pyx_n_s_vcf_info_hash;
static PyObject *__pyx_n_s_vcf_input;
static PyObject *__pyx_n_s_vcf_rec_hash;
static PyObject *__pyx_n_s_vcf_rec_hash_modify;
static PyObject *__pyx_n_s_vcf_rec_hash_new;
static PyObject *__pyx_n_s_vcf_vapor_modify;
static PyObject *__pyx_n_s_vec;
static PyObject *__pyx_n_s_vec2;
static PyObject *__pyx_n_s_vec3;
static PyObject *__pyx_n_s_vec4;
static PyObject *__pyx_n_s_vec_in;
static PyObject *__pyx_n_s_vq;
static PyObject *__pyx_kp_s_vs;
static PyObject *__pyx_n_s_w;
static PyObject *__pyx_n_s_where;
static PyObject *__pyx_n_s_whiten;
static PyObject *__pyx_n_s_whitened;
static PyObject *__pyx_n_s_width;
static PyObject *__pyx_n_s_window_size;
static PyObject *__pyx_n_s_window_size_qc;
static PyObject *__pyx_n_s_window_size_refine;
static PyObject *__pyx_n_s_write_dotdata_to_file;
static PyObject *__pyx_n_s_write_output_initiate;
static PyObject *__pyx_n_s_write_output_main;
static PyObject *__pyx_n_s_x;
static PyObject *__pyx_n_s_x_axis;
static PyObject *__pyx_n_s_x_modify;
static PyObject *__pyx_n_s_x_modify_new;
static PyObject *__pyx_n_s_x_to_x_modify_new;
static PyObject *__pyx_n_s_xlab;
static PyObject *__pyx_n_s_y;
static PyObject *__pyx_n_s_y_axis;
static PyObject *__pyx_n_s_y_x_ratio_list;
static PyObject *__pyx_n_s_ylab;
static PyObject *__pyx_n_s_z;
static PyObject *__pyx_pf_10vapor_vali_15Simple_function_alt_seq_readin(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_ref, PyObject *__pyx_v_info, PyObject *__pyx_v_flank_length); /* proto */
static PyObject *__pyx_pf_10vapor_vali_15Simple_function_2bam_in_decide(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_bam_in, CYTHON_UNUSED PyObject *__pyx_v_bps); /* proto */
static PyObject *__pyx_pf_10vapor_vali_15Simple_function_4block_around_check(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_alt_allele, PyObject *__pyx_v_ref_allele); /* proto */
static PyObject *__pyx_pf_10vapor_vali_15Simple_function_6bp_to_chr_hash(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_bps, PyObject *__pyx_v_chromos, PyObject *__pyx_v_flank_length); /* proto */
static PyObject *__pyx_pf_10vapor_vali_15Simple_function_8bp_to_block_len(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_bp_info); /* proto */
static PyObject *__pyx_pf_10vapor_vali_15Simple_function_10block_modify(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_block, PyObject *__pyx_v_chromos); /* proto */
static PyObject *__pyx_pf_10vapor_vali_15Simple_function_12block_subsplot(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_bp_list, PyObject *__pyx_v_chromos); /* proto */
static PyObject *__pyx_pf_10vapor_vali_15Simple_function_14calcu_log10(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_x); /* proto */
static PyObject *__pyx_pf_10vapor_vali_15Simple_function_16calcu_vapor_single_read_score_abs_dis_m1(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_ref_seq, PyObject *__pyx_v_alt_seq, PyObject *__pyx_v_x, PyObject *__pyx_v_window_size); /* proto */
static PyObject *__pyx_pf_10vapor_vali_15Simple_function_18calcu_vapor_single_read_score_abs_dis_m1b(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_ref_seq, PyObject *__pyx_v_alt_seq, PyObject *__pyx_v_x, PyObject *__pyx_v_window_size); /* proto */
static PyObject *__pyx_pf_10vapor_vali_15Simple_function_20calcu_vapor_single_read_score_directed_dis_m1b(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_ref_seq, PyObject *__pyx_v_alt_seq, PyObject *__pyx_v_x, PyObject *__pyx_v_window_size); /* proto */
static PyObject *__pyx_pf_10vapor_vali_15Simple_function_22calcu_vapor_single_read_score_directed_dis_m1b_not_really(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_ref_seq, PyObject *__pyx_v_alt_seq, PyObject *__pyx_v_x, PyObject *__pyx_v_window_size, PyObject *__pyx_v_ref_bps, PyObject *__pyx_v_alt_bps); /* proto */
static PyObject *__pyx_pf_10vapor_vali_15Simple_function_24calcu_vapor_single_read_score_directed_dis_m1b_redefine_diagnal(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_ref_seq, PyObject *__pyx_v_alt_seq, PyObject *__pyx_v_x, PyObject *__pyx_v_window_size); /* proto */
static PyObject *__pyx_pf_10vapor_vali_15Simple_function_26calcu_vapor_single_read_score_directed_dis_m1b_maybe(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_ref_seq, PyObject *__pyx_v_alt_seq, PyObject *__pyx_v_x, PyObject *__pyx_v_window_size, PyObject *__pyx_v_dup_block_bps); /* proto */
static PyObject *__pyx_pf_10vapor_vali_15Simple_function_28calcu_vapor_single_read_score_within_10Perc_m1b(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_ref_seq, PyObject *__pyx_v_alt_seq, PyObject *__pyx_v_x, PyObject *__pyx_v_window_size); /* proto */
static PyObject *__pyx_pf_10vapor_vali_15Simple_function_30calcu_vapor_single_read_score_abs_dis_m2(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_ref_seq, PyObject *__pyx_v_alt_seq, PyObject *__pyx_v_x, PyObject *__pyx_v_window_size); /* proto */
static PyObject *__pyx_pf_10vapor_vali_15Simple_function_32cigar2alignstart_by_pos(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_cigar, PyObject *__pyx_v_align_start, PyObject *__pyx_v_start, CYTHON_UNUSED PyObject *__pyx_v_end); /* proto */
static PyObject *__pyx_pf_10vapor_vali_15Simple_function_34chop_pacbio_read_by_pos(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_bam_in_new, PyObject *__pyx_v_chrom, PyObject *__pyx_v_start, PyObject *__pyx_v_end, PyObject *__pyx_v_flank_length); /* proto */
static PyObject *__pyx_pf_10vapor_vali_15Simple_function_36chromos_readin(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_ref); /* proto */
static PyObject *__pyx_pf_10vapor_vali_15Simple_function_38chr_start_end_extract(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_pin); /* proto */
static PyObject *__pyx_pf_10vapor_vali_15Simple_function_40cluster_range_decide(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_other_cluster); /* proto */
static PyObject *__pyx_pf_10vapor_vali_15Simple_function_42cluster_size_decide(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_range_cluster); /* proto */
static PyObject *__pyx_pf_10vapor_vali_15Simple_function_44clean_dotdata_m1(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_ref_dotdata); /* proto */
static PyObject *__pyx_pf_10vapor_vali_15Simple_function_46clean_dotdata_diagnal_m1b(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_ref_dotdata); /* proto */
static PyObject *__pyx_pf_10vapor_vali_15Simple_function_48clean_dotdata_anti_diagnal_m1b(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_ref_dotdata); /* proto */
static PyObject *__pyx_pf_10vapor_vali_15Simple_function_50clean_dotdata_diagnal_and_anti_diagnal(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_ref_dotdata); /* proto */
static PyObject *__pyx_pf_10vapor_vali_15Simple_function_52clean_dotdata_x_and_y(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_list_dotdata); /* proto */
static PyObject *__pyx_pf_10vapor_vali_15Simple_function_54clean_dotdata_m2(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_ref_dotdata); /* proto */
static PyObject *__pyx_pf_10vapor_vali_15Simple_function_56complementary(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_seq); /* proto */
static PyObject *__pyx_pf_10vapor_vali_15Simple_function_58compute_bic(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_kmeans, PyObject *__pyx_v_X); /* proto */
static PyObject *__pyx_pf_10vapor_vali_15Simple_function_60dup_inv_ref_alt_bps_produce(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_sv_info, PyObject *__pyx_v_flank_length, PyObject *__pyx_v_alt_structure); /* proto */
static PyObject *__pyx_pf_10vapor_vali_15Simple_function_62dup_inv_dup_bps_produce(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_sv_info, PyObject *__pyx_v_flank_length, PyObject *__pyx_v_alt_structure); /* proto */
static PyObject *__pyx_pf_10vapor_vali_15Simple_function_64dotdata(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_kmerlen, PyObject *__pyx_v_seq1, PyObject *__pyx_v_seq2); /* proto */
static PyObject *__pyx_pf_10vapor_vali_15Simple_function_66dis_cluster(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_dis_to_diagnal, PyObject *__pyx_v_dis_cff); /* proto */
static PyObject *__pyx_pf_10vapor_vali_15Simple_function_68dis_cluster_2(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_dis_to_diagnal, PyObject *__pyx_v_dis_cff); /* proto */
static PyObject *__pyx_pf_10vapor_vali_15Simple_function_70dis_to_diagnal_most_abundant_defined(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_alt_clean_dotdata); /* proto */
static PyObject *__pyx_pf_10vapor_vali_15Simple_function_72dot_to_line(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_list_dotdata, PyObject *__pyx_v_gap, PyObject *__pyx_v_length); /* proto */
static PyObject *__pyx_pf_10vapor_vali_15Simple_function_74dup_block_combine(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_dup_block, CYTHON_UNUSED PyObject *__pyx_v_k1_hap, PyObject *__pyx_v_k2_hap); /* proto */
static PyObject *__pyx_pf_10vapor_vali_15Simple_function_76dup_block_combined_qc(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_all_combines); /* proto */
static PyObject *__pyx_pf_10vapor_vali_15Simple_function_78dup_block_kept_qc(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_kept_dup); /* proto */
static PyObject *__pyx_pf_10vapor_vali_15Simple_function_80dup_let_recombind(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_vec_in); /* proto */
static PyObject *__pyx_pf_10vapor_vali_15Simple_function_82editDistance(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_seq1, PyObject *__pyx_v_seq2, PyObject *__pyx_v_cost_matrix, PyObject *__pyx_v_move_matrix, PyObject *__pyx_v_r, PyObject *__pyx_v_c); /* proto */
static PyObject *__pyx_pf_10vapor_vali_15Simple_function_84edit_dis_setup(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_seq1, PyObject *__pyx_v_seq2); /* proto */
static PyObject *__pyx_pf_10vapor_vali_15Simple_function_86eu_dis_abs_calcu(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_ref_clean_dotdata); /* proto */
static PyObject *__pyx_pf_10vapor_vali_15Simple_function_88eu_dis_single_dot(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_dot_pos); /* proto */
static PyObject *__pyx_pf_10vapor_vali_15Simple_function_90eu_dis_dir_calcu(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_list_dotdata); /* proto */
static PyObject *__pyx_pf_10vapor_vali_15Simple_function_92eu_dis_reg_calcu(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_list_dotdata); /* proto */
static PyObject *__pyx_pf_10vapor_vali_15Simple_function_94eu_dis_dots_within_10perc(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_ref_clean_dotdata); /* proto */
static PyObject *__pyx_pf_10vapor_vali_15Simple_function_96eu_dis_region_calcu(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_list_dotdata, PyObject *__pyx_v_list_bps); /* proto */
static PyObject *__pyx_pf_10vapor_vali_15Simple_function_98eu_dis_reg_dup_block_calcu(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_list_dotdata, PyObject *__pyx_v_dup_block_bps); /* proto */
static PyObject *__pyx_pf_10vapor_vali_15Simple_function_100eu_y_vs_x_ratio_single_dot(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_dot_pos); /* proto */
static PyObject *__pyx_lambda_funcdef_lambda(PyObject *__pyx_self, PyObject *__pyx_v_x); /* proto */
static PyObject *__pyx_pf_10vapor_vali_15Simple_function_102eu_y_vs_x_ratio_calcu(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_ref_clean_dotdata); /* proto */
static PyObject *__pyx_pf_10vapor_vali_15Simple_function_104find_longest_list(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_list_set); /* proto */
static PyObject *__pyx_pf_10vapor_vali_15Simple_function_106flank_length_calculate(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_bps); /* proto */
static PyObject *__pyx_pf_10vapor_vali_15Simple_function_108genoCN_extract(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_pin); /* proto */
static PyObject *__pyx_pf_10vapor_vali_15Simple_function_110genotype_extract(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_pin); /* proto */
static PyObject *__pyx_pf_10vapor_vali_15Simple_function_112INS_length_detect(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_pin); /* proto */
static PyObject *__pyx_pf_10vapor_vali_15Simple_function_114intersect(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_a, PyObject *__pyx_v_b); /* proto */
static PyObject *__pyx_pf_10vapor_vali_15Simple_function_116interval_dis_calcu_max(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_pos_check); /* proto */
static PyObject *__pyx_pf_10vapor_vali_15Simple_function_118kept_lines_size_filter(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_size_list, PyObject *__pyx_v_square_size); /* proto */
static PyObject *__pyx_pf_10vapor_vali_15Simple_function_120k_means_cluster(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_data_list); /* proto */
static PyObject *__pyx_pf_10vapor_vali_15Simple_function_122k_means_cluster_Predict(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_data_list, PyObject *__pyx_v_info); /* proto */
static PyObject *__pyx_pf_10vapor_vali_15Simple_function_124key_modify(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_key); /* proto */
static PyObject *__pyx_pf_10vapor_vali_15Simple_function_126kmerhits(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_seq1, PyObject *__pyx_v_seq2, PyObject *__pyx_v_kmerlen, PyObject *__pyx_v_nth_base, PyObject *__pyx_v_inversions); /* proto */
static PyObject *__pyx_pf_10vapor_vali_15Simple_function_128let_to_block_info(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_let, PyObject *__pyx_v_let_hash, PyObject *__pyx_v_chromos); /* proto */
static PyObject *__pyx_pf_10vapor_vali_15Simple_function_130letter_subgroup(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_k2_hap); /* proto */
static PyObject *__pyx_pf_10vapor_vali_15Simple_function_132letter_split(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_let); /* proto */
static PyObject *__pyx_pf_10vapor_vali_15Simple_function_134list_unify(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_list); /* proto */
static PyObject *__pyx_pf_10vapor_vali_15Simple_function_136make_event_figure_1(CYTHON_UNUSED PyObject *__pyx_self, CYTHON_UNUSED PyObject *__pyx_v_vapor_score_list, PyObject *__pyx_v_best_read_rec, PyObject *__pyx_v_window_size, PyObject *__pyx_v_ref_seq, PyObject *__pyx_v_alt_seq, PyObject *__pyx_v_out_figure_name); /* proto */
static PyObject *__pyx_pf_10vapor_vali_15Simple_function_138minimize_pacbio_read_list(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_x, PyObject *__pyx_v_ideal_list_length); /* proto */
static PyObject *__pyx_pf_10vapor_vali_15Simple_function_140number_cluster(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_dis_to_diagnal_list, PyObject *__pyx_v_dis_range); /* proto */
static PyObject *__pyx_pf_10vapor_vali_15Simple_function_142one_dimention_cluster_by_gap(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_dim1, PyObject *__pyx_v_gap, PyObject *__pyx_v_length); /* proto */
static PyObject *__pyx_pf_10vapor_vali_15Simple_function_144path_mkdir(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_path); /* proto */
static PyObject *__pyx_pf_10vapor_vali_15Simple_function_146path_modify(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_path); /* proto */
static PyObject *__pyx_pf_10vapor_vali_15Simple_function_148polarity_detect(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_pin); /* proto */
static PyObject *__pyx_pf_10vapor_vali_15Simple_function_150qual_check_repetitive_region(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_dotdata_qual_check); /* proto */
static PyObject *__pyx_pf_10vapor_vali_15Simple_function_152reverse(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_seq); /* proto */
static PyObject *__pyx_pf_10vapor_vali_15Simple_function_154ref_ref_deviate_lines_calcu(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_list_dotdata); /* proto */
static PyObject *__pyx_pf_10vapor_vali_15Simple_function_156ref_ref_deviate_lines_describe(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_list_dotdata); /* proto */
static PyObject *__pyx_pf_10vapor_vali_15Simple_function_158ref_deviate_lines_calcu(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_list_dotdata); /* proto */
static PyObject *__pyx_pf_10vapor_vali_15Simple_function_160ref_seq_readin(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_ref, PyObject *__pyx_v_chrom, PyObject *__pyx_v_start, PyObject *__pyx_v_end, PyObject *__pyx_v_reverse_flag); /* proto */
static PyObject *__pyx_pf_10vapor_vali_15Simple_function_162result_organize_ins(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_info_list); /* proto */
static PyObject *__pyx_pf_10vapor_vali_15Simple_function_164simple_del_diploid_decide(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_k1, PyObject *__pyx_v_k2); /* proto */
static PyObject *__pyx_pf_10vapor_vali_15Simple_function_166simple_del_haploid_decide(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_k1_hap, PyObject *__pyx_v_k2_hap); /* proto */
static PyObject *__pyx_pf_10vapor_vali_15Simple_function_168simple_inv_diploid_decide(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_k1, PyObject *__pyx_v_k2); /* proto */
static PyObject *__pyx_pf_10vapor_vali_15Simple_function_170simple_inv_haploid_decide(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_k1_hap, PyObject *__pyx_v_k2_hap); /* proto */
static PyObject *__pyx_pf_10vapor_vali_15Simple_function_172simple_tandup_diploid_decide(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_k1, PyObject *__pyx_v_k2); /* proto */
static PyObject *__pyx_pf_10vapor_vali_15Simple_function_174simple_tandup_haploid_decide(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_k1_hap, PyObject *__pyx_v_k2_hap); /* proto */
static PyObject *__pyx_pf_10vapor_vali_15Simple_function_176simple_disdup_diploid_decide(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_k1, PyObject *__pyx_v_k2); /* proto */
static PyObject *__pyx_pf_10vapor_vali_15Simple_function_178simple_disdup_haploid_decide(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_k1_hap, PyObject *__pyx_v_k2_hap); /* proto */
static PyObject *__pyx_pf_10vapor_vali_15Simple_function_180simple_del_chop_pacbio_read_simple_short(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_bam_in, PyObject *__pyx_v_sv_info, PyObject *__pyx_v_flank_length); /* proto */
static PyObject *__pyx_pf_10vapor_vali_15Simple_function_182simple_chop_pacbio_read_simple_short(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_bam_in, PyObject *__pyx_v_sv_info, PyObject *__pyx_v_flank_length); /* proto */
static PyObject *__pyx_pf_10vapor_vali_15Simple_function_184subkeys(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_key, PyObject *__pyx_v_nth_base, PyObject *__pyx_v_inversions); /* proto */
static PyObject *__pyx_pf_10vapor_vali_15Simple_function_186svtype_extract(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_pin); /* proto */
static PyObject *__pyx_pf_10vapor_vali_15Simple_function_188sv_len_extract(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_pin); /* proto */
static PyObject *__pyx_pf_10vapor_vali_15Simple_function_190sv_seq_extract(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_pin); /* proto */
static PyObject *__pyx_pf_10vapor_vali_15Simple_function_192sv_insert_point_define(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_pin); /* proto */
static PyObject *__pyx_pf_10vapor_vali_15Simple_function_194take_off_symmetric_dots(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_list_dotdata); /* proto */
static PyObject *__pyx_pf_10vapor_vali_15Simple_function_196two_dimention_cluster_by_gap(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_dim1, PyObject *__pyx_v_dim2, PyObject *__pyx_v_gap, PyObject *__pyx_v_length); /* proto */
static PyObject *__pyx_pf_10vapor_vali_15Simple_function_198unify_list(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_list); /* proto */
static PyObject *__pyx_pf_10vapor_vali_15Simple_function_200vapor_CANNOT_CLASSIFY_VapoR(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_bam_in, PyObject *__pyx_v_ref, PyObject *__pyx_v_sv_info, PyObject *__pyx_v_out_figure_name); /* proto */
static PyObject *__pyx_pf_10vapor_vali_15Simple_function_202vapor_del_inv_Vapor(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_bam_in, PyObject *__pyx_v_ref, PyObject *__pyx_v_sv_info, PyObject *__pyx_v_out_figure_name); /* proto */
static PyObject *__pyx_pf_10vapor_vali_15Simple_function_204vapor_dup_inv_VapoR(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_bam_in, PyObject *__pyx_v_ref, PyObject *__pyx_v_sv_info, PyObject *__pyx_v_out_figure_name); /* proto */
static PyObject *__pyx_pf_10vapor_vali_15Simple_function_206vapor_long_del_inv(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_bam_in, PyObject *__pyx_v_ref, PyObject *__pyx_v_sv_info, PyObject *__pyx_v_out_figure_name); /* proto */
static PyObject *__pyx_pf_10vapor_vali_15Simple_function_208vapor_simple_del_Vapor(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_bam_in, PyObject *__pyx_v_ref, PyObject *__pyx_v_sv_info, PyObject *__pyx_v_out_figure_name); /* proto */
static PyObject *__pyx_pf_10vapor_vali_15Simple_function_210vapor_simple_tandup_Vapor(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_bam_in, PyObject *__pyx_v_ref, PyObject *__pyx_v_sv_info, PyObject *__pyx_v_out_figure_name); /* proto */
static PyObject *__pyx_pf_10vapor_vali_15Simple_function_212vapor_simple_disdup_Vapor(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_bam_in, PyObject *__pyx_v_ref, PyObject *__pyx_v_sv_info, PyObject *__pyx_v_out_figure_name); /* proto */
static PyObject *__pyx_pf_10vapor_vali_15Simple_function_214vapor_simple_ins_Vapor(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_bam_in, PyObject *__pyx_v_ref, PyObject *__pyx_v_ins_pos, PyObject *__pyx_v_ins_seq, PyObject *__pyx_v_out_figure_name, PyObject *__pyx_v_POLARITY); /* proto */
static PyObject *__pyx_pf_10vapor_vali_15Simple_function_216vapor_simple_inv_Vapor(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_bam_in, PyObject *__pyx_v_ref, PyObject *__pyx_v_sv_info, PyObject *__pyx_v_out_figure_name); /* proto */
static PyObject *__pyx_pf_10vapor_vali_15Simple_function_218vcf_rec_hash_modify(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_vcf_rec_hash); /* proto */
static PyObject *__pyx_pf_10vapor_vali_15Simple_function_220vcf_vapor_modify(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_vcf_input, PyObject *__pyx_v_vcf_rec_hash_new); /* proto */
static PyObject *__pyx_pf_10vapor_vali_15Simple_function_222window_size_refine(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_seq2, PyObject *__pyx_v_region_QC_Cff); /* proto */
static PyObject *__pyx_pf_10vapor_vali_15Simple_function_224write_dotdata_to_file(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_file_out, PyObject *__pyx_v_dotdata_list); /* proto */
static PyObject *__pyx_pf_10vapor_vali_15Simple_function_226write_output_initiate(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_out_name); /* proto */
static PyObject *__pyx_pf_10vapor_vali_15Simple_function_228write_output_main(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_out_name, PyObject *__pyx_v_out_list); /* proto */
static PyObject *__pyx_pf_10vapor_vali_15Simple_function_230x_to_x_modify_new(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_x, PyObject *__pyx_v_dup_block_combined); /* proto */
static PyObject *__pyx_pf_10vapor_vali_15Simple_function_232X_means_cluster(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_data_list); /* proto */
static PyObject *__pyx_pf_10vapor_vali_15Simple_function_234X_means_cluster_reformat(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_data_list); /* proto */
static PyObject *__pyx_tp_new_10vapor_vali_15Simple_function___pyx_scope_struct__eu_y_vs_x_ratio_calcu(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
static __Pyx_CachedCFunction __pyx_umethod_PyDict_Type_keys = {0, &__pyx_n_s_keys, 0, 0, 0};
static PyObject *__pyx_float_0_1;
static PyObject *__pyx_float_0_3;
static PyObject *__pyx_float_0_4;
static PyObject *__pyx_float_0_5;
static PyObject *__pyx_float_1_0;
static PyObject *__pyx_float_1_1;
static PyObject *__pyx_float_2_1;
static PyObject *__pyx_float_0_15;
static PyObject *__pyx_float_0_16;
static PyObject *__pyx_float_10_0;
static PyObject *__pyx_float_0_0001;
static PyObject *__pyx_float_neg_1_0;
static PyObject *__pyx_int_0;
static PyObject *__pyx_int_1;
static PyObject *__pyx_int_2;
static PyObject *__pyx_int_3;
static PyObject *__pyx_int_4;
static PyObject *__pyx_int_6;
static PyObject *__pyx_int_9;
static PyObject *__pyx_int_10;
static PyObject *__pyx_int_11;
static PyObject *__pyx_int_20;
static PyObject *__pyx_int_30;
static PyObject *__pyx_int_40;
static PyObject *__pyx_int_50;
static PyObject *__pyx_int_97;
static PyObject *__pyx_int_100;
static PyObject *__pyx_int_140;
static PyObject *__pyx_int_400;
static PyObject *__pyx_int_500;
static PyObject *__pyx_int_512;
static PyObject *__pyx_int_4000;
static PyObject *__pyx_int_10000;
static PyObject *__pyx_int_100000000;
static PyObject *__pyx_int_100000000000000000000;
static PyObject *__pyx_int_neg_1;
static PyObject *__pyx_tuple__4;
static PyObject *__pyx_tuple__5;
static PyObject *__pyx_tuple__6;
static PyObject *__pyx_tuple__8;
static PyObject *__pyx_tuple__9;
static PyObject *__pyx_slice__10;
static PyObject *__pyx_slice__22;
static PyObject *__pyx_slice__28;
static PyObject *__pyx_slice__32;
static PyObject *__pyx_slice__35;
static PyObject *__pyx_slice__36;
static PyObject *__pyx_slice__37;
static PyObject *__pyx_slice__40;
static PyObject *__pyx_slice__43;
static PyObject *__pyx_slice__73;
static PyObject *__pyx_slice__78;
static PyObject *__pyx_slice__80;
static PyObject *__pyx_slice__85;
static PyObject *__pyx_slice__93;
static PyObject *__pyx_tuple__11;
static PyObject *__pyx_tuple__12;
static PyObject *__pyx_tuple__13;
static PyObject *__pyx_tuple__15;
static PyObject *__pyx_tuple__16;
static PyObject *__pyx_tuple__17;
static PyObject *__pyx_tuple__18;
static PyObject *__pyx_tuple__20;
static PyObject *__pyx_tuple__21;
static PyObject *__pyx_tuple__23;
static PyObject *__pyx_tuple__27;
static PyObject *__pyx_tuple__30;
static PyObject *__pyx_tuple__31;
static PyObject *__pyx_tuple__33;
static PyObject *__pyx_tuple__34;
static PyObject *__pyx_tuple__39;
static PyObject *__pyx_tuple__41;
static PyObject *__pyx_tuple__42;
static PyObject *__pyx_tuple__44;
static PyObject *__pyx_tuple__46;
static PyObject *__pyx_tuple__49;
static PyObject *__pyx_tuple__50;
static PyObject *__pyx_tuple__51;
static PyObject *__pyx_tuple__52;
static PyObject *__pyx_tuple__53;
static PyObject *__pyx_tuple__54;
static PyObject *__pyx_tuple__55;
static PyObject *__pyx_tuple__56;
static PyObject *__pyx_tuple__57;
static PyObject *__pyx_tuple__58;
static PyObject *__pyx_tuple__59;
static PyObject *__pyx_tuple__60;
static PyObject *__pyx_tuple__61;
static PyObject *__pyx_tuple__62;
static PyObject *__pyx_tuple__63;
static PyObject *__pyx_tuple__64;
static PyObject *__pyx_tuple__65;
static PyObject *__pyx_tuple__66;
static PyObject *__pyx_tuple__67;
static PyObject *__pyx_tuple__68;
static PyObject *__pyx_tuple__69;
static PyObject *__pyx_tuple__70;
static PyObject *__pyx_tuple__71;
static PyObject *__pyx_tuple__72;
static PyObject *__pyx_tuple__74;
static PyObject *__pyx_tuple__75;
static PyObject *__pyx_tuple__76;
static PyObject *__pyx_tuple__77;
static PyObject *__pyx_tuple__79;
static PyObject *__pyx_tuple__81;
static PyObject *__pyx_tuple__82;
static PyObject *__pyx_tuple__84;
static PyObject *__pyx_tuple__86;
static PyObject *__pyx_tuple__87;
static PyObject *__pyx_tuple__88;
static PyObject *__pyx_tuple__89;
static PyObject *__pyx_tuple__90;
static PyObject *__pyx_tuple__91;
static PyObject *__pyx_tuple__92;
static PyObject *__pyx_tuple__94;
static PyObject *__pyx_tuple__95;
static PyObject *__pyx_tuple__96;
static PyObject *__pyx_tuple__97;
static PyObject *__pyx_tuple__98;
static PyObject *__pyx_tuple__99;
static PyObject *__pyx_slice__107;
static PyObject *__pyx_slice__112;
static PyObject *__pyx_slice__113;
static PyObject *__pyx_slice__114;
static PyObject *__pyx_slice__118;
static PyObject *__pyx_slice__120;
static PyObject *__pyx_slice__122;
static PyObject *__pyx_slice__124;
static PyObject *__pyx_slice__126;
static PyObject *__pyx_slice__128;
static PyObject *__pyx_slice__130;
static PyObject *__pyx_slice__131;
static PyObject *__pyx_slice__132;
static PyObject *__pyx_slice__133;
static PyObject *__pyx_slice__134;
static PyObject *__pyx_slice__135;
static PyObject *__pyx_slice__136;
static PyObject *__pyx_slice__137;
static PyObject *__pyx_slice__138;
static PyObject *__pyx_slice__140;
static PyObject *__pyx_slice__144;
static PyObject *__pyx_slice__151;
static PyObject *__pyx_slice__158;
static PyObject *__pyx_tuple__101;
static PyObject *__pyx_tuple__103;
static PyObject *__pyx_tuple__104;
static PyObject *__pyx_tuple__105;
static PyObject *__pyx_tuple__106;
static PyObject *__pyx_tuple__108;
static PyObject *__pyx_tuple__109;
static PyObject *__pyx_tuple__110;
static PyObject *__pyx_tuple__111;
static PyObject *__pyx_tuple__116;
static PyObject *__pyx_tuple__117;
static PyObject *__pyx_tuple__119;
static PyObject *__pyx_tuple__121;
static PyObject *__pyx_tuple__123;
static PyObject *__pyx_tuple__125;
static PyObject *__pyx_tuple__127;
static PyObject *__pyx_tuple__129;
static PyObject *__pyx_tuple__139;
static PyObject *__pyx_tuple__141;
static PyObject *__pyx_tuple__142;
static PyObject *__pyx_tuple__143;
static PyObject *__pyx_tuple__145;
static PyObject *__pyx_tuple__146;
static PyObject *__pyx_tuple__147;
static PyObject *__pyx_tuple__148;
static PyObject *__pyx_tuple__149;
static PyObject *__pyx_tuple__150;
static PyObject *__pyx_tuple__152;
static PyObject *__pyx_tuple__153;
static PyObject *__pyx_tuple__154;
static PyObject *__pyx_tuple__155;
static PyObject *__pyx_tuple__156;
static PyObject *__pyx_tuple__160;
static PyObject *__pyx_tuple__161;
static PyObject *__pyx_tuple__163;
static PyObject *__pyx_tuple__165;
static PyObject *__pyx_tuple__167;
static PyObject *__pyx_tuple__169;
static PyObject *__pyx_tuple__171;
static PyObject *__pyx_tuple__173;
static PyObject *__pyx_tuple__175;
static PyObject *__pyx_tuple__177;
static PyObject *__pyx_tuple__179;
static PyObject *__pyx_tuple__181;
static PyObject *__pyx_tuple__183;
static PyObject *__pyx_tuple__185;
static PyObject *__pyx_tuple__187;
static PyObject *__pyx_tuple__189;
static PyObject *__pyx_tuple__191;
static PyObject *__pyx_tuple__193;
static PyObject *__pyx_tuple__195;
static PyObject *__pyx_tuple__197;
static PyObject *__pyx_tuple__199;
static PyObject *__pyx_tuple__201;
static PyObject *__pyx_tuple__203;
static PyObject *__pyx_tuple__205;
static PyObject *__pyx_tuple__207;
static PyObject *__pyx_tuple__209;
static PyObject *__pyx_tuple__211;
static PyObject *__pyx_tuple__213;
static PyObject *__pyx_tuple__215;
static PyObject *__pyx_tuple__217;
static PyObject *__pyx_tuple__219;
static PyObject *__pyx_tuple__221;
static PyObject *__pyx_tuple__223;
static PyObject *__pyx_tuple__225;
static PyObject *__pyx_tuple__227;
static PyObject *__pyx_tuple__229;
static PyObject *__pyx_tuple__231;
static PyObject *__pyx_tuple__233;
static PyObject *__pyx_tuple__235;
static PyObject *__pyx_tuple__237;
static PyObject *__pyx_tuple__239;
static PyObject *__pyx_tuple__241;
static PyObject *__pyx_tuple__243;
static PyObject *__pyx_tuple__245;
static PyObject *__pyx_tuple__247;
static PyObject *__pyx_tuple__249;
static PyObject *__pyx_tuple__251;
static PyObject *__pyx_tuple__253;
static PyObject *__pyx_tuple__255;
static PyObject *__pyx_tuple__257;
static PyObject *__pyx_tuple__259;
static PyObject *__pyx_tuple__261;
static PyObject *__pyx_tuple__263;
static PyObject *__pyx_tuple__265;
static PyObject *__pyx_tuple__267;
static PyObject *__pyx_tuple__269;
static PyObject *__pyx_tuple__271;
static PyObject *__pyx_tuple__273;
static PyObject *__pyx_tuple__275;
static PyObject *__pyx_tuple__277;
static PyObject *__pyx_tuple__279;
static PyObject *__pyx_tuple__281;
static PyObject *__pyx_tuple__283;
static PyObject *__pyx_tuple__285;
static PyObject *__pyx_tuple__287;
static PyObject *__pyx_tuple__289;
static PyObject *__pyx_tuple__291;
static PyObject *__pyx_tuple__293;
static PyObject *__pyx_tuple__295;
static PyObject *__pyx_tuple__297;
static PyObject *__pyx_tuple__299;
static PyObject *__pyx_tuple__301;
static PyObject *__pyx_tuple__303;
static PyObject *__pyx_tuple__305;
static PyObject *__pyx_tuple__307;
static PyObject *__pyx_tuple__309;
static PyObject *__pyx_tuple__311;
static PyObject *__pyx_tuple__313;
static PyObject *__pyx_tuple__315;
static PyObject *__pyx_tuple__317;
static PyObject *__pyx_tuple__319;
static PyObject *__pyx_tuple__321;
static PyObject *__pyx_tuple__323;
static PyObject *__pyx_tuple__325;
static PyObject *__pyx_tuple__327;
static PyObject *__pyx_tuple__329;
static PyObject *__pyx_tuple__331;
static PyObject *__pyx_tuple__333;
static PyObject *__pyx_tuple__335;
static PyObject *__pyx_tuple__337;
static PyObject *__pyx_tuple__339;
static PyObject *__pyx_tuple__341;
static PyObject *__pyx_tuple__343;
static PyObject *__pyx_tuple__345;
static PyObject *__pyx_tuple__347;
static PyObject *__pyx_tuple__349;
static PyObject *__pyx_tuple__351;
static PyObject *__pyx_tuple__353;
static PyObject *__pyx_tuple__355;
static PyObject *__pyx_tuple__357;
static PyObject *__pyx_tuple__359;
static PyObject *__pyx_tuple__361;
static PyObject *__pyx_tuple__363;
static PyObject *__pyx_tuple__365;
static PyObject *__pyx_tuple__367;
static PyObject *__pyx_tuple__369;
static PyObject *__pyx_tuple__371;
static PyObject *__pyx_tuple__373;
static PyObject *__pyx_tuple__375;
static PyObject *__pyx_tuple__377;
static PyObject *__pyx_tuple__379;
static PyObject *__pyx_tuple__381;
static PyObject *__pyx_tuple__383;
static PyObject *__pyx_tuple__385;
static PyObject *__pyx_tuple__387;
static PyObject *__pyx_tuple__389;
static PyObject *__pyx_tuple__391;
static PyObject *__pyx_tuple__393;
static PyObject *__pyx_tuple__395;
static PyObject *__pyx_tuple__397;
static PyObject *__pyx_codeobj__164;
static PyObject *__pyx_codeobj__166;
static PyObject *__pyx_codeobj__168;
static PyObject *__pyx_codeobj__170;
static PyObject *__pyx_codeobj__172;
static PyObject *__pyx_codeobj__174;
static PyObject *__pyx_codeobj__176;
static PyObject *__pyx_codeobj__178;
static PyObject *__pyx_codeobj__180;
static PyObject *__pyx_codeobj__182;
static PyObject *__pyx_codeobj__184;
static PyObject *__pyx_codeobj__186;
static PyObject *__pyx_codeobj__188;
static PyObject *__pyx_codeobj__190;
static PyObject *__pyx_codeobj__192;
static PyObject *__pyx_codeobj__194;
static PyObject *__pyx_codeobj__196;
static PyObject *__pyx_codeobj__198;
static PyObject *__pyx_codeobj__200;
static PyObject *__pyx_codeobj__202;
static PyObject *__pyx_codeobj__204;
static PyObject *__pyx_codeobj__206;
static PyObject *__pyx_codeobj__208;
static PyObject *__pyx_codeobj__210;
static PyObject *__pyx_codeobj__212;
static PyObject *__pyx_codeobj__214;
static PyObject *__pyx_codeobj__216;
static PyObject *__pyx_codeobj__218;
static PyObject *__pyx_codeobj__220;
static PyObject *__pyx_codeobj__222;
static PyObject *__pyx_codeobj__224;
static PyObject *__pyx_codeobj__226;
static PyObject *__pyx_codeobj__228;
static PyObject *__pyx_codeobj__230;
static PyObject *__pyx_codeobj__232;
static PyObject *__pyx_codeobj__234;
static PyObject *__pyx_codeobj__236;
static PyObject *__pyx_codeobj__238;
static PyObject *__pyx_codeobj__240;
static PyObject *__pyx_codeobj__242;
static PyObject *__pyx_codeobj__244;
static PyObject *__pyx_codeobj__246;
static PyObject *__pyx_codeobj__248;
static PyObject *__pyx_codeobj__250;
static PyObject *__pyx_codeobj__252;
static PyObject *__pyx_codeobj__254;
static PyObject *__pyx_codeobj__256;
static PyObject *__pyx_codeobj__258;
static PyObject *__pyx_codeobj__260;
static PyObject *__pyx_codeobj__262;
static PyObject *__pyx_codeobj__264;
static PyObject *__pyx_codeobj__266;
static PyObject *__pyx_codeobj__268;
static PyObject *__pyx_codeobj__270;
static PyObject *__pyx_codeobj__272;
static PyObject *__pyx_codeobj__274;
static PyObject *__pyx_codeobj__276;
static PyObject *__pyx_codeobj__278;
static PyObject *__pyx_codeobj__280;
static PyObject *__pyx_codeobj__282;
static PyObject *__pyx_codeobj__284;
static PyObject *__pyx_codeobj__286;
static PyObject *__pyx_codeobj__288;
static PyObject *__pyx_codeobj__290;
static PyObject *__pyx_codeobj__292;
static PyObject *__pyx_codeobj__294;
static PyObject *__pyx_codeobj__296;
static PyObject *__pyx_codeobj__298;
static PyObject *__pyx_codeobj__300;
static PyObject *__pyx_codeobj__302;
static PyObject *__pyx_codeobj__304;
static PyObject *__pyx_codeobj__306;
static PyObject *__pyx_codeobj__308;
static PyObject *__pyx_codeobj__310;
static PyObject *__pyx_codeobj__312;
static PyObject *__pyx_codeobj__314;
static PyObject *__pyx_codeobj__316;
static PyObject *__pyx_codeobj__318;
static PyObject *__pyx_codeobj__320;
static PyObject *__pyx_codeobj__322;
static PyObject *__pyx_codeobj__324;
static PyObject *__pyx_codeobj__326;
static PyObject *__pyx_codeobj__328;
static PyObject *__pyx_codeobj__330;
static PyObject *__pyx_codeobj__332;
static PyObject *__pyx_codeobj__334;
static PyObject *__pyx_codeobj__336;
static PyObject *__pyx_codeobj__338;
static PyObject *__pyx_codeobj__340;
static PyObject *__pyx_codeobj__342;
static PyObject *__pyx_codeobj__344;
static PyObject *__pyx_codeobj__346;
static PyObject *__pyx_codeobj__348;
static PyObject *__pyx_codeobj__350;
static PyObject *__pyx_codeobj__352;
static PyObject *__pyx_codeobj__354;
static PyObject *__pyx_codeobj__356;
static PyObject *__pyx_codeobj__358;
static PyObject *__pyx_codeobj__360;
static PyObject *__pyx_codeobj__362;
static PyObject *__pyx_codeobj__364;
static PyObject *__pyx_codeobj__366;
static PyObject *__pyx_codeobj__368;
static PyObject *__pyx_codeobj__370;
static PyObject *__pyx_codeobj__372;
static PyObject *__pyx_codeobj__374;
static PyObject *__pyx_codeobj__376;
static PyObject *__pyx_codeobj__378;
static PyObject *__pyx_codeobj__380;
static PyObject *__pyx_codeobj__382;
static PyObject *__pyx_codeobj__384;
static PyObject *__pyx_codeobj__386;
static PyObject *__pyx_codeobj__388;
static PyObject *__pyx_codeobj__390;
static PyObject *__pyx_codeobj__392;
static PyObject *__pyx_codeobj__394;
static PyObject *__pyx_codeobj__396;
static PyObject *__pyx_codeobj__398;

/* "vapor_vali/Simple_function.pyx":26
 * default_max_sv_test=10000 #when size of a sv block excessed default_max_sv_test, try junctions instead of event
 * 
 * def alt_seq_readin(ref,info,flank_length):             # <<<<<<<<<<<<<<
 *     #eg of info=('abcde/abcde', 'db/db', '1', '14436355', '14436655', '14437075', '14438241', '14438566', '14438940']
 *     block_hash={}
 */

/* Python wrapper */
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_1alt_seq_readin(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_10vapor_vali_15Simple_function_1alt_seq_readin = {"alt_seq_readin", (PyCFunction)__pyx_pw_10vapor_vali_15Simple_function_1alt_seq_readin, METH_VARARGS|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_1alt_seq_readin(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_ref = 0;
  PyObject *__pyx_v_info = 0;
  PyObject *__pyx_v_flank_length = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("alt_seq_readin (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_ref,&__pyx_n_s_info,&__pyx_n_s_flank_length,0};
    PyObject* values[3] = {0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
      switch (pos_args) {
        case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_ref)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_info)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("alt_seq_readin", 1, 3, 3, 1); __PYX_ERR(0, 26, __pyx_L3_error)
        }
        case  2:
        if (likely((values[2] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_flank_length)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("alt_seq_readin", 1, 3, 3, 2); __PYX_ERR(0, 26, __pyx_L3_error)
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "alt_seq_readin") < 0)) __PYX_ERR(0, 26, __pyx_L3_error)
      }
    } else if (PyTuple_GET_SIZE(__pyx_args) != 3) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
    }
    __pyx_v_ref = values[0];
    __pyx_v_info = values[1];
    __pyx_v_flank_length = values[2];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("alt_seq_readin", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 26, __pyx_L3_error)
  __pyx_L3_error:;
  __Pyx_AddTraceback("vapor_vali.Simple_function.alt_seq_readin", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_10vapor_vali_15Simple_function_alt_seq_readin(__pyx_self, __pyx_v_ref, __pyx_v_info, __pyx_v_flank_length);

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10vapor_vali_15Simple_function_alt_seq_readin(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_ref, PyObject *__pyx_v_info, PyObject *__pyx_v_flank_length) {
  PyObject *__pyx_v_block_hash = NULL;
  PyObject *__pyx_v_x = NULL;
  PyObject *__pyx_v_out = NULL;
  PyObject *__pyx_v_rec = NULL;
  PyObject *__pyx_v_temp_x = NULL;
  PyObject *__pyx_v_y = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  Py_ssize_t __pyx_t_2;
  PyObject *__pyx_t_3 = NULL;
  PyObject *(*__pyx_t_4)(PyObject *);
  PyObject *__pyx_t_5 = NULL;
  PyObject *__pyx_t_6 = NULL;
  PyObject *__pyx_t_7 = NULL;
  int __pyx_t_8;
  int __pyx_t_9;
  PyObject *__pyx_t_10 = NULL;
  PyObject *__pyx_t_11 = NULL;
  PyObject *__pyx_t_12 = NULL;
  Py_ssize_t __pyx_t_13;
  PyObject *(*__pyx_t_14)(PyObject *);
  int __pyx_t_15;
  Py_ssize_t __pyx_t_16;
  PyObject *__pyx_t_17 = NULL;
  PyObject *__pyx_t_18 = NULL;
  PyObject *__pyx_t_19 = NULL;
  __Pyx_RefNannySetupContext("alt_seq_readin", 0);

  /* "vapor_vali/Simple_function.pyx":28
 * def alt_seq_readin(ref,info,flank_length):
 *     #eg of info=('abcde/abcde', 'db/db', '1', '14436355', '14436655', '14437075', '14438241', '14438566', '14438940']
 *     block_hash={}             # <<<<<<<<<<<<<<
 *     for x in range(len(info)-4):
 *         block_hash[chr(97+x)]=[info[2],int(info[x+3]),int(info[x+4])]
 */
  __pyx_t_1 = PyDict_New(); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 28, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_block_hash = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":29
 *     #eg of info=('abcde/abcde', 'db/db', '1', '14436355', '14436655', '14437075', '14438241', '14438566', '14438940']
 *     block_hash={}
 *     for x in range(len(info)-4):             # <<<<<<<<<<<<<<
 *         block_hash[chr(97+x)]=[info[2],int(info[x+3]),int(info[x+4])]
 *     block_hash['-']=[block_hash[info[0][0]][0],block_hash[info[0][0]][1]-flank_length,block_hash[info[0][0]][1]]
 */
  __pyx_t_2 = PyObject_Length(__pyx_v_info); if (unlikely(__pyx_t_2 == -1)) __PYX_ERR(0, 29, __pyx_L1_error)
  __pyx_t_1 = PyInt_FromSsize_t((__pyx_t_2 - 4)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 29, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 29, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_GIVEREF(__pyx_t_1);
  PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_t_3, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 29, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  if (likely(PyList_CheckExact(__pyx_t_1)) || PyTuple_CheckExact(__pyx_t_1)) {
    __pyx_t_3 = __pyx_t_1; __Pyx_INCREF(__pyx_t_3); __pyx_t_2 = 0;
    __pyx_t_4 = NULL;
  } else {
    __pyx_t_2 = -1; __pyx_t_3 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 29, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_4 = Py_TYPE(__pyx_t_3)->tp_iternext; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 29, __pyx_L1_error)
  }
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  for (;;) {
    if (likely(!__pyx_t_4)) {
      if (likely(PyList_CheckExact(__pyx_t_3))) {
        if (__pyx_t_2 >= PyList_GET_SIZE(__pyx_t_3)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_1 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_2); __Pyx_INCREF(__pyx_t_1); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 29, __pyx_L1_error)
        #else
        __pyx_t_1 = PySequence_ITEM(__pyx_t_3, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 29, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        #endif
      } else {
        if (__pyx_t_2 >= PyTuple_GET_SIZE(__pyx_t_3)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_2); __Pyx_INCREF(__pyx_t_1); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 29, __pyx_L1_error)
        #else
        __pyx_t_1 = PySequence_ITEM(__pyx_t_3, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 29, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        #endif
      }
    } else {
      __pyx_t_1 = __pyx_t_4(__pyx_t_3);
      if (unlikely(!__pyx_t_1)) {
        PyObject* exc_type = PyErr_Occurred();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
          else __PYX_ERR(0, 29, __pyx_L1_error)
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_1);
    }
    __Pyx_XDECREF_SET(__pyx_v_x, __pyx_t_1);
    __pyx_t_1 = 0;

    /* "vapor_vali/Simple_function.pyx":30
 *     block_hash={}
 *     for x in range(len(info)-4):
 *         block_hash[chr(97+x)]=[info[2],int(info[x+3]),int(info[x+4])]             # <<<<<<<<<<<<<<
 *     block_hash['-']=[block_hash[info[0][0]][0],block_hash[info[0][0]][1]-flank_length,block_hash[info[0][0]][1]]
 *     block_hash['+']=[block_hash[info[0][-1]][0],block_hash[info[0][-1]][2],block_hash[info[0][-1]][2]+flank_length]
 */
    __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_info, 2, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 30, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_5 = __Pyx_PyInt_AddObjC(__pyx_v_x, __pyx_int_3, 3, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 30, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __pyx_t_6 = PyObject_GetItem(__pyx_v_info, __pyx_t_5); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 30, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = __Pyx_PyNumber_Int(__pyx_t_6); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 30, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = __Pyx_PyInt_AddObjC(__pyx_v_x, __pyx_int_4, 4, 0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 30, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __pyx_t_7 = PyObject_GetItem(__pyx_v_info, __pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 30, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = __Pyx_PyNumber_Int(__pyx_t_7); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 30, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_t_7 = PyList_New(3); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 30, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    __Pyx_GIVEREF(__pyx_t_1);
    PyList_SET_ITEM(__pyx_t_7, 0, __pyx_t_1);
    __Pyx_GIVEREF(__pyx_t_5);
    PyList_SET_ITEM(__pyx_t_7, 1, __pyx_t_5);
    __Pyx_GIVEREF(__pyx_t_6);
    PyList_SET_ITEM(__pyx_t_7, 2, __pyx_t_6);
    __pyx_t_1 = 0;
    __pyx_t_5 = 0;
    __pyx_t_6 = 0;
    __pyx_t_6 = __Pyx_PyInt_AddCObj(__pyx_int_97, __pyx_v_x, 97, 0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 30, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 30, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_GIVEREF(__pyx_t_6);
    PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_6);
    __pyx_t_6 = 0;
    __pyx_t_6 = __Pyx_PyObject_Call(__pyx_builtin_chr, __pyx_t_5, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 30, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    if (unlikely(PyDict_SetItem(__pyx_v_block_hash, __pyx_t_6, __pyx_t_7) < 0)) __PYX_ERR(0, 30, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;

    /* "vapor_vali/Simple_function.pyx":29
 *     #eg of info=('abcde/abcde', 'db/db', '1', '14436355', '14436655', '14437075', '14438241', '14438566', '14438940']
 *     block_hash={}
 *     for x in range(len(info)-4):             # <<<<<<<<<<<<<<
 *         block_hash[chr(97+x)]=[info[2],int(info[x+3]),int(info[x+4])]
 *     block_hash['-']=[block_hash[info[0][0]][0],block_hash[info[0][0]][1]-flank_length,block_hash[info[0][0]][1]]
 */
  }
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;

  /* "vapor_vali/Simple_function.pyx":31
 *     for x in range(len(info)-4):
 *         block_hash[chr(97+x)]=[info[2],int(info[x+3]),int(info[x+4])]
 *     block_hash['-']=[block_hash[info[0][0]][0],block_hash[info[0][0]][1]-flank_length,block_hash[info[0][0]][1]]             # <<<<<<<<<<<<<<
 *     block_hash['+']=[block_hash[info[0][-1]][0],block_hash[info[0][-1]][2],block_hash[info[0][-1]][2]+flank_length]
 *     if not info[1].split('/')[0]==info[1].split('/')[1]:
 */
  __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_info, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 31, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_7 = __Pyx_GetItemInt(__pyx_t_3, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 31, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = __Pyx_PyDict_GetItem(__pyx_v_block_hash, __pyx_t_7); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 31, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_7 = __Pyx_GetItemInt(__pyx_t_3, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 31, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_info, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 31, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_6 = __Pyx_GetItemInt(__pyx_t_3, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 31, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = __Pyx_PyDict_GetItem(__pyx_v_block_hash, __pyx_t_6); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 31, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = __Pyx_GetItemInt(__pyx_t_3, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 31, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = PyNumber_Subtract(__pyx_t_6, __pyx_v_flank_length); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 31, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = __Pyx_GetItemInt(__pyx_v_info, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 31, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_5 = __Pyx_GetItemInt(__pyx_t_6, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 31, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = __Pyx_PyDict_GetItem(__pyx_v_block_hash, __pyx_t_5); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 31, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = __Pyx_GetItemInt(__pyx_t_6, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 31, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = PyList_New(3); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 31, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_GIVEREF(__pyx_t_7);
  PyList_SET_ITEM(__pyx_t_6, 0, __pyx_t_7);
  __Pyx_GIVEREF(__pyx_t_3);
  PyList_SET_ITEM(__pyx_t_6, 1, __pyx_t_3);
  __Pyx_GIVEREF(__pyx_t_5);
  PyList_SET_ITEM(__pyx_t_6, 2, __pyx_t_5);
  __pyx_t_7 = 0;
  __pyx_t_3 = 0;
  __pyx_t_5 = 0;
  if (unlikely(PyDict_SetItem(__pyx_v_block_hash, __pyx_kp_s_, __pyx_t_6) < 0)) __PYX_ERR(0, 31, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

  /* "vapor_vali/Simple_function.pyx":32
 *         block_hash[chr(97+x)]=[info[2],int(info[x+3]),int(info[x+4])]
 *     block_hash['-']=[block_hash[info[0][0]][0],block_hash[info[0][0]][1]-flank_length,block_hash[info[0][0]][1]]
 *     block_hash['+']=[block_hash[info[0][-1]][0],block_hash[info[0][-1]][2],block_hash[info[0][-1]][2]+flank_length]             # <<<<<<<<<<<<<<
 *     if not info[1].split('/')[0]==info[1].split('/')[1]:
 *         out=[ref_seq_readin(ref,block_hash['-'][0],block_hash['-'][1],block_hash['-'][2]),ref_seq_readin(ref,block_hash['-'][0],block_hash['-'][1],block_hash['-'][2])]
 */
  __pyx_t_6 = __Pyx_GetItemInt(__pyx_v_info, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 32, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_5 = __Pyx_GetItemInt(__pyx_t_6, -1L, long, 1, __Pyx_PyInt_From_long, 0, 1, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 32, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = __Pyx_PyDict_GetItem(__pyx_v_block_hash, __pyx_t_5); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 32, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = __Pyx_GetItemInt(__pyx_t_6, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 32, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = __Pyx_GetItemInt(__pyx_v_info, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 32, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_3 = __Pyx_GetItemInt(__pyx_t_6, -1L, long, 1, __Pyx_PyInt_From_long, 0, 1, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 32, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = __Pyx_PyDict_GetItem(__pyx_v_block_hash, __pyx_t_3); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 32, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = __Pyx_GetItemInt(__pyx_t_6, 2, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 32, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = __Pyx_GetItemInt(__pyx_v_info, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 32, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_7 = __Pyx_GetItemInt(__pyx_t_6, -1L, long, 1, __Pyx_PyInt_From_long, 0, 1, 1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 32, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = __Pyx_PyDict_GetItem(__pyx_v_block_hash, __pyx_t_7); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 32, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_7 = __Pyx_GetItemInt(__pyx_t_6, 2, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 32, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = PyNumber_Add(__pyx_t_7, __pyx_v_flank_length); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 32, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_7 = PyList_New(3); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 32, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  __Pyx_GIVEREF(__pyx_t_5);
  PyList_SET_ITEM(__pyx_t_7, 0, __pyx_t_5);
  __Pyx_GIVEREF(__pyx_t_3);
  PyList_SET_ITEM(__pyx_t_7, 1, __pyx_t_3);
  __Pyx_GIVEREF(__pyx_t_6);
  PyList_SET_ITEM(__pyx_t_7, 2, __pyx_t_6);
  __pyx_t_5 = 0;
  __pyx_t_3 = 0;
  __pyx_t_6 = 0;
  if (unlikely(PyDict_SetItem(__pyx_v_block_hash, __pyx_kp_s__2, __pyx_t_7) < 0)) __PYX_ERR(0, 32, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;

  /* "vapor_vali/Simple_function.pyx":33
 *     block_hash['-']=[block_hash[info[0][0]][0],block_hash[info[0][0]][1]-flank_length,block_hash[info[0][0]][1]]
 *     block_hash['+']=[block_hash[info[0][-1]][0],block_hash[info[0][-1]][2],block_hash[info[0][-1]][2]+flank_length]
 *     if not info[1].split('/')[0]==info[1].split('/')[1]:             # <<<<<<<<<<<<<<
 *         out=[ref_seq_readin(ref,block_hash['-'][0],block_hash['-'][1],block_hash['-'][2]),ref_seq_readin(ref,block_hash['-'][0],block_hash['-'][1],block_hash['-'][2])]
 *         rec=-1
 */
  __pyx_t_7 = __Pyx_GetItemInt(__pyx_v_info, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 33, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_split); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 33, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_tuple__4, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 33, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = __Pyx_GetItemInt(__pyx_t_7, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 33, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_7 = __Pyx_GetItemInt(__pyx_v_info, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 33, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_split); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 33, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_tuple__5, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 33, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = __Pyx_GetItemInt(__pyx_t_7, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 33, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_7 = PyObject_RichCompare(__pyx_t_6, __pyx_t_3, Py_EQ); __Pyx_XGOTREF(__pyx_t_7); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 33, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_8 = __Pyx_PyObject_IsTrue(__pyx_t_7); if (unlikely(__pyx_t_8 < 0)) __PYX_ERR(0, 33, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_9 = ((!__pyx_t_8) != 0);
  if (__pyx_t_9) {

    /* "vapor_vali/Simple_function.pyx":34
 *     block_hash['+']=[block_hash[info[0][-1]][0],block_hash[info[0][-1]][2],block_hash[info[0][-1]][2]+flank_length]
 *     if not info[1].split('/')[0]==info[1].split('/')[1]:
 *         out=[ref_seq_readin(ref,block_hash['-'][0],block_hash['-'][1],block_hash['-'][2]),ref_seq_readin(ref,block_hash['-'][0],block_hash['-'][1],block_hash['-'][2])]             # <<<<<<<<<<<<<<
 *         rec=-1
 *         for x in info[1].split('/'):
 */
    __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_ref_seq_readin); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 34, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_6 = __Pyx_PyDict_GetItem(__pyx_v_block_hash, __pyx_kp_s_); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 34, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __pyx_t_5 = __Pyx_GetItemInt(__pyx_t_6, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 34, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = __Pyx_PyDict_GetItem(__pyx_v_block_hash, __pyx_kp_s_); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 34, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __pyx_t_1 = __Pyx_GetItemInt(__pyx_t_6, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 34, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = __Pyx_PyDict_GetItem(__pyx_v_block_hash, __pyx_kp_s_); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 34, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __pyx_t_10 = __Pyx_GetItemInt(__pyx_t_6, 2, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 34, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_10);
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = NULL;
    __pyx_t_2 = 0;
    if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_3))) {
      __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_3);
      if (likely(__pyx_t_6)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
        __Pyx_INCREF(__pyx_t_6);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_3, function);
        __pyx_t_2 = 1;
      }
    }
    __pyx_t_11 = PyTuple_New(4+__pyx_t_2); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 34, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_11);
    if (__pyx_t_6) {
      __Pyx_GIVEREF(__pyx_t_6); PyTuple_SET_ITEM(__pyx_t_11, 0, __pyx_t_6); __pyx_t_6 = NULL;
    }
    __Pyx_INCREF(__pyx_v_ref);
    __Pyx_GIVEREF(__pyx_v_ref);
    PyTuple_SET_ITEM(__pyx_t_11, 0+__pyx_t_2, __pyx_v_ref);
    __Pyx_GIVEREF(__pyx_t_5);
    PyTuple_SET_ITEM(__pyx_t_11, 1+__pyx_t_2, __pyx_t_5);
    __Pyx_GIVEREF(__pyx_t_1);
    PyTuple_SET_ITEM(__pyx_t_11, 2+__pyx_t_2, __pyx_t_1);
    __Pyx_GIVEREF(__pyx_t_10);
    PyTuple_SET_ITEM(__pyx_t_11, 3+__pyx_t_2, __pyx_t_10);
    __pyx_t_5 = 0;
    __pyx_t_1 = 0;
    __pyx_t_10 = 0;
    __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_11, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 34, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_11 = __Pyx_GetModuleGlobalName(__pyx_n_s_ref_seq_readin); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 34, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_11);
    __pyx_t_10 = __Pyx_PyDict_GetItem(__pyx_v_block_hash, __pyx_kp_s_); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 34, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_10);
    __pyx_t_1 = __Pyx_GetItemInt(__pyx_t_10, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 34, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
    __pyx_t_10 = __Pyx_PyDict_GetItem(__pyx_v_block_hash, __pyx_kp_s_); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 34, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_10);
    __pyx_t_5 = __Pyx_GetItemInt(__pyx_t_10, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 34, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
    __pyx_t_10 = __Pyx_PyDict_GetItem(__pyx_v_block_hash, __pyx_kp_s_); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 34, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_10);
    __pyx_t_6 = __Pyx_GetItemInt(__pyx_t_10, 2, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 34, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
    __pyx_t_10 = NULL;
    __pyx_t_2 = 0;
    if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_11))) {
      __pyx_t_10 = PyMethod_GET_SELF(__pyx_t_11);
      if (likely(__pyx_t_10)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_11);
        __Pyx_INCREF(__pyx_t_10);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_11, function);
        __pyx_t_2 = 1;
      }
    }
    __pyx_t_12 = PyTuple_New(4+__pyx_t_2); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 34, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_12);
    if (__pyx_t_10) {
      __Pyx_GIVEREF(__pyx_t_10); PyTuple_SET_ITEM(__pyx_t_12, 0, __pyx_t_10); __pyx_t_10 = NULL;
    }
    __Pyx_INCREF(__pyx_v_ref);
    __Pyx_GIVEREF(__pyx_v_ref);
    PyTuple_SET_ITEM(__pyx_t_12, 0+__pyx_t_2, __pyx_v_ref);
    __Pyx_GIVEREF(__pyx_t_1);
    PyTuple_SET_ITEM(__pyx_t_12, 1+__pyx_t_2, __pyx_t_1);
    __Pyx_GIVEREF(__pyx_t_5);
    PyTuple_SET_ITEM(__pyx_t_12, 2+__pyx_t_2, __pyx_t_5);
    __Pyx_GIVEREF(__pyx_t_6);
    PyTuple_SET_ITEM(__pyx_t_12, 3+__pyx_t_2, __pyx_t_6);
    __pyx_t_1 = 0;
    __pyx_t_5 = 0;
    __pyx_t_6 = 0;
    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_11, __pyx_t_12, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 34, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
    __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
    __pyx_t_11 = PyList_New(2); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 34, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_11);
    __Pyx_GIVEREF(__pyx_t_7);
    PyList_SET_ITEM(__pyx_t_11, 0, __pyx_t_7);
    __Pyx_GIVEREF(__pyx_t_3);
    PyList_SET_ITEM(__pyx_t_11, 1, __pyx_t_3);
    __pyx_t_7 = 0;
    __pyx_t_3 = 0;
    __pyx_v_out = ((PyObject*)__pyx_t_11);
    __pyx_t_11 = 0;

    /* "vapor_vali/Simple_function.pyx":35
 *     if not info[1].split('/')[0]==info[1].split('/')[1]:
 *         out=[ref_seq_readin(ref,block_hash['-'][0],block_hash['-'][1],block_hash['-'][2]),ref_seq_readin(ref,block_hash['-'][0],block_hash['-'][1],block_hash['-'][2])]
 *         rec=-1             # <<<<<<<<<<<<<<
 *         for x in info[1].split('/'):
 *             rec+=1
 */
    __Pyx_INCREF(__pyx_int_neg_1);
    __pyx_v_rec = __pyx_int_neg_1;

    /* "vapor_vali/Simple_function.pyx":36
 *         out=[ref_seq_readin(ref,block_hash['-'][0],block_hash['-'][1],block_hash['-'][2]),ref_seq_readin(ref,block_hash['-'][0],block_hash['-'][1],block_hash['-'][2])]
 *         rec=-1
 *         for x in info[1].split('/'):             # <<<<<<<<<<<<<<
 *             rec+=1
 *             temp_x=[]
 */
    __pyx_t_11 = __Pyx_GetItemInt(__pyx_v_info, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 36, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_11);
    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_11, __pyx_n_s_split); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 36, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
    __pyx_t_11 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_tuple__6, NULL); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 36, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_11);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    if (likely(PyList_CheckExact(__pyx_t_11)) || PyTuple_CheckExact(__pyx_t_11)) {
      __pyx_t_3 = __pyx_t_11; __Pyx_INCREF(__pyx_t_3); __pyx_t_2 = 0;
      __pyx_t_4 = NULL;
    } else {
      __pyx_t_2 = -1; __pyx_t_3 = PyObject_GetIter(__pyx_t_11); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 36, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __pyx_t_4 = Py_TYPE(__pyx_t_3)->tp_iternext; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 36, __pyx_L1_error)
    }
    __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
    for (;;) {
      if (likely(!__pyx_t_4)) {
        if (likely(PyList_CheckExact(__pyx_t_3))) {
          if (__pyx_t_2 >= PyList_GET_SIZE(__pyx_t_3)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_11 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_2); __Pyx_INCREF(__pyx_t_11); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 36, __pyx_L1_error)
          #else
          __pyx_t_11 = PySequence_ITEM(__pyx_t_3, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 36, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_11);
          #endif
        } else {
          if (__pyx_t_2 >= PyTuple_GET_SIZE(__pyx_t_3)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_11 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_2); __Pyx_INCREF(__pyx_t_11); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 36, __pyx_L1_error)
          #else
          __pyx_t_11 = PySequence_ITEM(__pyx_t_3, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 36, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_11);
          #endif
        }
      } else {
        __pyx_t_11 = __pyx_t_4(__pyx_t_3);
        if (unlikely(!__pyx_t_11)) {
          PyObject* exc_type = PyErr_Occurred();
          if (exc_type) {
            if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
            else __PYX_ERR(0, 36, __pyx_L1_error)
          }
          break;
        }
        __Pyx_GOTREF(__pyx_t_11);
      }
      __Pyx_XDECREF_SET(__pyx_v_x, __pyx_t_11);
      __pyx_t_11 = 0;

      /* "vapor_vali/Simple_function.pyx":37
 *         rec=-1
 *         for x in info[1].split('/'):
 *             rec+=1             # <<<<<<<<<<<<<<
 *             temp_x=[]
 *             for y in x:
 */
      __pyx_t_11 = __Pyx_PyInt_AddObjC(__pyx_v_rec, __pyx_int_1, 1, 1); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 37, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_11);
      __Pyx_DECREF_SET(__pyx_v_rec, __pyx_t_11);
      __pyx_t_11 = 0;

      /* "vapor_vali/Simple_function.pyx":38
 *         for x in info[1].split('/'):
 *             rec+=1
 *             temp_x=[]             # <<<<<<<<<<<<<<
 *             for y in x:
 *                 if not y=='^':temp_x.append(y)
 */
      __pyx_t_11 = PyList_New(0); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 38, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_11);
      __Pyx_XDECREF_SET(__pyx_v_temp_x, ((PyObject*)__pyx_t_11));
      __pyx_t_11 = 0;

      /* "vapor_vali/Simple_function.pyx":39
 *             rec+=1
 *             temp_x=[]
 *             for y in x:             # <<<<<<<<<<<<<<
 *                 if not y=='^':temp_x.append(y)
 *                 else:    temp_x[-1]+=y
 */
      if (likely(PyList_CheckExact(__pyx_v_x)) || PyTuple_CheckExact(__pyx_v_x)) {
        __pyx_t_11 = __pyx_v_x; __Pyx_INCREF(__pyx_t_11); __pyx_t_13 = 0;
        __pyx_t_14 = NULL;
      } else {
        __pyx_t_13 = -1; __pyx_t_11 = PyObject_GetIter(__pyx_v_x); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 39, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_11);
        __pyx_t_14 = Py_TYPE(__pyx_t_11)->tp_iternext; if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 39, __pyx_L1_error)
      }
      for (;;) {
        if (likely(!__pyx_t_14)) {
          if (likely(PyList_CheckExact(__pyx_t_11))) {
            if (__pyx_t_13 >= PyList_GET_SIZE(__pyx_t_11)) break;
            #if CYTHON_COMPILING_IN_CPYTHON
            __pyx_t_7 = PyList_GET_ITEM(__pyx_t_11, __pyx_t_13); __Pyx_INCREF(__pyx_t_7); __pyx_t_13++; if (unlikely(0 < 0)) __PYX_ERR(0, 39, __pyx_L1_error)
            #else
            __pyx_t_7 = PySequence_ITEM(__pyx_t_11, __pyx_t_13); __pyx_t_13++; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 39, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_7);
            #endif
          } else {
            if (__pyx_t_13 >= PyTuple_GET_SIZE(__pyx_t_11)) break;
            #if CYTHON_COMPILING_IN_CPYTHON
            __pyx_t_7 = PyTuple_GET_ITEM(__pyx_t_11, __pyx_t_13); __Pyx_INCREF(__pyx_t_7); __pyx_t_13++; if (unlikely(0 < 0)) __PYX_ERR(0, 39, __pyx_L1_error)
            #else
            __pyx_t_7 = PySequence_ITEM(__pyx_t_11, __pyx_t_13); __pyx_t_13++; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 39, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_7);
            #endif
          }
        } else {
          __pyx_t_7 = __pyx_t_14(__pyx_t_11);
          if (unlikely(!__pyx_t_7)) {
            PyObject* exc_type = PyErr_Occurred();
            if (exc_type) {
              if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
              else __PYX_ERR(0, 39, __pyx_L1_error)
            }
            break;
          }
          __Pyx_GOTREF(__pyx_t_7);
        }
        __Pyx_XDECREF_SET(__pyx_v_y, __pyx_t_7);
        __pyx_t_7 = 0;

        /* "vapor_vali/Simple_function.pyx":40
 *             temp_x=[]
 *             for y in x:
 *                 if not y=='^':temp_x.append(y)             # <<<<<<<<<<<<<<
 *                 else:    temp_x[-1]+=y
 *             for y in temp_x:
 */
        __pyx_t_9 = (__Pyx_PyString_Equals(__pyx_v_y, __pyx_kp_s__7, Py_EQ)); if (unlikely(__pyx_t_9 < 0)) __PYX_ERR(0, 40, __pyx_L1_error)
        __pyx_t_8 = ((!__pyx_t_9) != 0);
        if (__pyx_t_8) {
          __pyx_t_15 = __Pyx_PyList_Append(__pyx_v_temp_x, __pyx_v_y); if (unlikely(__pyx_t_15 == -1)) __PYX_ERR(0, 40, __pyx_L1_error)
          goto __pyx_L10;
        }

        /* "vapor_vali/Simple_function.pyx":41
 *             for y in x:
 *                 if not y=='^':temp_x.append(y)
 *                 else:    temp_x[-1]+=y             # <<<<<<<<<<<<<<
 *             for y in temp_x:
 *                 if not '^' in y:
 */
        /*else*/ {
          __pyx_t_16 = -1L;
          __pyx_t_7 = __Pyx_GetItemInt_List(__pyx_v_temp_x, __pyx_t_16, Py_ssize_t, 1, PyInt_FromSsize_t, 1, 1, 1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 41, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_7);
          __pyx_t_12 = PyNumber_InPlaceAdd(__pyx_t_7, __pyx_v_y); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 41, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_12);
          __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
          if (unlikely(__Pyx_SetItemInt(__pyx_v_temp_x, __pyx_t_16, __pyx_t_12, Py_ssize_t, 1, PyInt_FromSsize_t, 1, 1, 1) < 0)) __PYX_ERR(0, 41, __pyx_L1_error)
          __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
        }
        __pyx_L10:;

        /* "vapor_vali/Simple_function.pyx":39
 *             rec+=1
 *             temp_x=[]
 *             for y in x:             # <<<<<<<<<<<<<<
 *                 if not y=='^':temp_x.append(y)
 *                 else:    temp_x[-1]+=y
 */
      }
      __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;

      /* "vapor_vali/Simple_function.pyx":42
 *                 if not y=='^':temp_x.append(y)
 *                 else:    temp_x[-1]+=y
 *             for y in temp_x:             # <<<<<<<<<<<<<<
 *                 if not '^' in y:
 *                     out[rec]+=ref_seq_readin(ref,block_hash[y][0],block_hash[y][1],block_hash[y][2])
 */
      __pyx_t_11 = __pyx_v_temp_x; __Pyx_INCREF(__pyx_t_11); __pyx_t_13 = 0;
      for (;;) {
        if (__pyx_t_13 >= PyList_GET_SIZE(__pyx_t_11)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_12 = PyList_GET_ITEM(__pyx_t_11, __pyx_t_13); __Pyx_INCREF(__pyx_t_12); __pyx_t_13++; if (unlikely(0 < 0)) __PYX_ERR(0, 42, __pyx_L1_error)
        #else
        __pyx_t_12 = PySequence_ITEM(__pyx_t_11, __pyx_t_13); __pyx_t_13++; if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 42, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_12);
        #endif
        __Pyx_XDECREF_SET(__pyx_v_y, __pyx_t_12);
        __pyx_t_12 = 0;

        /* "vapor_vali/Simple_function.pyx":43
 *                 else:    temp_x[-1]+=y
 *             for y in temp_x:
 *                 if not '^' in y:             # <<<<<<<<<<<<<<
 *                     out[rec]+=ref_seq_readin(ref,block_hash[y][0],block_hash[y][1],block_hash[y][2])
 *                 else:
 */
        __pyx_t_8 = (__Pyx_PySequence_ContainsTF(__pyx_kp_s__7, __pyx_v_y, Py_NE)); if (unlikely(__pyx_t_8 < 0)) __PYX_ERR(0, 43, __pyx_L1_error)
        __pyx_t_9 = (__pyx_t_8 != 0);
        if (__pyx_t_9) {

          /* "vapor_vali/Simple_function.pyx":44
 *             for y in temp_x:
 *                 if not '^' in y:
 *                     out[rec]+=ref_seq_readin(ref,block_hash[y][0],block_hash[y][1],block_hash[y][2])             # <<<<<<<<<<<<<<
 *                 else:
 *                     out[rec]+=ref_seq_readin(ref,block_hash[y[0]][0],block_hash[y[0]][1],block_hash[y[0]][2],'TRUE')
 */
          __Pyx_INCREF(__pyx_v_rec);
          __pyx_t_12 = __pyx_v_rec;
          __pyx_t_7 = PyObject_GetItem(__pyx_v_out, __pyx_t_12); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 44, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_7);
          __pyx_t_5 = __Pyx_GetModuleGlobalName(__pyx_n_s_ref_seq_readin); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 44, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_5);
          __pyx_t_1 = __Pyx_PyDict_GetItem(__pyx_v_block_hash, __pyx_v_y); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 44, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_1);
          __pyx_t_10 = __Pyx_GetItemInt(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 44, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_10);
          __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
          __pyx_t_1 = __Pyx_PyDict_GetItem(__pyx_v_block_hash, __pyx_v_y); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 44, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_1);
          __pyx_t_17 = __Pyx_GetItemInt(__pyx_t_1, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 44, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_17);
          __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
          __pyx_t_1 = __Pyx_PyDict_GetItem(__pyx_v_block_hash, __pyx_v_y); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 44, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_1);
          __pyx_t_18 = __Pyx_GetItemInt(__pyx_t_1, 2, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 44, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_18);
          __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
          __pyx_t_1 = NULL;
          __pyx_t_16 = 0;
          if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_5))) {
            __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_5);
            if (likely(__pyx_t_1)) {
              PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
              __Pyx_INCREF(__pyx_t_1);
              __Pyx_INCREF(function);
              __Pyx_DECREF_SET(__pyx_t_5, function);
              __pyx_t_16 = 1;
            }
          }
          __pyx_t_19 = PyTuple_New(4+__pyx_t_16); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 44, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_19);
          if (__pyx_t_1) {
            __Pyx_GIVEREF(__pyx_t_1); PyTuple_SET_ITEM(__pyx_t_19, 0, __pyx_t_1); __pyx_t_1 = NULL;
          }
          __Pyx_INCREF(__pyx_v_ref);
          __Pyx_GIVEREF(__pyx_v_ref);
          PyTuple_SET_ITEM(__pyx_t_19, 0+__pyx_t_16, __pyx_v_ref);
          __Pyx_GIVEREF(__pyx_t_10);
          PyTuple_SET_ITEM(__pyx_t_19, 1+__pyx_t_16, __pyx_t_10);
          __Pyx_GIVEREF(__pyx_t_17);
          PyTuple_SET_ITEM(__pyx_t_19, 2+__pyx_t_16, __pyx_t_17);
          __Pyx_GIVEREF(__pyx_t_18);
          PyTuple_SET_ITEM(__pyx_t_19, 3+__pyx_t_16, __pyx_t_18);
          __pyx_t_10 = 0;
          __pyx_t_17 = 0;
          __pyx_t_18 = 0;
          __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_19, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 44, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_6);
          __Pyx_DECREF(__pyx_t_19); __pyx_t_19 = 0;
          __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
          __pyx_t_5 = PyNumber_InPlaceAdd(__pyx_t_7, __pyx_t_6); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 44, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_5);
          __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
          __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
          if (unlikely(PyObject_SetItem(__pyx_v_out, __pyx_t_12, __pyx_t_5) < 0)) __PYX_ERR(0, 44, __pyx_L1_error)
          __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
          __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;

          /* "vapor_vali/Simple_function.pyx":43
 *                 else:    temp_x[-1]+=y
 *             for y in temp_x:
 *                 if not '^' in y:             # <<<<<<<<<<<<<<
 *                     out[rec]+=ref_seq_readin(ref,block_hash[y][0],block_hash[y][1],block_hash[y][2])
 *                 else:
 */
          goto __pyx_L13;
        }

        /* "vapor_vali/Simple_function.pyx":46
 *                     out[rec]+=ref_seq_readin(ref,block_hash[y][0],block_hash[y][1],block_hash[y][2])
 *                 else:
 *                     out[rec]+=ref_seq_readin(ref,block_hash[y[0]][0],block_hash[y[0]][1],block_hash[y[0]][2],'TRUE')             # <<<<<<<<<<<<<<
 *         out[0]+=ref_seq_readin(ref,block_hash['+'][0],block_hash['+'][1],block_hash['+'][2])
 *         out[1]+=ref_seq_readin(ref,block_hash['+'][0],block_hash['+'][1],block_hash['+'][2])
 */
        /*else*/ {
          __Pyx_INCREF(__pyx_v_rec);
          __pyx_t_12 = __pyx_v_rec;
          __pyx_t_5 = PyObject_GetItem(__pyx_v_out, __pyx_t_12); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 46, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_5);
          __pyx_t_7 = __Pyx_GetModuleGlobalName(__pyx_n_s_ref_seq_readin); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 46, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_7);
          __pyx_t_19 = __Pyx_GetItemInt(__pyx_v_y, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 46, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_19);
          __pyx_t_18 = __Pyx_PyDict_GetItem(__pyx_v_block_hash, __pyx_t_19); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 46, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_18);
          __Pyx_DECREF(__pyx_t_19); __pyx_t_19 = 0;
          __pyx_t_19 = __Pyx_GetItemInt(__pyx_t_18, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 46, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_19);
          __Pyx_DECREF(__pyx_t_18); __pyx_t_18 = 0;
          __pyx_t_18 = __Pyx_GetItemInt(__pyx_v_y, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 46, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_18);
          __pyx_t_17 = __Pyx_PyDict_GetItem(__pyx_v_block_hash, __pyx_t_18); if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 46, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_17);
          __Pyx_DECREF(__pyx_t_18); __pyx_t_18 = 0;
          __pyx_t_18 = __Pyx_GetItemInt(__pyx_t_17, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 46, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_18);
          __Pyx_DECREF(__pyx_t_17); __pyx_t_17 = 0;
          __pyx_t_17 = __Pyx_GetItemInt(__pyx_v_y, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 46, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_17);
          __pyx_t_10 = __Pyx_PyDict_GetItem(__pyx_v_block_hash, __pyx_t_17); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 46, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_10);
          __Pyx_DECREF(__pyx_t_17); __pyx_t_17 = 0;
          __pyx_t_17 = __Pyx_GetItemInt(__pyx_t_10, 2, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 46, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_17);
          __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
          __pyx_t_10 = NULL;
          __pyx_t_16 = 0;
          if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_7))) {
            __pyx_t_10 = PyMethod_GET_SELF(__pyx_t_7);
            if (likely(__pyx_t_10)) {
              PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_7);
              __Pyx_INCREF(__pyx_t_10);
              __Pyx_INCREF(function);
              __Pyx_DECREF_SET(__pyx_t_7, function);
              __pyx_t_16 = 1;
            }
          }
          __pyx_t_1 = PyTuple_New(5+__pyx_t_16); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 46, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_1);
          if (__pyx_t_10) {
            __Pyx_GIVEREF(__pyx_t_10); PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_10); __pyx_t_10 = NULL;
          }
          __Pyx_INCREF(__pyx_v_ref);
          __Pyx_GIVEREF(__pyx_v_ref);
          PyTuple_SET_ITEM(__pyx_t_1, 0+__pyx_t_16, __pyx_v_ref);
          __Pyx_GIVEREF(__pyx_t_19);
          PyTuple_SET_ITEM(__pyx_t_1, 1+__pyx_t_16, __pyx_t_19);
          __Pyx_GIVEREF(__pyx_t_18);
          PyTuple_SET_ITEM(__pyx_t_1, 2+__pyx_t_16, __pyx_t_18);
          __Pyx_GIVEREF(__pyx_t_17);
          PyTuple_SET_ITEM(__pyx_t_1, 3+__pyx_t_16, __pyx_t_17);
          __Pyx_INCREF(__pyx_n_s_TRUE);
          __Pyx_GIVEREF(__pyx_n_s_TRUE);
          PyTuple_SET_ITEM(__pyx_t_1, 4+__pyx_t_16, __pyx_n_s_TRUE);
          __pyx_t_19 = 0;
          __pyx_t_18 = 0;
          __pyx_t_17 = 0;
          __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_7, __pyx_t_1, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 46, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_6);
          __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
          __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
          __pyx_t_7 = PyNumber_InPlaceAdd(__pyx_t_5, __pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 46, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_7);
          __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
          __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
          if (unlikely(PyObject_SetItem(__pyx_v_out, __pyx_t_12, __pyx_t_7) < 0)) __PYX_ERR(0, 46, __pyx_L1_error)
          __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
          __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
        }
        __pyx_L13:;

        /* "vapor_vali/Simple_function.pyx":42
 *                 if not y=='^':temp_x.append(y)
 *                 else:    temp_x[-1]+=y
 *             for y in temp_x:             # <<<<<<<<<<<<<<
 *                 if not '^' in y:
 *                     out[rec]+=ref_seq_readin(ref,block_hash[y][0],block_hash[y][1],block_hash[y][2])
 */
      }
      __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;

      /* "vapor_vali/Simple_function.pyx":36
 *         out=[ref_seq_readin(ref,block_hash['-'][0],block_hash['-'][1],block_hash['-'][2]),ref_seq_readin(ref,block_hash['-'][0],block_hash['-'][1],block_hash['-'][2])]
 *         rec=-1
 *         for x in info[1].split('/'):             # <<<<<<<<<<<<<<
 *             rec+=1
 *             temp_x=[]
 */
    }
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;

    /* "vapor_vali/Simple_function.pyx":47
 *                 else:
 *                     out[rec]+=ref_seq_readin(ref,block_hash[y[0]][0],block_hash[y[0]][1],block_hash[y[0]][2],'TRUE')
 *         out[0]+=ref_seq_readin(ref,block_hash['+'][0],block_hash['+'][1],block_hash['+'][2])             # <<<<<<<<<<<<<<
 *         out[1]+=ref_seq_readin(ref,block_hash['+'][0],block_hash['+'][1],block_hash['+'][2])
 *         return out
 */
    __pyx_t_2 = 0;
    __pyx_t_3 = __Pyx_GetItemInt_List(__pyx_v_out, __pyx_t_2, Py_ssize_t, 1, PyInt_FromSsize_t, 1, 1, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 47, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_12 = __Pyx_GetModuleGlobalName(__pyx_n_s_ref_seq_readin); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 47, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_12);
    __pyx_t_7 = __Pyx_PyDict_GetItem(__pyx_v_block_hash, __pyx_kp_s__2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 47, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    __pyx_t_6 = __Pyx_GetItemInt(__pyx_t_7, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 47, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_t_7 = __Pyx_PyDict_GetItem(__pyx_v_block_hash, __pyx_kp_s__2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 47, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    __pyx_t_5 = __Pyx_GetItemInt(__pyx_t_7, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 47, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_t_7 = __Pyx_PyDict_GetItem(__pyx_v_block_hash, __pyx_kp_s__2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 47, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    __pyx_t_1 = __Pyx_GetItemInt(__pyx_t_7, 2, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 47, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_t_7 = NULL;
    __pyx_t_13 = 0;
    if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_12))) {
      __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_12);
      if (likely(__pyx_t_7)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_12);
        __Pyx_INCREF(__pyx_t_7);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_12, function);
        __pyx_t_13 = 1;
      }
    }
    __pyx_t_17 = PyTuple_New(4+__pyx_t_13); if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 47, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_17);
    if (__pyx_t_7) {
      __Pyx_GIVEREF(__pyx_t_7); PyTuple_SET_ITEM(__pyx_t_17, 0, __pyx_t_7); __pyx_t_7 = NULL;
    }
    __Pyx_INCREF(__pyx_v_ref);
    __Pyx_GIVEREF(__pyx_v_ref);
    PyTuple_SET_ITEM(__pyx_t_17, 0+__pyx_t_13, __pyx_v_ref);
    __Pyx_GIVEREF(__pyx_t_6);
    PyTuple_SET_ITEM(__pyx_t_17, 1+__pyx_t_13, __pyx_t_6);
    __Pyx_GIVEREF(__pyx_t_5);
    PyTuple_SET_ITEM(__pyx_t_17, 2+__pyx_t_13, __pyx_t_5);
    __Pyx_GIVEREF(__pyx_t_1);
    PyTuple_SET_ITEM(__pyx_t_17, 3+__pyx_t_13, __pyx_t_1);
    __pyx_t_6 = 0;
    __pyx_t_5 = 0;
    __pyx_t_1 = 0;
    __pyx_t_11 = __Pyx_PyObject_Call(__pyx_t_12, __pyx_t_17, NULL); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 47, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_11);
    __Pyx_DECREF(__pyx_t_17); __pyx_t_17 = 0;
    __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
    __pyx_t_12 = PyNumber_InPlaceAdd(__pyx_t_3, __pyx_t_11); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 47, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_12);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
    if (unlikely(__Pyx_SetItemInt(__pyx_v_out, __pyx_t_2, __pyx_t_12, Py_ssize_t, 1, PyInt_FromSsize_t, 1, 1, 1) < 0)) __PYX_ERR(0, 47, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;

    /* "vapor_vali/Simple_function.pyx":48
 *                     out[rec]+=ref_seq_readin(ref,block_hash[y[0]][0],block_hash[y[0]][1],block_hash[y[0]][2],'TRUE')
 *         out[0]+=ref_seq_readin(ref,block_hash['+'][0],block_hash['+'][1],block_hash['+'][2])
 *         out[1]+=ref_seq_readin(ref,block_hash['+'][0],block_hash['+'][1],block_hash['+'][2])             # <<<<<<<<<<<<<<
 *         return out
 *     else:
 */
    __pyx_t_2 = 1;
    __pyx_t_12 = __Pyx_GetItemInt_List(__pyx_v_out, __pyx_t_2, Py_ssize_t, 1, PyInt_FromSsize_t, 1, 1, 1); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 48, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_12);
    __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_ref_seq_readin); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 48, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_17 = __Pyx_PyDict_GetItem(__pyx_v_block_hash, __pyx_kp_s__2); if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 48, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_17);
    __pyx_t_1 = __Pyx_GetItemInt(__pyx_t_17, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 48, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_17); __pyx_t_17 = 0;
    __pyx_t_17 = __Pyx_PyDict_GetItem(__pyx_v_block_hash, __pyx_kp_s__2); if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 48, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_17);
    __pyx_t_5 = __Pyx_GetItemInt(__pyx_t_17, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 48, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_DECREF(__pyx_t_17); __pyx_t_17 = 0;
    __pyx_t_17 = __Pyx_PyDict_GetItem(__pyx_v_block_hash, __pyx_kp_s__2); if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 48, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_17);
    __pyx_t_6 = __Pyx_GetItemInt(__pyx_t_17, 2, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 48, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __Pyx_DECREF(__pyx_t_17); __pyx_t_17 = 0;
    __pyx_t_17 = NULL;
    __pyx_t_13 = 0;
    if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_3))) {
      __pyx_t_17 = PyMethod_GET_SELF(__pyx_t_3);
      if (likely(__pyx_t_17)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
        __Pyx_INCREF(__pyx_t_17);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_3, function);
        __pyx_t_13 = 1;
      }
    }
    __pyx_t_7 = PyTuple_New(4+__pyx_t_13); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 48, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    if (__pyx_t_17) {
      __Pyx_GIVEREF(__pyx_t_17); PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_17); __pyx_t_17 = NULL;
    }
    __Pyx_INCREF(__pyx_v_ref);
    __Pyx_GIVEREF(__pyx_v_ref);
    PyTuple_SET_ITEM(__pyx_t_7, 0+__pyx_t_13, __pyx_v_ref);
    __Pyx_GIVEREF(__pyx_t_1);
    PyTuple_SET_ITEM(__pyx_t_7, 1+__pyx_t_13, __pyx_t_1);
    __Pyx_GIVEREF(__pyx_t_5);
    PyTuple_SET_ITEM(__pyx_t_7, 2+__pyx_t_13, __pyx_t_5);
    __Pyx_GIVEREF(__pyx_t_6);
    PyTuple_SET_ITEM(__pyx_t_7, 3+__pyx_t_13, __pyx_t_6);
    __pyx_t_1 = 0;
    __pyx_t_5 = 0;
    __pyx_t_6 = 0;
    __pyx_t_11 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_7, NULL); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 48, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_11);
    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = PyNumber_InPlaceAdd(__pyx_t_12, __pyx_t_11); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 48, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
    __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
    if (unlikely(__Pyx_SetItemInt(__pyx_v_out, __pyx_t_2, __pyx_t_3, Py_ssize_t, 1, PyInt_FromSsize_t, 1, 1, 1) < 0)) __PYX_ERR(0, 48, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;

    /* "vapor_vali/Simple_function.pyx":49
 *         out[0]+=ref_seq_readin(ref,block_hash['+'][0],block_hash['+'][1],block_hash['+'][2])
 *         out[1]+=ref_seq_readin(ref,block_hash['+'][0],block_hash['+'][1],block_hash['+'][2])
 *         return out             # <<<<<<<<<<<<<<
 *     else:
 *         out=[ref_seq_readin(ref,block_hash['-'][0],block_hash['-'][1],block_hash['-'][2])]
 */
    __Pyx_XDECREF(__pyx_r);
    __Pyx_INCREF(__pyx_v_out);
    __pyx_r = __pyx_v_out;
    goto __pyx_L0;

    /* "vapor_vali/Simple_function.pyx":33
 *     block_hash['-']=[block_hash[info[0][0]][0],block_hash[info[0][0]][1]-flank_length,block_hash[info[0][0]][1]]
 *     block_hash['+']=[block_hash[info[0][-1]][0],block_hash[info[0][-1]][2],block_hash[info[0][-1]][2]+flank_length]
 *     if not info[1].split('/')[0]==info[1].split('/')[1]:             # <<<<<<<<<<<<<<
 *         out=[ref_seq_readin(ref,block_hash['-'][0],block_hash['-'][1],block_hash['-'][2]),ref_seq_readin(ref,block_hash['-'][0],block_hash['-'][1],block_hash['-'][2])]
 *         rec=-1
 */
  }

  /* "vapor_vali/Simple_function.pyx":51
 *         return out
 *     else:
 *         out=[ref_seq_readin(ref,block_hash['-'][0],block_hash['-'][1],block_hash['-'][2])]             # <<<<<<<<<<<<<<
 *         rec=-1
 *         for x in [info[1].split('/')[0]]:
 */
  /*else*/ {
    __pyx_t_11 = __Pyx_GetModuleGlobalName(__pyx_n_s_ref_seq_readin); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 51, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_11);
    __pyx_t_12 = __Pyx_PyDict_GetItem(__pyx_v_block_hash, __pyx_kp_s_); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 51, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_12);
    __pyx_t_7 = __Pyx_GetItemInt(__pyx_t_12, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 51, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
    __pyx_t_12 = __Pyx_PyDict_GetItem(__pyx_v_block_hash, __pyx_kp_s_); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 51, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_12);
    __pyx_t_6 = __Pyx_GetItemInt(__pyx_t_12, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 51, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
    __pyx_t_12 = __Pyx_PyDict_GetItem(__pyx_v_block_hash, __pyx_kp_s_); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 51, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_12);
    __pyx_t_5 = __Pyx_GetItemInt(__pyx_t_12, 2, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 51, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
    __pyx_t_12 = NULL;
    __pyx_t_2 = 0;
    if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_11))) {
      __pyx_t_12 = PyMethod_GET_SELF(__pyx_t_11);
      if (likely(__pyx_t_12)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_11);
        __Pyx_INCREF(__pyx_t_12);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_11, function);
        __pyx_t_2 = 1;
      }
    }
    __pyx_t_1 = PyTuple_New(4+__pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 51, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    if (__pyx_t_12) {
      __Pyx_GIVEREF(__pyx_t_12); PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_12); __pyx_t_12 = NULL;
    }
    __Pyx_INCREF(__pyx_v_ref);
    __Pyx_GIVEREF(__pyx_v_ref);
    PyTuple_SET_ITEM(__pyx_t_1, 0+__pyx_t_2, __pyx_v_ref);
    __Pyx_GIVEREF(__pyx_t_7);
    PyTuple_SET_ITEM(__pyx_t_1, 1+__pyx_t_2, __pyx_t_7);
    __Pyx_GIVEREF(__pyx_t_6);
    PyTuple_SET_ITEM(__pyx_t_1, 2+__pyx_t_2, __pyx_t_6);
    __Pyx_GIVEREF(__pyx_t_5);
    PyTuple_SET_ITEM(__pyx_t_1, 3+__pyx_t_2, __pyx_t_5);
    __pyx_t_7 = 0;
    __pyx_t_6 = 0;
    __pyx_t_5 = 0;
    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_11, __pyx_t_1, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 51, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
    __pyx_t_11 = PyList_New(1); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 51, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_11);
    __Pyx_GIVEREF(__pyx_t_3);
    PyList_SET_ITEM(__pyx_t_11, 0, __pyx_t_3);
    __pyx_t_3 = 0;
    __pyx_v_out = ((PyObject*)__pyx_t_11);
    __pyx_t_11 = 0;

    /* "vapor_vali/Simple_function.pyx":52
 *     else:
 *         out=[ref_seq_readin(ref,block_hash['-'][0],block_hash['-'][1],block_hash['-'][2])]
 *         rec=-1             # <<<<<<<<<<<<<<
 *         for x in [info[1].split('/')[0]]:
 *             rec+=1
 */
    __Pyx_INCREF(__pyx_int_neg_1);
    __pyx_v_rec = __pyx_int_neg_1;

    /* "vapor_vali/Simple_function.pyx":53
 *         out=[ref_seq_readin(ref,block_hash['-'][0],block_hash['-'][1],block_hash['-'][2])]
 *         rec=-1
 *         for x in [info[1].split('/')[0]]:             # <<<<<<<<<<<<<<
 *             rec+=1
 *             temp_x=[]
 */
    __pyx_t_11 = __Pyx_GetItemInt(__pyx_v_info, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 53, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_11);
    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_11, __pyx_n_s_split); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 53, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
    __pyx_t_11 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_tuple__8, NULL); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 53, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_11);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = __Pyx_GetItemInt(__pyx_t_11, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 53, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
    __pyx_t_11 = PyTuple_New(1); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 53, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_11);
    __Pyx_GIVEREF(__pyx_t_3);
    PyTuple_SET_ITEM(__pyx_t_11, 0, __pyx_t_3);
    __pyx_t_3 = 0;
    __pyx_t_3 = __pyx_t_11; __Pyx_INCREF(__pyx_t_3); __pyx_t_2 = 0;
    __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
    for (;;) {
      if (__pyx_t_2 >= 1) break;
      #if CYTHON_COMPILING_IN_CPYTHON
      __pyx_t_11 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_2); __Pyx_INCREF(__pyx_t_11); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 53, __pyx_L1_error)
      #else
      __pyx_t_11 = PySequence_ITEM(__pyx_t_3, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 53, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_11);
      #endif
      __Pyx_XDECREF_SET(__pyx_v_x, __pyx_t_11);
      __pyx_t_11 = 0;

      /* "vapor_vali/Simple_function.pyx":54
 *         rec=-1
 *         for x in [info[1].split('/')[0]]:
 *             rec+=1             # <<<<<<<<<<<<<<
 *             temp_x=[]
 *             for y in x:
 */
      __pyx_t_11 = __Pyx_PyInt_AddObjC(__pyx_v_rec, __pyx_int_1, 1, 1); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 54, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_11);
      __Pyx_DECREF_SET(__pyx_v_rec, __pyx_t_11);
      __pyx_t_11 = 0;

      /* "vapor_vali/Simple_function.pyx":55
 *         for x in [info[1].split('/')[0]]:
 *             rec+=1
 *             temp_x=[]             # <<<<<<<<<<<<<<
 *             for y in x:
 *                 if not y=='^':temp_x.append(y)
 */
      __pyx_t_11 = PyList_New(0); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 55, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_11);
      __Pyx_XDECREF_SET(__pyx_v_temp_x, ((PyObject*)__pyx_t_11));
      __pyx_t_11 = 0;

      /* "vapor_vali/Simple_function.pyx":56
 *             rec+=1
 *             temp_x=[]
 *             for y in x:             # <<<<<<<<<<<<<<
 *                 if not y=='^':temp_x.append(y)
 *                 else:    temp_x[-1]+=y
 */
      if (likely(PyList_CheckExact(__pyx_v_x)) || PyTuple_CheckExact(__pyx_v_x)) {
        __pyx_t_11 = __pyx_v_x; __Pyx_INCREF(__pyx_t_11); __pyx_t_13 = 0;
        __pyx_t_4 = NULL;
      } else {
        __pyx_t_13 = -1; __pyx_t_11 = PyObject_GetIter(__pyx_v_x); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 56, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_11);
        __pyx_t_4 = Py_TYPE(__pyx_t_11)->tp_iternext; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 56, __pyx_L1_error)
      }
      for (;;) {
        if (likely(!__pyx_t_4)) {
          if (likely(PyList_CheckExact(__pyx_t_11))) {
            if (__pyx_t_13 >= PyList_GET_SIZE(__pyx_t_11)) break;
            #if CYTHON_COMPILING_IN_CPYTHON
            __pyx_t_1 = PyList_GET_ITEM(__pyx_t_11, __pyx_t_13); __Pyx_INCREF(__pyx_t_1); __pyx_t_13++; if (unlikely(0 < 0)) __PYX_ERR(0, 56, __pyx_L1_error)
            #else
            __pyx_t_1 = PySequence_ITEM(__pyx_t_11, __pyx_t_13); __pyx_t_13++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 56, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_1);
            #endif
          } else {
            if (__pyx_t_13 >= PyTuple_GET_SIZE(__pyx_t_11)) break;
            #if CYTHON_COMPILING_IN_CPYTHON
            __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_11, __pyx_t_13); __Pyx_INCREF(__pyx_t_1); __pyx_t_13++; if (unlikely(0 < 0)) __PYX_ERR(0, 56, __pyx_L1_error)
            #else
            __pyx_t_1 = PySequence_ITEM(__pyx_t_11, __pyx_t_13); __pyx_t_13++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 56, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_1);
            #endif
          }
        } else {
          __pyx_t_1 = __pyx_t_4(__pyx_t_11);
          if (unlikely(!__pyx_t_1)) {
            PyObject* exc_type = PyErr_Occurred();
            if (exc_type) {
              if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
              else __PYX_ERR(0, 56, __pyx_L1_error)
            }
            break;
          }
          __Pyx_GOTREF(__pyx_t_1);
        }
        __Pyx_XDECREF_SET(__pyx_v_y, __pyx_t_1);
        __pyx_t_1 = 0;

        /* "vapor_vali/Simple_function.pyx":57
 *             temp_x=[]
 *             for y in x:
 *                 if not y=='^':temp_x.append(y)             # <<<<<<<<<<<<<<
 *                 else:    temp_x[-1]+=y
 *             for y in temp_x:
 */
        __pyx_t_9 = (__Pyx_PyString_Equals(__pyx_v_y, __pyx_kp_s__7, Py_EQ)); if (unlikely(__pyx_t_9 < 0)) __PYX_ERR(0, 57, __pyx_L1_error)
        __pyx_t_8 = ((!__pyx_t_9) != 0);
        if (__pyx_t_8) {
          __pyx_t_15 = __Pyx_PyList_Append(__pyx_v_temp_x, __pyx_v_y); if (unlikely(__pyx_t_15 == -1)) __PYX_ERR(0, 57, __pyx_L1_error)
          goto __pyx_L18;
        }

        /* "vapor_vali/Simple_function.pyx":58
 *             for y in x:
 *                 if not y=='^':temp_x.append(y)
 *                 else:    temp_x[-1]+=y             # <<<<<<<<<<<<<<
 *             for y in temp_x:
 *                 if not '^' in y:
 */
        /*else*/ {
          __pyx_t_16 = -1L;
          __pyx_t_1 = __Pyx_GetItemInt_List(__pyx_v_temp_x, __pyx_t_16, Py_ssize_t, 1, PyInt_FromSsize_t, 1, 1, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 58, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_1);
          __pyx_t_5 = PyNumber_InPlaceAdd(__pyx_t_1, __pyx_v_y); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 58, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_5);
          __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
          if (unlikely(__Pyx_SetItemInt(__pyx_v_temp_x, __pyx_t_16, __pyx_t_5, Py_ssize_t, 1, PyInt_FromSsize_t, 1, 1, 1) < 0)) __PYX_ERR(0, 58, __pyx_L1_error)
          __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
        }
        __pyx_L18:;

        /* "vapor_vali/Simple_function.pyx":56
 *             rec+=1
 *             temp_x=[]
 *             for y in x:             # <<<<<<<<<<<<<<
 *                 if not y=='^':temp_x.append(y)
 *                 else:    temp_x[-1]+=y
 */
      }
      __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;

      /* "vapor_vali/Simple_function.pyx":59
 *                 if not y=='^':temp_x.append(y)
 *                 else:    temp_x[-1]+=y
 *             for y in temp_x:             # <<<<<<<<<<<<<<
 *                 if not '^' in y:
 *                     out[rec]+=ref_seq_readin(ref,block_hash[y][0],block_hash[y][1],block_hash[y][2])
 */
      __pyx_t_11 = __pyx_v_temp_x; __Pyx_INCREF(__pyx_t_11); __pyx_t_13 = 0;
      for (;;) {
        if (__pyx_t_13 >= PyList_GET_SIZE(__pyx_t_11)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_5 = PyList_GET_ITEM(__pyx_t_11, __pyx_t_13); __Pyx_INCREF(__pyx_t_5); __pyx_t_13++; if (unlikely(0 < 0)) __PYX_ERR(0, 59, __pyx_L1_error)
        #else
        __pyx_t_5 = PySequence_ITEM(__pyx_t_11, __pyx_t_13); __pyx_t_13++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 59, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_5);
        #endif
        __Pyx_XDECREF_SET(__pyx_v_y, __pyx_t_5);
        __pyx_t_5 = 0;

        /* "vapor_vali/Simple_function.pyx":60
 *                 else:    temp_x[-1]+=y
 *             for y in temp_x:
 *                 if not '^' in y:             # <<<<<<<<<<<<<<
 *                     out[rec]+=ref_seq_readin(ref,block_hash[y][0],block_hash[y][1],block_hash[y][2])
 *                 else:
 */
        __pyx_t_8 = (__Pyx_PySequence_ContainsTF(__pyx_kp_s__7, __pyx_v_y, Py_NE)); if (unlikely(__pyx_t_8 < 0)) __PYX_ERR(0, 60, __pyx_L1_error)
        __pyx_t_9 = (__pyx_t_8 != 0);
        if (__pyx_t_9) {

          /* "vapor_vali/Simple_function.pyx":61
 *             for y in temp_x:
 *                 if not '^' in y:
 *                     out[rec]+=ref_seq_readin(ref,block_hash[y][0],block_hash[y][1],block_hash[y][2])             # <<<<<<<<<<<<<<
 *                 else:
 *                     out[rec]+=ref_seq_readin(ref,block_hash[y[0]][0],block_hash[y[0]][1],block_hash[y[0]][2],'TRUE')
 */
          __Pyx_INCREF(__pyx_v_rec);
          __pyx_t_5 = __pyx_v_rec;
          __pyx_t_1 = PyObject_GetItem(__pyx_v_out, __pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 61, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_1);
          __pyx_t_7 = __Pyx_GetModuleGlobalName(__pyx_n_s_ref_seq_readin); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 61, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_7);
          __pyx_t_12 = __Pyx_PyDict_GetItem(__pyx_v_block_hash, __pyx_v_y); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 61, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_12);
          __pyx_t_17 = __Pyx_GetItemInt(__pyx_t_12, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 61, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_17);
          __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
          __pyx_t_12 = __Pyx_PyDict_GetItem(__pyx_v_block_hash, __pyx_v_y); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 61, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_12);
          __pyx_t_18 = __Pyx_GetItemInt(__pyx_t_12, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 61, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_18);
          __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
          __pyx_t_12 = __Pyx_PyDict_GetItem(__pyx_v_block_hash, __pyx_v_y); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 61, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_12);
          __pyx_t_19 = __Pyx_GetItemInt(__pyx_t_12, 2, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 61, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_19);
          __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
          __pyx_t_12 = NULL;
          __pyx_t_16 = 0;
          if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_7))) {
            __pyx_t_12 = PyMethod_GET_SELF(__pyx_t_7);
            if (likely(__pyx_t_12)) {
              PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_7);
              __Pyx_INCREF(__pyx_t_12);
              __Pyx_INCREF(function);
              __Pyx_DECREF_SET(__pyx_t_7, function);
              __pyx_t_16 = 1;
            }
          }
          __pyx_t_10 = PyTuple_New(4+__pyx_t_16); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 61, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_10);
          if (__pyx_t_12) {
            __Pyx_GIVEREF(__pyx_t_12); PyTuple_SET_ITEM(__pyx_t_10, 0, __pyx_t_12); __pyx_t_12 = NULL;
          }
          __Pyx_INCREF(__pyx_v_ref);
          __Pyx_GIVEREF(__pyx_v_ref);
          PyTuple_SET_ITEM(__pyx_t_10, 0+__pyx_t_16, __pyx_v_ref);
          __Pyx_GIVEREF(__pyx_t_17);
          PyTuple_SET_ITEM(__pyx_t_10, 1+__pyx_t_16, __pyx_t_17);
          __Pyx_GIVEREF(__pyx_t_18);
          PyTuple_SET_ITEM(__pyx_t_10, 2+__pyx_t_16, __pyx_t_18);
          __Pyx_GIVEREF(__pyx_t_19);
          PyTuple_SET_ITEM(__pyx_t_10, 3+__pyx_t_16, __pyx_t_19);
          __pyx_t_17 = 0;
          __pyx_t_18 = 0;
          __pyx_t_19 = 0;
          __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_7, __pyx_t_10, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 61, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_6);
          __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
          __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
          __pyx_t_7 = PyNumber_InPlaceAdd(__pyx_t_1, __pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 61, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_7);
          __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
          __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
          if (unlikely(PyObject_SetItem(__pyx_v_out, __pyx_t_5, __pyx_t_7) < 0)) __PYX_ERR(0, 61, __pyx_L1_error)
          __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
          __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;

          /* "vapor_vali/Simple_function.pyx":60
 *                 else:    temp_x[-1]+=y
 *             for y in temp_x:
 *                 if not '^' in y:             # <<<<<<<<<<<<<<
 *                     out[rec]+=ref_seq_readin(ref,block_hash[y][0],block_hash[y][1],block_hash[y][2])
 *                 else:
 */
          goto __pyx_L21;
        }

        /* "vapor_vali/Simple_function.pyx":63
 *                     out[rec]+=ref_seq_readin(ref,block_hash[y][0],block_hash[y][1],block_hash[y][2])
 *                 else:
 *                     out[rec]+=ref_seq_readin(ref,block_hash[y[0]][0],block_hash[y[0]][1],block_hash[y[0]][2],'TRUE')             # <<<<<<<<<<<<<<
 *         out[0]+=ref_seq_readin(ref,block_hash['+'][0],block_hash['+'][1],block_hash['+'][2])
 *         return [out[0],out[0]]
 */
        /*else*/ {
          __Pyx_INCREF(__pyx_v_rec);
          __pyx_t_5 = __pyx_v_rec;
          __pyx_t_7 = PyObject_GetItem(__pyx_v_out, __pyx_t_5); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 63, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_7);
          __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_ref_seq_readin); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 63, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_1);
          __pyx_t_10 = __Pyx_GetItemInt(__pyx_v_y, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 63, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_10);
          __pyx_t_19 = __Pyx_PyDict_GetItem(__pyx_v_block_hash, __pyx_t_10); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 63, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_19);
          __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
          __pyx_t_10 = __Pyx_GetItemInt(__pyx_t_19, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 63, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_10);
          __Pyx_DECREF(__pyx_t_19); __pyx_t_19 = 0;
          __pyx_t_19 = __Pyx_GetItemInt(__pyx_v_y, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 63, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_19);
          __pyx_t_18 = __Pyx_PyDict_GetItem(__pyx_v_block_hash, __pyx_t_19); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 63, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_18);
          __Pyx_DECREF(__pyx_t_19); __pyx_t_19 = 0;
          __pyx_t_19 = __Pyx_GetItemInt(__pyx_t_18, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 63, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_19);
          __Pyx_DECREF(__pyx_t_18); __pyx_t_18 = 0;
          __pyx_t_18 = __Pyx_GetItemInt(__pyx_v_y, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 63, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_18);
          __pyx_t_17 = __Pyx_PyDict_GetItem(__pyx_v_block_hash, __pyx_t_18); if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 63, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_17);
          __Pyx_DECREF(__pyx_t_18); __pyx_t_18 = 0;
          __pyx_t_18 = __Pyx_GetItemInt(__pyx_t_17, 2, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 63, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_18);
          __Pyx_DECREF(__pyx_t_17); __pyx_t_17 = 0;
          __pyx_t_17 = NULL;
          __pyx_t_16 = 0;
          if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_1))) {
            __pyx_t_17 = PyMethod_GET_SELF(__pyx_t_1);
            if (likely(__pyx_t_17)) {
              PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
              __Pyx_INCREF(__pyx_t_17);
              __Pyx_INCREF(function);
              __Pyx_DECREF_SET(__pyx_t_1, function);
              __pyx_t_16 = 1;
            }
          }
          __pyx_t_12 = PyTuple_New(5+__pyx_t_16); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 63, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_12);
          if (__pyx_t_17) {
            __Pyx_GIVEREF(__pyx_t_17); PyTuple_SET_ITEM(__pyx_t_12, 0, __pyx_t_17); __pyx_t_17 = NULL;
          }
          __Pyx_INCREF(__pyx_v_ref);
          __Pyx_GIVEREF(__pyx_v_ref);
          PyTuple_SET_ITEM(__pyx_t_12, 0+__pyx_t_16, __pyx_v_ref);
          __Pyx_GIVEREF(__pyx_t_10);
          PyTuple_SET_ITEM(__pyx_t_12, 1+__pyx_t_16, __pyx_t_10);
          __Pyx_GIVEREF(__pyx_t_19);
          PyTuple_SET_ITEM(__pyx_t_12, 2+__pyx_t_16, __pyx_t_19);
          __Pyx_GIVEREF(__pyx_t_18);
          PyTuple_SET_ITEM(__pyx_t_12, 3+__pyx_t_16, __pyx_t_18);
          __Pyx_INCREF(__pyx_n_s_TRUE);
          __Pyx_GIVEREF(__pyx_n_s_TRUE);
          PyTuple_SET_ITEM(__pyx_t_12, 4+__pyx_t_16, __pyx_n_s_TRUE);
          __pyx_t_10 = 0;
          __pyx_t_19 = 0;
          __pyx_t_18 = 0;
          __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_12, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 63, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_6);
          __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
          __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
          __pyx_t_1 = PyNumber_InPlaceAdd(__pyx_t_7, __pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 63, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_1);
          __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
          __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
          if (unlikely(PyObject_SetItem(__pyx_v_out, __pyx_t_5, __pyx_t_1) < 0)) __PYX_ERR(0, 63, __pyx_L1_error)
          __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
          __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
        }
        __pyx_L21:;

        /* "vapor_vali/Simple_function.pyx":59
 *                 if not y=='^':temp_x.append(y)
 *                 else:    temp_x[-1]+=y
 *             for y in temp_x:             # <<<<<<<<<<<<<<
 *                 if not '^' in y:
 *                     out[rec]+=ref_seq_readin(ref,block_hash[y][0],block_hash[y][1],block_hash[y][2])
 */
      }
      __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;

      /* "vapor_vali/Simple_function.pyx":53
 *         out=[ref_seq_readin(ref,block_hash['-'][0],block_hash['-'][1],block_hash['-'][2])]
 *         rec=-1
 *         for x in [info[1].split('/')[0]]:             # <<<<<<<<<<<<<<
 *             rec+=1
 *             temp_x=[]
 */
    }
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;

    /* "vapor_vali/Simple_function.pyx":64
 *                 else:
 *                     out[rec]+=ref_seq_readin(ref,block_hash[y[0]][0],block_hash[y[0]][1],block_hash[y[0]][2],'TRUE')
 *         out[0]+=ref_seq_readin(ref,block_hash['+'][0],block_hash['+'][1],block_hash['+'][2])             # <<<<<<<<<<<<<<
 *         return [out[0],out[0]]
 * 
 */
    __pyx_t_2 = 0;
    __pyx_t_3 = __Pyx_GetItemInt_List(__pyx_v_out, __pyx_t_2, Py_ssize_t, 1, PyInt_FromSsize_t, 1, 1, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 64, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_5 = __Pyx_GetModuleGlobalName(__pyx_n_s_ref_seq_readin); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 64, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __pyx_t_1 = __Pyx_PyDict_GetItem(__pyx_v_block_hash, __pyx_kp_s__2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 64, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_6 = __Pyx_GetItemInt(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 64, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = __Pyx_PyDict_GetItem(__pyx_v_block_hash, __pyx_kp_s__2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 64, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_7 = __Pyx_GetItemInt(__pyx_t_1, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 64, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = __Pyx_PyDict_GetItem(__pyx_v_block_hash, __pyx_kp_s__2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 64, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_12 = __Pyx_GetItemInt(__pyx_t_1, 2, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 64, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_12);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = NULL;
    __pyx_t_13 = 0;
    if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_5))) {
      __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_5);
      if (likely(__pyx_t_1)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
        __Pyx_INCREF(__pyx_t_1);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_5, function);
        __pyx_t_13 = 1;
      }
    }
    __pyx_t_18 = PyTuple_New(4+__pyx_t_13); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 64, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_18);
    if (__pyx_t_1) {
      __Pyx_GIVEREF(__pyx_t_1); PyTuple_SET_ITEM(__pyx_t_18, 0, __pyx_t_1); __pyx_t_1 = NULL;
    }
    __Pyx_INCREF(__pyx_v_ref);
    __Pyx_GIVEREF(__pyx_v_ref);
    PyTuple_SET_ITEM(__pyx_t_18, 0+__pyx_t_13, __pyx_v_ref);
    __Pyx_GIVEREF(__pyx_t_6);
    PyTuple_SET_ITEM(__pyx_t_18, 1+__pyx_t_13, __pyx_t_6);
    __Pyx_GIVEREF(__pyx_t_7);
    PyTuple_SET_ITEM(__pyx_t_18, 2+__pyx_t_13, __pyx_t_7);
    __Pyx_GIVEREF(__pyx_t_12);
    PyTuple_SET_ITEM(__pyx_t_18, 3+__pyx_t_13, __pyx_t_12);
    __pyx_t_6 = 0;
    __pyx_t_7 = 0;
    __pyx_t_12 = 0;
    __pyx_t_11 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_18, NULL); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 64, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_11);
    __Pyx_DECREF(__pyx_t_18); __pyx_t_18 = 0;
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = PyNumber_InPlaceAdd(__pyx_t_3, __pyx_t_11); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 64, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
    if (unlikely(__Pyx_SetItemInt(__pyx_v_out, __pyx_t_2, __pyx_t_5, Py_ssize_t, 1, PyInt_FromSsize_t, 1, 1, 1) < 0)) __PYX_ERR(0, 64, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;

    /* "vapor_vali/Simple_function.pyx":65
 *                     out[rec]+=ref_seq_readin(ref,block_hash[y[0]][0],block_hash[y[0]][1],block_hash[y[0]][2],'TRUE')
 *         out[0]+=ref_seq_readin(ref,block_hash['+'][0],block_hash['+'][1],block_hash['+'][2])
 *         return [out[0],out[0]]             # <<<<<<<<<<<<<<
 * 
 * def bam_in_decide(bam_in,bps):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_5 = __Pyx_GetItemInt_List(__pyx_v_out, 0, long, 1, __Pyx_PyInt_From_long, 1, 0, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 65, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __pyx_t_11 = __Pyx_GetItemInt_List(__pyx_v_out, 0, long, 1, __Pyx_PyInt_From_long, 1, 0, 1); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 65, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_11);
    __pyx_t_3 = PyList_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 65, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_GIVEREF(__pyx_t_5);
    PyList_SET_ITEM(__pyx_t_3, 0, __pyx_t_5);
    __Pyx_GIVEREF(__pyx_t_11);
    PyList_SET_ITEM(__pyx_t_3, 1, __pyx_t_11);
    __pyx_t_5 = 0;
    __pyx_t_11 = 0;
    __pyx_r = __pyx_t_3;
    __pyx_t_3 = 0;
    goto __pyx_L0;
  }

  /* "vapor_vali/Simple_function.pyx":26
 * default_max_sv_test=10000 #when size of a sv block excessed default_max_sv_test, try junctions instead of event
 * 
 * def alt_seq_readin(ref,info,flank_length):             # <<<<<<<<<<<<<<
 *     #eg of info=('abcde/abcde', 'db/db', '1', '14436355', '14436655', '14437075', '14438241', '14438566', '14438940']
 *     block_hash={}
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_XDECREF(__pyx_t_7);
  __Pyx_XDECREF(__pyx_t_10);
  __Pyx_XDECREF(__pyx_t_11);
  __Pyx_XDECREF(__pyx_t_12);
  __Pyx_XDECREF(__pyx_t_17);
  __Pyx_XDECREF(__pyx_t_18);
  __Pyx_XDECREF(__pyx_t_19);
  __Pyx_AddTraceback("vapor_vali.Simple_function.alt_seq_readin", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_block_hash);
  __Pyx_XDECREF(__pyx_v_x);
  __Pyx_XDECREF(__pyx_v_out);
  __Pyx_XDECREF(__pyx_v_rec);
  __Pyx_XDECREF(__pyx_v_temp_x);
  __Pyx_XDECREF(__pyx_v_y);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "vapor_vali/Simple_function.pyx":67
 *         return [out[0],out[0]]
 * 
 * def bam_in_decide(bam_in,bps):             # <<<<<<<<<<<<<<
 *     if os.path.isfile(bam_in):
 *         return [bam_in]
 */

/* Python wrapper */
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_3bam_in_decide(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_10vapor_vali_15Simple_function_3bam_in_decide = {"bam_in_decide", (PyCFunction)__pyx_pw_10vapor_vali_15Simple_function_3bam_in_decide, METH_VARARGS|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_3bam_in_decide(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_bam_in = 0;
  CYTHON_UNUSED PyObject *__pyx_v_bps = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("bam_in_decide (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_bam_in,&__pyx_n_s_bps,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_bam_in)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_bps)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("bam_in_decide", 1, 2, 2, 1); __PYX_ERR(0, 67, __pyx_L3_error)
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "bam_in_decide") < 0)) __PYX_ERR(0, 67, __pyx_L3_error)
      }
    } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
    }
    __pyx_v_bam_in = values[0];
    __pyx_v_bps = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("bam_in_decide", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 67, __pyx_L3_error)
  __pyx_L3_error:;
  __Pyx_AddTraceback("vapor_vali.Simple_function.bam_in_decide", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_10vapor_vali_15Simple_function_2bam_in_decide(__pyx_self, __pyx_v_bam_in, __pyx_v_bps);

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10vapor_vali_15Simple_function_2bam_in_decide(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_bam_in, CYTHON_UNUSED PyObject *__pyx_v_bps) {
  PyObject *__pyx_v_temp_bam_in = NULL;
  PyObject *__pyx_v_bam_in_path = NULL;
  PyObject *__pyx_v_bam_in_keys = NULL;
  PyObject *__pyx_v_k1 = NULL;
  PyObject *__pyx_v_flag = NULL;
  PyObject *__pyx_v_y = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  int __pyx_t_5;
  int __pyx_t_6;
  Py_ssize_t __pyx_t_7;
  PyObject *(*__pyx_t_8)(PyObject *);
  Py_ssize_t __pyx_t_9;
  PyObject *(*__pyx_t_10)(PyObject *);
  int __pyx_t_11;
  __Pyx_RefNannySetupContext("bam_in_decide", 0);

  /* "vapor_vali/Simple_function.pyx":68
 * 
 * def bam_in_decide(bam_in,bps):
 *     if os.path.isfile(bam_in):             # <<<<<<<<<<<<<<
 *         return [bam_in]
 *     else:
 */
  __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_os); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 68, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_path); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 68, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_isfile); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 68, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_3);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_2, function);
    }
  }
  if (!__pyx_t_3) {
    __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_v_bam_in); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 68, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
  } else {
    __pyx_t_4 = PyTuple_New(1+1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 68, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_GIVEREF(__pyx_t_3); PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3); __pyx_t_3 = NULL;
    __Pyx_INCREF(__pyx_v_bam_in);
    __Pyx_GIVEREF(__pyx_v_bam_in);
    PyTuple_SET_ITEM(__pyx_t_4, 0+1, __pyx_v_bam_in);
    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_4, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 68, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  }
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 68, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  if (__pyx_t_5) {

    /* "vapor_vali/Simple_function.pyx":69
 * def bam_in_decide(bam_in,bps):
 *     if os.path.isfile(bam_in):
 *         return [bam_in]             # <<<<<<<<<<<<<<
 *     else:
 *         temp_bam_in=[]
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = PyList_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 69, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_INCREF(__pyx_v_bam_in);
    __Pyx_GIVEREF(__pyx_v_bam_in);
    PyList_SET_ITEM(__pyx_t_1, 0, __pyx_v_bam_in);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "vapor_vali/Simple_function.pyx":68
 * 
 * def bam_in_decide(bam_in,bps):
 *     if os.path.isfile(bam_in):             # <<<<<<<<<<<<<<
 *         return [bam_in]
 *     else:
 */
  }

  /* "vapor_vali/Simple_function.pyx":71
 *         return [bam_in]
 *     else:
 *         temp_bam_in=[]             # <<<<<<<<<<<<<<
 *         bam_in_path='/'.join(bam_in.split('/')[:-1])+'/'
 *         if 'XXX' in bam_in.split('/')[-1]:
 */
  /*else*/ {
    __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 71, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_temp_bam_in = ((PyObject*)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "vapor_vali/Simple_function.pyx":72
 *     else:
 *         temp_bam_in=[]
 *         bam_in_path='/'.join(bam_in.split('/')[:-1])+'/'             # <<<<<<<<<<<<<<
 *         if 'XXX' in bam_in.split('/')[-1]:
 *             bam_in_keys=bam_in.split('/')[-1].split('XXX')
 */
    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_bam_in, __pyx_n_s_split); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 72, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_tuple__9, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 72, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = __Pyx_PyObject_GetSlice(__pyx_t_2, 0, -1L, NULL, NULL, &__pyx_slice__10, 0, 1, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 72, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = __Pyx_PyString_Join(__pyx_kp_s__3, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 72, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = PyNumber_Add(__pyx_t_2, __pyx_kp_s__3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 72, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_v_bam_in_path = ((PyObject*)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "vapor_vali/Simple_function.pyx":73
 *         temp_bam_in=[]
 *         bam_in_path='/'.join(bam_in.split('/')[:-1])+'/'
 *         if 'XXX' in bam_in.split('/')[-1]:             # <<<<<<<<<<<<<<
 *             bam_in_keys=bam_in.split('/')[-1].split('XXX')
 *         elif '*' in bam_in.split('/')[-1]:
 */
    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_bam_in, __pyx_n_s_split); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 73, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_tuple__11, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 73, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = __Pyx_GetItemInt(__pyx_t_2, -1L, long, 1, __Pyx_PyInt_From_long, 0, 1, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 73, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_5 = (__Pyx_PySequence_ContainsTF(__pyx_n_s_XXX, __pyx_t_1, Py_EQ)); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 73, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_6 = (__pyx_t_5 != 0);
    if (__pyx_t_6) {

      /* "vapor_vali/Simple_function.pyx":74
 *         bam_in_path='/'.join(bam_in.split('/')[:-1])+'/'
 *         if 'XXX' in bam_in.split('/')[-1]:
 *             bam_in_keys=bam_in.split('/')[-1].split('XXX')             # <<<<<<<<<<<<<<
 *         elif '*' in bam_in.split('/')[-1]:
 *             bam_in_keys=bam_in.split('/')[-1].split('*')
 */
      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_bam_in, __pyx_n_s_split); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 74, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_tuple__12, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 74, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_1 = __Pyx_GetItemInt(__pyx_t_2, -1L, long, 1, __Pyx_PyInt_From_long, 0, 1, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 74, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_split); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 74, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_tuple__13, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 74, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_v_bam_in_keys = __pyx_t_1;
      __pyx_t_1 = 0;

      /* "vapor_vali/Simple_function.pyx":73
 *         temp_bam_in=[]
 *         bam_in_path='/'.join(bam_in.split('/')[:-1])+'/'
 *         if 'XXX' in bam_in.split('/')[-1]:             # <<<<<<<<<<<<<<
 *             bam_in_keys=bam_in.split('/')[-1].split('XXX')
 *         elif '*' in bam_in.split('/')[-1]:
 */
      goto __pyx_L4;
    }

    /* "vapor_vali/Simple_function.pyx":75
 *         if 'XXX' in bam_in.split('/')[-1]:
 *             bam_in_keys=bam_in.split('/')[-1].split('XXX')
 *         elif '*' in bam_in.split('/')[-1]:             # <<<<<<<<<<<<<<
 *             bam_in_keys=bam_in.split('/')[-1].split('*')
 *         else:
 */
    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_bam_in, __pyx_n_s_split); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 75, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_tuple__15, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 75, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = __Pyx_GetItemInt(__pyx_t_2, -1L, long, 1, __Pyx_PyInt_From_long, 0, 1, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 75, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_6 = (__Pyx_PySequence_ContainsTF(__pyx_kp_s__14, __pyx_t_1, Py_EQ)); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 75, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_5 = (__pyx_t_6 != 0);
    if (__pyx_t_5) {

      /* "vapor_vali/Simple_function.pyx":76
 *             bam_in_keys=bam_in.split('/')[-1].split('XXX')
 *         elif '*' in bam_in.split('/')[-1]:
 *             bam_in_keys=bam_in.split('/')[-1].split('*')             # <<<<<<<<<<<<<<
 *         else:
 *             print ('Error: invalid name for pacbio files !')
 */
      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_bam_in, __pyx_n_s_split); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 76, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_tuple__16, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 76, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_1 = __Pyx_GetItemInt(__pyx_t_2, -1L, long, 1, __Pyx_PyInt_From_long, 0, 1, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 76, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_split); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 76, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_tuple__17, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 76, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_v_bam_in_keys = __pyx_t_1;
      __pyx_t_1 = 0;

      /* "vapor_vali/Simple_function.pyx":75
 *         if 'XXX' in bam_in.split('/')[-1]:
 *             bam_in_keys=bam_in.split('/')[-1].split('XXX')
 *         elif '*' in bam_in.split('/')[-1]:             # <<<<<<<<<<<<<<
 *             bam_in_keys=bam_in.split('/')[-1].split('*')
 *         else:
 */
      goto __pyx_L4;
    }

    /* "vapor_vali/Simple_function.pyx":78
 *             bam_in_keys=bam_in.split('/')[-1].split('*')
 *         else:
 *             print ('Error: invalid name for pacbio files !')             # <<<<<<<<<<<<<<
 *         for k1 in os.listdir(bam_in_path):
 *             if k1.split('.')[-1]==bam_in.split('.')[-1]:
 */
    /*else*/ {
      __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_print, __pyx_tuple__18, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 78, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    }
    __pyx_L4:;

    /* "vapor_vali/Simple_function.pyx":79
 *         else:
 *             print ('Error: invalid name for pacbio files !')
 *         for k1 in os.listdir(bam_in_path):             # <<<<<<<<<<<<<<
 *             if k1.split('.')[-1]==bam_in.split('.')[-1]:
 *                 flag=0
 */
    __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_os); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 79, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_listdir); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 79, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_4))) {
      __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_4);
      if (likely(__pyx_t_2)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
        __Pyx_INCREF(__pyx_t_2);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_4, function);
      }
    }
    if (!__pyx_t_2) {
      __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_v_bam_in_path); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 79, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
    } else {
      __pyx_t_3 = PyTuple_New(1+1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 79, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __Pyx_GIVEREF(__pyx_t_2); PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_2); __pyx_t_2 = NULL;
      __Pyx_INCREF(__pyx_v_bam_in_path);
      __Pyx_GIVEREF(__pyx_v_bam_in_path);
      PyTuple_SET_ITEM(__pyx_t_3, 0+1, __pyx_v_bam_in_path);
      __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_3, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 79, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    }
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    if (likely(PyList_CheckExact(__pyx_t_1)) || PyTuple_CheckExact(__pyx_t_1)) {
      __pyx_t_4 = __pyx_t_1; __Pyx_INCREF(__pyx_t_4); __pyx_t_7 = 0;
      __pyx_t_8 = NULL;
    } else {
      __pyx_t_7 = -1; __pyx_t_4 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 79, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_t_8 = Py_TYPE(__pyx_t_4)->tp_iternext; if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 79, __pyx_L1_error)
    }
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    for (;;) {
      if (likely(!__pyx_t_8)) {
        if (likely(PyList_CheckExact(__pyx_t_4))) {
          if (__pyx_t_7 >= PyList_GET_SIZE(__pyx_t_4)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_1 = PyList_GET_ITEM(__pyx_t_4, __pyx_t_7); __Pyx_INCREF(__pyx_t_1); __pyx_t_7++; if (unlikely(0 < 0)) __PYX_ERR(0, 79, __pyx_L1_error)
          #else
          __pyx_t_1 = PySequence_ITEM(__pyx_t_4, __pyx_t_7); __pyx_t_7++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 79, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_1);
          #endif
        } else {
          if (__pyx_t_7 >= PyTuple_GET_SIZE(__pyx_t_4)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_4, __pyx_t_7); __Pyx_INCREF(__pyx_t_1); __pyx_t_7++; if (unlikely(0 < 0)) __PYX_ERR(0, 79, __pyx_L1_error)
          #else
          __pyx_t_1 = PySequence_ITEM(__pyx_t_4, __pyx_t_7); __pyx_t_7++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 79, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_1);
          #endif
        }
      } else {
        __pyx_t_1 = __pyx_t_8(__pyx_t_4);
        if (unlikely(!__pyx_t_1)) {
          PyObject* exc_type = PyErr_Occurred();
          if (exc_type) {
            if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
            else __PYX_ERR(0, 79, __pyx_L1_error)
          }
          break;
        }
        __Pyx_GOTREF(__pyx_t_1);
      }
      __Pyx_XDECREF_SET(__pyx_v_k1, __pyx_t_1);
      __pyx_t_1 = 0;

      /* "vapor_vali/Simple_function.pyx":80
 *             print ('Error: invalid name for pacbio files !')
 *         for k1 in os.listdir(bam_in_path):
 *             if k1.split('.')[-1]==bam_in.split('.')[-1]:             # <<<<<<<<<<<<<<
 *                 flag=0
 *                 for y in bam_in_keys:
 */
      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_k1, __pyx_n_s_split); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 80, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_tuple__20, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 80, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_1 = __Pyx_GetItemInt(__pyx_t_3, -1L, long, 1, __Pyx_PyInt_From_long, 0, 1, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 80, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_bam_in, __pyx_n_s_split); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 80, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_tuple__21, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 80, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_3 = __Pyx_GetItemInt(__pyx_t_2, -1L, long, 1, __Pyx_PyInt_From_long, 0, 1, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 80, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_2 = PyObject_RichCompare(__pyx_t_1, __pyx_t_3, Py_EQ); __Pyx_XGOTREF(__pyx_t_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 80, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 80, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      if (__pyx_t_5) {

        /* "vapor_vali/Simple_function.pyx":81
 *         for k1 in os.listdir(bam_in_path):
 *             if k1.split('.')[-1]==bam_in.split('.')[-1]:
 *                 flag=0             # <<<<<<<<<<<<<<
 *                 for y in bam_in_keys:
 *                     if not y in k1:
 */
        __Pyx_INCREF(__pyx_int_0);
        __Pyx_XDECREF_SET(__pyx_v_flag, __pyx_int_0);

        /* "vapor_vali/Simple_function.pyx":82
 *             if k1.split('.')[-1]==bam_in.split('.')[-1]:
 *                 flag=0
 *                 for y in bam_in_keys:             # <<<<<<<<<<<<<<
 *                     if not y in k1:
 *                         flag+=1
 */
        if (unlikely(!__pyx_v_bam_in_keys)) { __Pyx_RaiseUnboundLocalError("bam_in_keys"); __PYX_ERR(0, 82, __pyx_L1_error) }
        if (likely(PyList_CheckExact(__pyx_v_bam_in_keys)) || PyTuple_CheckExact(__pyx_v_bam_in_keys)) {
          __pyx_t_2 = __pyx_v_bam_in_keys; __Pyx_INCREF(__pyx_t_2); __pyx_t_9 = 0;
          __pyx_t_10 = NULL;
        } else {
          __pyx_t_9 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_v_bam_in_keys); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 82, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_2);
          __pyx_t_10 = Py_TYPE(__pyx_t_2)->tp_iternext; if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 82, __pyx_L1_error)
        }
        for (;;) {
          if (likely(!__pyx_t_10)) {
            if (likely(PyList_CheckExact(__pyx_t_2))) {
              if (__pyx_t_9 >= PyList_GET_SIZE(__pyx_t_2)) break;
              #if CYTHON_COMPILING_IN_CPYTHON
              __pyx_t_3 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_9); __Pyx_INCREF(__pyx_t_3); __pyx_t_9++; if (unlikely(0 < 0)) __PYX_ERR(0, 82, __pyx_L1_error)
              #else
              __pyx_t_3 = PySequence_ITEM(__pyx_t_2, __pyx_t_9); __pyx_t_9++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 82, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_3);
              #endif
            } else {
              if (__pyx_t_9 >= PyTuple_GET_SIZE(__pyx_t_2)) break;
              #if CYTHON_COMPILING_IN_CPYTHON
              __pyx_t_3 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_9); __Pyx_INCREF(__pyx_t_3); __pyx_t_9++; if (unlikely(0 < 0)) __PYX_ERR(0, 82, __pyx_L1_error)
              #else
              __pyx_t_3 = PySequence_ITEM(__pyx_t_2, __pyx_t_9); __pyx_t_9++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 82, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_3);
              #endif
            }
          } else {
            __pyx_t_3 = __pyx_t_10(__pyx_t_2);
            if (unlikely(!__pyx_t_3)) {
              PyObject* exc_type = PyErr_Occurred();
              if (exc_type) {
                if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
                else __PYX_ERR(0, 82, __pyx_L1_error)
              }
              break;
            }
            __Pyx_GOTREF(__pyx_t_3);
          }
          __Pyx_XDECREF_SET(__pyx_v_y, __pyx_t_3);
          __pyx_t_3 = 0;

          /* "vapor_vali/Simple_function.pyx":83
 *                 flag=0
 *                 for y in bam_in_keys:
 *                     if not y in k1:             # <<<<<<<<<<<<<<
 *                         flag+=1
 *                 if flag==0:
 */
          __pyx_t_5 = (__Pyx_PySequence_ContainsTF(__pyx_v_y, __pyx_v_k1, Py_NE)); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 83, __pyx_L1_error)
          __pyx_t_6 = (__pyx_t_5 != 0);
          if (__pyx_t_6) {

            /* "vapor_vali/Simple_function.pyx":84
 *                 for y in bam_in_keys:
 *                     if not y in k1:
 *                         flag+=1             # <<<<<<<<<<<<<<
 *                 if flag==0:
 *                     temp_bam_in.append(bam_in_path+k1)
 */
            __pyx_t_3 = __Pyx_PyInt_AddObjC(__pyx_v_flag, __pyx_int_1, 1, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 84, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_3);
            __Pyx_DECREF_SET(__pyx_v_flag, __pyx_t_3);
            __pyx_t_3 = 0;

            /* "vapor_vali/Simple_function.pyx":83
 *                 flag=0
 *                 for y in bam_in_keys:
 *                     if not y in k1:             # <<<<<<<<<<<<<<
 *                         flag+=1
 *                 if flag==0:
 */
          }

          /* "vapor_vali/Simple_function.pyx":82
 *             if k1.split('.')[-1]==bam_in.split('.')[-1]:
 *                 flag=0
 *                 for y in bam_in_keys:             # <<<<<<<<<<<<<<
 *                     if not y in k1:
 *                         flag+=1
 */
        }
        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

        /* "vapor_vali/Simple_function.pyx":85
 *                     if not y in k1:
 *                         flag+=1
 *                 if flag==0:             # <<<<<<<<<<<<<<
 *                     temp_bam_in.append(bam_in_path+k1)
 *         return temp_bam_in
 */
        __pyx_t_2 = __Pyx_PyInt_EqObjC(__pyx_v_flag, __pyx_int_0, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 85, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
        __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 85, __pyx_L1_error)
        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
        if (__pyx_t_6) {

          /* "vapor_vali/Simple_function.pyx":86
 *                         flag+=1
 *                 if flag==0:
 *                     temp_bam_in.append(bam_in_path+k1)             # <<<<<<<<<<<<<<
 *         return temp_bam_in
 * 
 */
          __pyx_t_2 = PyNumber_Add(__pyx_v_bam_in_path, __pyx_v_k1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 86, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_2);
          __pyx_t_11 = __Pyx_PyList_Append(__pyx_v_temp_bam_in, __pyx_t_2); if (unlikely(__pyx_t_11 == -1)) __PYX_ERR(0, 86, __pyx_L1_error)
          __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

          /* "vapor_vali/Simple_function.pyx":85
 *                     if not y in k1:
 *                         flag+=1
 *                 if flag==0:             # <<<<<<<<<<<<<<
 *                     temp_bam_in.append(bam_in_path+k1)
 *         return temp_bam_in
 */
        }

        /* "vapor_vali/Simple_function.pyx":80
 *             print ('Error: invalid name for pacbio files !')
 *         for k1 in os.listdir(bam_in_path):
 *             if k1.split('.')[-1]==bam_in.split('.')[-1]:             # <<<<<<<<<<<<<<
 *                 flag=0
 *                 for y in bam_in_keys:
 */
      }

      /* "vapor_vali/Simple_function.pyx":79
 *         else:
 *             print ('Error: invalid name for pacbio files !')
 *         for k1 in os.listdir(bam_in_path):             # <<<<<<<<<<<<<<
 *             if k1.split('.')[-1]==bam_in.split('.')[-1]:
 *                 flag=0
 */
    }
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;

    /* "vapor_vali/Simple_function.pyx":87
 *                 if flag==0:
 *                     temp_bam_in.append(bam_in_path+k1)
 *         return temp_bam_in             # <<<<<<<<<<<<<<
 * 
 * def block_around_check(alt_allele,ref_allele):
 */
    __Pyx_XDECREF(__pyx_r);
    __Pyx_INCREF(__pyx_v_temp_bam_in);
    __pyx_r = __pyx_v_temp_bam_in;
    goto __pyx_L0;
  }

  /* "vapor_vali/Simple_function.pyx":67
 *         return [out[0],out[0]]
 * 
 * def bam_in_decide(bam_in,bps):             # <<<<<<<<<<<<<<
 *     if os.path.isfile(bam_in):
 *         return [bam_in]
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_AddTraceback("vapor_vali.Simple_function.bam_in_decide", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_temp_bam_in);
  __Pyx_XDECREF(__pyx_v_bam_in_path);
  __Pyx_XDECREF(__pyx_v_bam_in_keys);
  __Pyx_XDECREF(__pyx_v_k1);
  __Pyx_XDECREF(__pyx_v_flag);
  __Pyx_XDECREF(__pyx_v_y);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "vapor_vali/Simple_function.pyx":89
 *         return temp_bam_in
 * 
 * def block_around_check(alt_allele,ref_allele):             # <<<<<<<<<<<<<<
 *     #eg of alt_allele='abcab'  eg of ref_allele='abcd'
 *     alt_juncs=[[['-']+letter_split(alt_allele)+['+']][0][j:j+2] for j in range(len(letter_split(alt_allele))+1)]
 */

/* Python wrapper */
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_5block_around_check(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_10vapor_vali_15Simple_function_5block_around_check = {"block_around_check", (PyCFunction)__pyx_pw_10vapor_vali_15Simple_function_5block_around_check, METH_VARARGS|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_5block_around_check(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_alt_allele = 0;
  PyObject *__pyx_v_ref_allele = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("block_around_check (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_alt_allele,&__pyx_n_s_ref_allele,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_alt_allele)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_ref_allele)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("block_around_check", 1, 2, 2, 1); __PYX_ERR(0, 89, __pyx_L3_error)
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "block_around_check") < 0)) __PYX_ERR(0, 89, __pyx_L3_error)
      }
    } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
    }
    __pyx_v_alt_allele = values[0];
    __pyx_v_ref_allele = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("block_around_check", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 89, __pyx_L3_error)
  __pyx_L3_error:;
  __Pyx_AddTraceback("vapor_vali.Simple_function.block_around_check", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_10vapor_vali_15Simple_function_4block_around_check(__pyx_self, __pyx_v_alt_allele, __pyx_v_ref_allele);

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10vapor_vali_15Simple_function_4block_around_check(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_alt_allele, PyObject *__pyx_v_ref_allele) {
  PyObject *__pyx_v_alt_juncs = NULL;
  PyObject *__pyx_v_ref_juncs = NULL;
  PyObject *__pyx_v_new_juncs = NULL;
  PyObject *__pyx_v_j = NULL;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  Py_ssize_t __pyx_t_6;
  PyObject *(*__pyx_t_7)(PyObject *);
  PyObject *__pyx_t_8 = NULL;
  PyObject *__pyx_t_9 = NULL;
  int __pyx_t_10;
  int __pyx_t_11;
  __Pyx_RefNannySetupContext("block_around_check", 0);

  /* "vapor_vali/Simple_function.pyx":91
 * def block_around_check(alt_allele,ref_allele):
 *     #eg of alt_allele='abcab'  eg of ref_allele='abcd'
 *     alt_juncs=[[['-']+letter_split(alt_allele)+['+']][0][j:j+2] for j in range(len(letter_split(alt_allele))+1)]             # <<<<<<<<<<<<<<
 *     ref_juncs=[[['-']+letter_split(ref_allele)+['+']][0][j:j+2] for j in range(len(letter_split(alt_allele))+1)]
 *     new_juncs=[i for i in alt_juncs if not i in ref_juncs]
 */
  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 91, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_letter_split); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 91, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_4 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_3))) {
    __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
    if (likely(__pyx_t_4)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
      __Pyx_INCREF(__pyx_t_4);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_3, function);
    }
  }
  if (!__pyx_t_4) {
    __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_v_alt_allele); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 91, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
  } else {
    __pyx_t_5 = PyTuple_New(1+1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 91, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_GIVEREF(__pyx_t_4); PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_4); __pyx_t_4 = NULL;
    __Pyx_INCREF(__pyx_v_alt_allele);
    __Pyx_GIVEREF(__pyx_v_alt_allele);
    PyTuple_SET_ITEM(__pyx_t_5, 0+1, __pyx_v_alt_allele);
    __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_5, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 91, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  }
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_6 = PyObject_Length(__pyx_t_2); if (unlikely(__pyx_t_6 == -1)) __PYX_ERR(0, 91, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = PyInt_FromSsize_t((__pyx_t_6 + 1)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 91, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 91, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_GIVEREF(__pyx_t_2);
  PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_t_3, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 91, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  if (likely(PyList_CheckExact(__pyx_t_2)) || PyTuple_CheckExact(__pyx_t_2)) {
    __pyx_t_3 = __pyx_t_2; __Pyx_INCREF(__pyx_t_3); __pyx_t_6 = 0;
    __pyx_t_7 = NULL;
  } else {
    __pyx_t_6 = -1; __pyx_t_3 = PyObject_GetIter(__pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 91, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_7 = Py_TYPE(__pyx_t_3)->tp_iternext; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 91, __pyx_L1_error)
  }
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  for (;;) {
    if (likely(!__pyx_t_7)) {
      if (likely(PyList_CheckExact(__pyx_t_3))) {
        if (__pyx_t_6 >= PyList_GET_SIZE(__pyx_t_3)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_2 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_6); __Pyx_INCREF(__pyx_t_2); __pyx_t_6++; if (unlikely(0 < 0)) __PYX_ERR(0, 91, __pyx_L1_error)
        #else
        __pyx_t_2 = PySequence_ITEM(__pyx_t_3, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 91, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
        #endif
      } else {
        if (__pyx_t_6 >= PyTuple_GET_SIZE(__pyx_t_3)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_2 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_6); __Pyx_INCREF(__pyx_t_2); __pyx_t_6++; if (unlikely(0 < 0)) __PYX_ERR(0, 91, __pyx_L1_error)
        #else
        __pyx_t_2 = PySequence_ITEM(__pyx_t_3, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 91, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
        #endif
      }
    } else {
      __pyx_t_2 = __pyx_t_7(__pyx_t_3);
      if (unlikely(!__pyx_t_2)) {
        PyObject* exc_type = PyErr_Occurred();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
          else __PYX_ERR(0, 91, __pyx_L1_error)
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_2);
    }
    __Pyx_XDECREF_SET(__pyx_v_j, __pyx_t_2);
    __pyx_t_2 = 0;
    __pyx_t_2 = PyList_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 91, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_INCREF(__pyx_kp_s_);
    __Pyx_GIVEREF(__pyx_kp_s_);
    PyList_SET_ITEM(__pyx_t_2, 0, __pyx_kp_s_);
    __pyx_t_4 = __Pyx_GetModuleGlobalName(__pyx_n_s_letter_split); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 91, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_8 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_4))) {
      __pyx_t_8 = PyMethod_GET_SELF(__pyx_t_4);
      if (likely(__pyx_t_8)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
        __Pyx_INCREF(__pyx_t_8);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_4, function);
      }
    }
    if (!__pyx_t_8) {
      __pyx_t_5 = __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_v_alt_allele); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 91, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_5);
    } else {
      __pyx_t_9 = PyTuple_New(1+1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 91, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_9);
      __Pyx_GIVEREF(__pyx_t_8); PyTuple_SET_ITEM(__pyx_t_9, 0, __pyx_t_8); __pyx_t_8 = NULL;
      __Pyx_INCREF(__pyx_v_alt_allele);
      __Pyx_GIVEREF(__pyx_v_alt_allele);
      PyTuple_SET_ITEM(__pyx_t_9, 0+1, __pyx_v_alt_allele);
      __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_9, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 91, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_5);
      __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
    }
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = PyNumber_Add(__pyx_t_2, __pyx_t_5); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 91, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = PyList_New(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 91, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_INCREF(__pyx_kp_s__2);
    __Pyx_GIVEREF(__pyx_kp_s__2);
    PyList_SET_ITEM(__pyx_t_5, 0, __pyx_kp_s__2);
    __pyx_t_2 = PyNumber_Add(__pyx_t_4, __pyx_t_5); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 91, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = PyList_New(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 91, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_GIVEREF(__pyx_t_2);
    PyList_SET_ITEM(__pyx_t_5, 0, __pyx_t_2);
    __pyx_t_2 = 0;
    __pyx_t_2 = __Pyx_GetItemInt_List(__pyx_t_5, 0, long, 1, __Pyx_PyInt_From_long, 1, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 91, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = __Pyx_PyInt_AddObjC(__pyx_v_j, __pyx_int_2, 2, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 91, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __pyx_t_4 = __Pyx_PyObject_GetSlice(__pyx_t_2, 0, 0, &__pyx_v_j, &__pyx_t_5, NULL, 0, 0, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 91, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    if (unlikely(__Pyx_ListComp_Append(__pyx_t_1, (PyObject*)__pyx_t_4))) __PYX_ERR(0, 91, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  }
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_alt_juncs = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":92
 *     #eg of alt_allele='abcab'  eg of ref_allele='abcd'
 *     alt_juncs=[[['-']+letter_split(alt_allele)+['+']][0][j:j+2] for j in range(len(letter_split(alt_allele))+1)]
 *     ref_juncs=[[['-']+letter_split(ref_allele)+['+']][0][j:j+2] for j in range(len(letter_split(alt_allele))+1)]             # <<<<<<<<<<<<<<
 *     new_juncs=[i for i in alt_juncs if not i in ref_juncs]
 *     return new_juncs
 */
  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 92, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_4 = __Pyx_GetModuleGlobalName(__pyx_n_s_letter_split); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 92, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_5 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_4))) {
    __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_4);
    if (likely(__pyx_t_5)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
      __Pyx_INCREF(__pyx_t_5);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_4, function);
    }
  }
  if (!__pyx_t_5) {
    __pyx_t_3 = __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_v_alt_allele); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 92, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
  } else {
    __pyx_t_2 = PyTuple_New(1+1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 92, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_GIVEREF(__pyx_t_5); PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_5); __pyx_t_5 = NULL;
    __Pyx_INCREF(__pyx_v_alt_allele);
    __Pyx_GIVEREF(__pyx_v_alt_allele);
    PyTuple_SET_ITEM(__pyx_t_2, 0+1, __pyx_v_alt_allele);
    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_2, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 92, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  }
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_6 = PyObject_Length(__pyx_t_3); if (unlikely(__pyx_t_6 == -1)) __PYX_ERR(0, 92, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = PyInt_FromSsize_t((__pyx_t_6 + 1)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 92, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 92, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_GIVEREF(__pyx_t_3);
  PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_t_4, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 92, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  if (likely(PyList_CheckExact(__pyx_t_3)) || PyTuple_CheckExact(__pyx_t_3)) {
    __pyx_t_4 = __pyx_t_3; __Pyx_INCREF(__pyx_t_4); __pyx_t_6 = 0;
    __pyx_t_7 = NULL;
  } else {
    __pyx_t_6 = -1; __pyx_t_4 = PyObject_GetIter(__pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 92, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_7 = Py_TYPE(__pyx_t_4)->tp_iternext; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 92, __pyx_L1_error)
  }
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  for (;;) {
    if (likely(!__pyx_t_7)) {
      if (likely(PyList_CheckExact(__pyx_t_4))) {
        if (__pyx_t_6 >= PyList_GET_SIZE(__pyx_t_4)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_3 = PyList_GET_ITEM(__pyx_t_4, __pyx_t_6); __Pyx_INCREF(__pyx_t_3); __pyx_t_6++; if (unlikely(0 < 0)) __PYX_ERR(0, 92, __pyx_L1_error)
        #else
        __pyx_t_3 = PySequence_ITEM(__pyx_t_4, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 92, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_3);
        #endif
      } else {
        if (__pyx_t_6 >= PyTuple_GET_SIZE(__pyx_t_4)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_3 = PyTuple_GET_ITEM(__pyx_t_4, __pyx_t_6); __Pyx_INCREF(__pyx_t_3); __pyx_t_6++; if (unlikely(0 < 0)) __PYX_ERR(0, 92, __pyx_L1_error)
        #else
        __pyx_t_3 = PySequence_ITEM(__pyx_t_4, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 92, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_3);
        #endif
      }
    } else {
      __pyx_t_3 = __pyx_t_7(__pyx_t_4);
      if (unlikely(!__pyx_t_3)) {
        PyObject* exc_type = PyErr_Occurred();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
          else __PYX_ERR(0, 92, __pyx_L1_error)
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_3);
    }
    __Pyx_XDECREF_SET(__pyx_v_j, __pyx_t_3);
    __pyx_t_3 = 0;
    __pyx_t_3 = PyList_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 92, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_INCREF(__pyx_kp_s_);
    __Pyx_GIVEREF(__pyx_kp_s_);
    PyList_SET_ITEM(__pyx_t_3, 0, __pyx_kp_s_);
    __pyx_t_5 = __Pyx_GetModuleGlobalName(__pyx_n_s_letter_split); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 92, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __pyx_t_9 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_5))) {
      __pyx_t_9 = PyMethod_GET_SELF(__pyx_t_5);
      if (likely(__pyx_t_9)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
        __Pyx_INCREF(__pyx_t_9);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_5, function);
      }
    }
    if (!__pyx_t_9) {
      __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_v_ref_allele); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 92, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
    } else {
      __pyx_t_8 = PyTuple_New(1+1); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 92, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_8);
      __Pyx_GIVEREF(__pyx_t_9); PyTuple_SET_ITEM(__pyx_t_8, 0, __pyx_t_9); __pyx_t_9 = NULL;
      __Pyx_INCREF(__pyx_v_ref_allele);
      __Pyx_GIVEREF(__pyx_v_ref_allele);
      PyTuple_SET_ITEM(__pyx_t_8, 0+1, __pyx_v_ref_allele);
      __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_8, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 92, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
    }
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = PyNumber_Add(__pyx_t_3, __pyx_t_2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 92, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = PyList_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 92, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_INCREF(__pyx_kp_s__2);
    __Pyx_GIVEREF(__pyx_kp_s__2);
    PyList_SET_ITEM(__pyx_t_2, 0, __pyx_kp_s__2);
    __pyx_t_3 = PyNumber_Add(__pyx_t_5, __pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 92, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = PyList_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 92, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_GIVEREF(__pyx_t_3);
    PyList_SET_ITEM(__pyx_t_2, 0, __pyx_t_3);
    __pyx_t_3 = 0;
    __pyx_t_3 = __Pyx_GetItemInt_List(__pyx_t_2, 0, long, 1, __Pyx_PyInt_From_long, 1, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 92, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = __Pyx_PyInt_AddObjC(__pyx_v_j, __pyx_int_2, 2, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 92, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_5 = __Pyx_PyObject_GetSlice(__pyx_t_3, 0, 0, &__pyx_v_j, &__pyx_t_2, NULL, 0, 0, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 92, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    if (unlikely(__Pyx_ListComp_Append(__pyx_t_1, (PyObject*)__pyx_t_5))) __PYX_ERR(0, 92, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  }
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_ref_juncs = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":93
 *     alt_juncs=[[['-']+letter_split(alt_allele)+['+']][0][j:j+2] for j in range(len(letter_split(alt_allele))+1)]
 *     ref_juncs=[[['-']+letter_split(ref_allele)+['+']][0][j:j+2] for j in range(len(letter_split(alt_allele))+1)]
 *     new_juncs=[i for i in alt_juncs if not i in ref_juncs]             # <<<<<<<<<<<<<<
 *     return new_juncs
 * 
 */
  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 93, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_4 = __pyx_v_alt_juncs; __Pyx_INCREF(__pyx_t_4); __pyx_t_6 = 0;
  for (;;) {
    if (__pyx_t_6 >= PyList_GET_SIZE(__pyx_t_4)) break;
    #if CYTHON_COMPILING_IN_CPYTHON
    __pyx_t_5 = PyList_GET_ITEM(__pyx_t_4, __pyx_t_6); __Pyx_INCREF(__pyx_t_5); __pyx_t_6++; if (unlikely(0 < 0)) __PYX_ERR(0, 93, __pyx_L1_error)
    #else
    __pyx_t_5 = PySequence_ITEM(__pyx_t_4, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 93, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    #endif
    __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_5);
    __pyx_t_5 = 0;
    __pyx_t_10 = (__Pyx_PySequence_ContainsTF(__pyx_v_i, __pyx_v_ref_juncs, Py_NE)); if (unlikely(__pyx_t_10 < 0)) __PYX_ERR(0, 93, __pyx_L1_error)
    __pyx_t_11 = (__pyx_t_10 != 0);
    if (__pyx_t_11) {
      if (unlikely(__Pyx_ListComp_Append(__pyx_t_1, (PyObject*)__pyx_v_i))) __PYX_ERR(0, 93, __pyx_L1_error)
    }
  }
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_new_juncs = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":94
 *     ref_juncs=[[['-']+letter_split(ref_allele)+['+']][0][j:j+2] for j in range(len(letter_split(alt_allele))+1)]
 *     new_juncs=[i for i in alt_juncs if not i in ref_juncs]
 *     return new_juncs             # <<<<<<<<<<<<<<
 * 
 * def bp_to_chr_hash(bps,chromos,flank_length=500):
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_new_juncs);
  __pyx_r = __pyx_v_new_juncs;
  goto __pyx_L0;

  /* "vapor_vali/Simple_function.pyx":89
 *         return temp_bam_in
 * 
 * def block_around_check(alt_allele,ref_allele):             # <<<<<<<<<<<<<<
 *     #eg of alt_allele='abcab'  eg of ref_allele='abcd'
 *     alt_juncs=[[['-']+letter_split(alt_allele)+['+']][0][j:j+2] for j in range(len(letter_split(alt_allele))+1)]
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_8);
  __Pyx_XDECREF(__pyx_t_9);
  __Pyx_AddTraceback("vapor_vali.Simple_function.block_around_check", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_alt_juncs);
  __Pyx_XDECREF(__pyx_v_ref_juncs);
  __Pyx_XDECREF(__pyx_v_new_juncs);
  __Pyx_XDECREF(__pyx_v_j);
  __Pyx_XDECREF(__pyx_v_i);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "vapor_vali/Simple_function.pyx":96
 *     return new_juncs
 * 
 * def bp_to_chr_hash(bps,chromos,flank_length=500):             # <<<<<<<<<<<<<<
 *     #eg of bps=['chr16', '34910548', '34911339', '34913149', '34913438', '36181068', '36181482']
 *     temp1=[]
 */

/* Python wrapper */
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_7bp_to_chr_hash(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_10vapor_vali_15Simple_function_7bp_to_chr_hash = {"bp_to_chr_hash", (PyCFunction)__pyx_pw_10vapor_vali_15Simple_function_7bp_to_chr_hash, METH_VARARGS|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_7bp_to_chr_hash(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_bps = 0;
  PyObject *__pyx_v_chromos = 0;
  PyObject *__pyx_v_flank_length = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("bp_to_chr_hash (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_bps,&__pyx_n_s_chromos,&__pyx_n_s_flank_length,0};
    PyObject* values[3] = {0,0,0};
    values[2] = ((PyObject *)__pyx_int_500);
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
      switch (pos_args) {
        case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_bps)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_chromos)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("bp_to_chr_hash", 0, 2, 3, 1); __PYX_ERR(0, 96, __pyx_L3_error)
        }
        case  2:
        if (kw_args > 0) {
          PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_flank_length);
          if (value) { values[2] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "bp_to_chr_hash") < 0)) __PYX_ERR(0, 96, __pyx_L3_error)
      }
    } else {
      switch (PyTuple_GET_SIZE(__pyx_args)) {
        case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_bps = values[0];
    __pyx_v_chromos = values[1];
    __pyx_v_flank_length = values[2];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("bp_to_chr_hash", 0, 2, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 96, __pyx_L3_error)
  __pyx_L3_error:;
  __Pyx_AddTraceback("vapor_vali.Simple_function.bp_to_chr_hash", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_10vapor_vali_15Simple_function_6bp_to_chr_hash(__pyx_self, __pyx_v_bps, __pyx_v_chromos, __pyx_v_flank_length);

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10vapor_vali_15Simple_function_6bp_to_chr_hash(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_bps, PyObject *__pyx_v_chromos, PyObject *__pyx_v_flank_length) {
  PyObject *__pyx_v_temp1 = NULL;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_v_out = NULL;
  PyObject *__pyx_v_rec = NULL;
  PyObject *__pyx_v_k1 = NULL;
  PyObject *__pyx_v_k2 = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  Py_ssize_t __pyx_t_2;
  PyObject *(*__pyx_t_3)(PyObject *);
  PyObject *__pyx_t_4 = NULL;
  int __pyx_t_5;
  int __pyx_t_6;
  int __pyx_t_7;
  Py_ssize_t __pyx_t_8;
  PyObject *__pyx_t_9 = NULL;
  PyObject *__pyx_t_10 = NULL;
  PyObject *__pyx_t_11 = NULL;
  PyObject *__pyx_t_12 = NULL;
  __Pyx_RefNannySetupContext("bp_to_chr_hash", 0);

  /* "vapor_vali/Simple_function.pyx":98
 * def bp_to_chr_hash(bps,chromos,flank_length=500):
 *     #eg of bps=['chr16', '34910548', '34911339', '34913149', '34913438', '36181068', '36181482']
 *     temp1=[]             # <<<<<<<<<<<<<<
 *     for i in bps:
 *         if i in chromos:
 */
  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 98, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_temp1 = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":99
 *     #eg of bps=['chr16', '34910548', '34911339', '34913149', '34913438', '36181068', '36181482']
 *     temp1=[]
 *     for i in bps:             # <<<<<<<<<<<<<<
 *         if i in chromos:
 *             temp1.append([i])
 */
  if (likely(PyList_CheckExact(__pyx_v_bps)) || PyTuple_CheckExact(__pyx_v_bps)) {
    __pyx_t_1 = __pyx_v_bps; __Pyx_INCREF(__pyx_t_1); __pyx_t_2 = 0;
    __pyx_t_3 = NULL;
  } else {
    __pyx_t_2 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_v_bps); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 99, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_3 = Py_TYPE(__pyx_t_1)->tp_iternext; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 99, __pyx_L1_error)
  }
  for (;;) {
    if (likely(!__pyx_t_3)) {
      if (likely(PyList_CheckExact(__pyx_t_1))) {
        if (__pyx_t_2 >= PyList_GET_SIZE(__pyx_t_1)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_4 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_4); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 99, __pyx_L1_error)
        #else
        __pyx_t_4 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 99, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_4);
        #endif
      } else {
        if (__pyx_t_2 >= PyTuple_GET_SIZE(__pyx_t_1)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_4 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_4); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 99, __pyx_L1_error)
        #else
        __pyx_t_4 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 99, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_4);
        #endif
      }
    } else {
      __pyx_t_4 = __pyx_t_3(__pyx_t_1);
      if (unlikely(!__pyx_t_4)) {
        PyObject* exc_type = PyErr_Occurred();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
          else __PYX_ERR(0, 99, __pyx_L1_error)
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_4);
    }
    __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_4);
    __pyx_t_4 = 0;

    /* "vapor_vali/Simple_function.pyx":100
 *     temp1=[]
 *     for i in bps:
 *         if i in chromos:             # <<<<<<<<<<<<<<
 *             temp1.append([i])
 *         else:
 */
    __pyx_t_5 = (__Pyx_PySequence_ContainsTF(__pyx_v_i, __pyx_v_chromos, Py_EQ)); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 100, __pyx_L1_error)
    __pyx_t_6 = (__pyx_t_5 != 0);
    if (__pyx_t_6) {

      /* "vapor_vali/Simple_function.pyx":101
 *     for i in bps:
 *         if i in chromos:
 *             temp1.append([i])             # <<<<<<<<<<<<<<
 *         else:
 *             temp1[-1].append(i)
 */
      __pyx_t_4 = PyList_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 101, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      __Pyx_INCREF(__pyx_v_i);
      __Pyx_GIVEREF(__pyx_v_i);
      PyList_SET_ITEM(__pyx_t_4, 0, __pyx_v_i);
      __pyx_t_7 = __Pyx_PyList_Append(__pyx_v_temp1, __pyx_t_4); if (unlikely(__pyx_t_7 == -1)) __PYX_ERR(0, 101, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;

      /* "vapor_vali/Simple_function.pyx":100
 *     temp1=[]
 *     for i in bps:
 *         if i in chromos:             # <<<<<<<<<<<<<<
 *             temp1.append([i])
 *         else:
 */
      goto __pyx_L5;
    }

    /* "vapor_vali/Simple_function.pyx":103
 *             temp1.append([i])
 *         else:
 *             temp1[-1].append(i)             # <<<<<<<<<<<<<<
 *     out={}
 *     rec=-1
 */
    /*else*/ {
      __pyx_t_4 = __Pyx_GetItemInt_List(__pyx_v_temp1, -1L, long, 1, __Pyx_PyInt_From_long, 1, 1, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 103, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_t_7 = __Pyx_PyObject_Append(__pyx_t_4, __pyx_v_i); if (unlikely(__pyx_t_7 == -1)) __PYX_ERR(0, 103, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    }
    __pyx_L5:;

    /* "vapor_vali/Simple_function.pyx":99
 *     #eg of bps=['chr16', '34910548', '34911339', '34913149', '34913438', '36181068', '36181482']
 *     temp1=[]
 *     for i in bps:             # <<<<<<<<<<<<<<
 *         if i in chromos:
 *             temp1.append([i])
 */
  }
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":104
 *         else:
 *             temp1[-1].append(i)
 *     out={}             # <<<<<<<<<<<<<<
 *     rec=-1
 *     for k1 in temp1:
 */
  __pyx_t_1 = PyDict_New(); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 104, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_out = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":105
 *             temp1[-1].append(i)
 *     out={}
 *     rec=-1             # <<<<<<<<<<<<<<
 *     for k1 in temp1:
 *         for k2 in range(len(k1[2:])):
 */
  __Pyx_INCREF(__pyx_int_neg_1);
  __pyx_v_rec = __pyx_int_neg_1;

  /* "vapor_vali/Simple_function.pyx":106
 *     out={}
 *     rec=-1
 *     for k1 in temp1:             # <<<<<<<<<<<<<<
 *         for k2 in range(len(k1[2:])):
 *             rec+=1
 */
  __pyx_t_1 = __pyx_v_temp1; __Pyx_INCREF(__pyx_t_1); __pyx_t_2 = 0;
  for (;;) {
    if (__pyx_t_2 >= PyList_GET_SIZE(__pyx_t_1)) break;
    #if CYTHON_COMPILING_IN_CPYTHON
    __pyx_t_4 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_4); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 106, __pyx_L1_error)
    #else
    __pyx_t_4 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 106, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    #endif
    __Pyx_XDECREF_SET(__pyx_v_k1, __pyx_t_4);
    __pyx_t_4 = 0;

    /* "vapor_vali/Simple_function.pyx":107
 *     rec=-1
 *     for k1 in temp1:
 *         for k2 in range(len(k1[2:])):             # <<<<<<<<<<<<<<
 *             rec+=1
 *             out[chr(97+rec)]=[k1[0],k1[k2+1],k1[k2+2]]
 */
    __pyx_t_4 = __Pyx_PyObject_GetSlice(__pyx_v_k1, 2, 0, NULL, NULL, &__pyx_slice__22, 1, 0, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 107, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_8 = PyObject_Length(__pyx_t_4); if (unlikely(__pyx_t_8 == -1)) __PYX_ERR(0, 107, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = PyInt_FromSsize_t(__pyx_t_8); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 107, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_9 = PyTuple_New(1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 107, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_9);
    __Pyx_GIVEREF(__pyx_t_4);
    PyTuple_SET_ITEM(__pyx_t_9, 0, __pyx_t_4);
    __pyx_t_4 = 0;
    __pyx_t_4 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_t_9, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 107, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
    if (likely(PyList_CheckExact(__pyx_t_4)) || PyTuple_CheckExact(__pyx_t_4)) {
      __pyx_t_9 = __pyx_t_4; __Pyx_INCREF(__pyx_t_9); __pyx_t_8 = 0;
      __pyx_t_3 = NULL;
    } else {
      __pyx_t_8 = -1; __pyx_t_9 = PyObject_GetIter(__pyx_t_4); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 107, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_9);
      __pyx_t_3 = Py_TYPE(__pyx_t_9)->tp_iternext; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 107, __pyx_L1_error)
    }
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    for (;;) {
      if (likely(!__pyx_t_3)) {
        if (likely(PyList_CheckExact(__pyx_t_9))) {
          if (__pyx_t_8 >= PyList_GET_SIZE(__pyx_t_9)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_4 = PyList_GET_ITEM(__pyx_t_9, __pyx_t_8); __Pyx_INCREF(__pyx_t_4); __pyx_t_8++; if (unlikely(0 < 0)) __PYX_ERR(0, 107, __pyx_L1_error)
          #else
          __pyx_t_4 = PySequence_ITEM(__pyx_t_9, __pyx_t_8); __pyx_t_8++; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 107, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_4);
          #endif
        } else {
          if (__pyx_t_8 >= PyTuple_GET_SIZE(__pyx_t_9)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_4 = PyTuple_GET_ITEM(__pyx_t_9, __pyx_t_8); __Pyx_INCREF(__pyx_t_4); __pyx_t_8++; if (unlikely(0 < 0)) __PYX_ERR(0, 107, __pyx_L1_error)
          #else
          __pyx_t_4 = PySequence_ITEM(__pyx_t_9, __pyx_t_8); __pyx_t_8++; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 107, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_4);
          #endif
        }
      } else {
        __pyx_t_4 = __pyx_t_3(__pyx_t_9);
        if (unlikely(!__pyx_t_4)) {
          PyObject* exc_type = PyErr_Occurred();
          if (exc_type) {
            if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
            else __PYX_ERR(0, 107, __pyx_L1_error)
          }
          break;
        }
        __Pyx_GOTREF(__pyx_t_4);
      }
      __Pyx_XDECREF_SET(__pyx_v_k2, __pyx_t_4);
      __pyx_t_4 = 0;

      /* "vapor_vali/Simple_function.pyx":108
 *     for k1 in temp1:
 *         for k2 in range(len(k1[2:])):
 *             rec+=1             # <<<<<<<<<<<<<<
 *             out[chr(97+rec)]=[k1[0],k1[k2+1],k1[k2+2]]
 *     out['+']=[out[sorted(out.keys())[-1]][0],out[sorted(out.keys())[-1]][2],str(int(out[sorted(out.keys())[-1]][2])+flank_length)]
 */
      __pyx_t_4 = __Pyx_PyInt_AddObjC(__pyx_v_rec, __pyx_int_1, 1, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 108, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      __Pyx_DECREF_SET(__pyx_v_rec, __pyx_t_4);
      __pyx_t_4 = 0;

      /* "vapor_vali/Simple_function.pyx":109
 *         for k2 in range(len(k1[2:])):
 *             rec+=1
 *             out[chr(97+rec)]=[k1[0],k1[k2+1],k1[k2+2]]             # <<<<<<<<<<<<<<
 *     out['+']=[out[sorted(out.keys())[-1]][0],out[sorted(out.keys())[-1]][2],str(int(out[sorted(out.keys())[-1]][2])+flank_length)]
 *     out['-']=[out['a'][0],str(int(out['a'][1])-flank_length),int(out['a'][1])]
 */
      __pyx_t_4 = __Pyx_GetItemInt(__pyx_v_k1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 109, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_t_10 = __Pyx_PyInt_AddObjC(__pyx_v_k2, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 109, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_10);
      __pyx_t_11 = PyObject_GetItem(__pyx_v_k1, __pyx_t_10); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 109, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_11);
      __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
      __pyx_t_10 = __Pyx_PyInt_AddObjC(__pyx_v_k2, __pyx_int_2, 2, 0); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 109, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_10);
      __pyx_t_12 = PyObject_GetItem(__pyx_v_k1, __pyx_t_10); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 109, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_12);
      __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
      __pyx_t_10 = PyList_New(3); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 109, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_10);
      __Pyx_GIVEREF(__pyx_t_4);
      PyList_SET_ITEM(__pyx_t_10, 0, __pyx_t_4);
      __Pyx_GIVEREF(__pyx_t_11);
      PyList_SET_ITEM(__pyx_t_10, 1, __pyx_t_11);
      __Pyx_GIVEREF(__pyx_t_12);
      PyList_SET_ITEM(__pyx_t_10, 2, __pyx_t_12);
      __pyx_t_4 = 0;
      __pyx_t_11 = 0;
      __pyx_t_12 = 0;
      __pyx_t_12 = __Pyx_PyInt_AddCObj(__pyx_int_97, __pyx_v_rec, 97, 0); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 109, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_12);
      __pyx_t_11 = PyTuple_New(1); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 109, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_11);
      __Pyx_GIVEREF(__pyx_t_12);
      PyTuple_SET_ITEM(__pyx_t_11, 0, __pyx_t_12);
      __pyx_t_12 = 0;
      __pyx_t_12 = __Pyx_PyObject_Call(__pyx_builtin_chr, __pyx_t_11, NULL); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 109, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_12);
      __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
      if (unlikely(PyDict_SetItem(__pyx_v_out, __pyx_t_12, __pyx_t_10) < 0)) __PYX_ERR(0, 109, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
      __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;

      /* "vapor_vali/Simple_function.pyx":107
 *     rec=-1
 *     for k1 in temp1:
 *         for k2 in range(len(k1[2:])):             # <<<<<<<<<<<<<<
 *             rec+=1
 *             out[chr(97+rec)]=[k1[0],k1[k2+1],k1[k2+2]]
 */
    }
    __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;

    /* "vapor_vali/Simple_function.pyx":106
 *     out={}
 *     rec=-1
 *     for k1 in temp1:             # <<<<<<<<<<<<<<
 *         for k2 in range(len(k1[2:])):
 *             rec+=1
 */
  }
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":110
 *             rec+=1
 *             out[chr(97+rec)]=[k1[0],k1[k2+1],k1[k2+2]]
 *     out['+']=[out[sorted(out.keys())[-1]][0],out[sorted(out.keys())[-1]][2],str(int(out[sorted(out.keys())[-1]][2])+flank_length)]             # <<<<<<<<<<<<<<
 *     out['-']=[out['a'][0],str(int(out['a'][1])-flank_length),int(out['a'][1])]
 *     return out
 */
  __pyx_t_9 = __Pyx_PyDict_Keys(__pyx_v_out); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 110, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_9);
  __pyx_t_10 = PySequence_List(__pyx_t_9); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 110, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_10);
  __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
  __pyx_t_1 = ((PyObject*)__pyx_t_10);
  __pyx_t_10 = 0;
  __pyx_t_7 = PyList_Sort(__pyx_t_1); if (unlikely(__pyx_t_7 == -1)) __PYX_ERR(0, 110, __pyx_L1_error)
  if (unlikely(__pyx_t_1 == Py_None)) {
    PyErr_SetString(PyExc_TypeError, "'NoneType' object is not subscriptable");
    __PYX_ERR(0, 110, __pyx_L1_error)
  }
  __pyx_t_10 = __Pyx_GetItemInt_List(__pyx_t_1, -1L, long, 1, __Pyx_PyInt_From_long, 1, 1, 1); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 110, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_10);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_PyDict_GetItem(__pyx_v_out, __pyx_t_10); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 110, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
  __pyx_t_10 = __Pyx_GetItemInt(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 110, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_10);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_9 = __Pyx_PyDict_Keys(__pyx_v_out); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 110, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_9);
  __pyx_t_12 = PySequence_List(__pyx_t_9); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 110, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_12);
  __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
  __pyx_t_1 = ((PyObject*)__pyx_t_12);
  __pyx_t_12 = 0;
  __pyx_t_7 = PyList_Sort(__pyx_t_1); if (unlikely(__pyx_t_7 == -1)) __PYX_ERR(0, 110, __pyx_L1_error)
  if (unlikely(__pyx_t_1 == Py_None)) {
    PyErr_SetString(PyExc_TypeError, "'NoneType' object is not subscriptable");
    __PYX_ERR(0, 110, __pyx_L1_error)
  }
  __pyx_t_12 = __Pyx_GetItemInt_List(__pyx_t_1, -1L, long, 1, __Pyx_PyInt_From_long, 1, 1, 1); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 110, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_12);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_PyDict_GetItem(__pyx_v_out, __pyx_t_12); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 110, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
  __pyx_t_12 = __Pyx_GetItemInt(__pyx_t_1, 2, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 110, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_12);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_9 = __Pyx_PyDict_Keys(__pyx_v_out); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 110, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_9);
  __pyx_t_11 = PySequence_List(__pyx_t_9); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 110, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_11);
  __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
  __pyx_t_1 = ((PyObject*)__pyx_t_11);
  __pyx_t_11 = 0;
  __pyx_t_7 = PyList_Sort(__pyx_t_1); if (unlikely(__pyx_t_7 == -1)) __PYX_ERR(0, 110, __pyx_L1_error)
  if (unlikely(__pyx_t_1 == Py_None)) {
    PyErr_SetString(PyExc_TypeError, "'NoneType' object is not subscriptable");
    __PYX_ERR(0, 110, __pyx_L1_error)
  }
  __pyx_t_11 = __Pyx_GetItemInt_List(__pyx_t_1, -1L, long, 1, __Pyx_PyInt_From_long, 1, 1, 1); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 110, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_11);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_PyDict_GetItem(__pyx_v_out, __pyx_t_11); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 110, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
  __pyx_t_11 = __Pyx_GetItemInt(__pyx_t_1, 2, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 110, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_11);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_PyNumber_Int(__pyx_t_11); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 110, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
  __pyx_t_11 = PyNumber_Add(__pyx_t_1, __pyx_v_flank_length); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 110, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_11);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 110, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_GIVEREF(__pyx_t_11);
  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_11);
  __pyx_t_11 = 0;
  __pyx_t_11 = __Pyx_PyObject_Call(((PyObject *)(&PyString_Type)), __pyx_t_1, NULL); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 110, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_11);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = PyList_New(3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 110, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_GIVEREF(__pyx_t_10);
  PyList_SET_ITEM(__pyx_t_1, 0, __pyx_t_10);
  __Pyx_GIVEREF(__pyx_t_12);
  PyList_SET_ITEM(__pyx_t_1, 1, __pyx_t_12);
  __Pyx_GIVEREF(__pyx_t_11);
  PyList_SET_ITEM(__pyx_t_1, 2, __pyx_t_11);
  __pyx_t_10 = 0;
  __pyx_t_12 = 0;
  __pyx_t_11 = 0;
  if (unlikely(PyDict_SetItem(__pyx_v_out, __pyx_kp_s__2, __pyx_t_1) < 0)) __PYX_ERR(0, 110, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":111
 *             out[chr(97+rec)]=[k1[0],k1[k2+1],k1[k2+2]]
 *     out['+']=[out[sorted(out.keys())[-1]][0],out[sorted(out.keys())[-1]][2],str(int(out[sorted(out.keys())[-1]][2])+flank_length)]
 *     out['-']=[out['a'][0],str(int(out['a'][1])-flank_length),int(out['a'][1])]             # <<<<<<<<<<<<<<
 *     return out
 * 
 */
  __pyx_t_1 = __Pyx_PyDict_GetItem(__pyx_v_out, __pyx_n_s_a); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 111, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_11 = __Pyx_GetItemInt(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 111, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_11);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_PyDict_GetItem(__pyx_v_out, __pyx_n_s_a); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 111, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_12 = __Pyx_GetItemInt(__pyx_t_1, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 111, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_12);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_PyNumber_Int(__pyx_t_12); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 111, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
  __pyx_t_12 = PyNumber_Subtract(__pyx_t_1, __pyx_v_flank_length); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 111, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_12);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 111, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_GIVEREF(__pyx_t_12);
  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_12);
  __pyx_t_12 = 0;
  __pyx_t_12 = __Pyx_PyObject_Call(((PyObject *)(&PyString_Type)), __pyx_t_1, NULL); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 111, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_12);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_PyDict_GetItem(__pyx_v_out, __pyx_n_s_a); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 111, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_10 = __Pyx_GetItemInt(__pyx_t_1, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 111, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_10);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_PyNumber_Int(__pyx_t_10); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 111, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
  __pyx_t_10 = PyList_New(3); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 111, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_10);
  __Pyx_GIVEREF(__pyx_t_11);
  PyList_SET_ITEM(__pyx_t_10, 0, __pyx_t_11);
  __Pyx_GIVEREF(__pyx_t_12);
  PyList_SET_ITEM(__pyx_t_10, 1, __pyx_t_12);
  __Pyx_GIVEREF(__pyx_t_1);
  PyList_SET_ITEM(__pyx_t_10, 2, __pyx_t_1);
  __pyx_t_11 = 0;
  __pyx_t_12 = 0;
  __pyx_t_1 = 0;
  if (unlikely(PyDict_SetItem(__pyx_v_out, __pyx_kp_s_, __pyx_t_10) < 0)) __PYX_ERR(0, 111, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;

  /* "vapor_vali/Simple_function.pyx":112
 *     out['+']=[out[sorted(out.keys())[-1]][0],out[sorted(out.keys())[-1]][2],str(int(out[sorted(out.keys())[-1]][2])+flank_length)]
 *     out['-']=[out['a'][0],str(int(out['a'][1])-flank_length),int(out['a'][1])]
 *     return out             # <<<<<<<<<<<<<<
 * 
 * def bp_to_block_len(bp_info):
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_out);
  __pyx_r = __pyx_v_out;
  goto __pyx_L0;

  /* "vapor_vali/Simple_function.pyx":96
 *     return new_juncs
 * 
 * def bp_to_chr_hash(bps,chromos,flank_length=500):             # <<<<<<<<<<<<<<
 *     #eg of bps=['chr16', '34910548', '34911339', '34913149', '34913438', '36181068', '36181482']
 *     temp1=[]
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_9);
  __Pyx_XDECREF(__pyx_t_10);
  __Pyx_XDECREF(__pyx_t_11);
  __Pyx_XDECREF(__pyx_t_12);
  __Pyx_AddTraceback("vapor_vali.Simple_function.bp_to_chr_hash", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_temp1);
  __Pyx_XDECREF(__pyx_v_i);
  __Pyx_XDECREF(__pyx_v_out);
  __Pyx_XDECREF(__pyx_v_rec);
  __Pyx_XDECREF(__pyx_v_k1);
  __Pyx_XDECREF(__pyx_v_k2);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "vapor_vali/Simple_function.pyx":114
 *     return out
 * 
 * def bp_to_block_len(bp_info):             # <<<<<<<<<<<<<<
 *     #eg of bp_info=['chr1',127906515, 127907283, 127907399]
 *     out={}
 */

/* Python wrapper */
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_9bp_to_block_len(PyObject *__pyx_self, PyObject *__pyx_v_bp_info); /*proto*/
static PyMethodDef __pyx_mdef_10vapor_vali_15Simple_function_9bp_to_block_len = {"bp_to_block_len", (PyCFunction)__pyx_pw_10vapor_vali_15Simple_function_9bp_to_block_len, METH_O, 0};
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_9bp_to_block_len(PyObject *__pyx_self, PyObject *__pyx_v_bp_info) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("bp_to_block_len (wrapper)", 0);
  __pyx_r = __pyx_pf_10vapor_vali_15Simple_function_8bp_to_block_len(__pyx_self, ((PyObject *)__pyx_v_bp_info));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10vapor_vali_15Simple_function_8bp_to_block_len(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_bp_info) {
  PyObject *__pyx_v_out = NULL;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  Py_ssize_t __pyx_t_2;
  PyObject *__pyx_t_3 = NULL;
  PyObject *(*__pyx_t_4)(PyObject *);
  PyObject *__pyx_t_5 = NULL;
  PyObject *__pyx_t_6 = NULL;
  __Pyx_RefNannySetupContext("bp_to_block_len", 0);

  /* "vapor_vali/Simple_function.pyx":116
 * def bp_to_block_len(bp_info):
 *     #eg of bp_info=['chr1',127906515, 127907283, 127907399]
 *     out={}             # <<<<<<<<<<<<<<
 *     for i in range(len(bp_info)-2):
 *         out[chr(97+i)]=bp_info[i+2]-bp_info[i+1]
 */
  __pyx_t_1 = PyDict_New(); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 116, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_out = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":117
 *     #eg of bp_info=['chr1',127906515, 127907283, 127907399]
 *     out={}
 *     for i in range(len(bp_info)-2):             # <<<<<<<<<<<<<<
 *         out[chr(97+i)]=bp_info[i+2]-bp_info[i+1]
 *     return out
 */
  __pyx_t_2 = PyObject_Length(__pyx_v_bp_info); if (unlikely(__pyx_t_2 == -1)) __PYX_ERR(0, 117, __pyx_L1_error)
  __pyx_t_1 = PyInt_FromSsize_t((__pyx_t_2 - 2)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 117, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 117, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_GIVEREF(__pyx_t_1);
  PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_t_3, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 117, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  if (likely(PyList_CheckExact(__pyx_t_1)) || PyTuple_CheckExact(__pyx_t_1)) {
    __pyx_t_3 = __pyx_t_1; __Pyx_INCREF(__pyx_t_3); __pyx_t_2 = 0;
    __pyx_t_4 = NULL;
  } else {
    __pyx_t_2 = -1; __pyx_t_3 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 117, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_4 = Py_TYPE(__pyx_t_3)->tp_iternext; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 117, __pyx_L1_error)
  }
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  for (;;) {
    if (likely(!__pyx_t_4)) {
      if (likely(PyList_CheckExact(__pyx_t_3))) {
        if (__pyx_t_2 >= PyList_GET_SIZE(__pyx_t_3)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_1 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_2); __Pyx_INCREF(__pyx_t_1); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 117, __pyx_L1_error)
        #else
        __pyx_t_1 = PySequence_ITEM(__pyx_t_3, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 117, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        #endif
      } else {
        if (__pyx_t_2 >= PyTuple_GET_SIZE(__pyx_t_3)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_2); __Pyx_INCREF(__pyx_t_1); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 117, __pyx_L1_error)
        #else
        __pyx_t_1 = PySequence_ITEM(__pyx_t_3, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 117, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        #endif
      }
    } else {
      __pyx_t_1 = __pyx_t_4(__pyx_t_3);
      if (unlikely(!__pyx_t_1)) {
        PyObject* exc_type = PyErr_Occurred();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
          else __PYX_ERR(0, 117, __pyx_L1_error)
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_1);
    }
    __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_1);
    __pyx_t_1 = 0;

    /* "vapor_vali/Simple_function.pyx":118
 *     out={}
 *     for i in range(len(bp_info)-2):
 *         out[chr(97+i)]=bp_info[i+2]-bp_info[i+1]             # <<<<<<<<<<<<<<
 *     return out
 * 
 */
    __pyx_t_1 = __Pyx_PyInt_AddObjC(__pyx_v_i, __pyx_int_2, 2, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 118, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_5 = PyObject_GetItem(__pyx_v_bp_info, __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 118, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = __Pyx_PyInt_AddObjC(__pyx_v_i, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 118, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_6 = PyObject_GetItem(__pyx_v_bp_info, __pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 118, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = PyNumber_Subtract(__pyx_t_5, __pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 118, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = __Pyx_PyInt_AddCObj(__pyx_int_97, __pyx_v_i, 97, 0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 118, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 118, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_GIVEREF(__pyx_t_6);
    PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_6);
    __pyx_t_6 = 0;
    __pyx_t_6 = __Pyx_PyObject_Call(__pyx_builtin_chr, __pyx_t_5, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 118, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    if (unlikely(PyDict_SetItem(__pyx_v_out, __pyx_t_6, __pyx_t_1) < 0)) __PYX_ERR(0, 118, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "vapor_vali/Simple_function.pyx":117
 *     #eg of bp_info=['chr1',127906515, 127907283, 127907399]
 *     out={}
 *     for i in range(len(bp_info)-2):             # <<<<<<<<<<<<<<
 *         out[chr(97+i)]=bp_info[i+2]-bp_info[i+1]
 *     return out
 */
  }
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;

  /* "vapor_vali/Simple_function.pyx":119
 *     for i in range(len(bp_info)-2):
 *         out[chr(97+i)]=bp_info[i+2]-bp_info[i+1]
 *     return out             # <<<<<<<<<<<<<<
 * 
 * def block_modify(block,chromos):
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_out);
  __pyx_r = __pyx_v_out;
  goto __pyx_L0;

  /* "vapor_vali/Simple_function.pyx":114
 *     return out
 * 
 * def bp_to_block_len(bp_info):             # <<<<<<<<<<<<<<
 *     #eg of bp_info=['chr1',127906515, 127907283, 127907399]
 *     out={}
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_AddTraceback("vapor_vali.Simple_function.bp_to_block_len", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_out);
  __Pyx_XDECREF(__pyx_v_i);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "vapor_vali/Simple_function.pyx":121
 *     return out
 * 
 * def block_modify(block,chromos):             # <<<<<<<<<<<<<<
 *     #eg of block=['chr16', '34911339', '34913149', 'chr16', '34913149', '34913438']
 *     out=[]
 */

/* Python wrapper */
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_11block_modify(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_10vapor_vali_15Simple_function_11block_modify = {"block_modify", (PyCFunction)__pyx_pw_10vapor_vali_15Simple_function_11block_modify, METH_VARARGS|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_11block_modify(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_block = 0;
  PyObject *__pyx_v_chromos = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("block_modify (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_block,&__pyx_n_s_chromos,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_block)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_chromos)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("block_modify", 1, 2, 2, 1); __PYX_ERR(0, 121, __pyx_L3_error)
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "block_modify") < 0)) __PYX_ERR(0, 121, __pyx_L3_error)
      }
    } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
    }
    __pyx_v_block = values[0];
    __pyx_v_chromos = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("block_modify", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 121, __pyx_L3_error)
  __pyx_L3_error:;
  __Pyx_AddTraceback("vapor_vali.Simple_function.block_modify", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_10vapor_vali_15Simple_function_10block_modify(__pyx_self, __pyx_v_block, __pyx_v_chromos);

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10vapor_vali_15Simple_function_10block_modify(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_block, PyObject *__pyx_v_chromos) {
  PyObject *__pyx_v_out = NULL;
  PyObject *__pyx_v_x = NULL;
  PyObject *__pyx_v_out_new = NULL;
  PyObject *__pyx_v_y = NULL;
  PyObject *__pyx_v_out_new_2 = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  Py_ssize_t __pyx_t_2;
  PyObject *(*__pyx_t_3)(PyObject *);
  PyObject *__pyx_t_4 = NULL;
  int __pyx_t_5;
  int __pyx_t_6;
  PyObject *__pyx_t_7 = NULL;
  int __pyx_t_8;
  Py_ssize_t __pyx_t_9;
  PyObject *__pyx_t_10 = NULL;
  PyObject *__pyx_t_11 = NULL;
  PyObject *__pyx_t_12 = NULL;
  __Pyx_RefNannySetupContext("block_modify", 0);

  /* "vapor_vali/Simple_function.pyx":123
 * def block_modify(block,chromos):
 *     #eg of block=['chr16', '34911339', '34913149', 'chr16', '34913149', '34913438']
 *     out=[]             # <<<<<<<<<<<<<<
 *     for x in block:
 *         if x in chromos:
 */
  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 123, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_out = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":124
 *     #eg of block=['chr16', '34911339', '34913149', 'chr16', '34913149', '34913438']
 *     out=[]
 *     for x in block:             # <<<<<<<<<<<<<<
 *         if x in chromos:
 *             if out==[]:    out.append([x])
 */
  if (likely(PyList_CheckExact(__pyx_v_block)) || PyTuple_CheckExact(__pyx_v_block)) {
    __pyx_t_1 = __pyx_v_block; __Pyx_INCREF(__pyx_t_1); __pyx_t_2 = 0;
    __pyx_t_3 = NULL;
  } else {
    __pyx_t_2 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_v_block); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 124, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_3 = Py_TYPE(__pyx_t_1)->tp_iternext; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 124, __pyx_L1_error)
  }
  for (;;) {
    if (likely(!__pyx_t_3)) {
      if (likely(PyList_CheckExact(__pyx_t_1))) {
        if (__pyx_t_2 >= PyList_GET_SIZE(__pyx_t_1)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_4 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_4); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 124, __pyx_L1_error)
        #else
        __pyx_t_4 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 124, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_4);
        #endif
      } else {
        if (__pyx_t_2 >= PyTuple_GET_SIZE(__pyx_t_1)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_4 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_4); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 124, __pyx_L1_error)
        #else
        __pyx_t_4 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 124, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_4);
        #endif
      }
    } else {
      __pyx_t_4 = __pyx_t_3(__pyx_t_1);
      if (unlikely(!__pyx_t_4)) {
        PyObject* exc_type = PyErr_Occurred();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
          else __PYX_ERR(0, 124, __pyx_L1_error)
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_4);
    }
    __Pyx_XDECREF_SET(__pyx_v_x, __pyx_t_4);
    __pyx_t_4 = 0;

    /* "vapor_vali/Simple_function.pyx":125
 *     out=[]
 *     for x in block:
 *         if x in chromos:             # <<<<<<<<<<<<<<
 *             if out==[]:    out.append([x])
 *             else:
 */
    __pyx_t_5 = (__Pyx_PySequence_ContainsTF(__pyx_v_x, __pyx_v_chromos, Py_EQ)); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 125, __pyx_L1_error)
    __pyx_t_6 = (__pyx_t_5 != 0);
    if (__pyx_t_6) {

      /* "vapor_vali/Simple_function.pyx":126
 *     for x in block:
 *         if x in chromos:
 *             if out==[]:    out.append([x])             # <<<<<<<<<<<<<<
 *             else:
 *                 if not x in out[-1]:    out.append([x])
 */
      __pyx_t_4 = PyList_New(0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 126, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_t_7 = PyObject_RichCompare(__pyx_v_out, __pyx_t_4, Py_EQ); __Pyx_XGOTREF(__pyx_t_7); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 126, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_7); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 126, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
      if (__pyx_t_6) {
        __pyx_t_7 = PyList_New(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 126, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_7);
        __Pyx_INCREF(__pyx_v_x);
        __Pyx_GIVEREF(__pyx_v_x);
        PyList_SET_ITEM(__pyx_t_7, 0, __pyx_v_x);
        __pyx_t_8 = __Pyx_PyList_Append(__pyx_v_out, __pyx_t_7); if (unlikely(__pyx_t_8 == -1)) __PYX_ERR(0, 126, __pyx_L1_error)
        __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
        goto __pyx_L6;
      }

      /* "vapor_vali/Simple_function.pyx":128
 *             if out==[]:    out.append([x])
 *             else:
 *                 if not x in out[-1]:    out.append([x])             # <<<<<<<<<<<<<<
 *         else:   out[-1].append(x)
 *     out_new=[]
 */
      /*else*/ {
        __pyx_t_7 = __Pyx_GetItemInt_List(__pyx_v_out, -1L, long, 1, __Pyx_PyInt_From_long, 1, 1, 1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 128, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_7);
        __pyx_t_6 = (__Pyx_PySequence_ContainsTF(__pyx_v_x, __pyx_t_7, Py_NE)); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 128, __pyx_L1_error)
        __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
        __pyx_t_5 = (__pyx_t_6 != 0);
        if (__pyx_t_5) {
          __pyx_t_7 = PyList_New(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 128, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_7);
          __Pyx_INCREF(__pyx_v_x);
          __Pyx_GIVEREF(__pyx_v_x);
          PyList_SET_ITEM(__pyx_t_7, 0, __pyx_v_x);
          __pyx_t_8 = __Pyx_PyList_Append(__pyx_v_out, __pyx_t_7); if (unlikely(__pyx_t_8 == -1)) __PYX_ERR(0, 128, __pyx_L1_error)
          __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
        }
      }
      __pyx_L6:;

      /* "vapor_vali/Simple_function.pyx":125
 *     out=[]
 *     for x in block:
 *         if x in chromos:             # <<<<<<<<<<<<<<
 *             if out==[]:    out.append([x])
 *             else:
 */
      goto __pyx_L5;
    }

    /* "vapor_vali/Simple_function.pyx":129
 *             else:
 *                 if not x in out[-1]:    out.append([x])
 *         else:   out[-1].append(x)             # <<<<<<<<<<<<<<
 *     out_new=[]
 *     for x in out:
 */
    /*else*/ {
      __pyx_t_7 = __Pyx_GetItemInt_List(__pyx_v_out, -1L, long, 1, __Pyx_PyInt_From_long, 1, 1, 1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 129, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_7);
      __pyx_t_8 = __Pyx_PyObject_Append(__pyx_t_7, __pyx_v_x); if (unlikely(__pyx_t_8 == -1)) __PYX_ERR(0, 129, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
    }
    __pyx_L5:;

    /* "vapor_vali/Simple_function.pyx":124
 *     #eg of block=['chr16', '34911339', '34913149', 'chr16', '34913149', '34913438']
 *     out=[]
 *     for x in block:             # <<<<<<<<<<<<<<
 *         if x in chromos:
 *             if out==[]:    out.append([x])
 */
  }
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":130
 *                 if not x in out[-1]:    out.append([x])
 *         else:   out[-1].append(x)
 *     out_new=[]             # <<<<<<<<<<<<<<
 *     for x in out:
 *         out_new.append([])
 */
  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 130, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_out_new = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":131
 *         else:   out[-1].append(x)
 *     out_new=[]
 *     for x in out:             # <<<<<<<<<<<<<<
 *         out_new.append([])
 *         for y in x:
 */
  __pyx_t_1 = __pyx_v_out; __Pyx_INCREF(__pyx_t_1); __pyx_t_2 = 0;
  for (;;) {
    if (__pyx_t_2 >= PyList_GET_SIZE(__pyx_t_1)) break;
    #if CYTHON_COMPILING_IN_CPYTHON
    __pyx_t_7 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_7); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 131, __pyx_L1_error)
    #else
    __pyx_t_7 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 131, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    #endif
    __Pyx_XDECREF_SET(__pyx_v_x, __pyx_t_7);
    __pyx_t_7 = 0;

    /* "vapor_vali/Simple_function.pyx":132
 *     out_new=[]
 *     for x in out:
 *         out_new.append([])             # <<<<<<<<<<<<<<
 *         for y in x:
 *             if x.count(y)==1:
 */
    __pyx_t_7 = PyList_New(0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 132, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    __pyx_t_8 = __Pyx_PyList_Append(__pyx_v_out_new, __pyx_t_7); if (unlikely(__pyx_t_8 == -1)) __PYX_ERR(0, 132, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;

    /* "vapor_vali/Simple_function.pyx":133
 *     for x in out:
 *         out_new.append([])
 *         for y in x:             # <<<<<<<<<<<<<<
 *             if x.count(y)==1:
 *                 out_new[-1].append(y)
 */
    if (likely(PyList_CheckExact(__pyx_v_x)) || PyTuple_CheckExact(__pyx_v_x)) {
      __pyx_t_7 = __pyx_v_x; __Pyx_INCREF(__pyx_t_7); __pyx_t_9 = 0;
      __pyx_t_3 = NULL;
    } else {
      __pyx_t_9 = -1; __pyx_t_7 = PyObject_GetIter(__pyx_v_x); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 133, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_7);
      __pyx_t_3 = Py_TYPE(__pyx_t_7)->tp_iternext; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 133, __pyx_L1_error)
    }
    for (;;) {
      if (likely(!__pyx_t_3)) {
        if (likely(PyList_CheckExact(__pyx_t_7))) {
          if (__pyx_t_9 >= PyList_GET_SIZE(__pyx_t_7)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_4 = PyList_GET_ITEM(__pyx_t_7, __pyx_t_9); __Pyx_INCREF(__pyx_t_4); __pyx_t_9++; if (unlikely(0 < 0)) __PYX_ERR(0, 133, __pyx_L1_error)
          #else
          __pyx_t_4 = PySequence_ITEM(__pyx_t_7, __pyx_t_9); __pyx_t_9++; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 133, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_4);
          #endif
        } else {
          if (__pyx_t_9 >= PyTuple_GET_SIZE(__pyx_t_7)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_4 = PyTuple_GET_ITEM(__pyx_t_7, __pyx_t_9); __Pyx_INCREF(__pyx_t_4); __pyx_t_9++; if (unlikely(0 < 0)) __PYX_ERR(0, 133, __pyx_L1_error)
          #else
          __pyx_t_4 = PySequence_ITEM(__pyx_t_7, __pyx_t_9); __pyx_t_9++; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 133, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_4);
          #endif
        }
      } else {
        __pyx_t_4 = __pyx_t_3(__pyx_t_7);
        if (unlikely(!__pyx_t_4)) {
          PyObject* exc_type = PyErr_Occurred();
          if (exc_type) {
            if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
            else __PYX_ERR(0, 133, __pyx_L1_error)
          }
          break;
        }
        __Pyx_GOTREF(__pyx_t_4);
      }
      __Pyx_XDECREF_SET(__pyx_v_y, __pyx_t_4);
      __pyx_t_4 = 0;

      /* "vapor_vali/Simple_function.pyx":134
 *         out_new.append([])
 *         for y in x:
 *             if x.count(y)==1:             # <<<<<<<<<<<<<<
 *                 out_new[-1].append(y)
 *     out_new_2=[]
 */
      __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_v_x, __pyx_n_s_count); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 134, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_10);
      __pyx_t_11 = NULL;
      if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_10))) {
        __pyx_t_11 = PyMethod_GET_SELF(__pyx_t_10);
        if (likely(__pyx_t_11)) {
          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_10);
          __Pyx_INCREF(__pyx_t_11);
          __Pyx_INCREF(function);
          __Pyx_DECREF_SET(__pyx_t_10, function);
        }
      }
      if (!__pyx_t_11) {
        __pyx_t_4 = __Pyx_PyObject_CallOneArg(__pyx_t_10, __pyx_v_y); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 134, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_4);
      } else {
        __pyx_t_12 = PyTuple_New(1+1); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 134, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_12);
        __Pyx_GIVEREF(__pyx_t_11); PyTuple_SET_ITEM(__pyx_t_12, 0, __pyx_t_11); __pyx_t_11 = NULL;
        __Pyx_INCREF(__pyx_v_y);
        __Pyx_GIVEREF(__pyx_v_y);
        PyTuple_SET_ITEM(__pyx_t_12, 0+1, __pyx_v_y);
        __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_10, __pyx_t_12, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 134, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_4);
        __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
      }
      __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
      __pyx_t_10 = __Pyx_PyInt_EqObjC(__pyx_t_4, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 134, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_10);
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_10); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 134, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
      if (__pyx_t_5) {

        /* "vapor_vali/Simple_function.pyx":135
 *         for y in x:
 *             if x.count(y)==1:
 *                 out_new[-1].append(y)             # <<<<<<<<<<<<<<
 *     out_new_2=[]
 *     for x in out_new:
 */
        __pyx_t_10 = __Pyx_GetItemInt_List(__pyx_v_out_new, -1L, long, 1, __Pyx_PyInt_From_long, 1, 1, 1); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 135, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_10);
        __pyx_t_8 = __Pyx_PyObject_Append(__pyx_t_10, __pyx_v_y); if (unlikely(__pyx_t_8 == -1)) __PYX_ERR(0, 135, __pyx_L1_error)
        __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;

        /* "vapor_vali/Simple_function.pyx":134
 *         out_new.append([])
 *         for y in x:
 *             if x.count(y)==1:             # <<<<<<<<<<<<<<
 *                 out_new[-1].append(y)
 *     out_new_2=[]
 */
      }

      /* "vapor_vali/Simple_function.pyx":133
 *     for x in out:
 *         out_new.append([])
 *         for y in x:             # <<<<<<<<<<<<<<
 *             if x.count(y)==1:
 *                 out_new[-1].append(y)
 */
    }
    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;

    /* "vapor_vali/Simple_function.pyx":131
 *         else:   out[-1].append(x)
 *     out_new=[]
 *     for x in out:             # <<<<<<<<<<<<<<
 *         out_new.append([])
 *         for y in x:
 */
  }
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":136
 *             if x.count(y)==1:
 *                 out_new[-1].append(y)
 *     out_new_2=[]             # <<<<<<<<<<<<<<
 *     for x in out_new:
 *         if len(x)==3:
 */
  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 136, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_out_new_2 = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":137
 *                 out_new[-1].append(y)
 *     out_new_2=[]
 *     for x in out_new:             # <<<<<<<<<<<<<<
 *         if len(x)==3:
 *             out_new_2.append(x)
 */
  __pyx_t_1 = __pyx_v_out_new; __Pyx_INCREF(__pyx_t_1); __pyx_t_2 = 0;
  for (;;) {
    if (__pyx_t_2 >= PyList_GET_SIZE(__pyx_t_1)) break;
    #if CYTHON_COMPILING_IN_CPYTHON
    __pyx_t_7 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_7); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 137, __pyx_L1_error)
    #else
    __pyx_t_7 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 137, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    #endif
    __Pyx_XDECREF_SET(__pyx_v_x, __pyx_t_7);
    __pyx_t_7 = 0;

    /* "vapor_vali/Simple_function.pyx":138
 *     out_new_2=[]
 *     for x in out_new:
 *         if len(x)==3:             # <<<<<<<<<<<<<<
 *             out_new_2.append(x)
 *         else:
 */
    __pyx_t_9 = PyObject_Length(__pyx_v_x); if (unlikely(__pyx_t_9 == -1)) __PYX_ERR(0, 138, __pyx_L1_error)
    __pyx_t_5 = ((__pyx_t_9 == 3) != 0);
    if (__pyx_t_5) {

      /* "vapor_vali/Simple_function.pyx":139
 *     for x in out_new:
 *         if len(x)==3:
 *             out_new_2.append(x)             # <<<<<<<<<<<<<<
 *         else:
 *             for y in range((len(x)-1)/2):
 */
      __pyx_t_8 = __Pyx_PyList_Append(__pyx_v_out_new_2, __pyx_v_x); if (unlikely(__pyx_t_8 == -1)) __PYX_ERR(0, 139, __pyx_L1_error)

      /* "vapor_vali/Simple_function.pyx":138
 *     out_new_2=[]
 *     for x in out_new:
 *         if len(x)==3:             # <<<<<<<<<<<<<<
 *             out_new_2.append(x)
 *         else:
 */
      goto __pyx_L15;
    }

    /* "vapor_vali/Simple_function.pyx":141
 *             out_new_2.append(x)
 *         else:
 *             for y in range((len(x)-1)/2):             # <<<<<<<<<<<<<<
 *                 out_new_2.append([x[0],x[2*y+1],x[2*y+2]])
 *     return out_new_2
 */
    /*else*/ {
      __pyx_t_9 = PyObject_Length(__pyx_v_x); if (unlikely(__pyx_t_9 == -1)) __PYX_ERR(0, 141, __pyx_L1_error)
      __pyx_t_7 = PyInt_FromSsize_t(__Pyx_div_Py_ssize_t((__pyx_t_9 - 1), 2)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 141, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_7);
      __pyx_t_10 = PyTuple_New(1); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 141, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_10);
      __Pyx_GIVEREF(__pyx_t_7);
      PyTuple_SET_ITEM(__pyx_t_10, 0, __pyx_t_7);
      __pyx_t_7 = 0;
      __pyx_t_7 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_t_10, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 141, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_7);
      __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
      if (likely(PyList_CheckExact(__pyx_t_7)) || PyTuple_CheckExact(__pyx_t_7)) {
        __pyx_t_10 = __pyx_t_7; __Pyx_INCREF(__pyx_t_10); __pyx_t_9 = 0;
        __pyx_t_3 = NULL;
      } else {
        __pyx_t_9 = -1; __pyx_t_10 = PyObject_GetIter(__pyx_t_7); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 141, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_10);
        __pyx_t_3 = Py_TYPE(__pyx_t_10)->tp_iternext; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 141, __pyx_L1_error)
      }
      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
      for (;;) {
        if (likely(!__pyx_t_3)) {
          if (likely(PyList_CheckExact(__pyx_t_10))) {
            if (__pyx_t_9 >= PyList_GET_SIZE(__pyx_t_10)) break;
            #if CYTHON_COMPILING_IN_CPYTHON
            __pyx_t_7 = PyList_GET_ITEM(__pyx_t_10, __pyx_t_9); __Pyx_INCREF(__pyx_t_7); __pyx_t_9++; if (unlikely(0 < 0)) __PYX_ERR(0, 141, __pyx_L1_error)
            #else
            __pyx_t_7 = PySequence_ITEM(__pyx_t_10, __pyx_t_9); __pyx_t_9++; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 141, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_7);
            #endif
          } else {
            if (__pyx_t_9 >= PyTuple_GET_SIZE(__pyx_t_10)) break;
            #if CYTHON_COMPILING_IN_CPYTHON
            __pyx_t_7 = PyTuple_GET_ITEM(__pyx_t_10, __pyx_t_9); __Pyx_INCREF(__pyx_t_7); __pyx_t_9++; if (unlikely(0 < 0)) __PYX_ERR(0, 141, __pyx_L1_error)
            #else
            __pyx_t_7 = PySequence_ITEM(__pyx_t_10, __pyx_t_9); __pyx_t_9++; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 141, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_7);
            #endif
          }
        } else {
          __pyx_t_7 = __pyx_t_3(__pyx_t_10);
          if (unlikely(!__pyx_t_7)) {
            PyObject* exc_type = PyErr_Occurred();
            if (exc_type) {
              if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
              else __PYX_ERR(0, 141, __pyx_L1_error)
            }
            break;
          }
          __Pyx_GOTREF(__pyx_t_7);
        }
        __Pyx_XDECREF_SET(__pyx_v_y, __pyx_t_7);
        __pyx_t_7 = 0;

        /* "vapor_vali/Simple_function.pyx":142
 *         else:
 *             for y in range((len(x)-1)/2):
 *                 out_new_2.append([x[0],x[2*y+1],x[2*y+2]])             # <<<<<<<<<<<<<<
 *     return out_new_2
 * 
 */
        __pyx_t_7 = __Pyx_GetItemInt(__pyx_v_x, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 142, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_7);
        __pyx_t_4 = PyNumber_Multiply(__pyx_int_2, __pyx_v_y); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 142, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_4);
        __pyx_t_12 = __Pyx_PyInt_AddObjC(__pyx_t_4, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 142, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_12);
        __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
        __pyx_t_4 = PyObject_GetItem(__pyx_v_x, __pyx_t_12); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 142, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_4);
        __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
        __pyx_t_12 = PyNumber_Multiply(__pyx_int_2, __pyx_v_y); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 142, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_12);
        __pyx_t_11 = __Pyx_PyInt_AddObjC(__pyx_t_12, __pyx_int_2, 2, 0); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 142, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_11);
        __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
        __pyx_t_12 = PyObject_GetItem(__pyx_v_x, __pyx_t_11); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 142, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_12);
        __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
        __pyx_t_11 = PyList_New(3); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 142, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_11);
        __Pyx_GIVEREF(__pyx_t_7);
        PyList_SET_ITEM(__pyx_t_11, 0, __pyx_t_7);
        __Pyx_GIVEREF(__pyx_t_4);
        PyList_SET_ITEM(__pyx_t_11, 1, __pyx_t_4);
        __Pyx_GIVEREF(__pyx_t_12);
        PyList_SET_ITEM(__pyx_t_11, 2, __pyx_t_12);
        __pyx_t_7 = 0;
        __pyx_t_4 = 0;
        __pyx_t_12 = 0;
        __pyx_t_8 = __Pyx_PyList_Append(__pyx_v_out_new_2, __pyx_t_11); if (unlikely(__pyx_t_8 == -1)) __PYX_ERR(0, 142, __pyx_L1_error)
        __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;

        /* "vapor_vali/Simple_function.pyx":141
 *             out_new_2.append(x)
 *         else:
 *             for y in range((len(x)-1)/2):             # <<<<<<<<<<<<<<
 *                 out_new_2.append([x[0],x[2*y+1],x[2*y+2]])
 *     return out_new_2
 */
      }
      __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
    }
    __pyx_L15:;

    /* "vapor_vali/Simple_function.pyx":137
 *                 out_new[-1].append(y)
 *     out_new_2=[]
 *     for x in out_new:             # <<<<<<<<<<<<<<
 *         if len(x)==3:
 *             out_new_2.append(x)
 */
  }
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":143
 *             for y in range((len(x)-1)/2):
 *                 out_new_2.append([x[0],x[2*y+1],x[2*y+2]])
 *     return out_new_2             # <<<<<<<<<<<<<<
 * 
 * def block_subsplot(bp_list,chromos):
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_out_new_2);
  __pyx_r = __pyx_v_out_new_2;
  goto __pyx_L0;

  /* "vapor_vali/Simple_function.pyx":121
 *     return out
 * 
 * def block_modify(block,chromos):             # <<<<<<<<<<<<<<
 *     #eg of block=['chr16', '34911339', '34913149', 'chr16', '34913149', '34913438']
 *     out=[]
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_7);
  __Pyx_XDECREF(__pyx_t_10);
  __Pyx_XDECREF(__pyx_t_11);
  __Pyx_XDECREF(__pyx_t_12);
  __Pyx_AddTraceback("vapor_vali.Simple_function.block_modify", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_out);
  __Pyx_XDECREF(__pyx_v_x);
  __Pyx_XDECREF(__pyx_v_out_new);
  __Pyx_XDECREF(__pyx_v_y);
  __Pyx_XDECREF(__pyx_v_out_new_2);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "vapor_vali/Simple_function.pyx":145
 *     return out_new_2
 * 
 * def block_subsplot(bp_list,chromos):             # <<<<<<<<<<<<<<
 *     #eg of bp_list=['chr1', '9061390', '9061470', 'chr14', '93246136', '93248034']
 *     out=[]
 */

/* Python wrapper */
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_13block_subsplot(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_10vapor_vali_15Simple_function_13block_subsplot = {"block_subsplot", (PyCFunction)__pyx_pw_10vapor_vali_15Simple_function_13block_subsplot, METH_VARARGS|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_13block_subsplot(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_bp_list = 0;
  PyObject *__pyx_v_chromos = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("block_subsplot (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_bp_list,&__pyx_n_s_chromos,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_bp_list)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_chromos)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("block_subsplot", 1, 2, 2, 1); __PYX_ERR(0, 145, __pyx_L3_error)
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "block_subsplot") < 0)) __PYX_ERR(0, 145, __pyx_L3_error)
      }
    } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
    }
    __pyx_v_bp_list = values[0];
    __pyx_v_chromos = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("block_subsplot", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 145, __pyx_L3_error)
  __pyx_L3_error:;
  __Pyx_AddTraceback("vapor_vali.Simple_function.block_subsplot", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_10vapor_vali_15Simple_function_12block_subsplot(__pyx_self, __pyx_v_bp_list, __pyx_v_chromos);

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10vapor_vali_15Simple_function_12block_subsplot(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_bp_list, PyObject *__pyx_v_chromos) {
  PyObject *__pyx_v_out = NULL;
  PyObject *__pyx_v_x = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  Py_ssize_t __pyx_t_2;
  PyObject *(*__pyx_t_3)(PyObject *);
  PyObject *__pyx_t_4 = NULL;
  int __pyx_t_5;
  int __pyx_t_6;
  PyObject *__pyx_t_7 = NULL;
  int __pyx_t_8;
  __Pyx_RefNannySetupContext("block_subsplot", 0);

  /* "vapor_vali/Simple_function.pyx":147
 * def block_subsplot(bp_list,chromos):
 *     #eg of bp_list=['chr1', '9061390', '9061470', 'chr14', '93246136', '93248034']
 *     out=[]             # <<<<<<<<<<<<<<
 *     for x in bp_list:
 *         if not x in chromos:    out[-1].append(int(x))
 */
  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 147, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_out = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":148
 *     #eg of bp_list=['chr1', '9061390', '9061470', 'chr14', '93246136', '93248034']
 *     out=[]
 *     for x in bp_list:             # <<<<<<<<<<<<<<
 *         if not x in chromos:    out[-1].append(int(x))
 *         else:   out.append([x])
 */
  if (likely(PyList_CheckExact(__pyx_v_bp_list)) || PyTuple_CheckExact(__pyx_v_bp_list)) {
    __pyx_t_1 = __pyx_v_bp_list; __Pyx_INCREF(__pyx_t_1); __pyx_t_2 = 0;
    __pyx_t_3 = NULL;
  } else {
    __pyx_t_2 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_v_bp_list); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 148, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_3 = Py_TYPE(__pyx_t_1)->tp_iternext; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 148, __pyx_L1_error)
  }
  for (;;) {
    if (likely(!__pyx_t_3)) {
      if (likely(PyList_CheckExact(__pyx_t_1))) {
        if (__pyx_t_2 >= PyList_GET_SIZE(__pyx_t_1)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_4 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_4); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 148, __pyx_L1_error)
        #else
        __pyx_t_4 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 148, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_4);
        #endif
      } else {
        if (__pyx_t_2 >= PyTuple_GET_SIZE(__pyx_t_1)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_4 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_4); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 148, __pyx_L1_error)
        #else
        __pyx_t_4 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 148, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_4);
        #endif
      }
    } else {
      __pyx_t_4 = __pyx_t_3(__pyx_t_1);
      if (unlikely(!__pyx_t_4)) {
        PyObject* exc_type = PyErr_Occurred();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
          else __PYX_ERR(0, 148, __pyx_L1_error)
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_4);
    }
    __Pyx_XDECREF_SET(__pyx_v_x, __pyx_t_4);
    __pyx_t_4 = 0;

    /* "vapor_vali/Simple_function.pyx":149
 *     out=[]
 *     for x in bp_list:
 *         if not x in chromos:    out[-1].append(int(x))             # <<<<<<<<<<<<<<
 *         else:   out.append([x])
 *     return out
 */
    __pyx_t_5 = (__Pyx_PySequence_ContainsTF(__pyx_v_x, __pyx_v_chromos, Py_NE)); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 149, __pyx_L1_error)
    __pyx_t_6 = (__pyx_t_5 != 0);
    if (__pyx_t_6) {
      __pyx_t_4 = __Pyx_GetItemInt_List(__pyx_v_out, -1L, long, 1, __Pyx_PyInt_From_long, 1, 1, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 149, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_t_7 = __Pyx_PyNumber_Int(__pyx_v_x); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 149, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_7);
      __pyx_t_8 = __Pyx_PyObject_Append(__pyx_t_4, __pyx_t_7); if (unlikely(__pyx_t_8 == -1)) __PYX_ERR(0, 149, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
      goto __pyx_L5;
    }

    /* "vapor_vali/Simple_function.pyx":150
 *     for x in bp_list:
 *         if not x in chromos:    out[-1].append(int(x))
 *         else:   out.append([x])             # <<<<<<<<<<<<<<
 *     return out
 * 
 */
    /*else*/ {
      __pyx_t_7 = PyList_New(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 150, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_7);
      __Pyx_INCREF(__pyx_v_x);
      __Pyx_GIVEREF(__pyx_v_x);
      PyList_SET_ITEM(__pyx_t_7, 0, __pyx_v_x);
      __pyx_t_8 = __Pyx_PyList_Append(__pyx_v_out, __pyx_t_7); if (unlikely(__pyx_t_8 == -1)) __PYX_ERR(0, 150, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
    }
    __pyx_L5:;

    /* "vapor_vali/Simple_function.pyx":148
 *     #eg of bp_list=['chr1', '9061390', '9061470', 'chr14', '93246136', '93248034']
 *     out=[]
 *     for x in bp_list:             # <<<<<<<<<<<<<<
 *         if not x in chromos:    out[-1].append(int(x))
 *         else:   out.append([x])
 */
  }
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":151
 *         if not x in chromos:    out[-1].append(int(x))
 *         else:   out.append([x])
 *     return out             # <<<<<<<<<<<<<<
 * 
 * def calcu_log10(x):
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_out);
  __pyx_r = __pyx_v_out;
  goto __pyx_L0;

  /* "vapor_vali/Simple_function.pyx":145
 *     return out_new_2
 * 
 * def block_subsplot(bp_list,chromos):             # <<<<<<<<<<<<<<
 *     #eg of bp_list=['chr1', '9061390', '9061470', 'chr14', '93246136', '93248034']
 *     out=[]
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_7);
  __Pyx_AddTraceback("vapor_vali.Simple_function.block_subsplot", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_out);
  __Pyx_XDECREF(__pyx_v_x);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "vapor_vali/Simple_function.pyx":153
 *     return out
 * 
 * def calcu_log10(x):             # <<<<<<<<<<<<<<
 *     if x==0:
 *         return 0
 */

/* Python wrapper */
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_15calcu_log10(PyObject *__pyx_self, PyObject *__pyx_v_x); /*proto*/
static PyMethodDef __pyx_mdef_10vapor_vali_15Simple_function_15calcu_log10 = {"calcu_log10", (PyCFunction)__pyx_pw_10vapor_vali_15Simple_function_15calcu_log10, METH_O, 0};
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_15calcu_log10(PyObject *__pyx_self, PyObject *__pyx_v_x) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("calcu_log10 (wrapper)", 0);
  __pyx_r = __pyx_pf_10vapor_vali_15Simple_function_14calcu_log10(__pyx_self, ((PyObject *)__pyx_v_x));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10vapor_vali_15Simple_function_14calcu_log10(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_x) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_t_2;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  __Pyx_RefNannySetupContext("calcu_log10", 0);

  /* "vapor_vali/Simple_function.pyx":154
 * 
 * def calcu_log10(x):
 *     if x==0:             # <<<<<<<<<<<<<<
 *         return 0
 *     else:
 */
  __pyx_t_1 = __Pyx_PyInt_EqObjC(__pyx_v_x, __pyx_int_0, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 154, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 154, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  if (__pyx_t_2) {

    /* "vapor_vali/Simple_function.pyx":155
 * def calcu_log10(x):
 *     if x==0:
 *         return 0             # <<<<<<<<<<<<<<
 *     else:
 *         return np.log10(x)
 */
    __Pyx_XDECREF(__pyx_r);
    __Pyx_INCREF(__pyx_int_0);
    __pyx_r = __pyx_int_0;
    goto __pyx_L0;

    /* "vapor_vali/Simple_function.pyx":154
 * 
 * def calcu_log10(x):
 *     if x==0:             # <<<<<<<<<<<<<<
 *         return 0
 *     else:
 */
  }

  /* "vapor_vali/Simple_function.pyx":157
 *         return 0
 *     else:
 *         return np.log10(x)             # <<<<<<<<<<<<<<
 * 
 * def calcu_vapor_single_read_score_abs_dis_m1(ref_seq,alt_seq,x,window_size):
 */
  /*else*/ {
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 157, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_log10); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 157, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_4))) {
      __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_4);
      if (likely(__pyx_t_3)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
        __Pyx_INCREF(__pyx_t_3);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_4, function);
      }
    }
    if (!__pyx_t_3) {
      __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_v_x); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 157, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
    } else {
      __pyx_t_5 = PyTuple_New(1+1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 157, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_5);
      __Pyx_GIVEREF(__pyx_t_3); PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_3); __pyx_t_3 = NULL;
      __Pyx_INCREF(__pyx_v_x);
      __Pyx_GIVEREF(__pyx_v_x);
      PyTuple_SET_ITEM(__pyx_t_5, 0+1, __pyx_v_x);
      __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_5, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 157, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    }
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;
  }

  /* "vapor_vali/Simple_function.pyx":153
 *     return out
 * 
 * def calcu_log10(x):             # <<<<<<<<<<<<<<
 *     if x==0:
 *         return 0
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_AddTraceback("vapor_vali.Simple_function.calcu_log10", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "vapor_vali/Simple_function.pyx":159
 *         return np.log10(x)
 * 
 * def calcu_vapor_single_read_score_abs_dis_m1(ref_seq,alt_seq,x,window_size):             # <<<<<<<<<<<<<<
 *     ref_dotdata=dotdata(window_size,x[0],ref_seq[x[1]:])
 *     alt_dotdata=dotdata(window_size,x[0],alt_seq[x[1]:])
 */

/* Python wrapper */
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_17calcu_vapor_single_read_score_abs_dis_m1(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_10vapor_vali_15Simple_function_17calcu_vapor_single_read_score_abs_dis_m1 = {"calcu_vapor_single_read_score_abs_dis_m1", (PyCFunction)__pyx_pw_10vapor_vali_15Simple_function_17calcu_vapor_single_read_score_abs_dis_m1, METH_VARARGS|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_17calcu_vapor_single_read_score_abs_dis_m1(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_ref_seq = 0;
  PyObject *__pyx_v_alt_seq = 0;
  PyObject *__pyx_v_x = 0;
  PyObject *__pyx_v_window_size = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("calcu_vapor_single_read_score_abs_dis_m1 (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_ref_seq,&__pyx_n_s_alt_seq,&__pyx_n_s_x,&__pyx_n_s_window_size,0};
    PyObject* values[4] = {0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
      switch (pos_args) {
        case  4: values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
        case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_ref_seq)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_alt_seq)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("calcu_vapor_single_read_score_abs_dis_m1", 1, 4, 4, 1); __PYX_ERR(0, 159, __pyx_L3_error)
        }
        case  2:
        if (likely((values[2] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_x)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("calcu_vapor_single_read_score_abs_dis_m1", 1, 4, 4, 2); __PYX_ERR(0, 159, __pyx_L3_error)
        }
        case  3:
        if (likely((values[3] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_window_size)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("calcu_vapor_single_read_score_abs_dis_m1", 1, 4, 4, 3); __PYX_ERR(0, 159, __pyx_L3_error)
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "calcu_vapor_single_read_score_abs_dis_m1") < 0)) __PYX_ERR(0, 159, __pyx_L3_error)
      }
    } else if (PyTuple_GET_SIZE(__pyx_args) != 4) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
      values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
    }
    __pyx_v_ref_seq = values[0];
    __pyx_v_alt_seq = values[1];
    __pyx_v_x = values[2];
    __pyx_v_window_size = values[3];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("calcu_vapor_single_read_score_abs_dis_m1", 1, 4, 4, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 159, __pyx_L3_error)
  __pyx_L3_error:;
  __Pyx_AddTraceback("vapor_vali.Simple_function.calcu_vapor_single_read_score_abs_dis_m1", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_10vapor_vali_15Simple_function_16calcu_vapor_single_read_score_abs_dis_m1(__pyx_self, __pyx_v_ref_seq, __pyx_v_alt_seq, __pyx_v_x, __pyx_v_window_size);

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10vapor_vali_15Simple_function_16calcu_vapor_single_read_score_abs_dis_m1(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_ref_seq, PyObject *__pyx_v_alt_seq, PyObject *__pyx_v_x, PyObject *__pyx_v_window_size) {
  PyObject *__pyx_v_ref_dotdata = NULL;
  PyObject *__pyx_v_alt_dotdata = NULL;
  PyObject *__pyx_v_ref_clean_dotdata = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_ref_kept_segs = NULL;
  PyObject *__pyx_v_alt_clean_dotdata = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_alt_kept_segs = NULL;
  PyObject *__pyx_v_ref_left = NULL;
  PyObject *__pyx_v_alt_left = NULL;
  PyObject *__pyx_v_ref_anti_diag_clean_dotdata = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_ref_anti_diag_kept_segs = NULL;
  PyObject *__pyx_v_alt_anti_diag_clean_dotdata = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_alt_anti_diag_kept_segs = NULL;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  Py_ssize_t __pyx_t_6;
  PyObject *__pyx_t_7 = NULL;
  int __pyx_t_8;
  Py_ssize_t __pyx_t_9;
  int __pyx_t_10;
  double __pyx_t_11;
  PyObject *(*__pyx_t_12)(PyObject *);
  PyObject *(*__pyx_t_13)(PyObject *);
  __Pyx_RefNannySetupContext("calcu_vapor_single_read_score_abs_dis_m1", 0);

  /* "vapor_vali/Simple_function.pyx":160
 * 
 * def calcu_vapor_single_read_score_abs_dis_m1(ref_seq,alt_seq,x,window_size):
 *     ref_dotdata=dotdata(window_size,x[0],ref_seq[x[1]:])             # <<<<<<<<<<<<<<
 *     alt_dotdata=dotdata(window_size,x[0],alt_seq[x[1]:])
 *     if float(len(ref_dotdata))/float(len(ref_seq))>0.1 and float(len(alt_dotdata))/float(len(alt_seq))>0.1 and float(ref_dotdata[-1][0]-ref_dotdata[0][0])/float(len(ref_seq))>0.7 and float(alt_dotdata[-1][0]-alt_dotdata[0][0])/float(len(alt_seq))>0.7:
 */
  __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_dotdata); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 160, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_x, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 160, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_4 = __Pyx_GetItemInt(__pyx_v_x, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 160, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_5 = __Pyx_PyObject_GetSlice(__pyx_v_ref_seq, 0, 0, &__pyx_t_4, NULL, NULL, 0, 0, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 160, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = NULL;
  __pyx_t_6 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_2);
    if (likely(__pyx_t_4)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_4);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_2, function);
      __pyx_t_6 = 1;
    }
  }
  __pyx_t_7 = PyTuple_New(3+__pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 160, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  if (__pyx_t_4) {
    __Pyx_GIVEREF(__pyx_t_4); PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_4); __pyx_t_4 = NULL;
  }
  __Pyx_INCREF(__pyx_v_window_size);
  __Pyx_GIVEREF(__pyx_v_window_size);
  PyTuple_SET_ITEM(__pyx_t_7, 0+__pyx_t_6, __pyx_v_window_size);
  __Pyx_GIVEREF(__pyx_t_3);
  PyTuple_SET_ITEM(__pyx_t_7, 1+__pyx_t_6, __pyx_t_3);
  __Pyx_GIVEREF(__pyx_t_5);
  PyTuple_SET_ITEM(__pyx_t_7, 2+__pyx_t_6, __pyx_t_5);
  __pyx_t_3 = 0;
  __pyx_t_5 = 0;
  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_7, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 160, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_ref_dotdata = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":161
 * def calcu_vapor_single_read_score_abs_dis_m1(ref_seq,alt_seq,x,window_size):
 *     ref_dotdata=dotdata(window_size,x[0],ref_seq[x[1]:])
 *     alt_dotdata=dotdata(window_size,x[0],alt_seq[x[1]:])             # <<<<<<<<<<<<<<
 *     if float(len(ref_dotdata))/float(len(ref_seq))>0.1 and float(len(alt_dotdata))/float(len(alt_seq))>0.1 and float(ref_dotdata[-1][0]-ref_dotdata[0][0])/float(len(ref_seq))>0.7 and float(alt_dotdata[-1][0]-alt_dotdata[0][0])/float(len(alt_seq))>0.7:
 *         [ref_clean_dotdata,ref_kept_segs]=clean_dotdata_m1(ref_dotdata)
 */
  __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_dotdata); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 161, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_7 = __Pyx_GetItemInt(__pyx_v_x, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 161, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  __pyx_t_5 = __Pyx_GetItemInt(__pyx_v_x, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 161, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_3 = __Pyx_PyObject_GetSlice(__pyx_v_alt_seq, 0, 0, &__pyx_t_5, NULL, NULL, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 161, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = NULL;
  __pyx_t_6 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_2);
    if (likely(__pyx_t_5)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_5);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_2, function);
      __pyx_t_6 = 1;
    }
  }
  __pyx_t_4 = PyTuple_New(3+__pyx_t_6); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 161, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  if (__pyx_t_5) {
    __Pyx_GIVEREF(__pyx_t_5); PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_5); __pyx_t_5 = NULL;
  }
  __Pyx_INCREF(__pyx_v_window_size);
  __Pyx_GIVEREF(__pyx_v_window_size);
  PyTuple_SET_ITEM(__pyx_t_4, 0+__pyx_t_6, __pyx_v_window_size);
  __Pyx_GIVEREF(__pyx_t_7);
  PyTuple_SET_ITEM(__pyx_t_4, 1+__pyx_t_6, __pyx_t_7);
  __Pyx_GIVEREF(__pyx_t_3);
  PyTuple_SET_ITEM(__pyx_t_4, 2+__pyx_t_6, __pyx_t_3);
  __pyx_t_7 = 0;
  __pyx_t_3 = 0;
  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_4, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 161, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_alt_dotdata = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":162
 *     ref_dotdata=dotdata(window_size,x[0],ref_seq[x[1]:])
 *     alt_dotdata=dotdata(window_size,x[0],alt_seq[x[1]:])
 *     if float(len(ref_dotdata))/float(len(ref_seq))>0.1 and float(len(alt_dotdata))/float(len(alt_seq))>0.1 and float(ref_dotdata[-1][0]-ref_dotdata[0][0])/float(len(ref_seq))>0.7 and float(alt_dotdata[-1][0]-alt_dotdata[0][0])/float(len(alt_seq))>0.7:             # <<<<<<<<<<<<<<
 *         [ref_clean_dotdata,ref_kept_segs]=clean_dotdata_m1(ref_dotdata)
 *         [alt_clean_dotdata,alt_kept_segs]=clean_dotdata_m1(alt_dotdata)
 */
  __pyx_t_6 = PyObject_Length(__pyx_v_ref_dotdata); if (unlikely(__pyx_t_6 == -1)) __PYX_ERR(0, 162, __pyx_L1_error)
  __pyx_t_9 = PyObject_Length(__pyx_v_ref_seq); if (unlikely(__pyx_t_9 == -1)) __PYX_ERR(0, 162, __pyx_L1_error)
  if (unlikely(((double)__pyx_t_9) == 0)) {
    PyErr_SetString(PyExc_ZeroDivisionError, "float division");
    __PYX_ERR(0, 162, __pyx_L1_error)
  }
  __pyx_t_10 = (((((double)__pyx_t_6) / ((double)__pyx_t_9)) > 0.1) != 0);
  if (__pyx_t_10) {
  } else {
    __pyx_t_8 = __pyx_t_10;
    goto __pyx_L4_bool_binop_done;
  }
  __pyx_t_9 = PyObject_Length(__pyx_v_alt_dotdata); if (unlikely(__pyx_t_9 == -1)) __PYX_ERR(0, 162, __pyx_L1_error)
  __pyx_t_6 = PyObject_Length(__pyx_v_alt_seq); if (unlikely(__pyx_t_6 == -1)) __PYX_ERR(0, 162, __pyx_L1_error)
  if (unlikely(((double)__pyx_t_6) == 0)) {
    PyErr_SetString(PyExc_ZeroDivisionError, "float division");
    __PYX_ERR(0, 162, __pyx_L1_error)
  }
  __pyx_t_10 = (((((double)__pyx_t_9) / ((double)__pyx_t_6)) > 0.1) != 0);
  if (__pyx_t_10) {
  } else {
    __pyx_t_8 = __pyx_t_10;
    goto __pyx_L4_bool_binop_done;
  }
  __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_ref_dotdata, -1L, long, 1, __Pyx_PyInt_From_long, 0, 1, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 162, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_GetItemInt(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 162, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_ref_dotdata, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 162, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_4 = __Pyx_GetItemInt(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 162, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = PyNumber_Subtract(__pyx_t_2, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 162, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_11 = __Pyx_PyObject_AsDouble(__pyx_t_1); if (unlikely(__pyx_t_11 == ((double)-1) && PyErr_Occurred())) __PYX_ERR(0, 162, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_6 = PyObject_Length(__pyx_v_ref_seq); if (unlikely(__pyx_t_6 == -1)) __PYX_ERR(0, 162, __pyx_L1_error)
  if (unlikely(((double)__pyx_t_6) == 0)) {
    PyErr_SetString(PyExc_ZeroDivisionError, "float division");
    __PYX_ERR(0, 162, __pyx_L1_error)
  }
  __pyx_t_10 = (((__pyx_t_11 / ((double)__pyx_t_6)) > 0.7) != 0);
  if (__pyx_t_10) {
  } else {
    __pyx_t_8 = __pyx_t_10;
    goto __pyx_L4_bool_binop_done;
  }
  __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_alt_dotdata, -1L, long, 1, __Pyx_PyInt_From_long, 0, 1, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 162, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_4 = __Pyx_GetItemInt(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 162, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_alt_dotdata, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 162, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_GetItemInt(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 162, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = PyNumber_Subtract(__pyx_t_4, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 162, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_11 = __Pyx_PyObject_AsDouble(__pyx_t_1); if (unlikely(__pyx_t_11 == ((double)-1) && PyErr_Occurred())) __PYX_ERR(0, 162, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_6 = PyObject_Length(__pyx_v_alt_seq); if (unlikely(__pyx_t_6 == -1)) __PYX_ERR(0, 162, __pyx_L1_error)
  if (unlikely(((double)__pyx_t_6) == 0)) {
    PyErr_SetString(PyExc_ZeroDivisionError, "float division");
    __PYX_ERR(0, 162, __pyx_L1_error)
  }
  __pyx_t_10 = (((__pyx_t_11 / ((double)__pyx_t_6)) > 0.7) != 0);
  __pyx_t_8 = __pyx_t_10;
  __pyx_L4_bool_binop_done:;
  if (__pyx_t_8) {

    /* "vapor_vali/Simple_function.pyx":163
 *     alt_dotdata=dotdata(window_size,x[0],alt_seq[x[1]:])
 *     if float(len(ref_dotdata))/float(len(ref_seq))>0.1 and float(len(alt_dotdata))/float(len(alt_seq))>0.1 and float(ref_dotdata[-1][0]-ref_dotdata[0][0])/float(len(ref_seq))>0.7 and float(alt_dotdata[-1][0]-alt_dotdata[0][0])/float(len(alt_seq))>0.7:
 *         [ref_clean_dotdata,ref_kept_segs]=clean_dotdata_m1(ref_dotdata)             # <<<<<<<<<<<<<<
 *         [alt_clean_dotdata,alt_kept_segs]=clean_dotdata_m1(alt_dotdata)
 *         ref_left=[i for i in ref_dotdata if not list(i) in ref_clean_dotdata]
 */
    __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_clean_dotdata_m1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 163, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_4 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_2))) {
      __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_2);
      if (likely(__pyx_t_4)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
        __Pyx_INCREF(__pyx_t_4);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_2, function);
      }
    }
    if (!__pyx_t_4) {
      __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_v_ref_dotdata); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 163, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
    } else {
      __pyx_t_3 = PyTuple_New(1+1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 163, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __Pyx_GIVEREF(__pyx_t_4); PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_4); __pyx_t_4 = NULL;
      __Pyx_INCREF(__pyx_v_ref_dotdata);
      __Pyx_GIVEREF(__pyx_v_ref_dotdata);
      PyTuple_SET_ITEM(__pyx_t_3, 0+1, __pyx_v_ref_dotdata);
      __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_3, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 163, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    }
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    if ((likely(PyTuple_CheckExact(__pyx_t_1))) || (PyList_CheckExact(__pyx_t_1))) {
      PyObject* sequence = __pyx_t_1;
      #if CYTHON_COMPILING_IN_CPYTHON
      Py_ssize_t size = Py_SIZE(sequence);
      #else
      Py_ssize_t size = PySequence_Size(sequence);
      #endif
      if (unlikely(size != 2)) {
        if (size > 2) __Pyx_RaiseTooManyValuesError(2);
        else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
        __PYX_ERR(0, 163, __pyx_L1_error)
      }
      #if CYTHON_COMPILING_IN_CPYTHON
      if (likely(PyTuple_CheckExact(sequence))) {
        __pyx_t_2 = PyTuple_GET_ITEM(sequence, 0); 
        __pyx_t_3 = PyTuple_GET_ITEM(sequence, 1); 
      } else {
        __pyx_t_2 = PyList_GET_ITEM(sequence, 0); 
        __pyx_t_3 = PyList_GET_ITEM(sequence, 1); 
      }
      __Pyx_INCREF(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_3);
      #else
      __pyx_t_2 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 163, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __pyx_t_3 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 163, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      #endif
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    } else {
      Py_ssize_t index = -1;
      __pyx_t_4 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 163, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_12 = Py_TYPE(__pyx_t_4)->tp_iternext;
      index = 0; __pyx_t_2 = __pyx_t_12(__pyx_t_4); if (unlikely(!__pyx_t_2)) goto __pyx_L8_unpacking_failed;
      __Pyx_GOTREF(__pyx_t_2);
      index = 1; __pyx_t_3 = __pyx_t_12(__pyx_t_4); if (unlikely(!__pyx_t_3)) goto __pyx_L8_unpacking_failed;
      __Pyx_GOTREF(__pyx_t_3);
      if (__Pyx_IternextUnpackEndCheck(__pyx_t_12(__pyx_t_4), 2) < 0) __PYX_ERR(0, 163, __pyx_L1_error)
      __pyx_t_12 = NULL;
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      goto __pyx_L9_unpacking_done;
      __pyx_L8_unpacking_failed:;
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_12 = NULL;
      if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
      __PYX_ERR(0, 163, __pyx_L1_error)
      __pyx_L9_unpacking_done:;
    }
    __pyx_v_ref_clean_dotdata = __pyx_t_2;
    __pyx_t_2 = 0;
    __pyx_v_ref_kept_segs = __pyx_t_3;
    __pyx_t_3 = 0;

    /* "vapor_vali/Simple_function.pyx":164
 *     if float(len(ref_dotdata))/float(len(ref_seq))>0.1 and float(len(alt_dotdata))/float(len(alt_seq))>0.1 and float(ref_dotdata[-1][0]-ref_dotdata[0][0])/float(len(ref_seq))>0.7 and float(alt_dotdata[-1][0]-alt_dotdata[0][0])/float(len(alt_seq))>0.7:
 *         [ref_clean_dotdata,ref_kept_segs]=clean_dotdata_m1(ref_dotdata)
 *         [alt_clean_dotdata,alt_kept_segs]=clean_dotdata_m1(alt_dotdata)             # <<<<<<<<<<<<<<
 *         ref_left=[i for i in ref_dotdata if not list(i) in ref_clean_dotdata]
 *         alt_left=[i for i in alt_dotdata if not list(i) in alt_clean_dotdata]
 */
    __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_clean_dotdata_m1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 164, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_2 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_3))) {
      __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_3);
      if (likely(__pyx_t_2)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
        __Pyx_INCREF(__pyx_t_2);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_3, function);
      }
    }
    if (!__pyx_t_2) {
      __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_v_alt_dotdata); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 164, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
    } else {
      __pyx_t_4 = PyTuple_New(1+1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 164, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      __Pyx_GIVEREF(__pyx_t_2); PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_2); __pyx_t_2 = NULL;
      __Pyx_INCREF(__pyx_v_alt_dotdata);
      __Pyx_GIVEREF(__pyx_v_alt_dotdata);
      PyTuple_SET_ITEM(__pyx_t_4, 0+1, __pyx_v_alt_dotdata);
      __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_4, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 164, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    }
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    if ((likely(PyTuple_CheckExact(__pyx_t_1))) || (PyList_CheckExact(__pyx_t_1))) {
      PyObject* sequence = __pyx_t_1;
      #if CYTHON_COMPILING_IN_CPYTHON
      Py_ssize_t size = Py_SIZE(sequence);
      #else
      Py_ssize_t size = PySequence_Size(sequence);
      #endif
      if (unlikely(size != 2)) {
        if (size > 2) __Pyx_RaiseTooManyValuesError(2);
        else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
        __PYX_ERR(0, 164, __pyx_L1_error)
      }
      #if CYTHON_COMPILING_IN_CPYTHON
      if (likely(PyTuple_CheckExact(sequence))) {
        __pyx_t_3 = PyTuple_GET_ITEM(sequence, 0); 
        __pyx_t_4 = PyTuple_GET_ITEM(sequence, 1); 
      } else {
        __pyx_t_3 = PyList_GET_ITEM(sequence, 0); 
        __pyx_t_4 = PyList_GET_ITEM(sequence, 1); 
      }
      __Pyx_INCREF(__pyx_t_3);
      __Pyx_INCREF(__pyx_t_4);
      #else
      __pyx_t_3 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 164, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __pyx_t_4 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 164, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      #endif
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    } else {
      Py_ssize_t index = -1;
      __pyx_t_2 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 164, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_12 = Py_TYPE(__pyx_t_2)->tp_iternext;
      index = 0; __pyx_t_3 = __pyx_t_12(__pyx_t_2); if (unlikely(!__pyx_t_3)) goto __pyx_L10_unpacking_failed;
      __Pyx_GOTREF(__pyx_t_3);
      index = 1; __pyx_t_4 = __pyx_t_12(__pyx_t_2); if (unlikely(!__pyx_t_4)) goto __pyx_L10_unpacking_failed;
      __Pyx_GOTREF(__pyx_t_4);
      if (__Pyx_IternextUnpackEndCheck(__pyx_t_12(__pyx_t_2), 2) < 0) __PYX_ERR(0, 164, __pyx_L1_error)
      __pyx_t_12 = NULL;
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      goto __pyx_L11_unpacking_done;
      __pyx_L10_unpacking_failed:;
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_12 = NULL;
      if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
      __PYX_ERR(0, 164, __pyx_L1_error)
      __pyx_L11_unpacking_done:;
    }
    __pyx_v_alt_clean_dotdata = __pyx_t_3;
    __pyx_t_3 = 0;
    __pyx_v_alt_kept_segs = __pyx_t_4;
    __pyx_t_4 = 0;

    /* "vapor_vali/Simple_function.pyx":165
 *         [ref_clean_dotdata,ref_kept_segs]=clean_dotdata_m1(ref_dotdata)
 *         [alt_clean_dotdata,alt_kept_segs]=clean_dotdata_m1(alt_dotdata)
 *         ref_left=[i for i in ref_dotdata if not list(i) in ref_clean_dotdata]             # <<<<<<<<<<<<<<
 *         alt_left=[i for i in alt_dotdata if not list(i) in alt_clean_dotdata]
 *         [ref_anti_diag_clean_dotdata,ref_anti_diag_kept_segs]=clean_dotdata_anti_diagnal_m1b(ref_left)
 */
    __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 165, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    if (likely(PyList_CheckExact(__pyx_v_ref_dotdata)) || PyTuple_CheckExact(__pyx_v_ref_dotdata)) {
      __pyx_t_4 = __pyx_v_ref_dotdata; __Pyx_INCREF(__pyx_t_4); __pyx_t_6 = 0;
      __pyx_t_13 = NULL;
    } else {
      __pyx_t_6 = -1; __pyx_t_4 = PyObject_GetIter(__pyx_v_ref_dotdata); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 165, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_t_13 = Py_TYPE(__pyx_t_4)->tp_iternext; if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 165, __pyx_L1_error)
    }
    for (;;) {
      if (likely(!__pyx_t_13)) {
        if (likely(PyList_CheckExact(__pyx_t_4))) {
          if (__pyx_t_6 >= PyList_GET_SIZE(__pyx_t_4)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_3 = PyList_GET_ITEM(__pyx_t_4, __pyx_t_6); __Pyx_INCREF(__pyx_t_3); __pyx_t_6++; if (unlikely(0 < 0)) __PYX_ERR(0, 165, __pyx_L1_error)
          #else
          __pyx_t_3 = PySequence_ITEM(__pyx_t_4, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 165, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_3);
          #endif
        } else {
          if (__pyx_t_6 >= PyTuple_GET_SIZE(__pyx_t_4)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_3 = PyTuple_GET_ITEM(__pyx_t_4, __pyx_t_6); __Pyx_INCREF(__pyx_t_3); __pyx_t_6++; if (unlikely(0 < 0)) __PYX_ERR(0, 165, __pyx_L1_error)
          #else
          __pyx_t_3 = PySequence_ITEM(__pyx_t_4, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 165, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_3);
          #endif
        }
      } else {
        __pyx_t_3 = __pyx_t_13(__pyx_t_4);
        if (unlikely(!__pyx_t_3)) {
          PyObject* exc_type = PyErr_Occurred();
          if (exc_type) {
            if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
            else __PYX_ERR(0, 165, __pyx_L1_error)
          }
          break;
        }
        __Pyx_GOTREF(__pyx_t_3);
      }
      __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_3);
      __pyx_t_3 = 0;
      __pyx_t_3 = PySequence_List(__pyx_v_i); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 165, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __pyx_t_8 = (__Pyx_PySequence_ContainsTF(__pyx_t_3, __pyx_v_ref_clean_dotdata, Py_NE)); if (unlikely(__pyx_t_8 < 0)) __PYX_ERR(0, 165, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_10 = (__pyx_t_8 != 0);
      if (__pyx_t_10) {
        if (unlikely(__Pyx_ListComp_Append(__pyx_t_1, (PyObject*)__pyx_v_i))) __PYX_ERR(0, 165, __pyx_L1_error)
      }
    }
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_v_ref_left = ((PyObject*)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "vapor_vali/Simple_function.pyx":166
 *         [alt_clean_dotdata,alt_kept_segs]=clean_dotdata_m1(alt_dotdata)
 *         ref_left=[i for i in ref_dotdata if not list(i) in ref_clean_dotdata]
 *         alt_left=[i for i in alt_dotdata if not list(i) in alt_clean_dotdata]             # <<<<<<<<<<<<<<
 *         [ref_anti_diag_clean_dotdata,ref_anti_diag_kept_segs]=clean_dotdata_anti_diagnal_m1b(ref_left)
 *         [alt_anti_diag_clean_dotdata,alt_anti_diag_kept_segs]=clean_dotdata_anti_diagnal_m1b(alt_left)
 */
    __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 166, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    if (likely(PyList_CheckExact(__pyx_v_alt_dotdata)) || PyTuple_CheckExact(__pyx_v_alt_dotdata)) {
      __pyx_t_4 = __pyx_v_alt_dotdata; __Pyx_INCREF(__pyx_t_4); __pyx_t_6 = 0;
      __pyx_t_13 = NULL;
    } else {
      __pyx_t_6 = -1; __pyx_t_4 = PyObject_GetIter(__pyx_v_alt_dotdata); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 166, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_t_13 = Py_TYPE(__pyx_t_4)->tp_iternext; if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 166, __pyx_L1_error)
    }
    for (;;) {
      if (likely(!__pyx_t_13)) {
        if (likely(PyList_CheckExact(__pyx_t_4))) {
          if (__pyx_t_6 >= PyList_GET_SIZE(__pyx_t_4)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_3 = PyList_GET_ITEM(__pyx_t_4, __pyx_t_6); __Pyx_INCREF(__pyx_t_3); __pyx_t_6++; if (unlikely(0 < 0)) __PYX_ERR(0, 166, __pyx_L1_error)
          #else
          __pyx_t_3 = PySequence_ITEM(__pyx_t_4, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 166, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_3);
          #endif
        } else {
          if (__pyx_t_6 >= PyTuple_GET_SIZE(__pyx_t_4)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_3 = PyTuple_GET_ITEM(__pyx_t_4, __pyx_t_6); __Pyx_INCREF(__pyx_t_3); __pyx_t_6++; if (unlikely(0 < 0)) __PYX_ERR(0, 166, __pyx_L1_error)
          #else
          __pyx_t_3 = PySequence_ITEM(__pyx_t_4, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 166, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_3);
          #endif
        }
      } else {
        __pyx_t_3 = __pyx_t_13(__pyx_t_4);
        if (unlikely(!__pyx_t_3)) {
          PyObject* exc_type = PyErr_Occurred();
          if (exc_type) {
            if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
            else __PYX_ERR(0, 166, __pyx_L1_error)
          }
          break;
        }
        __Pyx_GOTREF(__pyx_t_3);
      }
      __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_3);
      __pyx_t_3 = 0;
      __pyx_t_3 = PySequence_List(__pyx_v_i); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 166, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __pyx_t_10 = (__Pyx_PySequence_ContainsTF(__pyx_t_3, __pyx_v_alt_clean_dotdata, Py_NE)); if (unlikely(__pyx_t_10 < 0)) __PYX_ERR(0, 166, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_8 = (__pyx_t_10 != 0);
      if (__pyx_t_8) {
        if (unlikely(__Pyx_ListComp_Append(__pyx_t_1, (PyObject*)__pyx_v_i))) __PYX_ERR(0, 166, __pyx_L1_error)
      }
    }
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_v_alt_left = ((PyObject*)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "vapor_vali/Simple_function.pyx":167
 *         ref_left=[i for i in ref_dotdata if not list(i) in ref_clean_dotdata]
 *         alt_left=[i for i in alt_dotdata if not list(i) in alt_clean_dotdata]
 *         [ref_anti_diag_clean_dotdata,ref_anti_diag_kept_segs]=clean_dotdata_anti_diagnal_m1b(ref_left)             # <<<<<<<<<<<<<<
 *         [alt_anti_diag_clean_dotdata,alt_anti_diag_kept_segs]=clean_dotdata_anti_diagnal_m1b(alt_left)
 *         ref_clean_dotdata+=ref_anti_diag_clean_dotdata
 */
    __pyx_t_4 = __Pyx_GetModuleGlobalName(__pyx_n_s_clean_dotdata_anti_diagnal_m1b); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 167, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_3 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_4))) {
      __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_4);
      if (likely(__pyx_t_3)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
        __Pyx_INCREF(__pyx_t_3);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_4, function);
      }
    }
    if (!__pyx_t_3) {
      __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_v_ref_left); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 167, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
    } else {
      __pyx_t_2 = PyTuple_New(1+1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 167, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __Pyx_GIVEREF(__pyx_t_3); PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_3); __pyx_t_3 = NULL;
      __Pyx_INCREF(__pyx_v_ref_left);
      __Pyx_GIVEREF(__pyx_v_ref_left);
      PyTuple_SET_ITEM(__pyx_t_2, 0+1, __pyx_v_ref_left);
      __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_2, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 167, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    }
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    if ((likely(PyTuple_CheckExact(__pyx_t_1))) || (PyList_CheckExact(__pyx_t_1))) {
      PyObject* sequence = __pyx_t_1;
      #if CYTHON_COMPILING_IN_CPYTHON
      Py_ssize_t size = Py_SIZE(sequence);
      #else
      Py_ssize_t size = PySequence_Size(sequence);
      #endif
      if (unlikely(size != 2)) {
        if (size > 2) __Pyx_RaiseTooManyValuesError(2);
        else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
        __PYX_ERR(0, 167, __pyx_L1_error)
      }
      #if CYTHON_COMPILING_IN_CPYTHON
      if (likely(PyTuple_CheckExact(sequence))) {
        __pyx_t_4 = PyTuple_GET_ITEM(sequence, 0); 
        __pyx_t_2 = PyTuple_GET_ITEM(sequence, 1); 
      } else {
        __pyx_t_4 = PyList_GET_ITEM(sequence, 0); 
        __pyx_t_2 = PyList_GET_ITEM(sequence, 1); 
      }
      __Pyx_INCREF(__pyx_t_4);
      __Pyx_INCREF(__pyx_t_2);
      #else
      __pyx_t_4 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 167, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_t_2 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 167, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      #endif
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    } else {
      Py_ssize_t index = -1;
      __pyx_t_3 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 167, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_12 = Py_TYPE(__pyx_t_3)->tp_iternext;
      index = 0; __pyx_t_4 = __pyx_t_12(__pyx_t_3); if (unlikely(!__pyx_t_4)) goto __pyx_L18_unpacking_failed;
      __Pyx_GOTREF(__pyx_t_4);
      index = 1; __pyx_t_2 = __pyx_t_12(__pyx_t_3); if (unlikely(!__pyx_t_2)) goto __pyx_L18_unpacking_failed;
      __Pyx_GOTREF(__pyx_t_2);
      if (__Pyx_IternextUnpackEndCheck(__pyx_t_12(__pyx_t_3), 2) < 0) __PYX_ERR(0, 167, __pyx_L1_error)
      __pyx_t_12 = NULL;
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      goto __pyx_L19_unpacking_done;
      __pyx_L18_unpacking_failed:;
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_12 = NULL;
      if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
      __PYX_ERR(0, 167, __pyx_L1_error)
      __pyx_L19_unpacking_done:;
    }
    __pyx_v_ref_anti_diag_clean_dotdata = __pyx_t_4;
    __pyx_t_4 = 0;
    __pyx_v_ref_anti_diag_kept_segs = __pyx_t_2;
    __pyx_t_2 = 0;

    /* "vapor_vali/Simple_function.pyx":168
 *         alt_left=[i for i in alt_dotdata if not list(i) in alt_clean_dotdata]
 *         [ref_anti_diag_clean_dotdata,ref_anti_diag_kept_segs]=clean_dotdata_anti_diagnal_m1b(ref_left)
 *         [alt_anti_diag_clean_dotdata,alt_anti_diag_kept_segs]=clean_dotdata_anti_diagnal_m1b(alt_left)             # <<<<<<<<<<<<<<
 *         ref_clean_dotdata+=ref_anti_diag_clean_dotdata
 *         alt_clean_dotdata+=alt_anti_diag_clean_dotdata
 */
    __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_clean_dotdata_anti_diagnal_m1b); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 168, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_4 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_2))) {
      __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_2);
      if (likely(__pyx_t_4)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
        __Pyx_INCREF(__pyx_t_4);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_2, function);
      }
    }
    if (!__pyx_t_4) {
      __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_v_alt_left); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 168, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
    } else {
      __pyx_t_3 = PyTuple_New(1+1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 168, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __Pyx_GIVEREF(__pyx_t_4); PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_4); __pyx_t_4 = NULL;
      __Pyx_INCREF(__pyx_v_alt_left);
      __Pyx_GIVEREF(__pyx_v_alt_left);
      PyTuple_SET_ITEM(__pyx_t_3, 0+1, __pyx_v_alt_left);
      __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_3, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 168, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    }
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    if ((likely(PyTuple_CheckExact(__pyx_t_1))) || (PyList_CheckExact(__pyx_t_1))) {
      PyObject* sequence = __pyx_t_1;
      #if CYTHON_COMPILING_IN_CPYTHON
      Py_ssize_t size = Py_SIZE(sequence);
      #else
      Py_ssize_t size = PySequence_Size(sequence);
      #endif
      if (unlikely(size != 2)) {
        if (size > 2) __Pyx_RaiseTooManyValuesError(2);
        else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
        __PYX_ERR(0, 168, __pyx_L1_error)
      }
      #if CYTHON_COMPILING_IN_CPYTHON
      if (likely(PyTuple_CheckExact(sequence))) {
        __pyx_t_2 = PyTuple_GET_ITEM(sequence, 0); 
        __pyx_t_3 = PyTuple_GET_ITEM(sequence, 1); 
      } else {
        __pyx_t_2 = PyList_GET_ITEM(sequence, 0); 
        __pyx_t_3 = PyList_GET_ITEM(sequence, 1); 
      }
      __Pyx_INCREF(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_3);
      #else
      __pyx_t_2 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 168, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __pyx_t_3 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 168, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      #endif
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    } else {
      Py_ssize_t index = -1;
      __pyx_t_4 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 168, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_12 = Py_TYPE(__pyx_t_4)->tp_iternext;
      index = 0; __pyx_t_2 = __pyx_t_12(__pyx_t_4); if (unlikely(!__pyx_t_2)) goto __pyx_L20_unpacking_failed;
      __Pyx_GOTREF(__pyx_t_2);
      index = 1; __pyx_t_3 = __pyx_t_12(__pyx_t_4); if (unlikely(!__pyx_t_3)) goto __pyx_L20_unpacking_failed;
      __Pyx_GOTREF(__pyx_t_3);
      if (__Pyx_IternextUnpackEndCheck(__pyx_t_12(__pyx_t_4), 2) < 0) __PYX_ERR(0, 168, __pyx_L1_error)
      __pyx_t_12 = NULL;
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      goto __pyx_L21_unpacking_done;
      __pyx_L20_unpacking_failed:;
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_12 = NULL;
      if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
      __PYX_ERR(0, 168, __pyx_L1_error)
      __pyx_L21_unpacking_done:;
    }
    __pyx_v_alt_anti_diag_clean_dotdata = __pyx_t_2;
    __pyx_t_2 = 0;
    __pyx_v_alt_anti_diag_kept_segs = __pyx_t_3;
    __pyx_t_3 = 0;

    /* "vapor_vali/Simple_function.pyx":169
 *         [ref_anti_diag_clean_dotdata,ref_anti_diag_kept_segs]=clean_dotdata_anti_diagnal_m1b(ref_left)
 *         [alt_anti_diag_clean_dotdata,alt_anti_diag_kept_segs]=clean_dotdata_anti_diagnal_m1b(alt_left)
 *         ref_clean_dotdata+=ref_anti_diag_clean_dotdata             # <<<<<<<<<<<<<<
 *         alt_clean_dotdata+=alt_anti_diag_clean_dotdata
 *         if len(ref_clean_dotdata)>0 and len(alt_clean_dotdata)>0:
 */
    __pyx_t_1 = PyNumber_InPlaceAdd(__pyx_v_ref_clean_dotdata, __pyx_v_ref_anti_diag_clean_dotdata); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 169, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF_SET(__pyx_v_ref_clean_dotdata, __pyx_t_1);
    __pyx_t_1 = 0;

    /* "vapor_vali/Simple_function.pyx":170
 *         [alt_anti_diag_clean_dotdata,alt_anti_diag_kept_segs]=clean_dotdata_anti_diagnal_m1b(alt_left)
 *         ref_clean_dotdata+=ref_anti_diag_clean_dotdata
 *         alt_clean_dotdata+=alt_anti_diag_clean_dotdata             # <<<<<<<<<<<<<<
 *         if len(ref_clean_dotdata)>0 and len(alt_clean_dotdata)>0:
 *             return [eu_dis_abs_calcu(ref_clean_dotdata),eu_dis_abs_calcu(alt_clean_dotdata)]
 */
    __pyx_t_1 = PyNumber_InPlaceAdd(__pyx_v_alt_clean_dotdata, __pyx_v_alt_anti_diag_clean_dotdata); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 170, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF_SET(__pyx_v_alt_clean_dotdata, __pyx_t_1);
    __pyx_t_1 = 0;

    /* "vapor_vali/Simple_function.pyx":171
 *         ref_clean_dotdata+=ref_anti_diag_clean_dotdata
 *         alt_clean_dotdata+=alt_anti_diag_clean_dotdata
 *         if len(ref_clean_dotdata)>0 and len(alt_clean_dotdata)>0:             # <<<<<<<<<<<<<<
 *             return [eu_dis_abs_calcu(ref_clean_dotdata),eu_dis_abs_calcu(alt_clean_dotdata)]
 *         else:
 */
    __pyx_t_6 = PyObject_Length(__pyx_v_ref_clean_dotdata); if (unlikely(__pyx_t_6 == -1)) __PYX_ERR(0, 171, __pyx_L1_error)
    __pyx_t_10 = ((__pyx_t_6 > 0) != 0);
    if (__pyx_t_10) {
    } else {
      __pyx_t_8 = __pyx_t_10;
      goto __pyx_L23_bool_binop_done;
    }
    __pyx_t_6 = PyObject_Length(__pyx_v_alt_clean_dotdata); if (unlikely(__pyx_t_6 == -1)) __PYX_ERR(0, 171, __pyx_L1_error)
    __pyx_t_10 = ((__pyx_t_6 > 0) != 0);
    __pyx_t_8 = __pyx_t_10;
    __pyx_L23_bool_binop_done:;
    if (__pyx_t_8) {

      /* "vapor_vali/Simple_function.pyx":172
 *         alt_clean_dotdata+=alt_anti_diag_clean_dotdata
 *         if len(ref_clean_dotdata)>0 and len(alt_clean_dotdata)>0:
 *             return [eu_dis_abs_calcu(ref_clean_dotdata),eu_dis_abs_calcu(alt_clean_dotdata)]             # <<<<<<<<<<<<<<
 *         else:
 *             return [0,0]
 */
      __Pyx_XDECREF(__pyx_r);
      __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_eu_dis_abs_calcu); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 172, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __pyx_t_2 = NULL;
      if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_3))) {
        __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_3);
        if (likely(__pyx_t_2)) {
          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
          __Pyx_INCREF(__pyx_t_2);
          __Pyx_INCREF(function);
          __Pyx_DECREF_SET(__pyx_t_3, function);
        }
      }
      if (!__pyx_t_2) {
        __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_v_ref_clean_dotdata); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 172, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
      } else {
        __pyx_t_4 = PyTuple_New(1+1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 172, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_4);
        __Pyx_GIVEREF(__pyx_t_2); PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_2); __pyx_t_2 = NULL;
        __Pyx_INCREF(__pyx_v_ref_clean_dotdata);
        __Pyx_GIVEREF(__pyx_v_ref_clean_dotdata);
        PyTuple_SET_ITEM(__pyx_t_4, 0+1, __pyx_v_ref_clean_dotdata);
        __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_4, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 172, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      }
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_4 = __Pyx_GetModuleGlobalName(__pyx_n_s_eu_dis_abs_calcu); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 172, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_t_2 = NULL;
      if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_4))) {
        __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_4);
        if (likely(__pyx_t_2)) {
          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
          __Pyx_INCREF(__pyx_t_2);
          __Pyx_INCREF(function);
          __Pyx_DECREF_SET(__pyx_t_4, function);
        }
      }
      if (!__pyx_t_2) {
        __pyx_t_3 = __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_v_alt_clean_dotdata); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 172, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_3);
      } else {
        __pyx_t_7 = PyTuple_New(1+1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 172, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_7);
        __Pyx_GIVEREF(__pyx_t_2); PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_2); __pyx_t_2 = NULL;
        __Pyx_INCREF(__pyx_v_alt_clean_dotdata);
        __Pyx_GIVEREF(__pyx_v_alt_clean_dotdata);
        PyTuple_SET_ITEM(__pyx_t_7, 0+1, __pyx_v_alt_clean_dotdata);
        __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_7, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 172, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_3);
        __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
      }
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_4 = PyList_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 172, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      __Pyx_GIVEREF(__pyx_t_1);
      PyList_SET_ITEM(__pyx_t_4, 0, __pyx_t_1);
      __Pyx_GIVEREF(__pyx_t_3);
      PyList_SET_ITEM(__pyx_t_4, 1, __pyx_t_3);
      __pyx_t_1 = 0;
      __pyx_t_3 = 0;
      __pyx_r = __pyx_t_4;
      __pyx_t_4 = 0;
      goto __pyx_L0;

      /* "vapor_vali/Simple_function.pyx":171
 *         ref_clean_dotdata+=ref_anti_diag_clean_dotdata
 *         alt_clean_dotdata+=alt_anti_diag_clean_dotdata
 *         if len(ref_clean_dotdata)>0 and len(alt_clean_dotdata)>0:             # <<<<<<<<<<<<<<
 *             return [eu_dis_abs_calcu(ref_clean_dotdata),eu_dis_abs_calcu(alt_clean_dotdata)]
 *         else:
 */
    }

    /* "vapor_vali/Simple_function.pyx":174
 *             return [eu_dis_abs_calcu(ref_clean_dotdata),eu_dis_abs_calcu(alt_clean_dotdata)]
 *         else:
 *             return [0,0]             # <<<<<<<<<<<<<<
 *     else:
 *         return [0,0]
 */
    /*else*/ {
      __Pyx_XDECREF(__pyx_r);
      __pyx_t_4 = PyList_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 174, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      __Pyx_INCREF(__pyx_int_0);
      __Pyx_GIVEREF(__pyx_int_0);
      PyList_SET_ITEM(__pyx_t_4, 0, __pyx_int_0);
      __Pyx_INCREF(__pyx_int_0);
      __Pyx_GIVEREF(__pyx_int_0);
      PyList_SET_ITEM(__pyx_t_4, 1, __pyx_int_0);
      __pyx_r = __pyx_t_4;
      __pyx_t_4 = 0;
      goto __pyx_L0;
    }

    /* "vapor_vali/Simple_function.pyx":162
 *     ref_dotdata=dotdata(window_size,x[0],ref_seq[x[1]:])
 *     alt_dotdata=dotdata(window_size,x[0],alt_seq[x[1]:])
 *     if float(len(ref_dotdata))/float(len(ref_seq))>0.1 and float(len(alt_dotdata))/float(len(alt_seq))>0.1 and float(ref_dotdata[-1][0]-ref_dotdata[0][0])/float(len(ref_seq))>0.7 and float(alt_dotdata[-1][0]-alt_dotdata[0][0])/float(len(alt_seq))>0.7:             # <<<<<<<<<<<<<<
 *         [ref_clean_dotdata,ref_kept_segs]=clean_dotdata_m1(ref_dotdata)
 *         [alt_clean_dotdata,alt_kept_segs]=clean_dotdata_m1(alt_dotdata)
 */
  }

  /* "vapor_vali/Simple_function.pyx":176
 *             return [0,0]
 *     else:
 *         return [0,0]             # <<<<<<<<<<<<<<
 * 
 * def calcu_vapor_single_read_score_abs_dis_m1b(ref_seq,alt_seq,x,window_size):
 */
  /*else*/ {
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_4 = PyList_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 176, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_INCREF(__pyx_int_0);
    __Pyx_GIVEREF(__pyx_int_0);
    PyList_SET_ITEM(__pyx_t_4, 0, __pyx_int_0);
    __Pyx_INCREF(__pyx_int_0);
    __Pyx_GIVEREF(__pyx_int_0);
    PyList_SET_ITEM(__pyx_t_4, 1, __pyx_int_0);
    __pyx_r = __pyx_t_4;
    __pyx_t_4 = 0;
    goto __pyx_L0;
  }

  /* "vapor_vali/Simple_function.pyx":159
 *         return np.log10(x)
 * 
 * def calcu_vapor_single_read_score_abs_dis_m1(ref_seq,alt_seq,x,window_size):             # <<<<<<<<<<<<<<
 *     ref_dotdata=dotdata(window_size,x[0],ref_seq[x[1]:])
 *     alt_dotdata=dotdata(window_size,x[0],alt_seq[x[1]:])
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_7);
  __Pyx_AddTraceback("vapor_vali.Simple_function.calcu_vapor_single_read_score_abs_dis_m1", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_ref_dotdata);
  __Pyx_XDECREF(__pyx_v_alt_dotdata);
  __Pyx_XDECREF(__pyx_v_ref_clean_dotdata);
  __Pyx_XDECREF(__pyx_v_ref_kept_segs);
  __Pyx_XDECREF(__pyx_v_alt_clean_dotdata);
  __Pyx_XDECREF(__pyx_v_alt_kept_segs);
  __Pyx_XDECREF(__pyx_v_ref_left);
  __Pyx_XDECREF(__pyx_v_alt_left);
  __Pyx_XDECREF(__pyx_v_ref_anti_diag_clean_dotdata);
  __Pyx_XDECREF(__pyx_v_ref_anti_diag_kept_segs);
  __Pyx_XDECREF(__pyx_v_alt_anti_diag_clean_dotdata);
  __Pyx_XDECREF(__pyx_v_alt_anti_diag_kept_segs);
  __Pyx_XDECREF(__pyx_v_i);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "vapor_vali/Simple_function.pyx":178
 *         return [0,0]
 * 
 * def calcu_vapor_single_read_score_abs_dis_m1b(ref_seq,alt_seq,x,window_size):             # <<<<<<<<<<<<<<
 *     ref_dotdata=dotdata(window_size,x[0],ref_seq[x[1]:])
 *     alt_dotdata=dotdata(window_size,x[0],alt_seq[x[1]:])
 */

/* Python wrapper */
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_19calcu_vapor_single_read_score_abs_dis_m1b(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_10vapor_vali_15Simple_function_19calcu_vapor_single_read_score_abs_dis_m1b = {"calcu_vapor_single_read_score_abs_dis_m1b", (PyCFunction)__pyx_pw_10vapor_vali_15Simple_function_19calcu_vapor_single_read_score_abs_dis_m1b, METH_VARARGS|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_19calcu_vapor_single_read_score_abs_dis_m1b(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_ref_seq = 0;
  PyObject *__pyx_v_alt_seq = 0;
  PyObject *__pyx_v_x = 0;
  PyObject *__pyx_v_window_size = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("calcu_vapor_single_read_score_abs_dis_m1b (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_ref_seq,&__pyx_n_s_alt_seq,&__pyx_n_s_x,&__pyx_n_s_window_size,0};
    PyObject* values[4] = {0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
      switch (pos_args) {
        case  4: values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
        case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_ref_seq)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_alt_seq)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("calcu_vapor_single_read_score_abs_dis_m1b", 1, 4, 4, 1); __PYX_ERR(0, 178, __pyx_L3_error)
        }
        case  2:
        if (likely((values[2] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_x)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("calcu_vapor_single_read_score_abs_dis_m1b", 1, 4, 4, 2); __PYX_ERR(0, 178, __pyx_L3_error)
        }
        case  3:
        if (likely((values[3] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_window_size)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("calcu_vapor_single_read_score_abs_dis_m1b", 1, 4, 4, 3); __PYX_ERR(0, 178, __pyx_L3_error)
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "calcu_vapor_single_read_score_abs_dis_m1b") < 0)) __PYX_ERR(0, 178, __pyx_L3_error)
      }
    } else if (PyTuple_GET_SIZE(__pyx_args) != 4) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
      values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
    }
    __pyx_v_ref_seq = values[0];
    __pyx_v_alt_seq = values[1];
    __pyx_v_x = values[2];
    __pyx_v_window_size = values[3];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("calcu_vapor_single_read_score_abs_dis_m1b", 1, 4, 4, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 178, __pyx_L3_error)
  __pyx_L3_error:;
  __Pyx_AddTraceback("vapor_vali.Simple_function.calcu_vapor_single_read_score_abs_dis_m1b", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_10vapor_vali_15Simple_function_18calcu_vapor_single_read_score_abs_dis_m1b(__pyx_self, __pyx_v_ref_seq, __pyx_v_alt_seq, __pyx_v_x, __pyx_v_window_size);

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10vapor_vali_15Simple_function_18calcu_vapor_single_read_score_abs_dis_m1b(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_ref_seq, PyObject *__pyx_v_alt_seq, PyObject *__pyx_v_x, PyObject *__pyx_v_window_size) {
  PyObject *__pyx_v_ref_dotdata = NULL;
  PyObject *__pyx_v_alt_dotdata = NULL;
  PyObject *__pyx_v_ref_clean_dotdata = NULL;
  PyObject *__pyx_v_alt_clean_dotdata = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  Py_ssize_t __pyx_t_6;
  PyObject *__pyx_t_7 = NULL;
  int __pyx_t_8;
  int __pyx_t_9;
  Py_ssize_t __pyx_t_10;
  double __pyx_t_11;
  double __pyx_t_12;
  double __pyx_t_13;
  __Pyx_RefNannySetupContext("calcu_vapor_single_read_score_abs_dis_m1b", 0);

  /* "vapor_vali/Simple_function.pyx":179
 * 
 * def calcu_vapor_single_read_score_abs_dis_m1b(ref_seq,alt_seq,x,window_size):
 *     ref_dotdata=dotdata(window_size,x[0],ref_seq[x[1]:])             # <<<<<<<<<<<<<<
 *     alt_dotdata=dotdata(window_size,x[0],alt_seq[x[1]:])
 *     if len(ref_dotdata)>2 and len(alt_dotdata)>2:
 */
  __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_dotdata); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 179, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_x, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 179, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_4 = __Pyx_GetItemInt(__pyx_v_x, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 179, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_5 = __Pyx_PyObject_GetSlice(__pyx_v_ref_seq, 0, 0, &__pyx_t_4, NULL, NULL, 0, 0, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 179, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = NULL;
  __pyx_t_6 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_2);
    if (likely(__pyx_t_4)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_4);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_2, function);
      __pyx_t_6 = 1;
    }
  }
  __pyx_t_7 = PyTuple_New(3+__pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 179, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  if (__pyx_t_4) {
    __Pyx_GIVEREF(__pyx_t_4); PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_4); __pyx_t_4 = NULL;
  }
  __Pyx_INCREF(__pyx_v_window_size);
  __Pyx_GIVEREF(__pyx_v_window_size);
  PyTuple_SET_ITEM(__pyx_t_7, 0+__pyx_t_6, __pyx_v_window_size);
  __Pyx_GIVEREF(__pyx_t_3);
  PyTuple_SET_ITEM(__pyx_t_7, 1+__pyx_t_6, __pyx_t_3);
  __Pyx_GIVEREF(__pyx_t_5);
  PyTuple_SET_ITEM(__pyx_t_7, 2+__pyx_t_6, __pyx_t_5);
  __pyx_t_3 = 0;
  __pyx_t_5 = 0;
  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_7, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 179, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_ref_dotdata = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":180
 * def calcu_vapor_single_read_score_abs_dis_m1b(ref_seq,alt_seq,x,window_size):
 *     ref_dotdata=dotdata(window_size,x[0],ref_seq[x[1]:])
 *     alt_dotdata=dotdata(window_size,x[0],alt_seq[x[1]:])             # <<<<<<<<<<<<<<
 *     if len(ref_dotdata)>2 and len(alt_dotdata)>2:
 *         if float(len(ref_dotdata))/min([float(len(ref_seq)),float(len(alt_seq))])>0.1:
 */
  __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_dotdata); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 180, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_7 = __Pyx_GetItemInt(__pyx_v_x, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 180, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  __pyx_t_5 = __Pyx_GetItemInt(__pyx_v_x, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 180, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_3 = __Pyx_PyObject_GetSlice(__pyx_v_alt_seq, 0, 0, &__pyx_t_5, NULL, NULL, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 180, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = NULL;
  __pyx_t_6 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_2);
    if (likely(__pyx_t_5)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_5);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_2, function);
      __pyx_t_6 = 1;
    }
  }
  __pyx_t_4 = PyTuple_New(3+__pyx_t_6); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 180, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  if (__pyx_t_5) {
    __Pyx_GIVEREF(__pyx_t_5); PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_5); __pyx_t_5 = NULL;
  }
  __Pyx_INCREF(__pyx_v_window_size);
  __Pyx_GIVEREF(__pyx_v_window_size);
  PyTuple_SET_ITEM(__pyx_t_4, 0+__pyx_t_6, __pyx_v_window_size);
  __Pyx_GIVEREF(__pyx_t_7);
  PyTuple_SET_ITEM(__pyx_t_4, 1+__pyx_t_6, __pyx_t_7);
  __Pyx_GIVEREF(__pyx_t_3);
  PyTuple_SET_ITEM(__pyx_t_4, 2+__pyx_t_6, __pyx_t_3);
  __pyx_t_7 = 0;
  __pyx_t_3 = 0;
  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_4, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 180, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_alt_dotdata = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":181
 *     ref_dotdata=dotdata(window_size,x[0],ref_seq[x[1]:])
 *     alt_dotdata=dotdata(window_size,x[0],alt_seq[x[1]:])
 *     if len(ref_dotdata)>2 and len(alt_dotdata)>2:             # <<<<<<<<<<<<<<
 *         if float(len(ref_dotdata))/min([float(len(ref_seq)),float(len(alt_seq))])>0.1:
 *             if float(ref_dotdata[-1][0]-ref_dotdata[0][0])/float(len(ref_seq))>0.6 and float(alt_dotdata[-1][0]-alt_dotdata[0][0])/float(len(alt_seq))>0.6:
 */
  __pyx_t_6 = PyObject_Length(__pyx_v_ref_dotdata); if (unlikely(__pyx_t_6 == -1)) __PYX_ERR(0, 181, __pyx_L1_error)
  __pyx_t_9 = ((__pyx_t_6 > 2) != 0);
  if (__pyx_t_9) {
  } else {
    __pyx_t_8 = __pyx_t_9;
    goto __pyx_L4_bool_binop_done;
  }
  __pyx_t_6 = PyObject_Length(__pyx_v_alt_dotdata); if (unlikely(__pyx_t_6 == -1)) __PYX_ERR(0, 181, __pyx_L1_error)
  __pyx_t_9 = ((__pyx_t_6 > 2) != 0);
  __pyx_t_8 = __pyx_t_9;
  __pyx_L4_bool_binop_done:;
  if (__pyx_t_8) {

    /* "vapor_vali/Simple_function.pyx":182
 *     alt_dotdata=dotdata(window_size,x[0],alt_seq[x[1]:])
 *     if len(ref_dotdata)>2 and len(alt_dotdata)>2:
 *         if float(len(ref_dotdata))/min([float(len(ref_seq)),float(len(alt_seq))])>0.1:             # <<<<<<<<<<<<<<
 *             if float(ref_dotdata[-1][0]-ref_dotdata[0][0])/float(len(ref_seq))>0.6 and float(alt_dotdata[-1][0]-alt_dotdata[0][0])/float(len(alt_seq))>0.6:
 *                 ref_clean_dotdata=clean_dotdata_diagnal_and_anti_diagnal(ref_dotdata)
 */
    __pyx_t_6 = PyObject_Length(__pyx_v_ref_dotdata); if (unlikely(__pyx_t_6 == -1)) __PYX_ERR(0, 182, __pyx_L1_error)
    __pyx_t_10 = PyObject_Length(__pyx_v_alt_seq); if (unlikely(__pyx_t_10 == -1)) __PYX_ERR(0, 182, __pyx_L1_error)
    __pyx_t_11 = ((double)__pyx_t_10);
    __pyx_t_10 = PyObject_Length(__pyx_v_ref_seq); if (unlikely(__pyx_t_10 == -1)) __PYX_ERR(0, 182, __pyx_L1_error)
    __pyx_t_12 = ((double)__pyx_t_10);
    if (((__pyx_t_11 < __pyx_t_12) != 0)) {
      __pyx_t_13 = __pyx_t_11;
    } else {
      __pyx_t_13 = __pyx_t_12;
    }
    __pyx_t_11 = __pyx_t_13;
    if (unlikely(__pyx_t_11 == 0)) {
      PyErr_SetString(PyExc_ZeroDivisionError, "float division");
      __PYX_ERR(0, 182, __pyx_L1_error)
    }
    __pyx_t_8 = (((((double)__pyx_t_6) / __pyx_t_11) > 0.1) != 0);
    if (__pyx_t_8) {

      /* "vapor_vali/Simple_function.pyx":183
 *     if len(ref_dotdata)>2 and len(alt_dotdata)>2:
 *         if float(len(ref_dotdata))/min([float(len(ref_seq)),float(len(alt_seq))])>0.1:
 *             if float(ref_dotdata[-1][0]-ref_dotdata[0][0])/float(len(ref_seq))>0.6 and float(alt_dotdata[-1][0]-alt_dotdata[0][0])/float(len(alt_seq))>0.6:             # <<<<<<<<<<<<<<
 *                 ref_clean_dotdata=clean_dotdata_diagnal_and_anti_diagnal(ref_dotdata)
 *                 alt_clean_dotdata=clean_dotdata_diagnal_and_anti_diagnal(alt_dotdata)
 */
      __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_ref_dotdata, -1L, long, 1, __Pyx_PyInt_From_long, 0, 1, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 183, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __pyx_t_2 = __Pyx_GetItemInt(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 183, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_ref_dotdata, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 183, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __pyx_t_4 = __Pyx_GetItemInt(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 183, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_1 = PyNumber_Subtract(__pyx_t_2, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 183, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_11 = __Pyx_PyObject_AsDouble(__pyx_t_1); if (unlikely(__pyx_t_11 == ((double)-1) && PyErr_Occurred())) __PYX_ERR(0, 183, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_6 = PyObject_Length(__pyx_v_ref_seq); if (unlikely(__pyx_t_6 == -1)) __PYX_ERR(0, 183, __pyx_L1_error)
      if (unlikely(((double)__pyx_t_6) == 0)) {
        PyErr_SetString(PyExc_ZeroDivisionError, "float division");
        __PYX_ERR(0, 183, __pyx_L1_error)
      }
      __pyx_t_9 = (((__pyx_t_11 / ((double)__pyx_t_6)) > 0.6) != 0);
      if (__pyx_t_9) {
      } else {
        __pyx_t_8 = __pyx_t_9;
        goto __pyx_L8_bool_binop_done;
      }
      __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_alt_dotdata, -1L, long, 1, __Pyx_PyInt_From_long, 0, 1, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 183, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __pyx_t_4 = __Pyx_GetItemInt(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 183, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_alt_dotdata, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 183, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __pyx_t_2 = __Pyx_GetItemInt(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 183, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_1 = PyNumber_Subtract(__pyx_t_4, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 183, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_11 = __Pyx_PyObject_AsDouble(__pyx_t_1); if (unlikely(__pyx_t_11 == ((double)-1) && PyErr_Occurred())) __PYX_ERR(0, 183, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_6 = PyObject_Length(__pyx_v_alt_seq); if (unlikely(__pyx_t_6 == -1)) __PYX_ERR(0, 183, __pyx_L1_error)
      if (unlikely(((double)__pyx_t_6) == 0)) {
        PyErr_SetString(PyExc_ZeroDivisionError, "float division");
        __PYX_ERR(0, 183, __pyx_L1_error)
      }
      __pyx_t_9 = (((__pyx_t_11 / ((double)__pyx_t_6)) > 0.6) != 0);
      __pyx_t_8 = __pyx_t_9;
      __pyx_L8_bool_binop_done:;
      if (__pyx_t_8) {

        /* "vapor_vali/Simple_function.pyx":184
 *         if float(len(ref_dotdata))/min([float(len(ref_seq)),float(len(alt_seq))])>0.1:
 *             if float(ref_dotdata[-1][0]-ref_dotdata[0][0])/float(len(ref_seq))>0.6 and float(alt_dotdata[-1][0]-alt_dotdata[0][0])/float(len(alt_seq))>0.6:
 *                 ref_clean_dotdata=clean_dotdata_diagnal_and_anti_diagnal(ref_dotdata)             # <<<<<<<<<<<<<<
 *                 alt_clean_dotdata=clean_dotdata_diagnal_and_anti_diagnal(alt_dotdata)
 *                 if len(ref_clean_dotdata)>0 and len(alt_clean_dotdata)>0:
 */
        __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_clean_dotdata_diagnal_and_anti_d); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 184, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
        __pyx_t_4 = NULL;
        if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_2))) {
          __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_2);
          if (likely(__pyx_t_4)) {
            PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
            __Pyx_INCREF(__pyx_t_4);
            __Pyx_INCREF(function);
            __Pyx_DECREF_SET(__pyx_t_2, function);
          }
        }
        if (!__pyx_t_4) {
          __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_v_ref_dotdata); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 184, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_1);
        } else {
          __pyx_t_3 = PyTuple_New(1+1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 184, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_3);
          __Pyx_GIVEREF(__pyx_t_4); PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_4); __pyx_t_4 = NULL;
          __Pyx_INCREF(__pyx_v_ref_dotdata);
          __Pyx_GIVEREF(__pyx_v_ref_dotdata);
          PyTuple_SET_ITEM(__pyx_t_3, 0+1, __pyx_v_ref_dotdata);
          __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_3, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 184, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_1);
          __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
        }
        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
        __pyx_v_ref_clean_dotdata = __pyx_t_1;
        __pyx_t_1 = 0;

        /* "vapor_vali/Simple_function.pyx":185
 *             if float(ref_dotdata[-1][0]-ref_dotdata[0][0])/float(len(ref_seq))>0.6 and float(alt_dotdata[-1][0]-alt_dotdata[0][0])/float(len(alt_seq))>0.6:
 *                 ref_clean_dotdata=clean_dotdata_diagnal_and_anti_diagnal(ref_dotdata)
 *                 alt_clean_dotdata=clean_dotdata_diagnal_and_anti_diagnal(alt_dotdata)             # <<<<<<<<<<<<<<
 *                 if len(ref_clean_dotdata)>0 and len(alt_clean_dotdata)>0:
 *                     return [eu_dis_abs_calcu(ref_clean_dotdata),eu_dis_abs_calcu(alt_clean_dotdata)]
 */
        __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_clean_dotdata_diagnal_and_anti_d); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 185, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
        __pyx_t_3 = NULL;
        if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_2))) {
          __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
          if (likely(__pyx_t_3)) {
            PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
            __Pyx_INCREF(__pyx_t_3);
            __Pyx_INCREF(function);
            __Pyx_DECREF_SET(__pyx_t_2, function);
          }
        }
        if (!__pyx_t_3) {
          __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_v_alt_dotdata); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 185, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_1);
        } else {
          __pyx_t_4 = PyTuple_New(1+1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 185, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_4);
          __Pyx_GIVEREF(__pyx_t_3); PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3); __pyx_t_3 = NULL;
          __Pyx_INCREF(__pyx_v_alt_dotdata);
          __Pyx_GIVEREF(__pyx_v_alt_dotdata);
          PyTuple_SET_ITEM(__pyx_t_4, 0+1, __pyx_v_alt_dotdata);
          __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_4, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 185, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_1);
          __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
        }
        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
        __pyx_v_alt_clean_dotdata = __pyx_t_1;
        __pyx_t_1 = 0;

        /* "vapor_vali/Simple_function.pyx":186
 *                 ref_clean_dotdata=clean_dotdata_diagnal_and_anti_diagnal(ref_dotdata)
 *                 alt_clean_dotdata=clean_dotdata_diagnal_and_anti_diagnal(alt_dotdata)
 *                 if len(ref_clean_dotdata)>0 and len(alt_clean_dotdata)>0:             # <<<<<<<<<<<<<<
 *                     return [eu_dis_abs_calcu(ref_clean_dotdata),eu_dis_abs_calcu(alt_clean_dotdata)]
 *                 else:
 */
        __pyx_t_6 = PyObject_Length(__pyx_v_ref_clean_dotdata); if (unlikely(__pyx_t_6 == -1)) __PYX_ERR(0, 186, __pyx_L1_error)
        __pyx_t_9 = ((__pyx_t_6 > 0) != 0);
        if (__pyx_t_9) {
        } else {
          __pyx_t_8 = __pyx_t_9;
          goto __pyx_L11_bool_binop_done;
        }
        __pyx_t_6 = PyObject_Length(__pyx_v_alt_clean_dotdata); if (unlikely(__pyx_t_6 == -1)) __PYX_ERR(0, 186, __pyx_L1_error)
        __pyx_t_9 = ((__pyx_t_6 > 0) != 0);
        __pyx_t_8 = __pyx_t_9;
        __pyx_L11_bool_binop_done:;
        if (__pyx_t_8) {

          /* "vapor_vali/Simple_function.pyx":187
 *                 alt_clean_dotdata=clean_dotdata_diagnal_and_anti_diagnal(alt_dotdata)
 *                 if len(ref_clean_dotdata)>0 and len(alt_clean_dotdata)>0:
 *                     return [eu_dis_abs_calcu(ref_clean_dotdata),eu_dis_abs_calcu(alt_clean_dotdata)]             # <<<<<<<<<<<<<<
 *                 else:
 *                     return [0,0]
 */
          __Pyx_XDECREF(__pyx_r);
          __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_eu_dis_abs_calcu); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 187, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_2);
          __pyx_t_4 = NULL;
          if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_2))) {
            __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_2);
            if (likely(__pyx_t_4)) {
              PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
              __Pyx_INCREF(__pyx_t_4);
              __Pyx_INCREF(function);
              __Pyx_DECREF_SET(__pyx_t_2, function);
            }
          }
          if (!__pyx_t_4) {
            __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_v_ref_clean_dotdata); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 187, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_1);
          } else {
            __pyx_t_3 = PyTuple_New(1+1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 187, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_3);
            __Pyx_GIVEREF(__pyx_t_4); PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_4); __pyx_t_4 = NULL;
            __Pyx_INCREF(__pyx_v_ref_clean_dotdata);
            __Pyx_GIVEREF(__pyx_v_ref_clean_dotdata);
            PyTuple_SET_ITEM(__pyx_t_3, 0+1, __pyx_v_ref_clean_dotdata);
            __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_3, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 187, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_1);
            __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
          }
          __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
          __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_eu_dis_abs_calcu); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 187, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_3);
          __pyx_t_4 = NULL;
          if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_3))) {
            __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
            if (likely(__pyx_t_4)) {
              PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
              __Pyx_INCREF(__pyx_t_4);
              __Pyx_INCREF(function);
              __Pyx_DECREF_SET(__pyx_t_3, function);
            }
          }
          if (!__pyx_t_4) {
            __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_v_alt_clean_dotdata); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 187, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_2);
          } else {
            __pyx_t_7 = PyTuple_New(1+1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 187, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_7);
            __Pyx_GIVEREF(__pyx_t_4); PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_4); __pyx_t_4 = NULL;
            __Pyx_INCREF(__pyx_v_alt_clean_dotdata);
            __Pyx_GIVEREF(__pyx_v_alt_clean_dotdata);
            PyTuple_SET_ITEM(__pyx_t_7, 0+1, __pyx_v_alt_clean_dotdata);
            __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_7, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 187, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_2);
            __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
          }
          __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
          __pyx_t_3 = PyList_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 187, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_3);
          __Pyx_GIVEREF(__pyx_t_1);
          PyList_SET_ITEM(__pyx_t_3, 0, __pyx_t_1);
          __Pyx_GIVEREF(__pyx_t_2);
          PyList_SET_ITEM(__pyx_t_3, 1, __pyx_t_2);
          __pyx_t_1 = 0;
          __pyx_t_2 = 0;
          __pyx_r = __pyx_t_3;
          __pyx_t_3 = 0;
          goto __pyx_L0;

          /* "vapor_vali/Simple_function.pyx":186
 *                 ref_clean_dotdata=clean_dotdata_diagnal_and_anti_diagnal(ref_dotdata)
 *                 alt_clean_dotdata=clean_dotdata_diagnal_and_anti_diagnal(alt_dotdata)
 *                 if len(ref_clean_dotdata)>0 and len(alt_clean_dotdata)>0:             # <<<<<<<<<<<<<<
 *                     return [eu_dis_abs_calcu(ref_clean_dotdata),eu_dis_abs_calcu(alt_clean_dotdata)]
 *                 else:
 */
        }

        /* "vapor_vali/Simple_function.pyx":189
 *                     return [eu_dis_abs_calcu(ref_clean_dotdata),eu_dis_abs_calcu(alt_clean_dotdata)]
 *                 else:
 *                     return [0,0]             # <<<<<<<<<<<<<<
 *             else:
 *                 if float(ref_dotdata[-1][0]-ref_dotdata[0][0])/float(len(ref_seq))>0.6: return [1.1,2.1]
 */
        /*else*/ {
          __Pyx_XDECREF(__pyx_r);
          __pyx_t_3 = PyList_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 189, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_3);
          __Pyx_INCREF(__pyx_int_0);
          __Pyx_GIVEREF(__pyx_int_0);
          PyList_SET_ITEM(__pyx_t_3, 0, __pyx_int_0);
          __Pyx_INCREF(__pyx_int_0);
          __Pyx_GIVEREF(__pyx_int_0);
          PyList_SET_ITEM(__pyx_t_3, 1, __pyx_int_0);
          __pyx_r = __pyx_t_3;
          __pyx_t_3 = 0;
          goto __pyx_L0;
        }

        /* "vapor_vali/Simple_function.pyx":183
 *     if len(ref_dotdata)>2 and len(alt_dotdata)>2:
 *         if float(len(ref_dotdata))/min([float(len(ref_seq)),float(len(alt_seq))])>0.1:
 *             if float(ref_dotdata[-1][0]-ref_dotdata[0][0])/float(len(ref_seq))>0.6 and float(alt_dotdata[-1][0]-alt_dotdata[0][0])/float(len(alt_seq))>0.6:             # <<<<<<<<<<<<<<
 *                 ref_clean_dotdata=clean_dotdata_diagnal_and_anti_diagnal(ref_dotdata)
 *                 alt_clean_dotdata=clean_dotdata_diagnal_and_anti_diagnal(alt_dotdata)
 */
      }

      /* "vapor_vali/Simple_function.pyx":191
 *                     return [0,0]
 *             else:
 *                 if float(ref_dotdata[-1][0]-ref_dotdata[0][0])/float(len(ref_seq))>0.6: return [1.1,2.1]             # <<<<<<<<<<<<<<
 *                 elif float(alt_dotdata[-1][0]-alt_dotdata[0][0])/float(len(alt_seq))>0.6: return [2.1,1.1]
 *                 else: return [0,0]
 */
      /*else*/ {
        __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_ref_dotdata, -1L, long, 1, __Pyx_PyInt_From_long, 0, 1, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 191, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_3);
        __pyx_t_2 = __Pyx_GetItemInt(__pyx_t_3, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 191, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
        __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_ref_dotdata, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 191, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_3);
        __pyx_t_1 = __Pyx_GetItemInt(__pyx_t_3, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 191, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
        __pyx_t_3 = PyNumber_Subtract(__pyx_t_2, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 191, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_3);
        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
        __pyx_t_11 = __Pyx_PyObject_AsDouble(__pyx_t_3); if (unlikely(__pyx_t_11 == ((double)-1) && PyErr_Occurred())) __PYX_ERR(0, 191, __pyx_L1_error)
        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
        __pyx_t_6 = PyObject_Length(__pyx_v_ref_seq); if (unlikely(__pyx_t_6 == -1)) __PYX_ERR(0, 191, __pyx_L1_error)
        if (unlikely(((double)__pyx_t_6) == 0)) {
          PyErr_SetString(PyExc_ZeroDivisionError, "float division");
          __PYX_ERR(0, 191, __pyx_L1_error)
        }
        __pyx_t_8 = (((__pyx_t_11 / ((double)__pyx_t_6)) > 0.6) != 0);
        if (__pyx_t_8) {
          __Pyx_XDECREF(__pyx_r);
          __pyx_t_3 = PyList_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 191, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_3);
          __Pyx_INCREF(__pyx_float_1_1);
          __Pyx_GIVEREF(__pyx_float_1_1);
          PyList_SET_ITEM(__pyx_t_3, 0, __pyx_float_1_1);
          __Pyx_INCREF(__pyx_float_2_1);
          __Pyx_GIVEREF(__pyx_float_2_1);
          PyList_SET_ITEM(__pyx_t_3, 1, __pyx_float_2_1);
          __pyx_r = __pyx_t_3;
          __pyx_t_3 = 0;
          goto __pyx_L0;
        }

        /* "vapor_vali/Simple_function.pyx":192
 *             else:
 *                 if float(ref_dotdata[-1][0]-ref_dotdata[0][0])/float(len(ref_seq))>0.6: return [1.1,2.1]
 *                 elif float(alt_dotdata[-1][0]-alt_dotdata[0][0])/float(len(alt_seq))>0.6: return [2.1,1.1]             # <<<<<<<<<<<<<<
 *                 else: return [0,0]
 *         else:
 */
        __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_alt_dotdata, -1L, long, 1, __Pyx_PyInt_From_long, 0, 1, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 192, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_3);
        __pyx_t_1 = __Pyx_GetItemInt(__pyx_t_3, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 192, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
        __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_alt_dotdata, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 192, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_3);
        __pyx_t_2 = __Pyx_GetItemInt(__pyx_t_3, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 192, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
        __pyx_t_3 = PyNumber_Subtract(__pyx_t_1, __pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 192, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_3);
        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
        __pyx_t_11 = __Pyx_PyObject_AsDouble(__pyx_t_3); if (unlikely(__pyx_t_11 == ((double)-1) && PyErr_Occurred())) __PYX_ERR(0, 192, __pyx_L1_error)
        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
        __pyx_t_6 = PyObject_Length(__pyx_v_alt_seq); if (unlikely(__pyx_t_6 == -1)) __PYX_ERR(0, 192, __pyx_L1_error)
        if (unlikely(((double)__pyx_t_6) == 0)) {
          PyErr_SetString(PyExc_ZeroDivisionError, "float division");
          __PYX_ERR(0, 192, __pyx_L1_error)
        }
        __pyx_t_8 = (((__pyx_t_11 / ((double)__pyx_t_6)) > 0.6) != 0);
        if (__pyx_t_8) {
          __Pyx_XDECREF(__pyx_r);
          __pyx_t_3 = PyList_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 192, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_3);
          __Pyx_INCREF(__pyx_float_2_1);
          __Pyx_GIVEREF(__pyx_float_2_1);
          PyList_SET_ITEM(__pyx_t_3, 0, __pyx_float_2_1);
          __Pyx_INCREF(__pyx_float_1_1);
          __Pyx_GIVEREF(__pyx_float_1_1);
          PyList_SET_ITEM(__pyx_t_3, 1, __pyx_float_1_1);
          __pyx_r = __pyx_t_3;
          __pyx_t_3 = 0;
          goto __pyx_L0;
        }

        /* "vapor_vali/Simple_function.pyx":193
 *                 if float(ref_dotdata[-1][0]-ref_dotdata[0][0])/float(len(ref_seq))>0.6: return [1.1,2.1]
 *                 elif float(alt_dotdata[-1][0]-alt_dotdata[0][0])/float(len(alt_seq))>0.6: return [2.1,1.1]
 *                 else: return [0,0]             # <<<<<<<<<<<<<<
 *         else:
 *             return [0,0]
 */
        /*else*/ {
          __Pyx_XDECREF(__pyx_r);
          __pyx_t_3 = PyList_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 193, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_3);
          __Pyx_INCREF(__pyx_int_0);
          __Pyx_GIVEREF(__pyx_int_0);
          PyList_SET_ITEM(__pyx_t_3, 0, __pyx_int_0);
          __Pyx_INCREF(__pyx_int_0);
          __Pyx_GIVEREF(__pyx_int_0);
          PyList_SET_ITEM(__pyx_t_3, 1, __pyx_int_0);
          __pyx_r = __pyx_t_3;
          __pyx_t_3 = 0;
          goto __pyx_L0;
        }
      }

      /* "vapor_vali/Simple_function.pyx":182
 *     alt_dotdata=dotdata(window_size,x[0],alt_seq[x[1]:])
 *     if len(ref_dotdata)>2 and len(alt_dotdata)>2:
 *         if float(len(ref_dotdata))/min([float(len(ref_seq)),float(len(alt_seq))])>0.1:             # <<<<<<<<<<<<<<
 *             if float(ref_dotdata[-1][0]-ref_dotdata[0][0])/float(len(ref_seq))>0.6 and float(alt_dotdata[-1][0]-alt_dotdata[0][0])/float(len(alt_seq))>0.6:
 *                 ref_clean_dotdata=clean_dotdata_diagnal_and_anti_diagnal(ref_dotdata)
 */
    }

    /* "vapor_vali/Simple_function.pyx":195
 *                 else: return [0,0]
 *         else:
 *             return [0,0]             # <<<<<<<<<<<<<<
 *     else:
 *         return [0,0]
 */
    /*else*/ {
      __Pyx_XDECREF(__pyx_r);
      __pyx_t_3 = PyList_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 195, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __Pyx_INCREF(__pyx_int_0);
      __Pyx_GIVEREF(__pyx_int_0);
      PyList_SET_ITEM(__pyx_t_3, 0, __pyx_int_0);
      __Pyx_INCREF(__pyx_int_0);
      __Pyx_GIVEREF(__pyx_int_0);
      PyList_SET_ITEM(__pyx_t_3, 1, __pyx_int_0);
      __pyx_r = __pyx_t_3;
      __pyx_t_3 = 0;
      goto __pyx_L0;
    }

    /* "vapor_vali/Simple_function.pyx":181
 *     ref_dotdata=dotdata(window_size,x[0],ref_seq[x[1]:])
 *     alt_dotdata=dotdata(window_size,x[0],alt_seq[x[1]:])
 *     if len(ref_dotdata)>2 and len(alt_dotdata)>2:             # <<<<<<<<<<<<<<
 *         if float(len(ref_dotdata))/min([float(len(ref_seq)),float(len(alt_seq))])>0.1:
 *             if float(ref_dotdata[-1][0]-ref_dotdata[0][0])/float(len(ref_seq))>0.6 and float(alt_dotdata[-1][0]-alt_dotdata[0][0])/float(len(alt_seq))>0.6:
 */
  }

  /* "vapor_vali/Simple_function.pyx":197
 *             return [0,0]
 *     else:
 *         return [0,0]             # <<<<<<<<<<<<<<
 * 
 * def calcu_vapor_single_read_score_directed_dis_m1b(ref_seq,alt_seq,x,window_size):
 */
  /*else*/ {
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_3 = PyList_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 197, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_INCREF(__pyx_int_0);
    __Pyx_GIVEREF(__pyx_int_0);
    PyList_SET_ITEM(__pyx_t_3, 0, __pyx_int_0);
    __Pyx_INCREF(__pyx_int_0);
    __Pyx_GIVEREF(__pyx_int_0);
    PyList_SET_ITEM(__pyx_t_3, 1, __pyx_int_0);
    __pyx_r = __pyx_t_3;
    __pyx_t_3 = 0;
    goto __pyx_L0;
  }

  /* "vapor_vali/Simple_function.pyx":178
 *         return [0,0]
 * 
 * def calcu_vapor_single_read_score_abs_dis_m1b(ref_seq,alt_seq,x,window_size):             # <<<<<<<<<<<<<<
 *     ref_dotdata=dotdata(window_size,x[0],ref_seq[x[1]:])
 *     alt_dotdata=dotdata(window_size,x[0],alt_seq[x[1]:])
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_7);
  __Pyx_AddTraceback("vapor_vali.Simple_function.calcu_vapor_single_read_score_abs_dis_m1b", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_ref_dotdata);
  __Pyx_XDECREF(__pyx_v_alt_dotdata);
  __Pyx_XDECREF(__pyx_v_ref_clean_dotdata);
  __Pyx_XDECREF(__pyx_v_alt_clean_dotdata);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "vapor_vali/Simple_function.pyx":199
 *         return [0,0]
 * 
 * def calcu_vapor_single_read_score_directed_dis_m1b(ref_seq,alt_seq,x,window_size):             # <<<<<<<<<<<<<<
 *     ref_dotdata=dotdata(window_size,x[0],ref_seq[x[1]:])
 *     alt_dotdata=dotdata(window_size,x[0],alt_seq[x[1]:])
 */

/* Python wrapper */
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_21calcu_vapor_single_read_score_directed_dis_m1b(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_10vapor_vali_15Simple_function_21calcu_vapor_single_read_score_directed_dis_m1b = {"calcu_vapor_single_read_score_directed_dis_m1b", (PyCFunction)__pyx_pw_10vapor_vali_15Simple_function_21calcu_vapor_single_read_score_directed_dis_m1b, METH_VARARGS|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_21calcu_vapor_single_read_score_directed_dis_m1b(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_ref_seq = 0;
  PyObject *__pyx_v_alt_seq = 0;
  PyObject *__pyx_v_x = 0;
  PyObject *__pyx_v_window_size = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("calcu_vapor_single_read_score_directed_dis_m1b (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_ref_seq,&__pyx_n_s_alt_seq,&__pyx_n_s_x,&__pyx_n_s_window_size,0};
    PyObject* values[4] = {0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
      switch (pos_args) {
        case  4: values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
        case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_ref_seq)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_alt_seq)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("calcu_vapor_single_read_score_directed_dis_m1b", 1, 4, 4, 1); __PYX_ERR(0, 199, __pyx_L3_error)
        }
        case  2:
        if (likely((values[2] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_x)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("calcu_vapor_single_read_score_directed_dis_m1b", 1, 4, 4, 2); __PYX_ERR(0, 199, __pyx_L3_error)
        }
        case  3:
        if (likely((values[3] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_window_size)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("calcu_vapor_single_read_score_directed_dis_m1b", 1, 4, 4, 3); __PYX_ERR(0, 199, __pyx_L3_error)
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "calcu_vapor_single_read_score_directed_dis_m1b") < 0)) __PYX_ERR(0, 199, __pyx_L3_error)
      }
    } else if (PyTuple_GET_SIZE(__pyx_args) != 4) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
      values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
    }
    __pyx_v_ref_seq = values[0];
    __pyx_v_alt_seq = values[1];
    __pyx_v_x = values[2];
    __pyx_v_window_size = values[3];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("calcu_vapor_single_read_score_directed_dis_m1b", 1, 4, 4, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 199, __pyx_L3_error)
  __pyx_L3_error:;
  __Pyx_AddTraceback("vapor_vali.Simple_function.calcu_vapor_single_read_score_directed_dis_m1b", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_10vapor_vali_15Simple_function_20calcu_vapor_single_read_score_directed_dis_m1b(__pyx_self, __pyx_v_ref_seq, __pyx_v_alt_seq, __pyx_v_x, __pyx_v_window_size);

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10vapor_vali_15Simple_function_20calcu_vapor_single_read_score_directed_dis_m1b(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_ref_seq, PyObject *__pyx_v_alt_seq, PyObject *__pyx_v_x, PyObject *__pyx_v_window_size) {
  PyObject *__pyx_v_ref_dotdata = NULL;
  PyObject *__pyx_v_alt_dotdata = NULL;
  PyObject *__pyx_v_ref_clean_dotdata = NULL;
  PyObject *__pyx_v_alt_clean_dotdata = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  Py_ssize_t __pyx_t_6;
  PyObject *__pyx_t_7 = NULL;
  int __pyx_t_8;
  Py_ssize_t __pyx_t_9;
  int __pyx_t_10;
  double __pyx_t_11;
  __Pyx_RefNannySetupContext("calcu_vapor_single_read_score_directed_dis_m1b", 0);

  /* "vapor_vali/Simple_function.pyx":200
 * 
 * def calcu_vapor_single_read_score_directed_dis_m1b(ref_seq,alt_seq,x,window_size):
 *     ref_dotdata=dotdata(window_size,x[0],ref_seq[x[1]:])             # <<<<<<<<<<<<<<
 *     alt_dotdata=dotdata(window_size,x[0],alt_seq[x[1]:])
 *     if float(len(ref_dotdata))/float(len(ref_seq))>0.1 and float(len(alt_dotdata))/float(len(alt_seq))>0.1 and float(ref_dotdata[-1][0]-ref_dotdata[0][0])/float(len(ref_seq))>0.7 and float(alt_dotdata[-1][0]-alt_dotdata[0][0])/float(len(alt_seq))>0.7:
 */
  __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_dotdata); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 200, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_x, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 200, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_4 = __Pyx_GetItemInt(__pyx_v_x, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 200, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_5 = __Pyx_PyObject_GetSlice(__pyx_v_ref_seq, 0, 0, &__pyx_t_4, NULL, NULL, 0, 0, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 200, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = NULL;
  __pyx_t_6 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_2);
    if (likely(__pyx_t_4)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_4);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_2, function);
      __pyx_t_6 = 1;
    }
  }
  __pyx_t_7 = PyTuple_New(3+__pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 200, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  if (__pyx_t_4) {
    __Pyx_GIVEREF(__pyx_t_4); PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_4); __pyx_t_4 = NULL;
  }
  __Pyx_INCREF(__pyx_v_window_size);
  __Pyx_GIVEREF(__pyx_v_window_size);
  PyTuple_SET_ITEM(__pyx_t_7, 0+__pyx_t_6, __pyx_v_window_size);
  __Pyx_GIVEREF(__pyx_t_3);
  PyTuple_SET_ITEM(__pyx_t_7, 1+__pyx_t_6, __pyx_t_3);
  __Pyx_GIVEREF(__pyx_t_5);
  PyTuple_SET_ITEM(__pyx_t_7, 2+__pyx_t_6, __pyx_t_5);
  __pyx_t_3 = 0;
  __pyx_t_5 = 0;
  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_7, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 200, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_ref_dotdata = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":201
 * def calcu_vapor_single_read_score_directed_dis_m1b(ref_seq,alt_seq,x,window_size):
 *     ref_dotdata=dotdata(window_size,x[0],ref_seq[x[1]:])
 *     alt_dotdata=dotdata(window_size,x[0],alt_seq[x[1]:])             # <<<<<<<<<<<<<<
 *     if float(len(ref_dotdata))/float(len(ref_seq))>0.1 and float(len(alt_dotdata))/float(len(alt_seq))>0.1 and float(ref_dotdata[-1][0]-ref_dotdata[0][0])/float(len(ref_seq))>0.7 and float(alt_dotdata[-1][0]-alt_dotdata[0][0])/float(len(alt_seq))>0.7:
 *         #[ref_clean_dotdata,ref_kept_segs]=clean_dotdata_diagnal_m1b(ref_dotdata)
 */
  __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_dotdata); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 201, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_7 = __Pyx_GetItemInt(__pyx_v_x, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 201, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  __pyx_t_5 = __Pyx_GetItemInt(__pyx_v_x, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 201, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_3 = __Pyx_PyObject_GetSlice(__pyx_v_alt_seq, 0, 0, &__pyx_t_5, NULL, NULL, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 201, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = NULL;
  __pyx_t_6 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_2);
    if (likely(__pyx_t_5)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_5);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_2, function);
      __pyx_t_6 = 1;
    }
  }
  __pyx_t_4 = PyTuple_New(3+__pyx_t_6); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 201, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  if (__pyx_t_5) {
    __Pyx_GIVEREF(__pyx_t_5); PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_5); __pyx_t_5 = NULL;
  }
  __Pyx_INCREF(__pyx_v_window_size);
  __Pyx_GIVEREF(__pyx_v_window_size);
  PyTuple_SET_ITEM(__pyx_t_4, 0+__pyx_t_6, __pyx_v_window_size);
  __Pyx_GIVEREF(__pyx_t_7);
  PyTuple_SET_ITEM(__pyx_t_4, 1+__pyx_t_6, __pyx_t_7);
  __Pyx_GIVEREF(__pyx_t_3);
  PyTuple_SET_ITEM(__pyx_t_4, 2+__pyx_t_6, __pyx_t_3);
  __pyx_t_7 = 0;
  __pyx_t_3 = 0;
  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_4, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 201, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_alt_dotdata = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":202
 *     ref_dotdata=dotdata(window_size,x[0],ref_seq[x[1]:])
 *     alt_dotdata=dotdata(window_size,x[0],alt_seq[x[1]:])
 *     if float(len(ref_dotdata))/float(len(ref_seq))>0.1 and float(len(alt_dotdata))/float(len(alt_seq))>0.1 and float(ref_dotdata[-1][0]-ref_dotdata[0][0])/float(len(ref_seq))>0.7 and float(alt_dotdata[-1][0]-alt_dotdata[0][0])/float(len(alt_seq))>0.7:             # <<<<<<<<<<<<<<
 *         #[ref_clean_dotdata,ref_kept_segs]=clean_dotdata_diagnal_m1b(ref_dotdata)
 *         #[alt_clean_dotdata,alt_kept_segs]=clean_dotdata_diagnal_m1b(alt_dotdata)
 */
  __pyx_t_6 = PyObject_Length(__pyx_v_ref_dotdata); if (unlikely(__pyx_t_6 == -1)) __PYX_ERR(0, 202, __pyx_L1_error)
  __pyx_t_9 = PyObject_Length(__pyx_v_ref_seq); if (unlikely(__pyx_t_9 == -1)) __PYX_ERR(0, 202, __pyx_L1_error)
  if (unlikely(((double)__pyx_t_9) == 0)) {
    PyErr_SetString(PyExc_ZeroDivisionError, "float division");
    __PYX_ERR(0, 202, __pyx_L1_error)
  }
  __pyx_t_10 = (((((double)__pyx_t_6) / ((double)__pyx_t_9)) > 0.1) != 0);
  if (__pyx_t_10) {
  } else {
    __pyx_t_8 = __pyx_t_10;
    goto __pyx_L4_bool_binop_done;
  }
  __pyx_t_9 = PyObject_Length(__pyx_v_alt_dotdata); if (unlikely(__pyx_t_9 == -1)) __PYX_ERR(0, 202, __pyx_L1_error)
  __pyx_t_6 = PyObject_Length(__pyx_v_alt_seq); if (unlikely(__pyx_t_6 == -1)) __PYX_ERR(0, 202, __pyx_L1_error)
  if (unlikely(((double)__pyx_t_6) == 0)) {
    PyErr_SetString(PyExc_ZeroDivisionError, "float division");
    __PYX_ERR(0, 202, __pyx_L1_error)
  }
  __pyx_t_10 = (((((double)__pyx_t_9) / ((double)__pyx_t_6)) > 0.1) != 0);
  if (__pyx_t_10) {
  } else {
    __pyx_t_8 = __pyx_t_10;
    goto __pyx_L4_bool_binop_done;
  }
  __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_ref_dotdata, -1L, long, 1, __Pyx_PyInt_From_long, 0, 1, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 202, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_GetItemInt(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 202, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_ref_dotdata, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 202, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_4 = __Pyx_GetItemInt(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 202, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = PyNumber_Subtract(__pyx_t_2, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 202, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_11 = __Pyx_PyObject_AsDouble(__pyx_t_1); if (unlikely(__pyx_t_11 == ((double)-1) && PyErr_Occurred())) __PYX_ERR(0, 202, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_6 = PyObject_Length(__pyx_v_ref_seq); if (unlikely(__pyx_t_6 == -1)) __PYX_ERR(0, 202, __pyx_L1_error)
  if (unlikely(((double)__pyx_t_6) == 0)) {
    PyErr_SetString(PyExc_ZeroDivisionError, "float division");
    __PYX_ERR(0, 202, __pyx_L1_error)
  }
  __pyx_t_10 = (((__pyx_t_11 / ((double)__pyx_t_6)) > 0.7) != 0);
  if (__pyx_t_10) {
  } else {
    __pyx_t_8 = __pyx_t_10;
    goto __pyx_L4_bool_binop_done;
  }
  __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_alt_dotdata, -1L, long, 1, __Pyx_PyInt_From_long, 0, 1, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 202, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_4 = __Pyx_GetItemInt(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 202, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_alt_dotdata, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 202, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_GetItemInt(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 202, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = PyNumber_Subtract(__pyx_t_4, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 202, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_11 = __Pyx_PyObject_AsDouble(__pyx_t_1); if (unlikely(__pyx_t_11 == ((double)-1) && PyErr_Occurred())) __PYX_ERR(0, 202, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_6 = PyObject_Length(__pyx_v_alt_seq); if (unlikely(__pyx_t_6 == -1)) __PYX_ERR(0, 202, __pyx_L1_error)
  if (unlikely(((double)__pyx_t_6) == 0)) {
    PyErr_SetString(PyExc_ZeroDivisionError, "float division");
    __PYX_ERR(0, 202, __pyx_L1_error)
  }
  __pyx_t_10 = (((__pyx_t_11 / ((double)__pyx_t_6)) > 0.7) != 0);
  __pyx_t_8 = __pyx_t_10;
  __pyx_L4_bool_binop_done:;
  if (__pyx_t_8) {

    /* "vapor_vali/Simple_function.pyx":211
 *         #ref_clean_dotdata+=ref_anti_diag_clean_dotdata
 *         #alt_clean_dotdata+=alt_anti_diag_clean_dotdata
 *         ref_clean_dotdata=clean_dotdata_diagnal_and_anti_diagnal(ref_dotdata)             # <<<<<<<<<<<<<<
 *         alt_clean_dotdata=clean_dotdata_diagnal_and_anti_diagnal(alt_dotdata)
 *         if len(ref_clean_dotdata)>0 and len(alt_clean_dotdata)>0:
 */
    __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_clean_dotdata_diagnal_and_anti_d); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 211, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_4 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_2))) {
      __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_2);
      if (likely(__pyx_t_4)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
        __Pyx_INCREF(__pyx_t_4);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_2, function);
      }
    }
    if (!__pyx_t_4) {
      __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_v_ref_dotdata); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 211, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
    } else {
      __pyx_t_3 = PyTuple_New(1+1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 211, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __Pyx_GIVEREF(__pyx_t_4); PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_4); __pyx_t_4 = NULL;
      __Pyx_INCREF(__pyx_v_ref_dotdata);
      __Pyx_GIVEREF(__pyx_v_ref_dotdata);
      PyTuple_SET_ITEM(__pyx_t_3, 0+1, __pyx_v_ref_dotdata);
      __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_3, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 211, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    }
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_v_ref_clean_dotdata = __pyx_t_1;
    __pyx_t_1 = 0;

    /* "vapor_vali/Simple_function.pyx":212
 *         #alt_clean_dotdata+=alt_anti_diag_clean_dotdata
 *         ref_clean_dotdata=clean_dotdata_diagnal_and_anti_diagnal(ref_dotdata)
 *         alt_clean_dotdata=clean_dotdata_diagnal_and_anti_diagnal(alt_dotdata)             # <<<<<<<<<<<<<<
 *         if len(ref_clean_dotdata)>0 and len(alt_clean_dotdata)>0:
 *             return [eu_dis_reg_calcu(ref_clean_dotdata),eu_dis_reg_calcu(alt_clean_dotdata)]
 */
    __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_clean_dotdata_diagnal_and_anti_d); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 212, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_3 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_2))) {
      __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
      if (likely(__pyx_t_3)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
        __Pyx_INCREF(__pyx_t_3);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_2, function);
      }
    }
    if (!__pyx_t_3) {
      __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_v_alt_dotdata); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 212, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
    } else {
      __pyx_t_4 = PyTuple_New(1+1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 212, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      __Pyx_GIVEREF(__pyx_t_3); PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3); __pyx_t_3 = NULL;
      __Pyx_INCREF(__pyx_v_alt_dotdata);
      __Pyx_GIVEREF(__pyx_v_alt_dotdata);
      PyTuple_SET_ITEM(__pyx_t_4, 0+1, __pyx_v_alt_dotdata);
      __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_4, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 212, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    }
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_v_alt_clean_dotdata = __pyx_t_1;
    __pyx_t_1 = 0;

    /* "vapor_vali/Simple_function.pyx":213
 *         ref_clean_dotdata=clean_dotdata_diagnal_and_anti_diagnal(ref_dotdata)
 *         alt_clean_dotdata=clean_dotdata_diagnal_and_anti_diagnal(alt_dotdata)
 *         if len(ref_clean_dotdata)>0 and len(alt_clean_dotdata)>0:             # <<<<<<<<<<<<<<
 *             return [eu_dis_reg_calcu(ref_clean_dotdata),eu_dis_reg_calcu(alt_clean_dotdata)]
 *             #return [eu_dis_abs_calcu(take_off_symmetric_dots(ref_clean_dotdata)),eu_dis_abs_calcu(take_off_symmetric_dots(alt_clean_dotdata))]
 */
    __pyx_t_6 = PyObject_Length(__pyx_v_ref_clean_dotdata); if (unlikely(__pyx_t_6 == -1)) __PYX_ERR(0, 213, __pyx_L1_error)
    __pyx_t_10 = ((__pyx_t_6 > 0) != 0);
    if (__pyx_t_10) {
    } else {
      __pyx_t_8 = __pyx_t_10;
      goto __pyx_L9_bool_binop_done;
    }
    __pyx_t_6 = PyObject_Length(__pyx_v_alt_clean_dotdata); if (unlikely(__pyx_t_6 == -1)) __PYX_ERR(0, 213, __pyx_L1_error)
    __pyx_t_10 = ((__pyx_t_6 > 0) != 0);
    __pyx_t_8 = __pyx_t_10;
    __pyx_L9_bool_binop_done:;
    if (__pyx_t_8) {

      /* "vapor_vali/Simple_function.pyx":214
 *         alt_clean_dotdata=clean_dotdata_diagnal_and_anti_diagnal(alt_dotdata)
 *         if len(ref_clean_dotdata)>0 and len(alt_clean_dotdata)>0:
 *             return [eu_dis_reg_calcu(ref_clean_dotdata),eu_dis_reg_calcu(alt_clean_dotdata)]             # <<<<<<<<<<<<<<
 *             #return [eu_dis_abs_calcu(take_off_symmetric_dots(ref_clean_dotdata)),eu_dis_abs_calcu(take_off_symmetric_dots(alt_clean_dotdata))]
 *         else:
 */
      __Pyx_XDECREF(__pyx_r);
      __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_eu_dis_reg_calcu); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 214, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __pyx_t_4 = NULL;
      if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_2))) {
        __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_2);
        if (likely(__pyx_t_4)) {
          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
          __Pyx_INCREF(__pyx_t_4);
          __Pyx_INCREF(function);
          __Pyx_DECREF_SET(__pyx_t_2, function);
        }
      }
      if (!__pyx_t_4) {
        __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_v_ref_clean_dotdata); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 214, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
      } else {
        __pyx_t_3 = PyTuple_New(1+1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 214, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_3);
        __Pyx_GIVEREF(__pyx_t_4); PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_4); __pyx_t_4 = NULL;
        __Pyx_INCREF(__pyx_v_ref_clean_dotdata);
        __Pyx_GIVEREF(__pyx_v_ref_clean_dotdata);
        PyTuple_SET_ITEM(__pyx_t_3, 0+1, __pyx_v_ref_clean_dotdata);
        __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_3, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 214, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      }
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_eu_dis_reg_calcu); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 214, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __pyx_t_4 = NULL;
      if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_3))) {
        __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
        if (likely(__pyx_t_4)) {
          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
          __Pyx_INCREF(__pyx_t_4);
          __Pyx_INCREF(function);
          __Pyx_DECREF_SET(__pyx_t_3, function);
        }
      }
      if (!__pyx_t_4) {
        __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_v_alt_clean_dotdata); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 214, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
      } else {
        __pyx_t_7 = PyTuple_New(1+1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 214, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_7);
        __Pyx_GIVEREF(__pyx_t_4); PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_4); __pyx_t_4 = NULL;
        __Pyx_INCREF(__pyx_v_alt_clean_dotdata);
        __Pyx_GIVEREF(__pyx_v_alt_clean_dotdata);
        PyTuple_SET_ITEM(__pyx_t_7, 0+1, __pyx_v_alt_clean_dotdata);
        __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_7, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 214, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
        __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
      }
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_3 = PyList_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 214, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __Pyx_GIVEREF(__pyx_t_1);
      PyList_SET_ITEM(__pyx_t_3, 0, __pyx_t_1);
      __Pyx_GIVEREF(__pyx_t_2);
      PyList_SET_ITEM(__pyx_t_3, 1, __pyx_t_2);
      __pyx_t_1 = 0;
      __pyx_t_2 = 0;
      __pyx_r = __pyx_t_3;
      __pyx_t_3 = 0;
      goto __pyx_L0;

      /* "vapor_vali/Simple_function.pyx":213
 *         ref_clean_dotdata=clean_dotdata_diagnal_and_anti_diagnal(ref_dotdata)
 *         alt_clean_dotdata=clean_dotdata_diagnal_and_anti_diagnal(alt_dotdata)
 *         if len(ref_clean_dotdata)>0 and len(alt_clean_dotdata)>0:             # <<<<<<<<<<<<<<
 *             return [eu_dis_reg_calcu(ref_clean_dotdata),eu_dis_reg_calcu(alt_clean_dotdata)]
 *             #return [eu_dis_abs_calcu(take_off_symmetric_dots(ref_clean_dotdata)),eu_dis_abs_calcu(take_off_symmetric_dots(alt_clean_dotdata))]
 */
    }

    /* "vapor_vali/Simple_function.pyx":217
 *             #return [eu_dis_abs_calcu(take_off_symmetric_dots(ref_clean_dotdata)),eu_dis_abs_calcu(take_off_symmetric_dots(alt_clean_dotdata))]
 *         else:
 *             return [0,0]             # <<<<<<<<<<<<<<
 *     else:
 *         return [0,0]
 */
    /*else*/ {
      __Pyx_XDECREF(__pyx_r);
      __pyx_t_3 = PyList_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 217, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __Pyx_INCREF(__pyx_int_0);
      __Pyx_GIVEREF(__pyx_int_0);
      PyList_SET_ITEM(__pyx_t_3, 0, __pyx_int_0);
      __Pyx_INCREF(__pyx_int_0);
      __Pyx_GIVEREF(__pyx_int_0);
      PyList_SET_ITEM(__pyx_t_3, 1, __pyx_int_0);
      __pyx_r = __pyx_t_3;
      __pyx_t_3 = 0;
      goto __pyx_L0;
    }

    /* "vapor_vali/Simple_function.pyx":202
 *     ref_dotdata=dotdata(window_size,x[0],ref_seq[x[1]:])
 *     alt_dotdata=dotdata(window_size,x[0],alt_seq[x[1]:])
 *     if float(len(ref_dotdata))/float(len(ref_seq))>0.1 and float(len(alt_dotdata))/float(len(alt_seq))>0.1 and float(ref_dotdata[-1][0]-ref_dotdata[0][0])/float(len(ref_seq))>0.7 and float(alt_dotdata[-1][0]-alt_dotdata[0][0])/float(len(alt_seq))>0.7:             # <<<<<<<<<<<<<<
 *         #[ref_clean_dotdata,ref_kept_segs]=clean_dotdata_diagnal_m1b(ref_dotdata)
 *         #[alt_clean_dotdata,alt_kept_segs]=clean_dotdata_diagnal_m1b(alt_dotdata)
 */
  }

  /* "vapor_vali/Simple_function.pyx":219
 *             return [0,0]
 *     else:
 *         return [0,0]             # <<<<<<<<<<<<<<
 * 
 * def calcu_vapor_single_read_score_directed_dis_m1b_not_really(ref_seq,alt_seq,x,window_size,ref_bps,alt_bps):
 */
  /*else*/ {
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_3 = PyList_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 219, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_INCREF(__pyx_int_0);
    __Pyx_GIVEREF(__pyx_int_0);
    PyList_SET_ITEM(__pyx_t_3, 0, __pyx_int_0);
    __Pyx_INCREF(__pyx_int_0);
    __Pyx_GIVEREF(__pyx_int_0);
    PyList_SET_ITEM(__pyx_t_3, 1, __pyx_int_0);
    __pyx_r = __pyx_t_3;
    __pyx_t_3 = 0;
    goto __pyx_L0;
  }

  /* "vapor_vali/Simple_function.pyx":199
 *         return [0,0]
 * 
 * def calcu_vapor_single_read_score_directed_dis_m1b(ref_seq,alt_seq,x,window_size):             # <<<<<<<<<<<<<<
 *     ref_dotdata=dotdata(window_size,x[0],ref_seq[x[1]:])
 *     alt_dotdata=dotdata(window_size,x[0],alt_seq[x[1]:])
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_7);
  __Pyx_AddTraceback("vapor_vali.Simple_function.calcu_vapor_single_read_score_directed_dis_m1b", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_ref_dotdata);
  __Pyx_XDECREF(__pyx_v_alt_dotdata);
  __Pyx_XDECREF(__pyx_v_ref_clean_dotdata);
  __Pyx_XDECREF(__pyx_v_alt_clean_dotdata);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "vapor_vali/Simple_function.pyx":221
 *         return [0,0]
 * 
 * def calcu_vapor_single_read_score_directed_dis_m1b_not_really(ref_seq,alt_seq,x,window_size,ref_bps,alt_bps):             # <<<<<<<<<<<<<<
 *     ref_dotdata=dotdata(window_size,x[0],ref_seq[x[1]:])
 *     alt_dotdata=dotdata(window_size,x[0],alt_seq[x[1]:])
 */

/* Python wrapper */
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_23calcu_vapor_single_read_score_directed_dis_m1b_not_really(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_10vapor_vali_15Simple_function_23calcu_vapor_single_read_score_directed_dis_m1b_not_really = {"calcu_vapor_single_read_score_directed_dis_m1b_not_really", (PyCFunction)__pyx_pw_10vapor_vali_15Simple_function_23calcu_vapor_single_read_score_directed_dis_m1b_not_really, METH_VARARGS|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_23calcu_vapor_single_read_score_directed_dis_m1b_not_really(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_ref_seq = 0;
  PyObject *__pyx_v_alt_seq = 0;
  PyObject *__pyx_v_x = 0;
  PyObject *__pyx_v_window_size = 0;
  PyObject *__pyx_v_ref_bps = 0;
  PyObject *__pyx_v_alt_bps = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("calcu_vapor_single_read_score_directed_dis_m1b_not_really (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_ref_seq,&__pyx_n_s_alt_seq,&__pyx_n_s_x,&__pyx_n_s_window_size,&__pyx_n_s_ref_bps,&__pyx_n_s_alt_bps,0};
    PyObject* values[6] = {0,0,0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
      switch (pos_args) {
        case  6: values[5] = PyTuple_GET_ITEM(__pyx_args, 5);
        case  5: values[4] = PyTuple_GET_ITEM(__pyx_args, 4);
        case  4: values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
        case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_ref_seq)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_alt_seq)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("calcu_vapor_single_read_score_directed_dis_m1b_not_really", 1, 6, 6, 1); __PYX_ERR(0, 221, __pyx_L3_error)
        }
        case  2:
        if (likely((values[2] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_x)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("calcu_vapor_single_read_score_directed_dis_m1b_not_really", 1, 6, 6, 2); __PYX_ERR(0, 221, __pyx_L3_error)
        }
        case  3:
        if (likely((values[3] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_window_size)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("calcu_vapor_single_read_score_directed_dis_m1b_not_really", 1, 6, 6, 3); __PYX_ERR(0, 221, __pyx_L3_error)
        }
        case  4:
        if (likely((values[4] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_ref_bps)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("calcu_vapor_single_read_score_directed_dis_m1b_not_really", 1, 6, 6, 4); __PYX_ERR(0, 221, __pyx_L3_error)
        }
        case  5:
        if (likely((values[5] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_alt_bps)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("calcu_vapor_single_read_score_directed_dis_m1b_not_really", 1, 6, 6, 5); __PYX_ERR(0, 221, __pyx_L3_error)
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "calcu_vapor_single_read_score_directed_dis_m1b_not_really") < 0)) __PYX_ERR(0, 221, __pyx_L3_error)
      }
    } else if (PyTuple_GET_SIZE(__pyx_args) != 6) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
      values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
      values[4] = PyTuple_GET_ITEM(__pyx_args, 4);
      values[5] = PyTuple_GET_ITEM(__pyx_args, 5);
    }
    __pyx_v_ref_seq = values[0];
    __pyx_v_alt_seq = values[1];
    __pyx_v_x = values[2];
    __pyx_v_window_size = values[3];
    __pyx_v_ref_bps = values[4];
    __pyx_v_alt_bps = values[5];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("calcu_vapor_single_read_score_directed_dis_m1b_not_really", 1, 6, 6, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 221, __pyx_L3_error)
  __pyx_L3_error:;
  __Pyx_AddTraceback("vapor_vali.Simple_function.calcu_vapor_single_read_score_directed_dis_m1b_not_really", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_10vapor_vali_15Simple_function_22calcu_vapor_single_read_score_directed_dis_m1b_not_really(__pyx_self, __pyx_v_ref_seq, __pyx_v_alt_seq, __pyx_v_x, __pyx_v_window_size, __pyx_v_ref_bps, __pyx_v_alt_bps);

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10vapor_vali_15Simple_function_22calcu_vapor_single_read_score_directed_dis_m1b_not_really(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_ref_seq, PyObject *__pyx_v_alt_seq, PyObject *__pyx_v_x, PyObject *__pyx_v_window_size, PyObject *__pyx_v_ref_bps, PyObject *__pyx_v_alt_bps) {
  PyObject *__pyx_v_ref_dotdata = NULL;
  PyObject *__pyx_v_alt_dotdata = NULL;
  PyObject *__pyx_v_ref_clean_dotdata = NULL;
  PyObject *__pyx_v_alt_clean_dotdata = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  Py_ssize_t __pyx_t_6;
  PyObject *__pyx_t_7 = NULL;
  int __pyx_t_8;
  Py_ssize_t __pyx_t_9;
  int __pyx_t_10;
  double __pyx_t_11;
  __Pyx_RefNannySetupContext("calcu_vapor_single_read_score_directed_dis_m1b_not_really", 0);

  /* "vapor_vali/Simple_function.pyx":222
 * 
 * def calcu_vapor_single_read_score_directed_dis_m1b_not_really(ref_seq,alt_seq,x,window_size,ref_bps,alt_bps):
 *     ref_dotdata=dotdata(window_size,x[0],ref_seq[x[1]:])             # <<<<<<<<<<<<<<
 *     alt_dotdata=dotdata(window_size,x[0],alt_seq[x[1]:])
 *     if float(len(ref_dotdata))/float(len(ref_seq))>0.1 and float(len(alt_dotdata))/float(len(alt_seq))>0.1 and float(ref_dotdata[-1][0]-ref_dotdata[0][0])/float(len(ref_seq))>0.7 and float(alt_dotdata[-1][0]-alt_dotdata[0][0])/float(len(alt_seq))>0.7:
 */
  __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_dotdata); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 222, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_x, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 222, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_4 = __Pyx_GetItemInt(__pyx_v_x, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 222, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_5 = __Pyx_PyObject_GetSlice(__pyx_v_ref_seq, 0, 0, &__pyx_t_4, NULL, NULL, 0, 0, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 222, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = NULL;
  __pyx_t_6 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_2);
    if (likely(__pyx_t_4)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_4);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_2, function);
      __pyx_t_6 = 1;
    }
  }
  __pyx_t_7 = PyTuple_New(3+__pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 222, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  if (__pyx_t_4) {
    __Pyx_GIVEREF(__pyx_t_4); PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_4); __pyx_t_4 = NULL;
  }
  __Pyx_INCREF(__pyx_v_window_size);
  __Pyx_GIVEREF(__pyx_v_window_size);
  PyTuple_SET_ITEM(__pyx_t_7, 0+__pyx_t_6, __pyx_v_window_size);
  __Pyx_GIVEREF(__pyx_t_3);
  PyTuple_SET_ITEM(__pyx_t_7, 1+__pyx_t_6, __pyx_t_3);
  __Pyx_GIVEREF(__pyx_t_5);
  PyTuple_SET_ITEM(__pyx_t_7, 2+__pyx_t_6, __pyx_t_5);
  __pyx_t_3 = 0;
  __pyx_t_5 = 0;
  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_7, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 222, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_ref_dotdata = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":223
 * def calcu_vapor_single_read_score_directed_dis_m1b_not_really(ref_seq,alt_seq,x,window_size,ref_bps,alt_bps):
 *     ref_dotdata=dotdata(window_size,x[0],ref_seq[x[1]:])
 *     alt_dotdata=dotdata(window_size,x[0],alt_seq[x[1]:])             # <<<<<<<<<<<<<<
 *     if float(len(ref_dotdata))/float(len(ref_seq))>0.1 and float(len(alt_dotdata))/float(len(alt_seq))>0.1 and float(ref_dotdata[-1][0]-ref_dotdata[0][0])/float(len(ref_seq))>0.7 and float(alt_dotdata[-1][0]-alt_dotdata[0][0])/float(len(alt_seq))>0.7:
 *         ref_clean_dotdata=clean_dotdata_diagnal_and_anti_diagnal(ref_dotdata)
 */
  __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_dotdata); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 223, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_7 = __Pyx_GetItemInt(__pyx_v_x, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 223, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  __pyx_t_5 = __Pyx_GetItemInt(__pyx_v_x, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 223, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_3 = __Pyx_PyObject_GetSlice(__pyx_v_alt_seq, 0, 0, &__pyx_t_5, NULL, NULL, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 223, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = NULL;
  __pyx_t_6 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_2);
    if (likely(__pyx_t_5)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_5);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_2, function);
      __pyx_t_6 = 1;
    }
  }
  __pyx_t_4 = PyTuple_New(3+__pyx_t_6); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 223, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  if (__pyx_t_5) {
    __Pyx_GIVEREF(__pyx_t_5); PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_5); __pyx_t_5 = NULL;
  }
  __Pyx_INCREF(__pyx_v_window_size);
  __Pyx_GIVEREF(__pyx_v_window_size);
  PyTuple_SET_ITEM(__pyx_t_4, 0+__pyx_t_6, __pyx_v_window_size);
  __Pyx_GIVEREF(__pyx_t_7);
  PyTuple_SET_ITEM(__pyx_t_4, 1+__pyx_t_6, __pyx_t_7);
  __Pyx_GIVEREF(__pyx_t_3);
  PyTuple_SET_ITEM(__pyx_t_4, 2+__pyx_t_6, __pyx_t_3);
  __pyx_t_7 = 0;
  __pyx_t_3 = 0;
  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_4, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 223, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_alt_dotdata = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":224
 *     ref_dotdata=dotdata(window_size,x[0],ref_seq[x[1]:])
 *     alt_dotdata=dotdata(window_size,x[0],alt_seq[x[1]:])
 *     if float(len(ref_dotdata))/float(len(ref_seq))>0.1 and float(len(alt_dotdata))/float(len(alt_seq))>0.1 and float(ref_dotdata[-1][0]-ref_dotdata[0][0])/float(len(ref_seq))>0.7 and float(alt_dotdata[-1][0]-alt_dotdata[0][0])/float(len(alt_seq))>0.7:             # <<<<<<<<<<<<<<
 *         ref_clean_dotdata=clean_dotdata_diagnal_and_anti_diagnal(ref_dotdata)
 *         alt_clean_dotdata=clean_dotdata_diagnal_and_anti_diagnal(alt_dotdata)
 */
  __pyx_t_6 = PyObject_Length(__pyx_v_ref_dotdata); if (unlikely(__pyx_t_6 == -1)) __PYX_ERR(0, 224, __pyx_L1_error)
  __pyx_t_9 = PyObject_Length(__pyx_v_ref_seq); if (unlikely(__pyx_t_9 == -1)) __PYX_ERR(0, 224, __pyx_L1_error)
  if (unlikely(((double)__pyx_t_9) == 0)) {
    PyErr_SetString(PyExc_ZeroDivisionError, "float division");
    __PYX_ERR(0, 224, __pyx_L1_error)
  }
  __pyx_t_10 = (((((double)__pyx_t_6) / ((double)__pyx_t_9)) > 0.1) != 0);
  if (__pyx_t_10) {
  } else {
    __pyx_t_8 = __pyx_t_10;
    goto __pyx_L4_bool_binop_done;
  }
  __pyx_t_9 = PyObject_Length(__pyx_v_alt_dotdata); if (unlikely(__pyx_t_9 == -1)) __PYX_ERR(0, 224, __pyx_L1_error)
  __pyx_t_6 = PyObject_Length(__pyx_v_alt_seq); if (unlikely(__pyx_t_6 == -1)) __PYX_ERR(0, 224, __pyx_L1_error)
  if (unlikely(((double)__pyx_t_6) == 0)) {
    PyErr_SetString(PyExc_ZeroDivisionError, "float division");
    __PYX_ERR(0, 224, __pyx_L1_error)
  }
  __pyx_t_10 = (((((double)__pyx_t_9) / ((double)__pyx_t_6)) > 0.1) != 0);
  if (__pyx_t_10) {
  } else {
    __pyx_t_8 = __pyx_t_10;
    goto __pyx_L4_bool_binop_done;
  }
  __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_ref_dotdata, -1L, long, 1, __Pyx_PyInt_From_long, 0, 1, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 224, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_GetItemInt(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 224, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_ref_dotdata, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 224, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_4 = __Pyx_GetItemInt(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 224, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = PyNumber_Subtract(__pyx_t_2, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 224, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_11 = __Pyx_PyObject_AsDouble(__pyx_t_1); if (unlikely(__pyx_t_11 == ((double)-1) && PyErr_Occurred())) __PYX_ERR(0, 224, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_6 = PyObject_Length(__pyx_v_ref_seq); if (unlikely(__pyx_t_6 == -1)) __PYX_ERR(0, 224, __pyx_L1_error)
  if (unlikely(((double)__pyx_t_6) == 0)) {
    PyErr_SetString(PyExc_ZeroDivisionError, "float division");
    __PYX_ERR(0, 224, __pyx_L1_error)
  }
  __pyx_t_10 = (((__pyx_t_11 / ((double)__pyx_t_6)) > 0.7) != 0);
  if (__pyx_t_10) {
  } else {
    __pyx_t_8 = __pyx_t_10;
    goto __pyx_L4_bool_binop_done;
  }
  __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_alt_dotdata, -1L, long, 1, __Pyx_PyInt_From_long, 0, 1, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 224, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_4 = __Pyx_GetItemInt(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 224, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_alt_dotdata, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 224, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_GetItemInt(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 224, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = PyNumber_Subtract(__pyx_t_4, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 224, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_11 = __Pyx_PyObject_AsDouble(__pyx_t_1); if (unlikely(__pyx_t_11 == ((double)-1) && PyErr_Occurred())) __PYX_ERR(0, 224, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_6 = PyObject_Length(__pyx_v_alt_seq); if (unlikely(__pyx_t_6 == -1)) __PYX_ERR(0, 224, __pyx_L1_error)
  if (unlikely(((double)__pyx_t_6) == 0)) {
    PyErr_SetString(PyExc_ZeroDivisionError, "float division");
    __PYX_ERR(0, 224, __pyx_L1_error)
  }
  __pyx_t_10 = (((__pyx_t_11 / ((double)__pyx_t_6)) > 0.7) != 0);
  __pyx_t_8 = __pyx_t_10;
  __pyx_L4_bool_binop_done:;
  if (__pyx_t_8) {

    /* "vapor_vali/Simple_function.pyx":225
 *     alt_dotdata=dotdata(window_size,x[0],alt_seq[x[1]:])
 *     if float(len(ref_dotdata))/float(len(ref_seq))>0.1 and float(len(alt_dotdata))/float(len(alt_seq))>0.1 and float(ref_dotdata[-1][0]-ref_dotdata[0][0])/float(len(ref_seq))>0.7 and float(alt_dotdata[-1][0]-alt_dotdata[0][0])/float(len(alt_seq))>0.7:
 *         ref_clean_dotdata=clean_dotdata_diagnal_and_anti_diagnal(ref_dotdata)             # <<<<<<<<<<<<<<
 *         alt_clean_dotdata=clean_dotdata_diagnal_and_anti_diagnal(alt_dotdata)
 *         if len(ref_clean_dotdata)>0 and len(alt_clean_dotdata)>0:
 */
    __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_clean_dotdata_diagnal_and_anti_d); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 225, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_4 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_2))) {
      __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_2);
      if (likely(__pyx_t_4)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
        __Pyx_INCREF(__pyx_t_4);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_2, function);
      }
    }
    if (!__pyx_t_4) {
      __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_v_ref_dotdata); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 225, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
    } else {
      __pyx_t_3 = PyTuple_New(1+1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 225, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __Pyx_GIVEREF(__pyx_t_4); PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_4); __pyx_t_4 = NULL;
      __Pyx_INCREF(__pyx_v_ref_dotdata);
      __Pyx_GIVEREF(__pyx_v_ref_dotdata);
      PyTuple_SET_ITEM(__pyx_t_3, 0+1, __pyx_v_ref_dotdata);
      __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_3, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 225, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    }
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_v_ref_clean_dotdata = __pyx_t_1;
    __pyx_t_1 = 0;

    /* "vapor_vali/Simple_function.pyx":226
 *     if float(len(ref_dotdata))/float(len(ref_seq))>0.1 and float(len(alt_dotdata))/float(len(alt_seq))>0.1 and float(ref_dotdata[-1][0]-ref_dotdata[0][0])/float(len(ref_seq))>0.7 and float(alt_dotdata[-1][0]-alt_dotdata[0][0])/float(len(alt_seq))>0.7:
 *         ref_clean_dotdata=clean_dotdata_diagnal_and_anti_diagnal(ref_dotdata)
 *         alt_clean_dotdata=clean_dotdata_diagnal_and_anti_diagnal(alt_dotdata)             # <<<<<<<<<<<<<<
 *         if len(ref_clean_dotdata)>0 and len(alt_clean_dotdata)>0:
 *             return [abs(eu_dis_region_calcu(ref_clean_dotdata,ref_bps)),abs(eu_dis_region_calcu(alt_clean_dotdata,alt_bps))]
 */
    __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_clean_dotdata_diagnal_and_anti_d); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 226, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_3 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_2))) {
      __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
      if (likely(__pyx_t_3)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
        __Pyx_INCREF(__pyx_t_3);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_2, function);
      }
    }
    if (!__pyx_t_3) {
      __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_v_alt_dotdata); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 226, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
    } else {
      __pyx_t_4 = PyTuple_New(1+1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 226, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      __Pyx_GIVEREF(__pyx_t_3); PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3); __pyx_t_3 = NULL;
      __Pyx_INCREF(__pyx_v_alt_dotdata);
      __Pyx_GIVEREF(__pyx_v_alt_dotdata);
      PyTuple_SET_ITEM(__pyx_t_4, 0+1, __pyx_v_alt_dotdata);
      __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_4, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 226, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    }
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_v_alt_clean_dotdata = __pyx_t_1;
    __pyx_t_1 = 0;

    /* "vapor_vali/Simple_function.pyx":227
 *         ref_clean_dotdata=clean_dotdata_diagnal_and_anti_diagnal(ref_dotdata)
 *         alt_clean_dotdata=clean_dotdata_diagnal_and_anti_diagnal(alt_dotdata)
 *         if len(ref_clean_dotdata)>0 and len(alt_clean_dotdata)>0:             # <<<<<<<<<<<<<<
 *             return [abs(eu_dis_region_calcu(ref_clean_dotdata,ref_bps)),abs(eu_dis_region_calcu(alt_clean_dotdata,alt_bps))]
 *             #return [eu_dis_abs_calcu(take_off_symmetric_dots(ref_clean_dotdata)),eu_dis_abs_calcu(take_off_symmetric_dots(alt_clean_dotdata))]
 */
    __pyx_t_6 = PyObject_Length(__pyx_v_ref_clean_dotdata); if (unlikely(__pyx_t_6 == -1)) __PYX_ERR(0, 227, __pyx_L1_error)
    __pyx_t_10 = ((__pyx_t_6 > 0) != 0);
    if (__pyx_t_10) {
    } else {
      __pyx_t_8 = __pyx_t_10;
      goto __pyx_L9_bool_binop_done;
    }
    __pyx_t_6 = PyObject_Length(__pyx_v_alt_clean_dotdata); if (unlikely(__pyx_t_6 == -1)) __PYX_ERR(0, 227, __pyx_L1_error)
    __pyx_t_10 = ((__pyx_t_6 > 0) != 0);
    __pyx_t_8 = __pyx_t_10;
    __pyx_L9_bool_binop_done:;
    if (__pyx_t_8) {

      /* "vapor_vali/Simple_function.pyx":228
 *         alt_clean_dotdata=clean_dotdata_diagnal_and_anti_diagnal(alt_dotdata)
 *         if len(ref_clean_dotdata)>0 and len(alt_clean_dotdata)>0:
 *             return [abs(eu_dis_region_calcu(ref_clean_dotdata,ref_bps)),abs(eu_dis_region_calcu(alt_clean_dotdata,alt_bps))]             # <<<<<<<<<<<<<<
 *             #return [eu_dis_abs_calcu(take_off_symmetric_dots(ref_clean_dotdata)),eu_dis_abs_calcu(take_off_symmetric_dots(alt_clean_dotdata))]
 *         else:
 */
      __Pyx_XDECREF(__pyx_r);
      __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_eu_dis_region_calcu); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 228, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __pyx_t_4 = NULL;
      __pyx_t_6 = 0;
      if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_2))) {
        __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_2);
        if (likely(__pyx_t_4)) {
          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
          __Pyx_INCREF(__pyx_t_4);
          __Pyx_INCREF(function);
          __Pyx_DECREF_SET(__pyx_t_2, function);
          __pyx_t_6 = 1;
        }
      }
      __pyx_t_3 = PyTuple_New(2+__pyx_t_6); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 228, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      if (__pyx_t_4) {
        __Pyx_GIVEREF(__pyx_t_4); PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_4); __pyx_t_4 = NULL;
      }
      __Pyx_INCREF(__pyx_v_ref_clean_dotdata);
      __Pyx_GIVEREF(__pyx_v_ref_clean_dotdata);
      PyTuple_SET_ITEM(__pyx_t_3, 0+__pyx_t_6, __pyx_v_ref_clean_dotdata);
      __Pyx_INCREF(__pyx_v_ref_bps);
      __Pyx_GIVEREF(__pyx_v_ref_bps);
      PyTuple_SET_ITEM(__pyx_t_3, 1+__pyx_t_6, __pyx_v_ref_bps);
      __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_3, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 228, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_2 = PyNumber_Absolute(__pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 228, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_eu_dis_region_calcu); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 228, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __pyx_t_4 = NULL;
      __pyx_t_6 = 0;
      if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_3))) {
        __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
        if (likely(__pyx_t_4)) {
          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
          __Pyx_INCREF(__pyx_t_4);
          __Pyx_INCREF(function);
          __Pyx_DECREF_SET(__pyx_t_3, function);
          __pyx_t_6 = 1;
        }
      }
      __pyx_t_7 = PyTuple_New(2+__pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 228, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_7);
      if (__pyx_t_4) {
        __Pyx_GIVEREF(__pyx_t_4); PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_4); __pyx_t_4 = NULL;
      }
      __Pyx_INCREF(__pyx_v_alt_clean_dotdata);
      __Pyx_GIVEREF(__pyx_v_alt_clean_dotdata);
      PyTuple_SET_ITEM(__pyx_t_7, 0+__pyx_t_6, __pyx_v_alt_clean_dotdata);
      __Pyx_INCREF(__pyx_v_alt_bps);
      __Pyx_GIVEREF(__pyx_v_alt_bps);
      PyTuple_SET_ITEM(__pyx_t_7, 1+__pyx_t_6, __pyx_v_alt_bps);
      __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_7, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 228, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_3 = PyNumber_Absolute(__pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 228, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_1 = PyList_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 228, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_GIVEREF(__pyx_t_2);
      PyList_SET_ITEM(__pyx_t_1, 0, __pyx_t_2);
      __Pyx_GIVEREF(__pyx_t_3);
      PyList_SET_ITEM(__pyx_t_1, 1, __pyx_t_3);
      __pyx_t_2 = 0;
      __pyx_t_3 = 0;
      __pyx_r = __pyx_t_1;
      __pyx_t_1 = 0;
      goto __pyx_L0;

      /* "vapor_vali/Simple_function.pyx":227
 *         ref_clean_dotdata=clean_dotdata_diagnal_and_anti_diagnal(ref_dotdata)
 *         alt_clean_dotdata=clean_dotdata_diagnal_and_anti_diagnal(alt_dotdata)
 *         if len(ref_clean_dotdata)>0 and len(alt_clean_dotdata)>0:             # <<<<<<<<<<<<<<
 *             return [abs(eu_dis_region_calcu(ref_clean_dotdata,ref_bps)),abs(eu_dis_region_calcu(alt_clean_dotdata,alt_bps))]
 *             #return [eu_dis_abs_calcu(take_off_symmetric_dots(ref_clean_dotdata)),eu_dis_abs_calcu(take_off_symmetric_dots(alt_clean_dotdata))]
 */
    }

    /* "vapor_vali/Simple_function.pyx":231
 *             #return [eu_dis_abs_calcu(take_off_symmetric_dots(ref_clean_dotdata)),eu_dis_abs_calcu(take_off_symmetric_dots(alt_clean_dotdata))]
 *         else:
 *             return [0,0]             # <<<<<<<<<<<<<<
 *     else:
 *         return [0,0]
 */
    /*else*/ {
      __Pyx_XDECREF(__pyx_r);
      __pyx_t_1 = PyList_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 231, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_INCREF(__pyx_int_0);
      __Pyx_GIVEREF(__pyx_int_0);
      PyList_SET_ITEM(__pyx_t_1, 0, __pyx_int_0);
      __Pyx_INCREF(__pyx_int_0);
      __Pyx_GIVEREF(__pyx_int_0);
      PyList_SET_ITEM(__pyx_t_1, 1, __pyx_int_0);
      __pyx_r = __pyx_t_1;
      __pyx_t_1 = 0;
      goto __pyx_L0;
    }

    /* "vapor_vali/Simple_function.pyx":224
 *     ref_dotdata=dotdata(window_size,x[0],ref_seq[x[1]:])
 *     alt_dotdata=dotdata(window_size,x[0],alt_seq[x[1]:])
 *     if float(len(ref_dotdata))/float(len(ref_seq))>0.1 and float(len(alt_dotdata))/float(len(alt_seq))>0.1 and float(ref_dotdata[-1][0]-ref_dotdata[0][0])/float(len(ref_seq))>0.7 and float(alt_dotdata[-1][0]-alt_dotdata[0][0])/float(len(alt_seq))>0.7:             # <<<<<<<<<<<<<<
 *         ref_clean_dotdata=clean_dotdata_diagnal_and_anti_diagnal(ref_dotdata)
 *         alt_clean_dotdata=clean_dotdata_diagnal_and_anti_diagnal(alt_dotdata)
 */
  }

  /* "vapor_vali/Simple_function.pyx":233
 *             return [0,0]
 *     else:
 *         return [0,0]             # <<<<<<<<<<<<<<
 * 
 * def calcu_vapor_single_read_score_directed_dis_m1b_redefine_diagnal(ref_seq,alt_seq,x,window_size):
 */
  /*else*/ {
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = PyList_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 233, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_INCREF(__pyx_int_0);
    __Pyx_GIVEREF(__pyx_int_0);
    PyList_SET_ITEM(__pyx_t_1, 0, __pyx_int_0);
    __Pyx_INCREF(__pyx_int_0);
    __Pyx_GIVEREF(__pyx_int_0);
    PyList_SET_ITEM(__pyx_t_1, 1, __pyx_int_0);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;
  }

  /* "vapor_vali/Simple_function.pyx":221
 *         return [0,0]
 * 
 * def calcu_vapor_single_read_score_directed_dis_m1b_not_really(ref_seq,alt_seq,x,window_size,ref_bps,alt_bps):             # <<<<<<<<<<<<<<
 *     ref_dotdata=dotdata(window_size,x[0],ref_seq[x[1]:])
 *     alt_dotdata=dotdata(window_size,x[0],alt_seq[x[1]:])
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_7);
  __Pyx_AddTraceback("vapor_vali.Simple_function.calcu_vapor_single_read_score_directed_dis_m1b_not_really", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_ref_dotdata);
  __Pyx_XDECREF(__pyx_v_alt_dotdata);
  __Pyx_XDECREF(__pyx_v_ref_clean_dotdata);
  __Pyx_XDECREF(__pyx_v_alt_clean_dotdata);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "vapor_vali/Simple_function.pyx":235
 *         return [0,0]
 * 
 * def calcu_vapor_single_read_score_directed_dis_m1b_redefine_diagnal(ref_seq,alt_seq,x,window_size):             # <<<<<<<<<<<<<<
 *     ref_dotdata=dotdata(window_size,x[0],ref_seq[x[1]:])
 *     alt_dotdata=dotdata(window_size,x[0],alt_seq[x[1]:])
 */

/* Python wrapper */
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_25calcu_vapor_single_read_score_directed_dis_m1b_redefine_diagnal(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_10vapor_vali_15Simple_function_25calcu_vapor_single_read_score_directed_dis_m1b_redefine_diagnal = {"calcu_vapor_single_read_score_directed_dis_m1b_redefine_diagnal", (PyCFunction)__pyx_pw_10vapor_vali_15Simple_function_25calcu_vapor_single_read_score_directed_dis_m1b_redefine_diagnal, METH_VARARGS|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_25calcu_vapor_single_read_score_directed_dis_m1b_redefine_diagnal(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_ref_seq = 0;
  PyObject *__pyx_v_alt_seq = 0;
  PyObject *__pyx_v_x = 0;
  PyObject *__pyx_v_window_size = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("calcu_vapor_single_read_score_directed_dis_m1b_redefine_diagnal (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_ref_seq,&__pyx_n_s_alt_seq,&__pyx_n_s_x,&__pyx_n_s_window_size,0};
    PyObject* values[4] = {0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
      switch (pos_args) {
        case  4: values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
        case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_ref_seq)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_alt_seq)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("calcu_vapor_single_read_score_directed_dis_m1b_redefine_diagnal", 1, 4, 4, 1); __PYX_ERR(0, 235, __pyx_L3_error)
        }
        case  2:
        if (likely((values[2] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_x)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("calcu_vapor_single_read_score_directed_dis_m1b_redefine_diagnal", 1, 4, 4, 2); __PYX_ERR(0, 235, __pyx_L3_error)
        }
        case  3:
        if (likely((values[3] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_window_size)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("calcu_vapor_single_read_score_directed_dis_m1b_redefine_diagnal", 1, 4, 4, 3); __PYX_ERR(0, 235, __pyx_L3_error)
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "calcu_vapor_single_read_score_directed_dis_m1b_redefine_diagnal") < 0)) __PYX_ERR(0, 235, __pyx_L3_error)
      }
    } else if (PyTuple_GET_SIZE(__pyx_args) != 4) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
      values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
    }
    __pyx_v_ref_seq = values[0];
    __pyx_v_alt_seq = values[1];
    __pyx_v_x = values[2];
    __pyx_v_window_size = values[3];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("calcu_vapor_single_read_score_directed_dis_m1b_redefine_diagnal", 1, 4, 4, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 235, __pyx_L3_error)
  __pyx_L3_error:;
  __Pyx_AddTraceback("vapor_vali.Simple_function.calcu_vapor_single_read_score_directed_dis_m1b_redefine_diagnal", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_10vapor_vali_15Simple_function_24calcu_vapor_single_read_score_directed_dis_m1b_redefine_diagnal(__pyx_self, __pyx_v_ref_seq, __pyx_v_alt_seq, __pyx_v_x, __pyx_v_window_size);

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10vapor_vali_15Simple_function_24calcu_vapor_single_read_score_directed_dis_m1b_redefine_diagnal(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_ref_seq, PyObject *__pyx_v_alt_seq, PyObject *__pyx_v_x, PyObject *__pyx_v_window_size) {
  PyObject *__pyx_v_ref_dotdata = NULL;
  PyObject *__pyx_v_alt_dotdata = NULL;
  PyObject *__pyx_v_ref_clean_dotdata = NULL;
  PyObject *__pyx_v_alt_clean_dotdata = NULL;
  PyObject *__pyx_v_ref_new_intercept = NULL;
  PyObject *__pyx_v_alt_new_intercept = NULL;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  Py_ssize_t __pyx_t_6;
  PyObject *__pyx_t_7 = NULL;
  int __pyx_t_8;
  Py_ssize_t __pyx_t_9;
  int __pyx_t_10;
  double __pyx_t_11;
  PyObject *(*__pyx_t_12)(PyObject *);
  PyObject *__pyx_t_13 = NULL;
  PyObject *__pyx_t_14 = NULL;
  __Pyx_RefNannySetupContext("calcu_vapor_single_read_score_directed_dis_m1b_redefine_diagnal", 0);

  /* "vapor_vali/Simple_function.pyx":236
 * 
 * def calcu_vapor_single_read_score_directed_dis_m1b_redefine_diagnal(ref_seq,alt_seq,x,window_size):
 *     ref_dotdata=dotdata(window_size,x[0],ref_seq[x[1]:])             # <<<<<<<<<<<<<<
 *     alt_dotdata=dotdata(window_size,x[0],alt_seq[x[1]:])
 *     if float(len(ref_dotdata))/float(len(ref_seq))>0.1 and float(len(alt_dotdata))/float(len(alt_seq))>0.1 and float(ref_dotdata[-1][0]-ref_dotdata[0][0])/float(len(ref_seq))>0.7 and float(alt_dotdata[-1][0]-alt_dotdata[0][0])/float(len(alt_seq))>0.7:
 */
  __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_dotdata); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 236, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_x, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 236, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_4 = __Pyx_GetItemInt(__pyx_v_x, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 236, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_5 = __Pyx_PyObject_GetSlice(__pyx_v_ref_seq, 0, 0, &__pyx_t_4, NULL, NULL, 0, 0, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 236, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = NULL;
  __pyx_t_6 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_2);
    if (likely(__pyx_t_4)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_4);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_2, function);
      __pyx_t_6 = 1;
    }
  }
  __pyx_t_7 = PyTuple_New(3+__pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 236, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  if (__pyx_t_4) {
    __Pyx_GIVEREF(__pyx_t_4); PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_4); __pyx_t_4 = NULL;
  }
  __Pyx_INCREF(__pyx_v_window_size);
  __Pyx_GIVEREF(__pyx_v_window_size);
  PyTuple_SET_ITEM(__pyx_t_7, 0+__pyx_t_6, __pyx_v_window_size);
  __Pyx_GIVEREF(__pyx_t_3);
  PyTuple_SET_ITEM(__pyx_t_7, 1+__pyx_t_6, __pyx_t_3);
  __Pyx_GIVEREF(__pyx_t_5);
  PyTuple_SET_ITEM(__pyx_t_7, 2+__pyx_t_6, __pyx_t_5);
  __pyx_t_3 = 0;
  __pyx_t_5 = 0;
  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_7, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 236, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_ref_dotdata = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":237
 * def calcu_vapor_single_read_score_directed_dis_m1b_redefine_diagnal(ref_seq,alt_seq,x,window_size):
 *     ref_dotdata=dotdata(window_size,x[0],ref_seq[x[1]:])
 *     alt_dotdata=dotdata(window_size,x[0],alt_seq[x[1]:])             # <<<<<<<<<<<<<<
 *     if float(len(ref_dotdata))/float(len(ref_seq))>0.1 and float(len(alt_dotdata))/float(len(alt_seq))>0.1 and float(ref_dotdata[-1][0]-ref_dotdata[0][0])/float(len(ref_seq))>0.7 and float(alt_dotdata[-1][0]-alt_dotdata[0][0])/float(len(alt_seq))>0.7:
 *         ref_clean_dotdata=clean_dotdata_diagnal_and_anti_diagnal(ref_dotdata)
 */
  __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_dotdata); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 237, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_7 = __Pyx_GetItemInt(__pyx_v_x, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 237, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  __pyx_t_5 = __Pyx_GetItemInt(__pyx_v_x, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 237, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_3 = __Pyx_PyObject_GetSlice(__pyx_v_alt_seq, 0, 0, &__pyx_t_5, NULL, NULL, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 237, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = NULL;
  __pyx_t_6 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_2);
    if (likely(__pyx_t_5)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_5);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_2, function);
      __pyx_t_6 = 1;
    }
  }
  __pyx_t_4 = PyTuple_New(3+__pyx_t_6); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 237, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  if (__pyx_t_5) {
    __Pyx_GIVEREF(__pyx_t_5); PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_5); __pyx_t_5 = NULL;
  }
  __Pyx_INCREF(__pyx_v_window_size);
  __Pyx_GIVEREF(__pyx_v_window_size);
  PyTuple_SET_ITEM(__pyx_t_4, 0+__pyx_t_6, __pyx_v_window_size);
  __Pyx_GIVEREF(__pyx_t_7);
  PyTuple_SET_ITEM(__pyx_t_4, 1+__pyx_t_6, __pyx_t_7);
  __Pyx_GIVEREF(__pyx_t_3);
  PyTuple_SET_ITEM(__pyx_t_4, 2+__pyx_t_6, __pyx_t_3);
  __pyx_t_7 = 0;
  __pyx_t_3 = 0;
  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_4, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 237, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_alt_dotdata = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":238
 *     ref_dotdata=dotdata(window_size,x[0],ref_seq[x[1]:])
 *     alt_dotdata=dotdata(window_size,x[0],alt_seq[x[1]:])
 *     if float(len(ref_dotdata))/float(len(ref_seq))>0.1 and float(len(alt_dotdata))/float(len(alt_seq))>0.1 and float(ref_dotdata[-1][0]-ref_dotdata[0][0])/float(len(ref_seq))>0.7 and float(alt_dotdata[-1][0]-alt_dotdata[0][0])/float(len(alt_seq))>0.7:             # <<<<<<<<<<<<<<
 *         ref_clean_dotdata=clean_dotdata_diagnal_and_anti_diagnal(ref_dotdata)
 *         alt_clean_dotdata=clean_dotdata_diagnal_and_anti_diagnal(alt_dotdata)
 */
  __pyx_t_6 = PyObject_Length(__pyx_v_ref_dotdata); if (unlikely(__pyx_t_6 == -1)) __PYX_ERR(0, 238, __pyx_L1_error)
  __pyx_t_9 = PyObject_Length(__pyx_v_ref_seq); if (unlikely(__pyx_t_9 == -1)) __PYX_ERR(0, 238, __pyx_L1_error)
  if (unlikely(((double)__pyx_t_9) == 0)) {
    PyErr_SetString(PyExc_ZeroDivisionError, "float division");
    __PYX_ERR(0, 238, __pyx_L1_error)
  }
  __pyx_t_10 = (((((double)__pyx_t_6) / ((double)__pyx_t_9)) > 0.1) != 0);
  if (__pyx_t_10) {
  } else {
    __pyx_t_8 = __pyx_t_10;
    goto __pyx_L4_bool_binop_done;
  }
  __pyx_t_9 = PyObject_Length(__pyx_v_alt_dotdata); if (unlikely(__pyx_t_9 == -1)) __PYX_ERR(0, 238, __pyx_L1_error)
  __pyx_t_6 = PyObject_Length(__pyx_v_alt_seq); if (unlikely(__pyx_t_6 == -1)) __PYX_ERR(0, 238, __pyx_L1_error)
  if (unlikely(((double)__pyx_t_6) == 0)) {
    PyErr_SetString(PyExc_ZeroDivisionError, "float division");
    __PYX_ERR(0, 238, __pyx_L1_error)
  }
  __pyx_t_10 = (((((double)__pyx_t_9) / ((double)__pyx_t_6)) > 0.1) != 0);
  if (__pyx_t_10) {
  } else {
    __pyx_t_8 = __pyx_t_10;
    goto __pyx_L4_bool_binop_done;
  }
  __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_ref_dotdata, -1L, long, 1, __Pyx_PyInt_From_long, 0, 1, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 238, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_GetItemInt(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 238, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_ref_dotdata, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 238, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_4 = __Pyx_GetItemInt(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 238, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = PyNumber_Subtract(__pyx_t_2, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 238, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_11 = __Pyx_PyObject_AsDouble(__pyx_t_1); if (unlikely(__pyx_t_11 == ((double)-1) && PyErr_Occurred())) __PYX_ERR(0, 238, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_6 = PyObject_Length(__pyx_v_ref_seq); if (unlikely(__pyx_t_6 == -1)) __PYX_ERR(0, 238, __pyx_L1_error)
  if (unlikely(((double)__pyx_t_6) == 0)) {
    PyErr_SetString(PyExc_ZeroDivisionError, "float division");
    __PYX_ERR(0, 238, __pyx_L1_error)
  }
  __pyx_t_10 = (((__pyx_t_11 / ((double)__pyx_t_6)) > 0.7) != 0);
  if (__pyx_t_10) {
  } else {
    __pyx_t_8 = __pyx_t_10;
    goto __pyx_L4_bool_binop_done;
  }
  __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_alt_dotdata, -1L, long, 1, __Pyx_PyInt_From_long, 0, 1, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 238, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_4 = __Pyx_GetItemInt(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 238, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_alt_dotdata, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 238, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_GetItemInt(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 238, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = PyNumber_Subtract(__pyx_t_4, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 238, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_11 = __Pyx_PyObject_AsDouble(__pyx_t_1); if (unlikely(__pyx_t_11 == ((double)-1) && PyErr_Occurred())) __PYX_ERR(0, 238, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_6 = PyObject_Length(__pyx_v_alt_seq); if (unlikely(__pyx_t_6 == -1)) __PYX_ERR(0, 238, __pyx_L1_error)
  if (unlikely(((double)__pyx_t_6) == 0)) {
    PyErr_SetString(PyExc_ZeroDivisionError, "float division");
    __PYX_ERR(0, 238, __pyx_L1_error)
  }
  __pyx_t_10 = (((__pyx_t_11 / ((double)__pyx_t_6)) > 0.7) != 0);
  __pyx_t_8 = __pyx_t_10;
  __pyx_L4_bool_binop_done:;
  if (__pyx_t_8) {

    /* "vapor_vali/Simple_function.pyx":239
 *     alt_dotdata=dotdata(window_size,x[0],alt_seq[x[1]:])
 *     if float(len(ref_dotdata))/float(len(ref_seq))>0.1 and float(len(alt_dotdata))/float(len(alt_seq))>0.1 and float(ref_dotdata[-1][0]-ref_dotdata[0][0])/float(len(ref_seq))>0.7 and float(alt_dotdata[-1][0]-alt_dotdata[0][0])/float(len(alt_seq))>0.7:
 *         ref_clean_dotdata=clean_dotdata_diagnal_and_anti_diagnal(ref_dotdata)             # <<<<<<<<<<<<<<
 *         alt_clean_dotdata=clean_dotdata_diagnal_and_anti_diagnal(alt_dotdata)
 *         if len(ref_clean_dotdata)>0 and len(alt_clean_dotdata)>0:
 */
    __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_clean_dotdata_diagnal_and_anti_d); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 239, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_4 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_2))) {
      __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_2);
      if (likely(__pyx_t_4)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
        __Pyx_INCREF(__pyx_t_4);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_2, function);
      }
    }
    if (!__pyx_t_4) {
      __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_v_ref_dotdata); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 239, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
    } else {
      __pyx_t_3 = PyTuple_New(1+1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 239, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __Pyx_GIVEREF(__pyx_t_4); PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_4); __pyx_t_4 = NULL;
      __Pyx_INCREF(__pyx_v_ref_dotdata);
      __Pyx_GIVEREF(__pyx_v_ref_dotdata);
      PyTuple_SET_ITEM(__pyx_t_3, 0+1, __pyx_v_ref_dotdata);
      __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_3, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 239, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    }
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_v_ref_clean_dotdata = __pyx_t_1;
    __pyx_t_1 = 0;

    /* "vapor_vali/Simple_function.pyx":240
 *     if float(len(ref_dotdata))/float(len(ref_seq))>0.1 and float(len(alt_dotdata))/float(len(alt_seq))>0.1 and float(ref_dotdata[-1][0]-ref_dotdata[0][0])/float(len(ref_seq))>0.7 and float(alt_dotdata[-1][0]-alt_dotdata[0][0])/float(len(alt_seq))>0.7:
 *         ref_clean_dotdata=clean_dotdata_diagnal_and_anti_diagnal(ref_dotdata)
 *         alt_clean_dotdata=clean_dotdata_diagnal_and_anti_diagnal(alt_dotdata)             # <<<<<<<<<<<<<<
 *         if len(ref_clean_dotdata)>0 and len(alt_clean_dotdata)>0:
 *             ref_new_intercept=dis_to_diagnal_most_abundant_defined(ref_clean_dotdata)
 */
    __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_clean_dotdata_diagnal_and_anti_d); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 240, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_3 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_2))) {
      __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
      if (likely(__pyx_t_3)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
        __Pyx_INCREF(__pyx_t_3);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_2, function);
      }
    }
    if (!__pyx_t_3) {
      __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_v_alt_dotdata); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 240, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
    } else {
      __pyx_t_4 = PyTuple_New(1+1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 240, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      __Pyx_GIVEREF(__pyx_t_3); PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3); __pyx_t_3 = NULL;
      __Pyx_INCREF(__pyx_v_alt_dotdata);
      __Pyx_GIVEREF(__pyx_v_alt_dotdata);
      PyTuple_SET_ITEM(__pyx_t_4, 0+1, __pyx_v_alt_dotdata);
      __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_4, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 240, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    }
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_v_alt_clean_dotdata = __pyx_t_1;
    __pyx_t_1 = 0;

    /* "vapor_vali/Simple_function.pyx":241
 *         ref_clean_dotdata=clean_dotdata_diagnal_and_anti_diagnal(ref_dotdata)
 *         alt_clean_dotdata=clean_dotdata_diagnal_and_anti_diagnal(alt_dotdata)
 *         if len(ref_clean_dotdata)>0 and len(alt_clean_dotdata)>0:             # <<<<<<<<<<<<<<
 *             ref_new_intercept=dis_to_diagnal_most_abundant_defined(ref_clean_dotdata)
 *             alt_new_intercept=dis_to_diagnal_most_abundant_defined(alt_clean_dotdata)
 */
    __pyx_t_6 = PyObject_Length(__pyx_v_ref_clean_dotdata); if (unlikely(__pyx_t_6 == -1)) __PYX_ERR(0, 241, __pyx_L1_error)
    __pyx_t_10 = ((__pyx_t_6 > 0) != 0);
    if (__pyx_t_10) {
    } else {
      __pyx_t_8 = __pyx_t_10;
      goto __pyx_L9_bool_binop_done;
    }
    __pyx_t_6 = PyObject_Length(__pyx_v_alt_clean_dotdata); if (unlikely(__pyx_t_6 == -1)) __PYX_ERR(0, 241, __pyx_L1_error)
    __pyx_t_10 = ((__pyx_t_6 > 0) != 0);
    __pyx_t_8 = __pyx_t_10;
    __pyx_L9_bool_binop_done:;
    if (__pyx_t_8) {

      /* "vapor_vali/Simple_function.pyx":242
 *         alt_clean_dotdata=clean_dotdata_diagnal_and_anti_diagnal(alt_dotdata)
 *         if len(ref_clean_dotdata)>0 and len(alt_clean_dotdata)>0:
 *             ref_new_intercept=dis_to_diagnal_most_abundant_defined(ref_clean_dotdata)             # <<<<<<<<<<<<<<
 *             alt_new_intercept=dis_to_diagnal_most_abundant_defined(alt_clean_dotdata)
 *             return [abs(eu_dis_dir_calcu([[i[0]+ref_new_intercept,i[1]] for i in ref_clean_dotdata])),
 */
      __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_dis_to_diagnal_most_abundant_def); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 242, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __pyx_t_4 = NULL;
      if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_2))) {
        __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_2);
        if (likely(__pyx_t_4)) {
          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
          __Pyx_INCREF(__pyx_t_4);
          __Pyx_INCREF(function);
          __Pyx_DECREF_SET(__pyx_t_2, function);
        }
      }
      if (!__pyx_t_4) {
        __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_v_ref_clean_dotdata); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 242, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
      } else {
        __pyx_t_3 = PyTuple_New(1+1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 242, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_3);
        __Pyx_GIVEREF(__pyx_t_4); PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_4); __pyx_t_4 = NULL;
        __Pyx_INCREF(__pyx_v_ref_clean_dotdata);
        __Pyx_GIVEREF(__pyx_v_ref_clean_dotdata);
        PyTuple_SET_ITEM(__pyx_t_3, 0+1, __pyx_v_ref_clean_dotdata);
        __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_3, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 242, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      }
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_v_ref_new_intercept = __pyx_t_1;
      __pyx_t_1 = 0;

      /* "vapor_vali/Simple_function.pyx":243
 *         if len(ref_clean_dotdata)>0 and len(alt_clean_dotdata)>0:
 *             ref_new_intercept=dis_to_diagnal_most_abundant_defined(ref_clean_dotdata)
 *             alt_new_intercept=dis_to_diagnal_most_abundant_defined(alt_clean_dotdata)             # <<<<<<<<<<<<<<
 *             return [abs(eu_dis_dir_calcu([[i[0]+ref_new_intercept,i[1]] for i in ref_clean_dotdata])),
 *                     abs(eu_dis_dir_calcu([[i[0]+alt_new_intercept,i[1]] for i in alt_clean_dotdata]))]
 */
      __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_dis_to_diagnal_most_abundant_def); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 243, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __pyx_t_3 = NULL;
      if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_2))) {
        __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
        if (likely(__pyx_t_3)) {
          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
          __Pyx_INCREF(__pyx_t_3);
          __Pyx_INCREF(function);
          __Pyx_DECREF_SET(__pyx_t_2, function);
        }
      }
      if (!__pyx_t_3) {
        __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_v_alt_clean_dotdata); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 243, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
      } else {
        __pyx_t_4 = PyTuple_New(1+1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 243, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_4);
        __Pyx_GIVEREF(__pyx_t_3); PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3); __pyx_t_3 = NULL;
        __Pyx_INCREF(__pyx_v_alt_clean_dotdata);
        __Pyx_GIVEREF(__pyx_v_alt_clean_dotdata);
        PyTuple_SET_ITEM(__pyx_t_4, 0+1, __pyx_v_alt_clean_dotdata);
        __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_4, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 243, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      }
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_v_alt_new_intercept = __pyx_t_1;
      __pyx_t_1 = 0;

      /* "vapor_vali/Simple_function.pyx":244
 *             ref_new_intercept=dis_to_diagnal_most_abundant_defined(ref_clean_dotdata)
 *             alt_new_intercept=dis_to_diagnal_most_abundant_defined(alt_clean_dotdata)
 *             return [abs(eu_dis_dir_calcu([[i[0]+ref_new_intercept,i[1]] for i in ref_clean_dotdata])),             # <<<<<<<<<<<<<<
 *                     abs(eu_dis_dir_calcu([[i[0]+alt_new_intercept,i[1]] for i in alt_clean_dotdata]))]
 *             #return [abs(eu_dis_region_calcu(ref_clean_dotdata,ref_bps)),abs(eu_dis_region_calcu(alt_clean_dotdata,alt_bps))]
 */
      __Pyx_XDECREF(__pyx_r);
      __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_eu_dis_dir_calcu); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 244, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __pyx_t_4 = PyList_New(0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 244, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      if (likely(PyList_CheckExact(__pyx_v_ref_clean_dotdata)) || PyTuple_CheckExact(__pyx_v_ref_clean_dotdata)) {
        __pyx_t_3 = __pyx_v_ref_clean_dotdata; __Pyx_INCREF(__pyx_t_3); __pyx_t_6 = 0;
        __pyx_t_12 = NULL;
      } else {
        __pyx_t_6 = -1; __pyx_t_3 = PyObject_GetIter(__pyx_v_ref_clean_dotdata); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 244, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_3);
        __pyx_t_12 = Py_TYPE(__pyx_t_3)->tp_iternext; if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 244, __pyx_L1_error)
      }
      for (;;) {
        if (likely(!__pyx_t_12)) {
          if (likely(PyList_CheckExact(__pyx_t_3))) {
            if (__pyx_t_6 >= PyList_GET_SIZE(__pyx_t_3)) break;
            #if CYTHON_COMPILING_IN_CPYTHON
            __pyx_t_7 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_6); __Pyx_INCREF(__pyx_t_7); __pyx_t_6++; if (unlikely(0 < 0)) __PYX_ERR(0, 244, __pyx_L1_error)
            #else
            __pyx_t_7 = PySequence_ITEM(__pyx_t_3, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 244, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_7);
            #endif
          } else {
            if (__pyx_t_6 >= PyTuple_GET_SIZE(__pyx_t_3)) break;
            #if CYTHON_COMPILING_IN_CPYTHON
            __pyx_t_7 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_6); __Pyx_INCREF(__pyx_t_7); __pyx_t_6++; if (unlikely(0 < 0)) __PYX_ERR(0, 244, __pyx_L1_error)
            #else
            __pyx_t_7 = PySequence_ITEM(__pyx_t_3, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 244, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_7);
            #endif
          }
        } else {
          __pyx_t_7 = __pyx_t_12(__pyx_t_3);
          if (unlikely(!__pyx_t_7)) {
            PyObject* exc_type = PyErr_Occurred();
            if (exc_type) {
              if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
              else __PYX_ERR(0, 244, __pyx_L1_error)
            }
            break;
          }
          __Pyx_GOTREF(__pyx_t_7);
        }
        __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_7);
        __pyx_t_7 = 0;
        __pyx_t_7 = __Pyx_GetItemInt(__pyx_v_i, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 244, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_7);
        __pyx_t_5 = PyNumber_Add(__pyx_t_7, __pyx_v_ref_new_intercept); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 244, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_5);
        __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
        __pyx_t_7 = __Pyx_GetItemInt(__pyx_v_i, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 244, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_7);
        __pyx_t_13 = PyList_New(2); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 244, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_13);
        __Pyx_GIVEREF(__pyx_t_5);
        PyList_SET_ITEM(__pyx_t_13, 0, __pyx_t_5);
        __Pyx_GIVEREF(__pyx_t_7);
        PyList_SET_ITEM(__pyx_t_13, 1, __pyx_t_7);
        __pyx_t_5 = 0;
        __pyx_t_7 = 0;
        if (unlikely(__Pyx_ListComp_Append(__pyx_t_4, (PyObject*)__pyx_t_13))) __PYX_ERR(0, 244, __pyx_L1_error)
        __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
      }
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_3 = NULL;
      if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_2))) {
        __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
        if (likely(__pyx_t_3)) {
          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
          __Pyx_INCREF(__pyx_t_3);
          __Pyx_INCREF(function);
          __Pyx_DECREF_SET(__pyx_t_2, function);
        }
      }
      if (!__pyx_t_3) {
        __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 244, __pyx_L1_error)
        __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
        __Pyx_GOTREF(__pyx_t_1);
      } else {
        __pyx_t_13 = PyTuple_New(1+1); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 244, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_13);
        __Pyx_GIVEREF(__pyx_t_3); PyTuple_SET_ITEM(__pyx_t_13, 0, __pyx_t_3); __pyx_t_3 = NULL;
        __Pyx_GIVEREF(__pyx_t_4);
        PyTuple_SET_ITEM(__pyx_t_13, 0+1, __pyx_t_4);
        __pyx_t_4 = 0;
        __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_13, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 244, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
      }
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_2 = PyNumber_Absolute(__pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 244, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

      /* "vapor_vali/Simple_function.pyx":245
 *             alt_new_intercept=dis_to_diagnal_most_abundant_defined(alt_clean_dotdata)
 *             return [abs(eu_dis_dir_calcu([[i[0]+ref_new_intercept,i[1]] for i in ref_clean_dotdata])),
 *                     abs(eu_dis_dir_calcu([[i[0]+alt_new_intercept,i[1]] for i in alt_clean_dotdata]))]             # <<<<<<<<<<<<<<
 *             #return [abs(eu_dis_region_calcu(ref_clean_dotdata,ref_bps)),abs(eu_dis_region_calcu(alt_clean_dotdata,alt_bps))]
 *             #return [eu_dis_abs_calcu(take_off_symmetric_dots(ref_clean_dotdata)),eu_dis_abs_calcu(take_off_symmetric_dots(alt_clean_dotdata))]
 */
      __pyx_t_13 = __Pyx_GetModuleGlobalName(__pyx_n_s_eu_dis_dir_calcu); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 245, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_13);
      __pyx_t_4 = PyList_New(0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 245, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      if (likely(PyList_CheckExact(__pyx_v_alt_clean_dotdata)) || PyTuple_CheckExact(__pyx_v_alt_clean_dotdata)) {
        __pyx_t_3 = __pyx_v_alt_clean_dotdata; __Pyx_INCREF(__pyx_t_3); __pyx_t_6 = 0;
        __pyx_t_12 = NULL;
      } else {
        __pyx_t_6 = -1; __pyx_t_3 = PyObject_GetIter(__pyx_v_alt_clean_dotdata); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 245, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_3);
        __pyx_t_12 = Py_TYPE(__pyx_t_3)->tp_iternext; if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 245, __pyx_L1_error)
      }
      for (;;) {
        if (likely(!__pyx_t_12)) {
          if (likely(PyList_CheckExact(__pyx_t_3))) {
            if (__pyx_t_6 >= PyList_GET_SIZE(__pyx_t_3)) break;
            #if CYTHON_COMPILING_IN_CPYTHON
            __pyx_t_7 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_6); __Pyx_INCREF(__pyx_t_7); __pyx_t_6++; if (unlikely(0 < 0)) __PYX_ERR(0, 245, __pyx_L1_error)
            #else
            __pyx_t_7 = PySequence_ITEM(__pyx_t_3, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 245, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_7);
            #endif
          } else {
            if (__pyx_t_6 >= PyTuple_GET_SIZE(__pyx_t_3)) break;
            #if CYTHON_COMPILING_IN_CPYTHON
            __pyx_t_7 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_6); __Pyx_INCREF(__pyx_t_7); __pyx_t_6++; if (unlikely(0 < 0)) __PYX_ERR(0, 245, __pyx_L1_error)
            #else
            __pyx_t_7 = PySequence_ITEM(__pyx_t_3, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 245, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_7);
            #endif
          }
        } else {
          __pyx_t_7 = __pyx_t_12(__pyx_t_3);
          if (unlikely(!__pyx_t_7)) {
            PyObject* exc_type = PyErr_Occurred();
            if (exc_type) {
              if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
              else __PYX_ERR(0, 245, __pyx_L1_error)
            }
            break;
          }
          __Pyx_GOTREF(__pyx_t_7);
        }
        __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_7);
        __pyx_t_7 = 0;
        __pyx_t_7 = __Pyx_GetItemInt(__pyx_v_i, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 245, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_7);
        __pyx_t_5 = PyNumber_Add(__pyx_t_7, __pyx_v_alt_new_intercept); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 245, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_5);
        __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
        __pyx_t_7 = __Pyx_GetItemInt(__pyx_v_i, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 245, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_7);
        __pyx_t_14 = PyList_New(2); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 245, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_14);
        __Pyx_GIVEREF(__pyx_t_5);
        PyList_SET_ITEM(__pyx_t_14, 0, __pyx_t_5);
        __Pyx_GIVEREF(__pyx_t_7);
        PyList_SET_ITEM(__pyx_t_14, 1, __pyx_t_7);
        __pyx_t_5 = 0;
        __pyx_t_7 = 0;
        if (unlikely(__Pyx_ListComp_Append(__pyx_t_4, (PyObject*)__pyx_t_14))) __PYX_ERR(0, 245, __pyx_L1_error)
        __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
      }
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_3 = NULL;
      if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_13))) {
        __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_13);
        if (likely(__pyx_t_3)) {
          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_13);
          __Pyx_INCREF(__pyx_t_3);
          __Pyx_INCREF(function);
          __Pyx_DECREF_SET(__pyx_t_13, function);
        }
      }
      if (!__pyx_t_3) {
        __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_13, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 245, __pyx_L1_error)
        __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
        __Pyx_GOTREF(__pyx_t_1);
      } else {
        __pyx_t_14 = PyTuple_New(1+1); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 245, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_14);
        __Pyx_GIVEREF(__pyx_t_3); PyTuple_SET_ITEM(__pyx_t_14, 0, __pyx_t_3); __pyx_t_3 = NULL;
        __Pyx_GIVEREF(__pyx_t_4);
        PyTuple_SET_ITEM(__pyx_t_14, 0+1, __pyx_t_4);
        __pyx_t_4 = 0;
        __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_13, __pyx_t_14, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 245, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
      }
      __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
      __pyx_t_13 = PyNumber_Absolute(__pyx_t_1); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 245, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_13);
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

      /* "vapor_vali/Simple_function.pyx":244
 *             ref_new_intercept=dis_to_diagnal_most_abundant_defined(ref_clean_dotdata)
 *             alt_new_intercept=dis_to_diagnal_most_abundant_defined(alt_clean_dotdata)
 *             return [abs(eu_dis_dir_calcu([[i[0]+ref_new_intercept,i[1]] for i in ref_clean_dotdata])),             # <<<<<<<<<<<<<<
 *                     abs(eu_dis_dir_calcu([[i[0]+alt_new_intercept,i[1]] for i in alt_clean_dotdata]))]
 *             #return [abs(eu_dis_region_calcu(ref_clean_dotdata,ref_bps)),abs(eu_dis_region_calcu(alt_clean_dotdata,alt_bps))]
 */
      __pyx_t_1 = PyList_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 244, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_GIVEREF(__pyx_t_2);
      PyList_SET_ITEM(__pyx_t_1, 0, __pyx_t_2);
      __Pyx_GIVEREF(__pyx_t_13);
      PyList_SET_ITEM(__pyx_t_1, 1, __pyx_t_13);
      __pyx_t_2 = 0;
      __pyx_t_13 = 0;
      __pyx_r = __pyx_t_1;
      __pyx_t_1 = 0;
      goto __pyx_L0;

      /* "vapor_vali/Simple_function.pyx":241
 *         ref_clean_dotdata=clean_dotdata_diagnal_and_anti_diagnal(ref_dotdata)
 *         alt_clean_dotdata=clean_dotdata_diagnal_and_anti_diagnal(alt_dotdata)
 *         if len(ref_clean_dotdata)>0 and len(alt_clean_dotdata)>0:             # <<<<<<<<<<<<<<
 *             ref_new_intercept=dis_to_diagnal_most_abundant_defined(ref_clean_dotdata)
 *             alt_new_intercept=dis_to_diagnal_most_abundant_defined(alt_clean_dotdata)
 */
    }

    /* "vapor_vali/Simple_function.pyx":249
 *             #return [eu_dis_abs_calcu(take_off_symmetric_dots(ref_clean_dotdata)),eu_dis_abs_calcu(take_off_symmetric_dots(alt_clean_dotdata))]
 *         else:
 *             return [0,0]             # <<<<<<<<<<<<<<
 *     else:
 *         return [0,0]
 */
    /*else*/ {
      __Pyx_XDECREF(__pyx_r);
      __pyx_t_1 = PyList_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 249, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_INCREF(__pyx_int_0);
      __Pyx_GIVEREF(__pyx_int_0);
      PyList_SET_ITEM(__pyx_t_1, 0, __pyx_int_0);
      __Pyx_INCREF(__pyx_int_0);
      __Pyx_GIVEREF(__pyx_int_0);
      PyList_SET_ITEM(__pyx_t_1, 1, __pyx_int_0);
      __pyx_r = __pyx_t_1;
      __pyx_t_1 = 0;
      goto __pyx_L0;
    }

    /* "vapor_vali/Simple_function.pyx":238
 *     ref_dotdata=dotdata(window_size,x[0],ref_seq[x[1]:])
 *     alt_dotdata=dotdata(window_size,x[0],alt_seq[x[1]:])
 *     if float(len(ref_dotdata))/float(len(ref_seq))>0.1 and float(len(alt_dotdata))/float(len(alt_seq))>0.1 and float(ref_dotdata[-1][0]-ref_dotdata[0][0])/float(len(ref_seq))>0.7 and float(alt_dotdata[-1][0]-alt_dotdata[0][0])/float(len(alt_seq))>0.7:             # <<<<<<<<<<<<<<
 *         ref_clean_dotdata=clean_dotdata_diagnal_and_anti_diagnal(ref_dotdata)
 *         alt_clean_dotdata=clean_dotdata_diagnal_and_anti_diagnal(alt_dotdata)
 */
  }

  /* "vapor_vali/Simple_function.pyx":251
 *             return [0,0]
 *     else:
 *         return [0,0]             # <<<<<<<<<<<<<<
 * 
 * def calcu_vapor_single_read_score_directed_dis_m1b_maybe(ref_seq,alt_seq,x,window_size,dup_block_bps):
 */
  /*else*/ {
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = PyList_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 251, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_INCREF(__pyx_int_0);
    __Pyx_GIVEREF(__pyx_int_0);
    PyList_SET_ITEM(__pyx_t_1, 0, __pyx_int_0);
    __Pyx_INCREF(__pyx_int_0);
    __Pyx_GIVEREF(__pyx_int_0);
    PyList_SET_ITEM(__pyx_t_1, 1, __pyx_int_0);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;
  }

  /* "vapor_vali/Simple_function.pyx":235
 *         return [0,0]
 * 
 * def calcu_vapor_single_read_score_directed_dis_m1b_redefine_diagnal(ref_seq,alt_seq,x,window_size):             # <<<<<<<<<<<<<<
 *     ref_dotdata=dotdata(window_size,x[0],ref_seq[x[1]:])
 *     alt_dotdata=dotdata(window_size,x[0],alt_seq[x[1]:])
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_7);
  __Pyx_XDECREF(__pyx_t_13);
  __Pyx_XDECREF(__pyx_t_14);
  __Pyx_AddTraceback("vapor_vali.Simple_function.calcu_vapor_single_read_score_directed_dis_m1b_redefine_diagnal", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_ref_dotdata);
  __Pyx_XDECREF(__pyx_v_alt_dotdata);
  __Pyx_XDECREF(__pyx_v_ref_clean_dotdata);
  __Pyx_XDECREF(__pyx_v_alt_clean_dotdata);
  __Pyx_XDECREF(__pyx_v_ref_new_intercept);
  __Pyx_XDECREF(__pyx_v_alt_new_intercept);
  __Pyx_XDECREF(__pyx_v_i);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "vapor_vali/Simple_function.pyx":253
 *         return [0,0]
 * 
 * def calcu_vapor_single_read_score_directed_dis_m1b_maybe(ref_seq,alt_seq,x,window_size,dup_block_bps):             # <<<<<<<<<<<<<<
 *     #ref_ref_dotdata=dotdata(window_size,ref_seq[x[1]:],ref_seq[x[1]:])
 *     #alt_alt_dotdata=dotdata(window_size,alt_seq[x[1]:],alt_seq[x[1]:])
 */

/* Python wrapper */
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_27calcu_vapor_single_read_score_directed_dis_m1b_maybe(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_10vapor_vali_15Simple_function_27calcu_vapor_single_read_score_directed_dis_m1b_maybe = {"calcu_vapor_single_read_score_directed_dis_m1b_maybe", (PyCFunction)__pyx_pw_10vapor_vali_15Simple_function_27calcu_vapor_single_read_score_directed_dis_m1b_maybe, METH_VARARGS|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_27calcu_vapor_single_read_score_directed_dis_m1b_maybe(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_ref_seq = 0;
  PyObject *__pyx_v_alt_seq = 0;
  PyObject *__pyx_v_x = 0;
  PyObject *__pyx_v_window_size = 0;
  PyObject *__pyx_v_dup_block_bps = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("calcu_vapor_single_read_score_directed_dis_m1b_maybe (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_ref_seq,&__pyx_n_s_alt_seq,&__pyx_n_s_x,&__pyx_n_s_window_size,&__pyx_n_s_dup_block_bps,0};
    PyObject* values[5] = {0,0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
      switch (pos_args) {
        case  5: values[4] = PyTuple_GET_ITEM(__pyx_args, 4);
        case  4: values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
        case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_ref_seq)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_alt_seq)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("calcu_vapor_single_read_score_directed_dis_m1b_maybe", 1, 5, 5, 1); __PYX_ERR(0, 253, __pyx_L3_error)
        }
        case  2:
        if (likely((values[2] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_x)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("calcu_vapor_single_read_score_directed_dis_m1b_maybe", 1, 5, 5, 2); __PYX_ERR(0, 253, __pyx_L3_error)
        }
        case  3:
        if (likely((values[3] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_window_size)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("calcu_vapor_single_read_score_directed_dis_m1b_maybe", 1, 5, 5, 3); __PYX_ERR(0, 253, __pyx_L3_error)
        }
        case  4:
        if (likely((values[4] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_dup_block_bps)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("calcu_vapor_single_read_score_directed_dis_m1b_maybe", 1, 5, 5, 4); __PYX_ERR(0, 253, __pyx_L3_error)
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "calcu_vapor_single_read_score_directed_dis_m1b_maybe") < 0)) __PYX_ERR(0, 253, __pyx_L3_error)
      }
    } else if (PyTuple_GET_SIZE(__pyx_args) != 5) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
      values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
      values[4] = PyTuple_GET_ITEM(__pyx_args, 4);
    }
    __pyx_v_ref_seq = values[0];
    __pyx_v_alt_seq = values[1];
    __pyx_v_x = values[2];
    __pyx_v_window_size = values[3];
    __pyx_v_dup_block_bps = values[4];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("calcu_vapor_single_read_score_directed_dis_m1b_maybe", 1, 5, 5, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 253, __pyx_L3_error)
  __pyx_L3_error:;
  __Pyx_AddTraceback("vapor_vali.Simple_function.calcu_vapor_single_read_score_directed_dis_m1b_maybe", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_10vapor_vali_15Simple_function_26calcu_vapor_single_read_score_directed_dis_m1b_maybe(__pyx_self, __pyx_v_ref_seq, __pyx_v_alt_seq, __pyx_v_x, __pyx_v_window_size, __pyx_v_dup_block_bps);

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10vapor_vali_15Simple_function_26calcu_vapor_single_read_score_directed_dis_m1b_maybe(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_ref_seq, PyObject *__pyx_v_alt_seq, PyObject *__pyx_v_x, PyObject *__pyx_v_window_size, PyObject *__pyx_v_dup_block_bps) {
  PyObject *__pyx_v_ref_dotdata = NULL;
  PyObject *__pyx_v_alt_dotdata = NULL;
  PyObject *__pyx_v_ref_clean_dotdata = NULL;
  PyObject *__pyx_v_alt_clean_dotdata = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  Py_ssize_t __pyx_t_6;
  PyObject *__pyx_t_7 = NULL;
  int __pyx_t_8;
  Py_ssize_t __pyx_t_9;
  int __pyx_t_10;
  double __pyx_t_11;
  __Pyx_RefNannySetupContext("calcu_vapor_single_read_score_directed_dis_m1b_maybe", 0);

  /* "vapor_vali/Simple_function.pyx":256
 *     #ref_ref_dotdata=dotdata(window_size,ref_seq[x[1]:],ref_seq[x[1]:])
 *     #alt_alt_dotdata=dotdata(window_size,alt_seq[x[1]:],alt_seq[x[1]:])
 *     ref_dotdata=dotdata(window_size,x[0],ref_seq[x[1]:])             # <<<<<<<<<<<<<<
 *     alt_dotdata=dotdata(window_size,x[0],alt_seq[x[1]:])
 *     #ref_ref_lines=ref_ref_deviate_lines_describe(ref_ref_dotdata)
 */
  __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_dotdata); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 256, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_x, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 256, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_4 = __Pyx_GetItemInt(__pyx_v_x, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 256, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_5 = __Pyx_PyObject_GetSlice(__pyx_v_ref_seq, 0, 0, &__pyx_t_4, NULL, NULL, 0, 0, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 256, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = NULL;
  __pyx_t_6 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_2);
    if (likely(__pyx_t_4)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_4);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_2, function);
      __pyx_t_6 = 1;
    }
  }
  __pyx_t_7 = PyTuple_New(3+__pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 256, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  if (__pyx_t_4) {
    __Pyx_GIVEREF(__pyx_t_4); PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_4); __pyx_t_4 = NULL;
  }
  __Pyx_INCREF(__pyx_v_window_size);
  __Pyx_GIVEREF(__pyx_v_window_size);
  PyTuple_SET_ITEM(__pyx_t_7, 0+__pyx_t_6, __pyx_v_window_size);
  __Pyx_GIVEREF(__pyx_t_3);
  PyTuple_SET_ITEM(__pyx_t_7, 1+__pyx_t_6, __pyx_t_3);
  __Pyx_GIVEREF(__pyx_t_5);
  PyTuple_SET_ITEM(__pyx_t_7, 2+__pyx_t_6, __pyx_t_5);
  __pyx_t_3 = 0;
  __pyx_t_5 = 0;
  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_7, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 256, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_ref_dotdata = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":257
 *     #alt_alt_dotdata=dotdata(window_size,alt_seq[x[1]:],alt_seq[x[1]:])
 *     ref_dotdata=dotdata(window_size,x[0],ref_seq[x[1]:])
 *     alt_dotdata=dotdata(window_size,x[0],alt_seq[x[1]:])             # <<<<<<<<<<<<<<
 *     #ref_ref_lines=ref_ref_deviate_lines_describe(ref_ref_dotdata)
 *     #alt_alt_lines=ref_ref_deviate_lines_describe(alt_alt_dotdata)
 */
  __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_dotdata); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 257, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_7 = __Pyx_GetItemInt(__pyx_v_x, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 257, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  __pyx_t_5 = __Pyx_GetItemInt(__pyx_v_x, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 257, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_3 = __Pyx_PyObject_GetSlice(__pyx_v_alt_seq, 0, 0, &__pyx_t_5, NULL, NULL, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 257, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = NULL;
  __pyx_t_6 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_2);
    if (likely(__pyx_t_5)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_5);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_2, function);
      __pyx_t_6 = 1;
    }
  }
  __pyx_t_4 = PyTuple_New(3+__pyx_t_6); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 257, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  if (__pyx_t_5) {
    __Pyx_GIVEREF(__pyx_t_5); PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_5); __pyx_t_5 = NULL;
  }
  __Pyx_INCREF(__pyx_v_window_size);
  __Pyx_GIVEREF(__pyx_v_window_size);
  PyTuple_SET_ITEM(__pyx_t_4, 0+__pyx_t_6, __pyx_v_window_size);
  __Pyx_GIVEREF(__pyx_t_7);
  PyTuple_SET_ITEM(__pyx_t_4, 1+__pyx_t_6, __pyx_t_7);
  __Pyx_GIVEREF(__pyx_t_3);
  PyTuple_SET_ITEM(__pyx_t_4, 2+__pyx_t_6, __pyx_t_3);
  __pyx_t_7 = 0;
  __pyx_t_3 = 0;
  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_4, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 257, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_alt_dotdata = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":260
 *     #ref_ref_lines=ref_ref_deviate_lines_describe(ref_ref_dotdata)
 *     #alt_alt_lines=ref_ref_deviate_lines_describe(alt_alt_dotdata)
 *     if float(len(ref_dotdata))/float(len(ref_seq))>0.1 and float(len(alt_dotdata))/float(len(alt_seq))>0.1 and float(ref_dotdata[-1][0]-ref_dotdata[0][0])/float(len(ref_seq))>0.7 and float(alt_dotdata[-1][0]-alt_dotdata[0][0])/float(len(alt_seq))>0.7:             # <<<<<<<<<<<<<<
 *         ref_clean_dotdata=(ref_dotdata)
 *         alt_clean_dotdata=clean_dotdata_diagnal_and_anti_diagnal(alt_dotdata)
 */
  __pyx_t_6 = PyObject_Length(__pyx_v_ref_dotdata); if (unlikely(__pyx_t_6 == -1)) __PYX_ERR(0, 260, __pyx_L1_error)
  __pyx_t_9 = PyObject_Length(__pyx_v_ref_seq); if (unlikely(__pyx_t_9 == -1)) __PYX_ERR(0, 260, __pyx_L1_error)
  if (unlikely(((double)__pyx_t_9) == 0)) {
    PyErr_SetString(PyExc_ZeroDivisionError, "float division");
    __PYX_ERR(0, 260, __pyx_L1_error)
  }
  __pyx_t_10 = (((((double)__pyx_t_6) / ((double)__pyx_t_9)) > 0.1) != 0);
  if (__pyx_t_10) {
  } else {
    __pyx_t_8 = __pyx_t_10;
    goto __pyx_L4_bool_binop_done;
  }
  __pyx_t_9 = PyObject_Length(__pyx_v_alt_dotdata); if (unlikely(__pyx_t_9 == -1)) __PYX_ERR(0, 260, __pyx_L1_error)
  __pyx_t_6 = PyObject_Length(__pyx_v_alt_seq); if (unlikely(__pyx_t_6 == -1)) __PYX_ERR(0, 260, __pyx_L1_error)
  if (unlikely(((double)__pyx_t_6) == 0)) {
    PyErr_SetString(PyExc_ZeroDivisionError, "float division");
    __PYX_ERR(0, 260, __pyx_L1_error)
  }
  __pyx_t_10 = (((((double)__pyx_t_9) / ((double)__pyx_t_6)) > 0.1) != 0);
  if (__pyx_t_10) {
  } else {
    __pyx_t_8 = __pyx_t_10;
    goto __pyx_L4_bool_binop_done;
  }
  __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_ref_dotdata, -1L, long, 1, __Pyx_PyInt_From_long, 0, 1, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 260, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_GetItemInt(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 260, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_ref_dotdata, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 260, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_4 = __Pyx_GetItemInt(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 260, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = PyNumber_Subtract(__pyx_t_2, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 260, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_11 = __Pyx_PyObject_AsDouble(__pyx_t_1); if (unlikely(__pyx_t_11 == ((double)-1) && PyErr_Occurred())) __PYX_ERR(0, 260, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_6 = PyObject_Length(__pyx_v_ref_seq); if (unlikely(__pyx_t_6 == -1)) __PYX_ERR(0, 260, __pyx_L1_error)
  if (unlikely(((double)__pyx_t_6) == 0)) {
    PyErr_SetString(PyExc_ZeroDivisionError, "float division");
    __PYX_ERR(0, 260, __pyx_L1_error)
  }
  __pyx_t_10 = (((__pyx_t_11 / ((double)__pyx_t_6)) > 0.7) != 0);
  if (__pyx_t_10) {
  } else {
    __pyx_t_8 = __pyx_t_10;
    goto __pyx_L4_bool_binop_done;
  }
  __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_alt_dotdata, -1L, long, 1, __Pyx_PyInt_From_long, 0, 1, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 260, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_4 = __Pyx_GetItemInt(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 260, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_alt_dotdata, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 260, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_GetItemInt(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 260, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = PyNumber_Subtract(__pyx_t_4, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 260, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_11 = __Pyx_PyObject_AsDouble(__pyx_t_1); if (unlikely(__pyx_t_11 == ((double)-1) && PyErr_Occurred())) __PYX_ERR(0, 260, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_6 = PyObject_Length(__pyx_v_alt_seq); if (unlikely(__pyx_t_6 == -1)) __PYX_ERR(0, 260, __pyx_L1_error)
  if (unlikely(((double)__pyx_t_6) == 0)) {
    PyErr_SetString(PyExc_ZeroDivisionError, "float division");
    __PYX_ERR(0, 260, __pyx_L1_error)
  }
  __pyx_t_10 = (((__pyx_t_11 / ((double)__pyx_t_6)) > 0.7) != 0);
  __pyx_t_8 = __pyx_t_10;
  __pyx_L4_bool_binop_done:;
  if (__pyx_t_8) {

    /* "vapor_vali/Simple_function.pyx":261
 *     #alt_alt_lines=ref_ref_deviate_lines_describe(alt_alt_dotdata)
 *     if float(len(ref_dotdata))/float(len(ref_seq))>0.1 and float(len(alt_dotdata))/float(len(alt_seq))>0.1 and float(ref_dotdata[-1][0]-ref_dotdata[0][0])/float(len(ref_seq))>0.7 and float(alt_dotdata[-1][0]-alt_dotdata[0][0])/float(len(alt_seq))>0.7:
 *         ref_clean_dotdata=(ref_dotdata)             # <<<<<<<<<<<<<<
 *         alt_clean_dotdata=clean_dotdata_diagnal_and_anti_diagnal(alt_dotdata)
 *         if len(ref_clean_dotdata)>0 and len(alt_clean_dotdata)>0:
 */
    __Pyx_INCREF(__pyx_v_ref_dotdata);
    __pyx_v_ref_clean_dotdata = __pyx_v_ref_dotdata;

    /* "vapor_vali/Simple_function.pyx":262
 *     if float(len(ref_dotdata))/float(len(ref_seq))>0.1 and float(len(alt_dotdata))/float(len(alt_seq))>0.1 and float(ref_dotdata[-1][0]-ref_dotdata[0][0])/float(len(ref_seq))>0.7 and float(alt_dotdata[-1][0]-alt_dotdata[0][0])/float(len(alt_seq))>0.7:
 *         ref_clean_dotdata=(ref_dotdata)
 *         alt_clean_dotdata=clean_dotdata_diagnal_and_anti_diagnal(alt_dotdata)             # <<<<<<<<<<<<<<
 *         if len(ref_clean_dotdata)>0 and len(alt_clean_dotdata)>0:
 *             return [abs(eu_dis_abs_calcu(ref_clean_dotdata)),abs(eu_dis_reg_dup_block_calcu(alt_clean_dotdata,dup_block_bps))]
 */
    __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_clean_dotdata_diagnal_and_anti_d); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 262, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_4 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_2))) {
      __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_2);
      if (likely(__pyx_t_4)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
        __Pyx_INCREF(__pyx_t_4);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_2, function);
      }
    }
    if (!__pyx_t_4) {
      __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_v_alt_dotdata); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 262, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
    } else {
      __pyx_t_3 = PyTuple_New(1+1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 262, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __Pyx_GIVEREF(__pyx_t_4); PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_4); __pyx_t_4 = NULL;
      __Pyx_INCREF(__pyx_v_alt_dotdata);
      __Pyx_GIVEREF(__pyx_v_alt_dotdata);
      PyTuple_SET_ITEM(__pyx_t_3, 0+1, __pyx_v_alt_dotdata);
      __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_3, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 262, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    }
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_v_alt_clean_dotdata = __pyx_t_1;
    __pyx_t_1 = 0;

    /* "vapor_vali/Simple_function.pyx":263
 *         ref_clean_dotdata=(ref_dotdata)
 *         alt_clean_dotdata=clean_dotdata_diagnal_and_anti_diagnal(alt_dotdata)
 *         if len(ref_clean_dotdata)>0 and len(alt_clean_dotdata)>0:             # <<<<<<<<<<<<<<
 *             return [abs(eu_dis_abs_calcu(ref_clean_dotdata)),abs(eu_dis_reg_dup_block_calcu(alt_clean_dotdata,dup_block_bps))]
 *             #return [eu_dis_abs_calcu(take_off_symmetric_dots(ref_clean_dotdata)),eu_dis_abs_calcu(take_off_symmetric_dots(alt_clean_dotdata))]
 */
    __pyx_t_6 = PyObject_Length(__pyx_v_ref_clean_dotdata); if (unlikely(__pyx_t_6 == -1)) __PYX_ERR(0, 263, __pyx_L1_error)
    __pyx_t_10 = ((__pyx_t_6 > 0) != 0);
    if (__pyx_t_10) {
    } else {
      __pyx_t_8 = __pyx_t_10;
      goto __pyx_L9_bool_binop_done;
    }
    __pyx_t_6 = PyObject_Length(__pyx_v_alt_clean_dotdata); if (unlikely(__pyx_t_6 == -1)) __PYX_ERR(0, 263, __pyx_L1_error)
    __pyx_t_10 = ((__pyx_t_6 > 0) != 0);
    __pyx_t_8 = __pyx_t_10;
    __pyx_L9_bool_binop_done:;
    if (__pyx_t_8) {

      /* "vapor_vali/Simple_function.pyx":264
 *         alt_clean_dotdata=clean_dotdata_diagnal_and_anti_diagnal(alt_dotdata)
 *         if len(ref_clean_dotdata)>0 and len(alt_clean_dotdata)>0:
 *             return [abs(eu_dis_abs_calcu(ref_clean_dotdata)),abs(eu_dis_reg_dup_block_calcu(alt_clean_dotdata,dup_block_bps))]             # <<<<<<<<<<<<<<
 *             #return [eu_dis_abs_calcu(take_off_symmetric_dots(ref_clean_dotdata)),eu_dis_abs_calcu(take_off_symmetric_dots(alt_clean_dotdata))]
 *         else:
 */
      __Pyx_XDECREF(__pyx_r);
      __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_eu_dis_abs_calcu); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 264, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __pyx_t_3 = NULL;
      if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_2))) {
        __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
        if (likely(__pyx_t_3)) {
          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
          __Pyx_INCREF(__pyx_t_3);
          __Pyx_INCREF(function);
          __Pyx_DECREF_SET(__pyx_t_2, function);
        }
      }
      if (!__pyx_t_3) {
        __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_v_ref_clean_dotdata); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 264, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
      } else {
        __pyx_t_4 = PyTuple_New(1+1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 264, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_4);
        __Pyx_GIVEREF(__pyx_t_3); PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3); __pyx_t_3 = NULL;
        __Pyx_INCREF(__pyx_v_ref_clean_dotdata);
        __Pyx_GIVEREF(__pyx_v_ref_clean_dotdata);
        PyTuple_SET_ITEM(__pyx_t_4, 0+1, __pyx_v_ref_clean_dotdata);
        __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_4, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 264, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      }
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_2 = PyNumber_Absolute(__pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 264, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_4 = __Pyx_GetModuleGlobalName(__pyx_n_s_eu_dis_reg_dup_block_calcu); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 264, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_t_3 = NULL;
      __pyx_t_6 = 0;
      if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_4))) {
        __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_4);
        if (likely(__pyx_t_3)) {
          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
          __Pyx_INCREF(__pyx_t_3);
          __Pyx_INCREF(function);
          __Pyx_DECREF_SET(__pyx_t_4, function);
          __pyx_t_6 = 1;
        }
      }
      __pyx_t_7 = PyTuple_New(2+__pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 264, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_7);
      if (__pyx_t_3) {
        __Pyx_GIVEREF(__pyx_t_3); PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_3); __pyx_t_3 = NULL;
      }
      __Pyx_INCREF(__pyx_v_alt_clean_dotdata);
      __Pyx_GIVEREF(__pyx_v_alt_clean_dotdata);
      PyTuple_SET_ITEM(__pyx_t_7, 0+__pyx_t_6, __pyx_v_alt_clean_dotdata);
      __Pyx_INCREF(__pyx_v_dup_block_bps);
      __Pyx_GIVEREF(__pyx_v_dup_block_bps);
      PyTuple_SET_ITEM(__pyx_t_7, 1+__pyx_t_6, __pyx_v_dup_block_bps);
      __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_7, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 264, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_4 = PyNumber_Absolute(__pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 264, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_1 = PyList_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 264, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_GIVEREF(__pyx_t_2);
      PyList_SET_ITEM(__pyx_t_1, 0, __pyx_t_2);
      __Pyx_GIVEREF(__pyx_t_4);
      PyList_SET_ITEM(__pyx_t_1, 1, __pyx_t_4);
      __pyx_t_2 = 0;
      __pyx_t_4 = 0;
      __pyx_r = __pyx_t_1;
      __pyx_t_1 = 0;
      goto __pyx_L0;

      /* "vapor_vali/Simple_function.pyx":263
 *         ref_clean_dotdata=(ref_dotdata)
 *         alt_clean_dotdata=clean_dotdata_diagnal_and_anti_diagnal(alt_dotdata)
 *         if len(ref_clean_dotdata)>0 and len(alt_clean_dotdata)>0:             # <<<<<<<<<<<<<<
 *             return [abs(eu_dis_abs_calcu(ref_clean_dotdata)),abs(eu_dis_reg_dup_block_calcu(alt_clean_dotdata,dup_block_bps))]
 *             #return [eu_dis_abs_calcu(take_off_symmetric_dots(ref_clean_dotdata)),eu_dis_abs_calcu(take_off_symmetric_dots(alt_clean_dotdata))]
 */
    }

    /* "vapor_vali/Simple_function.pyx":267
 *             #return [eu_dis_abs_calcu(take_off_symmetric_dots(ref_clean_dotdata)),eu_dis_abs_calcu(take_off_symmetric_dots(alt_clean_dotdata))]
 *         else:
 *             return [0,0]             # <<<<<<<<<<<<<<
 *     else:
 *         return [0,0]
 */
    /*else*/ {
      __Pyx_XDECREF(__pyx_r);
      __pyx_t_1 = PyList_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 267, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_INCREF(__pyx_int_0);
      __Pyx_GIVEREF(__pyx_int_0);
      PyList_SET_ITEM(__pyx_t_1, 0, __pyx_int_0);
      __Pyx_INCREF(__pyx_int_0);
      __Pyx_GIVEREF(__pyx_int_0);
      PyList_SET_ITEM(__pyx_t_1, 1, __pyx_int_0);
      __pyx_r = __pyx_t_1;
      __pyx_t_1 = 0;
      goto __pyx_L0;
    }

    /* "vapor_vali/Simple_function.pyx":260
 *     #ref_ref_lines=ref_ref_deviate_lines_describe(ref_ref_dotdata)
 *     #alt_alt_lines=ref_ref_deviate_lines_describe(alt_alt_dotdata)
 *     if float(len(ref_dotdata))/float(len(ref_seq))>0.1 and float(len(alt_dotdata))/float(len(alt_seq))>0.1 and float(ref_dotdata[-1][0]-ref_dotdata[0][0])/float(len(ref_seq))>0.7 and float(alt_dotdata[-1][0]-alt_dotdata[0][0])/float(len(alt_seq))>0.7:             # <<<<<<<<<<<<<<
 *         ref_clean_dotdata=(ref_dotdata)
 *         alt_clean_dotdata=clean_dotdata_diagnal_and_anti_diagnal(alt_dotdata)
 */
  }

  /* "vapor_vali/Simple_function.pyx":269
 *             return [0,0]
 *     else:
 *         return [0,0]             # <<<<<<<<<<<<<<
 * 
 * def calcu_vapor_single_read_score_within_10Perc_m1b(ref_seq,alt_seq,x,window_size):
 */
  /*else*/ {
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = PyList_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 269, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_INCREF(__pyx_int_0);
    __Pyx_GIVEREF(__pyx_int_0);
    PyList_SET_ITEM(__pyx_t_1, 0, __pyx_int_0);
    __Pyx_INCREF(__pyx_int_0);
    __Pyx_GIVEREF(__pyx_int_0);
    PyList_SET_ITEM(__pyx_t_1, 1, __pyx_int_0);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;
  }

  /* "vapor_vali/Simple_function.pyx":253
 *         return [0,0]
 * 
 * def calcu_vapor_single_read_score_directed_dis_m1b_maybe(ref_seq,alt_seq,x,window_size,dup_block_bps):             # <<<<<<<<<<<<<<
 *     #ref_ref_dotdata=dotdata(window_size,ref_seq[x[1]:],ref_seq[x[1]:])
 *     #alt_alt_dotdata=dotdata(window_size,alt_seq[x[1]:],alt_seq[x[1]:])
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_7);
  __Pyx_AddTraceback("vapor_vali.Simple_function.calcu_vapor_single_read_score_directed_dis_m1b_maybe", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_ref_dotdata);
  __Pyx_XDECREF(__pyx_v_alt_dotdata);
  __Pyx_XDECREF(__pyx_v_ref_clean_dotdata);
  __Pyx_XDECREF(__pyx_v_alt_clean_dotdata);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "vapor_vali/Simple_function.pyx":271
 *         return [0,0]
 * 
 * def calcu_vapor_single_read_score_within_10Perc_m1b(ref_seq,alt_seq,x,window_size):             # <<<<<<<<<<<<<<
 *     ref_dotdata=dotdata(window_size,x[0],ref_seq[x[1]:])
 *     alt_dotdata=dotdata(window_size,x[0],alt_seq[x[1]:])
 */

/* Python wrapper */
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_29calcu_vapor_single_read_score_within_10Perc_m1b(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_10vapor_vali_15Simple_function_29calcu_vapor_single_read_score_within_10Perc_m1b = {"calcu_vapor_single_read_score_within_10Perc_m1b", (PyCFunction)__pyx_pw_10vapor_vali_15Simple_function_29calcu_vapor_single_read_score_within_10Perc_m1b, METH_VARARGS|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_29calcu_vapor_single_read_score_within_10Perc_m1b(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_ref_seq = 0;
  PyObject *__pyx_v_alt_seq = 0;
  PyObject *__pyx_v_x = 0;
  PyObject *__pyx_v_window_size = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("calcu_vapor_single_read_score_within_10Perc_m1b (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_ref_seq,&__pyx_n_s_alt_seq,&__pyx_n_s_x,&__pyx_n_s_window_size,0};
    PyObject* values[4] = {0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
      switch (pos_args) {
        case  4: values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
        case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_ref_seq)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_alt_seq)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("calcu_vapor_single_read_score_within_10Perc_m1b", 1, 4, 4, 1); __PYX_ERR(0, 271, __pyx_L3_error)
        }
        case  2:
        if (likely((values[2] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_x)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("calcu_vapor_single_read_score_within_10Perc_m1b", 1, 4, 4, 2); __PYX_ERR(0, 271, __pyx_L3_error)
        }
        case  3:
        if (likely((values[3] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_window_size)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("calcu_vapor_single_read_score_within_10Perc_m1b", 1, 4, 4, 3); __PYX_ERR(0, 271, __pyx_L3_error)
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "calcu_vapor_single_read_score_within_10Perc_m1b") < 0)) __PYX_ERR(0, 271, __pyx_L3_error)
      }
    } else if (PyTuple_GET_SIZE(__pyx_args) != 4) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
      values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
    }
    __pyx_v_ref_seq = values[0];
    __pyx_v_alt_seq = values[1];
    __pyx_v_x = values[2];
    __pyx_v_window_size = values[3];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("calcu_vapor_single_read_score_within_10Perc_m1b", 1, 4, 4, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 271, __pyx_L3_error)
  __pyx_L3_error:;
  __Pyx_AddTraceback("vapor_vali.Simple_function.calcu_vapor_single_read_score_within_10Perc_m1b", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_10vapor_vali_15Simple_function_28calcu_vapor_single_read_score_within_10Perc_m1b(__pyx_self, __pyx_v_ref_seq, __pyx_v_alt_seq, __pyx_v_x, __pyx_v_window_size);

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10vapor_vali_15Simple_function_28calcu_vapor_single_read_score_within_10Perc_m1b(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_ref_seq, PyObject *__pyx_v_alt_seq, PyObject *__pyx_v_x, PyObject *__pyx_v_window_size) {
  PyObject *__pyx_v_ref_dotdata = NULL;
  PyObject *__pyx_v_alt_dotdata = NULL;
  PyObject *__pyx_v_ref_clean_dotdata = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_ref_kept_segs = NULL;
  PyObject *__pyx_v_alt_clean_dotdata = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_alt_kept_segs = NULL;
  PyObject *__pyx_v_ref_left = NULL;
  PyObject *__pyx_v_alt_left = NULL;
  PyObject *__pyx_v_ref_anti_diag_clean_dotdata = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_ref_anti_diag_kept_segs = NULL;
  PyObject *__pyx_v_alt_anti_diag_clean_dotdata = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_alt_anti_diag_kept_segs = NULL;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  Py_ssize_t __pyx_t_6;
  PyObject *__pyx_t_7 = NULL;
  Py_ssize_t __pyx_t_8;
  double __pyx_t_9;
  double __pyx_t_10;
  double __pyx_t_11;
  int __pyx_t_12;
  PyObject *(*__pyx_t_13)(PyObject *);
  PyObject *(*__pyx_t_14)(PyObject *);
  int __pyx_t_15;
  __Pyx_RefNannySetupContext("calcu_vapor_single_read_score_within_10Perc_m1b", 0);

  /* "vapor_vali/Simple_function.pyx":272
 * 
 * def calcu_vapor_single_read_score_within_10Perc_m1b(ref_seq,alt_seq,x,window_size):
 *     ref_dotdata=dotdata(window_size,x[0],ref_seq[x[1]:])             # <<<<<<<<<<<<<<
 *     alt_dotdata=dotdata(window_size,x[0],alt_seq[x[1]:])
 *     if max([float(len(ref_dotdata))/float(len(ref_seq)),float(len(alt_dotdata))/float(len(alt_seq))])>0.1:
 */
  __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_dotdata); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 272, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_x, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 272, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_4 = __Pyx_GetItemInt(__pyx_v_x, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 272, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_5 = __Pyx_PyObject_GetSlice(__pyx_v_ref_seq, 0, 0, &__pyx_t_4, NULL, NULL, 0, 0, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 272, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = NULL;
  __pyx_t_6 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_2);
    if (likely(__pyx_t_4)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_4);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_2, function);
      __pyx_t_6 = 1;
    }
  }
  __pyx_t_7 = PyTuple_New(3+__pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 272, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  if (__pyx_t_4) {
    __Pyx_GIVEREF(__pyx_t_4); PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_4); __pyx_t_4 = NULL;
  }
  __Pyx_INCREF(__pyx_v_window_size);
  __Pyx_GIVEREF(__pyx_v_window_size);
  PyTuple_SET_ITEM(__pyx_t_7, 0+__pyx_t_6, __pyx_v_window_size);
  __Pyx_GIVEREF(__pyx_t_3);
  PyTuple_SET_ITEM(__pyx_t_7, 1+__pyx_t_6, __pyx_t_3);
  __Pyx_GIVEREF(__pyx_t_5);
  PyTuple_SET_ITEM(__pyx_t_7, 2+__pyx_t_6, __pyx_t_5);
  __pyx_t_3 = 0;
  __pyx_t_5 = 0;
  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_7, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 272, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_ref_dotdata = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":273
 * def calcu_vapor_single_read_score_within_10Perc_m1b(ref_seq,alt_seq,x,window_size):
 *     ref_dotdata=dotdata(window_size,x[0],ref_seq[x[1]:])
 *     alt_dotdata=dotdata(window_size,x[0],alt_seq[x[1]:])             # <<<<<<<<<<<<<<
 *     if max([float(len(ref_dotdata))/float(len(ref_seq)),float(len(alt_dotdata))/float(len(alt_seq))])>0.1:
 *         [ref_clean_dotdata,ref_kept_segs]=clean_dotdata_diagnal_m1b(ref_dotdata)
 */
  __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_dotdata); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 273, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_7 = __Pyx_GetItemInt(__pyx_v_x, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 273, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  __pyx_t_5 = __Pyx_GetItemInt(__pyx_v_x, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 273, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_3 = __Pyx_PyObject_GetSlice(__pyx_v_alt_seq, 0, 0, &__pyx_t_5, NULL, NULL, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 273, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = NULL;
  __pyx_t_6 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_2);
    if (likely(__pyx_t_5)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_5);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_2, function);
      __pyx_t_6 = 1;
    }
  }
  __pyx_t_4 = PyTuple_New(3+__pyx_t_6); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 273, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  if (__pyx_t_5) {
    __Pyx_GIVEREF(__pyx_t_5); PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_5); __pyx_t_5 = NULL;
  }
  __Pyx_INCREF(__pyx_v_window_size);
  __Pyx_GIVEREF(__pyx_v_window_size);
  PyTuple_SET_ITEM(__pyx_t_4, 0+__pyx_t_6, __pyx_v_window_size);
  __Pyx_GIVEREF(__pyx_t_7);
  PyTuple_SET_ITEM(__pyx_t_4, 1+__pyx_t_6, __pyx_t_7);
  __Pyx_GIVEREF(__pyx_t_3);
  PyTuple_SET_ITEM(__pyx_t_4, 2+__pyx_t_6, __pyx_t_3);
  __pyx_t_7 = 0;
  __pyx_t_3 = 0;
  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_4, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 273, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_alt_dotdata = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":274
 *     ref_dotdata=dotdata(window_size,x[0],ref_seq[x[1]:])
 *     alt_dotdata=dotdata(window_size,x[0],alt_seq[x[1]:])
 *     if max([float(len(ref_dotdata))/float(len(ref_seq)),float(len(alt_dotdata))/float(len(alt_seq))])>0.1:             # <<<<<<<<<<<<<<
 *         [ref_clean_dotdata,ref_kept_segs]=clean_dotdata_diagnal_m1b(ref_dotdata)
 *         [alt_clean_dotdata,alt_kept_segs]=clean_dotdata_diagnal_m1b(alt_dotdata)
 */
  __pyx_t_6 = PyObject_Length(__pyx_v_alt_dotdata); if (unlikely(__pyx_t_6 == -1)) __PYX_ERR(0, 274, __pyx_L1_error)
  __pyx_t_8 = PyObject_Length(__pyx_v_alt_seq); if (unlikely(__pyx_t_8 == -1)) __PYX_ERR(0, 274, __pyx_L1_error)
  if (unlikely(((double)__pyx_t_8) == 0)) {
    PyErr_SetString(PyExc_ZeroDivisionError, "float division");
    __PYX_ERR(0, 274, __pyx_L1_error)
  }
  __pyx_t_9 = (((double)__pyx_t_6) / ((double)__pyx_t_8));
  __pyx_t_8 = PyObject_Length(__pyx_v_ref_dotdata); if (unlikely(__pyx_t_8 == -1)) __PYX_ERR(0, 274, __pyx_L1_error)
  __pyx_t_6 = PyObject_Length(__pyx_v_ref_seq); if (unlikely(__pyx_t_6 == -1)) __PYX_ERR(0, 274, __pyx_L1_error)
  if (unlikely(((double)__pyx_t_6) == 0)) {
    PyErr_SetString(PyExc_ZeroDivisionError, "float division");
    __PYX_ERR(0, 274, __pyx_L1_error)
  }
  __pyx_t_10 = (((double)__pyx_t_8) / ((double)__pyx_t_6));
  if (((__pyx_t_9 > __pyx_t_10) != 0)) {
    __pyx_t_11 = __pyx_t_9;
  } else {
    __pyx_t_11 = __pyx_t_10;
  }
  __pyx_t_12 = ((__pyx_t_11 > 0.1) != 0);
  if (__pyx_t_12) {

    /* "vapor_vali/Simple_function.pyx":275
 *     alt_dotdata=dotdata(window_size,x[0],alt_seq[x[1]:])
 *     if max([float(len(ref_dotdata))/float(len(ref_seq)),float(len(alt_dotdata))/float(len(alt_seq))])>0.1:
 *         [ref_clean_dotdata,ref_kept_segs]=clean_dotdata_diagnal_m1b(ref_dotdata)             # <<<<<<<<<<<<<<
 *         [alt_clean_dotdata,alt_kept_segs]=clean_dotdata_diagnal_m1b(alt_dotdata)
 *         ref_left=[i for i in ref_dotdata if not list(i) in ref_clean_dotdata]
 */
    __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_clean_dotdata_diagnal_m1b); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 275, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_4 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_2))) {
      __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_2);
      if (likely(__pyx_t_4)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
        __Pyx_INCREF(__pyx_t_4);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_2, function);
      }
    }
    if (!__pyx_t_4) {
      __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_v_ref_dotdata); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 275, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
    } else {
      __pyx_t_3 = PyTuple_New(1+1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 275, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __Pyx_GIVEREF(__pyx_t_4); PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_4); __pyx_t_4 = NULL;
      __Pyx_INCREF(__pyx_v_ref_dotdata);
      __Pyx_GIVEREF(__pyx_v_ref_dotdata);
      PyTuple_SET_ITEM(__pyx_t_3, 0+1, __pyx_v_ref_dotdata);
      __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_3, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 275, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    }
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    if ((likely(PyTuple_CheckExact(__pyx_t_1))) || (PyList_CheckExact(__pyx_t_1))) {
      PyObject* sequence = __pyx_t_1;
      #if CYTHON_COMPILING_IN_CPYTHON
      Py_ssize_t size = Py_SIZE(sequence);
      #else
      Py_ssize_t size = PySequence_Size(sequence);
      #endif
      if (unlikely(size != 2)) {
        if (size > 2) __Pyx_RaiseTooManyValuesError(2);
        else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
        __PYX_ERR(0, 275, __pyx_L1_error)
      }
      #if CYTHON_COMPILING_IN_CPYTHON
      if (likely(PyTuple_CheckExact(sequence))) {
        __pyx_t_2 = PyTuple_GET_ITEM(sequence, 0); 
        __pyx_t_3 = PyTuple_GET_ITEM(sequence, 1); 
      } else {
        __pyx_t_2 = PyList_GET_ITEM(sequence, 0); 
        __pyx_t_3 = PyList_GET_ITEM(sequence, 1); 
      }
      __Pyx_INCREF(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_3);
      #else
      __pyx_t_2 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 275, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __pyx_t_3 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 275, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      #endif
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    } else {
      Py_ssize_t index = -1;
      __pyx_t_4 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 275, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_13 = Py_TYPE(__pyx_t_4)->tp_iternext;
      index = 0; __pyx_t_2 = __pyx_t_13(__pyx_t_4); if (unlikely(!__pyx_t_2)) goto __pyx_L4_unpacking_failed;
      __Pyx_GOTREF(__pyx_t_2);
      index = 1; __pyx_t_3 = __pyx_t_13(__pyx_t_4); if (unlikely(!__pyx_t_3)) goto __pyx_L4_unpacking_failed;
      __Pyx_GOTREF(__pyx_t_3);
      if (__Pyx_IternextUnpackEndCheck(__pyx_t_13(__pyx_t_4), 2) < 0) __PYX_ERR(0, 275, __pyx_L1_error)
      __pyx_t_13 = NULL;
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      goto __pyx_L5_unpacking_done;
      __pyx_L4_unpacking_failed:;
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_13 = NULL;
      if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
      __PYX_ERR(0, 275, __pyx_L1_error)
      __pyx_L5_unpacking_done:;
    }
    __pyx_v_ref_clean_dotdata = __pyx_t_2;
    __pyx_t_2 = 0;
    __pyx_v_ref_kept_segs = __pyx_t_3;
    __pyx_t_3 = 0;

    /* "vapor_vali/Simple_function.pyx":276
 *     if max([float(len(ref_dotdata))/float(len(ref_seq)),float(len(alt_dotdata))/float(len(alt_seq))])>0.1:
 *         [ref_clean_dotdata,ref_kept_segs]=clean_dotdata_diagnal_m1b(ref_dotdata)
 *         [alt_clean_dotdata,alt_kept_segs]=clean_dotdata_diagnal_m1b(alt_dotdata)             # <<<<<<<<<<<<<<
 *         ref_left=[i for i in ref_dotdata if not list(i) in ref_clean_dotdata]
 *         alt_left=[i for i in alt_dotdata if not list(i) in alt_clean_dotdata]
 */
    __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_clean_dotdata_diagnal_m1b); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 276, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_2 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_3))) {
      __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_3);
      if (likely(__pyx_t_2)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
        __Pyx_INCREF(__pyx_t_2);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_3, function);
      }
    }
    if (!__pyx_t_2) {
      __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_v_alt_dotdata); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 276, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
    } else {
      __pyx_t_4 = PyTuple_New(1+1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 276, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      __Pyx_GIVEREF(__pyx_t_2); PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_2); __pyx_t_2 = NULL;
      __Pyx_INCREF(__pyx_v_alt_dotdata);
      __Pyx_GIVEREF(__pyx_v_alt_dotdata);
      PyTuple_SET_ITEM(__pyx_t_4, 0+1, __pyx_v_alt_dotdata);
      __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_4, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 276, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    }
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    if ((likely(PyTuple_CheckExact(__pyx_t_1))) || (PyList_CheckExact(__pyx_t_1))) {
      PyObject* sequence = __pyx_t_1;
      #if CYTHON_COMPILING_IN_CPYTHON
      Py_ssize_t size = Py_SIZE(sequence);
      #else
      Py_ssize_t size = PySequence_Size(sequence);
      #endif
      if (unlikely(size != 2)) {
        if (size > 2) __Pyx_RaiseTooManyValuesError(2);
        else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
        __PYX_ERR(0, 276, __pyx_L1_error)
      }
      #if CYTHON_COMPILING_IN_CPYTHON
      if (likely(PyTuple_CheckExact(sequence))) {
        __pyx_t_3 = PyTuple_GET_ITEM(sequence, 0); 
        __pyx_t_4 = PyTuple_GET_ITEM(sequence, 1); 
      } else {
        __pyx_t_3 = PyList_GET_ITEM(sequence, 0); 
        __pyx_t_4 = PyList_GET_ITEM(sequence, 1); 
      }
      __Pyx_INCREF(__pyx_t_3);
      __Pyx_INCREF(__pyx_t_4);
      #else
      __pyx_t_3 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 276, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __pyx_t_4 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 276, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      #endif
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    } else {
      Py_ssize_t index = -1;
      __pyx_t_2 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 276, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_13 = Py_TYPE(__pyx_t_2)->tp_iternext;
      index = 0; __pyx_t_3 = __pyx_t_13(__pyx_t_2); if (unlikely(!__pyx_t_3)) goto __pyx_L6_unpacking_failed;
      __Pyx_GOTREF(__pyx_t_3);
      index = 1; __pyx_t_4 = __pyx_t_13(__pyx_t_2); if (unlikely(!__pyx_t_4)) goto __pyx_L6_unpacking_failed;
      __Pyx_GOTREF(__pyx_t_4);
      if (__Pyx_IternextUnpackEndCheck(__pyx_t_13(__pyx_t_2), 2) < 0) __PYX_ERR(0, 276, __pyx_L1_error)
      __pyx_t_13 = NULL;
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      goto __pyx_L7_unpacking_done;
      __pyx_L6_unpacking_failed:;
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_13 = NULL;
      if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
      __PYX_ERR(0, 276, __pyx_L1_error)
      __pyx_L7_unpacking_done:;
    }
    __pyx_v_alt_clean_dotdata = __pyx_t_3;
    __pyx_t_3 = 0;
    __pyx_v_alt_kept_segs = __pyx_t_4;
    __pyx_t_4 = 0;

    /* "vapor_vali/Simple_function.pyx":277
 *         [ref_clean_dotdata,ref_kept_segs]=clean_dotdata_diagnal_m1b(ref_dotdata)
 *         [alt_clean_dotdata,alt_kept_segs]=clean_dotdata_diagnal_m1b(alt_dotdata)
 *         ref_left=[i for i in ref_dotdata if not list(i) in ref_clean_dotdata]             # <<<<<<<<<<<<<<
 *         alt_left=[i for i in alt_dotdata if not list(i) in alt_clean_dotdata]
 *         [ref_anti_diag_clean_dotdata,ref_anti_diag_kept_segs]=clean_dotdata_anti_diagnal_m1b(ref_left)
 */
    __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 277, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    if (likely(PyList_CheckExact(__pyx_v_ref_dotdata)) || PyTuple_CheckExact(__pyx_v_ref_dotdata)) {
      __pyx_t_4 = __pyx_v_ref_dotdata; __Pyx_INCREF(__pyx_t_4); __pyx_t_6 = 0;
      __pyx_t_14 = NULL;
    } else {
      __pyx_t_6 = -1; __pyx_t_4 = PyObject_GetIter(__pyx_v_ref_dotdata); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 277, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_t_14 = Py_TYPE(__pyx_t_4)->tp_iternext; if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 277, __pyx_L1_error)
    }
    for (;;) {
      if (likely(!__pyx_t_14)) {
        if (likely(PyList_CheckExact(__pyx_t_4))) {
          if (__pyx_t_6 >= PyList_GET_SIZE(__pyx_t_4)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_3 = PyList_GET_ITEM(__pyx_t_4, __pyx_t_6); __Pyx_INCREF(__pyx_t_3); __pyx_t_6++; if (unlikely(0 < 0)) __PYX_ERR(0, 277, __pyx_L1_error)
          #else
          __pyx_t_3 = PySequence_ITEM(__pyx_t_4, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 277, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_3);
          #endif
        } else {
          if (__pyx_t_6 >= PyTuple_GET_SIZE(__pyx_t_4)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_3 = PyTuple_GET_ITEM(__pyx_t_4, __pyx_t_6); __Pyx_INCREF(__pyx_t_3); __pyx_t_6++; if (unlikely(0 < 0)) __PYX_ERR(0, 277, __pyx_L1_error)
          #else
          __pyx_t_3 = PySequence_ITEM(__pyx_t_4, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 277, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_3);
          #endif
        }
      } else {
        __pyx_t_3 = __pyx_t_14(__pyx_t_4);
        if (unlikely(!__pyx_t_3)) {
          PyObject* exc_type = PyErr_Occurred();
          if (exc_type) {
            if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
            else __PYX_ERR(0, 277, __pyx_L1_error)
          }
          break;
        }
        __Pyx_GOTREF(__pyx_t_3);
      }
      __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_3);
      __pyx_t_3 = 0;
      __pyx_t_3 = PySequence_List(__pyx_v_i); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 277, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __pyx_t_12 = (__Pyx_PySequence_ContainsTF(__pyx_t_3, __pyx_v_ref_clean_dotdata, Py_NE)); if (unlikely(__pyx_t_12 < 0)) __PYX_ERR(0, 277, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_15 = (__pyx_t_12 != 0);
      if (__pyx_t_15) {
        if (unlikely(__Pyx_ListComp_Append(__pyx_t_1, (PyObject*)__pyx_v_i))) __PYX_ERR(0, 277, __pyx_L1_error)
      }
    }
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_v_ref_left = ((PyObject*)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "vapor_vali/Simple_function.pyx":278
 *         [alt_clean_dotdata,alt_kept_segs]=clean_dotdata_diagnal_m1b(alt_dotdata)
 *         ref_left=[i for i in ref_dotdata if not list(i) in ref_clean_dotdata]
 *         alt_left=[i for i in alt_dotdata if not list(i) in alt_clean_dotdata]             # <<<<<<<<<<<<<<
 *         [ref_anti_diag_clean_dotdata,ref_anti_diag_kept_segs]=clean_dotdata_anti_diagnal_m1b(ref_left)
 *         [alt_anti_diag_clean_dotdata,alt_anti_diag_kept_segs]=clean_dotdata_anti_diagnal_m1b(alt_left)
 */
    __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 278, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    if (likely(PyList_CheckExact(__pyx_v_alt_dotdata)) || PyTuple_CheckExact(__pyx_v_alt_dotdata)) {
      __pyx_t_4 = __pyx_v_alt_dotdata; __Pyx_INCREF(__pyx_t_4); __pyx_t_6 = 0;
      __pyx_t_14 = NULL;
    } else {
      __pyx_t_6 = -1; __pyx_t_4 = PyObject_GetIter(__pyx_v_alt_dotdata); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 278, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_t_14 = Py_TYPE(__pyx_t_4)->tp_iternext; if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 278, __pyx_L1_error)
    }
    for (;;) {
      if (likely(!__pyx_t_14)) {
        if (likely(PyList_CheckExact(__pyx_t_4))) {
          if (__pyx_t_6 >= PyList_GET_SIZE(__pyx_t_4)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_3 = PyList_GET_ITEM(__pyx_t_4, __pyx_t_6); __Pyx_INCREF(__pyx_t_3); __pyx_t_6++; if (unlikely(0 < 0)) __PYX_ERR(0, 278, __pyx_L1_error)
          #else
          __pyx_t_3 = PySequence_ITEM(__pyx_t_4, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 278, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_3);
          #endif
        } else {
          if (__pyx_t_6 >= PyTuple_GET_SIZE(__pyx_t_4)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_3 = PyTuple_GET_ITEM(__pyx_t_4, __pyx_t_6); __Pyx_INCREF(__pyx_t_3); __pyx_t_6++; if (unlikely(0 < 0)) __PYX_ERR(0, 278, __pyx_L1_error)
          #else
          __pyx_t_3 = PySequence_ITEM(__pyx_t_4, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 278, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_3);
          #endif
        }
      } else {
        __pyx_t_3 = __pyx_t_14(__pyx_t_4);
        if (unlikely(!__pyx_t_3)) {
          PyObject* exc_type = PyErr_Occurred();
          if (exc_type) {
            if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
            else __PYX_ERR(0, 278, __pyx_L1_error)
          }
          break;
        }
        __Pyx_GOTREF(__pyx_t_3);
      }
      __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_3);
      __pyx_t_3 = 0;
      __pyx_t_3 = PySequence_List(__pyx_v_i); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 278, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __pyx_t_15 = (__Pyx_PySequence_ContainsTF(__pyx_t_3, __pyx_v_alt_clean_dotdata, Py_NE)); if (unlikely(__pyx_t_15 < 0)) __PYX_ERR(0, 278, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_12 = (__pyx_t_15 != 0);
      if (__pyx_t_12) {
        if (unlikely(__Pyx_ListComp_Append(__pyx_t_1, (PyObject*)__pyx_v_i))) __PYX_ERR(0, 278, __pyx_L1_error)
      }
    }
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_v_alt_left = ((PyObject*)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "vapor_vali/Simple_function.pyx":279
 *         ref_left=[i for i in ref_dotdata if not list(i) in ref_clean_dotdata]
 *         alt_left=[i for i in alt_dotdata if not list(i) in alt_clean_dotdata]
 *         [ref_anti_diag_clean_dotdata,ref_anti_diag_kept_segs]=clean_dotdata_anti_diagnal_m1b(ref_left)             # <<<<<<<<<<<<<<
 *         [alt_anti_diag_clean_dotdata,alt_anti_diag_kept_segs]=clean_dotdata_anti_diagnal_m1b(alt_left)
 *         ref_clean_dotdata+=ref_anti_diag_clean_dotdata
 */
    __pyx_t_4 = __Pyx_GetModuleGlobalName(__pyx_n_s_clean_dotdata_anti_diagnal_m1b); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 279, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_3 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_4))) {
      __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_4);
      if (likely(__pyx_t_3)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
        __Pyx_INCREF(__pyx_t_3);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_4, function);
      }
    }
    if (!__pyx_t_3) {
      __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_v_ref_left); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 279, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
    } else {
      __pyx_t_2 = PyTuple_New(1+1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 279, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __Pyx_GIVEREF(__pyx_t_3); PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_3); __pyx_t_3 = NULL;
      __Pyx_INCREF(__pyx_v_ref_left);
      __Pyx_GIVEREF(__pyx_v_ref_left);
      PyTuple_SET_ITEM(__pyx_t_2, 0+1, __pyx_v_ref_left);
      __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_2, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 279, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    }
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    if ((likely(PyTuple_CheckExact(__pyx_t_1))) || (PyList_CheckExact(__pyx_t_1))) {
      PyObject* sequence = __pyx_t_1;
      #if CYTHON_COMPILING_IN_CPYTHON
      Py_ssize_t size = Py_SIZE(sequence);
      #else
      Py_ssize_t size = PySequence_Size(sequence);
      #endif
      if (unlikely(size != 2)) {
        if (size > 2) __Pyx_RaiseTooManyValuesError(2);
        else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
        __PYX_ERR(0, 279, __pyx_L1_error)
      }
      #if CYTHON_COMPILING_IN_CPYTHON
      if (likely(PyTuple_CheckExact(sequence))) {
        __pyx_t_4 = PyTuple_GET_ITEM(sequence, 0); 
        __pyx_t_2 = PyTuple_GET_ITEM(sequence, 1); 
      } else {
        __pyx_t_4 = PyList_GET_ITEM(sequence, 0); 
        __pyx_t_2 = PyList_GET_ITEM(sequence, 1); 
      }
      __Pyx_INCREF(__pyx_t_4);
      __Pyx_INCREF(__pyx_t_2);
      #else
      __pyx_t_4 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 279, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_t_2 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 279, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      #endif
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    } else {
      Py_ssize_t index = -1;
      __pyx_t_3 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 279, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_13 = Py_TYPE(__pyx_t_3)->tp_iternext;
      index = 0; __pyx_t_4 = __pyx_t_13(__pyx_t_3); if (unlikely(!__pyx_t_4)) goto __pyx_L14_unpacking_failed;
      __Pyx_GOTREF(__pyx_t_4);
      index = 1; __pyx_t_2 = __pyx_t_13(__pyx_t_3); if (unlikely(!__pyx_t_2)) goto __pyx_L14_unpacking_failed;
      __Pyx_GOTREF(__pyx_t_2);
      if (__Pyx_IternextUnpackEndCheck(__pyx_t_13(__pyx_t_3), 2) < 0) __PYX_ERR(0, 279, __pyx_L1_error)
      __pyx_t_13 = NULL;
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      goto __pyx_L15_unpacking_done;
      __pyx_L14_unpacking_failed:;
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_13 = NULL;
      if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
      __PYX_ERR(0, 279, __pyx_L1_error)
      __pyx_L15_unpacking_done:;
    }
    __pyx_v_ref_anti_diag_clean_dotdata = __pyx_t_4;
    __pyx_t_4 = 0;
    __pyx_v_ref_anti_diag_kept_segs = __pyx_t_2;
    __pyx_t_2 = 0;

    /* "vapor_vali/Simple_function.pyx":280
 *         alt_left=[i for i in alt_dotdata if not list(i) in alt_clean_dotdata]
 *         [ref_anti_diag_clean_dotdata,ref_anti_diag_kept_segs]=clean_dotdata_anti_diagnal_m1b(ref_left)
 *         [alt_anti_diag_clean_dotdata,alt_anti_diag_kept_segs]=clean_dotdata_anti_diagnal_m1b(alt_left)             # <<<<<<<<<<<<<<
 *         ref_clean_dotdata+=ref_anti_diag_clean_dotdata
 *         alt_clean_dotdata+=alt_anti_diag_clean_dotdata
 */
    __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_clean_dotdata_anti_diagnal_m1b); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 280, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_4 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_2))) {
      __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_2);
      if (likely(__pyx_t_4)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
        __Pyx_INCREF(__pyx_t_4);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_2, function);
      }
    }
    if (!__pyx_t_4) {
      __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_v_alt_left); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 280, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
    } else {
      __pyx_t_3 = PyTuple_New(1+1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 280, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __Pyx_GIVEREF(__pyx_t_4); PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_4); __pyx_t_4 = NULL;
      __Pyx_INCREF(__pyx_v_alt_left);
      __Pyx_GIVEREF(__pyx_v_alt_left);
      PyTuple_SET_ITEM(__pyx_t_3, 0+1, __pyx_v_alt_left);
      __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_3, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 280, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    }
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    if ((likely(PyTuple_CheckExact(__pyx_t_1))) || (PyList_CheckExact(__pyx_t_1))) {
      PyObject* sequence = __pyx_t_1;
      #if CYTHON_COMPILING_IN_CPYTHON
      Py_ssize_t size = Py_SIZE(sequence);
      #else
      Py_ssize_t size = PySequence_Size(sequence);
      #endif
      if (unlikely(size != 2)) {
        if (size > 2) __Pyx_RaiseTooManyValuesError(2);
        else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
        __PYX_ERR(0, 280, __pyx_L1_error)
      }
      #if CYTHON_COMPILING_IN_CPYTHON
      if (likely(PyTuple_CheckExact(sequence))) {
        __pyx_t_2 = PyTuple_GET_ITEM(sequence, 0); 
        __pyx_t_3 = PyTuple_GET_ITEM(sequence, 1); 
      } else {
        __pyx_t_2 = PyList_GET_ITEM(sequence, 0); 
        __pyx_t_3 = PyList_GET_ITEM(sequence, 1); 
      }
      __Pyx_INCREF(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_3);
      #else
      __pyx_t_2 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 280, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __pyx_t_3 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 280, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      #endif
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    } else {
      Py_ssize_t index = -1;
      __pyx_t_4 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 280, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_13 = Py_TYPE(__pyx_t_4)->tp_iternext;
      index = 0; __pyx_t_2 = __pyx_t_13(__pyx_t_4); if (unlikely(!__pyx_t_2)) goto __pyx_L16_unpacking_failed;
      __Pyx_GOTREF(__pyx_t_2);
      index = 1; __pyx_t_3 = __pyx_t_13(__pyx_t_4); if (unlikely(!__pyx_t_3)) goto __pyx_L16_unpacking_failed;
      __Pyx_GOTREF(__pyx_t_3);
      if (__Pyx_IternextUnpackEndCheck(__pyx_t_13(__pyx_t_4), 2) < 0) __PYX_ERR(0, 280, __pyx_L1_error)
      __pyx_t_13 = NULL;
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      goto __pyx_L17_unpacking_done;
      __pyx_L16_unpacking_failed:;
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_13 = NULL;
      if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
      __PYX_ERR(0, 280, __pyx_L1_error)
      __pyx_L17_unpacking_done:;
    }
    __pyx_v_alt_anti_diag_clean_dotdata = __pyx_t_2;
    __pyx_t_2 = 0;
    __pyx_v_alt_anti_diag_kept_segs = __pyx_t_3;
    __pyx_t_3 = 0;

    /* "vapor_vali/Simple_function.pyx":281
 *         [ref_anti_diag_clean_dotdata,ref_anti_diag_kept_segs]=clean_dotdata_anti_diagnal_m1b(ref_left)
 *         [alt_anti_diag_clean_dotdata,alt_anti_diag_kept_segs]=clean_dotdata_anti_diagnal_m1b(alt_left)
 *         ref_clean_dotdata+=ref_anti_diag_clean_dotdata             # <<<<<<<<<<<<<<
 *         alt_clean_dotdata+=alt_anti_diag_clean_dotdata
 *         if len(ref_clean_dotdata)>0 and len(alt_clean_dotdata)>0:
 */
    __pyx_t_1 = PyNumber_InPlaceAdd(__pyx_v_ref_clean_dotdata, __pyx_v_ref_anti_diag_clean_dotdata); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 281, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF_SET(__pyx_v_ref_clean_dotdata, __pyx_t_1);
    __pyx_t_1 = 0;

    /* "vapor_vali/Simple_function.pyx":282
 *         [alt_anti_diag_clean_dotdata,alt_anti_diag_kept_segs]=clean_dotdata_anti_diagnal_m1b(alt_left)
 *         ref_clean_dotdata+=ref_anti_diag_clean_dotdata
 *         alt_clean_dotdata+=alt_anti_diag_clean_dotdata             # <<<<<<<<<<<<<<
 *         if len(ref_clean_dotdata)>0 and len(alt_clean_dotdata)>0:
 *             return [eu_dis_dots_within_10perc(alt_clean_dotdata),eu_dis_dots_within_10perc(ref_clean_dotdata)]    #if prediction correct [large, small]
 */
    __pyx_t_1 = PyNumber_InPlaceAdd(__pyx_v_alt_clean_dotdata, __pyx_v_alt_anti_diag_clean_dotdata); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 282, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF_SET(__pyx_v_alt_clean_dotdata, __pyx_t_1);
    __pyx_t_1 = 0;

    /* "vapor_vali/Simple_function.pyx":283
 *         ref_clean_dotdata+=ref_anti_diag_clean_dotdata
 *         alt_clean_dotdata+=alt_anti_diag_clean_dotdata
 *         if len(ref_clean_dotdata)>0 and len(alt_clean_dotdata)>0:             # <<<<<<<<<<<<<<
 *             return [eu_dis_dots_within_10perc(alt_clean_dotdata),eu_dis_dots_within_10perc(ref_clean_dotdata)]    #if prediction correct [large, small]
 *         else:
 */
    __pyx_t_6 = PyObject_Length(__pyx_v_ref_clean_dotdata); if (unlikely(__pyx_t_6 == -1)) __PYX_ERR(0, 283, __pyx_L1_error)
    __pyx_t_15 = ((__pyx_t_6 > 0) != 0);
    if (__pyx_t_15) {
    } else {
      __pyx_t_12 = __pyx_t_15;
      goto __pyx_L19_bool_binop_done;
    }
    __pyx_t_6 = PyObject_Length(__pyx_v_alt_clean_dotdata); if (unlikely(__pyx_t_6 == -1)) __PYX_ERR(0, 283, __pyx_L1_error)
    __pyx_t_15 = ((__pyx_t_6 > 0) != 0);
    __pyx_t_12 = __pyx_t_15;
    __pyx_L19_bool_binop_done:;
    if (__pyx_t_12) {

      /* "vapor_vali/Simple_function.pyx":284
 *         alt_clean_dotdata+=alt_anti_diag_clean_dotdata
 *         if len(ref_clean_dotdata)>0 and len(alt_clean_dotdata)>0:
 *             return [eu_dis_dots_within_10perc(alt_clean_dotdata),eu_dis_dots_within_10perc(ref_clean_dotdata)]    #if prediction correct [large, small]             # <<<<<<<<<<<<<<
 *         else:
 *             return [0,0]
 */
      __Pyx_XDECREF(__pyx_r);
      __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_eu_dis_dots_within_10perc); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 284, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __pyx_t_2 = NULL;
      if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_3))) {
        __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_3);
        if (likely(__pyx_t_2)) {
          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
          __Pyx_INCREF(__pyx_t_2);
          __Pyx_INCREF(function);
          __Pyx_DECREF_SET(__pyx_t_3, function);
        }
      }
      if (!__pyx_t_2) {
        __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_v_alt_clean_dotdata); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 284, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
      } else {
        __pyx_t_4 = PyTuple_New(1+1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 284, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_4);
        __Pyx_GIVEREF(__pyx_t_2); PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_2); __pyx_t_2 = NULL;
        __Pyx_INCREF(__pyx_v_alt_clean_dotdata);
        __Pyx_GIVEREF(__pyx_v_alt_clean_dotdata);
        PyTuple_SET_ITEM(__pyx_t_4, 0+1, __pyx_v_alt_clean_dotdata);
        __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_4, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 284, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      }
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_4 = __Pyx_GetModuleGlobalName(__pyx_n_s_eu_dis_dots_within_10perc); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 284, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_t_2 = NULL;
      if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_4))) {
        __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_4);
        if (likely(__pyx_t_2)) {
          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
          __Pyx_INCREF(__pyx_t_2);
          __Pyx_INCREF(function);
          __Pyx_DECREF_SET(__pyx_t_4, function);
        }
      }
      if (!__pyx_t_2) {
        __pyx_t_3 = __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_v_ref_clean_dotdata); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 284, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_3);
      } else {
        __pyx_t_7 = PyTuple_New(1+1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 284, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_7);
        __Pyx_GIVEREF(__pyx_t_2); PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_2); __pyx_t_2 = NULL;
        __Pyx_INCREF(__pyx_v_ref_clean_dotdata);
        __Pyx_GIVEREF(__pyx_v_ref_clean_dotdata);
        PyTuple_SET_ITEM(__pyx_t_7, 0+1, __pyx_v_ref_clean_dotdata);
        __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_7, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 284, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_3);
        __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
      }
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_4 = PyList_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 284, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      __Pyx_GIVEREF(__pyx_t_1);
      PyList_SET_ITEM(__pyx_t_4, 0, __pyx_t_1);
      __Pyx_GIVEREF(__pyx_t_3);
      PyList_SET_ITEM(__pyx_t_4, 1, __pyx_t_3);
      __pyx_t_1 = 0;
      __pyx_t_3 = 0;
      __pyx_r = __pyx_t_4;
      __pyx_t_4 = 0;
      goto __pyx_L0;

      /* "vapor_vali/Simple_function.pyx":283
 *         ref_clean_dotdata+=ref_anti_diag_clean_dotdata
 *         alt_clean_dotdata+=alt_anti_diag_clean_dotdata
 *         if len(ref_clean_dotdata)>0 and len(alt_clean_dotdata)>0:             # <<<<<<<<<<<<<<
 *             return [eu_dis_dots_within_10perc(alt_clean_dotdata),eu_dis_dots_within_10perc(ref_clean_dotdata)]    #if prediction correct [large, small]
 *         else:
 */
    }

    /* "vapor_vali/Simple_function.pyx":286
 *             return [eu_dis_dots_within_10perc(alt_clean_dotdata),eu_dis_dots_within_10perc(ref_clean_dotdata)]    #if prediction correct [large, small]
 *         else:
 *             return [0,0]             # <<<<<<<<<<<<<<
 *     else:
 *         return [0,0]
 */
    /*else*/ {
      __Pyx_XDECREF(__pyx_r);
      __pyx_t_4 = PyList_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 286, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      __Pyx_INCREF(__pyx_int_0);
      __Pyx_GIVEREF(__pyx_int_0);
      PyList_SET_ITEM(__pyx_t_4, 0, __pyx_int_0);
      __Pyx_INCREF(__pyx_int_0);
      __Pyx_GIVEREF(__pyx_int_0);
      PyList_SET_ITEM(__pyx_t_4, 1, __pyx_int_0);
      __pyx_r = __pyx_t_4;
      __pyx_t_4 = 0;
      goto __pyx_L0;
    }

    /* "vapor_vali/Simple_function.pyx":274
 *     ref_dotdata=dotdata(window_size,x[0],ref_seq[x[1]:])
 *     alt_dotdata=dotdata(window_size,x[0],alt_seq[x[1]:])
 *     if max([float(len(ref_dotdata))/float(len(ref_seq)),float(len(alt_dotdata))/float(len(alt_seq))])>0.1:             # <<<<<<<<<<<<<<
 *         [ref_clean_dotdata,ref_kept_segs]=clean_dotdata_diagnal_m1b(ref_dotdata)
 *         [alt_clean_dotdata,alt_kept_segs]=clean_dotdata_diagnal_m1b(alt_dotdata)
 */
  }

  /* "vapor_vali/Simple_function.pyx":288
 *             return [0,0]
 *     else:
 *         return [0,0]             # <<<<<<<<<<<<<<
 * 
 * def calcu_vapor_single_read_score_abs_dis_m2(ref_seq,alt_seq,x,window_size):
 */
  /*else*/ {
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_4 = PyList_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 288, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_INCREF(__pyx_int_0);
    __Pyx_GIVEREF(__pyx_int_0);
    PyList_SET_ITEM(__pyx_t_4, 0, __pyx_int_0);
    __Pyx_INCREF(__pyx_int_0);
    __Pyx_GIVEREF(__pyx_int_0);
    PyList_SET_ITEM(__pyx_t_4, 1, __pyx_int_0);
    __pyx_r = __pyx_t_4;
    __pyx_t_4 = 0;
    goto __pyx_L0;
  }

  /* "vapor_vali/Simple_function.pyx":271
 *         return [0,0]
 * 
 * def calcu_vapor_single_read_score_within_10Perc_m1b(ref_seq,alt_seq,x,window_size):             # <<<<<<<<<<<<<<
 *     ref_dotdata=dotdata(window_size,x[0],ref_seq[x[1]:])
 *     alt_dotdata=dotdata(window_size,x[0],alt_seq[x[1]:])
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_7);
  __Pyx_AddTraceback("vapor_vali.Simple_function.calcu_vapor_single_read_score_within_10Perc_m1b", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_ref_dotdata);
  __Pyx_XDECREF(__pyx_v_alt_dotdata);
  __Pyx_XDECREF(__pyx_v_ref_clean_dotdata);
  __Pyx_XDECREF(__pyx_v_ref_kept_segs);
  __Pyx_XDECREF(__pyx_v_alt_clean_dotdata);
  __Pyx_XDECREF(__pyx_v_alt_kept_segs);
  __Pyx_XDECREF(__pyx_v_ref_left);
  __Pyx_XDECREF(__pyx_v_alt_left);
  __Pyx_XDECREF(__pyx_v_ref_anti_diag_clean_dotdata);
  __Pyx_XDECREF(__pyx_v_ref_anti_diag_kept_segs);
  __Pyx_XDECREF(__pyx_v_alt_anti_diag_clean_dotdata);
  __Pyx_XDECREF(__pyx_v_alt_anti_diag_kept_segs);
  __Pyx_XDECREF(__pyx_v_i);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "vapor_vali/Simple_function.pyx":290
 *         return [0,0]
 * 
 * def calcu_vapor_single_read_score_abs_dis_m2(ref_seq,alt_seq,x,window_size):             # <<<<<<<<<<<<<<
 *     ref_dotdata=dotdata(window_size,x[0],ref_seq[x[1]:])
 *     alt_dotdata=dotdata(window_size,x[0],alt_seq[x[1]:])
 */

/* Python wrapper */
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_31calcu_vapor_single_read_score_abs_dis_m2(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_10vapor_vali_15Simple_function_31calcu_vapor_single_read_score_abs_dis_m2 = {"calcu_vapor_single_read_score_abs_dis_m2", (PyCFunction)__pyx_pw_10vapor_vali_15Simple_function_31calcu_vapor_single_read_score_abs_dis_m2, METH_VARARGS|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_31calcu_vapor_single_read_score_abs_dis_m2(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_ref_seq = 0;
  PyObject *__pyx_v_alt_seq = 0;
  PyObject *__pyx_v_x = 0;
  PyObject *__pyx_v_window_size = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("calcu_vapor_single_read_score_abs_dis_m2 (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_ref_seq,&__pyx_n_s_alt_seq,&__pyx_n_s_x,&__pyx_n_s_window_size,0};
    PyObject* values[4] = {0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
      switch (pos_args) {
        case  4: values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
        case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_ref_seq)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_alt_seq)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("calcu_vapor_single_read_score_abs_dis_m2", 1, 4, 4, 1); __PYX_ERR(0, 290, __pyx_L3_error)
        }
        case  2:
        if (likely((values[2] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_x)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("calcu_vapor_single_read_score_abs_dis_m2", 1, 4, 4, 2); __PYX_ERR(0, 290, __pyx_L3_error)
        }
        case  3:
        if (likely((values[3] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_window_size)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("calcu_vapor_single_read_score_abs_dis_m2", 1, 4, 4, 3); __PYX_ERR(0, 290, __pyx_L3_error)
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "calcu_vapor_single_read_score_abs_dis_m2") < 0)) __PYX_ERR(0, 290, __pyx_L3_error)
      }
    } else if (PyTuple_GET_SIZE(__pyx_args) != 4) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
      values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
    }
    __pyx_v_ref_seq = values[0];
    __pyx_v_alt_seq = values[1];
    __pyx_v_x = values[2];
    __pyx_v_window_size = values[3];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("calcu_vapor_single_read_score_abs_dis_m2", 1, 4, 4, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 290, __pyx_L3_error)
  __pyx_L3_error:;
  __Pyx_AddTraceback("vapor_vali.Simple_function.calcu_vapor_single_read_score_abs_dis_m2", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_10vapor_vali_15Simple_function_30calcu_vapor_single_read_score_abs_dis_m2(__pyx_self, __pyx_v_ref_seq, __pyx_v_alt_seq, __pyx_v_x, __pyx_v_window_size);

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10vapor_vali_15Simple_function_30calcu_vapor_single_read_score_abs_dis_m2(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_ref_seq, PyObject *__pyx_v_alt_seq, PyObject *__pyx_v_x, PyObject *__pyx_v_window_size) {
  PyObject *__pyx_v_ref_dotdata = NULL;
  PyObject *__pyx_v_alt_dotdata = NULL;
  PyObject *__pyx_v_ref_clean_dotdata = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_ref_kept_segs = NULL;
  PyObject *__pyx_v_alt_clean_dotdata = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_alt_kept_segs = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  Py_ssize_t __pyx_t_6;
  PyObject *__pyx_t_7 = NULL;
  int __pyx_t_8;
  Py_ssize_t __pyx_t_9;
  int __pyx_t_10;
  double __pyx_t_11;
  PyObject *(*__pyx_t_12)(PyObject *);
  __Pyx_RefNannySetupContext("calcu_vapor_single_read_score_abs_dis_m2", 0);

  /* "vapor_vali/Simple_function.pyx":291
 * 
 * def calcu_vapor_single_read_score_abs_dis_m2(ref_seq,alt_seq,x,window_size):
 *     ref_dotdata=dotdata(window_size,x[0],ref_seq[x[1]:])             # <<<<<<<<<<<<<<
 *     alt_dotdata=dotdata(window_size,x[0],alt_seq[x[1]:])
 *     if float(len(ref_dotdata))/float(len(ref_seq))>0.1 and float(len(alt_dotdata))/float(len(alt_seq))>0.1 and float(ref_dotdata[-1][0]-ref_dotdata[0][0])/float(len(ref_seq))>0.7 and float(alt_dotdata[-1][0]-alt_dotdata[0][0])/float(len(alt_seq))>0.7:
 */
  __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_dotdata); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 291, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_x, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 291, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_4 = __Pyx_GetItemInt(__pyx_v_x, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 291, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_5 = __Pyx_PyObject_GetSlice(__pyx_v_ref_seq, 0, 0, &__pyx_t_4, NULL, NULL, 0, 0, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 291, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = NULL;
  __pyx_t_6 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_2);
    if (likely(__pyx_t_4)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_4);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_2, function);
      __pyx_t_6 = 1;
    }
  }
  __pyx_t_7 = PyTuple_New(3+__pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 291, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  if (__pyx_t_4) {
    __Pyx_GIVEREF(__pyx_t_4); PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_4); __pyx_t_4 = NULL;
  }
  __Pyx_INCREF(__pyx_v_window_size);
  __Pyx_GIVEREF(__pyx_v_window_size);
  PyTuple_SET_ITEM(__pyx_t_7, 0+__pyx_t_6, __pyx_v_window_size);
  __Pyx_GIVEREF(__pyx_t_3);
  PyTuple_SET_ITEM(__pyx_t_7, 1+__pyx_t_6, __pyx_t_3);
  __Pyx_GIVEREF(__pyx_t_5);
  PyTuple_SET_ITEM(__pyx_t_7, 2+__pyx_t_6, __pyx_t_5);
  __pyx_t_3 = 0;
  __pyx_t_5 = 0;
  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_7, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 291, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_ref_dotdata = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":292
 * def calcu_vapor_single_read_score_abs_dis_m2(ref_seq,alt_seq,x,window_size):
 *     ref_dotdata=dotdata(window_size,x[0],ref_seq[x[1]:])
 *     alt_dotdata=dotdata(window_size,x[0],alt_seq[x[1]:])             # <<<<<<<<<<<<<<
 *     if float(len(ref_dotdata))/float(len(ref_seq))>0.1 and float(len(alt_dotdata))/float(len(alt_seq))>0.1 and float(ref_dotdata[-1][0]-ref_dotdata[0][0])/float(len(ref_seq))>0.7 and float(alt_dotdata[-1][0]-alt_dotdata[0][0])/float(len(alt_seq))>0.7:
 *         [ref_clean_dotdata,ref_kept_segs]=clean_dotdata_m2(ref_dotdata)
 */
  __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_dotdata); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 292, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_7 = __Pyx_GetItemInt(__pyx_v_x, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 292, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  __pyx_t_5 = __Pyx_GetItemInt(__pyx_v_x, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 292, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_3 = __Pyx_PyObject_GetSlice(__pyx_v_alt_seq, 0, 0, &__pyx_t_5, NULL, NULL, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 292, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = NULL;
  __pyx_t_6 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_2);
    if (likely(__pyx_t_5)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_5);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_2, function);
      __pyx_t_6 = 1;
    }
  }
  __pyx_t_4 = PyTuple_New(3+__pyx_t_6); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 292, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  if (__pyx_t_5) {
    __Pyx_GIVEREF(__pyx_t_5); PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_5); __pyx_t_5 = NULL;
  }
  __Pyx_INCREF(__pyx_v_window_size);
  __Pyx_GIVEREF(__pyx_v_window_size);
  PyTuple_SET_ITEM(__pyx_t_4, 0+__pyx_t_6, __pyx_v_window_size);
  __Pyx_GIVEREF(__pyx_t_7);
  PyTuple_SET_ITEM(__pyx_t_4, 1+__pyx_t_6, __pyx_t_7);
  __Pyx_GIVEREF(__pyx_t_3);
  PyTuple_SET_ITEM(__pyx_t_4, 2+__pyx_t_6, __pyx_t_3);
  __pyx_t_7 = 0;
  __pyx_t_3 = 0;
  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_4, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 292, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_alt_dotdata = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":293
 *     ref_dotdata=dotdata(window_size,x[0],ref_seq[x[1]:])
 *     alt_dotdata=dotdata(window_size,x[0],alt_seq[x[1]:])
 *     if float(len(ref_dotdata))/float(len(ref_seq))>0.1 and float(len(alt_dotdata))/float(len(alt_seq))>0.1 and float(ref_dotdata[-1][0]-ref_dotdata[0][0])/float(len(ref_seq))>0.7 and float(alt_dotdata[-1][0]-alt_dotdata[0][0])/float(len(alt_seq))>0.7:             # <<<<<<<<<<<<<<
 *         [ref_clean_dotdata,ref_kept_segs]=clean_dotdata_m2(ref_dotdata)
 *         [alt_clean_dotdata,alt_kept_segs]=clean_dotdata_m2(alt_dotdata)
 */
  __pyx_t_6 = PyObject_Length(__pyx_v_ref_dotdata); if (unlikely(__pyx_t_6 == -1)) __PYX_ERR(0, 293, __pyx_L1_error)
  __pyx_t_9 = PyObject_Length(__pyx_v_ref_seq); if (unlikely(__pyx_t_9 == -1)) __PYX_ERR(0, 293, __pyx_L1_error)
  if (unlikely(((double)__pyx_t_9) == 0)) {
    PyErr_SetString(PyExc_ZeroDivisionError, "float division");
    __PYX_ERR(0, 293, __pyx_L1_error)
  }
  __pyx_t_10 = (((((double)__pyx_t_6) / ((double)__pyx_t_9)) > 0.1) != 0);
  if (__pyx_t_10) {
  } else {
    __pyx_t_8 = __pyx_t_10;
    goto __pyx_L4_bool_binop_done;
  }
  __pyx_t_9 = PyObject_Length(__pyx_v_alt_dotdata); if (unlikely(__pyx_t_9 == -1)) __PYX_ERR(0, 293, __pyx_L1_error)
  __pyx_t_6 = PyObject_Length(__pyx_v_alt_seq); if (unlikely(__pyx_t_6 == -1)) __PYX_ERR(0, 293, __pyx_L1_error)
  if (unlikely(((double)__pyx_t_6) == 0)) {
    PyErr_SetString(PyExc_ZeroDivisionError, "float division");
    __PYX_ERR(0, 293, __pyx_L1_error)
  }
  __pyx_t_10 = (((((double)__pyx_t_9) / ((double)__pyx_t_6)) > 0.1) != 0);
  if (__pyx_t_10) {
  } else {
    __pyx_t_8 = __pyx_t_10;
    goto __pyx_L4_bool_binop_done;
  }
  __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_ref_dotdata, -1L, long, 1, __Pyx_PyInt_From_long, 0, 1, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 293, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_GetItemInt(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 293, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_ref_dotdata, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 293, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_4 = __Pyx_GetItemInt(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 293, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = PyNumber_Subtract(__pyx_t_2, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 293, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_11 = __Pyx_PyObject_AsDouble(__pyx_t_1); if (unlikely(__pyx_t_11 == ((double)-1) && PyErr_Occurred())) __PYX_ERR(0, 293, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_6 = PyObject_Length(__pyx_v_ref_seq); if (unlikely(__pyx_t_6 == -1)) __PYX_ERR(0, 293, __pyx_L1_error)
  if (unlikely(((double)__pyx_t_6) == 0)) {
    PyErr_SetString(PyExc_ZeroDivisionError, "float division");
    __PYX_ERR(0, 293, __pyx_L1_error)
  }
  __pyx_t_10 = (((__pyx_t_11 / ((double)__pyx_t_6)) > 0.7) != 0);
  if (__pyx_t_10) {
  } else {
    __pyx_t_8 = __pyx_t_10;
    goto __pyx_L4_bool_binop_done;
  }
  __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_alt_dotdata, -1L, long, 1, __Pyx_PyInt_From_long, 0, 1, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 293, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_4 = __Pyx_GetItemInt(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 293, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_alt_dotdata, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 293, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_GetItemInt(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 293, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = PyNumber_Subtract(__pyx_t_4, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 293, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_11 = __Pyx_PyObject_AsDouble(__pyx_t_1); if (unlikely(__pyx_t_11 == ((double)-1) && PyErr_Occurred())) __PYX_ERR(0, 293, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_6 = PyObject_Length(__pyx_v_alt_seq); if (unlikely(__pyx_t_6 == -1)) __PYX_ERR(0, 293, __pyx_L1_error)
  if (unlikely(((double)__pyx_t_6) == 0)) {
    PyErr_SetString(PyExc_ZeroDivisionError, "float division");
    __PYX_ERR(0, 293, __pyx_L1_error)
  }
  __pyx_t_10 = (((__pyx_t_11 / ((double)__pyx_t_6)) > 0.7) != 0);
  __pyx_t_8 = __pyx_t_10;
  __pyx_L4_bool_binop_done:;
  if (__pyx_t_8) {

    /* "vapor_vali/Simple_function.pyx":294
 *     alt_dotdata=dotdata(window_size,x[0],alt_seq[x[1]:])
 *     if float(len(ref_dotdata))/float(len(ref_seq))>0.1 and float(len(alt_dotdata))/float(len(alt_seq))>0.1 and float(ref_dotdata[-1][0]-ref_dotdata[0][0])/float(len(ref_seq))>0.7 and float(alt_dotdata[-1][0]-alt_dotdata[0][0])/float(len(alt_seq))>0.7:
 *         [ref_clean_dotdata,ref_kept_segs]=clean_dotdata_m2(ref_dotdata)             # <<<<<<<<<<<<<<
 *         [alt_clean_dotdata,alt_kept_segs]=clean_dotdata_m2(alt_dotdata)
 *         if len(ref_clean_dotdata)>0 and len(alt_clean_dotdata)>0:
 */
    __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_clean_dotdata_m2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 294, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_4 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_2))) {
      __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_2);
      if (likely(__pyx_t_4)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
        __Pyx_INCREF(__pyx_t_4);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_2, function);
      }
    }
    if (!__pyx_t_4) {
      __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_v_ref_dotdata); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 294, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
    } else {
      __pyx_t_3 = PyTuple_New(1+1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 294, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __Pyx_GIVEREF(__pyx_t_4); PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_4); __pyx_t_4 = NULL;
      __Pyx_INCREF(__pyx_v_ref_dotdata);
      __Pyx_GIVEREF(__pyx_v_ref_dotdata);
      PyTuple_SET_ITEM(__pyx_t_3, 0+1, __pyx_v_ref_dotdata);
      __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_3, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 294, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    }
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    if ((likely(PyTuple_CheckExact(__pyx_t_1))) || (PyList_CheckExact(__pyx_t_1))) {
      PyObject* sequence = __pyx_t_1;
      #if CYTHON_COMPILING_IN_CPYTHON
      Py_ssize_t size = Py_SIZE(sequence);
      #else
      Py_ssize_t size = PySequence_Size(sequence);
      #endif
      if (unlikely(size != 2)) {
        if (size > 2) __Pyx_RaiseTooManyValuesError(2);
        else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
        __PYX_ERR(0, 294, __pyx_L1_error)
      }
      #if CYTHON_COMPILING_IN_CPYTHON
      if (likely(PyTuple_CheckExact(sequence))) {
        __pyx_t_2 = PyTuple_GET_ITEM(sequence, 0); 
        __pyx_t_3 = PyTuple_GET_ITEM(sequence, 1); 
      } else {
        __pyx_t_2 = PyList_GET_ITEM(sequence, 0); 
        __pyx_t_3 = PyList_GET_ITEM(sequence, 1); 
      }
      __Pyx_INCREF(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_3);
      #else
      __pyx_t_2 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 294, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __pyx_t_3 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 294, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      #endif
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    } else {
      Py_ssize_t index = -1;
      __pyx_t_4 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 294, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_12 = Py_TYPE(__pyx_t_4)->tp_iternext;
      index = 0; __pyx_t_2 = __pyx_t_12(__pyx_t_4); if (unlikely(!__pyx_t_2)) goto __pyx_L8_unpacking_failed;
      __Pyx_GOTREF(__pyx_t_2);
      index = 1; __pyx_t_3 = __pyx_t_12(__pyx_t_4); if (unlikely(!__pyx_t_3)) goto __pyx_L8_unpacking_failed;
      __Pyx_GOTREF(__pyx_t_3);
      if (__Pyx_IternextUnpackEndCheck(__pyx_t_12(__pyx_t_4), 2) < 0) __PYX_ERR(0, 294, __pyx_L1_error)
      __pyx_t_12 = NULL;
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      goto __pyx_L9_unpacking_done;
      __pyx_L8_unpacking_failed:;
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_12 = NULL;
      if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
      __PYX_ERR(0, 294, __pyx_L1_error)
      __pyx_L9_unpacking_done:;
    }
    __pyx_v_ref_clean_dotdata = __pyx_t_2;
    __pyx_t_2 = 0;
    __pyx_v_ref_kept_segs = __pyx_t_3;
    __pyx_t_3 = 0;

    /* "vapor_vali/Simple_function.pyx":295
 *     if float(len(ref_dotdata))/float(len(ref_seq))>0.1 and float(len(alt_dotdata))/float(len(alt_seq))>0.1 and float(ref_dotdata[-1][0]-ref_dotdata[0][0])/float(len(ref_seq))>0.7 and float(alt_dotdata[-1][0]-alt_dotdata[0][0])/float(len(alt_seq))>0.7:
 *         [ref_clean_dotdata,ref_kept_segs]=clean_dotdata_m2(ref_dotdata)
 *         [alt_clean_dotdata,alt_kept_segs]=clean_dotdata_m2(alt_dotdata)             # <<<<<<<<<<<<<<
 *         if len(ref_clean_dotdata)>0 and len(alt_clean_dotdata)>0:
 *             return [eu_dis_abs_calcu(ref_clean_dotdata),eu_dis_abs_calcu(alt_clean_dotdata)]
 */
    __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_clean_dotdata_m2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 295, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_2 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_3))) {
      __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_3);
      if (likely(__pyx_t_2)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
        __Pyx_INCREF(__pyx_t_2);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_3, function);
      }
    }
    if (!__pyx_t_2) {
      __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_v_alt_dotdata); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 295, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
    } else {
      __pyx_t_4 = PyTuple_New(1+1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 295, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      __Pyx_GIVEREF(__pyx_t_2); PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_2); __pyx_t_2 = NULL;
      __Pyx_INCREF(__pyx_v_alt_dotdata);
      __Pyx_GIVEREF(__pyx_v_alt_dotdata);
      PyTuple_SET_ITEM(__pyx_t_4, 0+1, __pyx_v_alt_dotdata);
      __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_4, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 295, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    }
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    if ((likely(PyTuple_CheckExact(__pyx_t_1))) || (PyList_CheckExact(__pyx_t_1))) {
      PyObject* sequence = __pyx_t_1;
      #if CYTHON_COMPILING_IN_CPYTHON
      Py_ssize_t size = Py_SIZE(sequence);
      #else
      Py_ssize_t size = PySequence_Size(sequence);
      #endif
      if (unlikely(size != 2)) {
        if (size > 2) __Pyx_RaiseTooManyValuesError(2);
        else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
        __PYX_ERR(0, 295, __pyx_L1_error)
      }
      #if CYTHON_COMPILING_IN_CPYTHON
      if (likely(PyTuple_CheckExact(sequence))) {
        __pyx_t_3 = PyTuple_GET_ITEM(sequence, 0); 
        __pyx_t_4 = PyTuple_GET_ITEM(sequence, 1); 
      } else {
        __pyx_t_3 = PyList_GET_ITEM(sequence, 0); 
        __pyx_t_4 = PyList_GET_ITEM(sequence, 1); 
      }
      __Pyx_INCREF(__pyx_t_3);
      __Pyx_INCREF(__pyx_t_4);
      #else
      __pyx_t_3 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 295, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __pyx_t_4 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 295, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      #endif
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    } else {
      Py_ssize_t index = -1;
      __pyx_t_2 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 295, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_12 = Py_TYPE(__pyx_t_2)->tp_iternext;
      index = 0; __pyx_t_3 = __pyx_t_12(__pyx_t_2); if (unlikely(!__pyx_t_3)) goto __pyx_L10_unpacking_failed;
      __Pyx_GOTREF(__pyx_t_3);
      index = 1; __pyx_t_4 = __pyx_t_12(__pyx_t_2); if (unlikely(!__pyx_t_4)) goto __pyx_L10_unpacking_failed;
      __Pyx_GOTREF(__pyx_t_4);
      if (__Pyx_IternextUnpackEndCheck(__pyx_t_12(__pyx_t_2), 2) < 0) __PYX_ERR(0, 295, __pyx_L1_error)
      __pyx_t_12 = NULL;
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      goto __pyx_L11_unpacking_done;
      __pyx_L10_unpacking_failed:;
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_12 = NULL;
      if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
      __PYX_ERR(0, 295, __pyx_L1_error)
      __pyx_L11_unpacking_done:;
    }
    __pyx_v_alt_clean_dotdata = __pyx_t_3;
    __pyx_t_3 = 0;
    __pyx_v_alt_kept_segs = __pyx_t_4;
    __pyx_t_4 = 0;

    /* "vapor_vali/Simple_function.pyx":296
 *         [ref_clean_dotdata,ref_kept_segs]=clean_dotdata_m2(ref_dotdata)
 *         [alt_clean_dotdata,alt_kept_segs]=clean_dotdata_m2(alt_dotdata)
 *         if len(ref_clean_dotdata)>0 and len(alt_clean_dotdata)>0:             # <<<<<<<<<<<<<<
 *             return [eu_dis_abs_calcu(ref_clean_dotdata),eu_dis_abs_calcu(alt_clean_dotdata)]
 *         else:
 */
    __pyx_t_6 = PyObject_Length(__pyx_v_ref_clean_dotdata); if (unlikely(__pyx_t_6 == -1)) __PYX_ERR(0, 296, __pyx_L1_error)
    __pyx_t_10 = ((__pyx_t_6 > 0) != 0);
    if (__pyx_t_10) {
    } else {
      __pyx_t_8 = __pyx_t_10;
      goto __pyx_L13_bool_binop_done;
    }
    __pyx_t_6 = PyObject_Length(__pyx_v_alt_clean_dotdata); if (unlikely(__pyx_t_6 == -1)) __PYX_ERR(0, 296, __pyx_L1_error)
    __pyx_t_10 = ((__pyx_t_6 > 0) != 0);
    __pyx_t_8 = __pyx_t_10;
    __pyx_L13_bool_binop_done:;
    if (__pyx_t_8) {

      /* "vapor_vali/Simple_function.pyx":297
 *         [alt_clean_dotdata,alt_kept_segs]=clean_dotdata_m2(alt_dotdata)
 *         if len(ref_clean_dotdata)>0 and len(alt_clean_dotdata)>0:
 *             return [eu_dis_abs_calcu(ref_clean_dotdata),eu_dis_abs_calcu(alt_clean_dotdata)]             # <<<<<<<<<<<<<<
 *         else:
 *             return [0,0]
 */
      __Pyx_XDECREF(__pyx_r);
      __pyx_t_4 = __Pyx_GetModuleGlobalName(__pyx_n_s_eu_dis_abs_calcu); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 297, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_t_3 = NULL;
      if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_4))) {
        __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_4);
        if (likely(__pyx_t_3)) {
          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
          __Pyx_INCREF(__pyx_t_3);
          __Pyx_INCREF(function);
          __Pyx_DECREF_SET(__pyx_t_4, function);
        }
      }
      if (!__pyx_t_3) {
        __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_v_ref_clean_dotdata); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 297, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
      } else {
        __pyx_t_2 = PyTuple_New(1+1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 297, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
        __Pyx_GIVEREF(__pyx_t_3); PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_3); __pyx_t_3 = NULL;
        __Pyx_INCREF(__pyx_v_ref_clean_dotdata);
        __Pyx_GIVEREF(__pyx_v_ref_clean_dotdata);
        PyTuple_SET_ITEM(__pyx_t_2, 0+1, __pyx_v_ref_clean_dotdata);
        __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_2, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 297, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      }
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_eu_dis_abs_calcu); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 297, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __pyx_t_3 = NULL;
      if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_2))) {
        __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
        if (likely(__pyx_t_3)) {
          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
          __Pyx_INCREF(__pyx_t_3);
          __Pyx_INCREF(function);
          __Pyx_DECREF_SET(__pyx_t_2, function);
        }
      }
      if (!__pyx_t_3) {
        __pyx_t_4 = __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_v_alt_clean_dotdata); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 297, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_4);
      } else {
        __pyx_t_7 = PyTuple_New(1+1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 297, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_7);
        __Pyx_GIVEREF(__pyx_t_3); PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_3); __pyx_t_3 = NULL;
        __Pyx_INCREF(__pyx_v_alt_clean_dotdata);
        __Pyx_GIVEREF(__pyx_v_alt_clean_dotdata);
        PyTuple_SET_ITEM(__pyx_t_7, 0+1, __pyx_v_alt_clean_dotdata);
        __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_7, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 297, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_4);
        __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
      }
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_2 = PyList_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 297, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __Pyx_GIVEREF(__pyx_t_1);
      PyList_SET_ITEM(__pyx_t_2, 0, __pyx_t_1);
      __Pyx_GIVEREF(__pyx_t_4);
      PyList_SET_ITEM(__pyx_t_2, 1, __pyx_t_4);
      __pyx_t_1 = 0;
      __pyx_t_4 = 0;
      __pyx_r = __pyx_t_2;
      __pyx_t_2 = 0;
      goto __pyx_L0;

      /* "vapor_vali/Simple_function.pyx":296
 *         [ref_clean_dotdata,ref_kept_segs]=clean_dotdata_m2(ref_dotdata)
 *         [alt_clean_dotdata,alt_kept_segs]=clean_dotdata_m2(alt_dotdata)
 *         if len(ref_clean_dotdata)>0 and len(alt_clean_dotdata)>0:             # <<<<<<<<<<<<<<
 *             return [eu_dis_abs_calcu(ref_clean_dotdata),eu_dis_abs_calcu(alt_clean_dotdata)]
 *         else:
 */
    }

    /* "vapor_vali/Simple_function.pyx":299
 *             return [eu_dis_abs_calcu(ref_clean_dotdata),eu_dis_abs_calcu(alt_clean_dotdata)]
 *         else:
 *             return [0,0]             # <<<<<<<<<<<<<<
 *     else:
 *         return [0,0]
 */
    /*else*/ {
      __Pyx_XDECREF(__pyx_r);
      __pyx_t_2 = PyList_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 299, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __Pyx_INCREF(__pyx_int_0);
      __Pyx_GIVEREF(__pyx_int_0);
      PyList_SET_ITEM(__pyx_t_2, 0, __pyx_int_0);
      __Pyx_INCREF(__pyx_int_0);
      __Pyx_GIVEREF(__pyx_int_0);
      PyList_SET_ITEM(__pyx_t_2, 1, __pyx_int_0);
      __pyx_r = __pyx_t_2;
      __pyx_t_2 = 0;
      goto __pyx_L0;
    }

    /* "vapor_vali/Simple_function.pyx":293
 *     ref_dotdata=dotdata(window_size,x[0],ref_seq[x[1]:])
 *     alt_dotdata=dotdata(window_size,x[0],alt_seq[x[1]:])
 *     if float(len(ref_dotdata))/float(len(ref_seq))>0.1 and float(len(alt_dotdata))/float(len(alt_seq))>0.1 and float(ref_dotdata[-1][0]-ref_dotdata[0][0])/float(len(ref_seq))>0.7 and float(alt_dotdata[-1][0]-alt_dotdata[0][0])/float(len(alt_seq))>0.7:             # <<<<<<<<<<<<<<
 *         [ref_clean_dotdata,ref_kept_segs]=clean_dotdata_m2(ref_dotdata)
 *         [alt_clean_dotdata,alt_kept_segs]=clean_dotdata_m2(alt_dotdata)
 */
  }

  /* "vapor_vali/Simple_function.pyx":301
 *             return [0,0]
 *     else:
 *         return [0,0]             # <<<<<<<<<<<<<<
 * 
 * def cigar2alignstart_by_pos(cigar,align_start,start,end):
 */
  /*else*/ {
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = PyList_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 301, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_INCREF(__pyx_int_0);
    __Pyx_GIVEREF(__pyx_int_0);
    PyList_SET_ITEM(__pyx_t_2, 0, __pyx_int_0);
    __Pyx_INCREF(__pyx_int_0);
    __Pyx_GIVEREF(__pyx_int_0);
    PyList_SET_ITEM(__pyx_t_2, 1, __pyx_int_0);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;
  }

  /* "vapor_vali/Simple_function.pyx":290
 *         return [0,0]
 * 
 * def calcu_vapor_single_read_score_abs_dis_m2(ref_seq,alt_seq,x,window_size):             # <<<<<<<<<<<<<<
 *     ref_dotdata=dotdata(window_size,x[0],ref_seq[x[1]:])
 *     alt_dotdata=dotdata(window_size,x[0],alt_seq[x[1]:])
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_7);
  __Pyx_AddTraceback("vapor_vali.Simple_function.calcu_vapor_single_read_score_abs_dis_m2", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_ref_dotdata);
  __Pyx_XDECREF(__pyx_v_alt_dotdata);
  __Pyx_XDECREF(__pyx_v_ref_clean_dotdata);
  __Pyx_XDECREF(__pyx_v_ref_kept_segs);
  __Pyx_XDECREF(__pyx_v_alt_clean_dotdata);
  __Pyx_XDECREF(__pyx_v_alt_kept_segs);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "vapor_vali/Simple_function.pyx":303
 *         return [0,0]
 * 
 * def cigar2alignstart_by_pos(cigar,align_start,start,end):             # <<<<<<<<<<<<<<
 *     #eg cigar2alignstart(pbam[5],int(pbam[3]),bps)
 *     import re
 */

/* Python wrapper */
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_33cigar2alignstart_by_pos(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_10vapor_vali_15Simple_function_33cigar2alignstart_by_pos = {"cigar2alignstart_by_pos", (PyCFunction)__pyx_pw_10vapor_vali_15Simple_function_33cigar2alignstart_by_pos, METH_VARARGS|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_33cigar2alignstart_by_pos(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_cigar = 0;
  PyObject *__pyx_v_align_start = 0;
  PyObject *__pyx_v_start = 0;
  CYTHON_UNUSED PyObject *__pyx_v_end = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("cigar2alignstart_by_pos (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_cigar,&__pyx_n_s_align_start,&__pyx_n_s_start,&__pyx_n_s_end,0};
    PyObject* values[4] = {0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
      switch (pos_args) {
        case  4: values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
        case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_cigar)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_align_start)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("cigar2alignstart_by_pos", 1, 4, 4, 1); __PYX_ERR(0, 303, __pyx_L3_error)
        }
        case  2:
        if (likely((values[2] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_start)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("cigar2alignstart_by_pos", 1, 4, 4, 2); __PYX_ERR(0, 303, __pyx_L3_error)
        }
        case  3:
        if (likely((values[3] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_end)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("cigar2alignstart_by_pos", 1, 4, 4, 3); __PYX_ERR(0, 303, __pyx_L3_error)
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "cigar2alignstart_by_pos") < 0)) __PYX_ERR(0, 303, __pyx_L3_error)
      }
    } else if (PyTuple_GET_SIZE(__pyx_args) != 4) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
      values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
    }
    __pyx_v_cigar = values[0];
    __pyx_v_align_start = values[1];
    __pyx_v_start = values[2];
    __pyx_v_end = values[3];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("cigar2alignstart_by_pos", 1, 4, 4, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 303, __pyx_L3_error)
  __pyx_L3_error:;
  __Pyx_AddTraceback("vapor_vali.Simple_function.cigar2alignstart_by_pos", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_10vapor_vali_15Simple_function_32cigar2alignstart_by_pos(__pyx_self, __pyx_v_cigar, __pyx_v_align_start, __pyx_v_start, __pyx_v_end);

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10vapor_vali_15Simple_function_32cigar2alignstart_by_pos(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_cigar, PyObject *__pyx_v_align_start, PyObject *__pyx_v_start, CYTHON_UNUSED PyObject *__pyx_v_end) {
  PyObject *__pyx_v_re = NULL;
  PyObject *__pyx_v_pcigar = NULL;
  PyObject *__pyx_v_cigars = NULL;
  PyObject *__pyx_v_m = NULL;
  PyObject *__pyx_v_read_rec = NULL;
  PyObject *__pyx_v_align_rec = NULL;
  PyObject *__pyx_v_cigar_record = NULL;
  PyObject *__pyx_v_x = NULL;
  PyObject *__pyx_v_start_dis = NULL;
  PyObject *__pyx_v_new_read_rec = NULL;
  long __pyx_v_new_start_dis;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  Py_ssize_t __pyx_t_5;
  PyObject *(*__pyx_t_6)(PyObject *);
  PyObject *__pyx_t_7 = NULL;
  int __pyx_t_8;
  int __pyx_t_9;
  __Pyx_RefNannySetupContext("cigar2alignstart_by_pos", 0);

  /* "vapor_vali/Simple_function.pyx":305
 * def cigar2alignstart_by_pos(cigar,align_start,start,end):
 *     #eg cigar2alignstart(pbam[5],int(pbam[3]),bps)
 *     import re             # <<<<<<<<<<<<<<
 *     pcigar=re.compile(r'''(\d+)([MIDNSHP=X])''')
 *     cigars=[]
 */
  __pyx_t_1 = __Pyx_Import(__pyx_n_s_re, 0, -1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 305, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_re = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":306
 *     #eg cigar2alignstart(pbam[5],int(pbam[3]),bps)
 *     import re
 *     pcigar=re.compile(r'''(\d+)([MIDNSHP=X])''')             # <<<<<<<<<<<<<<
 *     cigars=[]
 *     for m in pcigar.finditer(cigar):
 */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_re, __pyx_n_s_compile); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 306, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_tuple__23, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 306, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_pcigar = __pyx_t_2;
  __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":307
 *     import re
 *     pcigar=re.compile(r'''(\d+)([MIDNSHP=X])''')
 *     cigars=[]             # <<<<<<<<<<<<<<
 *     for m in pcigar.finditer(cigar):
 *         cigars.append((m.groups()[0],m.groups()[1]))
 */
  __pyx_t_2 = PyList_New(0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 307, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_v_cigars = ((PyObject*)__pyx_t_2);
  __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":308
 *     pcigar=re.compile(r'''(\d+)([MIDNSHP=X])''')
 *     cigars=[]
 *     for m in pcigar.finditer(cigar):             # <<<<<<<<<<<<<<
 *         cigars.append((m.groups()[0],m.groups()[1]))
 *     read_rec=0
 */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_pcigar, __pyx_n_s_finditer); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 308, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_3 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_1))) {
    __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_1);
    if (likely(__pyx_t_3)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
      __Pyx_INCREF(__pyx_t_3);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_1, function);
    }
  }
  if (!__pyx_t_3) {
    __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_v_cigar); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 308, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
  } else {
    __pyx_t_4 = PyTuple_New(1+1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 308, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_GIVEREF(__pyx_t_3); PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3); __pyx_t_3 = NULL;
    __Pyx_INCREF(__pyx_v_cigar);
    __Pyx_GIVEREF(__pyx_v_cigar);
    PyTuple_SET_ITEM(__pyx_t_4, 0+1, __pyx_v_cigar);
    __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_4, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 308, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  }
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  if (likely(PyList_CheckExact(__pyx_t_2)) || PyTuple_CheckExact(__pyx_t_2)) {
    __pyx_t_1 = __pyx_t_2; __Pyx_INCREF(__pyx_t_1); __pyx_t_5 = 0;
    __pyx_t_6 = NULL;
  } else {
    __pyx_t_5 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 308, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_6 = Py_TYPE(__pyx_t_1)->tp_iternext; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 308, __pyx_L1_error)
  }
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  for (;;) {
    if (likely(!__pyx_t_6)) {
      if (likely(PyList_CheckExact(__pyx_t_1))) {
        if (__pyx_t_5 >= PyList_GET_SIZE(__pyx_t_1)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_2 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_5); __Pyx_INCREF(__pyx_t_2); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 308, __pyx_L1_error)
        #else
        __pyx_t_2 = PySequence_ITEM(__pyx_t_1, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 308, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
        #endif
      } else {
        if (__pyx_t_5 >= PyTuple_GET_SIZE(__pyx_t_1)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_2 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_5); __Pyx_INCREF(__pyx_t_2); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 308, __pyx_L1_error)
        #else
        __pyx_t_2 = PySequence_ITEM(__pyx_t_1, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 308, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
        #endif
      }
    } else {
      __pyx_t_2 = __pyx_t_6(__pyx_t_1);
      if (unlikely(!__pyx_t_2)) {
        PyObject* exc_type = PyErr_Occurred();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
          else __PYX_ERR(0, 308, __pyx_L1_error)
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_2);
    }
    __Pyx_XDECREF_SET(__pyx_v_m, __pyx_t_2);
    __pyx_t_2 = 0;

    /* "vapor_vali/Simple_function.pyx":309
 *     cigars=[]
 *     for m in pcigar.finditer(cigar):
 *         cigars.append((m.groups()[0],m.groups()[1]))             # <<<<<<<<<<<<<<
 *     read_rec=0
 *     align_rec=align_start
 */
    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_m, __pyx_n_s_groups); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 309, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_3 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_4))) {
      __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_4);
      if (likely(__pyx_t_3)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
        __Pyx_INCREF(__pyx_t_3);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_4, function);
      }
    }
    if (__pyx_t_3) {
      __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 309, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    } else {
      __pyx_t_2 = __Pyx_PyObject_CallNoArg(__pyx_t_4); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 309, __pyx_L1_error)
    }
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = __Pyx_GetItemInt(__pyx_t_2, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 309, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_m, __pyx_n_s_groups); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 309, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_7 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_3))) {
      __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_3);
      if (likely(__pyx_t_7)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
        __Pyx_INCREF(__pyx_t_7);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_3, function);
      }
    }
    if (__pyx_t_7) {
      __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_7); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 309, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
    } else {
      __pyx_t_2 = __Pyx_PyObject_CallNoArg(__pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 309, __pyx_L1_error)
    }
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = __Pyx_GetItemInt(__pyx_t_2, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 309, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 309, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_GIVEREF(__pyx_t_4);
    PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_4);
    __Pyx_GIVEREF(__pyx_t_3);
    PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_t_3);
    __pyx_t_4 = 0;
    __pyx_t_3 = 0;
    __pyx_t_8 = __Pyx_PyList_Append(__pyx_v_cigars, __pyx_t_2); if (unlikely(__pyx_t_8 == -1)) __PYX_ERR(0, 309, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

    /* "vapor_vali/Simple_function.pyx":308
 *     pcigar=re.compile(r'''(\d+)([MIDNSHP=X])''')
 *     cigars=[]
 *     for m in pcigar.finditer(cigar):             # <<<<<<<<<<<<<<
 *         cigars.append((m.groups()[0],m.groups()[1]))
 *     read_rec=0
 */
  }
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":310
 *     for m in pcigar.finditer(cigar):
 *         cigars.append((m.groups()[0],m.groups()[1]))
 *     read_rec=0             # <<<<<<<<<<<<<<
 *     align_rec=align_start
 *     cigar_record=''
 */
  __Pyx_INCREF(__pyx_int_0);
  __pyx_v_read_rec = __pyx_int_0;

  /* "vapor_vali/Simple_function.pyx":311
 *         cigars.append((m.groups()[0],m.groups()[1]))
 *     read_rec=0
 *     align_rec=align_start             # <<<<<<<<<<<<<<
 *     cigar_record=''
 *     for x in cigars:
 */
  __Pyx_INCREF(__pyx_v_align_start);
  __pyx_v_align_rec = __pyx_v_align_start;

  /* "vapor_vali/Simple_function.pyx":312
 *     read_rec=0
 *     align_rec=align_start
 *     cigar_record=''             # <<<<<<<<<<<<<<
 *     for x in cigars:
 *         if x[1]=='S':
 */
  __Pyx_INCREF(__pyx_kp_s__24);
  __pyx_v_cigar_record = __pyx_kp_s__24;

  /* "vapor_vali/Simple_function.pyx":313
 *     align_rec=align_start
 *     cigar_record=''
 *     for x in cigars:             # <<<<<<<<<<<<<<
 *         if x[1]=='S':
 *             read_rec+=int(x[0])
 */
  __pyx_t_1 = __pyx_v_cigars; __Pyx_INCREF(__pyx_t_1); __pyx_t_5 = 0;
  for (;;) {
    if (__pyx_t_5 >= PyList_GET_SIZE(__pyx_t_1)) break;
    #if CYTHON_COMPILING_IN_CPYTHON
    __pyx_t_2 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_5); __Pyx_INCREF(__pyx_t_2); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 313, __pyx_L1_error)
    #else
    __pyx_t_2 = PySequence_ITEM(__pyx_t_1, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 313, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    #endif
    __Pyx_XDECREF_SET(__pyx_v_x, __pyx_t_2);
    __pyx_t_2 = 0;

    /* "vapor_vali/Simple_function.pyx":314
 *     cigar_record=''
 *     for x in cigars:
 *         if x[1]=='S':             # <<<<<<<<<<<<<<
 *             read_rec+=int(x[0])
 *         if x[1]=='M':
 */
    __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_x, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 314, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_9 = (__Pyx_PyString_Equals(__pyx_t_2, __pyx_n_s_S, Py_EQ)); if (unlikely(__pyx_t_9 < 0)) __PYX_ERR(0, 314, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    if (__pyx_t_9) {

      /* "vapor_vali/Simple_function.pyx":315
 *     for x in cigars:
 *         if x[1]=='S':
 *             read_rec+=int(x[0])             # <<<<<<<<<<<<<<
 *         if x[1]=='M':
 *             read_rec+=int(x[0])
 */
      __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_x, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 315, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __pyx_t_3 = __Pyx_PyNumber_Int(__pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 315, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_2 = PyNumber_InPlaceAdd(__pyx_v_read_rec, __pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 315, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      __Pyx_DECREF_SET(__pyx_v_read_rec, __pyx_t_2);
      __pyx_t_2 = 0;

      /* "vapor_vali/Simple_function.pyx":314
 *     cigar_record=''
 *     for x in cigars:
 *         if x[1]=='S':             # <<<<<<<<<<<<<<
 *             read_rec+=int(x[0])
 *         if x[1]=='M':
 */
    }

    /* "vapor_vali/Simple_function.pyx":316
 *         if x[1]=='S':
 *             read_rec+=int(x[0])
 *         if x[1]=='M':             # <<<<<<<<<<<<<<
 *             read_rec+=int(x[0])
 *             align_rec+=int(x[0])
 */
    __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_x, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 316, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_9 = (__Pyx_PyString_Equals(__pyx_t_2, __pyx_n_s_M, Py_EQ)); if (unlikely(__pyx_t_9 < 0)) __PYX_ERR(0, 316, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    if (__pyx_t_9) {

      /* "vapor_vali/Simple_function.pyx":317
 *             read_rec+=int(x[0])
 *         if x[1]=='M':
 *             read_rec+=int(x[0])             # <<<<<<<<<<<<<<
 *             align_rec+=int(x[0])
 *         if x[1]=='D':
 */
      __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_x, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 317, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __pyx_t_3 = __Pyx_PyNumber_Int(__pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 317, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_2 = PyNumber_InPlaceAdd(__pyx_v_read_rec, __pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 317, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      __Pyx_DECREF_SET(__pyx_v_read_rec, __pyx_t_2);
      __pyx_t_2 = 0;

      /* "vapor_vali/Simple_function.pyx":318
 *         if x[1]=='M':
 *             read_rec+=int(x[0])
 *             align_rec+=int(x[0])             # <<<<<<<<<<<<<<
 *         if x[1]=='D':
 *             align_rec+=int(x[0])
 */
      __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_x, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 318, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __pyx_t_3 = __Pyx_PyNumber_Int(__pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 318, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_2 = PyNumber_InPlaceAdd(__pyx_v_align_rec, __pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 318, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      __Pyx_DECREF_SET(__pyx_v_align_rec, __pyx_t_2);
      __pyx_t_2 = 0;

      /* "vapor_vali/Simple_function.pyx":316
 *         if x[1]=='S':
 *             read_rec+=int(x[0])
 *         if x[1]=='M':             # <<<<<<<<<<<<<<
 *             read_rec+=int(x[0])
 *             align_rec+=int(x[0])
 */
    }

    /* "vapor_vali/Simple_function.pyx":319
 *             read_rec+=int(x[0])
 *             align_rec+=int(x[0])
 *         if x[1]=='D':             # <<<<<<<<<<<<<<
 *             align_rec+=int(x[0])
 *         if x[1]=='I':
 */
    __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_x, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 319, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_9 = (__Pyx_PyString_Equals(__pyx_t_2, __pyx_n_s_D, Py_EQ)); if (unlikely(__pyx_t_9 < 0)) __PYX_ERR(0, 319, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    if (__pyx_t_9) {

      /* "vapor_vali/Simple_function.pyx":320
 *             align_rec+=int(x[0])
 *         if x[1]=='D':
 *             align_rec+=int(x[0])             # <<<<<<<<<<<<<<
 *         if x[1]=='I':
 *             read_rec+=int(x[0])
 */
      __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_x, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 320, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __pyx_t_3 = __Pyx_PyNumber_Int(__pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 320, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_2 = PyNumber_InPlaceAdd(__pyx_v_align_rec, __pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 320, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      __Pyx_DECREF_SET(__pyx_v_align_rec, __pyx_t_2);
      __pyx_t_2 = 0;

      /* "vapor_vali/Simple_function.pyx":319
 *             read_rec+=int(x[0])
 *             align_rec+=int(x[0])
 *         if x[1]=='D':             # <<<<<<<<<<<<<<
 *             align_rec+=int(x[0])
 *         if x[1]=='I':
 */
    }

    /* "vapor_vali/Simple_function.pyx":321
 *         if x[1]=='D':
 *             align_rec+=int(x[0])
 *         if x[1]=='I':             # <<<<<<<<<<<<<<
 *             read_rec+=int(x[0])
 *         cigar_record=x
 */
    __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_x, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 321, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_9 = (__Pyx_PyString_Equals(__pyx_t_2, __pyx_n_s_I, Py_EQ)); if (unlikely(__pyx_t_9 < 0)) __PYX_ERR(0, 321, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    if (__pyx_t_9) {

      /* "vapor_vali/Simple_function.pyx":322
 *             align_rec+=int(x[0])
 *         if x[1]=='I':
 *             read_rec+=int(x[0])             # <<<<<<<<<<<<<<
 *         cigar_record=x
 *         if align_rec>start-1: break
 */
      __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_x, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 322, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __pyx_t_3 = __Pyx_PyNumber_Int(__pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 322, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_2 = PyNumber_InPlaceAdd(__pyx_v_read_rec, __pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 322, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      __Pyx_DECREF_SET(__pyx_v_read_rec, __pyx_t_2);
      __pyx_t_2 = 0;

      /* "vapor_vali/Simple_function.pyx":321
 *         if x[1]=='D':
 *             align_rec+=int(x[0])
 *         if x[1]=='I':             # <<<<<<<<<<<<<<
 *             read_rec+=int(x[0])
 *         cigar_record=x
 */
    }

    /* "vapor_vali/Simple_function.pyx":323
 *         if x[1]=='I':
 *             read_rec+=int(x[0])
 *         cigar_record=x             # <<<<<<<<<<<<<<
 *         if align_rec>start-1: break
 *     start_dis=int(align_rec)-start
 */
    __Pyx_INCREF(__pyx_v_x);
    __Pyx_DECREF_SET(__pyx_v_cigar_record, __pyx_v_x);

    /* "vapor_vali/Simple_function.pyx":324
 *             read_rec+=int(x[0])
 *         cigar_record=x
 *         if align_rec>start-1: break             # <<<<<<<<<<<<<<
 *     start_dis=int(align_rec)-start
 *     if cigar_record[1]=='M':
 */
    __pyx_t_2 = __Pyx_PyInt_SubtractObjC(__pyx_v_start, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 324, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_3 = PyObject_RichCompare(__pyx_v_align_rec, __pyx_t_2, Py_GT); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 324, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_9 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_9 < 0)) __PYX_ERR(0, 324, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    if (__pyx_t_9) {
      goto __pyx_L6_break;
    }

    /* "vapor_vali/Simple_function.pyx":313
 *     align_rec=align_start
 *     cigar_record=''
 *     for x in cigars:             # <<<<<<<<<<<<<<
 *         if x[1]=='S':
 *             read_rec+=int(x[0])
 */
  }
  __pyx_L6_break:;
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":325
 *         cigar_record=x
 *         if align_rec>start-1: break
 *     start_dis=int(align_rec)-start             # <<<<<<<<<<<<<<
 *     if cigar_record[1]=='M':
 *         new_read_rec=read_rec-start_dis
 */
  __pyx_t_1 = __Pyx_PyNumber_Int(__pyx_v_align_rec); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 325, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_3 = PyNumber_Subtract(__pyx_t_1, __pyx_v_start); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 325, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_start_dis = __pyx_t_3;
  __pyx_t_3 = 0;

  /* "vapor_vali/Simple_function.pyx":326
 *         if align_rec>start-1: break
 *     start_dis=int(align_rec)-start
 *     if cigar_record[1]=='M':             # <<<<<<<<<<<<<<
 *         new_read_rec=read_rec-start_dis
 *         new_start_dis=0
 */
  __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_cigar_record, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 326, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_9 = (__Pyx_PyString_Equals(__pyx_t_3, __pyx_n_s_M, Py_EQ)); if (unlikely(__pyx_t_9 < 0)) __PYX_ERR(0, 326, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  if (__pyx_t_9) {

    /* "vapor_vali/Simple_function.pyx":327
 *     start_dis=int(align_rec)-start
 *     if cigar_record[1]=='M':
 *         new_read_rec=read_rec-start_dis             # <<<<<<<<<<<<<<
 *         new_start_dis=0
 *         return [new_read_rec,new_start_dis]
 */
    __pyx_t_3 = PyNumber_Subtract(__pyx_v_read_rec, __pyx_v_start_dis); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 327, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_v_new_read_rec = __pyx_t_3;
    __pyx_t_3 = 0;

    /* "vapor_vali/Simple_function.pyx":328
 *     if cigar_record[1]=='M':
 *         new_read_rec=read_rec-start_dis
 *         new_start_dis=0             # <<<<<<<<<<<<<<
 *         return [new_read_rec,new_start_dis]
 *     else:
 */
    __pyx_v_new_start_dis = 0;

    /* "vapor_vali/Simple_function.pyx":329
 *         new_read_rec=read_rec-start_dis
 *         new_start_dis=0
 *         return [new_read_rec,new_start_dis]             # <<<<<<<<<<<<<<
 *     else:
 *         return [read_rec,start_dis]
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_3 = __Pyx_PyInt_From_long(__pyx_v_new_start_dis); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 329, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_1 = PyList_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 329, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_INCREF(__pyx_v_new_read_rec);
    __Pyx_GIVEREF(__pyx_v_new_read_rec);
    PyList_SET_ITEM(__pyx_t_1, 0, __pyx_v_new_read_rec);
    __Pyx_GIVEREF(__pyx_t_3);
    PyList_SET_ITEM(__pyx_t_1, 1, __pyx_t_3);
    __pyx_t_3 = 0;
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "vapor_vali/Simple_function.pyx":326
 *         if align_rec>start-1: break
 *     start_dis=int(align_rec)-start
 *     if cigar_record[1]=='M':             # <<<<<<<<<<<<<<
 *         new_read_rec=read_rec-start_dis
 *         new_start_dis=0
 */
  }

  /* "vapor_vali/Simple_function.pyx":331
 *         return [new_read_rec,new_start_dis]
 *     else:
 *         return [read_rec,start_dis]             # <<<<<<<<<<<<<<
 * 
 * def chop_pacbio_read_by_pos(bam_in_new,chrom,start,end,flank_length):
 */
  /*else*/ {
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = PyList_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 331, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_INCREF(__pyx_v_read_rec);
    __Pyx_GIVEREF(__pyx_v_read_rec);
    PyList_SET_ITEM(__pyx_t_1, 0, __pyx_v_read_rec);
    __Pyx_INCREF(__pyx_v_start_dis);
    __Pyx_GIVEREF(__pyx_v_start_dis);
    PyList_SET_ITEM(__pyx_t_1, 1, __pyx_v_start_dis);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;
  }

  /* "vapor_vali/Simple_function.pyx":303
 *         return [0,0]
 * 
 * def cigar2alignstart_by_pos(cigar,align_start,start,end):             # <<<<<<<<<<<<<<
 *     #eg cigar2alignstart(pbam[5],int(pbam[3]),bps)
 *     import re
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_7);
  __Pyx_AddTraceback("vapor_vali.Simple_function.cigar2alignstart_by_pos", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_re);
  __Pyx_XDECREF(__pyx_v_pcigar);
  __Pyx_XDECREF(__pyx_v_cigars);
  __Pyx_XDECREF(__pyx_v_m);
  __Pyx_XDECREF(__pyx_v_read_rec);
  __Pyx_XDECREF(__pyx_v_align_rec);
  __Pyx_XDECREF(__pyx_v_cigar_record);
  __Pyx_XDECREF(__pyx_v_x);
  __Pyx_XDECREF(__pyx_v_start_dis);
  __Pyx_XDECREF(__pyx_v_new_read_rec);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "vapor_vali/Simple_function.pyx":333
 *         return [read_rec,start_dis]
 * 
 * def chop_pacbio_read_by_pos(bam_in_new,chrom,start,end,flank_length):             # <<<<<<<<<<<<<<
 *     fbam=os.popen(r'''samtools view %s %s:%d-%d'''%(bam_in_new,chrom,start,end))
 *     out=[]
 */

/* Python wrapper */
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_35chop_pacbio_read_by_pos(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_10vapor_vali_15Simple_function_35chop_pacbio_read_by_pos = {"chop_pacbio_read_by_pos", (PyCFunction)__pyx_pw_10vapor_vali_15Simple_function_35chop_pacbio_read_by_pos, METH_VARARGS|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_35chop_pacbio_read_by_pos(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_bam_in_new = 0;
  PyObject *__pyx_v_chrom = 0;
  PyObject *__pyx_v_start = 0;
  PyObject *__pyx_v_end = 0;
  PyObject *__pyx_v_flank_length = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("chop_pacbio_read_by_pos (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_bam_in_new,&__pyx_n_s_chrom,&__pyx_n_s_start,&__pyx_n_s_end,&__pyx_n_s_flank_length,0};
    PyObject* values[5] = {0,0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
      switch (pos_args) {
        case  5: values[4] = PyTuple_GET_ITEM(__pyx_args, 4);
        case  4: values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
        case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_bam_in_new)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_chrom)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("chop_pacbio_read_by_pos", 1, 5, 5, 1); __PYX_ERR(0, 333, __pyx_L3_error)
        }
        case  2:
        if (likely((values[2] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_start)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("chop_pacbio_read_by_pos", 1, 5, 5, 2); __PYX_ERR(0, 333, __pyx_L3_error)
        }
        case  3:
        if (likely((values[3] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_end)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("chop_pacbio_read_by_pos", 1, 5, 5, 3); __PYX_ERR(0, 333, __pyx_L3_error)
        }
        case  4:
        if (likely((values[4] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_flank_length)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("chop_pacbio_read_by_pos", 1, 5, 5, 4); __PYX_ERR(0, 333, __pyx_L3_error)
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "chop_pacbio_read_by_pos") < 0)) __PYX_ERR(0, 333, __pyx_L3_error)
      }
    } else if (PyTuple_GET_SIZE(__pyx_args) != 5) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
      values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
      values[4] = PyTuple_GET_ITEM(__pyx_args, 4);
    }
    __pyx_v_bam_in_new = values[0];
    __pyx_v_chrom = values[1];
    __pyx_v_start = values[2];
    __pyx_v_end = values[3];
    __pyx_v_flank_length = values[4];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("chop_pacbio_read_by_pos", 1, 5, 5, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 333, __pyx_L3_error)
  __pyx_L3_error:;
  __Pyx_AddTraceback("vapor_vali.Simple_function.chop_pacbio_read_by_pos", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_10vapor_vali_15Simple_function_34chop_pacbio_read_by_pos(__pyx_self, __pyx_v_bam_in_new, __pyx_v_chrom, __pyx_v_start, __pyx_v_end, __pyx_v_flank_length);

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10vapor_vali_15Simple_function_34chop_pacbio_read_by_pos(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_bam_in_new, PyObject *__pyx_v_chrom, PyObject *__pyx_v_start, PyObject *__pyx_v_end, PyObject *__pyx_v_flank_length) {
  PyObject *__pyx_v_fbam = NULL;
  PyObject *__pyx_v_out = NULL;
  PyObject *__pyx_v_line = NULL;
  PyObject *__pyx_v_pbam = NULL;
  PyObject *__pyx_v_align_info = NULL;
  PyObject *__pyx_v_align_start = NULL;
  PyObject *__pyx_v_miss_bp = NULL;
  PyObject *__pyx_v_target_read = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  Py_ssize_t __pyx_t_6;
  PyObject *(*__pyx_t_7)(PyObject *);
  int __pyx_t_8;
  int __pyx_t_9;
  PyObject *__pyx_t_10 = NULL;
  Py_ssize_t __pyx_t_11;
  PyObject *__pyx_t_12 = NULL;
  int __pyx_t_13;
  __Pyx_RefNannySetupContext("chop_pacbio_read_by_pos", 0);

  /* "vapor_vali/Simple_function.pyx":334
 * 
 * def chop_pacbio_read_by_pos(bam_in_new,chrom,start,end,flank_length):
 *     fbam=os.popen(r'''samtools view %s %s:%d-%d'''%(bam_in_new,chrom,start,end))             # <<<<<<<<<<<<<<
 *     out=[]
 *     for line in fbam:
 */
  __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_os); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 334, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_popen); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 334, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = PyTuple_New(4); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 334, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_INCREF(__pyx_v_bam_in_new);
  __Pyx_GIVEREF(__pyx_v_bam_in_new);
  PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_v_bam_in_new);
  __Pyx_INCREF(__pyx_v_chrom);
  __Pyx_GIVEREF(__pyx_v_chrom);
  PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_v_chrom);
  __Pyx_INCREF(__pyx_v_start);
  __Pyx_GIVEREF(__pyx_v_start);
  PyTuple_SET_ITEM(__pyx_t_2, 2, __pyx_v_start);
  __Pyx_INCREF(__pyx_v_end);
  __Pyx_GIVEREF(__pyx_v_end);
  PyTuple_SET_ITEM(__pyx_t_2, 3, __pyx_v_end);
  __pyx_t_4 = __Pyx_PyString_Format(__pyx_kp_s_samtools_view_s_s_d_d, __pyx_t_2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 334, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_3))) {
    __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_3);
    if (likely(__pyx_t_2)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
      __Pyx_INCREF(__pyx_t_2);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_3, function);
    }
  }
  if (!__pyx_t_2) {
    __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 334, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __Pyx_GOTREF(__pyx_t_1);
  } else {
    __pyx_t_5 = PyTuple_New(1+1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 334, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_GIVEREF(__pyx_t_2); PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_2); __pyx_t_2 = NULL;
    __Pyx_GIVEREF(__pyx_t_4);
    PyTuple_SET_ITEM(__pyx_t_5, 0+1, __pyx_t_4);
    __pyx_t_4 = 0;
    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_5, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 334, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  }
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_fbam = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":335
 * def chop_pacbio_read_by_pos(bam_in_new,chrom,start,end,flank_length):
 *     fbam=os.popen(r'''samtools view %s %s:%d-%d'''%(bam_in_new,chrom,start,end))
 *     out=[]             # <<<<<<<<<<<<<<
 *     for line in fbam:
 *         pbam=line.strip().split()
 */
  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 335, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_out = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":336
 *     fbam=os.popen(r'''samtools view %s %s:%d-%d'''%(bam_in_new,chrom,start,end))
 *     out=[]
 *     for line in fbam:             # <<<<<<<<<<<<<<
 *         pbam=line.strip().split()
 *         if not pbam[0]=='@':
 */
  if (likely(PyList_CheckExact(__pyx_v_fbam)) || PyTuple_CheckExact(__pyx_v_fbam)) {
    __pyx_t_1 = __pyx_v_fbam; __Pyx_INCREF(__pyx_t_1); __pyx_t_6 = 0;
    __pyx_t_7 = NULL;
  } else {
    __pyx_t_6 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_v_fbam); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 336, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_7 = Py_TYPE(__pyx_t_1)->tp_iternext; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 336, __pyx_L1_error)
  }
  for (;;) {
    if (likely(!__pyx_t_7)) {
      if (likely(PyList_CheckExact(__pyx_t_1))) {
        if (__pyx_t_6 >= PyList_GET_SIZE(__pyx_t_1)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_3 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_6); __Pyx_INCREF(__pyx_t_3); __pyx_t_6++; if (unlikely(0 < 0)) __PYX_ERR(0, 336, __pyx_L1_error)
        #else
        __pyx_t_3 = PySequence_ITEM(__pyx_t_1, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 336, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_3);
        #endif
      } else {
        if (__pyx_t_6 >= PyTuple_GET_SIZE(__pyx_t_1)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_3 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_6); __Pyx_INCREF(__pyx_t_3); __pyx_t_6++; if (unlikely(0 < 0)) __PYX_ERR(0, 336, __pyx_L1_error)
        #else
        __pyx_t_3 = PySequence_ITEM(__pyx_t_1, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 336, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_3);
        #endif
      }
    } else {
      __pyx_t_3 = __pyx_t_7(__pyx_t_1);
      if (unlikely(!__pyx_t_3)) {
        PyObject* exc_type = PyErr_Occurred();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
          else __PYX_ERR(0, 336, __pyx_L1_error)
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_3);
    }
    __Pyx_XDECREF_SET(__pyx_v_line, __pyx_t_3);
    __pyx_t_3 = 0;

    /* "vapor_vali/Simple_function.pyx":337
 *     out=[]
 *     for line in fbam:
 *         pbam=line.strip().split()             # <<<<<<<<<<<<<<
 *         if not pbam[0]=='@':
 *             if int(pbam[3])<start+1:
 */
    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_line, __pyx_n_s_strip); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 337, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_2 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_4))) {
      __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_4);
      if (likely(__pyx_t_2)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
        __Pyx_INCREF(__pyx_t_2);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_4, function);
      }
    }
    if (__pyx_t_2) {
      __pyx_t_5 = __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 337, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    } else {
      __pyx_t_5 = __Pyx_PyObject_CallNoArg(__pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 337, __pyx_L1_error)
    }
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_split); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 337, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_4))) {
      __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_4);
      if (likely(__pyx_t_5)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
        __Pyx_INCREF(__pyx_t_5);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_4, function);
      }
    }
    if (__pyx_t_5) {
      __pyx_t_3 = __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_5); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 337, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    } else {
      __pyx_t_3 = __Pyx_PyObject_CallNoArg(__pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 337, __pyx_L1_error)
    }
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __Pyx_XDECREF_SET(__pyx_v_pbam, __pyx_t_3);
    __pyx_t_3 = 0;

    /* "vapor_vali/Simple_function.pyx":338
 *     for line in fbam:
 *         pbam=line.strip().split()
 *         if not pbam[0]=='@':             # <<<<<<<<<<<<<<
 *             if int(pbam[3])<start+1:
 *                 align_info=cigar2alignstart_by_pos(pbam[5],int(pbam[3]),start,end)
 */
    __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_pbam, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 338, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_8 = (__Pyx_PyString_Equals(__pyx_t_3, __pyx_kp_s__25, Py_EQ)); if (unlikely(__pyx_t_8 < 0)) __PYX_ERR(0, 338, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_9 = ((!__pyx_t_8) != 0);
    if (__pyx_t_9) {

      /* "vapor_vali/Simple_function.pyx":339
 *         pbam=line.strip().split()
 *         if not pbam[0]=='@':
 *             if int(pbam[3])<start+1:             # <<<<<<<<<<<<<<
 *                 align_info=cigar2alignstart_by_pos(pbam[5],int(pbam[3]),start,end)
 *                 align_start=align_info[0]
 */
      __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_pbam, 3, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 339, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __pyx_t_4 = __Pyx_PyNumber_Int(__pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 339, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_3 = __Pyx_PyInt_AddObjC(__pyx_v_start, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 339, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __pyx_t_5 = PyObject_RichCompare(__pyx_t_4, __pyx_t_3, Py_LT); __Pyx_XGOTREF(__pyx_t_5); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 339, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_9 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_9 < 0)) __PYX_ERR(0, 339, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
      if (__pyx_t_9) {

        /* "vapor_vali/Simple_function.pyx":340
 *         if not pbam[0]=='@':
 *             if int(pbam[3])<start+1:
 *                 align_info=cigar2alignstart_by_pos(pbam[5],int(pbam[3]),start,end)             # <<<<<<<<<<<<<<
 *                 align_start=align_info[0]
 *                 miss_bp=align_info[1]
 */
        __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_cigar2alignstart_by_pos); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 340, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_3);
        __pyx_t_4 = __Pyx_GetItemInt(__pyx_v_pbam, 5, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 340, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_4);
        __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_pbam, 3, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 340, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
        __pyx_t_10 = __Pyx_PyNumber_Int(__pyx_t_2); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 340, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_10);
        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
        __pyx_t_2 = NULL;
        __pyx_t_11 = 0;
        if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_3))) {
          __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_3);
          if (likely(__pyx_t_2)) {
            PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
            __Pyx_INCREF(__pyx_t_2);
            __Pyx_INCREF(function);
            __Pyx_DECREF_SET(__pyx_t_3, function);
            __pyx_t_11 = 1;
          }
        }
        __pyx_t_12 = PyTuple_New(4+__pyx_t_11); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 340, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_12);
        if (__pyx_t_2) {
          __Pyx_GIVEREF(__pyx_t_2); PyTuple_SET_ITEM(__pyx_t_12, 0, __pyx_t_2); __pyx_t_2 = NULL;
        }
        __Pyx_GIVEREF(__pyx_t_4);
        PyTuple_SET_ITEM(__pyx_t_12, 0+__pyx_t_11, __pyx_t_4);
        __Pyx_GIVEREF(__pyx_t_10);
        PyTuple_SET_ITEM(__pyx_t_12, 1+__pyx_t_11, __pyx_t_10);
        __Pyx_INCREF(__pyx_v_start);
        __Pyx_GIVEREF(__pyx_v_start);
        PyTuple_SET_ITEM(__pyx_t_12, 2+__pyx_t_11, __pyx_v_start);
        __Pyx_INCREF(__pyx_v_end);
        __Pyx_GIVEREF(__pyx_v_end);
        PyTuple_SET_ITEM(__pyx_t_12, 3+__pyx_t_11, __pyx_v_end);
        __pyx_t_4 = 0;
        __pyx_t_10 = 0;
        __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_12, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 340, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_5);
        __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
        __Pyx_XDECREF_SET(__pyx_v_align_info, __pyx_t_5);
        __pyx_t_5 = 0;

        /* "vapor_vali/Simple_function.pyx":341
 *             if int(pbam[3])<start+1:
 *                 align_info=cigar2alignstart_by_pos(pbam[5],int(pbam[3]),start,end)
 *                 align_start=align_info[0]             # <<<<<<<<<<<<<<
 *                 miss_bp=align_info[1]
 *                 if not miss_bp>flank_length/2:
 */
        __pyx_t_5 = __Pyx_GetItemInt(__pyx_v_align_info, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 341, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_5);
        __Pyx_XDECREF_SET(__pyx_v_align_start, __pyx_t_5);
        __pyx_t_5 = 0;

        /* "vapor_vali/Simple_function.pyx":342
 *                 align_info=cigar2alignstart_by_pos(pbam[5],int(pbam[3]),start,end)
 *                 align_start=align_info[0]
 *                 miss_bp=align_info[1]             # <<<<<<<<<<<<<<
 *                 if not miss_bp>flank_length/2:
 *                     target_read=pbam[9][align_start:]
 */
        __pyx_t_5 = __Pyx_GetItemInt(__pyx_v_align_info, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 342, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_5);
        __Pyx_XDECREF_SET(__pyx_v_miss_bp, __pyx_t_5);
        __pyx_t_5 = 0;

        /* "vapor_vali/Simple_function.pyx":343
 *                 align_start=align_info[0]
 *                 miss_bp=align_info[1]
 *                 if not miss_bp>flank_length/2:             # <<<<<<<<<<<<<<
 *                     target_read=pbam[9][align_start:]
 *                     if len(target_read)>end-start-miss_bp:
 */
        __pyx_t_5 = __Pyx_PyNumber_Divide(__pyx_v_flank_length, __pyx_int_2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 343, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_5);
        __pyx_t_3 = PyObject_RichCompare(__pyx_v_miss_bp, __pyx_t_5, Py_GT); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 343, __pyx_L1_error)
        __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
        __pyx_t_9 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_9 < 0)) __PYX_ERR(0, 343, __pyx_L1_error)
        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
        __pyx_t_8 = ((!__pyx_t_9) != 0);
        if (__pyx_t_8) {

          /* "vapor_vali/Simple_function.pyx":344
 *                 miss_bp=align_info[1]
 *                 if not miss_bp>flank_length/2:
 *                     target_read=pbam[9][align_start:]             # <<<<<<<<<<<<<<
 *                     if len(target_read)>end-start-miss_bp:
 *                         out.append([target_read[:end-start-miss_bp],miss_bp,pbam[0]])
 */
          __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_pbam, 9, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 344, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_3);
          __pyx_t_5 = __Pyx_PyObject_GetSlice(__pyx_t_3, 0, 0, &__pyx_v_align_start, NULL, NULL, 0, 0, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 344, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_5);
          __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
          __Pyx_XDECREF_SET(__pyx_v_target_read, __pyx_t_5);
          __pyx_t_5 = 0;

          /* "vapor_vali/Simple_function.pyx":345
 *                 if not miss_bp>flank_length/2:
 *                     target_read=pbam[9][align_start:]
 *                     if len(target_read)>end-start-miss_bp:             # <<<<<<<<<<<<<<
 *                         out.append([target_read[:end-start-miss_bp],miss_bp,pbam[0]])
 *     fbam.close()
 */
          __pyx_t_11 = PyObject_Length(__pyx_v_target_read); if (unlikely(__pyx_t_11 == -1)) __PYX_ERR(0, 345, __pyx_L1_error)
          __pyx_t_5 = PyInt_FromSsize_t(__pyx_t_11); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 345, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_5);
          __pyx_t_3 = PyNumber_Subtract(__pyx_v_end, __pyx_v_start); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 345, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_3);
          __pyx_t_12 = PyNumber_Subtract(__pyx_t_3, __pyx_v_miss_bp); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 345, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_12);
          __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
          __pyx_t_3 = PyObject_RichCompare(__pyx_t_5, __pyx_t_12, Py_GT); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 345, __pyx_L1_error)
          __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
          __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
          __pyx_t_8 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_8 < 0)) __PYX_ERR(0, 345, __pyx_L1_error)
          __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
          if (__pyx_t_8) {

            /* "vapor_vali/Simple_function.pyx":346
 *                     target_read=pbam[9][align_start:]
 *                     if len(target_read)>end-start-miss_bp:
 *                         out.append([target_read[:end-start-miss_bp],miss_bp,pbam[0]])             # <<<<<<<<<<<<<<
 *     fbam.close()
 *     return out
 */
            __pyx_t_3 = PyNumber_Subtract(__pyx_v_end, __pyx_v_start); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 346, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_3);
            __pyx_t_12 = PyNumber_Subtract(__pyx_t_3, __pyx_v_miss_bp); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 346, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_12);
            __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
            __pyx_t_3 = __Pyx_PyObject_GetSlice(__pyx_v_target_read, 0, 0, NULL, &__pyx_t_12, NULL, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 346, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_3);
            __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
            __pyx_t_12 = __Pyx_GetItemInt(__pyx_v_pbam, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 346, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_12);
            __pyx_t_5 = PyList_New(3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 346, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_5);
            __Pyx_GIVEREF(__pyx_t_3);
            PyList_SET_ITEM(__pyx_t_5, 0, __pyx_t_3);
            __Pyx_INCREF(__pyx_v_miss_bp);
            __Pyx_GIVEREF(__pyx_v_miss_bp);
            PyList_SET_ITEM(__pyx_t_5, 1, __pyx_v_miss_bp);
            __Pyx_GIVEREF(__pyx_t_12);
            PyList_SET_ITEM(__pyx_t_5, 2, __pyx_t_12);
            __pyx_t_3 = 0;
            __pyx_t_12 = 0;
            __pyx_t_13 = __Pyx_PyList_Append(__pyx_v_out, __pyx_t_5); if (unlikely(__pyx_t_13 == -1)) __PYX_ERR(0, 346, __pyx_L1_error)
            __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;

            /* "vapor_vali/Simple_function.pyx":345
 *                 if not miss_bp>flank_length/2:
 *                     target_read=pbam[9][align_start:]
 *                     if len(target_read)>end-start-miss_bp:             # <<<<<<<<<<<<<<
 *                         out.append([target_read[:end-start-miss_bp],miss_bp,pbam[0]])
 *     fbam.close()
 */
          }

          /* "vapor_vali/Simple_function.pyx":343
 *                 align_start=align_info[0]
 *                 miss_bp=align_info[1]
 *                 if not miss_bp>flank_length/2:             # <<<<<<<<<<<<<<
 *                     target_read=pbam[9][align_start:]
 *                     if len(target_read)>end-start-miss_bp:
 */
        }

        /* "vapor_vali/Simple_function.pyx":339
 *         pbam=line.strip().split()
 *         if not pbam[0]=='@':
 *             if int(pbam[3])<start+1:             # <<<<<<<<<<<<<<
 *                 align_info=cigar2alignstart_by_pos(pbam[5],int(pbam[3]),start,end)
 *                 align_start=align_info[0]
 */
      }

      /* "vapor_vali/Simple_function.pyx":338
 *     for line in fbam:
 *         pbam=line.strip().split()
 *         if not pbam[0]=='@':             # <<<<<<<<<<<<<<
 *             if int(pbam[3])<start+1:
 *                 align_info=cigar2alignstart_by_pos(pbam[5],int(pbam[3]),start,end)
 */
    }

    /* "vapor_vali/Simple_function.pyx":336
 *     fbam=os.popen(r'''samtools view %s %s:%d-%d'''%(bam_in_new,chrom,start,end))
 *     out=[]
 *     for line in fbam:             # <<<<<<<<<<<<<<
 *         pbam=line.strip().split()
 *         if not pbam[0]=='@':
 */
  }
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":347
 *                     if len(target_read)>end-start-miss_bp:
 *                         out.append([target_read[:end-start-miss_bp],miss_bp,pbam[0]])
 *     fbam.close()             # <<<<<<<<<<<<<<
 *     return out
 * 
 */
  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_fbam, __pyx_n_s_close); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 347, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_12 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_5))) {
    __pyx_t_12 = PyMethod_GET_SELF(__pyx_t_5);
    if (likely(__pyx_t_12)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
      __Pyx_INCREF(__pyx_t_12);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_5, function);
    }
  }
  if (__pyx_t_12) {
    __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_t_12); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 347, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
  } else {
    __pyx_t_1 = __Pyx_PyObject_CallNoArg(__pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 347, __pyx_L1_error)
  }
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":348
 *                         out.append([target_read[:end-start-miss_bp],miss_bp,pbam[0]])
 *     fbam.close()
 *     return out             # <<<<<<<<<<<<<<
 * 
 * def chromos_readin(ref):
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_out);
  __pyx_r = __pyx_v_out;
  goto __pyx_L0;

  /* "vapor_vali/Simple_function.pyx":333
 *         return [read_rec,start_dis]
 * 
 * def chop_pacbio_read_by_pos(bam_in_new,chrom,start,end,flank_length):             # <<<<<<<<<<<<<<
 *     fbam=os.popen(r'''samtools view %s %s:%d-%d'''%(bam_in_new,chrom,start,end))
 *     out=[]
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_10);
  __Pyx_XDECREF(__pyx_t_12);
  __Pyx_AddTraceback("vapor_vali.Simple_function.chop_pacbio_read_by_pos", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_fbam);
  __Pyx_XDECREF(__pyx_v_out);
  __Pyx_XDECREF(__pyx_v_line);
  __Pyx_XDECREF(__pyx_v_pbam);
  __Pyx_XDECREF(__pyx_v_align_info);
  __Pyx_XDECREF(__pyx_v_align_start);
  __Pyx_XDECREF(__pyx_v_miss_bp);
  __Pyx_XDECREF(__pyx_v_target_read);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "vapor_vali/Simple_function.pyx":350
 *     return out
 * 
 * def chromos_readin(ref):             # <<<<<<<<<<<<<<
 *     fin=open(ref+'.fai')
 *     chromos=[]
 */

/* Python wrapper */
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_37chromos_readin(PyObject *__pyx_self, PyObject *__pyx_v_ref); /*proto*/
static PyMethodDef __pyx_mdef_10vapor_vali_15Simple_function_37chromos_readin = {"chromos_readin", (PyCFunction)__pyx_pw_10vapor_vali_15Simple_function_37chromos_readin, METH_O, 0};
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_37chromos_readin(PyObject *__pyx_self, PyObject *__pyx_v_ref) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("chromos_readin (wrapper)", 0);
  __pyx_r = __pyx_pf_10vapor_vali_15Simple_function_36chromos_readin(__pyx_self, ((PyObject *)__pyx_v_ref));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10vapor_vali_15Simple_function_36chromos_readin(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_ref) {
  PyObject *__pyx_v_fin = NULL;
  PyObject *__pyx_v_chromos = NULL;
  PyObject *__pyx_v_line = NULL;
  PyObject *__pyx_v_pin = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  Py_ssize_t __pyx_t_3;
  PyObject *(*__pyx_t_4)(PyObject *);
  PyObject *__pyx_t_5 = NULL;
  PyObject *__pyx_t_6 = NULL;
  PyObject *__pyx_t_7 = NULL;
  int __pyx_t_8;
  __Pyx_RefNannySetupContext("chromos_readin", 0);

  /* "vapor_vali/Simple_function.pyx":351
 * 
 * def chromos_readin(ref):
 *     fin=open(ref+'.fai')             # <<<<<<<<<<<<<<
 *     chromos=[]
 *     for line in fin:
 */
  __pyx_t_1 = PyNumber_Add(__pyx_v_ref, __pyx_kp_s_fai); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 351, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 351, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_GIVEREF(__pyx_t_1);
  PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_open, __pyx_t_2, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 351, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_fin = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":352
 * def chromos_readin(ref):
 *     fin=open(ref+'.fai')
 *     chromos=[]             # <<<<<<<<<<<<<<
 *     for line in fin:
 *             pin=line.strip().split()
 */
  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 352, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_chromos = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":353
 *     fin=open(ref+'.fai')
 *     chromos=[]
 *     for line in fin:             # <<<<<<<<<<<<<<
 *             pin=line.strip().split()
 *             chromos.append(pin[0])
 */
  if (likely(PyList_CheckExact(__pyx_v_fin)) || PyTuple_CheckExact(__pyx_v_fin)) {
    __pyx_t_1 = __pyx_v_fin; __Pyx_INCREF(__pyx_t_1); __pyx_t_3 = 0;
    __pyx_t_4 = NULL;
  } else {
    __pyx_t_3 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_v_fin); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 353, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_4 = Py_TYPE(__pyx_t_1)->tp_iternext; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 353, __pyx_L1_error)
  }
  for (;;) {
    if (likely(!__pyx_t_4)) {
      if (likely(PyList_CheckExact(__pyx_t_1))) {
        if (__pyx_t_3 >= PyList_GET_SIZE(__pyx_t_1)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_2 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_3); __Pyx_INCREF(__pyx_t_2); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 353, __pyx_L1_error)
        #else
        __pyx_t_2 = PySequence_ITEM(__pyx_t_1, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 353, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
        #endif
      } else {
        if (__pyx_t_3 >= PyTuple_GET_SIZE(__pyx_t_1)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_2 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_3); __Pyx_INCREF(__pyx_t_2); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 353, __pyx_L1_error)
        #else
        __pyx_t_2 = PySequence_ITEM(__pyx_t_1, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 353, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
        #endif
      }
    } else {
      __pyx_t_2 = __pyx_t_4(__pyx_t_1);
      if (unlikely(!__pyx_t_2)) {
        PyObject* exc_type = PyErr_Occurred();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
          else __PYX_ERR(0, 353, __pyx_L1_error)
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_2);
    }
    __Pyx_XDECREF_SET(__pyx_v_line, __pyx_t_2);
    __pyx_t_2 = 0;

    /* "vapor_vali/Simple_function.pyx":354
 *     chromos=[]
 *     for line in fin:
 *             pin=line.strip().split()             # <<<<<<<<<<<<<<
 *             chromos.append(pin[0])
 *     fin.close()
 */
    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_line, __pyx_n_s_strip); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 354, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __pyx_t_7 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_6))) {
      __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_6);
      if (likely(__pyx_t_7)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
        __Pyx_INCREF(__pyx_t_7);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_6, function);
      }
    }
    if (__pyx_t_7) {
      __pyx_t_5 = __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_7); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 354, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
    } else {
      __pyx_t_5 = __Pyx_PyObject_CallNoArg(__pyx_t_6); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 354, __pyx_L1_error)
    }
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_split); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 354, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_6))) {
      __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_6);
      if (likely(__pyx_t_5)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
        __Pyx_INCREF(__pyx_t_5);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_6, function);
      }
    }
    if (__pyx_t_5) {
      __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_5); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 354, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    } else {
      __pyx_t_2 = __Pyx_PyObject_CallNoArg(__pyx_t_6); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 354, __pyx_L1_error)
    }
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    __Pyx_XDECREF_SET(__pyx_v_pin, __pyx_t_2);
    __pyx_t_2 = 0;

    /* "vapor_vali/Simple_function.pyx":355
 *     for line in fin:
 *             pin=line.strip().split()
 *             chromos.append(pin[0])             # <<<<<<<<<<<<<<
 *     fin.close()
 *     return chromos
 */
    __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_pin, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 355, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_8 = __Pyx_PyList_Append(__pyx_v_chromos, __pyx_t_2); if (unlikely(__pyx_t_8 == -1)) __PYX_ERR(0, 355, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

    /* "vapor_vali/Simple_function.pyx":353
 *     fin=open(ref+'.fai')
 *     chromos=[]
 *     for line in fin:             # <<<<<<<<<<<<<<
 *             pin=line.strip().split()
 *             chromos.append(pin[0])
 */
  }
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":356
 *             pin=line.strip().split()
 *             chromos.append(pin[0])
 *     fin.close()             # <<<<<<<<<<<<<<
 *     return chromos
 * 
 */
  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_fin, __pyx_n_s_close); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 356, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_6 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_2);
    if (likely(__pyx_t_6)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_6);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_2, function);
    }
  }
  if (__pyx_t_6) {
    __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 356, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  } else {
    __pyx_t_1 = __Pyx_PyObject_CallNoArg(__pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 356, __pyx_L1_error)
  }
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":357
 *             chromos.append(pin[0])
 *     fin.close()
 *     return chromos             # <<<<<<<<<<<<<<
 * 
 * def chr_start_end_extract(pin):
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_chromos);
  __pyx_r = __pyx_v_chromos;
  goto __pyx_L0;

  /* "vapor_vali/Simple_function.pyx":350
 *     return out
 * 
 * def chromos_readin(ref):             # <<<<<<<<<<<<<<
 *     fin=open(ref+'.fai')
 *     chromos=[]
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_XDECREF(__pyx_t_7);
  __Pyx_AddTraceback("vapor_vali.Simple_function.chromos_readin", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_fin);
  __Pyx_XDECREF(__pyx_v_chromos);
  __Pyx_XDECREF(__pyx_v_line);
  __Pyx_XDECREF(__pyx_v_pin);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "vapor_vali/Simple_function.pyx":359
 *     return chromos
 * 
 * def chr_start_end_extract(pin):             # <<<<<<<<<<<<<<
 *     out=[pin[0],int(pin[1])]
 *     for x in pin[7].split(';'):
 */

/* Python wrapper */
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_39chr_start_end_extract(PyObject *__pyx_self, PyObject *__pyx_v_pin); /*proto*/
static PyMethodDef __pyx_mdef_10vapor_vali_15Simple_function_39chr_start_end_extract = {"chr_start_end_extract", (PyCFunction)__pyx_pw_10vapor_vali_15Simple_function_39chr_start_end_extract, METH_O, 0};
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_39chr_start_end_extract(PyObject *__pyx_self, PyObject *__pyx_v_pin) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("chr_start_end_extract (wrapper)", 0);
  __pyx_r = __pyx_pf_10vapor_vali_15Simple_function_38chr_start_end_extract(__pyx_self, ((PyObject *)__pyx_v_pin));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10vapor_vali_15Simple_function_38chr_start_end_extract(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_pin) {
  PyObject *__pyx_v_out = NULL;
  PyObject *__pyx_v_x = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  Py_ssize_t __pyx_t_4;
  PyObject *(*__pyx_t_5)(PyObject *);
  int __pyx_t_6;
  int __pyx_t_7;
  int __pyx_t_8;
  __Pyx_RefNannySetupContext("chr_start_end_extract", 0);

  /* "vapor_vali/Simple_function.pyx":360
 * 
 * def chr_start_end_extract(pin):
 *     out=[pin[0],int(pin[1])]             # <<<<<<<<<<<<<<
 *     for x in pin[7].split(';'):
 *         if x[:4]=='END=' and x.split('=')[0]=='END':
 */
  __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_pin, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 360, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_pin, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 360, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = __Pyx_PyNumber_Int(__pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 360, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = PyList_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 360, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_GIVEREF(__pyx_t_1);
  PyList_SET_ITEM(__pyx_t_2, 0, __pyx_t_1);
  __Pyx_GIVEREF(__pyx_t_3);
  PyList_SET_ITEM(__pyx_t_2, 1, __pyx_t_3);
  __pyx_t_1 = 0;
  __pyx_t_3 = 0;
  __pyx_v_out = ((PyObject*)__pyx_t_2);
  __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":361
 * def chr_start_end_extract(pin):
 *     out=[pin[0],int(pin[1])]
 *     for x in pin[7].split(';'):             # <<<<<<<<<<<<<<
 *         if x[:4]=='END=' and x.split('=')[0]=='END':
 *             out.append(int(x.split('=')[1]))
 */
  __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_pin, 7, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 361, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_split); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 361, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_tuple__27, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 361, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  if (likely(PyList_CheckExact(__pyx_t_2)) || PyTuple_CheckExact(__pyx_t_2)) {
    __pyx_t_3 = __pyx_t_2; __Pyx_INCREF(__pyx_t_3); __pyx_t_4 = 0;
    __pyx_t_5 = NULL;
  } else {
    __pyx_t_4 = -1; __pyx_t_3 = PyObject_GetIter(__pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 361, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_5 = Py_TYPE(__pyx_t_3)->tp_iternext; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 361, __pyx_L1_error)
  }
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  for (;;) {
    if (likely(!__pyx_t_5)) {
      if (likely(PyList_CheckExact(__pyx_t_3))) {
        if (__pyx_t_4 >= PyList_GET_SIZE(__pyx_t_3)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_2 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_4); __Pyx_INCREF(__pyx_t_2); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 361, __pyx_L1_error)
        #else
        __pyx_t_2 = PySequence_ITEM(__pyx_t_3, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 361, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
        #endif
      } else {
        if (__pyx_t_4 >= PyTuple_GET_SIZE(__pyx_t_3)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_2 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_4); __Pyx_INCREF(__pyx_t_2); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 361, __pyx_L1_error)
        #else
        __pyx_t_2 = PySequence_ITEM(__pyx_t_3, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 361, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
        #endif
      }
    } else {
      __pyx_t_2 = __pyx_t_5(__pyx_t_3);
      if (unlikely(!__pyx_t_2)) {
        PyObject* exc_type = PyErr_Occurred();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
          else __PYX_ERR(0, 361, __pyx_L1_error)
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_2);
    }
    __Pyx_XDECREF_SET(__pyx_v_x, __pyx_t_2);
    __pyx_t_2 = 0;

    /* "vapor_vali/Simple_function.pyx":362
 *     out=[pin[0],int(pin[1])]
 *     for x in pin[7].split(';'):
 *         if x[:4]=='END=' and x.split('=')[0]=='END':             # <<<<<<<<<<<<<<
 *             out.append(int(x.split('=')[1]))
 *     return out
 */
    __pyx_t_2 = __Pyx_PyObject_GetSlice(__pyx_v_x, 0, 4, NULL, NULL, &__pyx_slice__28, 0, 1, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 362, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_7 = (__Pyx_PyString_Equals(__pyx_t_2, __pyx_kp_s_END, Py_EQ)); if (unlikely(__pyx_t_7 < 0)) __PYX_ERR(0, 362, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    if (__pyx_t_7) {
    } else {
      __pyx_t_6 = __pyx_t_7;
      goto __pyx_L6_bool_binop_done;
    }
    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_x, __pyx_n_s_split); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 362, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_tuple__30, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 362, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = __Pyx_GetItemInt(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 362, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_7 = (__Pyx_PyString_Equals(__pyx_t_2, __pyx_n_s_END_2, Py_EQ)); if (unlikely(__pyx_t_7 < 0)) __PYX_ERR(0, 362, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_6 = __pyx_t_7;
    __pyx_L6_bool_binop_done:;
    if (__pyx_t_6) {

      /* "vapor_vali/Simple_function.pyx":363
 *     for x in pin[7].split(';'):
 *         if x[:4]=='END=' and x.split('=')[0]=='END':
 *             out.append(int(x.split('=')[1]))             # <<<<<<<<<<<<<<
 *     return out
 * 
 */
      __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_x, __pyx_n_s_split); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 363, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_tuple__31, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 363, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_2 = __Pyx_GetItemInt(__pyx_t_1, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 363, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_1 = __Pyx_PyNumber_Int(__pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 363, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_8 = __Pyx_PyList_Append(__pyx_v_out, __pyx_t_1); if (unlikely(__pyx_t_8 == -1)) __PYX_ERR(0, 363, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

      /* "vapor_vali/Simple_function.pyx":362
 *     out=[pin[0],int(pin[1])]
 *     for x in pin[7].split(';'):
 *         if x[:4]=='END=' and x.split('=')[0]=='END':             # <<<<<<<<<<<<<<
 *             out.append(int(x.split('=')[1]))
 *     return out
 */
    }

    /* "vapor_vali/Simple_function.pyx":361
 * def chr_start_end_extract(pin):
 *     out=[pin[0],int(pin[1])]
 *     for x in pin[7].split(';'):             # <<<<<<<<<<<<<<
 *         if x[:4]=='END=' and x.split('=')[0]=='END':
 *             out.append(int(x.split('=')[1]))
 */
  }
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;

  /* "vapor_vali/Simple_function.pyx":364
 *         if x[:4]=='END=' and x.split('=')[0]=='END':
 *             out.append(int(x.split('=')[1]))
 *     return out             # <<<<<<<<<<<<<<
 * 
 * def cluster_range_decide(other_cluster):
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_out);
  __pyx_r = __pyx_v_out;
  goto __pyx_L0;

  /* "vapor_vali/Simple_function.pyx":359
 *     return chromos
 * 
 * def chr_start_end_extract(pin):             # <<<<<<<<<<<<<<
 *     out=[pin[0],int(pin[1])]
 *     for x in pin[7].split(';'):
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_AddTraceback("vapor_vali.Simple_function.chr_start_end_extract", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_out);
  __Pyx_XDECREF(__pyx_v_x);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "vapor_vali/Simple_function.pyx":366
 *     return out
 * 
 * def cluster_range_decide(other_cluster):             # <<<<<<<<<<<<<<
 *     out=[]
 *     for x in other_cluster:
 */

/* Python wrapper */
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_41cluster_range_decide(PyObject *__pyx_self, PyObject *__pyx_v_other_cluster); /*proto*/
static PyMethodDef __pyx_mdef_10vapor_vali_15Simple_function_41cluster_range_decide = {"cluster_range_decide", (PyCFunction)__pyx_pw_10vapor_vali_15Simple_function_41cluster_range_decide, METH_O, 0};
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_41cluster_range_decide(PyObject *__pyx_self, PyObject *__pyx_v_other_cluster) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("cluster_range_decide (wrapper)", 0);
  __pyx_r = __pyx_pf_10vapor_vali_15Simple_function_40cluster_range_decide(__pyx_self, ((PyObject *)__pyx_v_other_cluster));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10vapor_vali_15Simple_function_40cluster_range_decide(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_other_cluster) {
  PyObject *__pyx_v_out = NULL;
  PyObject *__pyx_v_x = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  Py_ssize_t __pyx_t_2;
  PyObject *(*__pyx_t_3)(PyObject *);
  PyObject *__pyx_t_4 = NULL;
  int __pyx_t_5;
  PyObject *__pyx_t_6 = NULL;
  PyObject *__pyx_t_7 = NULL;
  PyObject *__pyx_t_8 = NULL;
  __Pyx_RefNannySetupContext("cluster_range_decide", 0);

  /* "vapor_vali/Simple_function.pyx":367
 * 
 * def cluster_range_decide(other_cluster):
 *     out=[]             # <<<<<<<<<<<<<<
 *     for x in other_cluster:
 *         out.append([])
 */
  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 367, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_out = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":368
 * def cluster_range_decide(other_cluster):
 *     out=[]
 *     for x in other_cluster:             # <<<<<<<<<<<<<<
 *         out.append([])
 *         out[-1].append([min(x[0]),max(x[0])])
 */
  if (likely(PyList_CheckExact(__pyx_v_other_cluster)) || PyTuple_CheckExact(__pyx_v_other_cluster)) {
    __pyx_t_1 = __pyx_v_other_cluster; __Pyx_INCREF(__pyx_t_1); __pyx_t_2 = 0;
    __pyx_t_3 = NULL;
  } else {
    __pyx_t_2 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_v_other_cluster); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 368, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_3 = Py_TYPE(__pyx_t_1)->tp_iternext; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 368, __pyx_L1_error)
  }
  for (;;) {
    if (likely(!__pyx_t_3)) {
      if (likely(PyList_CheckExact(__pyx_t_1))) {
        if (__pyx_t_2 >= PyList_GET_SIZE(__pyx_t_1)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_4 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_4); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 368, __pyx_L1_error)
        #else
        __pyx_t_4 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 368, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_4);
        #endif
      } else {
        if (__pyx_t_2 >= PyTuple_GET_SIZE(__pyx_t_1)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_4 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_4); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 368, __pyx_L1_error)
        #else
        __pyx_t_4 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 368, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_4);
        #endif
      }
    } else {
      __pyx_t_4 = __pyx_t_3(__pyx_t_1);
      if (unlikely(!__pyx_t_4)) {
        PyObject* exc_type = PyErr_Occurred();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
          else __PYX_ERR(0, 368, __pyx_L1_error)
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_4);
    }
    __Pyx_XDECREF_SET(__pyx_v_x, __pyx_t_4);
    __pyx_t_4 = 0;

    /* "vapor_vali/Simple_function.pyx":369
 *     out=[]
 *     for x in other_cluster:
 *         out.append([])             # <<<<<<<<<<<<<<
 *         out[-1].append([min(x[0]),max(x[0])])
 *         out[-1].append([min(x[1]),max(x[1])])
 */
    __pyx_t_4 = PyList_New(0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 369, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_5 = __Pyx_PyList_Append(__pyx_v_out, __pyx_t_4); if (unlikely(__pyx_t_5 == -1)) __PYX_ERR(0, 369, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;

    /* "vapor_vali/Simple_function.pyx":370
 *     for x in other_cluster:
 *         out.append([])
 *         out[-1].append([min(x[0]),max(x[0])])             # <<<<<<<<<<<<<<
 *         out[-1].append([min(x[1]),max(x[1])])
 *     return out
 */
    __pyx_t_4 = __Pyx_GetItemInt_List(__pyx_v_out, -1L, long, 1, __Pyx_PyInt_From_long, 1, 1, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 370, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_6 = __Pyx_GetItemInt(__pyx_v_x, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 370, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __pyx_t_7 = PyTuple_New(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 370, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    __Pyx_GIVEREF(__pyx_t_6);
    PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_6);
    __pyx_t_6 = 0;
    __pyx_t_6 = __Pyx_PyObject_Call(__pyx_builtin_min, __pyx_t_7, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 370, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_t_7 = __Pyx_GetItemInt(__pyx_v_x, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 370, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    __pyx_t_8 = PyTuple_New(1); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 370, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_8);
    __Pyx_GIVEREF(__pyx_t_7);
    PyTuple_SET_ITEM(__pyx_t_8, 0, __pyx_t_7);
    __pyx_t_7 = 0;
    __pyx_t_7 = __Pyx_PyObject_Call(__pyx_builtin_max, __pyx_t_8, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 370, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
    __pyx_t_8 = PyList_New(2); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 370, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_8);
    __Pyx_GIVEREF(__pyx_t_6);
    PyList_SET_ITEM(__pyx_t_8, 0, __pyx_t_6);
    __Pyx_GIVEREF(__pyx_t_7);
    PyList_SET_ITEM(__pyx_t_8, 1, __pyx_t_7);
    __pyx_t_6 = 0;
    __pyx_t_7 = 0;
    __pyx_t_5 = __Pyx_PyObject_Append(__pyx_t_4, __pyx_t_8); if (unlikely(__pyx_t_5 == -1)) __PYX_ERR(0, 370, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;

    /* "vapor_vali/Simple_function.pyx":371
 *         out.append([])
 *         out[-1].append([min(x[0]),max(x[0])])
 *         out[-1].append([min(x[1]),max(x[1])])             # <<<<<<<<<<<<<<
 *     return out
 * 
 */
    __pyx_t_8 = __Pyx_GetItemInt_List(__pyx_v_out, -1L, long, 1, __Pyx_PyInt_From_long, 1, 1, 1); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 371, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_8);
    __pyx_t_4 = __Pyx_GetItemInt(__pyx_v_x, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 371, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_7 = PyTuple_New(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 371, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    __Pyx_GIVEREF(__pyx_t_4);
    PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_4);
    __pyx_t_4 = 0;
    __pyx_t_4 = __Pyx_PyObject_Call(__pyx_builtin_min, __pyx_t_7, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 371, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_t_7 = __Pyx_GetItemInt(__pyx_v_x, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 371, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    __pyx_t_6 = PyTuple_New(1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 371, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __Pyx_GIVEREF(__pyx_t_7);
    PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_7);
    __pyx_t_7 = 0;
    __pyx_t_7 = __Pyx_PyObject_Call(__pyx_builtin_max, __pyx_t_6, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 371, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = PyList_New(2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 371, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __Pyx_GIVEREF(__pyx_t_4);
    PyList_SET_ITEM(__pyx_t_6, 0, __pyx_t_4);
    __Pyx_GIVEREF(__pyx_t_7);
    PyList_SET_ITEM(__pyx_t_6, 1, __pyx_t_7);
    __pyx_t_4 = 0;
    __pyx_t_7 = 0;
    __pyx_t_5 = __Pyx_PyObject_Append(__pyx_t_8, __pyx_t_6); if (unlikely(__pyx_t_5 == -1)) __PYX_ERR(0, 371, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

    /* "vapor_vali/Simple_function.pyx":368
 * def cluster_range_decide(other_cluster):
 *     out=[]
 *     for x in other_cluster:             # <<<<<<<<<<<<<<
 *         out.append([])
 *         out[-1].append([min(x[0]),max(x[0])])
 */
  }
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":372
 *         out[-1].append([min(x[0]),max(x[0])])
 *         out[-1].append([min(x[1]),max(x[1])])
 *     return out             # <<<<<<<<<<<<<<
 * 
 * def cluster_size_decide(range_cluster):
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_out);
  __pyx_r = __pyx_v_out;
  goto __pyx_L0;

  /* "vapor_vali/Simple_function.pyx":366
 *     return out
 * 
 * def cluster_range_decide(other_cluster):             # <<<<<<<<<<<<<<
 *     out=[]
 *     for x in other_cluster:
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_XDECREF(__pyx_t_7);
  __Pyx_XDECREF(__pyx_t_8);
  __Pyx_AddTraceback("vapor_vali.Simple_function.cluster_range_decide", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_out);
  __Pyx_XDECREF(__pyx_v_x);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "vapor_vali/Simple_function.pyx":374
 *     return out
 * 
 * def cluster_size_decide(range_cluster):             # <<<<<<<<<<<<<<
 *     out=[]
 *     for x in range_cluster:
 */

/* Python wrapper */
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_43cluster_size_decide(PyObject *__pyx_self, PyObject *__pyx_v_range_cluster); /*proto*/
static PyMethodDef __pyx_mdef_10vapor_vali_15Simple_function_43cluster_size_decide = {"cluster_size_decide", (PyCFunction)__pyx_pw_10vapor_vali_15Simple_function_43cluster_size_decide, METH_O, 0};
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_43cluster_size_decide(PyObject *__pyx_self, PyObject *__pyx_v_range_cluster) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("cluster_size_decide (wrapper)", 0);
  __pyx_r = __pyx_pf_10vapor_vali_15Simple_function_42cluster_size_decide(__pyx_self, ((PyObject *)__pyx_v_range_cluster));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10vapor_vali_15Simple_function_42cluster_size_decide(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_range_cluster) {
  PyObject *__pyx_v_out = NULL;
  PyObject *__pyx_v_x = NULL;
  PyObject *__pyx_v_size = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  Py_ssize_t __pyx_t_2;
  PyObject *(*__pyx_t_3)(PyObject *);
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  PyObject *__pyx_t_6 = NULL;
  PyObject *__pyx_t_7 = NULL;
  int __pyx_t_8;
  __Pyx_RefNannySetupContext("cluster_size_decide", 0);

  /* "vapor_vali/Simple_function.pyx":375
 * 
 * def cluster_size_decide(range_cluster):
 *     out=[]             # <<<<<<<<<<<<<<
 *     for x in range_cluster:
 *         size=(x[0][1]-x[0][0])*(x[1][1]-x[1][0])
 */
  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 375, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_out = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":376
 * def cluster_size_decide(range_cluster):
 *     out=[]
 *     for x in range_cluster:             # <<<<<<<<<<<<<<
 *         size=(x[0][1]-x[0][0])*(x[1][1]-x[1][0])
 *         out.append(np.sqrt(size))
 */
  if (likely(PyList_CheckExact(__pyx_v_range_cluster)) || PyTuple_CheckExact(__pyx_v_range_cluster)) {
    __pyx_t_1 = __pyx_v_range_cluster; __Pyx_INCREF(__pyx_t_1); __pyx_t_2 = 0;
    __pyx_t_3 = NULL;
  } else {
    __pyx_t_2 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_v_range_cluster); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 376, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_3 = Py_TYPE(__pyx_t_1)->tp_iternext; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 376, __pyx_L1_error)
  }
  for (;;) {
    if (likely(!__pyx_t_3)) {
      if (likely(PyList_CheckExact(__pyx_t_1))) {
        if (__pyx_t_2 >= PyList_GET_SIZE(__pyx_t_1)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_4 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_4); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 376, __pyx_L1_error)
        #else
        __pyx_t_4 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 376, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_4);
        #endif
      } else {
        if (__pyx_t_2 >= PyTuple_GET_SIZE(__pyx_t_1)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_4 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_4); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 376, __pyx_L1_error)
        #else
        __pyx_t_4 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 376, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_4);
        #endif
      }
    } else {
      __pyx_t_4 = __pyx_t_3(__pyx_t_1);
      if (unlikely(!__pyx_t_4)) {
        PyObject* exc_type = PyErr_Occurred();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
          else __PYX_ERR(0, 376, __pyx_L1_error)
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_4);
    }
    __Pyx_XDECREF_SET(__pyx_v_x, __pyx_t_4);
    __pyx_t_4 = 0;

    /* "vapor_vali/Simple_function.pyx":377
 *     out=[]
 *     for x in range_cluster:
 *         size=(x[0][1]-x[0][0])*(x[1][1]-x[1][0])             # <<<<<<<<<<<<<<
 *         out.append(np.sqrt(size))
 *     return out
 */
    __pyx_t_4 = __Pyx_GetItemInt(__pyx_v_x, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 377, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_5 = __Pyx_GetItemInt(__pyx_t_4, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 377, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = __Pyx_GetItemInt(__pyx_v_x, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 377, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_6 = __Pyx_GetItemInt(__pyx_t_4, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 377, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = PyNumber_Subtract(__pyx_t_5, __pyx_t_6); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 377, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = __Pyx_GetItemInt(__pyx_v_x, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 377, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __pyx_t_5 = __Pyx_GetItemInt(__pyx_t_6, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 377, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = __Pyx_GetItemInt(__pyx_v_x, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 377, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __pyx_t_7 = __Pyx_GetItemInt(__pyx_t_6, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 377, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = PyNumber_Subtract(__pyx_t_5, __pyx_t_7); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 377, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_t_7 = PyNumber_Multiply(__pyx_t_4, __pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 377, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    __Pyx_XDECREF_SET(__pyx_v_size, __pyx_t_7);
    __pyx_t_7 = 0;

    /* "vapor_vali/Simple_function.pyx":378
 *     for x in range_cluster:
 *         size=(x[0][1]-x[0][0])*(x[1][1]-x[1][0])
 *         out.append(np.sqrt(size))             # <<<<<<<<<<<<<<
 *     return out
 * 
 */
    __pyx_t_6 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 378, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_sqrt); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 378, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_4))) {
      __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_4);
      if (likely(__pyx_t_6)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
        __Pyx_INCREF(__pyx_t_6);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_4, function);
      }
    }
    if (!__pyx_t_6) {
      __pyx_t_7 = __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_v_size); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 378, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_7);
    } else {
      __pyx_t_5 = PyTuple_New(1+1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 378, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_5);
      __Pyx_GIVEREF(__pyx_t_6); PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_6); __pyx_t_6 = NULL;
      __Pyx_INCREF(__pyx_v_size);
      __Pyx_GIVEREF(__pyx_v_size);
      PyTuple_SET_ITEM(__pyx_t_5, 0+1, __pyx_v_size);
      __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_5, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 378, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_7);
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    }
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_8 = __Pyx_PyList_Append(__pyx_v_out, __pyx_t_7); if (unlikely(__pyx_t_8 == -1)) __PYX_ERR(0, 378, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;

    /* "vapor_vali/Simple_function.pyx":376
 * def cluster_size_decide(range_cluster):
 *     out=[]
 *     for x in range_cluster:             # <<<<<<<<<<<<<<
 *         size=(x[0][1]-x[0][0])*(x[1][1]-x[1][0])
 *         out.append(np.sqrt(size))
 */
  }
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":379
 *         size=(x[0][1]-x[0][0])*(x[1][1]-x[1][0])
 *         out.append(np.sqrt(size))
 *     return out             # <<<<<<<<<<<<<<
 * 
 * def clean_dotdata_m1(ref_dotdata):
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_out);
  __pyx_r = __pyx_v_out;
  goto __pyx_L0;

  /* "vapor_vali/Simple_function.pyx":374
 *     return out
 * 
 * def cluster_size_decide(range_cluster):             # <<<<<<<<<<<<<<
 *     out=[]
 *     for x in range_cluster:
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_XDECREF(__pyx_t_7);
  __Pyx_AddTraceback("vapor_vali.Simple_function.cluster_size_decide", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_out);
  __Pyx_XDECREF(__pyx_v_x);
  __Pyx_XDECREF(__pyx_v_size);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "vapor_vali/Simple_function.pyx":381
 *     return out
 * 
 * def clean_dotdata_m1(ref_dotdata):             # <<<<<<<<<<<<<<
 *     #cluster dots based on their distance to diagnal
 *     x_axis=[i[0] for i in ref_dotdata]
 */

/* Python wrapper */
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_45clean_dotdata_m1(PyObject *__pyx_self, PyObject *__pyx_v_ref_dotdata); /*proto*/
static PyMethodDef __pyx_mdef_10vapor_vali_15Simple_function_45clean_dotdata_m1 = {"clean_dotdata_m1", (PyCFunction)__pyx_pw_10vapor_vali_15Simple_function_45clean_dotdata_m1, METH_O, 0};
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_45clean_dotdata_m1(PyObject *__pyx_self, PyObject *__pyx_v_ref_dotdata) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("clean_dotdata_m1 (wrapper)", 0);
  __pyx_r = __pyx_pf_10vapor_vali_15Simple_function_44clean_dotdata_m1(__pyx_self, ((PyObject *)__pyx_v_ref_dotdata));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10vapor_vali_15Simple_function_44clean_dotdata_m1(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_ref_dotdata) {
  PyObject *__pyx_v_x_axis = NULL;
  PyObject *__pyx_v_y_axis = NULL;
  PyObject *__pyx_v_dis_to_diagnal = NULL;
  PyObject *__pyx_v_kept_dot_pos = NULL;
  PyObject *__pyx_v_kept_dot = NULL;
  PyObject *__pyx_v_x = NULL;
  PyObject *__pyx_v_temp = NULL;
  PyObject *__pyx_v_kept_dot_cluster = NULL;
  PyObject *__pyx_v_y = NULL;
  PyObject *__pyx_v_kept_region = NULL;
  PyObject *__pyx_v_out = NULL;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  Py_ssize_t __pyx_t_3;
  PyObject *(*__pyx_t_4)(PyObject *);
  PyObject *__pyx_t_5 = NULL;
  PyObject *__pyx_t_6 = NULL;
  PyObject *__pyx_t_7 = NULL;
  Py_ssize_t __pyx_t_8;
  PyObject *(*__pyx_t_9)(PyObject *);
  PyObject *__pyx_t_10 = NULL;
  Py_ssize_t __pyx_t_11;
  PyObject *(*__pyx_t_12)(PyObject *);
  int __pyx_t_13;
  __Pyx_RefNannySetupContext("clean_dotdata_m1", 0);

  /* "vapor_vali/Simple_function.pyx":383
 * def clean_dotdata_m1(ref_dotdata):
 *     #cluster dots based on their distance to diagnal
 *     x_axis=[i[0] for i in ref_dotdata]             # <<<<<<<<<<<<<<
 *     y_axis=[i[1] for i in ref_dotdata]
 *     dis_to_diagnal=[y_axis[i]-x_axis[i] for i in range(len(x_axis))]
 */
  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 383, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  if (likely(PyList_CheckExact(__pyx_v_ref_dotdata)) || PyTuple_CheckExact(__pyx_v_ref_dotdata)) {
    __pyx_t_2 = __pyx_v_ref_dotdata; __Pyx_INCREF(__pyx_t_2); __pyx_t_3 = 0;
    __pyx_t_4 = NULL;
  } else {
    __pyx_t_3 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_v_ref_dotdata); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 383, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_4 = Py_TYPE(__pyx_t_2)->tp_iternext; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 383, __pyx_L1_error)
  }
  for (;;) {
    if (likely(!__pyx_t_4)) {
      if (likely(PyList_CheckExact(__pyx_t_2))) {
        if (__pyx_t_3 >= PyList_GET_SIZE(__pyx_t_2)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_5 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_3); __Pyx_INCREF(__pyx_t_5); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 383, __pyx_L1_error)
        #else
        __pyx_t_5 = PySequence_ITEM(__pyx_t_2, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 383, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_5);
        #endif
      } else {
        if (__pyx_t_3 >= PyTuple_GET_SIZE(__pyx_t_2)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_5 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_3); __Pyx_INCREF(__pyx_t_5); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 383, __pyx_L1_error)
        #else
        __pyx_t_5 = PySequence_ITEM(__pyx_t_2, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 383, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_5);
        #endif
      }
    } else {
      __pyx_t_5 = __pyx_t_4(__pyx_t_2);
      if (unlikely(!__pyx_t_5)) {
        PyObject* exc_type = PyErr_Occurred();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
          else __PYX_ERR(0, 383, __pyx_L1_error)
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_5);
    }
    __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_5);
    __pyx_t_5 = 0;
    __pyx_t_5 = __Pyx_GetItemInt(__pyx_v_i, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 383, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    if (unlikely(__Pyx_ListComp_Append(__pyx_t_1, (PyObject*)__pyx_t_5))) __PYX_ERR(0, 383, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  }
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_x_axis = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":384
 *     #cluster dots based on their distance to diagnal
 *     x_axis=[i[0] for i in ref_dotdata]
 *     y_axis=[i[1] for i in ref_dotdata]             # <<<<<<<<<<<<<<
 *     dis_to_diagnal=[y_axis[i]-x_axis[i] for i in range(len(x_axis))]
 *     kept_dot_pos=dis_cluster(dis_to_diagnal,dis_cff=10)
 */
  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 384, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  if (likely(PyList_CheckExact(__pyx_v_ref_dotdata)) || PyTuple_CheckExact(__pyx_v_ref_dotdata)) {
    __pyx_t_2 = __pyx_v_ref_dotdata; __Pyx_INCREF(__pyx_t_2); __pyx_t_3 = 0;
    __pyx_t_4 = NULL;
  } else {
    __pyx_t_3 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_v_ref_dotdata); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 384, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_4 = Py_TYPE(__pyx_t_2)->tp_iternext; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 384, __pyx_L1_error)
  }
  for (;;) {
    if (likely(!__pyx_t_4)) {
      if (likely(PyList_CheckExact(__pyx_t_2))) {
        if (__pyx_t_3 >= PyList_GET_SIZE(__pyx_t_2)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_5 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_3); __Pyx_INCREF(__pyx_t_5); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 384, __pyx_L1_error)
        #else
        __pyx_t_5 = PySequence_ITEM(__pyx_t_2, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 384, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_5);
        #endif
      } else {
        if (__pyx_t_3 >= PyTuple_GET_SIZE(__pyx_t_2)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_5 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_3); __Pyx_INCREF(__pyx_t_5); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 384, __pyx_L1_error)
        #else
        __pyx_t_5 = PySequence_ITEM(__pyx_t_2, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 384, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_5);
        #endif
      }
    } else {
      __pyx_t_5 = __pyx_t_4(__pyx_t_2);
      if (unlikely(!__pyx_t_5)) {
        PyObject* exc_type = PyErr_Occurred();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
          else __PYX_ERR(0, 384, __pyx_L1_error)
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_5);
    }
    __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_5);
    __pyx_t_5 = 0;
    __pyx_t_5 = __Pyx_GetItemInt(__pyx_v_i, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 384, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    if (unlikely(__Pyx_ListComp_Append(__pyx_t_1, (PyObject*)__pyx_t_5))) __PYX_ERR(0, 384, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  }
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_y_axis = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":385
 *     x_axis=[i[0] for i in ref_dotdata]
 *     y_axis=[i[1] for i in ref_dotdata]
 *     dis_to_diagnal=[y_axis[i]-x_axis[i] for i in range(len(x_axis))]             # <<<<<<<<<<<<<<
 *     kept_dot_pos=dis_cluster(dis_to_diagnal,dis_cff=10)
 *     kept_dot=[]
 */
  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 385, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_3 = PyList_GET_SIZE(__pyx_v_x_axis); if (unlikely(__pyx_t_3 == -1)) __PYX_ERR(0, 385, __pyx_L1_error)
  __pyx_t_2 = PyInt_FromSsize_t(__pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 385, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 385, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_GIVEREF(__pyx_t_2);
  PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_t_5, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 385, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  if (likely(PyList_CheckExact(__pyx_t_2)) || PyTuple_CheckExact(__pyx_t_2)) {
    __pyx_t_5 = __pyx_t_2; __Pyx_INCREF(__pyx_t_5); __pyx_t_3 = 0;
    __pyx_t_4 = NULL;
  } else {
    __pyx_t_3 = -1; __pyx_t_5 = PyObject_GetIter(__pyx_t_2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 385, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __pyx_t_4 = Py_TYPE(__pyx_t_5)->tp_iternext; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 385, __pyx_L1_error)
  }
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  for (;;) {
    if (likely(!__pyx_t_4)) {
      if (likely(PyList_CheckExact(__pyx_t_5))) {
        if (__pyx_t_3 >= PyList_GET_SIZE(__pyx_t_5)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_2 = PyList_GET_ITEM(__pyx_t_5, __pyx_t_3); __Pyx_INCREF(__pyx_t_2); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 385, __pyx_L1_error)
        #else
        __pyx_t_2 = PySequence_ITEM(__pyx_t_5, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 385, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
        #endif
      } else {
        if (__pyx_t_3 >= PyTuple_GET_SIZE(__pyx_t_5)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_2 = PyTuple_GET_ITEM(__pyx_t_5, __pyx_t_3); __Pyx_INCREF(__pyx_t_2); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 385, __pyx_L1_error)
        #else
        __pyx_t_2 = PySequence_ITEM(__pyx_t_5, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 385, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
        #endif
      }
    } else {
      __pyx_t_2 = __pyx_t_4(__pyx_t_5);
      if (unlikely(!__pyx_t_2)) {
        PyObject* exc_type = PyErr_Occurred();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
          else __PYX_ERR(0, 385, __pyx_L1_error)
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_2);
    }
    __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_2);
    __pyx_t_2 = 0;
    __pyx_t_2 = PyObject_GetItem(__pyx_v_y_axis, __pyx_v_i); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 385, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_6 = PyObject_GetItem(__pyx_v_x_axis, __pyx_v_i); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 385, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __pyx_t_7 = PyNumber_Subtract(__pyx_t_2, __pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 385, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    if (unlikely(__Pyx_ListComp_Append(__pyx_t_1, (PyObject*)__pyx_t_7))) __PYX_ERR(0, 385, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
  }
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v_dis_to_diagnal = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":386
 *     y_axis=[i[1] for i in ref_dotdata]
 *     dis_to_diagnal=[y_axis[i]-x_axis[i] for i in range(len(x_axis))]
 *     kept_dot_pos=dis_cluster(dis_to_diagnal,dis_cff=10)             # <<<<<<<<<<<<<<
 *     kept_dot=[]
 *     for x in kept_dot_pos:
 */
  __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_dis_cluster); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 386, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 386, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_INCREF(__pyx_v_dis_to_diagnal);
  __Pyx_GIVEREF(__pyx_v_dis_to_diagnal);
  PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_v_dis_to_diagnal);
  __pyx_t_7 = PyDict_New(); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 386, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_dis_cff, __pyx_int_10) < 0) __PYX_ERR(0, 386, __pyx_L1_error)
  __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_5, __pyx_t_7); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 386, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_v_kept_dot_pos = __pyx_t_6;
  __pyx_t_6 = 0;

  /* "vapor_vali/Simple_function.pyx":387
 *     dis_to_diagnal=[y_axis[i]-x_axis[i] for i in range(len(x_axis))]
 *     kept_dot_pos=dis_cluster(dis_to_diagnal,dis_cff=10)
 *     kept_dot=[]             # <<<<<<<<<<<<<<
 *     for x in kept_dot_pos:
 *         temp=[[x_axis[i],y_axis[i]] for i in x]
 */
  __pyx_t_6 = PyList_New(0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 387, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_v_kept_dot = ((PyObject*)__pyx_t_6);
  __pyx_t_6 = 0;

  /* "vapor_vali/Simple_function.pyx":388
 *     kept_dot_pos=dis_cluster(dis_to_diagnal,dis_cff=10)
 *     kept_dot=[]
 *     for x in kept_dot_pos:             # <<<<<<<<<<<<<<
 *         temp=[[x_axis[i],y_axis[i]] for i in x]
 *         kept_dot_cluster=dis_cluster([i[0] for i in temp],40)
 */
  if (likely(PyList_CheckExact(__pyx_v_kept_dot_pos)) || PyTuple_CheckExact(__pyx_v_kept_dot_pos)) {
    __pyx_t_6 = __pyx_v_kept_dot_pos; __Pyx_INCREF(__pyx_t_6); __pyx_t_3 = 0;
    __pyx_t_4 = NULL;
  } else {
    __pyx_t_3 = -1; __pyx_t_6 = PyObject_GetIter(__pyx_v_kept_dot_pos); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 388, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __pyx_t_4 = Py_TYPE(__pyx_t_6)->tp_iternext; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 388, __pyx_L1_error)
  }
  for (;;) {
    if (likely(!__pyx_t_4)) {
      if (likely(PyList_CheckExact(__pyx_t_6))) {
        if (__pyx_t_3 >= PyList_GET_SIZE(__pyx_t_6)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_7 = PyList_GET_ITEM(__pyx_t_6, __pyx_t_3); __Pyx_INCREF(__pyx_t_7); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 388, __pyx_L1_error)
        #else
        __pyx_t_7 = PySequence_ITEM(__pyx_t_6, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 388, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_7);
        #endif
      } else {
        if (__pyx_t_3 >= PyTuple_GET_SIZE(__pyx_t_6)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_7 = PyTuple_GET_ITEM(__pyx_t_6, __pyx_t_3); __Pyx_INCREF(__pyx_t_7); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 388, __pyx_L1_error)
        #else
        __pyx_t_7 = PySequence_ITEM(__pyx_t_6, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 388, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_7);
        #endif
      }
    } else {
      __pyx_t_7 = __pyx_t_4(__pyx_t_6);
      if (unlikely(!__pyx_t_7)) {
        PyObject* exc_type = PyErr_Occurred();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
          else __PYX_ERR(0, 388, __pyx_L1_error)
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_7);
    }
    __Pyx_XDECREF_SET(__pyx_v_x, __pyx_t_7);
    __pyx_t_7 = 0;

    /* "vapor_vali/Simple_function.pyx":389
 *     kept_dot=[]
 *     for x in kept_dot_pos:
 *         temp=[[x_axis[i],y_axis[i]] for i in x]             # <<<<<<<<<<<<<<
 *         kept_dot_cluster=dis_cluster([i[0] for i in temp],40)
 *         for y in kept_dot_cluster:
 */
    __pyx_t_7 = PyList_New(0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 389, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    if (likely(PyList_CheckExact(__pyx_v_x)) || PyTuple_CheckExact(__pyx_v_x)) {
      __pyx_t_5 = __pyx_v_x; __Pyx_INCREF(__pyx_t_5); __pyx_t_8 = 0;
      __pyx_t_9 = NULL;
    } else {
      __pyx_t_8 = -1; __pyx_t_5 = PyObject_GetIter(__pyx_v_x); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 389, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_5);
      __pyx_t_9 = Py_TYPE(__pyx_t_5)->tp_iternext; if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 389, __pyx_L1_error)
    }
    for (;;) {
      if (likely(!__pyx_t_9)) {
        if (likely(PyList_CheckExact(__pyx_t_5))) {
          if (__pyx_t_8 >= PyList_GET_SIZE(__pyx_t_5)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_1 = PyList_GET_ITEM(__pyx_t_5, __pyx_t_8); __Pyx_INCREF(__pyx_t_1); __pyx_t_8++; if (unlikely(0 < 0)) __PYX_ERR(0, 389, __pyx_L1_error)
          #else
          __pyx_t_1 = PySequence_ITEM(__pyx_t_5, __pyx_t_8); __pyx_t_8++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 389, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_1);
          #endif
        } else {
          if (__pyx_t_8 >= PyTuple_GET_SIZE(__pyx_t_5)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_5, __pyx_t_8); __Pyx_INCREF(__pyx_t_1); __pyx_t_8++; if (unlikely(0 < 0)) __PYX_ERR(0, 389, __pyx_L1_error)
          #else
          __pyx_t_1 = PySequence_ITEM(__pyx_t_5, __pyx_t_8); __pyx_t_8++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 389, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_1);
          #endif
        }
      } else {
        __pyx_t_1 = __pyx_t_9(__pyx_t_5);
        if (unlikely(!__pyx_t_1)) {
          PyObject* exc_type = PyErr_Occurred();
          if (exc_type) {
            if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
            else __PYX_ERR(0, 389, __pyx_L1_error)
          }
          break;
        }
        __Pyx_GOTREF(__pyx_t_1);
      }
      __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_1);
      __pyx_t_1 = 0;
      __pyx_t_1 = PyObject_GetItem(__pyx_v_x_axis, __pyx_v_i); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 389, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __pyx_t_2 = PyObject_GetItem(__pyx_v_y_axis, __pyx_v_i); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 389, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __pyx_t_10 = PyList_New(2); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 389, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_10);
      __Pyx_GIVEREF(__pyx_t_1);
      PyList_SET_ITEM(__pyx_t_10, 0, __pyx_t_1);
      __Pyx_GIVEREF(__pyx_t_2);
      PyList_SET_ITEM(__pyx_t_10, 1, __pyx_t_2);
      __pyx_t_1 = 0;
      __pyx_t_2 = 0;
      if (unlikely(__Pyx_ListComp_Append(__pyx_t_7, (PyObject*)__pyx_t_10))) __PYX_ERR(0, 389, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
    }
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    __Pyx_XDECREF_SET(__pyx_v_temp, ((PyObject*)__pyx_t_7));
    __pyx_t_7 = 0;

    /* "vapor_vali/Simple_function.pyx":390
 *     for x in kept_dot_pos:
 *         temp=[[x_axis[i],y_axis[i]] for i in x]
 *         kept_dot_cluster=dis_cluster([i[0] for i in temp],40)             # <<<<<<<<<<<<<<
 *         for y in kept_dot_cluster:
 *             kept_dot.append([temp[i] for i in y])
 */
    __pyx_t_5 = __Pyx_GetModuleGlobalName(__pyx_n_s_dis_cluster); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 390, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __pyx_t_10 = PyList_New(0); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 390, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_10);
    __pyx_t_2 = __pyx_v_temp; __Pyx_INCREF(__pyx_t_2); __pyx_t_8 = 0;
    for (;;) {
      if (__pyx_t_8 >= PyList_GET_SIZE(__pyx_t_2)) break;
      #if CYTHON_COMPILING_IN_CPYTHON
      __pyx_t_1 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_8); __Pyx_INCREF(__pyx_t_1); __pyx_t_8++; if (unlikely(0 < 0)) __PYX_ERR(0, 390, __pyx_L1_error)
      #else
      __pyx_t_1 = PySequence_ITEM(__pyx_t_2, __pyx_t_8); __pyx_t_8++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 390, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      #endif
      __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_1);
      __pyx_t_1 = 0;
      __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_i, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 390, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      if (unlikely(__Pyx_ListComp_Append(__pyx_t_10, (PyObject*)__pyx_t_1))) __PYX_ERR(0, 390, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    }
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = NULL;
    __pyx_t_8 = 0;
    if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_5))) {
      __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_5);
      if (likely(__pyx_t_2)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
        __Pyx_INCREF(__pyx_t_2);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_5, function);
        __pyx_t_8 = 1;
      }
    }
    __pyx_t_1 = PyTuple_New(2+__pyx_t_8); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 390, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    if (__pyx_t_2) {
      __Pyx_GIVEREF(__pyx_t_2); PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_2); __pyx_t_2 = NULL;
    }
    __Pyx_GIVEREF(__pyx_t_10);
    PyTuple_SET_ITEM(__pyx_t_1, 0+__pyx_t_8, __pyx_t_10);
    __Pyx_INCREF(__pyx_int_40);
    __Pyx_GIVEREF(__pyx_int_40);
    PyTuple_SET_ITEM(__pyx_t_1, 1+__pyx_t_8, __pyx_int_40);
    __pyx_t_10 = 0;
    __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_1, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 390, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    __Pyx_XDECREF_SET(__pyx_v_kept_dot_cluster, __pyx_t_7);
    __pyx_t_7 = 0;

    /* "vapor_vali/Simple_function.pyx":391
 *         temp=[[x_axis[i],y_axis[i]] for i in x]
 *         kept_dot_cluster=dis_cluster([i[0] for i in temp],40)
 *         for y in kept_dot_cluster:             # <<<<<<<<<<<<<<
 *             kept_dot.append([temp[i] for i in y])
 *     kept_region=[[x[0],x[1]] for x in kept_dot]
 */
    if (likely(PyList_CheckExact(__pyx_v_kept_dot_cluster)) || PyTuple_CheckExact(__pyx_v_kept_dot_cluster)) {
      __pyx_t_7 = __pyx_v_kept_dot_cluster; __Pyx_INCREF(__pyx_t_7); __pyx_t_8 = 0;
      __pyx_t_9 = NULL;
    } else {
      __pyx_t_8 = -1; __pyx_t_7 = PyObject_GetIter(__pyx_v_kept_dot_cluster); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 391, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_7);
      __pyx_t_9 = Py_TYPE(__pyx_t_7)->tp_iternext; if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 391, __pyx_L1_error)
    }
    for (;;) {
      if (likely(!__pyx_t_9)) {
        if (likely(PyList_CheckExact(__pyx_t_7))) {
          if (__pyx_t_8 >= PyList_GET_SIZE(__pyx_t_7)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_5 = PyList_GET_ITEM(__pyx_t_7, __pyx_t_8); __Pyx_INCREF(__pyx_t_5); __pyx_t_8++; if (unlikely(0 < 0)) __PYX_ERR(0, 391, __pyx_L1_error)
          #else
          __pyx_t_5 = PySequence_ITEM(__pyx_t_7, __pyx_t_8); __pyx_t_8++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 391, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_5);
          #endif
        } else {
          if (__pyx_t_8 >= PyTuple_GET_SIZE(__pyx_t_7)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_5 = PyTuple_GET_ITEM(__pyx_t_7, __pyx_t_8); __Pyx_INCREF(__pyx_t_5); __pyx_t_8++; if (unlikely(0 < 0)) __PYX_ERR(0, 391, __pyx_L1_error)
          #else
          __pyx_t_5 = PySequence_ITEM(__pyx_t_7, __pyx_t_8); __pyx_t_8++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 391, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_5);
          #endif
        }
      } else {
        __pyx_t_5 = __pyx_t_9(__pyx_t_7);
        if (unlikely(!__pyx_t_5)) {
          PyObject* exc_type = PyErr_Occurred();
          if (exc_type) {
            if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
            else __PYX_ERR(0, 391, __pyx_L1_error)
          }
          break;
        }
        __Pyx_GOTREF(__pyx_t_5);
      }
      __Pyx_XDECREF_SET(__pyx_v_y, __pyx_t_5);
      __pyx_t_5 = 0;

      /* "vapor_vali/Simple_function.pyx":392
 *         kept_dot_cluster=dis_cluster([i[0] for i in temp],40)
 *         for y in kept_dot_cluster:
 *             kept_dot.append([temp[i] for i in y])             # <<<<<<<<<<<<<<
 *     kept_region=[[x[0],x[1]] for x in kept_dot]
 *     out=[]
 */
      __pyx_t_5 = PyList_New(0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 392, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_5);
      if (likely(PyList_CheckExact(__pyx_v_y)) || PyTuple_CheckExact(__pyx_v_y)) {
        __pyx_t_1 = __pyx_v_y; __Pyx_INCREF(__pyx_t_1); __pyx_t_11 = 0;
        __pyx_t_12 = NULL;
      } else {
        __pyx_t_11 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_v_y); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 392, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        __pyx_t_12 = Py_TYPE(__pyx_t_1)->tp_iternext; if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 392, __pyx_L1_error)
      }
      for (;;) {
        if (likely(!__pyx_t_12)) {
          if (likely(PyList_CheckExact(__pyx_t_1))) {
            if (__pyx_t_11 >= PyList_GET_SIZE(__pyx_t_1)) break;
            #if CYTHON_COMPILING_IN_CPYTHON
            __pyx_t_10 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_11); __Pyx_INCREF(__pyx_t_10); __pyx_t_11++; if (unlikely(0 < 0)) __PYX_ERR(0, 392, __pyx_L1_error)
            #else
            __pyx_t_10 = PySequence_ITEM(__pyx_t_1, __pyx_t_11); __pyx_t_11++; if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 392, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_10);
            #endif
          } else {
            if (__pyx_t_11 >= PyTuple_GET_SIZE(__pyx_t_1)) break;
            #if CYTHON_COMPILING_IN_CPYTHON
            __pyx_t_10 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_11); __Pyx_INCREF(__pyx_t_10); __pyx_t_11++; if (unlikely(0 < 0)) __PYX_ERR(0, 392, __pyx_L1_error)
            #else
            __pyx_t_10 = PySequence_ITEM(__pyx_t_1, __pyx_t_11); __pyx_t_11++; if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 392, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_10);
            #endif
          }
        } else {
          __pyx_t_10 = __pyx_t_12(__pyx_t_1);
          if (unlikely(!__pyx_t_10)) {
            PyObject* exc_type = PyErr_Occurred();
            if (exc_type) {
              if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
              else __PYX_ERR(0, 392, __pyx_L1_error)
            }
            break;
          }
          __Pyx_GOTREF(__pyx_t_10);
        }
        __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_10);
        __pyx_t_10 = 0;
        __pyx_t_10 = PyObject_GetItem(__pyx_v_temp, __pyx_v_i); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 392, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_10);
        if (unlikely(__Pyx_ListComp_Append(__pyx_t_5, (PyObject*)__pyx_t_10))) __PYX_ERR(0, 392, __pyx_L1_error)
        __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
      }
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_13 = __Pyx_PyList_Append(__pyx_v_kept_dot, __pyx_t_5); if (unlikely(__pyx_t_13 == -1)) __PYX_ERR(0, 392, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;

      /* "vapor_vali/Simple_function.pyx":391
 *         temp=[[x_axis[i],y_axis[i]] for i in x]
 *         kept_dot_cluster=dis_cluster([i[0] for i in temp],40)
 *         for y in kept_dot_cluster:             # <<<<<<<<<<<<<<
 *             kept_dot.append([temp[i] for i in y])
 *     kept_region=[[x[0],x[1]] for x in kept_dot]
 */
    }
    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;

    /* "vapor_vali/Simple_function.pyx":388
 *     kept_dot_pos=dis_cluster(dis_to_diagnal,dis_cff=10)
 *     kept_dot=[]
 *     for x in kept_dot_pos:             # <<<<<<<<<<<<<<
 *         temp=[[x_axis[i],y_axis[i]] for i in x]
 *         kept_dot_cluster=dis_cluster([i[0] for i in temp],40)
 */
  }
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

  /* "vapor_vali/Simple_function.pyx":393
 *         for y in kept_dot_cluster:
 *             kept_dot.append([temp[i] for i in y])
 *     kept_region=[[x[0],x[1]] for x in kept_dot]             # <<<<<<<<<<<<<<
 *     out=[]
 *     for x in kept_dot:    out+=x
 */
  __pyx_t_6 = PyList_New(0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 393, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_7 = __pyx_v_kept_dot; __Pyx_INCREF(__pyx_t_7); __pyx_t_3 = 0;
  for (;;) {
    if (__pyx_t_3 >= PyList_GET_SIZE(__pyx_t_7)) break;
    #if CYTHON_COMPILING_IN_CPYTHON
    __pyx_t_5 = PyList_GET_ITEM(__pyx_t_7, __pyx_t_3); __Pyx_INCREF(__pyx_t_5); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 393, __pyx_L1_error)
    #else
    __pyx_t_5 = PySequence_ITEM(__pyx_t_7, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 393, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    #endif
    __Pyx_XDECREF_SET(__pyx_v_x, __pyx_t_5);
    __pyx_t_5 = 0;
    __pyx_t_5 = __Pyx_GetItemInt(__pyx_v_x, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 393, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_x, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 393, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_10 = PyList_New(2); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 393, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_10);
    __Pyx_GIVEREF(__pyx_t_5);
    PyList_SET_ITEM(__pyx_t_10, 0, __pyx_t_5);
    __Pyx_GIVEREF(__pyx_t_1);
    PyList_SET_ITEM(__pyx_t_10, 1, __pyx_t_1);
    __pyx_t_5 = 0;
    __pyx_t_1 = 0;
    if (unlikely(__Pyx_ListComp_Append(__pyx_t_6, (PyObject*)__pyx_t_10))) __PYX_ERR(0, 393, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
  }
  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_v_kept_region = ((PyObject*)__pyx_t_6);
  __pyx_t_6 = 0;

  /* "vapor_vali/Simple_function.pyx":394
 *             kept_dot.append([temp[i] for i in y])
 *     kept_region=[[x[0],x[1]] for x in kept_dot]
 *     out=[]             # <<<<<<<<<<<<<<
 *     for x in kept_dot:    out+=x
 *     return [out,kept_region]
 */
  __pyx_t_6 = PyList_New(0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 394, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_v_out = __pyx_t_6;
  __pyx_t_6 = 0;

  /* "vapor_vali/Simple_function.pyx":395
 *     kept_region=[[x[0],x[1]] for x in kept_dot]
 *     out=[]
 *     for x in kept_dot:    out+=x             # <<<<<<<<<<<<<<
 *     return [out,kept_region]
 * 
 */
  __pyx_t_6 = __pyx_v_kept_dot; __Pyx_INCREF(__pyx_t_6); __pyx_t_3 = 0;
  for (;;) {
    if (__pyx_t_3 >= PyList_GET_SIZE(__pyx_t_6)) break;
    #if CYTHON_COMPILING_IN_CPYTHON
    __pyx_t_7 = PyList_GET_ITEM(__pyx_t_6, __pyx_t_3); __Pyx_INCREF(__pyx_t_7); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 395, __pyx_L1_error)
    #else
    __pyx_t_7 = PySequence_ITEM(__pyx_t_6, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 395, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    #endif
    __Pyx_XDECREF_SET(__pyx_v_x, __pyx_t_7);
    __pyx_t_7 = 0;
    __pyx_t_7 = PyNumber_InPlaceAdd(__pyx_v_out, __pyx_v_x); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 395, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    __Pyx_DECREF_SET(__pyx_v_out, __pyx_t_7);
    __pyx_t_7 = 0;
  }
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

  /* "vapor_vali/Simple_function.pyx":396
 *     out=[]
 *     for x in kept_dot:    out+=x
 *     return [out,kept_region]             # <<<<<<<<<<<<<<
 * 
 * def clean_dotdata_diagnal_m1b(ref_dotdata):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_6 = PyList_New(2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 396, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_INCREF(__pyx_v_out);
  __Pyx_GIVEREF(__pyx_v_out);
  PyList_SET_ITEM(__pyx_t_6, 0, __pyx_v_out);
  __Pyx_INCREF(__pyx_v_kept_region);
  __Pyx_GIVEREF(__pyx_v_kept_region);
  PyList_SET_ITEM(__pyx_t_6, 1, __pyx_v_kept_region);
  __pyx_r = __pyx_t_6;
  __pyx_t_6 = 0;
  goto __pyx_L0;

  /* "vapor_vali/Simple_function.pyx":381
 *     return out
 * 
 * def clean_dotdata_m1(ref_dotdata):             # <<<<<<<<<<<<<<
 *     #cluster dots based on their distance to diagnal
 *     x_axis=[i[0] for i in ref_dotdata]
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_XDECREF(__pyx_t_7);
  __Pyx_XDECREF(__pyx_t_10);
  __Pyx_AddTraceback("vapor_vali.Simple_function.clean_dotdata_m1", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_x_axis);
  __Pyx_XDECREF(__pyx_v_y_axis);
  __Pyx_XDECREF(__pyx_v_dis_to_diagnal);
  __Pyx_XDECREF(__pyx_v_kept_dot_pos);
  __Pyx_XDECREF(__pyx_v_kept_dot);
  __Pyx_XDECREF(__pyx_v_x);
  __Pyx_XDECREF(__pyx_v_temp);
  __Pyx_XDECREF(__pyx_v_kept_dot_cluster);
  __Pyx_XDECREF(__pyx_v_y);
  __Pyx_XDECREF(__pyx_v_kept_region);
  __Pyx_XDECREF(__pyx_v_out);
  __Pyx_XDECREF(__pyx_v_i);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "vapor_vali/Simple_function.pyx":398
 *     return [out,kept_region]
 * 
 * def clean_dotdata_diagnal_m1b(ref_dotdata):             # <<<<<<<<<<<<<<
 *     #cluster dots based on their distance to diagnal
 *     if ref_dotdata==[]:    return [[],[]]
 */

/* Python wrapper */
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_47clean_dotdata_diagnal_m1b(PyObject *__pyx_self, PyObject *__pyx_v_ref_dotdata); /*proto*/
static PyMethodDef __pyx_mdef_10vapor_vali_15Simple_function_47clean_dotdata_diagnal_m1b = {"clean_dotdata_diagnal_m1b", (PyCFunction)__pyx_pw_10vapor_vali_15Simple_function_47clean_dotdata_diagnal_m1b, METH_O, 0};
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_47clean_dotdata_diagnal_m1b(PyObject *__pyx_self, PyObject *__pyx_v_ref_dotdata) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("clean_dotdata_diagnal_m1b (wrapper)", 0);
  __pyx_r = __pyx_pf_10vapor_vali_15Simple_function_46clean_dotdata_diagnal_m1b(__pyx_self, ((PyObject *)__pyx_v_ref_dotdata));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10vapor_vali_15Simple_function_46clean_dotdata_diagnal_m1b(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_ref_dotdata) {
  PyObject *__pyx_v_x_axis = NULL;
  PyObject *__pyx_v_y_axis = NULL;
  PyObject *__pyx_v_dis_to_diagnal = NULL;
  PyObject *__pyx_v_kept_dot_pos = NULL;
  PyObject *__pyx_v_kept_dot = NULL;
  PyObject *__pyx_v_x = NULL;
  PyObject *__pyx_v_temp = NULL;
  PyObject *__pyx_v_kept_region = NULL;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  int __pyx_t_3;
  PyObject *__pyx_t_4 = NULL;
  Py_ssize_t __pyx_t_5;
  PyObject *(*__pyx_t_6)(PyObject *);
  PyObject *__pyx_t_7 = NULL;
  PyObject *__pyx_t_8 = NULL;
  Py_ssize_t __pyx_t_9;
  PyObject *(*__pyx_t_10)(PyObject *);
  PyObject *__pyx_t_11 = NULL;
  __Pyx_RefNannySetupContext("clean_dotdata_diagnal_m1b", 0);

  /* "vapor_vali/Simple_function.pyx":400
 * def clean_dotdata_diagnal_m1b(ref_dotdata):
 *     #cluster dots based on their distance to diagnal
 *     if ref_dotdata==[]:    return [[],[]]             # <<<<<<<<<<<<<<
 *     x_axis=[i[0] for i in ref_dotdata]
 *     y_axis=[i[1] for i in ref_dotdata]
 */
  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 400, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = PyObject_RichCompare(__pyx_v_ref_dotdata, __pyx_t_1, Py_EQ); __Pyx_XGOTREF(__pyx_t_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 400, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_3 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_3 < 0)) __PYX_ERR(0, 400, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  if (__pyx_t_3) {
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = PyList_New(0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 400, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 400, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_4 = PyList_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 400, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_GIVEREF(__pyx_t_2);
    PyList_SET_ITEM(__pyx_t_4, 0, __pyx_t_2);
    __Pyx_GIVEREF(__pyx_t_1);
    PyList_SET_ITEM(__pyx_t_4, 1, __pyx_t_1);
    __pyx_t_2 = 0;
    __pyx_t_1 = 0;
    __pyx_r = __pyx_t_4;
    __pyx_t_4 = 0;
    goto __pyx_L0;
  }

  /* "vapor_vali/Simple_function.pyx":401
 *     #cluster dots based on their distance to diagnal
 *     if ref_dotdata==[]:    return [[],[]]
 *     x_axis=[i[0] for i in ref_dotdata]             # <<<<<<<<<<<<<<
 *     y_axis=[i[1] for i in ref_dotdata]
 *     dis_to_diagnal=[y_axis[i]-x_axis[i] for i in range(len(x_axis))]
 */
  __pyx_t_4 = PyList_New(0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 401, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  if (likely(PyList_CheckExact(__pyx_v_ref_dotdata)) || PyTuple_CheckExact(__pyx_v_ref_dotdata)) {
    __pyx_t_1 = __pyx_v_ref_dotdata; __Pyx_INCREF(__pyx_t_1); __pyx_t_5 = 0;
    __pyx_t_6 = NULL;
  } else {
    __pyx_t_5 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_v_ref_dotdata); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 401, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_6 = Py_TYPE(__pyx_t_1)->tp_iternext; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 401, __pyx_L1_error)
  }
  for (;;) {
    if (likely(!__pyx_t_6)) {
      if (likely(PyList_CheckExact(__pyx_t_1))) {
        if (__pyx_t_5 >= PyList_GET_SIZE(__pyx_t_1)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_2 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_5); __Pyx_INCREF(__pyx_t_2); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 401, __pyx_L1_error)
        #else
        __pyx_t_2 = PySequence_ITEM(__pyx_t_1, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 401, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
        #endif
      } else {
        if (__pyx_t_5 >= PyTuple_GET_SIZE(__pyx_t_1)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_2 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_5); __Pyx_INCREF(__pyx_t_2); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 401, __pyx_L1_error)
        #else
        __pyx_t_2 = PySequence_ITEM(__pyx_t_1, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 401, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
        #endif
      }
    } else {
      __pyx_t_2 = __pyx_t_6(__pyx_t_1);
      if (unlikely(!__pyx_t_2)) {
        PyObject* exc_type = PyErr_Occurred();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
          else __PYX_ERR(0, 401, __pyx_L1_error)
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_2);
    }
    __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_2);
    __pyx_t_2 = 0;
    __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_i, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 401, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    if (unlikely(__Pyx_ListComp_Append(__pyx_t_4, (PyObject*)__pyx_t_2))) __PYX_ERR(0, 401, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  }
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_x_axis = ((PyObject*)__pyx_t_4);
  __pyx_t_4 = 0;

  /* "vapor_vali/Simple_function.pyx":402
 *     if ref_dotdata==[]:    return [[],[]]
 *     x_axis=[i[0] for i in ref_dotdata]
 *     y_axis=[i[1] for i in ref_dotdata]             # <<<<<<<<<<<<<<
 *     dis_to_diagnal=[y_axis[i]-x_axis[i] for i in range(len(x_axis))]
 *     kept_dot_pos=dis_cluster(dis_to_diagnal,dis_cff=10)
 */
  __pyx_t_4 = PyList_New(0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 402, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  if (likely(PyList_CheckExact(__pyx_v_ref_dotdata)) || PyTuple_CheckExact(__pyx_v_ref_dotdata)) {
    __pyx_t_1 = __pyx_v_ref_dotdata; __Pyx_INCREF(__pyx_t_1); __pyx_t_5 = 0;
    __pyx_t_6 = NULL;
  } else {
    __pyx_t_5 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_v_ref_dotdata); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 402, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_6 = Py_TYPE(__pyx_t_1)->tp_iternext; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 402, __pyx_L1_error)
  }
  for (;;) {
    if (likely(!__pyx_t_6)) {
      if (likely(PyList_CheckExact(__pyx_t_1))) {
        if (__pyx_t_5 >= PyList_GET_SIZE(__pyx_t_1)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_2 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_5); __Pyx_INCREF(__pyx_t_2); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 402, __pyx_L1_error)
        #else
        __pyx_t_2 = PySequence_ITEM(__pyx_t_1, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 402, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
        #endif
      } else {
        if (__pyx_t_5 >= PyTuple_GET_SIZE(__pyx_t_1)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_2 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_5); __Pyx_INCREF(__pyx_t_2); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 402, __pyx_L1_error)
        #else
        __pyx_t_2 = PySequence_ITEM(__pyx_t_1, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 402, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
        #endif
      }
    } else {
      __pyx_t_2 = __pyx_t_6(__pyx_t_1);
      if (unlikely(!__pyx_t_2)) {
        PyObject* exc_type = PyErr_Occurred();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
          else __PYX_ERR(0, 402, __pyx_L1_error)
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_2);
    }
    __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_2);
    __pyx_t_2 = 0;
    __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_i, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 402, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    if (unlikely(__Pyx_ListComp_Append(__pyx_t_4, (PyObject*)__pyx_t_2))) __PYX_ERR(0, 402, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  }
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_y_axis = ((PyObject*)__pyx_t_4);
  __pyx_t_4 = 0;

  /* "vapor_vali/Simple_function.pyx":403
 *     x_axis=[i[0] for i in ref_dotdata]
 *     y_axis=[i[1] for i in ref_dotdata]
 *     dis_to_diagnal=[y_axis[i]-x_axis[i] for i in range(len(x_axis))]             # <<<<<<<<<<<<<<
 *     kept_dot_pos=dis_cluster(dis_to_diagnal,dis_cff=10)
 *     kept_dot=[]
 */
  __pyx_t_4 = PyList_New(0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 403, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_5 = PyList_GET_SIZE(__pyx_v_x_axis); if (unlikely(__pyx_t_5 == -1)) __PYX_ERR(0, 403, __pyx_L1_error)
  __pyx_t_1 = PyInt_FromSsize_t(__pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 403, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 403, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_GIVEREF(__pyx_t_1);
  PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_t_2, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 403, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  if (likely(PyList_CheckExact(__pyx_t_1)) || PyTuple_CheckExact(__pyx_t_1)) {
    __pyx_t_2 = __pyx_t_1; __Pyx_INCREF(__pyx_t_2); __pyx_t_5 = 0;
    __pyx_t_6 = NULL;
  } else {
    __pyx_t_5 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 403, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_6 = Py_TYPE(__pyx_t_2)->tp_iternext; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 403, __pyx_L1_error)
  }
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  for (;;) {
    if (likely(!__pyx_t_6)) {
      if (likely(PyList_CheckExact(__pyx_t_2))) {
        if (__pyx_t_5 >= PyList_GET_SIZE(__pyx_t_2)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_1 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_5); __Pyx_INCREF(__pyx_t_1); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 403, __pyx_L1_error)
        #else
        __pyx_t_1 = PySequence_ITEM(__pyx_t_2, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 403, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        #endif
      } else {
        if (__pyx_t_5 >= PyTuple_GET_SIZE(__pyx_t_2)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_5); __Pyx_INCREF(__pyx_t_1); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 403, __pyx_L1_error)
        #else
        __pyx_t_1 = PySequence_ITEM(__pyx_t_2, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 403, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        #endif
      }
    } else {
      __pyx_t_1 = __pyx_t_6(__pyx_t_2);
      if (unlikely(!__pyx_t_1)) {
        PyObject* exc_type = PyErr_Occurred();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
          else __PYX_ERR(0, 403, __pyx_L1_error)
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_1);
    }
    __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_1);
    __pyx_t_1 = 0;
    __pyx_t_1 = PyObject_GetItem(__pyx_v_y_axis, __pyx_v_i); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 403, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_7 = PyObject_GetItem(__pyx_v_x_axis, __pyx_v_i); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 403, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    __pyx_t_8 = PyNumber_Subtract(__pyx_t_1, __pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 403, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_8);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
    if (unlikely(__Pyx_ListComp_Append(__pyx_t_4, (PyObject*)__pyx_t_8))) __PYX_ERR(0, 403, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
  }
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_dis_to_diagnal = ((PyObject*)__pyx_t_4);
  __pyx_t_4 = 0;

  /* "vapor_vali/Simple_function.pyx":404
 *     y_axis=[i[1] for i in ref_dotdata]
 *     dis_to_diagnal=[y_axis[i]-x_axis[i] for i in range(len(x_axis))]
 *     kept_dot_pos=dis_cluster(dis_to_diagnal,dis_cff=10)             # <<<<<<<<<<<<<<
 *     kept_dot=[]
 *     for x in kept_dot_pos:
 */
  __pyx_t_4 = __Pyx_GetModuleGlobalName(__pyx_n_s_dis_cluster); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 404, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 404, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_INCREF(__pyx_v_dis_to_diagnal);
  __Pyx_GIVEREF(__pyx_v_dis_to_diagnal);
  PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_v_dis_to_diagnal);
  __pyx_t_8 = PyDict_New(); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 404, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_8);
  if (PyDict_SetItem(__pyx_t_8, __pyx_n_s_dis_cff, __pyx_int_10) < 0) __PYX_ERR(0, 404, __pyx_L1_error)
  __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_2, __pyx_t_8); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 404, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
  __pyx_v_kept_dot_pos = __pyx_t_7;
  __pyx_t_7 = 0;

  /* "vapor_vali/Simple_function.pyx":405
 *     dis_to_diagnal=[y_axis[i]-x_axis[i] for i in range(len(x_axis))]
 *     kept_dot_pos=dis_cluster(dis_to_diagnal,dis_cff=10)
 *     kept_dot=[]             # <<<<<<<<<<<<<<
 *     for x in kept_dot_pos:
 *         temp=[[x_axis[i],y_axis[i]] for i in x]
 */
  __pyx_t_7 = PyList_New(0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 405, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  __pyx_v_kept_dot = ((PyObject*)__pyx_t_7);
  __pyx_t_7 = 0;

  /* "vapor_vali/Simple_function.pyx":406
 *     kept_dot_pos=dis_cluster(dis_to_diagnal,dis_cff=10)
 *     kept_dot=[]
 *     for x in kept_dot_pos:             # <<<<<<<<<<<<<<
 *         temp=[[x_axis[i],y_axis[i]] for i in x]
 *         kept_dot+=temp
 */
  if (likely(PyList_CheckExact(__pyx_v_kept_dot_pos)) || PyTuple_CheckExact(__pyx_v_kept_dot_pos)) {
    __pyx_t_7 = __pyx_v_kept_dot_pos; __Pyx_INCREF(__pyx_t_7); __pyx_t_5 = 0;
    __pyx_t_6 = NULL;
  } else {
    __pyx_t_5 = -1; __pyx_t_7 = PyObject_GetIter(__pyx_v_kept_dot_pos); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 406, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    __pyx_t_6 = Py_TYPE(__pyx_t_7)->tp_iternext; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 406, __pyx_L1_error)
  }
  for (;;) {
    if (likely(!__pyx_t_6)) {
      if (likely(PyList_CheckExact(__pyx_t_7))) {
        if (__pyx_t_5 >= PyList_GET_SIZE(__pyx_t_7)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_8 = PyList_GET_ITEM(__pyx_t_7, __pyx_t_5); __Pyx_INCREF(__pyx_t_8); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 406, __pyx_L1_error)
        #else
        __pyx_t_8 = PySequence_ITEM(__pyx_t_7, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 406, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_8);
        #endif
      } else {
        if (__pyx_t_5 >= PyTuple_GET_SIZE(__pyx_t_7)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_8 = PyTuple_GET_ITEM(__pyx_t_7, __pyx_t_5); __Pyx_INCREF(__pyx_t_8); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 406, __pyx_L1_error)
        #else
        __pyx_t_8 = PySequence_ITEM(__pyx_t_7, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 406, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_8);
        #endif
      }
    } else {
      __pyx_t_8 = __pyx_t_6(__pyx_t_7);
      if (unlikely(!__pyx_t_8)) {
        PyObject* exc_type = PyErr_Occurred();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
          else __PYX_ERR(0, 406, __pyx_L1_error)
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_8);
    }
    __Pyx_XDECREF_SET(__pyx_v_x, __pyx_t_8);
    __pyx_t_8 = 0;

    /* "vapor_vali/Simple_function.pyx":407
 *     kept_dot=[]
 *     for x in kept_dot_pos:
 *         temp=[[x_axis[i],y_axis[i]] for i in x]             # <<<<<<<<<<<<<<
 *         kept_dot+=temp
 *     kept_region=[[x[0],x[1]] for x in kept_dot]
 */
    __pyx_t_8 = PyList_New(0); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 407, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_8);
    if (likely(PyList_CheckExact(__pyx_v_x)) || PyTuple_CheckExact(__pyx_v_x)) {
      __pyx_t_2 = __pyx_v_x; __Pyx_INCREF(__pyx_t_2); __pyx_t_9 = 0;
      __pyx_t_10 = NULL;
    } else {
      __pyx_t_9 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_v_x); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 407, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __pyx_t_10 = Py_TYPE(__pyx_t_2)->tp_iternext; if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 407, __pyx_L1_error)
    }
    for (;;) {
      if (likely(!__pyx_t_10)) {
        if (likely(PyList_CheckExact(__pyx_t_2))) {
          if (__pyx_t_9 >= PyList_GET_SIZE(__pyx_t_2)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_4 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_9); __Pyx_INCREF(__pyx_t_4); __pyx_t_9++; if (unlikely(0 < 0)) __PYX_ERR(0, 407, __pyx_L1_error)
          #else
          __pyx_t_4 = PySequence_ITEM(__pyx_t_2, __pyx_t_9); __pyx_t_9++; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 407, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_4);
          #endif
        } else {
          if (__pyx_t_9 >= PyTuple_GET_SIZE(__pyx_t_2)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_4 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_9); __Pyx_INCREF(__pyx_t_4); __pyx_t_9++; if (unlikely(0 < 0)) __PYX_ERR(0, 407, __pyx_L1_error)
          #else
          __pyx_t_4 = PySequence_ITEM(__pyx_t_2, __pyx_t_9); __pyx_t_9++; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 407, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_4);
          #endif
        }
      } else {
        __pyx_t_4 = __pyx_t_10(__pyx_t_2);
        if (unlikely(!__pyx_t_4)) {
          PyObject* exc_type = PyErr_Occurred();
          if (exc_type) {
            if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
            else __PYX_ERR(0, 407, __pyx_L1_error)
          }
          break;
        }
        __Pyx_GOTREF(__pyx_t_4);
      }
      __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_4);
      __pyx_t_4 = 0;
      __pyx_t_4 = PyObject_GetItem(__pyx_v_x_axis, __pyx_v_i); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 407, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_t_1 = PyObject_GetItem(__pyx_v_y_axis, __pyx_v_i); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 407, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __pyx_t_11 = PyList_New(2); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 407, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_11);
      __Pyx_GIVEREF(__pyx_t_4);
      PyList_SET_ITEM(__pyx_t_11, 0, __pyx_t_4);
      __Pyx_GIVEREF(__pyx_t_1);
      PyList_SET_ITEM(__pyx_t_11, 1, __pyx_t_1);
      __pyx_t_4 = 0;
      __pyx_t_1 = 0;
      if (unlikely(__Pyx_ListComp_Append(__pyx_t_8, (PyObject*)__pyx_t_11))) __PYX_ERR(0, 407, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
    }
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __Pyx_XDECREF_SET(__pyx_v_temp, ((PyObject*)__pyx_t_8));
    __pyx_t_8 = 0;

    /* "vapor_vali/Simple_function.pyx":408
 *     for x in kept_dot_pos:
 *         temp=[[x_axis[i],y_axis[i]] for i in x]
 *         kept_dot+=temp             # <<<<<<<<<<<<<<
 *     kept_region=[[x[0],x[1]] for x in kept_dot]
 *     return [kept_dot,kept_region]
 */
    __pyx_t_8 = PyNumber_InPlaceAdd(__pyx_v_kept_dot, __pyx_v_temp); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 408, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_8);
    __Pyx_DECREF_SET(__pyx_v_kept_dot, ((PyObject*)__pyx_t_8));
    __pyx_t_8 = 0;

    /* "vapor_vali/Simple_function.pyx":406
 *     kept_dot_pos=dis_cluster(dis_to_diagnal,dis_cff=10)
 *     kept_dot=[]
 *     for x in kept_dot_pos:             # <<<<<<<<<<<<<<
 *         temp=[[x_axis[i],y_axis[i]] for i in x]
 *         kept_dot+=temp
 */
  }
  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;

  /* "vapor_vali/Simple_function.pyx":409
 *         temp=[[x_axis[i],y_axis[i]] for i in x]
 *         kept_dot+=temp
 *     kept_region=[[x[0],x[1]] for x in kept_dot]             # <<<<<<<<<<<<<<
 *     return [kept_dot,kept_region]
 * 
 */
  __pyx_t_7 = PyList_New(0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 409, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  __pyx_t_8 = __pyx_v_kept_dot; __Pyx_INCREF(__pyx_t_8); __pyx_t_5 = 0;
  for (;;) {
    if (__pyx_t_5 >= PyList_GET_SIZE(__pyx_t_8)) break;
    #if CYTHON_COMPILING_IN_CPYTHON
    __pyx_t_2 = PyList_GET_ITEM(__pyx_t_8, __pyx_t_5); __Pyx_INCREF(__pyx_t_2); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 409, __pyx_L1_error)
    #else
    __pyx_t_2 = PySequence_ITEM(__pyx_t_8, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 409, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    #endif
    __Pyx_XDECREF_SET(__pyx_v_x, __pyx_t_2);
    __pyx_t_2 = 0;
    __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_x, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 409, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_11 = __Pyx_GetItemInt(__pyx_v_x, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 409, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_11);
    __pyx_t_1 = PyList_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 409, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_GIVEREF(__pyx_t_2);
    PyList_SET_ITEM(__pyx_t_1, 0, __pyx_t_2);
    __Pyx_GIVEREF(__pyx_t_11);
    PyList_SET_ITEM(__pyx_t_1, 1, __pyx_t_11);
    __pyx_t_2 = 0;
    __pyx_t_11 = 0;
    if (unlikely(__Pyx_ListComp_Append(__pyx_t_7, (PyObject*)__pyx_t_1))) __PYX_ERR(0, 409, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  }
  __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
  __pyx_v_kept_region = ((PyObject*)__pyx_t_7);
  __pyx_t_7 = 0;

  /* "vapor_vali/Simple_function.pyx":410
 *         kept_dot+=temp
 *     kept_region=[[x[0],x[1]] for x in kept_dot]
 *     return [kept_dot,kept_region]             # <<<<<<<<<<<<<<
 * 
 * def clean_dotdata_anti_diagnal_m1b(ref_dotdata):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_7 = PyList_New(2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 410, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  __Pyx_INCREF(__pyx_v_kept_dot);
  __Pyx_GIVEREF(__pyx_v_kept_dot);
  PyList_SET_ITEM(__pyx_t_7, 0, __pyx_v_kept_dot);
  __Pyx_INCREF(__pyx_v_kept_region);
  __Pyx_GIVEREF(__pyx_v_kept_region);
  PyList_SET_ITEM(__pyx_t_7, 1, __pyx_v_kept_region);
  __pyx_r = __pyx_t_7;
  __pyx_t_7 = 0;
  goto __pyx_L0;

  /* "vapor_vali/Simple_function.pyx":398
 *     return [out,kept_region]
 * 
 * def clean_dotdata_diagnal_m1b(ref_dotdata):             # <<<<<<<<<<<<<<
 *     #cluster dots based on their distance to diagnal
 *     if ref_dotdata==[]:    return [[],[]]
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_7);
  __Pyx_XDECREF(__pyx_t_8);
  __Pyx_XDECREF(__pyx_t_11);
  __Pyx_AddTraceback("vapor_vali.Simple_function.clean_dotdata_diagnal_m1b", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_x_axis);
  __Pyx_XDECREF(__pyx_v_y_axis);
  __Pyx_XDECREF(__pyx_v_dis_to_diagnal);
  __Pyx_XDECREF(__pyx_v_kept_dot_pos);
  __Pyx_XDECREF(__pyx_v_kept_dot);
  __Pyx_XDECREF(__pyx_v_x);
  __Pyx_XDECREF(__pyx_v_temp);
  __Pyx_XDECREF(__pyx_v_kept_region);
  __Pyx_XDECREF(__pyx_v_i);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "vapor_vali/Simple_function.pyx":412
 *     return [kept_dot,kept_region]
 * 
 * def clean_dotdata_anti_diagnal_m1b(ref_dotdata):             # <<<<<<<<<<<<<<
 *     #cluster dots based on their distance to diagnal
 *     if ref_dotdata==[]:    return [[],[]]
 */

/* Python wrapper */
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_49clean_dotdata_anti_diagnal_m1b(PyObject *__pyx_self, PyObject *__pyx_v_ref_dotdata); /*proto*/
static PyMethodDef __pyx_mdef_10vapor_vali_15Simple_function_49clean_dotdata_anti_diagnal_m1b = {"clean_dotdata_anti_diagnal_m1b", (PyCFunction)__pyx_pw_10vapor_vali_15Simple_function_49clean_dotdata_anti_diagnal_m1b, METH_O, 0};
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_49clean_dotdata_anti_diagnal_m1b(PyObject *__pyx_self, PyObject *__pyx_v_ref_dotdata) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("clean_dotdata_anti_diagnal_m1b (wrapper)", 0);
  __pyx_r = __pyx_pf_10vapor_vali_15Simple_function_48clean_dotdata_anti_diagnal_m1b(__pyx_self, ((PyObject *)__pyx_v_ref_dotdata));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10vapor_vali_15Simple_function_48clean_dotdata_anti_diagnal_m1b(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_ref_dotdata) {
  PyObject *__pyx_v_x_axis = NULL;
  PyObject *__pyx_v_y_axis = NULL;
  PyObject *__pyx_v_dis_to_diagnal = NULL;
  PyObject *__pyx_v_kept_dot_pos = NULL;
  PyObject *__pyx_v_kept_dot = NULL;
  PyObject *__pyx_v_x = NULL;
  PyObject *__pyx_v_temp = NULL;
  PyObject *__pyx_v_kept_region = NULL;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  int __pyx_t_3;
  PyObject *__pyx_t_4 = NULL;
  Py_ssize_t __pyx_t_5;
  PyObject *(*__pyx_t_6)(PyObject *);
  PyObject *__pyx_t_7 = NULL;
  PyObject *__pyx_t_8 = NULL;
  Py_ssize_t __pyx_t_9;
  PyObject *(*__pyx_t_10)(PyObject *);
  PyObject *__pyx_t_11 = NULL;
  __Pyx_RefNannySetupContext("clean_dotdata_anti_diagnal_m1b", 0);

  /* "vapor_vali/Simple_function.pyx":414
 * def clean_dotdata_anti_diagnal_m1b(ref_dotdata):
 *     #cluster dots based on their distance to diagnal
 *     if ref_dotdata==[]:    return [[],[]]             # <<<<<<<<<<<<<<
 *     x_axis=[i[0] for i in ref_dotdata]
 *     y_axis=[i[1] for i in ref_dotdata]
 */
  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 414, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = PyObject_RichCompare(__pyx_v_ref_dotdata, __pyx_t_1, Py_EQ); __Pyx_XGOTREF(__pyx_t_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 414, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_3 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_3 < 0)) __PYX_ERR(0, 414, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  if (__pyx_t_3) {
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = PyList_New(0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 414, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 414, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_4 = PyList_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 414, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_GIVEREF(__pyx_t_2);
    PyList_SET_ITEM(__pyx_t_4, 0, __pyx_t_2);
    __Pyx_GIVEREF(__pyx_t_1);
    PyList_SET_ITEM(__pyx_t_4, 1, __pyx_t_1);
    __pyx_t_2 = 0;
    __pyx_t_1 = 0;
    __pyx_r = __pyx_t_4;
    __pyx_t_4 = 0;
    goto __pyx_L0;
  }

  /* "vapor_vali/Simple_function.pyx":415
 *     #cluster dots based on their distance to diagnal
 *     if ref_dotdata==[]:    return [[],[]]
 *     x_axis=[i[0] for i in ref_dotdata]             # <<<<<<<<<<<<<<
 *     y_axis=[i[1] for i in ref_dotdata]
 *     dis_to_diagnal=[y_axis[i]+x_axis[i] for i in range(len(x_axis))]
 */
  __pyx_t_4 = PyList_New(0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 415, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  if (likely(PyList_CheckExact(__pyx_v_ref_dotdata)) || PyTuple_CheckExact(__pyx_v_ref_dotdata)) {
    __pyx_t_1 = __pyx_v_ref_dotdata; __Pyx_INCREF(__pyx_t_1); __pyx_t_5 = 0;
    __pyx_t_6 = NULL;
  } else {
    __pyx_t_5 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_v_ref_dotdata); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 415, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_6 = Py_TYPE(__pyx_t_1)->tp_iternext; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 415, __pyx_L1_error)
  }
  for (;;) {
    if (likely(!__pyx_t_6)) {
      if (likely(PyList_CheckExact(__pyx_t_1))) {
        if (__pyx_t_5 >= PyList_GET_SIZE(__pyx_t_1)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_2 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_5); __Pyx_INCREF(__pyx_t_2); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 415, __pyx_L1_error)
        #else
        __pyx_t_2 = PySequence_ITEM(__pyx_t_1, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 415, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
        #endif
      } else {
        if (__pyx_t_5 >= PyTuple_GET_SIZE(__pyx_t_1)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_2 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_5); __Pyx_INCREF(__pyx_t_2); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 415, __pyx_L1_error)
        #else
        __pyx_t_2 = PySequence_ITEM(__pyx_t_1, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 415, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
        #endif
      }
    } else {
      __pyx_t_2 = __pyx_t_6(__pyx_t_1);
      if (unlikely(!__pyx_t_2)) {
        PyObject* exc_type = PyErr_Occurred();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
          else __PYX_ERR(0, 415, __pyx_L1_error)
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_2);
    }
    __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_2);
    __pyx_t_2 = 0;
    __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_i, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 415, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    if (unlikely(__Pyx_ListComp_Append(__pyx_t_4, (PyObject*)__pyx_t_2))) __PYX_ERR(0, 415, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  }
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_x_axis = ((PyObject*)__pyx_t_4);
  __pyx_t_4 = 0;

  /* "vapor_vali/Simple_function.pyx":416
 *     if ref_dotdata==[]:    return [[],[]]
 *     x_axis=[i[0] for i in ref_dotdata]
 *     y_axis=[i[1] for i in ref_dotdata]             # <<<<<<<<<<<<<<
 *     dis_to_diagnal=[y_axis[i]+x_axis[i] for i in range(len(x_axis))]
 *     kept_dot_pos=dis_cluster(dis_to_diagnal,dis_cff=10)
 */
  __pyx_t_4 = PyList_New(0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 416, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  if (likely(PyList_CheckExact(__pyx_v_ref_dotdata)) || PyTuple_CheckExact(__pyx_v_ref_dotdata)) {
    __pyx_t_1 = __pyx_v_ref_dotdata; __Pyx_INCREF(__pyx_t_1); __pyx_t_5 = 0;
    __pyx_t_6 = NULL;
  } else {
    __pyx_t_5 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_v_ref_dotdata); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 416, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_6 = Py_TYPE(__pyx_t_1)->tp_iternext; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 416, __pyx_L1_error)
  }
  for (;;) {
    if (likely(!__pyx_t_6)) {
      if (likely(PyList_CheckExact(__pyx_t_1))) {
        if (__pyx_t_5 >= PyList_GET_SIZE(__pyx_t_1)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_2 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_5); __Pyx_INCREF(__pyx_t_2); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 416, __pyx_L1_error)
        #else
        __pyx_t_2 = PySequence_ITEM(__pyx_t_1, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 416, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
        #endif
      } else {
        if (__pyx_t_5 >= PyTuple_GET_SIZE(__pyx_t_1)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_2 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_5); __Pyx_INCREF(__pyx_t_2); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 416, __pyx_L1_error)
        #else
        __pyx_t_2 = PySequence_ITEM(__pyx_t_1, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 416, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
        #endif
      }
    } else {
      __pyx_t_2 = __pyx_t_6(__pyx_t_1);
      if (unlikely(!__pyx_t_2)) {
        PyObject* exc_type = PyErr_Occurred();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
          else __PYX_ERR(0, 416, __pyx_L1_error)
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_2);
    }
    __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_2);
    __pyx_t_2 = 0;
    __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_i, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 416, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    if (unlikely(__Pyx_ListComp_Append(__pyx_t_4, (PyObject*)__pyx_t_2))) __PYX_ERR(0, 416, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  }
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_y_axis = ((PyObject*)__pyx_t_4);
  __pyx_t_4 = 0;

  /* "vapor_vali/Simple_function.pyx":417
 *     x_axis=[i[0] for i in ref_dotdata]
 *     y_axis=[i[1] for i in ref_dotdata]
 *     dis_to_diagnal=[y_axis[i]+x_axis[i] for i in range(len(x_axis))]             # <<<<<<<<<<<<<<
 *     kept_dot_pos=dis_cluster(dis_to_diagnal,dis_cff=10)
 *     kept_dot=[]
 */
  __pyx_t_4 = PyList_New(0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 417, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_5 = PyList_GET_SIZE(__pyx_v_x_axis); if (unlikely(__pyx_t_5 == -1)) __PYX_ERR(0, 417, __pyx_L1_error)
  __pyx_t_1 = PyInt_FromSsize_t(__pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 417, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 417, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_GIVEREF(__pyx_t_1);
  PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_t_2, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 417, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  if (likely(PyList_CheckExact(__pyx_t_1)) || PyTuple_CheckExact(__pyx_t_1)) {
    __pyx_t_2 = __pyx_t_1; __Pyx_INCREF(__pyx_t_2); __pyx_t_5 = 0;
    __pyx_t_6 = NULL;
  } else {
    __pyx_t_5 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 417, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_6 = Py_TYPE(__pyx_t_2)->tp_iternext; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 417, __pyx_L1_error)
  }
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  for (;;) {
    if (likely(!__pyx_t_6)) {
      if (likely(PyList_CheckExact(__pyx_t_2))) {
        if (__pyx_t_5 >= PyList_GET_SIZE(__pyx_t_2)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_1 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_5); __Pyx_INCREF(__pyx_t_1); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 417, __pyx_L1_error)
        #else
        __pyx_t_1 = PySequence_ITEM(__pyx_t_2, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 417, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        #endif
      } else {
        if (__pyx_t_5 >= PyTuple_GET_SIZE(__pyx_t_2)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_5); __Pyx_INCREF(__pyx_t_1); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 417, __pyx_L1_error)
        #else
        __pyx_t_1 = PySequence_ITEM(__pyx_t_2, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 417, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        #endif
      }
    } else {
      __pyx_t_1 = __pyx_t_6(__pyx_t_2);
      if (unlikely(!__pyx_t_1)) {
        PyObject* exc_type = PyErr_Occurred();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
          else __PYX_ERR(0, 417, __pyx_L1_error)
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_1);
    }
    __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_1);
    __pyx_t_1 = 0;
    __pyx_t_1 = PyObject_GetItem(__pyx_v_y_axis, __pyx_v_i); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 417, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_7 = PyObject_GetItem(__pyx_v_x_axis, __pyx_v_i); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 417, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    __pyx_t_8 = PyNumber_Add(__pyx_t_1, __pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 417, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_8);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
    if (unlikely(__Pyx_ListComp_Append(__pyx_t_4, (PyObject*)__pyx_t_8))) __PYX_ERR(0, 417, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
  }
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_dis_to_diagnal = ((PyObject*)__pyx_t_4);
  __pyx_t_4 = 0;

  /* "vapor_vali/Simple_function.pyx":418
 *     y_axis=[i[1] for i in ref_dotdata]
 *     dis_to_diagnal=[y_axis[i]+x_axis[i] for i in range(len(x_axis))]
 *     kept_dot_pos=dis_cluster(dis_to_diagnal,dis_cff=10)             # <<<<<<<<<<<<<<
 *     kept_dot=[]
 *     for x in kept_dot_pos:
 */
  __pyx_t_4 = __Pyx_GetModuleGlobalName(__pyx_n_s_dis_cluster); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 418, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 418, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_INCREF(__pyx_v_dis_to_diagnal);
  __Pyx_GIVEREF(__pyx_v_dis_to_diagnal);
  PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_v_dis_to_diagnal);
  __pyx_t_8 = PyDict_New(); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 418, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_8);
  if (PyDict_SetItem(__pyx_t_8, __pyx_n_s_dis_cff, __pyx_int_10) < 0) __PYX_ERR(0, 418, __pyx_L1_error)
  __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_2, __pyx_t_8); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 418, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
  __pyx_v_kept_dot_pos = __pyx_t_7;
  __pyx_t_7 = 0;

  /* "vapor_vali/Simple_function.pyx":419
 *     dis_to_diagnal=[y_axis[i]+x_axis[i] for i in range(len(x_axis))]
 *     kept_dot_pos=dis_cluster(dis_to_diagnal,dis_cff=10)
 *     kept_dot=[]             # <<<<<<<<<<<<<<
 *     for x in kept_dot_pos:
 *         temp=[[x_axis[i],y_axis[i]] for i in x]
 */
  __pyx_t_7 = PyList_New(0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 419, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  __pyx_v_kept_dot = ((PyObject*)__pyx_t_7);
  __pyx_t_7 = 0;

  /* "vapor_vali/Simple_function.pyx":420
 *     kept_dot_pos=dis_cluster(dis_to_diagnal,dis_cff=10)
 *     kept_dot=[]
 *     for x in kept_dot_pos:             # <<<<<<<<<<<<<<
 *         temp=[[x_axis[i],y_axis[i]] for i in x]
 *         kept_dot+=temp
 */
  if (likely(PyList_CheckExact(__pyx_v_kept_dot_pos)) || PyTuple_CheckExact(__pyx_v_kept_dot_pos)) {
    __pyx_t_7 = __pyx_v_kept_dot_pos; __Pyx_INCREF(__pyx_t_7); __pyx_t_5 = 0;
    __pyx_t_6 = NULL;
  } else {
    __pyx_t_5 = -1; __pyx_t_7 = PyObject_GetIter(__pyx_v_kept_dot_pos); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 420, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    __pyx_t_6 = Py_TYPE(__pyx_t_7)->tp_iternext; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 420, __pyx_L1_error)
  }
  for (;;) {
    if (likely(!__pyx_t_6)) {
      if (likely(PyList_CheckExact(__pyx_t_7))) {
        if (__pyx_t_5 >= PyList_GET_SIZE(__pyx_t_7)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_8 = PyList_GET_ITEM(__pyx_t_7, __pyx_t_5); __Pyx_INCREF(__pyx_t_8); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 420, __pyx_L1_error)
        #else
        __pyx_t_8 = PySequence_ITEM(__pyx_t_7, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 420, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_8);
        #endif
      } else {
        if (__pyx_t_5 >= PyTuple_GET_SIZE(__pyx_t_7)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_8 = PyTuple_GET_ITEM(__pyx_t_7, __pyx_t_5); __Pyx_INCREF(__pyx_t_8); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 420, __pyx_L1_error)
        #else
        __pyx_t_8 = PySequence_ITEM(__pyx_t_7, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 420, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_8);
        #endif
      }
    } else {
      __pyx_t_8 = __pyx_t_6(__pyx_t_7);
      if (unlikely(!__pyx_t_8)) {
        PyObject* exc_type = PyErr_Occurred();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
          else __PYX_ERR(0, 420, __pyx_L1_error)
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_8);
    }
    __Pyx_XDECREF_SET(__pyx_v_x, __pyx_t_8);
    __pyx_t_8 = 0;

    /* "vapor_vali/Simple_function.pyx":421
 *     kept_dot=[]
 *     for x in kept_dot_pos:
 *         temp=[[x_axis[i],y_axis[i]] for i in x]             # <<<<<<<<<<<<<<
 *         kept_dot+=temp
 *     kept_region=[[x[0],x[1]] for x in kept_dot]
 */
    __pyx_t_8 = PyList_New(0); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 421, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_8);
    if (likely(PyList_CheckExact(__pyx_v_x)) || PyTuple_CheckExact(__pyx_v_x)) {
      __pyx_t_2 = __pyx_v_x; __Pyx_INCREF(__pyx_t_2); __pyx_t_9 = 0;
      __pyx_t_10 = NULL;
    } else {
      __pyx_t_9 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_v_x); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 421, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __pyx_t_10 = Py_TYPE(__pyx_t_2)->tp_iternext; if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 421, __pyx_L1_error)
    }
    for (;;) {
      if (likely(!__pyx_t_10)) {
        if (likely(PyList_CheckExact(__pyx_t_2))) {
          if (__pyx_t_9 >= PyList_GET_SIZE(__pyx_t_2)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_4 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_9); __Pyx_INCREF(__pyx_t_4); __pyx_t_9++; if (unlikely(0 < 0)) __PYX_ERR(0, 421, __pyx_L1_error)
          #else
          __pyx_t_4 = PySequence_ITEM(__pyx_t_2, __pyx_t_9); __pyx_t_9++; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 421, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_4);
          #endif
        } else {
          if (__pyx_t_9 >= PyTuple_GET_SIZE(__pyx_t_2)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_4 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_9); __Pyx_INCREF(__pyx_t_4); __pyx_t_9++; if (unlikely(0 < 0)) __PYX_ERR(0, 421, __pyx_L1_error)
          #else
          __pyx_t_4 = PySequence_ITEM(__pyx_t_2, __pyx_t_9); __pyx_t_9++; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 421, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_4);
          #endif
        }
      } else {
        __pyx_t_4 = __pyx_t_10(__pyx_t_2);
        if (unlikely(!__pyx_t_4)) {
          PyObject* exc_type = PyErr_Occurred();
          if (exc_type) {
            if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
            else __PYX_ERR(0, 421, __pyx_L1_error)
          }
          break;
        }
        __Pyx_GOTREF(__pyx_t_4);
      }
      __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_4);
      __pyx_t_4 = 0;
      __pyx_t_4 = PyObject_GetItem(__pyx_v_x_axis, __pyx_v_i); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 421, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_t_1 = PyObject_GetItem(__pyx_v_y_axis, __pyx_v_i); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 421, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __pyx_t_11 = PyList_New(2); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 421, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_11);
      __Pyx_GIVEREF(__pyx_t_4);
      PyList_SET_ITEM(__pyx_t_11, 0, __pyx_t_4);
      __Pyx_GIVEREF(__pyx_t_1);
      PyList_SET_ITEM(__pyx_t_11, 1, __pyx_t_1);
      __pyx_t_4 = 0;
      __pyx_t_1 = 0;
      if (unlikely(__Pyx_ListComp_Append(__pyx_t_8, (PyObject*)__pyx_t_11))) __PYX_ERR(0, 421, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
    }
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __Pyx_XDECREF_SET(__pyx_v_temp, ((PyObject*)__pyx_t_8));
    __pyx_t_8 = 0;

    /* "vapor_vali/Simple_function.pyx":422
 *     for x in kept_dot_pos:
 *         temp=[[x_axis[i],y_axis[i]] for i in x]
 *         kept_dot+=temp             # <<<<<<<<<<<<<<
 *     kept_region=[[x[0],x[1]] for x in kept_dot]
 *     return [kept_dot,kept_region]
 */
    __pyx_t_8 = PyNumber_InPlaceAdd(__pyx_v_kept_dot, __pyx_v_temp); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 422, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_8);
    __Pyx_DECREF_SET(__pyx_v_kept_dot, ((PyObject*)__pyx_t_8));
    __pyx_t_8 = 0;

    /* "vapor_vali/Simple_function.pyx":420
 *     kept_dot_pos=dis_cluster(dis_to_diagnal,dis_cff=10)
 *     kept_dot=[]
 *     for x in kept_dot_pos:             # <<<<<<<<<<<<<<
 *         temp=[[x_axis[i],y_axis[i]] for i in x]
 *         kept_dot+=temp
 */
  }
  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;

  /* "vapor_vali/Simple_function.pyx":423
 *         temp=[[x_axis[i],y_axis[i]] for i in x]
 *         kept_dot+=temp
 *     kept_region=[[x[0],x[1]] for x in kept_dot]             # <<<<<<<<<<<<<<
 *     return [kept_dot,kept_region]
 * 
 */
  __pyx_t_7 = PyList_New(0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 423, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  __pyx_t_8 = __pyx_v_kept_dot; __Pyx_INCREF(__pyx_t_8); __pyx_t_5 = 0;
  for (;;) {
    if (__pyx_t_5 >= PyList_GET_SIZE(__pyx_t_8)) break;
    #if CYTHON_COMPILING_IN_CPYTHON
    __pyx_t_2 = PyList_GET_ITEM(__pyx_t_8, __pyx_t_5); __Pyx_INCREF(__pyx_t_2); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 423, __pyx_L1_error)
    #else
    __pyx_t_2 = PySequence_ITEM(__pyx_t_8, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 423, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    #endif
    __Pyx_XDECREF_SET(__pyx_v_x, __pyx_t_2);
    __pyx_t_2 = 0;
    __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_x, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 423, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_11 = __Pyx_GetItemInt(__pyx_v_x, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 423, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_11);
    __pyx_t_1 = PyList_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 423, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_GIVEREF(__pyx_t_2);
    PyList_SET_ITEM(__pyx_t_1, 0, __pyx_t_2);
    __Pyx_GIVEREF(__pyx_t_11);
    PyList_SET_ITEM(__pyx_t_1, 1, __pyx_t_11);
    __pyx_t_2 = 0;
    __pyx_t_11 = 0;
    if (unlikely(__Pyx_ListComp_Append(__pyx_t_7, (PyObject*)__pyx_t_1))) __PYX_ERR(0, 423, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  }
  __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
  __pyx_v_kept_region = ((PyObject*)__pyx_t_7);
  __pyx_t_7 = 0;

  /* "vapor_vali/Simple_function.pyx":424
 *         kept_dot+=temp
 *     kept_region=[[x[0],x[1]] for x in kept_dot]
 *     return [kept_dot,kept_region]             # <<<<<<<<<<<<<<
 * 
 * def clean_dotdata_diagnal_and_anti_diagnal(ref_dotdata):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_7 = PyList_New(2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 424, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  __Pyx_INCREF(__pyx_v_kept_dot);
  __Pyx_GIVEREF(__pyx_v_kept_dot);
  PyList_SET_ITEM(__pyx_t_7, 0, __pyx_v_kept_dot);
  __Pyx_INCREF(__pyx_v_kept_region);
  __Pyx_GIVEREF(__pyx_v_kept_region);
  PyList_SET_ITEM(__pyx_t_7, 1, __pyx_v_kept_region);
  __pyx_r = __pyx_t_7;
  __pyx_t_7 = 0;
  goto __pyx_L0;

  /* "vapor_vali/Simple_function.pyx":412
 *     return [kept_dot,kept_region]
 * 
 * def clean_dotdata_anti_diagnal_m1b(ref_dotdata):             # <<<<<<<<<<<<<<
 *     #cluster dots based on their distance to diagnal
 *     if ref_dotdata==[]:    return [[],[]]
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_7);
  __Pyx_XDECREF(__pyx_t_8);
  __Pyx_XDECREF(__pyx_t_11);
  __Pyx_AddTraceback("vapor_vali.Simple_function.clean_dotdata_anti_diagnal_m1b", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_x_axis);
  __Pyx_XDECREF(__pyx_v_y_axis);
  __Pyx_XDECREF(__pyx_v_dis_to_diagnal);
  __Pyx_XDECREF(__pyx_v_kept_dot_pos);
  __Pyx_XDECREF(__pyx_v_kept_dot);
  __Pyx_XDECREF(__pyx_v_x);
  __Pyx_XDECREF(__pyx_v_temp);
  __Pyx_XDECREF(__pyx_v_kept_region);
  __Pyx_XDECREF(__pyx_v_i);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "vapor_vali/Simple_function.pyx":426
 *     return [kept_dot,kept_region]
 * 
 * def clean_dotdata_diagnal_and_anti_diagnal(ref_dotdata):             # <<<<<<<<<<<<<<
 *     if ref_dotdata==[]:    return [[],[]]
 *     x_axis=[i[0] for i in ref_dotdata]
 */

/* Python wrapper */
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_51clean_dotdata_diagnal_and_anti_diagnal(PyObject *__pyx_self, PyObject *__pyx_v_ref_dotdata); /*proto*/
static PyMethodDef __pyx_mdef_10vapor_vali_15Simple_function_51clean_dotdata_diagnal_and_anti_diagnal = {"clean_dotdata_diagnal_and_anti_diagnal", (PyCFunction)__pyx_pw_10vapor_vali_15Simple_function_51clean_dotdata_diagnal_and_anti_diagnal, METH_O, 0};
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_51clean_dotdata_diagnal_and_anti_diagnal(PyObject *__pyx_self, PyObject *__pyx_v_ref_dotdata) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("clean_dotdata_diagnal_and_anti_diagnal (wrapper)", 0);
  __pyx_r = __pyx_pf_10vapor_vali_15Simple_function_50clean_dotdata_diagnal_and_anti_diagnal(__pyx_self, ((PyObject *)__pyx_v_ref_dotdata));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10vapor_vali_15Simple_function_50clean_dotdata_diagnal_and_anti_diagnal(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_ref_dotdata) {
  PyObject *__pyx_v_x_axis = NULL;
  PyObject *__pyx_v_y_axis = NULL;
  PyObject *__pyx_v_dis_to_diagnal = NULL;
  PyObject *__pyx_v_dis_to_anti_diagnal = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_kept_dot_diag = NULL;
  PyObject *__pyx_v_removed_dot_diag = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_kept_dot_anti_diag = NULL;
  PyObject *__pyx_v_removed_dot_anti_diag = NULL;
  PyObject *__pyx_v_rec = NULL;
  PyObject *__pyx_v_kept_dot = NULL;
  PyObject *__pyx_v_x = NULL;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  int __pyx_t_3;
  PyObject *__pyx_t_4 = NULL;
  Py_ssize_t __pyx_t_5;
  PyObject *(*__pyx_t_6)(PyObject *);
  PyObject *__pyx_t_7 = NULL;
  PyObject *__pyx_t_8 = NULL;
  PyObject *(*__pyx_t_9)(PyObject *);
  int __pyx_t_10;
  int __pyx_t_11;
  int __pyx_t_12;
  __Pyx_RefNannySetupContext("clean_dotdata_diagnal_and_anti_diagnal", 0);

  /* "vapor_vali/Simple_function.pyx":427
 * 
 * def clean_dotdata_diagnal_and_anti_diagnal(ref_dotdata):
 *     if ref_dotdata==[]:    return [[],[]]             # <<<<<<<<<<<<<<
 *     x_axis=[i[0] for i in ref_dotdata]
 *     y_axis=[i[1] for i in ref_dotdata]
 */
  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 427, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = PyObject_RichCompare(__pyx_v_ref_dotdata, __pyx_t_1, Py_EQ); __Pyx_XGOTREF(__pyx_t_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 427, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_3 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_3 < 0)) __PYX_ERR(0, 427, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  if (__pyx_t_3) {
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = PyList_New(0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 427, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 427, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_4 = PyList_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 427, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_GIVEREF(__pyx_t_2);
    PyList_SET_ITEM(__pyx_t_4, 0, __pyx_t_2);
    __Pyx_GIVEREF(__pyx_t_1);
    PyList_SET_ITEM(__pyx_t_4, 1, __pyx_t_1);
    __pyx_t_2 = 0;
    __pyx_t_1 = 0;
    __pyx_r = __pyx_t_4;
    __pyx_t_4 = 0;
    goto __pyx_L0;
  }

  /* "vapor_vali/Simple_function.pyx":428
 * def clean_dotdata_diagnal_and_anti_diagnal(ref_dotdata):
 *     if ref_dotdata==[]:    return [[],[]]
 *     x_axis=[i[0] for i in ref_dotdata]             # <<<<<<<<<<<<<<
 *     y_axis=[i[1] for i in ref_dotdata]
 *     dis_to_diagnal=[y_axis[i]-x_axis[i] for i in range(len(x_axis))]
 */
  __pyx_t_4 = PyList_New(0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 428, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  if (likely(PyList_CheckExact(__pyx_v_ref_dotdata)) || PyTuple_CheckExact(__pyx_v_ref_dotdata)) {
    __pyx_t_1 = __pyx_v_ref_dotdata; __Pyx_INCREF(__pyx_t_1); __pyx_t_5 = 0;
    __pyx_t_6 = NULL;
  } else {
    __pyx_t_5 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_v_ref_dotdata); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 428, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_6 = Py_TYPE(__pyx_t_1)->tp_iternext; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 428, __pyx_L1_error)
  }
  for (;;) {
    if (likely(!__pyx_t_6)) {
      if (likely(PyList_CheckExact(__pyx_t_1))) {
        if (__pyx_t_5 >= PyList_GET_SIZE(__pyx_t_1)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_2 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_5); __Pyx_INCREF(__pyx_t_2); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 428, __pyx_L1_error)
        #else
        __pyx_t_2 = PySequence_ITEM(__pyx_t_1, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 428, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
        #endif
      } else {
        if (__pyx_t_5 >= PyTuple_GET_SIZE(__pyx_t_1)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_2 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_5); __Pyx_INCREF(__pyx_t_2); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 428, __pyx_L1_error)
        #else
        __pyx_t_2 = PySequence_ITEM(__pyx_t_1, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 428, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
        #endif
      }
    } else {
      __pyx_t_2 = __pyx_t_6(__pyx_t_1);
      if (unlikely(!__pyx_t_2)) {
        PyObject* exc_type = PyErr_Occurred();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
          else __PYX_ERR(0, 428, __pyx_L1_error)
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_2);
    }
    __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_2);
    __pyx_t_2 = 0;
    __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_i, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 428, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    if (unlikely(__Pyx_ListComp_Append(__pyx_t_4, (PyObject*)__pyx_t_2))) __PYX_ERR(0, 428, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  }
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_x_axis = ((PyObject*)__pyx_t_4);
  __pyx_t_4 = 0;

  /* "vapor_vali/Simple_function.pyx":429
 *     if ref_dotdata==[]:    return [[],[]]
 *     x_axis=[i[0] for i in ref_dotdata]
 *     y_axis=[i[1] for i in ref_dotdata]             # <<<<<<<<<<<<<<
 *     dis_to_diagnal=[y_axis[i]-x_axis[i] for i in range(len(x_axis))]
 *     dis_to_anti_diagnal=[y_axis[i]+x_axis[i] for i in range(len(x_axis))]
 */
  __pyx_t_4 = PyList_New(0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 429, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  if (likely(PyList_CheckExact(__pyx_v_ref_dotdata)) || PyTuple_CheckExact(__pyx_v_ref_dotdata)) {
    __pyx_t_1 = __pyx_v_ref_dotdata; __Pyx_INCREF(__pyx_t_1); __pyx_t_5 = 0;
    __pyx_t_6 = NULL;
  } else {
    __pyx_t_5 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_v_ref_dotdata); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 429, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_6 = Py_TYPE(__pyx_t_1)->tp_iternext; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 429, __pyx_L1_error)
  }
  for (;;) {
    if (likely(!__pyx_t_6)) {
      if (likely(PyList_CheckExact(__pyx_t_1))) {
        if (__pyx_t_5 >= PyList_GET_SIZE(__pyx_t_1)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_2 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_5); __Pyx_INCREF(__pyx_t_2); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 429, __pyx_L1_error)
        #else
        __pyx_t_2 = PySequence_ITEM(__pyx_t_1, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 429, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
        #endif
      } else {
        if (__pyx_t_5 >= PyTuple_GET_SIZE(__pyx_t_1)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_2 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_5); __Pyx_INCREF(__pyx_t_2); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 429, __pyx_L1_error)
        #else
        __pyx_t_2 = PySequence_ITEM(__pyx_t_1, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 429, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
        #endif
      }
    } else {
      __pyx_t_2 = __pyx_t_6(__pyx_t_1);
      if (unlikely(!__pyx_t_2)) {
        PyObject* exc_type = PyErr_Occurred();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
          else __PYX_ERR(0, 429, __pyx_L1_error)
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_2);
    }
    __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_2);
    __pyx_t_2 = 0;
    __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_i, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 429, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    if (unlikely(__Pyx_ListComp_Append(__pyx_t_4, (PyObject*)__pyx_t_2))) __PYX_ERR(0, 429, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  }
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_y_axis = ((PyObject*)__pyx_t_4);
  __pyx_t_4 = 0;

  /* "vapor_vali/Simple_function.pyx":430
 *     x_axis=[i[0] for i in ref_dotdata]
 *     y_axis=[i[1] for i in ref_dotdata]
 *     dis_to_diagnal=[y_axis[i]-x_axis[i] for i in range(len(x_axis))]             # <<<<<<<<<<<<<<
 *     dis_to_anti_diagnal=[y_axis[i]+x_axis[i] for i in range(len(x_axis))]
 *     #[kept_dot_x,removed_dot_x]=dis_cluster_2(x_axis,dis_cff=10)
 */
  __pyx_t_4 = PyList_New(0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 430, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_5 = PyList_GET_SIZE(__pyx_v_x_axis); if (unlikely(__pyx_t_5 == -1)) __PYX_ERR(0, 430, __pyx_L1_error)
  __pyx_t_1 = PyInt_FromSsize_t(__pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 430, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 430, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_GIVEREF(__pyx_t_1);
  PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_t_2, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 430, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  if (likely(PyList_CheckExact(__pyx_t_1)) || PyTuple_CheckExact(__pyx_t_1)) {
    __pyx_t_2 = __pyx_t_1; __Pyx_INCREF(__pyx_t_2); __pyx_t_5 = 0;
    __pyx_t_6 = NULL;
  } else {
    __pyx_t_5 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 430, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_6 = Py_TYPE(__pyx_t_2)->tp_iternext; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 430, __pyx_L1_error)
  }
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  for (;;) {
    if (likely(!__pyx_t_6)) {
      if (likely(PyList_CheckExact(__pyx_t_2))) {
        if (__pyx_t_5 >= PyList_GET_SIZE(__pyx_t_2)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_1 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_5); __Pyx_INCREF(__pyx_t_1); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 430, __pyx_L1_error)
        #else
        __pyx_t_1 = PySequence_ITEM(__pyx_t_2, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 430, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        #endif
      } else {
        if (__pyx_t_5 >= PyTuple_GET_SIZE(__pyx_t_2)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_5); __Pyx_INCREF(__pyx_t_1); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 430, __pyx_L1_error)
        #else
        __pyx_t_1 = PySequence_ITEM(__pyx_t_2, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 430, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        #endif
      }
    } else {
      __pyx_t_1 = __pyx_t_6(__pyx_t_2);
      if (unlikely(!__pyx_t_1)) {
        PyObject* exc_type = PyErr_Occurred();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
          else __PYX_ERR(0, 430, __pyx_L1_error)
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_1);
    }
    __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_1);
    __pyx_t_1 = 0;
    __pyx_t_1 = PyObject_GetItem(__pyx_v_y_axis, __pyx_v_i); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 430, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_7 = PyObject_GetItem(__pyx_v_x_axis, __pyx_v_i); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 430, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    __pyx_t_8 = PyNumber_Subtract(__pyx_t_1, __pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 430, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_8);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
    if (unlikely(__Pyx_ListComp_Append(__pyx_t_4, (PyObject*)__pyx_t_8))) __PYX_ERR(0, 430, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
  }
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_dis_to_diagnal = ((PyObject*)__pyx_t_4);
  __pyx_t_4 = 0;

  /* "vapor_vali/Simple_function.pyx":431
 *     y_axis=[i[1] for i in ref_dotdata]
 *     dis_to_diagnal=[y_axis[i]-x_axis[i] for i in range(len(x_axis))]
 *     dis_to_anti_diagnal=[y_axis[i]+x_axis[i] for i in range(len(x_axis))]             # <<<<<<<<<<<<<<
 *     #[kept_dot_x,removed_dot_x]=dis_cluster_2(x_axis,dis_cff=10)
 *     #[kept_dot_y,removed_dot_y]=dis_cluster_2(y_axis,dis_cff=10)
 */
  __pyx_t_4 = PyList_New(0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 431, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_5 = PyList_GET_SIZE(__pyx_v_x_axis); if (unlikely(__pyx_t_5 == -1)) __PYX_ERR(0, 431, __pyx_L1_error)
  __pyx_t_2 = PyInt_FromSsize_t(__pyx_t_5); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 431, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_8 = PyTuple_New(1); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 431, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_8);
  __Pyx_GIVEREF(__pyx_t_2);
  PyTuple_SET_ITEM(__pyx_t_8, 0, __pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_t_8, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 431, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
  if (likely(PyList_CheckExact(__pyx_t_2)) || PyTuple_CheckExact(__pyx_t_2)) {
    __pyx_t_8 = __pyx_t_2; __Pyx_INCREF(__pyx_t_8); __pyx_t_5 = 0;
    __pyx_t_6 = NULL;
  } else {
    __pyx_t_5 = -1; __pyx_t_8 = PyObject_GetIter(__pyx_t_2); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 431, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_8);
    __pyx_t_6 = Py_TYPE(__pyx_t_8)->tp_iternext; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 431, __pyx_L1_error)
  }
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  for (;;) {
    if (likely(!__pyx_t_6)) {
      if (likely(PyList_CheckExact(__pyx_t_8))) {
        if (__pyx_t_5 >= PyList_GET_SIZE(__pyx_t_8)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_2 = PyList_GET_ITEM(__pyx_t_8, __pyx_t_5); __Pyx_INCREF(__pyx_t_2); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 431, __pyx_L1_error)
        #else
        __pyx_t_2 = PySequence_ITEM(__pyx_t_8, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 431, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
        #endif
      } else {
        if (__pyx_t_5 >= PyTuple_GET_SIZE(__pyx_t_8)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_2 = PyTuple_GET_ITEM(__pyx_t_8, __pyx_t_5); __Pyx_INCREF(__pyx_t_2); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 431, __pyx_L1_error)
        #else
        __pyx_t_2 = PySequence_ITEM(__pyx_t_8, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 431, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
        #endif
      }
    } else {
      __pyx_t_2 = __pyx_t_6(__pyx_t_8);
      if (unlikely(!__pyx_t_2)) {
        PyObject* exc_type = PyErr_Occurred();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
          else __PYX_ERR(0, 431, __pyx_L1_error)
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_2);
    }
    __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_2);
    __pyx_t_2 = 0;
    __pyx_t_2 = PyObject_GetItem(__pyx_v_y_axis, __pyx_v_i); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 431, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_7 = PyObject_GetItem(__pyx_v_x_axis, __pyx_v_i); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 431, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    __pyx_t_1 = PyNumber_Add(__pyx_t_2, __pyx_t_7); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 431, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
    if (unlikely(__Pyx_ListComp_Append(__pyx_t_4, (PyObject*)__pyx_t_1))) __PYX_ERR(0, 431, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  }
  __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
  __pyx_v_dis_to_anti_diagnal = ((PyObject*)__pyx_t_4);
  __pyx_t_4 = 0;

  /* "vapor_vali/Simple_function.pyx":434
 *     #[kept_dot_x,removed_dot_x]=dis_cluster_2(x_axis,dis_cff=10)
 *     #[kept_dot_y,removed_dot_y]=dis_cluster_2(y_axis,dis_cff=10)
 *     [kept_dot_diag,removed_dot_diag]=dis_cluster_2(dis_to_diagnal,dis_cff=10)             # <<<<<<<<<<<<<<
 *     [kept_dot_anti_diag,removed_dot_anti_diag]=dis_cluster_2(dis_to_anti_diagnal,dis_cff=10)
 *     rec=-1
 */
  __pyx_t_4 = __Pyx_GetModuleGlobalName(__pyx_n_s_dis_cluster_2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 434, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_8 = PyTuple_New(1); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 434, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_8);
  __Pyx_INCREF(__pyx_v_dis_to_diagnal);
  __Pyx_GIVEREF(__pyx_v_dis_to_diagnal);
  PyTuple_SET_ITEM(__pyx_t_8, 0, __pyx_v_dis_to_diagnal);
  __pyx_t_1 = PyDict_New(); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 434, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dis_cff, __pyx_int_10) < 0) __PYX_ERR(0, 434, __pyx_L1_error)
  __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_8, __pyx_t_1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 434, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  if ((likely(PyTuple_CheckExact(__pyx_t_7))) || (PyList_CheckExact(__pyx_t_7))) {
    PyObject* sequence = __pyx_t_7;
    #if CYTHON_COMPILING_IN_CPYTHON
    Py_ssize_t size = Py_SIZE(sequence);
    #else
    Py_ssize_t size = PySequence_Size(sequence);
    #endif
    if (unlikely(size != 2)) {
      if (size > 2) __Pyx_RaiseTooManyValuesError(2);
      else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
      __PYX_ERR(0, 434, __pyx_L1_error)
    }
    #if CYTHON_COMPILING_IN_CPYTHON
    if (likely(PyTuple_CheckExact(sequence))) {
      __pyx_t_1 = PyTuple_GET_ITEM(sequence, 0); 
      __pyx_t_8 = PyTuple_GET_ITEM(sequence, 1); 
    } else {
      __pyx_t_1 = PyList_GET_ITEM(sequence, 0); 
      __pyx_t_8 = PyList_GET_ITEM(sequence, 1); 
    }
    __Pyx_INCREF(__pyx_t_1);
    __Pyx_INCREF(__pyx_t_8);
    #else
    __pyx_t_1 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 434, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_8 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 434, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_8);
    #endif
    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
  } else {
    Py_ssize_t index = -1;
    __pyx_t_4 = PyObject_GetIter(__pyx_t_7); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 434, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_t_9 = Py_TYPE(__pyx_t_4)->tp_iternext;
    index = 0; __pyx_t_1 = __pyx_t_9(__pyx_t_4); if (unlikely(!__pyx_t_1)) goto __pyx_L12_unpacking_failed;
    __Pyx_GOTREF(__pyx_t_1);
    index = 1; __pyx_t_8 = __pyx_t_9(__pyx_t_4); if (unlikely(!__pyx_t_8)) goto __pyx_L12_unpacking_failed;
    __Pyx_GOTREF(__pyx_t_8);
    if (__Pyx_IternextUnpackEndCheck(__pyx_t_9(__pyx_t_4), 2) < 0) __PYX_ERR(0, 434, __pyx_L1_error)
    __pyx_t_9 = NULL;
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    goto __pyx_L13_unpacking_done;
    __pyx_L12_unpacking_failed:;
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_9 = NULL;
    if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
    __PYX_ERR(0, 434, __pyx_L1_error)
    __pyx_L13_unpacking_done:;
  }
  __pyx_v_kept_dot_diag = __pyx_t_1;
  __pyx_t_1 = 0;
  __pyx_v_removed_dot_diag = __pyx_t_8;
  __pyx_t_8 = 0;

  /* "vapor_vali/Simple_function.pyx":435
 *     #[kept_dot_y,removed_dot_y]=dis_cluster_2(y_axis,dis_cff=10)
 *     [kept_dot_diag,removed_dot_diag]=dis_cluster_2(dis_to_diagnal,dis_cff=10)
 *     [kept_dot_anti_diag,removed_dot_anti_diag]=dis_cluster_2(dis_to_anti_diagnal,dis_cff=10)             # <<<<<<<<<<<<<<
 *     rec=-1
 *     kept_dot=[]
 */
  __pyx_t_7 = __Pyx_GetModuleGlobalName(__pyx_n_s_dis_cluster_2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 435, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  __pyx_t_8 = PyTuple_New(1); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 435, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_8);
  __Pyx_INCREF(__pyx_v_dis_to_anti_diagnal);
  __Pyx_GIVEREF(__pyx_v_dis_to_anti_diagnal);
  PyTuple_SET_ITEM(__pyx_t_8, 0, __pyx_v_dis_to_anti_diagnal);
  __pyx_t_1 = PyDict_New(); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 435, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dis_cff, __pyx_int_10) < 0) __PYX_ERR(0, 435, __pyx_L1_error)
  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_7, __pyx_t_8, __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 435, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
  __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  if ((likely(PyTuple_CheckExact(__pyx_t_4))) || (PyList_CheckExact(__pyx_t_4))) {
    PyObject* sequence = __pyx_t_4;
    #if CYTHON_COMPILING_IN_CPYTHON
    Py_ssize_t size = Py_SIZE(sequence);
    #else
    Py_ssize_t size = PySequence_Size(sequence);
    #endif
    if (unlikely(size != 2)) {
      if (size > 2) __Pyx_RaiseTooManyValuesError(2);
      else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
      __PYX_ERR(0, 435, __pyx_L1_error)
    }
    #if CYTHON_COMPILING_IN_CPYTHON
    if (likely(PyTuple_CheckExact(sequence))) {
      __pyx_t_1 = PyTuple_GET_ITEM(sequence, 0); 
      __pyx_t_8 = PyTuple_GET_ITEM(sequence, 1); 
    } else {
      __pyx_t_1 = PyList_GET_ITEM(sequence, 0); 
      __pyx_t_8 = PyList_GET_ITEM(sequence, 1); 
    }
    __Pyx_INCREF(__pyx_t_1);
    __Pyx_INCREF(__pyx_t_8);
    #else
    __pyx_t_1 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 435, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_8 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 435, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_8);
    #endif
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  } else {
    Py_ssize_t index = -1;
    __pyx_t_7 = PyObject_GetIter(__pyx_t_4); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 435, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_9 = Py_TYPE(__pyx_t_7)->tp_iternext;
    index = 0; __pyx_t_1 = __pyx_t_9(__pyx_t_7); if (unlikely(!__pyx_t_1)) goto __pyx_L14_unpacking_failed;
    __Pyx_GOTREF(__pyx_t_1);
    index = 1; __pyx_t_8 = __pyx_t_9(__pyx_t_7); if (unlikely(!__pyx_t_8)) goto __pyx_L14_unpacking_failed;
    __Pyx_GOTREF(__pyx_t_8);
    if (__Pyx_IternextUnpackEndCheck(__pyx_t_9(__pyx_t_7), 2) < 0) __PYX_ERR(0, 435, __pyx_L1_error)
    __pyx_t_9 = NULL;
    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
    goto __pyx_L15_unpacking_done;
    __pyx_L14_unpacking_failed:;
    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_t_9 = NULL;
    if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
    __PYX_ERR(0, 435, __pyx_L1_error)
    __pyx_L15_unpacking_done:;
  }
  __pyx_v_kept_dot_anti_diag = __pyx_t_1;
  __pyx_t_1 = 0;
  __pyx_v_removed_dot_anti_diag = __pyx_t_8;
  __pyx_t_8 = 0;

  /* "vapor_vali/Simple_function.pyx":436
 *     [kept_dot_diag,removed_dot_diag]=dis_cluster_2(dis_to_diagnal,dis_cff=10)
 *     [kept_dot_anti_diag,removed_dot_anti_diag]=dis_cluster_2(dis_to_anti_diagnal,dis_cff=10)
 *     rec=-1             # <<<<<<<<<<<<<<
 *     kept_dot=[]
 *     for x in ref_dotdata:
 */
  __Pyx_INCREF(__pyx_int_neg_1);
  __pyx_v_rec = __pyx_int_neg_1;

  /* "vapor_vali/Simple_function.pyx":437
 *     [kept_dot_anti_diag,removed_dot_anti_diag]=dis_cluster_2(dis_to_anti_diagnal,dis_cff=10)
 *     rec=-1
 *     kept_dot=[]             # <<<<<<<<<<<<<<
 *     for x in ref_dotdata:
 *         rec+=1
 */
  __pyx_t_4 = PyList_New(0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 437, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_v_kept_dot = ((PyObject*)__pyx_t_4);
  __pyx_t_4 = 0;

  /* "vapor_vali/Simple_function.pyx":438
 *     rec=-1
 *     kept_dot=[]
 *     for x in ref_dotdata:             # <<<<<<<<<<<<<<
 *         rec+=1
 *         if rec in removed_dot_diag and rec in removed_dot_anti_diag:   continue
 */
  if (likely(PyList_CheckExact(__pyx_v_ref_dotdata)) || PyTuple_CheckExact(__pyx_v_ref_dotdata)) {
    __pyx_t_4 = __pyx_v_ref_dotdata; __Pyx_INCREF(__pyx_t_4); __pyx_t_5 = 0;
    __pyx_t_6 = NULL;
  } else {
    __pyx_t_5 = -1; __pyx_t_4 = PyObject_GetIter(__pyx_v_ref_dotdata); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 438, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_6 = Py_TYPE(__pyx_t_4)->tp_iternext; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 438, __pyx_L1_error)
  }
  for (;;) {
    if (likely(!__pyx_t_6)) {
      if (likely(PyList_CheckExact(__pyx_t_4))) {
        if (__pyx_t_5 >= PyList_GET_SIZE(__pyx_t_4)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_8 = PyList_GET_ITEM(__pyx_t_4, __pyx_t_5); __Pyx_INCREF(__pyx_t_8); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 438, __pyx_L1_error)
        #else
        __pyx_t_8 = PySequence_ITEM(__pyx_t_4, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 438, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_8);
        #endif
      } else {
        if (__pyx_t_5 >= PyTuple_GET_SIZE(__pyx_t_4)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_8 = PyTuple_GET_ITEM(__pyx_t_4, __pyx_t_5); __Pyx_INCREF(__pyx_t_8); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 438, __pyx_L1_error)
        #else
        __pyx_t_8 = PySequence_ITEM(__pyx_t_4, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 438, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_8);
        #endif
      }
    } else {
      __pyx_t_8 = __pyx_t_6(__pyx_t_4);
      if (unlikely(!__pyx_t_8)) {
        PyObject* exc_type = PyErr_Occurred();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
          else __PYX_ERR(0, 438, __pyx_L1_error)
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_8);
    }
    __Pyx_XDECREF_SET(__pyx_v_x, __pyx_t_8);
    __pyx_t_8 = 0;

    /* "vapor_vali/Simple_function.pyx":439
 *     kept_dot=[]
 *     for x in ref_dotdata:
 *         rec+=1             # <<<<<<<<<<<<<<
 *         if rec in removed_dot_diag and rec in removed_dot_anti_diag:   continue
 *         else:   kept_dot.append(x)
 */
    __pyx_t_8 = __Pyx_PyInt_AddObjC(__pyx_v_rec, __pyx_int_1, 1, 1); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 439, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_8);
    __Pyx_DECREF_SET(__pyx_v_rec, __pyx_t_8);
    __pyx_t_8 = 0;

    /* "vapor_vali/Simple_function.pyx":440
 *     for x in ref_dotdata:
 *         rec+=1
 *         if rec in removed_dot_diag and rec in removed_dot_anti_diag:   continue             # <<<<<<<<<<<<<<
 *         else:   kept_dot.append(x)
 *     return kept_dot
 */
    __pyx_t_10 = (__Pyx_PySequence_ContainsTF(__pyx_v_rec, __pyx_v_removed_dot_diag, Py_EQ)); if (unlikely(__pyx_t_10 < 0)) __PYX_ERR(0, 440, __pyx_L1_error)
    __pyx_t_11 = (__pyx_t_10 != 0);
    if (__pyx_t_11) {
    } else {
      __pyx_t_3 = __pyx_t_11;
      goto __pyx_L19_bool_binop_done;
    }
    __pyx_t_11 = (__Pyx_PySequence_ContainsTF(__pyx_v_rec, __pyx_v_removed_dot_anti_diag, Py_EQ)); if (unlikely(__pyx_t_11 < 0)) __PYX_ERR(0, 440, __pyx_L1_error)
    __pyx_t_10 = (__pyx_t_11 != 0);
    __pyx_t_3 = __pyx_t_10;
    __pyx_L19_bool_binop_done:;
    if (__pyx_t_3) {
      goto __pyx_L16_continue;
    }

    /* "vapor_vali/Simple_function.pyx":441
 *         rec+=1
 *         if rec in removed_dot_diag and rec in removed_dot_anti_diag:   continue
 *         else:   kept_dot.append(x)             # <<<<<<<<<<<<<<
 *     return kept_dot
 * 
 */
    /*else*/ {
      __pyx_t_12 = __Pyx_PyList_Append(__pyx_v_kept_dot, __pyx_v_x); if (unlikely(__pyx_t_12 == -1)) __PYX_ERR(0, 441, __pyx_L1_error)
    }

    /* "vapor_vali/Simple_function.pyx":438
 *     rec=-1
 *     kept_dot=[]
 *     for x in ref_dotdata:             # <<<<<<<<<<<<<<
 *         rec+=1
 *         if rec in removed_dot_diag and rec in removed_dot_anti_diag:   continue
 */
    __pyx_L16_continue:;
  }
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;

  /* "vapor_vali/Simple_function.pyx":442
 *         if rec in removed_dot_diag and rec in removed_dot_anti_diag:   continue
 *         else:   kept_dot.append(x)
 *     return kept_dot             # <<<<<<<<<<<<<<
 * 
 * def clean_dotdata_x_and_y(list_dotdata):
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_kept_dot);
  __pyx_r = __pyx_v_kept_dot;
  goto __pyx_L0;

  /* "vapor_vali/Simple_function.pyx":426
 *     return [kept_dot,kept_region]
 * 
 * def clean_dotdata_diagnal_and_anti_diagnal(ref_dotdata):             # <<<<<<<<<<<<<<
 *     if ref_dotdata==[]:    return [[],[]]
 *     x_axis=[i[0] for i in ref_dotdata]
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_7);
  __Pyx_XDECREF(__pyx_t_8);
  __Pyx_AddTraceback("vapor_vali.Simple_function.clean_dotdata_diagnal_and_anti_diagnal", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_x_axis);
  __Pyx_XDECREF(__pyx_v_y_axis);
  __Pyx_XDECREF(__pyx_v_dis_to_diagnal);
  __Pyx_XDECREF(__pyx_v_dis_to_anti_diagnal);
  __Pyx_XDECREF(__pyx_v_kept_dot_diag);
  __Pyx_XDECREF(__pyx_v_removed_dot_diag);
  __Pyx_XDECREF(__pyx_v_kept_dot_anti_diag);
  __Pyx_XDECREF(__pyx_v_removed_dot_anti_diag);
  __Pyx_XDECREF(__pyx_v_rec);
  __Pyx_XDECREF(__pyx_v_kept_dot);
  __Pyx_XDECREF(__pyx_v_x);
  __Pyx_XDECREF(__pyx_v_i);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "vapor_vali/Simple_function.pyx":444
 *     return kept_dot
 * 
 * def clean_dotdata_x_and_y(list_dotdata):             # <<<<<<<<<<<<<<
 *     [kept_dot_x,removed_dot_x]=dis_cluster_2([i[0] for i in list_dotdata],dis_cff=10)
 *     kept_list=[]
 */

/* Python wrapper */
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_53clean_dotdata_x_and_y(PyObject *__pyx_self, PyObject *__pyx_v_list_dotdata); /*proto*/
static PyMethodDef __pyx_mdef_10vapor_vali_15Simple_function_53clean_dotdata_x_and_y = {"clean_dotdata_x_and_y", (PyCFunction)__pyx_pw_10vapor_vali_15Simple_function_53clean_dotdata_x_and_y, METH_O, 0};
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_53clean_dotdata_x_and_y(PyObject *__pyx_self, PyObject *__pyx_v_list_dotdata) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("clean_dotdata_x_and_y (wrapper)", 0);
  __pyx_r = __pyx_pf_10vapor_vali_15Simple_function_52clean_dotdata_x_and_y(__pyx_self, ((PyObject *)__pyx_v_list_dotdata));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10vapor_vali_15Simple_function_52clean_dotdata_x_and_y(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_list_dotdata) {
  PyObject *__pyx_v_kept_dot_x = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_removed_dot_x = NULL;
  PyObject *__pyx_v_kept_list = NULL;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_v_kept_dot_y = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_removed_dot_y = NULL;
  PyObject *__pyx_v_out_list = NULL;
  PyObject *__pyx_v_j = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  Py_ssize_t __pyx_t_4;
  PyObject *(*__pyx_t_5)(PyObject *);
  PyObject *__pyx_t_6 = NULL;
  PyObject *(*__pyx_t_7)(PyObject *);
  Py_ssize_t __pyx_t_8;
  PyObject *(*__pyx_t_9)(PyObject *);
  __Pyx_RefNannySetupContext("clean_dotdata_x_and_y", 0);

  /* "vapor_vali/Simple_function.pyx":445
 * 
 * def clean_dotdata_x_and_y(list_dotdata):
 *     [kept_dot_x,removed_dot_x]=dis_cluster_2([i[0] for i in list_dotdata],dis_cff=10)             # <<<<<<<<<<<<<<
 *     kept_list=[]
 *     for i in kept_dot_x:
 */
  __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_dis_cluster_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 445, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = PyList_New(0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 445, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (likely(PyList_CheckExact(__pyx_v_list_dotdata)) || PyTuple_CheckExact(__pyx_v_list_dotdata)) {
    __pyx_t_3 = __pyx_v_list_dotdata; __Pyx_INCREF(__pyx_t_3); __pyx_t_4 = 0;
    __pyx_t_5 = NULL;
  } else {
    __pyx_t_4 = -1; __pyx_t_3 = PyObject_GetIter(__pyx_v_list_dotdata); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 445, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_5 = Py_TYPE(__pyx_t_3)->tp_iternext; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 445, __pyx_L1_error)
  }
  for (;;) {
    if (likely(!__pyx_t_5)) {
      if (likely(PyList_CheckExact(__pyx_t_3))) {
        if (__pyx_t_4 >= PyList_GET_SIZE(__pyx_t_3)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_6 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_4); __Pyx_INCREF(__pyx_t_6); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 445, __pyx_L1_error)
        #else
        __pyx_t_6 = PySequence_ITEM(__pyx_t_3, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 445, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_6);
        #endif
      } else {
        if (__pyx_t_4 >= PyTuple_GET_SIZE(__pyx_t_3)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_6 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_4); __Pyx_INCREF(__pyx_t_6); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 445, __pyx_L1_error)
        #else
        __pyx_t_6 = PySequence_ITEM(__pyx_t_3, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 445, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_6);
        #endif
      }
    } else {
      __pyx_t_6 = __pyx_t_5(__pyx_t_3);
      if (unlikely(!__pyx_t_6)) {
        PyObject* exc_type = PyErr_Occurred();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
          else __PYX_ERR(0, 445, __pyx_L1_error)
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_6);
    }
    __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_6);
    __pyx_t_6 = 0;
    __pyx_t_6 = __Pyx_GetItemInt(__pyx_v_i, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 445, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    if (unlikely(__Pyx_ListComp_Append(__pyx_t_2, (PyObject*)__pyx_t_6))) __PYX_ERR(0, 445, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  }
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 445, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_GIVEREF(__pyx_t_2);
  PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = PyDict_New(); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 445, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_dis_cff, __pyx_int_10) < 0) __PYX_ERR(0, 445, __pyx_L1_error)
  __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_3, __pyx_t_2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 445, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  if ((likely(PyTuple_CheckExact(__pyx_t_6))) || (PyList_CheckExact(__pyx_t_6))) {
    PyObject* sequence = __pyx_t_6;
    #if CYTHON_COMPILING_IN_CPYTHON
    Py_ssize_t size = Py_SIZE(sequence);
    #else
    Py_ssize_t size = PySequence_Size(sequence);
    #endif
    if (unlikely(size != 2)) {
      if (size > 2) __Pyx_RaiseTooManyValuesError(2);
      else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
      __PYX_ERR(0, 445, __pyx_L1_error)
    }
    #if CYTHON_COMPILING_IN_CPYTHON
    if (likely(PyTuple_CheckExact(sequence))) {
      __pyx_t_2 = PyTuple_GET_ITEM(sequence, 0); 
      __pyx_t_3 = PyTuple_GET_ITEM(sequence, 1); 
    } else {
      __pyx_t_2 = PyList_GET_ITEM(sequence, 0); 
      __pyx_t_3 = PyList_GET_ITEM(sequence, 1); 
    }
    __Pyx_INCREF(__pyx_t_2);
    __Pyx_INCREF(__pyx_t_3);
    #else
    __pyx_t_2 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 445, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_3 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 445, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    #endif
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  } else {
    Py_ssize_t index = -1;
    __pyx_t_1 = PyObject_GetIter(__pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 445, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_7 = Py_TYPE(__pyx_t_1)->tp_iternext;
    index = 0; __pyx_t_2 = __pyx_t_7(__pyx_t_1); if (unlikely(!__pyx_t_2)) goto __pyx_L5_unpacking_failed;
    __Pyx_GOTREF(__pyx_t_2);
    index = 1; __pyx_t_3 = __pyx_t_7(__pyx_t_1); if (unlikely(!__pyx_t_3)) goto __pyx_L5_unpacking_failed;
    __Pyx_GOTREF(__pyx_t_3);
    if (__Pyx_IternextUnpackEndCheck(__pyx_t_7(__pyx_t_1), 2) < 0) __PYX_ERR(0, 445, __pyx_L1_error)
    __pyx_t_7 = NULL;
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    goto __pyx_L6_unpacking_done;
    __pyx_L5_unpacking_failed:;
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_7 = NULL;
    if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
    __PYX_ERR(0, 445, __pyx_L1_error)
    __pyx_L6_unpacking_done:;
  }
  __pyx_v_kept_dot_x = __pyx_t_2;
  __pyx_t_2 = 0;
  __pyx_v_removed_dot_x = __pyx_t_3;
  __pyx_t_3 = 0;

  /* "vapor_vali/Simple_function.pyx":446
 * def clean_dotdata_x_and_y(list_dotdata):
 *     [kept_dot_x,removed_dot_x]=dis_cluster_2([i[0] for i in list_dotdata],dis_cff=10)
 *     kept_list=[]             # <<<<<<<<<<<<<<
 *     for i in kept_dot_x:
 *         kept_list+=[list_dotdata[j] for j in i]
 */
  __pyx_t_6 = PyList_New(0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 446, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_v_kept_list = ((PyObject*)__pyx_t_6);
  __pyx_t_6 = 0;

  /* "vapor_vali/Simple_function.pyx":447
 *     [kept_dot_x,removed_dot_x]=dis_cluster_2([i[0] for i in list_dotdata],dis_cff=10)
 *     kept_list=[]
 *     for i in kept_dot_x:             # <<<<<<<<<<<<<<
 *         kept_list+=[list_dotdata[j] for j in i]
 *     [kept_dot_y,removed_dot_y]=dis_cluster_2([i[1] for i in kept_list],dis_cff=10)
 */
  if (likely(PyList_CheckExact(__pyx_v_kept_dot_x)) || PyTuple_CheckExact(__pyx_v_kept_dot_x)) {
    __pyx_t_6 = __pyx_v_kept_dot_x; __Pyx_INCREF(__pyx_t_6); __pyx_t_4 = 0;
    __pyx_t_5 = NULL;
  } else {
    __pyx_t_4 = -1; __pyx_t_6 = PyObject_GetIter(__pyx_v_kept_dot_x); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 447, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __pyx_t_5 = Py_TYPE(__pyx_t_6)->tp_iternext; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 447, __pyx_L1_error)
  }
  for (;;) {
    if (likely(!__pyx_t_5)) {
      if (likely(PyList_CheckExact(__pyx_t_6))) {
        if (__pyx_t_4 >= PyList_GET_SIZE(__pyx_t_6)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_3 = PyList_GET_ITEM(__pyx_t_6, __pyx_t_4); __Pyx_INCREF(__pyx_t_3); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 447, __pyx_L1_error)
        #else
        __pyx_t_3 = PySequence_ITEM(__pyx_t_6, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 447, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_3);
        #endif
      } else {
        if (__pyx_t_4 >= PyTuple_GET_SIZE(__pyx_t_6)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_3 = PyTuple_GET_ITEM(__pyx_t_6, __pyx_t_4); __Pyx_INCREF(__pyx_t_3); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 447, __pyx_L1_error)
        #else
        __pyx_t_3 = PySequence_ITEM(__pyx_t_6, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 447, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_3);
        #endif
      }
    } else {
      __pyx_t_3 = __pyx_t_5(__pyx_t_6);
      if (unlikely(!__pyx_t_3)) {
        PyObject* exc_type = PyErr_Occurred();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
          else __PYX_ERR(0, 447, __pyx_L1_error)
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_3);
    }
    __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_3);
    __pyx_t_3 = 0;

    /* "vapor_vali/Simple_function.pyx":448
 *     kept_list=[]
 *     for i in kept_dot_x:
 *         kept_list+=[list_dotdata[j] for j in i]             # <<<<<<<<<<<<<<
 *     [kept_dot_y,removed_dot_y]=dis_cluster_2([i[1] for i in kept_list],dis_cff=10)
 *     out_list=[]
 */
    __pyx_t_3 = PyList_New(0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 448, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    if (likely(PyList_CheckExact(__pyx_v_i)) || PyTuple_CheckExact(__pyx_v_i)) {
      __pyx_t_2 = __pyx_v_i; __Pyx_INCREF(__pyx_t_2); __pyx_t_8 = 0;
      __pyx_t_9 = NULL;
    } else {
      __pyx_t_8 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_v_i); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 448, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __pyx_t_9 = Py_TYPE(__pyx_t_2)->tp_iternext; if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 448, __pyx_L1_error)
    }
    for (;;) {
      if (likely(!__pyx_t_9)) {
        if (likely(PyList_CheckExact(__pyx_t_2))) {
          if (__pyx_t_8 >= PyList_GET_SIZE(__pyx_t_2)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_1 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_8); __Pyx_INCREF(__pyx_t_1); __pyx_t_8++; if (unlikely(0 < 0)) __PYX_ERR(0, 448, __pyx_L1_error)
          #else
          __pyx_t_1 = PySequence_ITEM(__pyx_t_2, __pyx_t_8); __pyx_t_8++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 448, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_1);
          #endif
        } else {
          if (__pyx_t_8 >= PyTuple_GET_SIZE(__pyx_t_2)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_8); __Pyx_INCREF(__pyx_t_1); __pyx_t_8++; if (unlikely(0 < 0)) __PYX_ERR(0, 448, __pyx_L1_error)
          #else
          __pyx_t_1 = PySequence_ITEM(__pyx_t_2, __pyx_t_8); __pyx_t_8++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 448, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_1);
          #endif
        }
      } else {
        __pyx_t_1 = __pyx_t_9(__pyx_t_2);
        if (unlikely(!__pyx_t_1)) {
          PyObject* exc_type = PyErr_Occurred();
          if (exc_type) {
            if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
            else __PYX_ERR(0, 448, __pyx_L1_error)
          }
          break;
        }
        __Pyx_GOTREF(__pyx_t_1);
      }
      __Pyx_XDECREF_SET(__pyx_v_j, __pyx_t_1);
      __pyx_t_1 = 0;
      __pyx_t_1 = PyObject_GetItem(__pyx_v_list_dotdata, __pyx_v_j); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 448, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      if (unlikely(__Pyx_ListComp_Append(__pyx_t_3, (PyObject*)__pyx_t_1))) __PYX_ERR(0, 448, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    }
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = PyNumber_InPlaceAdd(__pyx_v_kept_list, __pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 448, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __Pyx_DECREF_SET(__pyx_v_kept_list, ((PyObject*)__pyx_t_2));
    __pyx_t_2 = 0;

    /* "vapor_vali/Simple_function.pyx":447
 *     [kept_dot_x,removed_dot_x]=dis_cluster_2([i[0] for i in list_dotdata],dis_cff=10)
 *     kept_list=[]
 *     for i in kept_dot_x:             # <<<<<<<<<<<<<<
 *         kept_list+=[list_dotdata[j] for j in i]
 *     [kept_dot_y,removed_dot_y]=dis_cluster_2([i[1] for i in kept_list],dis_cff=10)
 */
  }
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

  /* "vapor_vali/Simple_function.pyx":449
 *     for i in kept_dot_x:
 *         kept_list+=[list_dotdata[j] for j in i]
 *     [kept_dot_y,removed_dot_y]=dis_cluster_2([i[1] for i in kept_list],dis_cff=10)             # <<<<<<<<<<<<<<
 *     out_list=[]
 *     for i in kept_dot_y:
 */
  __pyx_t_6 = __Pyx_GetModuleGlobalName(__pyx_n_s_dis_cluster_2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 449, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_2 = PyList_New(0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 449, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = __pyx_v_kept_list; __Pyx_INCREF(__pyx_t_3); __pyx_t_4 = 0;
  for (;;) {
    if (__pyx_t_4 >= PyList_GET_SIZE(__pyx_t_3)) break;
    #if CYTHON_COMPILING_IN_CPYTHON
    __pyx_t_1 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_4); __Pyx_INCREF(__pyx_t_1); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 449, __pyx_L1_error)
    #else
    __pyx_t_1 = PySequence_ITEM(__pyx_t_3, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 449, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    #endif
    __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_1);
    __pyx_t_1 = 0;
    __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_i, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 449, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    if (unlikely(__Pyx_ListComp_Append(__pyx_t_2, (PyObject*)__pyx_t_1))) __PYX_ERR(0, 449, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  }
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 449, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_GIVEREF(__pyx_t_2);
  PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = PyDict_New(); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 449, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_dis_cff, __pyx_int_10) < 0) __PYX_ERR(0, 449, __pyx_L1_error)
  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_3, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 449, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  if ((likely(PyTuple_CheckExact(__pyx_t_1))) || (PyList_CheckExact(__pyx_t_1))) {
    PyObject* sequence = __pyx_t_1;
    #if CYTHON_COMPILING_IN_CPYTHON
    Py_ssize_t size = Py_SIZE(sequence);
    #else
    Py_ssize_t size = PySequence_Size(sequence);
    #endif
    if (unlikely(size != 2)) {
      if (size > 2) __Pyx_RaiseTooManyValuesError(2);
      else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
      __PYX_ERR(0, 449, __pyx_L1_error)
    }
    #if CYTHON_COMPILING_IN_CPYTHON
    if (likely(PyTuple_CheckExact(sequence))) {
      __pyx_t_2 = PyTuple_GET_ITEM(sequence, 0); 
      __pyx_t_3 = PyTuple_GET_ITEM(sequence, 1); 
    } else {
      __pyx_t_2 = PyList_GET_ITEM(sequence, 0); 
      __pyx_t_3 = PyList_GET_ITEM(sequence, 1); 
    }
    __Pyx_INCREF(__pyx_t_2);
    __Pyx_INCREF(__pyx_t_3);
    #else
    __pyx_t_2 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 449, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_3 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 449, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    #endif
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  } else {
    Py_ssize_t index = -1;
    __pyx_t_6 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 449, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_7 = Py_TYPE(__pyx_t_6)->tp_iternext;
    index = 0; __pyx_t_2 = __pyx_t_7(__pyx_t_6); if (unlikely(!__pyx_t_2)) goto __pyx_L13_unpacking_failed;
    __Pyx_GOTREF(__pyx_t_2);
    index = 1; __pyx_t_3 = __pyx_t_7(__pyx_t_6); if (unlikely(!__pyx_t_3)) goto __pyx_L13_unpacking_failed;
    __Pyx_GOTREF(__pyx_t_3);
    if (__Pyx_IternextUnpackEndCheck(__pyx_t_7(__pyx_t_6), 2) < 0) __PYX_ERR(0, 449, __pyx_L1_error)
    __pyx_t_7 = NULL;
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    goto __pyx_L14_unpacking_done;
    __pyx_L13_unpacking_failed:;
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_7 = NULL;
    if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
    __PYX_ERR(0, 449, __pyx_L1_error)
    __pyx_L14_unpacking_done:;
  }
  __pyx_v_kept_dot_y = __pyx_t_2;
  __pyx_t_2 = 0;
  __pyx_v_removed_dot_y = __pyx_t_3;
  __pyx_t_3 = 0;

  /* "vapor_vali/Simple_function.pyx":450
 *         kept_list+=[list_dotdata[j] for j in i]
 *     [kept_dot_y,removed_dot_y]=dis_cluster_2([i[1] for i in kept_list],dis_cff=10)
 *     out_list=[]             # <<<<<<<<<<<<<<
 *     for i in kept_dot_y:
 *         out_list+=[list_dotdata[j] for j in i]
 */
  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 450, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_out_list = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":451
 *     [kept_dot_y,removed_dot_y]=dis_cluster_2([i[1] for i in kept_list],dis_cff=10)
 *     out_list=[]
 *     for i in kept_dot_y:             # <<<<<<<<<<<<<<
 *         out_list+=[list_dotdata[j] for j in i]
 *     return out_list
 */
  if (likely(PyList_CheckExact(__pyx_v_kept_dot_y)) || PyTuple_CheckExact(__pyx_v_kept_dot_y)) {
    __pyx_t_1 = __pyx_v_kept_dot_y; __Pyx_INCREF(__pyx_t_1); __pyx_t_4 = 0;
    __pyx_t_5 = NULL;
  } else {
    __pyx_t_4 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_v_kept_dot_y); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 451, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_5 = Py_TYPE(__pyx_t_1)->tp_iternext; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 451, __pyx_L1_error)
  }
  for (;;) {
    if (likely(!__pyx_t_5)) {
      if (likely(PyList_CheckExact(__pyx_t_1))) {
        if (__pyx_t_4 >= PyList_GET_SIZE(__pyx_t_1)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_3 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_4); __Pyx_INCREF(__pyx_t_3); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 451, __pyx_L1_error)
        #else
        __pyx_t_3 = PySequence_ITEM(__pyx_t_1, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 451, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_3);
        #endif
      } else {
        if (__pyx_t_4 >= PyTuple_GET_SIZE(__pyx_t_1)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_3 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_4); __Pyx_INCREF(__pyx_t_3); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 451, __pyx_L1_error)
        #else
        __pyx_t_3 = PySequence_ITEM(__pyx_t_1, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 451, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_3);
        #endif
      }
    } else {
      __pyx_t_3 = __pyx_t_5(__pyx_t_1);
      if (unlikely(!__pyx_t_3)) {
        PyObject* exc_type = PyErr_Occurred();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
          else __PYX_ERR(0, 451, __pyx_L1_error)
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_3);
    }
    __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_3);
    __pyx_t_3 = 0;

    /* "vapor_vali/Simple_function.pyx":452
 *     out_list=[]
 *     for i in kept_dot_y:
 *         out_list+=[list_dotdata[j] for j in i]             # <<<<<<<<<<<<<<
 *     return out_list
 * 
 */
    __pyx_t_3 = PyList_New(0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 452, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    if (likely(PyList_CheckExact(__pyx_v_i)) || PyTuple_CheckExact(__pyx_v_i)) {
      __pyx_t_2 = __pyx_v_i; __Pyx_INCREF(__pyx_t_2); __pyx_t_8 = 0;
      __pyx_t_9 = NULL;
    } else {
      __pyx_t_8 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_v_i); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 452, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __pyx_t_9 = Py_TYPE(__pyx_t_2)->tp_iternext; if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 452, __pyx_L1_error)
    }
    for (;;) {
      if (likely(!__pyx_t_9)) {
        if (likely(PyList_CheckExact(__pyx_t_2))) {
          if (__pyx_t_8 >= PyList_GET_SIZE(__pyx_t_2)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_6 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_8); __Pyx_INCREF(__pyx_t_6); __pyx_t_8++; if (unlikely(0 < 0)) __PYX_ERR(0, 452, __pyx_L1_error)
          #else
          __pyx_t_6 = PySequence_ITEM(__pyx_t_2, __pyx_t_8); __pyx_t_8++; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 452, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_6);
          #endif
        } else {
          if (__pyx_t_8 >= PyTuple_GET_SIZE(__pyx_t_2)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_6 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_8); __Pyx_INCREF(__pyx_t_6); __pyx_t_8++; if (unlikely(0 < 0)) __PYX_ERR(0, 452, __pyx_L1_error)
          #else
          __pyx_t_6 = PySequence_ITEM(__pyx_t_2, __pyx_t_8); __pyx_t_8++; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 452, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_6);
          #endif
        }
      } else {
        __pyx_t_6 = __pyx_t_9(__pyx_t_2);
        if (unlikely(!__pyx_t_6)) {
          PyObject* exc_type = PyErr_Occurred();
          if (exc_type) {
            if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
            else __PYX_ERR(0, 452, __pyx_L1_error)
          }
          break;
        }
        __Pyx_GOTREF(__pyx_t_6);
      }
      __Pyx_XDECREF_SET(__pyx_v_j, __pyx_t_6);
      __pyx_t_6 = 0;
      __pyx_t_6 = PyObject_GetItem(__pyx_v_list_dotdata, __pyx_v_j); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 452, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_6);
      if (unlikely(__Pyx_ListComp_Append(__pyx_t_3, (PyObject*)__pyx_t_6))) __PYX_ERR(0, 452, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    }
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = PyNumber_InPlaceAdd(__pyx_v_out_list, __pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 452, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __Pyx_DECREF_SET(__pyx_v_out_list, ((PyObject*)__pyx_t_2));
    __pyx_t_2 = 0;

    /* "vapor_vali/Simple_function.pyx":451
 *     [kept_dot_y,removed_dot_y]=dis_cluster_2([i[1] for i in kept_list],dis_cff=10)
 *     out_list=[]
 *     for i in kept_dot_y:             # <<<<<<<<<<<<<<
 *         out_list+=[list_dotdata[j] for j in i]
 *     return out_list
 */
  }
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":453
 *     for i in kept_dot_y:
 *         out_list+=[list_dotdata[j] for j in i]
 *     return out_list             # <<<<<<<<<<<<<<
 * 
 * def clean_dotdata_m2(ref_dotdata):
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_out_list);
  __pyx_r = __pyx_v_out_list;
  goto __pyx_L0;

  /* "vapor_vali/Simple_function.pyx":444
 *     return kept_dot
 * 
 * def clean_dotdata_x_and_y(list_dotdata):             # <<<<<<<<<<<<<<
 *     [kept_dot_x,removed_dot_x]=dis_cluster_2([i[0] for i in list_dotdata],dis_cff=10)
 *     kept_list=[]
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_AddTraceback("vapor_vali.Simple_function.clean_dotdata_x_and_y", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_kept_dot_x);
  __Pyx_XDECREF(__pyx_v_removed_dot_x);
  __Pyx_XDECREF(__pyx_v_kept_list);
  __Pyx_XDECREF(__pyx_v_i);
  __Pyx_XDECREF(__pyx_v_kept_dot_y);
  __Pyx_XDECREF(__pyx_v_removed_dot_y);
  __Pyx_XDECREF(__pyx_v_out_list);
  __Pyx_XDECREF(__pyx_v_j);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "vapor_vali/Simple_function.pyx":455
 *     return out_list
 * 
 * def clean_dotdata_m2(ref_dotdata):             # <<<<<<<<<<<<<<
 *     #keep dots closest to diagnal
 *     data_hash={}
 */

/* Python wrapper */
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_55clean_dotdata_m2(PyObject *__pyx_self, PyObject *__pyx_v_ref_dotdata); /*proto*/
static PyMethodDef __pyx_mdef_10vapor_vali_15Simple_function_55clean_dotdata_m2 = {"clean_dotdata_m2", (PyCFunction)__pyx_pw_10vapor_vali_15Simple_function_55clean_dotdata_m2, METH_O, 0};
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_55clean_dotdata_m2(PyObject *__pyx_self, PyObject *__pyx_v_ref_dotdata) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("clean_dotdata_m2 (wrapper)", 0);
  __pyx_r = __pyx_pf_10vapor_vali_15Simple_function_54clean_dotdata_m2(__pyx_self, ((PyObject *)__pyx_v_ref_dotdata));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10vapor_vali_15Simple_function_54clean_dotdata_m2(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_ref_dotdata) {
  PyObject *__pyx_v_data_hash = NULL;
  PyObject *__pyx_v_x = NULL;
  PyObject *__pyx_v_out = NULL;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  Py_ssize_t __pyx_t_2;
  PyObject *(*__pyx_t_3)(PyObject *);
  PyObject *__pyx_t_4 = NULL;
  int __pyx_t_5;
  int __pyx_t_6;
  PyObject *__pyx_t_7 = NULL;
  PyObject *__pyx_t_8 = NULL;
  PyObject *__pyx_t_9 = NULL;
  int __pyx_t_10;
  __Pyx_RefNannySetupContext("clean_dotdata_m2", 0);

  /* "vapor_vali/Simple_function.pyx":457
 * def clean_dotdata_m2(ref_dotdata):
 *     #keep dots closest to diagnal
 *     data_hash={}             # <<<<<<<<<<<<<<
 *     for x in ref_dotdata:
 *         if not x[0] in data_hash:    data_hash[x[0]]=x[1]
 */
  __pyx_t_1 = PyDict_New(); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 457, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_data_hash = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":458
 *     #keep dots closest to diagnal
 *     data_hash={}
 *     for x in ref_dotdata:             # <<<<<<<<<<<<<<
 *         if not x[0] in data_hash:    data_hash[x[0]]=x[1]
 *         else:
 */
  if (likely(PyList_CheckExact(__pyx_v_ref_dotdata)) || PyTuple_CheckExact(__pyx_v_ref_dotdata)) {
    __pyx_t_1 = __pyx_v_ref_dotdata; __Pyx_INCREF(__pyx_t_1); __pyx_t_2 = 0;
    __pyx_t_3 = NULL;
  } else {
    __pyx_t_2 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_v_ref_dotdata); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 458, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_3 = Py_TYPE(__pyx_t_1)->tp_iternext; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 458, __pyx_L1_error)
  }
  for (;;) {
    if (likely(!__pyx_t_3)) {
      if (likely(PyList_CheckExact(__pyx_t_1))) {
        if (__pyx_t_2 >= PyList_GET_SIZE(__pyx_t_1)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_4 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_4); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 458, __pyx_L1_error)
        #else
        __pyx_t_4 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 458, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_4);
        #endif
      } else {
        if (__pyx_t_2 >= PyTuple_GET_SIZE(__pyx_t_1)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_4 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_4); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 458, __pyx_L1_error)
        #else
        __pyx_t_4 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 458, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_4);
        #endif
      }
    } else {
      __pyx_t_4 = __pyx_t_3(__pyx_t_1);
      if (unlikely(!__pyx_t_4)) {
        PyObject* exc_type = PyErr_Occurred();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
          else __PYX_ERR(0, 458, __pyx_L1_error)
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_4);
    }
    __Pyx_XDECREF_SET(__pyx_v_x, __pyx_t_4);
    __pyx_t_4 = 0;

    /* "vapor_vali/Simple_function.pyx":459
 *     data_hash={}
 *     for x in ref_dotdata:
 *         if not x[0] in data_hash:    data_hash[x[0]]=x[1]             # <<<<<<<<<<<<<<
 *         else:
 *             if abs(x[1]-x[0])<abs(data_hash[x[0]]-x[0]):    data_hash[x[0]]=x[1]
 */
    __pyx_t_4 = __Pyx_GetItemInt(__pyx_v_x, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 459, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_5 = (__Pyx_PyDict_ContainsTF(__pyx_t_4, __pyx_v_data_hash, Py_NE)); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 459, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_6 = (__pyx_t_5 != 0);
    if (__pyx_t_6) {
      __pyx_t_4 = __Pyx_GetItemInt(__pyx_v_x, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 459, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_t_7 = __Pyx_GetItemInt(__pyx_v_x, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 459, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_7);
      if (unlikely(PyDict_SetItem(__pyx_v_data_hash, __pyx_t_7, __pyx_t_4) < 0)) __PYX_ERR(0, 459, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      goto __pyx_L5;
    }

    /* "vapor_vali/Simple_function.pyx":461
 *         if not x[0] in data_hash:    data_hash[x[0]]=x[1]
 *         else:
 *             if abs(x[1]-x[0])<abs(data_hash[x[0]]-x[0]):    data_hash[x[0]]=x[1]             # <<<<<<<<<<<<<<
 *     out=[[[i,data_hash[i]] for i in sorted(data_hash.keys())],[]]
 *     return out
 */
    /*else*/ {
      __pyx_t_4 = __Pyx_GetItemInt(__pyx_v_x, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 461, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_t_7 = __Pyx_GetItemInt(__pyx_v_x, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 461, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_7);
      __pyx_t_8 = PyNumber_Subtract(__pyx_t_4, __pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 461, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_8);
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
      __pyx_t_7 = PyNumber_Absolute(__pyx_t_8); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 461, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_7);
      __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
      __pyx_t_8 = __Pyx_GetItemInt(__pyx_v_x, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 461, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_8);
      __pyx_t_4 = __Pyx_PyDict_GetItem(__pyx_v_data_hash, __pyx_t_8); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 461, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
      __pyx_t_8 = __Pyx_GetItemInt(__pyx_v_x, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 461, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_8);
      __pyx_t_9 = PyNumber_Subtract(__pyx_t_4, __pyx_t_8); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 461, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_9);
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
      __pyx_t_8 = PyNumber_Absolute(__pyx_t_9); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 461, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_8);
      __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
      __pyx_t_9 = PyObject_RichCompare(__pyx_t_7, __pyx_t_8, Py_LT); __Pyx_XGOTREF(__pyx_t_9); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 461, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
      __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
      __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_9); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 461, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
      if (__pyx_t_6) {
        __pyx_t_9 = __Pyx_GetItemInt(__pyx_v_x, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 461, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_9);
        __pyx_t_8 = __Pyx_GetItemInt(__pyx_v_x, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 461, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_8);
        if (unlikely(PyDict_SetItem(__pyx_v_data_hash, __pyx_t_8, __pyx_t_9) < 0)) __PYX_ERR(0, 461, __pyx_L1_error)
        __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
        __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
      }
    }
    __pyx_L5:;

    /* "vapor_vali/Simple_function.pyx":458
 *     #keep dots closest to diagnal
 *     data_hash={}
 *     for x in ref_dotdata:             # <<<<<<<<<<<<<<
 *         if not x[0] in data_hash:    data_hash[x[0]]=x[1]
 *         else:
 */
  }
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":462
 *         else:
 *             if abs(x[1]-x[0])<abs(data_hash[x[0]]-x[0]):    data_hash[x[0]]=x[1]
 *     out=[[[i,data_hash[i]] for i in sorted(data_hash.keys())],[]]             # <<<<<<<<<<<<<<
 *     return out
 * 
 */
  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 462, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_8 = __Pyx_PyDict_Keys(__pyx_v_data_hash); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 462, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_8);
  __pyx_t_7 = PySequence_List(__pyx_t_8); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 462, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
  __pyx_t_9 = ((PyObject*)__pyx_t_7);
  __pyx_t_7 = 0;
  __pyx_t_10 = PyList_Sort(__pyx_t_9); if (unlikely(__pyx_t_10 == -1)) __PYX_ERR(0, 462, __pyx_L1_error)
  if (unlikely(__pyx_t_9 == Py_None)) {
    PyErr_SetString(PyExc_TypeError, "'NoneType' object is not iterable");
    __PYX_ERR(0, 462, __pyx_L1_error)
  }
  __pyx_t_7 = __pyx_t_9; __Pyx_INCREF(__pyx_t_7); __pyx_t_2 = 0;
  __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
  for (;;) {
    if (__pyx_t_2 >= PyList_GET_SIZE(__pyx_t_7)) break;
    #if CYTHON_COMPILING_IN_CPYTHON
    __pyx_t_9 = PyList_GET_ITEM(__pyx_t_7, __pyx_t_2); __Pyx_INCREF(__pyx_t_9); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 462, __pyx_L1_error)
    #else
    __pyx_t_9 = PySequence_ITEM(__pyx_t_7, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 462, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_9);
    #endif
    __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_9);
    __pyx_t_9 = 0;
    __pyx_t_9 = __Pyx_PyDict_GetItem(__pyx_v_data_hash, __pyx_v_i); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 462, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_9);
    __pyx_t_8 = PyList_New(2); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 462, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_8);
    __Pyx_INCREF(__pyx_v_i);
    __Pyx_GIVEREF(__pyx_v_i);
    PyList_SET_ITEM(__pyx_t_8, 0, __pyx_v_i);
    __Pyx_GIVEREF(__pyx_t_9);
    PyList_SET_ITEM(__pyx_t_8, 1, __pyx_t_9);
    __pyx_t_9 = 0;
    if (unlikely(__Pyx_ListComp_Append(__pyx_t_1, (PyObject*)__pyx_t_8))) __PYX_ERR(0, 462, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
  }
  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_7 = PyList_New(0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 462, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  __pyx_t_8 = PyList_New(2); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 462, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_8);
  __Pyx_GIVEREF(__pyx_t_1);
  PyList_SET_ITEM(__pyx_t_8, 0, __pyx_t_1);
  __Pyx_GIVEREF(__pyx_t_7);
  PyList_SET_ITEM(__pyx_t_8, 1, __pyx_t_7);
  __pyx_t_1 = 0;
  __pyx_t_7 = 0;
  __pyx_v_out = ((PyObject*)__pyx_t_8);
  __pyx_t_8 = 0;

  /* "vapor_vali/Simple_function.pyx":463
 *             if abs(x[1]-x[0])<abs(data_hash[x[0]]-x[0]):    data_hash[x[0]]=x[1]
 *     out=[[[i,data_hash[i]] for i in sorted(data_hash.keys())],[]]
 *     return out             # <<<<<<<<<<<<<<
 * 
 * def complementary(seq):
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_out);
  __pyx_r = __pyx_v_out;
  goto __pyx_L0;

  /* "vapor_vali/Simple_function.pyx":455
 *     return out_list
 * 
 * def clean_dotdata_m2(ref_dotdata):             # <<<<<<<<<<<<<<
 *     #keep dots closest to diagnal
 *     data_hash={}
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_7);
  __Pyx_XDECREF(__pyx_t_8);
  __Pyx_XDECREF(__pyx_t_9);
  __Pyx_AddTraceback("vapor_vali.Simple_function.clean_dotdata_m2", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_data_hash);
  __Pyx_XDECREF(__pyx_v_x);
  __Pyx_XDECREF(__pyx_v_out);
  __Pyx_XDECREF(__pyx_v_i);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "vapor_vali/Simple_function.pyx":465
 *     return out
 * 
 * def complementary(seq):             # <<<<<<<<<<<<<<
 *     seq2=[]
 *     for i in seq:
 */

/* Python wrapper */
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_57complementary(PyObject *__pyx_self, PyObject *__pyx_v_seq); /*proto*/
static PyMethodDef __pyx_mdef_10vapor_vali_15Simple_function_57complementary = {"complementary", (PyCFunction)__pyx_pw_10vapor_vali_15Simple_function_57complementary, METH_O, 0};
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_57complementary(PyObject *__pyx_self, PyObject *__pyx_v_seq) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("complementary (wrapper)", 0);
  __pyx_r = __pyx_pf_10vapor_vali_15Simple_function_56complementary(__pyx_self, ((PyObject *)__pyx_v_seq));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10vapor_vali_15Simple_function_56complementary(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_seq) {
  PyObject *__pyx_v_seq2 = NULL;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  Py_ssize_t __pyx_t_2;
  PyObject *(*__pyx_t_3)(PyObject *);
  PyObject *__pyx_t_4 = NULL;
  int __pyx_t_5;
  int __pyx_t_6;
  PyObject *__pyx_t_7 = NULL;
  PyObject *__pyx_t_8 = NULL;
  PyObject *__pyx_t_9 = NULL;
  int __pyx_t_10;
  __Pyx_RefNannySetupContext("complementary", 0);

  /* "vapor_vali/Simple_function.pyx":466
 * 
 * def complementary(seq):
 *     seq2=[]             # <<<<<<<<<<<<<<
 *     for i in seq:
 *             if i in 'ATGCN':
 */
  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 466, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_seq2 = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":467
 * def complementary(seq):
 *     seq2=[]
 *     for i in seq:             # <<<<<<<<<<<<<<
 *             if i in 'ATGCN':
 *                     seq2.append('ATGCN'['TACGN'.index(i)])
 */
  if (likely(PyList_CheckExact(__pyx_v_seq)) || PyTuple_CheckExact(__pyx_v_seq)) {
    __pyx_t_1 = __pyx_v_seq; __Pyx_INCREF(__pyx_t_1); __pyx_t_2 = 0;
    __pyx_t_3 = NULL;
  } else {
    __pyx_t_2 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_v_seq); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 467, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_3 = Py_TYPE(__pyx_t_1)->tp_iternext; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 467, __pyx_L1_error)
  }
  for (;;) {
    if (likely(!__pyx_t_3)) {
      if (likely(PyList_CheckExact(__pyx_t_1))) {
        if (__pyx_t_2 >= PyList_GET_SIZE(__pyx_t_1)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_4 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_4); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 467, __pyx_L1_error)
        #else
        __pyx_t_4 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 467, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_4);
        #endif
      } else {
        if (__pyx_t_2 >= PyTuple_GET_SIZE(__pyx_t_1)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_4 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_4); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 467, __pyx_L1_error)
        #else
        __pyx_t_4 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 467, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_4);
        #endif
      }
    } else {
      __pyx_t_4 = __pyx_t_3(__pyx_t_1);
      if (unlikely(!__pyx_t_4)) {
        PyObject* exc_type = PyErr_Occurred();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
          else __PYX_ERR(0, 467, __pyx_L1_error)
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_4);
    }
    __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_4);
    __pyx_t_4 = 0;

    /* "vapor_vali/Simple_function.pyx":468
 *     seq2=[]
 *     for i in seq:
 *             if i in 'ATGCN':             # <<<<<<<<<<<<<<
 *                     seq2.append('ATGCN'['TACGN'.index(i)])
 *             elif i in 'atgcn':
 */
    __pyx_t_5 = (__Pyx_PySequence_ContainsTF(__pyx_v_i, __pyx_n_s_ATGCN, Py_EQ)); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 468, __pyx_L1_error)
    __pyx_t_6 = (__pyx_t_5 != 0);
    if (__pyx_t_6) {

      /* "vapor_vali/Simple_function.pyx":469
 *     for i in seq:
 *             if i in 'ATGCN':
 *                     seq2.append('ATGCN'['TACGN'.index(i)])             # <<<<<<<<<<<<<<
 *             elif i in 'atgcn':
 *                     seq2.append('atgcn'['tacgn'.index(i)])
 */
      __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_n_s_TACGN, __pyx_n_s_index); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 469, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_7);
      __pyx_t_8 = NULL;
      if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_7))) {
        __pyx_t_8 = PyMethod_GET_SELF(__pyx_t_7);
        if (likely(__pyx_t_8)) {
          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_7);
          __Pyx_INCREF(__pyx_t_8);
          __Pyx_INCREF(function);
          __Pyx_DECREF_SET(__pyx_t_7, function);
        }
      }
      if (!__pyx_t_8) {
        __pyx_t_4 = __Pyx_PyObject_CallOneArg(__pyx_t_7, __pyx_v_i); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 469, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_4);
      } else {
        __pyx_t_9 = PyTuple_New(1+1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 469, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_9);
        __Pyx_GIVEREF(__pyx_t_8); PyTuple_SET_ITEM(__pyx_t_9, 0, __pyx_t_8); __pyx_t_8 = NULL;
        __Pyx_INCREF(__pyx_v_i);
        __Pyx_GIVEREF(__pyx_v_i);
        PyTuple_SET_ITEM(__pyx_t_9, 0+1, __pyx_v_i);
        __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_7, __pyx_t_9, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 469, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_4);
        __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
      }
      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
      __pyx_t_7 = PyObject_GetItem(__pyx_n_s_ATGCN, __pyx_t_4); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 469, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_7);
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_10 = __Pyx_PyList_Append(__pyx_v_seq2, __pyx_t_7); if (unlikely(__pyx_t_10 == -1)) __PYX_ERR(0, 469, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;

      /* "vapor_vali/Simple_function.pyx":468
 *     seq2=[]
 *     for i in seq:
 *             if i in 'ATGCN':             # <<<<<<<<<<<<<<
 *                     seq2.append('ATGCN'['TACGN'.index(i)])
 *             elif i in 'atgcn':
 */
      goto __pyx_L5;
    }

    /* "vapor_vali/Simple_function.pyx":470
 *             if i in 'ATGCN':
 *                     seq2.append('ATGCN'['TACGN'.index(i)])
 *             elif i in 'atgcn':             # <<<<<<<<<<<<<<
 *                     seq2.append('atgcn'['tacgn'.index(i)])
 *     return ''.join(seq2)
 */
    __pyx_t_6 = (__Pyx_PySequence_ContainsTF(__pyx_v_i, __pyx_n_s_atgcn, Py_EQ)); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 470, __pyx_L1_error)
    __pyx_t_5 = (__pyx_t_6 != 0);
    if (__pyx_t_5) {

      /* "vapor_vali/Simple_function.pyx":471
 *                     seq2.append('ATGCN'['TACGN'.index(i)])
 *             elif i in 'atgcn':
 *                     seq2.append('atgcn'['tacgn'.index(i)])             # <<<<<<<<<<<<<<
 *     return ''.join(seq2)
 * 
 */
      __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_n_s_tacgn, __pyx_n_s_index); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 471, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_t_9 = NULL;
      if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_4))) {
        __pyx_t_9 = PyMethod_GET_SELF(__pyx_t_4);
        if (likely(__pyx_t_9)) {
          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
          __Pyx_INCREF(__pyx_t_9);
          __Pyx_INCREF(function);
          __Pyx_DECREF_SET(__pyx_t_4, function);
        }
      }
      if (!__pyx_t_9) {
        __pyx_t_7 = __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_v_i); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 471, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_7);
      } else {
        __pyx_t_8 = PyTuple_New(1+1); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 471, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_8);
        __Pyx_GIVEREF(__pyx_t_9); PyTuple_SET_ITEM(__pyx_t_8, 0, __pyx_t_9); __pyx_t_9 = NULL;
        __Pyx_INCREF(__pyx_v_i);
        __Pyx_GIVEREF(__pyx_v_i);
        PyTuple_SET_ITEM(__pyx_t_8, 0+1, __pyx_v_i);
        __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_8, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 471, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_7);
        __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
      }
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_4 = PyObject_GetItem(__pyx_n_s_atgcn, __pyx_t_7); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 471, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
      __pyx_t_10 = __Pyx_PyList_Append(__pyx_v_seq2, __pyx_t_4); if (unlikely(__pyx_t_10 == -1)) __PYX_ERR(0, 471, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;

      /* "vapor_vali/Simple_function.pyx":470
 *             if i in 'ATGCN':
 *                     seq2.append('ATGCN'['TACGN'.index(i)])
 *             elif i in 'atgcn':             # <<<<<<<<<<<<<<
 *                     seq2.append('atgcn'['tacgn'.index(i)])
 *     return ''.join(seq2)
 */
    }
    __pyx_L5:;

    /* "vapor_vali/Simple_function.pyx":467
 * def complementary(seq):
 *     seq2=[]
 *     for i in seq:             # <<<<<<<<<<<<<<
 *             if i in 'ATGCN':
 *                     seq2.append('ATGCN'['TACGN'.index(i)])
 */
  }
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":472
 *             elif i in 'atgcn':
 *                     seq2.append('atgcn'['tacgn'.index(i)])
 *     return ''.join(seq2)             # <<<<<<<<<<<<<<
 * 
 * def compute_bic(kmeans,X):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = __Pyx_PyString_Join(__pyx_kp_s__24, __pyx_v_seq2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 472, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* "vapor_vali/Simple_function.pyx":465
 *     return out
 * 
 * def complementary(seq):             # <<<<<<<<<<<<<<
 *     seq2=[]
 *     for i in seq:
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_7);
  __Pyx_XDECREF(__pyx_t_8);
  __Pyx_XDECREF(__pyx_t_9);
  __Pyx_AddTraceback("vapor_vali.Simple_function.complementary", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_seq2);
  __Pyx_XDECREF(__pyx_v_i);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "vapor_vali/Simple_function.pyx":474
 *     return ''.join(seq2)
 * 
 * def compute_bic(kmeans,X):             # <<<<<<<<<<<<<<
 *     """
 *     Computes the BIC metric for a given clusters
 */

/* Python wrapper */
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_59compute_bic(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_10vapor_vali_15Simple_function_58compute_bic[] = "\n    Computes the BIC metric for a given clusters\n    Parameters:\n    -----------------------------------------\n    kmeans:  List of clustering object from scikit learn\n    X     :  multidimension np array of data points\n    Returns:\n    -----------------------------------------\n    BIC value\n    ";
static PyMethodDef __pyx_mdef_10vapor_vali_15Simple_function_59compute_bic = {"compute_bic", (PyCFunction)__pyx_pw_10vapor_vali_15Simple_function_59compute_bic, METH_VARARGS|METH_KEYWORDS, __pyx_doc_10vapor_vali_15Simple_function_58compute_bic};
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_59compute_bic(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_kmeans = 0;
  PyObject *__pyx_v_X = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("compute_bic (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_kmeans,&__pyx_n_s_X,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_kmeans)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_X)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("compute_bic", 1, 2, 2, 1); __PYX_ERR(0, 474, __pyx_L3_error)
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "compute_bic") < 0)) __PYX_ERR(0, 474, __pyx_L3_error)
      }
    } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
    }
    __pyx_v_kmeans = values[0];
    __pyx_v_X = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("compute_bic", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 474, __pyx_L3_error)
  __pyx_L3_error:;
  __Pyx_AddTraceback("vapor_vali.Simple_function.compute_bic", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_10vapor_vali_15Simple_function_58compute_bic(__pyx_self, __pyx_v_kmeans, __pyx_v_X);

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10vapor_vali_15Simple_function_58compute_bic(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_kmeans, PyObject *__pyx_v_X) {
  PyObject *__pyx_v_centers = NULL;
  PyObject *__pyx_v_labels = NULL;
  PyObject *__pyx_v_m = NULL;
  PyObject *__pyx_v_n = NULL;
  PyObject *__pyx_v_N = NULL;
  PyObject *__pyx_v_d = NULL;
  PyObject *__pyx_v_cl_var = NULL;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_v_const_term = NULL;
  PyObject *__pyx_v_BIC = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  PyObject *(*__pyx_t_5)(PyObject *);
  Py_ssize_t __pyx_t_6;
  PyObject *(*__pyx_t_7)(PyObject *);
  int __pyx_t_8;
  int __pyx_t_9;
  PyObject *__pyx_t_10 = NULL;
  PyObject *__pyx_t_11 = NULL;
  PyObject *__pyx_t_12 = NULL;
  PyObject *__pyx_t_13 = NULL;
  PyObject *__pyx_t_14 = NULL;
  Py_ssize_t __pyx_t_15;
  int __pyx_t_16;
  PyObject *__pyx_t_17 = NULL;
  PyObject *__pyx_t_18 = NULL;
  __Pyx_RefNannySetupContext("compute_bic", 0);

  /* "vapor_vali/Simple_function.pyx":486
 *     """
 *     # assign centers and labels
 *     centers = [kmeans.cluster_centers_]             # <<<<<<<<<<<<<<
 *     labels  = kmeans.labels_
 *     #number of clusters
 */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_kmeans, __pyx_n_s_cluster_centers); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 486, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = PyList_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 486, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_GIVEREF(__pyx_t_1);
  PyList_SET_ITEM(__pyx_t_2, 0, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_v_centers = ((PyObject*)__pyx_t_2);
  __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":487
 *     # assign centers and labels
 *     centers = [kmeans.cluster_centers_]
 *     labels  = kmeans.labels_             # <<<<<<<<<<<<<<
 *     #number of clusters
 *     m = kmeans.n_clusters
 */
  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_kmeans, __pyx_n_s_labels); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 487, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_v_labels = __pyx_t_2;
  __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":489
 *     labels  = kmeans.labels_
 *     #number of clusters
 *     m = kmeans.n_clusters             # <<<<<<<<<<<<<<
 *     # size of the clusters
 *     n = np.bincount(labels)
 */
  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_kmeans, __pyx_n_s_n_clusters); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 489, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_v_m = __pyx_t_2;
  __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":491
 *     m = kmeans.n_clusters
 *     # size of the clusters
 *     n = np.bincount(labels)             # <<<<<<<<<<<<<<
 *     #size of data set
 *     N, d = X.shape
 */
  __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 491, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_bincount); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 491, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_3))) {
    __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_3);
    if (likely(__pyx_t_1)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
      __Pyx_INCREF(__pyx_t_1);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_3, function);
    }
  }
  if (!__pyx_t_1) {
    __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_v_labels); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 491, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
  } else {
    __pyx_t_4 = PyTuple_New(1+1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 491, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_GIVEREF(__pyx_t_1); PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_1); __pyx_t_1 = NULL;
    __Pyx_INCREF(__pyx_v_labels);
    __Pyx_GIVEREF(__pyx_v_labels);
    PyTuple_SET_ITEM(__pyx_t_4, 0+1, __pyx_v_labels);
    __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_4, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 491, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  }
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_n = __pyx_t_2;
  __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":493
 *     n = np.bincount(labels)
 *     #size of data set
 *     N, d = X.shape             # <<<<<<<<<<<<<<
 *     #compute variance for all clusters beforehand
 *     cl_var=[]
 */
  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_X, __pyx_n_s_shape); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 493, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if ((likely(PyTuple_CheckExact(__pyx_t_2))) || (PyList_CheckExact(__pyx_t_2))) {
    PyObject* sequence = __pyx_t_2;
    #if CYTHON_COMPILING_IN_CPYTHON
    Py_ssize_t size = Py_SIZE(sequence);
    #else
    Py_ssize_t size = PySequence_Size(sequence);
    #endif
    if (unlikely(size != 2)) {
      if (size > 2) __Pyx_RaiseTooManyValuesError(2);
      else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
      __PYX_ERR(0, 493, __pyx_L1_error)
    }
    #if CYTHON_COMPILING_IN_CPYTHON
    if (likely(PyTuple_CheckExact(sequence))) {
      __pyx_t_3 = PyTuple_GET_ITEM(sequence, 0); 
      __pyx_t_4 = PyTuple_GET_ITEM(sequence, 1); 
    } else {
      __pyx_t_3 = PyList_GET_ITEM(sequence, 0); 
      __pyx_t_4 = PyList_GET_ITEM(sequence, 1); 
    }
    __Pyx_INCREF(__pyx_t_3);
    __Pyx_INCREF(__pyx_t_4);
    #else
    __pyx_t_3 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 493, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_4 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 493, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    #endif
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  } else {
    Py_ssize_t index = -1;
    __pyx_t_1 = PyObject_GetIter(__pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 493, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_5 = Py_TYPE(__pyx_t_1)->tp_iternext;
    index = 0; __pyx_t_3 = __pyx_t_5(__pyx_t_1); if (unlikely(!__pyx_t_3)) goto __pyx_L3_unpacking_failed;
    __Pyx_GOTREF(__pyx_t_3);
    index = 1; __pyx_t_4 = __pyx_t_5(__pyx_t_1); if (unlikely(!__pyx_t_4)) goto __pyx_L3_unpacking_failed;
    __Pyx_GOTREF(__pyx_t_4);
    if (__Pyx_IternextUnpackEndCheck(__pyx_t_5(__pyx_t_1), 2) < 0) __PYX_ERR(0, 493, __pyx_L1_error)
    __pyx_t_5 = NULL;
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    goto __pyx_L4_unpacking_done;
    __pyx_L3_unpacking_failed:;
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_5 = NULL;
    if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
    __PYX_ERR(0, 493, __pyx_L1_error)
    __pyx_L4_unpacking_done:;
  }
  __pyx_v_N = __pyx_t_3;
  __pyx_t_3 = 0;
  __pyx_v_d = __pyx_t_4;
  __pyx_t_4 = 0;

  /* "vapor_vali/Simple_function.pyx":495
 *     N, d = X.shape
 *     #compute variance for all clusters beforehand
 *     cl_var=[]             # <<<<<<<<<<<<<<
 *     for i in range(m):
 *         if not n[i] - m==0:
 */
  __pyx_t_2 = PyList_New(0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 495, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_v_cl_var = ((PyObject*)__pyx_t_2);
  __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":496
 *     #compute variance for all clusters beforehand
 *     cl_var=[]
 *     for i in range(m):             # <<<<<<<<<<<<<<
 *         if not n[i] - m==0:
 *             cl_var.append((1.0 / (n[i] - m)) * sum(distance.cdist(X[np.where(labels == i)], [centers[0][i]], 'euclidean')**2))
 */
  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 496, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_INCREF(__pyx_v_m);
  __Pyx_GIVEREF(__pyx_v_m);
  PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_v_m);
  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_t_2, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 496, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  if (likely(PyList_CheckExact(__pyx_t_4)) || PyTuple_CheckExact(__pyx_t_4)) {
    __pyx_t_2 = __pyx_t_4; __Pyx_INCREF(__pyx_t_2); __pyx_t_6 = 0;
    __pyx_t_7 = NULL;
  } else {
    __pyx_t_6 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_t_4); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 496, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_7 = Py_TYPE(__pyx_t_2)->tp_iternext; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 496, __pyx_L1_error)
  }
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  for (;;) {
    if (likely(!__pyx_t_7)) {
      if (likely(PyList_CheckExact(__pyx_t_2))) {
        if (__pyx_t_6 >= PyList_GET_SIZE(__pyx_t_2)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_4 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_6); __Pyx_INCREF(__pyx_t_4); __pyx_t_6++; if (unlikely(0 < 0)) __PYX_ERR(0, 496, __pyx_L1_error)
        #else
        __pyx_t_4 = PySequence_ITEM(__pyx_t_2, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 496, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_4);
        #endif
      } else {
        if (__pyx_t_6 >= PyTuple_GET_SIZE(__pyx_t_2)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_4 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_6); __Pyx_INCREF(__pyx_t_4); __pyx_t_6++; if (unlikely(0 < 0)) __PYX_ERR(0, 496, __pyx_L1_error)
        #else
        __pyx_t_4 = PySequence_ITEM(__pyx_t_2, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 496, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_4);
        #endif
      }
    } else {
      __pyx_t_4 = __pyx_t_7(__pyx_t_2);
      if (unlikely(!__pyx_t_4)) {
        PyObject* exc_type = PyErr_Occurred();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
          else __PYX_ERR(0, 496, __pyx_L1_error)
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_4);
    }
    __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_4);
    __pyx_t_4 = 0;

    /* "vapor_vali/Simple_function.pyx":497
 *     cl_var=[]
 *     for i in range(m):
 *         if not n[i] - m==0:             # <<<<<<<<<<<<<<
 *             cl_var.append((1.0 / (n[i] - m)) * sum(distance.cdist(X[np.where(labels == i)], [centers[0][i]], 'euclidean')**2))
 *         else:
 */
    __pyx_t_4 = PyObject_GetItem(__pyx_v_n, __pyx_v_i); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 497, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_3 = PyNumber_Subtract(__pyx_t_4, __pyx_v_m); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 497, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = __Pyx_PyInt_EqObjC(__pyx_t_3, __pyx_int_0, 0, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 497, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_8 = __Pyx_PyObject_IsTrue(__pyx_t_4); if (unlikely(__pyx_t_8 < 0)) __PYX_ERR(0, 497, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_9 = ((!__pyx_t_8) != 0);
    if (__pyx_t_9) {

      /* "vapor_vali/Simple_function.pyx":498
 *     for i in range(m):
 *         if not n[i] - m==0:
 *             cl_var.append((1.0 / (n[i] - m)) * sum(distance.cdist(X[np.where(labels == i)], [centers[0][i]], 'euclidean')**2))             # <<<<<<<<<<<<<<
 *         else:
 *             cl_var.append(float(10**20) * sum(distance.cdist(X[np.where(labels == i)], [centers[0][i]], 'euclidean')**2))
 */
      __pyx_t_4 = PyObject_GetItem(__pyx_v_n, __pyx_v_i); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 498, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_t_3 = PyNumber_Subtract(__pyx_t_4, __pyx_v_m); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 498, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_4 = __Pyx_PyFloat_DivideCObj(__pyx_float_1_0, __pyx_t_3, 1.0, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 498, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_distance); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 498, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_cdist); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 498, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_10);
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_11 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 498, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_11);
      __pyx_t_12 = __Pyx_PyObject_GetAttrStr(__pyx_t_11, __pyx_n_s_where); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 498, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_12);
      __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
      __pyx_t_11 = PyObject_RichCompare(__pyx_v_labels, __pyx_v_i, Py_EQ); __Pyx_XGOTREF(__pyx_t_11); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 498, __pyx_L1_error)
      __pyx_t_13 = NULL;
      if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_12))) {
        __pyx_t_13 = PyMethod_GET_SELF(__pyx_t_12);
        if (likely(__pyx_t_13)) {
          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_12);
          __Pyx_INCREF(__pyx_t_13);
          __Pyx_INCREF(function);
          __Pyx_DECREF_SET(__pyx_t_12, function);
        }
      }
      if (!__pyx_t_13) {
        __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_12, __pyx_t_11); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 498, __pyx_L1_error)
        __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
        __Pyx_GOTREF(__pyx_t_1);
      } else {
        __pyx_t_14 = PyTuple_New(1+1); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 498, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_14);
        __Pyx_GIVEREF(__pyx_t_13); PyTuple_SET_ITEM(__pyx_t_14, 0, __pyx_t_13); __pyx_t_13 = NULL;
        __Pyx_GIVEREF(__pyx_t_11);
        PyTuple_SET_ITEM(__pyx_t_14, 0+1, __pyx_t_11);
        __pyx_t_11 = 0;
        __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_12, __pyx_t_14, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 498, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
      }
      __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
      __pyx_t_12 = PyObject_GetItem(__pyx_v_X, __pyx_t_1); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 498, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_12);
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_1 = __Pyx_GetItemInt_List(__pyx_v_centers, 0, long, 1, __Pyx_PyInt_From_long, 1, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 498, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __pyx_t_14 = PyObject_GetItem(__pyx_t_1, __pyx_v_i); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 498, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_14);
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_1 = PyList_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 498, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_GIVEREF(__pyx_t_14);
      PyList_SET_ITEM(__pyx_t_1, 0, __pyx_t_14);
      __pyx_t_14 = 0;
      __pyx_t_14 = NULL;
      __pyx_t_15 = 0;
      if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_10))) {
        __pyx_t_14 = PyMethod_GET_SELF(__pyx_t_10);
        if (likely(__pyx_t_14)) {
          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_10);
          __Pyx_INCREF(__pyx_t_14);
          __Pyx_INCREF(function);
          __Pyx_DECREF_SET(__pyx_t_10, function);
          __pyx_t_15 = 1;
        }
      }
      __pyx_t_11 = PyTuple_New(3+__pyx_t_15); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 498, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_11);
      if (__pyx_t_14) {
        __Pyx_GIVEREF(__pyx_t_14); PyTuple_SET_ITEM(__pyx_t_11, 0, __pyx_t_14); __pyx_t_14 = NULL;
      }
      __Pyx_GIVEREF(__pyx_t_12);
      PyTuple_SET_ITEM(__pyx_t_11, 0+__pyx_t_15, __pyx_t_12);
      __Pyx_GIVEREF(__pyx_t_1);
      PyTuple_SET_ITEM(__pyx_t_11, 1+__pyx_t_15, __pyx_t_1);
      __Pyx_INCREF(__pyx_n_s_euclidean);
      __Pyx_GIVEREF(__pyx_n_s_euclidean);
      PyTuple_SET_ITEM(__pyx_t_11, 2+__pyx_t_15, __pyx_n_s_euclidean);
      __pyx_t_12 = 0;
      __pyx_t_1 = 0;
      __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_10, __pyx_t_11, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 498, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
      __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
      __pyx_t_10 = PyNumber_Power(__pyx_t_3, __pyx_int_2, Py_None); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 498, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_10);
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 498, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __Pyx_GIVEREF(__pyx_t_10);
      PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_10);
      __pyx_t_10 = 0;
      __pyx_t_10 = __Pyx_PyObject_Call(__pyx_builtin_sum, __pyx_t_3, NULL); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 498, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_10);
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_3 = PyNumber_Multiply(__pyx_t_4, __pyx_t_10); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 498, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
      __pyx_t_16 = __Pyx_PyList_Append(__pyx_v_cl_var, __pyx_t_3); if (unlikely(__pyx_t_16 == -1)) __PYX_ERR(0, 498, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;

      /* "vapor_vali/Simple_function.pyx":497
 *     cl_var=[]
 *     for i in range(m):
 *         if not n[i] - m==0:             # <<<<<<<<<<<<<<
 *             cl_var.append((1.0 / (n[i] - m)) * sum(distance.cdist(X[np.where(labels == i)], [centers[0][i]], 'euclidean')**2))
 *         else:
 */
      goto __pyx_L7;
    }

    /* "vapor_vali/Simple_function.pyx":500
 *             cl_var.append((1.0 / (n[i] - m)) * sum(distance.cdist(X[np.where(labels == i)], [centers[0][i]], 'euclidean')**2))
 *         else:
 *             cl_var.append(float(10**20) * sum(distance.cdist(X[np.where(labels == i)], [centers[0][i]], 'euclidean')**2))             # <<<<<<<<<<<<<<
 *     const_term = 0.5 * m * calcu_log10(N)
 *     BIC = np.sum([n[i] * calcu_log10(n[i]) -
 */
    /*else*/ {
      __pyx_t_3 = __Pyx_PyNumber_Float(__pyx_int_100000000000000000000); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 500, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __pyx_t_4 = __Pyx_GetModuleGlobalName(__pyx_n_s_distance); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 500, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_cdist); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 500, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_11);
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 500, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __pyx_t_12 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_where); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 500, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_12);
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_1 = PyObject_RichCompare(__pyx_v_labels, __pyx_v_i, Py_EQ); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 500, __pyx_L1_error)
      __pyx_t_14 = NULL;
      if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_12))) {
        __pyx_t_14 = PyMethod_GET_SELF(__pyx_t_12);
        if (likely(__pyx_t_14)) {
          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_12);
          __Pyx_INCREF(__pyx_t_14);
          __Pyx_INCREF(function);
          __Pyx_DECREF_SET(__pyx_t_12, function);
        }
      }
      if (!__pyx_t_14) {
        __pyx_t_4 = __Pyx_PyObject_CallOneArg(__pyx_t_12, __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 500, __pyx_L1_error)
        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
        __Pyx_GOTREF(__pyx_t_4);
      } else {
        __pyx_t_13 = PyTuple_New(1+1); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 500, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_13);
        __Pyx_GIVEREF(__pyx_t_14); PyTuple_SET_ITEM(__pyx_t_13, 0, __pyx_t_14); __pyx_t_14 = NULL;
        __Pyx_GIVEREF(__pyx_t_1);
        PyTuple_SET_ITEM(__pyx_t_13, 0+1, __pyx_t_1);
        __pyx_t_1 = 0;
        __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_12, __pyx_t_13, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 500, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_4);
        __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
      }
      __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
      __pyx_t_12 = PyObject_GetItem(__pyx_v_X, __pyx_t_4); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 500, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_12);
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_4 = __Pyx_GetItemInt_List(__pyx_v_centers, 0, long, 1, __Pyx_PyInt_From_long, 1, 0, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 500, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_t_13 = PyObject_GetItem(__pyx_t_4, __pyx_v_i); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 500, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_13);
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_4 = PyList_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 500, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      __Pyx_GIVEREF(__pyx_t_13);
      PyList_SET_ITEM(__pyx_t_4, 0, __pyx_t_13);
      __pyx_t_13 = 0;
      __pyx_t_13 = NULL;
      __pyx_t_15 = 0;
      if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_11))) {
        __pyx_t_13 = PyMethod_GET_SELF(__pyx_t_11);
        if (likely(__pyx_t_13)) {
          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_11);
          __Pyx_INCREF(__pyx_t_13);
          __Pyx_INCREF(function);
          __Pyx_DECREF_SET(__pyx_t_11, function);
          __pyx_t_15 = 1;
        }
      }
      __pyx_t_1 = PyTuple_New(3+__pyx_t_15); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 500, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      if (__pyx_t_13) {
        __Pyx_GIVEREF(__pyx_t_13); PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_13); __pyx_t_13 = NULL;
      }
      __Pyx_GIVEREF(__pyx_t_12);
      PyTuple_SET_ITEM(__pyx_t_1, 0+__pyx_t_15, __pyx_t_12);
      __Pyx_GIVEREF(__pyx_t_4);
      PyTuple_SET_ITEM(__pyx_t_1, 1+__pyx_t_15, __pyx_t_4);
      __Pyx_INCREF(__pyx_n_s_euclidean);
      __Pyx_GIVEREF(__pyx_n_s_euclidean);
      PyTuple_SET_ITEM(__pyx_t_1, 2+__pyx_t_15, __pyx_n_s_euclidean);
      __pyx_t_12 = 0;
      __pyx_t_4 = 0;
      __pyx_t_10 = __Pyx_PyObject_Call(__pyx_t_11, __pyx_t_1, NULL); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 500, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_10);
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
      __pyx_t_11 = PyNumber_Power(__pyx_t_10, __pyx_int_2, Py_None); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 500, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_11);
      __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
      __pyx_t_10 = PyTuple_New(1); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 500, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_10);
      __Pyx_GIVEREF(__pyx_t_11);
      PyTuple_SET_ITEM(__pyx_t_10, 0, __pyx_t_11);
      __pyx_t_11 = 0;
      __pyx_t_11 = __Pyx_PyObject_Call(__pyx_builtin_sum, __pyx_t_10, NULL); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 500, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_11);
      __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
      __pyx_t_10 = PyNumber_Multiply(__pyx_t_3, __pyx_t_11); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 500, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_10);
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
      __pyx_t_16 = __Pyx_PyList_Append(__pyx_v_cl_var, __pyx_t_10); if (unlikely(__pyx_t_16 == -1)) __PYX_ERR(0, 500, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
    }
    __pyx_L7:;

    /* "vapor_vali/Simple_function.pyx":496
 *     #compute variance for all clusters beforehand
 *     cl_var=[]
 *     for i in range(m):             # <<<<<<<<<<<<<<
 *         if not n[i] - m==0:
 *             cl_var.append((1.0 / (n[i] - m)) * sum(distance.cdist(X[np.where(labels == i)], [centers[0][i]], 'euclidean')**2))
 */
  }
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":501
 *         else:
 *             cl_var.append(float(10**20) * sum(distance.cdist(X[np.where(labels == i)], [centers[0][i]], 'euclidean')**2))
 *     const_term = 0.5 * m * calcu_log10(N)             # <<<<<<<<<<<<<<
 *     BIC = np.sum([n[i] * calcu_log10(n[i]) -
 *            n[i] * calcu_log10(N) -
 */
  __pyx_t_2 = PyNumber_Multiply(__pyx_float_0_5, __pyx_v_m); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 501, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_11 = __Pyx_GetModuleGlobalName(__pyx_n_s_calcu_log10); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 501, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_11);
  __pyx_t_3 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_11))) {
    __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_11);
    if (likely(__pyx_t_3)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_11);
      __Pyx_INCREF(__pyx_t_3);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_11, function);
    }
  }
  if (!__pyx_t_3) {
    __pyx_t_10 = __Pyx_PyObject_CallOneArg(__pyx_t_11, __pyx_v_N); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 501, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_10);
  } else {
    __pyx_t_1 = PyTuple_New(1+1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 501, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_GIVEREF(__pyx_t_3); PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_3); __pyx_t_3 = NULL;
    __Pyx_INCREF(__pyx_v_N);
    __Pyx_GIVEREF(__pyx_v_N);
    PyTuple_SET_ITEM(__pyx_t_1, 0+1, __pyx_v_N);
    __pyx_t_10 = __Pyx_PyObject_Call(__pyx_t_11, __pyx_t_1, NULL); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 501, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_10);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  }
  __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
  __pyx_t_11 = PyNumber_Multiply(__pyx_t_2, __pyx_t_10); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 501, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_11);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
  __pyx_v_const_term = __pyx_t_11;
  __pyx_t_11 = 0;

  /* "vapor_vali/Simple_function.pyx":502
 *             cl_var.append(float(10**20) * sum(distance.cdist(X[np.where(labels == i)], [centers[0][i]], 'euclidean')**2))
 *     const_term = 0.5 * m * calcu_log10(N)
 *     BIC = np.sum([n[i] * calcu_log10(n[i]) -             # <<<<<<<<<<<<<<
 *            n[i] * calcu_log10(N) -
 *          ((n[i] * d) / 2) * calcu_log10(2*np.pi) -
 */
  __pyx_t_10 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 502, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_10);
  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_10, __pyx_n_s_sum); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 502, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
  __pyx_t_10 = PyList_New(0); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 502, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_10);

  /* "vapor_vali/Simple_function.pyx":506
 *          ((n[i] * d) / 2) * calcu_log10(2*np.pi) -
 *           (n[i] / 2) * calcu_log10(cl_var[i]) -
 *          ((n[i] - m) / 2) for i in range(m)]) - const_term             # <<<<<<<<<<<<<<
 *     return(BIC)
 * 
 */
  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 506, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_INCREF(__pyx_v_m);
  __Pyx_GIVEREF(__pyx_v_m);
  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_m);
  __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_t_1, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 506, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  if (likely(PyList_CheckExact(__pyx_t_3)) || PyTuple_CheckExact(__pyx_t_3)) {
    __pyx_t_1 = __pyx_t_3; __Pyx_INCREF(__pyx_t_1); __pyx_t_6 = 0;
    __pyx_t_7 = NULL;
  } else {
    __pyx_t_6 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 506, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_7 = Py_TYPE(__pyx_t_1)->tp_iternext; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 506, __pyx_L1_error)
  }
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  for (;;) {
    if (likely(!__pyx_t_7)) {
      if (likely(PyList_CheckExact(__pyx_t_1))) {
        if (__pyx_t_6 >= PyList_GET_SIZE(__pyx_t_1)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_3 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_6); __Pyx_INCREF(__pyx_t_3); __pyx_t_6++; if (unlikely(0 < 0)) __PYX_ERR(0, 506, __pyx_L1_error)
        #else
        __pyx_t_3 = PySequence_ITEM(__pyx_t_1, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 506, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_3);
        #endif
      } else {
        if (__pyx_t_6 >= PyTuple_GET_SIZE(__pyx_t_1)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_3 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_6); __Pyx_INCREF(__pyx_t_3); __pyx_t_6++; if (unlikely(0 < 0)) __PYX_ERR(0, 506, __pyx_L1_error)
        #else
        __pyx_t_3 = PySequence_ITEM(__pyx_t_1, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 506, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_3);
        #endif
      }
    } else {
      __pyx_t_3 = __pyx_t_7(__pyx_t_1);
      if (unlikely(!__pyx_t_3)) {
        PyObject* exc_type = PyErr_Occurred();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
          else __PYX_ERR(0, 506, __pyx_L1_error)
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_3);
    }
    __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_3);
    __pyx_t_3 = 0;

    /* "vapor_vali/Simple_function.pyx":502
 *             cl_var.append(float(10**20) * sum(distance.cdist(X[np.where(labels == i)], [centers[0][i]], 'euclidean')**2))
 *     const_term = 0.5 * m * calcu_log10(N)
 *     BIC = np.sum([n[i] * calcu_log10(n[i]) -             # <<<<<<<<<<<<<<
 *            n[i] * calcu_log10(N) -
 *          ((n[i] * d) / 2) * calcu_log10(2*np.pi) -
 */
    __pyx_t_3 = PyObject_GetItem(__pyx_v_n, __pyx_v_i); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 502, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_12 = __Pyx_GetModuleGlobalName(__pyx_n_s_calcu_log10); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 502, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_12);
    __pyx_t_13 = PyObject_GetItem(__pyx_v_n, __pyx_v_i); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 502, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_13);
    __pyx_t_14 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_12))) {
      __pyx_t_14 = PyMethod_GET_SELF(__pyx_t_12);
      if (likely(__pyx_t_14)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_12);
        __Pyx_INCREF(__pyx_t_14);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_12, function);
      }
    }
    if (!__pyx_t_14) {
      __pyx_t_4 = __Pyx_PyObject_CallOneArg(__pyx_t_12, __pyx_t_13); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 502, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
      __Pyx_GOTREF(__pyx_t_4);
    } else {
      __pyx_t_17 = PyTuple_New(1+1); if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 502, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_17);
      __Pyx_GIVEREF(__pyx_t_14); PyTuple_SET_ITEM(__pyx_t_17, 0, __pyx_t_14); __pyx_t_14 = NULL;
      __Pyx_GIVEREF(__pyx_t_13);
      PyTuple_SET_ITEM(__pyx_t_17, 0+1, __pyx_t_13);
      __pyx_t_13 = 0;
      __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_12, __pyx_t_17, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 502, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      __Pyx_DECREF(__pyx_t_17); __pyx_t_17 = 0;
    }
    __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
    __pyx_t_12 = PyNumber_Multiply(__pyx_t_3, __pyx_t_4); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 502, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_12);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;

    /* "vapor_vali/Simple_function.pyx":503
 *     const_term = 0.5 * m * calcu_log10(N)
 *     BIC = np.sum([n[i] * calcu_log10(n[i]) -
 *            n[i] * calcu_log10(N) -             # <<<<<<<<<<<<<<
 *          ((n[i] * d) / 2) * calcu_log10(2*np.pi) -
 *           (n[i] / 2) * calcu_log10(cl_var[i]) -
 */
    __pyx_t_4 = PyObject_GetItem(__pyx_v_n, __pyx_v_i); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 503, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_17 = __Pyx_GetModuleGlobalName(__pyx_n_s_calcu_log10); if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 503, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_17);
    __pyx_t_13 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_17))) {
      __pyx_t_13 = PyMethod_GET_SELF(__pyx_t_17);
      if (likely(__pyx_t_13)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_17);
        __Pyx_INCREF(__pyx_t_13);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_17, function);
      }
    }
    if (!__pyx_t_13) {
      __pyx_t_3 = __Pyx_PyObject_CallOneArg(__pyx_t_17, __pyx_v_N); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 503, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
    } else {
      __pyx_t_14 = PyTuple_New(1+1); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 503, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_14);
      __Pyx_GIVEREF(__pyx_t_13); PyTuple_SET_ITEM(__pyx_t_14, 0, __pyx_t_13); __pyx_t_13 = NULL;
      __Pyx_INCREF(__pyx_v_N);
      __Pyx_GIVEREF(__pyx_v_N);
      PyTuple_SET_ITEM(__pyx_t_14, 0+1, __pyx_v_N);
      __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_17, __pyx_t_14, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 503, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
    }
    __Pyx_DECREF(__pyx_t_17); __pyx_t_17 = 0;
    __pyx_t_17 = PyNumber_Multiply(__pyx_t_4, __pyx_t_3); if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 503, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_17);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;

    /* "vapor_vali/Simple_function.pyx":502
 *             cl_var.append(float(10**20) * sum(distance.cdist(X[np.where(labels == i)], [centers[0][i]], 'euclidean')**2))
 *     const_term = 0.5 * m * calcu_log10(N)
 *     BIC = np.sum([n[i] * calcu_log10(n[i]) -             # <<<<<<<<<<<<<<
 *            n[i] * calcu_log10(N) -
 *          ((n[i] * d) / 2) * calcu_log10(2*np.pi) -
 */
    __pyx_t_3 = PyNumber_Subtract(__pyx_t_12, __pyx_t_17); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 502, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
    __Pyx_DECREF(__pyx_t_17); __pyx_t_17 = 0;

    /* "vapor_vali/Simple_function.pyx":504
 *     BIC = np.sum([n[i] * calcu_log10(n[i]) -
 *            n[i] * calcu_log10(N) -
 *          ((n[i] * d) / 2) * calcu_log10(2*np.pi) -             # <<<<<<<<<<<<<<
 *           (n[i] / 2) * calcu_log10(cl_var[i]) -
 *          ((n[i] - m) / 2) for i in range(m)]) - const_term
 */
    __pyx_t_17 = PyObject_GetItem(__pyx_v_n, __pyx_v_i); if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 504, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_17);
    __pyx_t_12 = PyNumber_Multiply(__pyx_t_17, __pyx_v_d); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 504, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_12);
    __Pyx_DECREF(__pyx_t_17); __pyx_t_17 = 0;
    __pyx_t_17 = __Pyx_PyNumber_Divide(__pyx_t_12, __pyx_int_2); if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 504, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_17);
    __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
    __pyx_t_4 = __Pyx_GetModuleGlobalName(__pyx_n_s_calcu_log10); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 504, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_14 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 504, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_14);
    __pyx_t_13 = __Pyx_PyObject_GetAttrStr(__pyx_t_14, __pyx_n_s_pi); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 504, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_13);
    __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
    __pyx_t_14 = PyNumber_Multiply(__pyx_int_2, __pyx_t_13); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 504, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_14);
    __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
    __pyx_t_13 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_4))) {
      __pyx_t_13 = PyMethod_GET_SELF(__pyx_t_4);
      if (likely(__pyx_t_13)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
        __Pyx_INCREF(__pyx_t_13);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_4, function);
      }
    }
    if (!__pyx_t_13) {
      __pyx_t_12 = __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_14); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 504, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
      __Pyx_GOTREF(__pyx_t_12);
    } else {
      __pyx_t_18 = PyTuple_New(1+1); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 504, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_18);
      __Pyx_GIVEREF(__pyx_t_13); PyTuple_SET_ITEM(__pyx_t_18, 0, __pyx_t_13); __pyx_t_13 = NULL;
      __Pyx_GIVEREF(__pyx_t_14);
      PyTuple_SET_ITEM(__pyx_t_18, 0+1, __pyx_t_14);
      __pyx_t_14 = 0;
      __pyx_t_12 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_18, NULL); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 504, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_12);
      __Pyx_DECREF(__pyx_t_18); __pyx_t_18 = 0;
    }
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = PyNumber_Multiply(__pyx_t_17, __pyx_t_12); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 504, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_17); __pyx_t_17 = 0;
    __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;

    /* "vapor_vali/Simple_function.pyx":503
 *     const_term = 0.5 * m * calcu_log10(N)
 *     BIC = np.sum([n[i] * calcu_log10(n[i]) -
 *            n[i] * calcu_log10(N) -             # <<<<<<<<<<<<<<
 *          ((n[i] * d) / 2) * calcu_log10(2*np.pi) -
 *           (n[i] / 2) * calcu_log10(cl_var[i]) -
 */
    __pyx_t_12 = PyNumber_Subtract(__pyx_t_3, __pyx_t_4); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 503, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_12);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;

    /* "vapor_vali/Simple_function.pyx":505
 *            n[i] * calcu_log10(N) -
 *          ((n[i] * d) / 2) * calcu_log10(2*np.pi) -
 *           (n[i] / 2) * calcu_log10(cl_var[i]) -             # <<<<<<<<<<<<<<
 *          ((n[i] - m) / 2) for i in range(m)]) - const_term
 *     return(BIC)
 */
    __pyx_t_4 = PyObject_GetItem(__pyx_v_n, __pyx_v_i); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 505, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_3 = __Pyx_PyNumber_Divide(__pyx_t_4, __pyx_int_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 505, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_17 = __Pyx_GetModuleGlobalName(__pyx_n_s_calcu_log10); if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 505, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_17);
    __pyx_t_18 = PyObject_GetItem(__pyx_v_cl_var, __pyx_v_i); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 505, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_18);
    __pyx_t_14 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_17))) {
      __pyx_t_14 = PyMethod_GET_SELF(__pyx_t_17);
      if (likely(__pyx_t_14)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_17);
        __Pyx_INCREF(__pyx_t_14);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_17, function);
      }
    }
    if (!__pyx_t_14) {
      __pyx_t_4 = __Pyx_PyObject_CallOneArg(__pyx_t_17, __pyx_t_18); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 505, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_18); __pyx_t_18 = 0;
      __Pyx_GOTREF(__pyx_t_4);
    } else {
      __pyx_t_13 = PyTuple_New(1+1); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 505, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_13);
      __Pyx_GIVEREF(__pyx_t_14); PyTuple_SET_ITEM(__pyx_t_13, 0, __pyx_t_14); __pyx_t_14 = NULL;
      __Pyx_GIVEREF(__pyx_t_18);
      PyTuple_SET_ITEM(__pyx_t_13, 0+1, __pyx_t_18);
      __pyx_t_18 = 0;
      __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_17, __pyx_t_13, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 505, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
    }
    __Pyx_DECREF(__pyx_t_17); __pyx_t_17 = 0;
    __pyx_t_17 = PyNumber_Multiply(__pyx_t_3, __pyx_t_4); if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 505, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_17);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;

    /* "vapor_vali/Simple_function.pyx":504
 *     BIC = np.sum([n[i] * calcu_log10(n[i]) -
 *            n[i] * calcu_log10(N) -
 *          ((n[i] * d) / 2) * calcu_log10(2*np.pi) -             # <<<<<<<<<<<<<<
 *           (n[i] / 2) * calcu_log10(cl_var[i]) -
 *          ((n[i] - m) / 2) for i in range(m)]) - const_term
 */
    __pyx_t_4 = PyNumber_Subtract(__pyx_t_12, __pyx_t_17); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 504, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
    __Pyx_DECREF(__pyx_t_17); __pyx_t_17 = 0;

    /* "vapor_vali/Simple_function.pyx":506
 *          ((n[i] * d) / 2) * calcu_log10(2*np.pi) -
 *           (n[i] / 2) * calcu_log10(cl_var[i]) -
 *          ((n[i] - m) / 2) for i in range(m)]) - const_term             # <<<<<<<<<<<<<<
 *     return(BIC)
 * 
 */
    __pyx_t_17 = PyObject_GetItem(__pyx_v_n, __pyx_v_i); if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 506, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_17);
    __pyx_t_12 = PyNumber_Subtract(__pyx_t_17, __pyx_v_m); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 506, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_12);
    __Pyx_DECREF(__pyx_t_17); __pyx_t_17 = 0;
    __pyx_t_17 = __Pyx_PyNumber_Divide(__pyx_t_12, __pyx_int_2); if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 506, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_17);
    __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;

    /* "vapor_vali/Simple_function.pyx":505
 *            n[i] * calcu_log10(N) -
 *          ((n[i] * d) / 2) * calcu_log10(2*np.pi) -
 *           (n[i] / 2) * calcu_log10(cl_var[i]) -             # <<<<<<<<<<<<<<
 *          ((n[i] - m) / 2) for i in range(m)]) - const_term
 *     return(BIC)
 */
    __pyx_t_12 = PyNumber_Subtract(__pyx_t_4, __pyx_t_17); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 505, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_12);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __Pyx_DECREF(__pyx_t_17); __pyx_t_17 = 0;
    if (unlikely(__Pyx_ListComp_Append(__pyx_t_10, (PyObject*)__pyx_t_12))) __PYX_ERR(0, 502, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;

    /* "vapor_vali/Simple_function.pyx":506
 *          ((n[i] * d) / 2) * calcu_log10(2*np.pi) -
 *           (n[i] / 2) * calcu_log10(cl_var[i]) -
 *          ((n[i] - m) / 2) for i in range(m)]) - const_term             # <<<<<<<<<<<<<<
 *     return(BIC)
 * 
 */
  }
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_2);
    if (likely(__pyx_t_1)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_1);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_2, function);
    }
  }
  if (!__pyx_t_1) {
    __pyx_t_11 = __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_10); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 502, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
    __Pyx_GOTREF(__pyx_t_11);
  } else {
    __pyx_t_12 = PyTuple_New(1+1); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 502, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_12);
    __Pyx_GIVEREF(__pyx_t_1); PyTuple_SET_ITEM(__pyx_t_12, 0, __pyx_t_1); __pyx_t_1 = NULL;
    __Pyx_GIVEREF(__pyx_t_10);
    PyTuple_SET_ITEM(__pyx_t_12, 0+1, __pyx_t_10);
    __pyx_t_10 = 0;
    __pyx_t_11 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_12, NULL); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 502, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_11);
    __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
  }
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = PyNumber_Subtract(__pyx_t_11, __pyx_v_const_term); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 506, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
  __pyx_v_BIC = __pyx_t_2;
  __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":507
 *           (n[i] / 2) * calcu_log10(cl_var[i]) -
 *          ((n[i] - m) / 2) for i in range(m)]) - const_term
 *     return(BIC)             # <<<<<<<<<<<<<<
 * 
 * def dup_inv_ref_alt_bps_produce(sv_info,flank_length,alt_structure):
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_BIC);
  __pyx_r = __pyx_v_BIC;
  goto __pyx_L0;

  /* "vapor_vali/Simple_function.pyx":474
 *     return ''.join(seq2)
 * 
 * def compute_bic(kmeans,X):             # <<<<<<<<<<<<<<
 *     """
 *     Computes the BIC metric for a given clusters
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_10);
  __Pyx_XDECREF(__pyx_t_11);
  __Pyx_XDECREF(__pyx_t_12);
  __Pyx_XDECREF(__pyx_t_13);
  __Pyx_XDECREF(__pyx_t_14);
  __Pyx_XDECREF(__pyx_t_17);
  __Pyx_XDECREF(__pyx_t_18);
  __Pyx_AddTraceback("vapor_vali.Simple_function.compute_bic", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_centers);
  __Pyx_XDECREF(__pyx_v_labels);
  __Pyx_XDECREF(__pyx_v_m);
  __Pyx_XDECREF(__pyx_v_n);
  __Pyx_XDECREF(__pyx_v_N);
  __Pyx_XDECREF(__pyx_v_d);
  __Pyx_XDECREF(__pyx_v_cl_var);
  __Pyx_XDECREF(__pyx_v_i);
  __Pyx_XDECREF(__pyx_v_const_term);
  __Pyx_XDECREF(__pyx_v_BIC);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "vapor_vali/Simple_function.pyx":509
 *     return(BIC)
 * 
 * def dup_inv_ref_alt_bps_produce(sv_info,flank_length,alt_structure):             # <<<<<<<<<<<<<<
 *     bp_info=sorted(sv_info[1:3]+[sv_info[4]])
 *     block_len=bp_to_block_len([sv_info[0]]+bp_info)
 */

/* Python wrapper */
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_61dup_inv_ref_alt_bps_produce(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_10vapor_vali_15Simple_function_61dup_inv_ref_alt_bps_produce = {"dup_inv_ref_alt_bps_produce", (PyCFunction)__pyx_pw_10vapor_vali_15Simple_function_61dup_inv_ref_alt_bps_produce, METH_VARARGS|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_61dup_inv_ref_alt_bps_produce(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_sv_info = 0;
  PyObject *__pyx_v_flank_length = 0;
  PyObject *__pyx_v_alt_structure = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("dup_inv_ref_alt_bps_produce (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_sv_info,&__pyx_n_s_flank_length,&__pyx_n_s_alt_structure,0};
    PyObject* values[3] = {0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
      switch (pos_args) {
        case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_sv_info)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_flank_length)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("dup_inv_ref_alt_bps_produce", 1, 3, 3, 1); __PYX_ERR(0, 509, __pyx_L3_error)
        }
        case  2:
        if (likely((values[2] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_alt_structure)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("dup_inv_ref_alt_bps_produce", 1, 3, 3, 2); __PYX_ERR(0, 509, __pyx_L3_error)
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "dup_inv_ref_alt_bps_produce") < 0)) __PYX_ERR(0, 509, __pyx_L3_error)
      }
    } else if (PyTuple_GET_SIZE(__pyx_args) != 3) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
    }
    __pyx_v_sv_info = values[0];
    __pyx_v_flank_length = values[1];
    __pyx_v_alt_structure = values[2];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("dup_inv_ref_alt_bps_produce", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 509, __pyx_L3_error)
  __pyx_L3_error:;
  __Pyx_AddTraceback("vapor_vali.Simple_function.dup_inv_ref_alt_bps_produce", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_10vapor_vali_15Simple_function_60dup_inv_ref_alt_bps_produce(__pyx_self, __pyx_v_sv_info, __pyx_v_flank_length, __pyx_v_alt_structure);

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10vapor_vali_15Simple_function_60dup_inv_ref_alt_bps_produce(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_sv_info, PyObject *__pyx_v_flank_length, PyObject *__pyx_v_alt_structure) {
  PyObject *__pyx_v_bp_info = NULL;
  PyObject *__pyx_v_block_len = NULL;
  PyObject *__pyx_v_ref_bps = NULL;
  PyObject *__pyx_v_alt_bps = NULL;
  PyObject *__pyx_v_let_single = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  int __pyx_t_5;
  PyObject *__pyx_t_6 = NULL;
  Py_ssize_t __pyx_t_7;
  PyObject *(*__pyx_t_8)(PyObject *);
  __Pyx_RefNannySetupContext("dup_inv_ref_alt_bps_produce", 0);

  /* "vapor_vali/Simple_function.pyx":510
 * 
 * def dup_inv_ref_alt_bps_produce(sv_info,flank_length,alt_structure):
 *     bp_info=sorted(sv_info[1:3]+[sv_info[4]])             # <<<<<<<<<<<<<<
 *     block_len=bp_to_block_len([sv_info[0]]+bp_info)
 *     ref_bps=[bp_info[0]-flank_length]+bp_info+[bp_info[-1]+flank_length]
 */
  __pyx_t_2 = __Pyx_PyObject_GetSlice(__pyx_v_sv_info, 1, 3, NULL, NULL, &__pyx_slice__32, 1, 1, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 510, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_sv_info, 4, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 510, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_4 = PyList_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 510, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_GIVEREF(__pyx_t_3);
  PyList_SET_ITEM(__pyx_t_4, 0, __pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = PyNumber_Add(__pyx_t_2, __pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 510, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = PySequence_List(__pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 510, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_1 = ((PyObject*)__pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_5 = PyList_Sort(__pyx_t_1); if (unlikely(__pyx_t_5 == -1)) __PYX_ERR(0, 510, __pyx_L1_error)
  __pyx_v_bp_info = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":511
 * def dup_inv_ref_alt_bps_produce(sv_info,flank_length,alt_structure):
 *     bp_info=sorted(sv_info[1:3]+[sv_info[4]])
 *     block_len=bp_to_block_len([sv_info[0]]+bp_info)             # <<<<<<<<<<<<<<
 *     ref_bps=[bp_info[0]-flank_length]+bp_info+[bp_info[-1]+flank_length]
 *     alt_bps=ref_bps[:2]
 */
  __pyx_t_4 = __Pyx_GetModuleGlobalName(__pyx_n_s_bp_to_block_len); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 511, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_sv_info, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 511, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_2 = PyList_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 511, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_GIVEREF(__pyx_t_3);
  PyList_SET_ITEM(__pyx_t_2, 0, __pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = PyNumber_Add(__pyx_t_2, __pyx_v_bp_info); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 511, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_4))) {
    __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_4);
    if (likely(__pyx_t_2)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
      __Pyx_INCREF(__pyx_t_2);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_4, function);
    }
  }
  if (!__pyx_t_2) {
    __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 511, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __Pyx_GOTREF(__pyx_t_1);
  } else {
    __pyx_t_6 = PyTuple_New(1+1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 511, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __Pyx_GIVEREF(__pyx_t_2); PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_2); __pyx_t_2 = NULL;
    __Pyx_GIVEREF(__pyx_t_3);
    PyTuple_SET_ITEM(__pyx_t_6, 0+1, __pyx_t_3);
    __pyx_t_3 = 0;
    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_6, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 511, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  }
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_block_len = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":512
 *     bp_info=sorted(sv_info[1:3]+[sv_info[4]])
 *     block_len=bp_to_block_len([sv_info[0]]+bp_info)
 *     ref_bps=[bp_info[0]-flank_length]+bp_info+[bp_info[-1]+flank_length]             # <<<<<<<<<<<<<<
 *     alt_bps=ref_bps[:2]
 *     for let_single in alt_structure:
 */
  if (unlikely(__pyx_v_bp_info == Py_None)) {
    PyErr_SetString(PyExc_TypeError, "'NoneType' object is not subscriptable");
    __PYX_ERR(0, 512, __pyx_L1_error)
  }
  __pyx_t_1 = __Pyx_GetItemInt_List(__pyx_v_bp_info, 0, long, 1, __Pyx_PyInt_From_long, 1, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 512, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_4 = PyNumber_Subtract(__pyx_t_1, __pyx_v_flank_length); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 512, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = PyList_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 512, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_GIVEREF(__pyx_t_4);
  PyList_SET_ITEM(__pyx_t_1, 0, __pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_4 = PyNumber_Add(__pyx_t_1, __pyx_v_bp_info); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 512, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  if (unlikely(__pyx_v_bp_info == Py_None)) {
    PyErr_SetString(PyExc_TypeError, "'NoneType' object is not subscriptable");
    __PYX_ERR(0, 512, __pyx_L1_error)
  }
  __pyx_t_1 = __Pyx_GetItemInt_List(__pyx_v_bp_info, -1L, long, 1, __Pyx_PyInt_From_long, 1, 1, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 512, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_6 = PyNumber_Add(__pyx_t_1, __pyx_v_flank_length); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 512, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = PyList_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 512, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_GIVEREF(__pyx_t_6);
  PyList_SET_ITEM(__pyx_t_1, 0, __pyx_t_6);
  __pyx_t_6 = 0;
  __pyx_t_6 = PyNumber_Add(__pyx_t_4, __pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 512, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_ref_bps = ((PyObject*)__pyx_t_6);
  __pyx_t_6 = 0;

  /* "vapor_vali/Simple_function.pyx":513
 *     block_len=bp_to_block_len([sv_info[0]]+bp_info)
 *     ref_bps=[bp_info[0]-flank_length]+bp_info+[bp_info[-1]+flank_length]
 *     alt_bps=ref_bps[:2]             # <<<<<<<<<<<<<<
 *     for let_single in alt_structure:
 *         alt_bps.append(alt_bps[-1]+block_len[let_single[0]])
 */
  __pyx_t_6 = __Pyx_PyList_GetSlice(__pyx_v_ref_bps, 0, 2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 513, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_v_alt_bps = ((PyObject*)__pyx_t_6);
  __pyx_t_6 = 0;

  /* "vapor_vali/Simple_function.pyx":514
 *     ref_bps=[bp_info[0]-flank_length]+bp_info+[bp_info[-1]+flank_length]
 *     alt_bps=ref_bps[:2]
 *     for let_single in alt_structure:             # <<<<<<<<<<<<<<
 *         alt_bps.append(alt_bps[-1]+block_len[let_single[0]])
 *     alt_bps+=[alt_bps[-1]+flank_length]
 */
  if (likely(PyList_CheckExact(__pyx_v_alt_structure)) || PyTuple_CheckExact(__pyx_v_alt_structure)) {
    __pyx_t_6 = __pyx_v_alt_structure; __Pyx_INCREF(__pyx_t_6); __pyx_t_7 = 0;
    __pyx_t_8 = NULL;
  } else {
    __pyx_t_7 = -1; __pyx_t_6 = PyObject_GetIter(__pyx_v_alt_structure); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 514, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __pyx_t_8 = Py_TYPE(__pyx_t_6)->tp_iternext; if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 514, __pyx_L1_error)
  }
  for (;;) {
    if (likely(!__pyx_t_8)) {
      if (likely(PyList_CheckExact(__pyx_t_6))) {
        if (__pyx_t_7 >= PyList_GET_SIZE(__pyx_t_6)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_1 = PyList_GET_ITEM(__pyx_t_6, __pyx_t_7); __Pyx_INCREF(__pyx_t_1); __pyx_t_7++; if (unlikely(0 < 0)) __PYX_ERR(0, 514, __pyx_L1_error)
        #else
        __pyx_t_1 = PySequence_ITEM(__pyx_t_6, __pyx_t_7); __pyx_t_7++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 514, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        #endif
      } else {
        if (__pyx_t_7 >= PyTuple_GET_SIZE(__pyx_t_6)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_6, __pyx_t_7); __Pyx_INCREF(__pyx_t_1); __pyx_t_7++; if (unlikely(0 < 0)) __PYX_ERR(0, 514, __pyx_L1_error)
        #else
        __pyx_t_1 = PySequence_ITEM(__pyx_t_6, __pyx_t_7); __pyx_t_7++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 514, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        #endif
      }
    } else {
      __pyx_t_1 = __pyx_t_8(__pyx_t_6);
      if (unlikely(!__pyx_t_1)) {
        PyObject* exc_type = PyErr_Occurred();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
          else __PYX_ERR(0, 514, __pyx_L1_error)
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_1);
    }
    __Pyx_XDECREF_SET(__pyx_v_let_single, __pyx_t_1);
    __pyx_t_1 = 0;

    /* "vapor_vali/Simple_function.pyx":515
 *     alt_bps=ref_bps[:2]
 *     for let_single in alt_structure:
 *         alt_bps.append(alt_bps[-1]+block_len[let_single[0]])             # <<<<<<<<<<<<<<
 *     alt_bps+=[alt_bps[-1]+flank_length]
 *     return [ref_bps,alt_bps]
 */
    __pyx_t_1 = __Pyx_GetItemInt_List(__pyx_v_alt_bps, -1L, long, 1, __Pyx_PyInt_From_long, 1, 1, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 515, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_4 = __Pyx_GetItemInt(__pyx_v_let_single, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 515, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_3 = PyObject_GetItem(__pyx_v_block_len, __pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 515, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = PyNumber_Add(__pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 515, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_5 = __Pyx_PyList_Append(__pyx_v_alt_bps, __pyx_t_4); if (unlikely(__pyx_t_5 == -1)) __PYX_ERR(0, 515, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;

    /* "vapor_vali/Simple_function.pyx":514
 *     ref_bps=[bp_info[0]-flank_length]+bp_info+[bp_info[-1]+flank_length]
 *     alt_bps=ref_bps[:2]
 *     for let_single in alt_structure:             # <<<<<<<<<<<<<<
 *         alt_bps.append(alt_bps[-1]+block_len[let_single[0]])
 *     alt_bps+=[alt_bps[-1]+flank_length]
 */
  }
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

  /* "vapor_vali/Simple_function.pyx":516
 *     for let_single in alt_structure:
 *         alt_bps.append(alt_bps[-1]+block_len[let_single[0]])
 *     alt_bps+=[alt_bps[-1]+flank_length]             # <<<<<<<<<<<<<<
 *     return [ref_bps,alt_bps]
 * 
 */
  __pyx_t_6 = __Pyx_GetItemInt_List(__pyx_v_alt_bps, -1L, long, 1, __Pyx_PyInt_From_long, 1, 1, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 516, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_4 = PyNumber_Add(__pyx_t_6, __pyx_v_flank_length); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 516, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = PyList_New(1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 516, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_GIVEREF(__pyx_t_4);
  PyList_SET_ITEM(__pyx_t_6, 0, __pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_4 = PyNumber_InPlaceAdd(__pyx_v_alt_bps, __pyx_t_6); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 516, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __Pyx_DECREF_SET(__pyx_v_alt_bps, ((PyObject*)__pyx_t_4));
  __pyx_t_4 = 0;

  /* "vapor_vali/Simple_function.pyx":517
 *         alt_bps.append(alt_bps[-1]+block_len[let_single[0]])
 *     alt_bps+=[alt_bps[-1]+flank_length]
 *     return [ref_bps,alt_bps]             # <<<<<<<<<<<<<<
 * 
 * def dup_inv_dup_bps_produce(sv_info,flank_length,alt_structure):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_4 = PyList_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 517, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_INCREF(__pyx_v_ref_bps);
  __Pyx_GIVEREF(__pyx_v_ref_bps);
  PyList_SET_ITEM(__pyx_t_4, 0, __pyx_v_ref_bps);
  __Pyx_INCREF(__pyx_v_alt_bps);
  __Pyx_GIVEREF(__pyx_v_alt_bps);
  PyList_SET_ITEM(__pyx_t_4, 1, __pyx_v_alt_bps);
  __pyx_r = __pyx_t_4;
  __pyx_t_4 = 0;
  goto __pyx_L0;

  /* "vapor_vali/Simple_function.pyx":509
 *     return(BIC)
 * 
 * def dup_inv_ref_alt_bps_produce(sv_info,flank_length,alt_structure):             # <<<<<<<<<<<<<<
 *     bp_info=sorted(sv_info[1:3]+[sv_info[4]])
 *     block_len=bp_to_block_len([sv_info[0]]+bp_info)
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_AddTraceback("vapor_vali.Simple_function.dup_inv_ref_alt_bps_produce", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_bp_info);
  __Pyx_XDECREF(__pyx_v_block_len);
  __Pyx_XDECREF(__pyx_v_ref_bps);
  __Pyx_XDECREF(__pyx_v_alt_bps);
  __Pyx_XDECREF(__pyx_v_let_single);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "vapor_vali/Simple_function.pyx":519
 *     return [ref_bps,alt_bps]
 * 
 * def dup_inv_dup_bps_produce(sv_info,flank_length,alt_structure):             # <<<<<<<<<<<<<<
 *     [ref_bps,alt_bps]=dup_inv_ref_alt_bps_produce(sv_info,flank_length,alt_structure)
 *     alt_bps_new=[i-alt_bps[0] for i in alt_bps]
 */

/* Python wrapper */
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_63dup_inv_dup_bps_produce(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_10vapor_vali_15Simple_function_63dup_inv_dup_bps_produce = {"dup_inv_dup_bps_produce", (PyCFunction)__pyx_pw_10vapor_vali_15Simple_function_63dup_inv_dup_bps_produce, METH_VARARGS|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_63dup_inv_dup_bps_produce(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_sv_info = 0;
  PyObject *__pyx_v_flank_length = 0;
  PyObject *__pyx_v_alt_structure = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("dup_inv_dup_bps_produce (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_sv_info,&__pyx_n_s_flank_length,&__pyx_n_s_alt_structure,0};
    PyObject* values[3] = {0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
      switch (pos_args) {
        case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_sv_info)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_flank_length)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("dup_inv_dup_bps_produce", 1, 3, 3, 1); __PYX_ERR(0, 519, __pyx_L3_error)
        }
        case  2:
        if (likely((values[2] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_alt_structure)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("dup_inv_dup_bps_produce", 1, 3, 3, 2); __PYX_ERR(0, 519, __pyx_L3_error)
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "dup_inv_dup_bps_produce") < 0)) __PYX_ERR(0, 519, __pyx_L3_error)
      }
    } else if (PyTuple_GET_SIZE(__pyx_args) != 3) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
    }
    __pyx_v_sv_info = values[0];
    __pyx_v_flank_length = values[1];
    __pyx_v_alt_structure = values[2];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("dup_inv_dup_bps_produce", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 519, __pyx_L3_error)
  __pyx_L3_error:;
  __Pyx_AddTraceback("vapor_vali.Simple_function.dup_inv_dup_bps_produce", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_10vapor_vali_15Simple_function_62dup_inv_dup_bps_produce(__pyx_self, __pyx_v_sv_info, __pyx_v_flank_length, __pyx_v_alt_structure);

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10vapor_vali_15Simple_function_62dup_inv_dup_bps_produce(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_sv_info, PyObject *__pyx_v_flank_length, PyObject *__pyx_v_alt_structure) {
  CYTHON_UNUSED PyObject *__pyx_v_ref_bps = NULL;
  PyObject *__pyx_v_alt_bps = NULL;
  PyObject *__pyx_v_alt_bps_new = NULL;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  Py_ssize_t __pyx_t_4;
  PyObject *__pyx_t_5 = NULL;
  PyObject *(*__pyx_t_6)(PyObject *);
  PyObject *(*__pyx_t_7)(PyObject *);
  int __pyx_t_8;
  __Pyx_RefNannySetupContext("dup_inv_dup_bps_produce", 0);

  /* "vapor_vali/Simple_function.pyx":520
 * 
 * def dup_inv_dup_bps_produce(sv_info,flank_length,alt_structure):
 *     [ref_bps,alt_bps]=dup_inv_ref_alt_bps_produce(sv_info,flank_length,alt_structure)             # <<<<<<<<<<<<<<
 *     alt_bps_new=[i-alt_bps[0] for i in alt_bps]
 *     if len(alt_structure)==2:
 */
  __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_dup_inv_ref_alt_bps_produce); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 520, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = NULL;
  __pyx_t_4 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_3);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_2, function);
      __pyx_t_4 = 1;
    }
  }
  __pyx_t_5 = PyTuple_New(3+__pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 520, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  if (__pyx_t_3) {
    __Pyx_GIVEREF(__pyx_t_3); PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_3); __pyx_t_3 = NULL;
  }
  __Pyx_INCREF(__pyx_v_sv_info);
  __Pyx_GIVEREF(__pyx_v_sv_info);
  PyTuple_SET_ITEM(__pyx_t_5, 0+__pyx_t_4, __pyx_v_sv_info);
  __Pyx_INCREF(__pyx_v_flank_length);
  __Pyx_GIVEREF(__pyx_v_flank_length);
  PyTuple_SET_ITEM(__pyx_t_5, 1+__pyx_t_4, __pyx_v_flank_length);
  __Pyx_INCREF(__pyx_v_alt_structure);
  __Pyx_GIVEREF(__pyx_v_alt_structure);
  PyTuple_SET_ITEM(__pyx_t_5, 2+__pyx_t_4, __pyx_v_alt_structure);
  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_5, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 520, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  if ((likely(PyTuple_CheckExact(__pyx_t_1))) || (PyList_CheckExact(__pyx_t_1))) {
    PyObject* sequence = __pyx_t_1;
    #if CYTHON_COMPILING_IN_CPYTHON
    Py_ssize_t size = Py_SIZE(sequence);
    #else
    Py_ssize_t size = PySequence_Size(sequence);
    #endif
    if (unlikely(size != 2)) {
      if (size > 2) __Pyx_RaiseTooManyValuesError(2);
      else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
      __PYX_ERR(0, 520, __pyx_L1_error)
    }
    #if CYTHON_COMPILING_IN_CPYTHON
    if (likely(PyTuple_CheckExact(sequence))) {
      __pyx_t_2 = PyTuple_GET_ITEM(sequence, 0); 
      __pyx_t_5 = PyTuple_GET_ITEM(sequence, 1); 
    } else {
      __pyx_t_2 = PyList_GET_ITEM(sequence, 0); 
      __pyx_t_5 = PyList_GET_ITEM(sequence, 1); 
    }
    __Pyx_INCREF(__pyx_t_2);
    __Pyx_INCREF(__pyx_t_5);
    #else
    __pyx_t_2 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 520, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_5 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 520, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    #endif
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  } else {
    Py_ssize_t index = -1;
    __pyx_t_3 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 520, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_6 = Py_TYPE(__pyx_t_3)->tp_iternext;
    index = 0; __pyx_t_2 = __pyx_t_6(__pyx_t_3); if (unlikely(!__pyx_t_2)) goto __pyx_L3_unpacking_failed;
    __Pyx_GOTREF(__pyx_t_2);
    index = 1; __pyx_t_5 = __pyx_t_6(__pyx_t_3); if (unlikely(!__pyx_t_5)) goto __pyx_L3_unpacking_failed;
    __Pyx_GOTREF(__pyx_t_5);
    if (__Pyx_IternextUnpackEndCheck(__pyx_t_6(__pyx_t_3), 2) < 0) __PYX_ERR(0, 520, __pyx_L1_error)
    __pyx_t_6 = NULL;
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    goto __pyx_L4_unpacking_done;
    __pyx_L3_unpacking_failed:;
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_6 = NULL;
    if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
    __PYX_ERR(0, 520, __pyx_L1_error)
    __pyx_L4_unpacking_done:;
  }
  __pyx_v_ref_bps = __pyx_t_2;
  __pyx_t_2 = 0;
  __pyx_v_alt_bps = __pyx_t_5;
  __pyx_t_5 = 0;

  /* "vapor_vali/Simple_function.pyx":521
 * def dup_inv_dup_bps_produce(sv_info,flank_length,alt_structure):
 *     [ref_bps,alt_bps]=dup_inv_ref_alt_bps_produce(sv_info,flank_length,alt_structure)
 *     alt_bps_new=[i-alt_bps[0] for i in alt_bps]             # <<<<<<<<<<<<<<
 *     if len(alt_structure)==2:
 *         return [alt_bps_new[1:3],alt_bps_new[2:4]]
 */
  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 521, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  if (likely(PyList_CheckExact(__pyx_v_alt_bps)) || PyTuple_CheckExact(__pyx_v_alt_bps)) {
    __pyx_t_5 = __pyx_v_alt_bps; __Pyx_INCREF(__pyx_t_5); __pyx_t_4 = 0;
    __pyx_t_7 = NULL;
  } else {
    __pyx_t_4 = -1; __pyx_t_5 = PyObject_GetIter(__pyx_v_alt_bps); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 521, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __pyx_t_7 = Py_TYPE(__pyx_t_5)->tp_iternext; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 521, __pyx_L1_error)
  }
  for (;;) {
    if (likely(!__pyx_t_7)) {
      if (likely(PyList_CheckExact(__pyx_t_5))) {
        if (__pyx_t_4 >= PyList_GET_SIZE(__pyx_t_5)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_2 = PyList_GET_ITEM(__pyx_t_5, __pyx_t_4); __Pyx_INCREF(__pyx_t_2); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 521, __pyx_L1_error)
        #else
        __pyx_t_2 = PySequence_ITEM(__pyx_t_5, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 521, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
        #endif
      } else {
        if (__pyx_t_4 >= PyTuple_GET_SIZE(__pyx_t_5)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_2 = PyTuple_GET_ITEM(__pyx_t_5, __pyx_t_4); __Pyx_INCREF(__pyx_t_2); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 521, __pyx_L1_error)
        #else
        __pyx_t_2 = PySequence_ITEM(__pyx_t_5, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 521, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
        #endif
      }
    } else {
      __pyx_t_2 = __pyx_t_7(__pyx_t_5);
      if (unlikely(!__pyx_t_2)) {
        PyObject* exc_type = PyErr_Occurred();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
          else __PYX_ERR(0, 521, __pyx_L1_error)
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_2);
    }
    __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_2);
    __pyx_t_2 = 0;
    __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_alt_bps, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 521, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_3 = PyNumber_Subtract(__pyx_v_i, __pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 521, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    if (unlikely(__Pyx_ListComp_Append(__pyx_t_1, (PyObject*)__pyx_t_3))) __PYX_ERR(0, 521, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  }
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v_alt_bps_new = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":522
 *     [ref_bps,alt_bps]=dup_inv_ref_alt_bps_produce(sv_info,flank_length,alt_structure)
 *     alt_bps_new=[i-alt_bps[0] for i in alt_bps]
 *     if len(alt_structure)==2:             # <<<<<<<<<<<<<<
 *         return [alt_bps_new[1:3],alt_bps_new[2:4]]
 *     else:
 */
  __pyx_t_4 = PyObject_Length(__pyx_v_alt_structure); if (unlikely(__pyx_t_4 == -1)) __PYX_ERR(0, 522, __pyx_L1_error)
  __pyx_t_8 = ((__pyx_t_4 == 2) != 0);
  if (__pyx_t_8) {

    /* "vapor_vali/Simple_function.pyx":523
 *     alt_bps_new=[i-alt_bps[0] for i in alt_bps]
 *     if len(alt_structure)==2:
 *         return [alt_bps_new[1:3],alt_bps_new[2:4]]             # <<<<<<<<<<<<<<
 *     else:
 *         return [alt_bps_new[1:3],alt_bps_new[3:5]]
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = __Pyx_PyList_GetSlice(__pyx_v_alt_bps_new, 1, 3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 523, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_5 = __Pyx_PyList_GetSlice(__pyx_v_alt_bps_new, 2, 4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 523, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __pyx_t_3 = PyList_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 523, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_GIVEREF(__pyx_t_1);
    PyList_SET_ITEM(__pyx_t_3, 0, __pyx_t_1);
    __Pyx_GIVEREF(__pyx_t_5);
    PyList_SET_ITEM(__pyx_t_3, 1, __pyx_t_5);
    __pyx_t_1 = 0;
    __pyx_t_5 = 0;
    __pyx_r = __pyx_t_3;
    __pyx_t_3 = 0;
    goto __pyx_L0;

    /* "vapor_vali/Simple_function.pyx":522
 *     [ref_bps,alt_bps]=dup_inv_ref_alt_bps_produce(sv_info,flank_length,alt_structure)
 *     alt_bps_new=[i-alt_bps[0] for i in alt_bps]
 *     if len(alt_structure)==2:             # <<<<<<<<<<<<<<
 *         return [alt_bps_new[1:3],alt_bps_new[2:4]]
 *     else:
 */
  }

  /* "vapor_vali/Simple_function.pyx":525
 *         return [alt_bps_new[1:3],alt_bps_new[2:4]]
 *     else:
 *         return [alt_bps_new[1:3],alt_bps_new[3:5]]             # <<<<<<<<<<<<<<
 * 
 * def dotdata(kmerlen,seq1, seq2):
 */
  /*else*/ {
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_3 = __Pyx_PyList_GetSlice(__pyx_v_alt_bps_new, 1, 3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 525, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_5 = __Pyx_PyList_GetSlice(__pyx_v_alt_bps_new, 3, 5); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 525, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __pyx_t_1 = PyList_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 525, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_GIVEREF(__pyx_t_3);
    PyList_SET_ITEM(__pyx_t_1, 0, __pyx_t_3);
    __Pyx_GIVEREF(__pyx_t_5);
    PyList_SET_ITEM(__pyx_t_1, 1, __pyx_t_5);
    __pyx_t_3 = 0;
    __pyx_t_5 = 0;
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;
  }

  /* "vapor_vali/Simple_function.pyx":519
 *     return [ref_bps,alt_bps]
 * 
 * def dup_inv_dup_bps_produce(sv_info,flank_length,alt_structure):             # <<<<<<<<<<<<<<
 *     [ref_bps,alt_bps]=dup_inv_ref_alt_bps_produce(sv_info,flank_length,alt_structure)
 *     alt_bps_new=[i-alt_bps[0] for i in alt_bps]
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_AddTraceback("vapor_vali.Simple_function.dup_inv_dup_bps_produce", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_ref_bps);
  __Pyx_XDECREF(__pyx_v_alt_bps);
  __Pyx_XDECREF(__pyx_v_alt_bps_new);
  __Pyx_XDECREF(__pyx_v_i);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "vapor_vali/Simple_function.pyx":527
 *         return [alt_bps_new[1:3],alt_bps_new[3:5]]
 * 
 * def dotdata(kmerlen,seq1, seq2):             # <<<<<<<<<<<<<<
 *     nth_base = 1
 *     inversions = True
 */

/* Python wrapper */
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_65dotdata(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_10vapor_vali_15Simple_function_65dotdata = {"dotdata", (PyCFunction)__pyx_pw_10vapor_vali_15Simple_function_65dotdata, METH_VARARGS|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_65dotdata(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_kmerlen = 0;
  PyObject *__pyx_v_seq1 = 0;
  PyObject *__pyx_v_seq2 = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("dotdata (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_kmerlen,&__pyx_n_s_seq1,&__pyx_n_s_seq2,0};
    PyObject* values[3] = {0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
      switch (pos_args) {
        case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_kmerlen)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_seq1)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("dotdata", 1, 3, 3, 1); __PYX_ERR(0, 527, __pyx_L3_error)
        }
        case  2:
        if (likely((values[2] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_seq2)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("dotdata", 1, 3, 3, 2); __PYX_ERR(0, 527, __pyx_L3_error)
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "dotdata") < 0)) __PYX_ERR(0, 527, __pyx_L3_error)
      }
    } else if (PyTuple_GET_SIZE(__pyx_args) != 3) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
    }
    __pyx_v_kmerlen = values[0];
    __pyx_v_seq1 = values[1];
    __pyx_v_seq2 = values[2];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("dotdata", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 527, __pyx_L3_error)
  __pyx_L3_error:;
  __Pyx_AddTraceback("vapor_vali.Simple_function.dotdata", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_10vapor_vali_15Simple_function_64dotdata(__pyx_self, __pyx_v_kmerlen, __pyx_v_seq1, __pyx_v_seq2);

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10vapor_vali_15Simple_function_64dotdata(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_kmerlen, PyObject *__pyx_v_seq1, PyObject *__pyx_v_seq2) {
  long __pyx_v_nth_base;
  int __pyx_v_inversions;
  PyObject *__pyx_v_hits = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  Py_ssize_t __pyx_t_6;
  PyObject *__pyx_t_7 = NULL;
  __Pyx_RefNannySetupContext("dotdata", 0);

  /* "vapor_vali/Simple_function.pyx":528
 * 
 * def dotdata(kmerlen,seq1, seq2):
 *     nth_base = 1             # <<<<<<<<<<<<<<
 *     inversions = True
 *     hits = kmerhits(seq1, seq2, kmerlen, nth_base, inversions)
 */
  __pyx_v_nth_base = 1;

  /* "vapor_vali/Simple_function.pyx":529
 * def dotdata(kmerlen,seq1, seq2):
 *     nth_base = 1
 *     inversions = True             # <<<<<<<<<<<<<<
 *     hits = kmerhits(seq1, seq2, kmerlen, nth_base, inversions)
 *     return hits
 */
  __pyx_v_inversions = 1;

  /* "vapor_vali/Simple_function.pyx":530
 *     nth_base = 1
 *     inversions = True
 *     hits = kmerhits(seq1, seq2, kmerlen, nth_base, inversions)             # <<<<<<<<<<<<<<
 *     return hits
 * 
 */
  __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_kmerhits); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 530, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = __Pyx_PyInt_From_long(__pyx_v_nth_base); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 530, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_4 = __Pyx_PyBool_FromLong(__pyx_v_inversions); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 530, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_5 = NULL;
  __pyx_t_6 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_2);
    if (likely(__pyx_t_5)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_5);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_2, function);
      __pyx_t_6 = 1;
    }
  }
  __pyx_t_7 = PyTuple_New(5+__pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 530, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  if (__pyx_t_5) {
    __Pyx_GIVEREF(__pyx_t_5); PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_5); __pyx_t_5 = NULL;
  }
  __Pyx_INCREF(__pyx_v_seq1);
  __Pyx_GIVEREF(__pyx_v_seq1);
  PyTuple_SET_ITEM(__pyx_t_7, 0+__pyx_t_6, __pyx_v_seq1);
  __Pyx_INCREF(__pyx_v_seq2);
  __Pyx_GIVEREF(__pyx_v_seq2);
  PyTuple_SET_ITEM(__pyx_t_7, 1+__pyx_t_6, __pyx_v_seq2);
  __Pyx_INCREF(__pyx_v_kmerlen);
  __Pyx_GIVEREF(__pyx_v_kmerlen);
  PyTuple_SET_ITEM(__pyx_t_7, 2+__pyx_t_6, __pyx_v_kmerlen);
  __Pyx_GIVEREF(__pyx_t_3);
  PyTuple_SET_ITEM(__pyx_t_7, 3+__pyx_t_6, __pyx_t_3);
  __Pyx_GIVEREF(__pyx_t_4);
  PyTuple_SET_ITEM(__pyx_t_7, 4+__pyx_t_6, __pyx_t_4);
  __pyx_t_3 = 0;
  __pyx_t_4 = 0;
  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_7, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 530, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_hits = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":531
 *     inversions = True
 *     hits = kmerhits(seq1, seq2, kmerlen, nth_base, inversions)
 *     return hits             # <<<<<<<<<<<<<<
 * 
 * def dis_cluster(dis_to_diagnal,dis_cff=10):
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_hits);
  __pyx_r = __pyx_v_hits;
  goto __pyx_L0;

  /* "vapor_vali/Simple_function.pyx":527
 *         return [alt_bps_new[1:3],alt_bps_new[3:5]]
 * 
 * def dotdata(kmerlen,seq1, seq2):             # <<<<<<<<<<<<<<
 *     nth_base = 1
 *     inversions = True
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_7);
  __Pyx_AddTraceback("vapor_vali.Simple_function.dotdata", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_hits);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "vapor_vali/Simple_function.pyx":533
 *     return hits
 * 
 * def dis_cluster(dis_to_diagnal,dis_cff=10):             # <<<<<<<<<<<<<<
 *     #eg of dis_list=[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 683, 854, 0, 683, 854, 0, 683, 854, 0, 683, 854, 0, 683, 0, 683, 0, 683, 0, 683, 0, 341, 512, 683, 0, 341, 512, 683, 0, 341, 512, 683, 0, 341, 512, 683, 1025, 0, 341, 512, 683, 1025, 0, 170, 341, 512, 683, 1025, 0, 170, 341, 683, 854, 1025, 0, 170, 683, 854, 1025, 0, 683, 1025, 0, 0, 0, 0, 0, 0, 0, 0, 512, 0, 512, 0, 512, 1196, 0, 170, 341, 512, 854, 1196, 1367, 0, 170, 341, 512, 854, 1196, 1367, 0]
 *     sorted_list=sorted(dis_to_diagnal)
 */

/* Python wrapper */
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_67dis_cluster(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_10vapor_vali_15Simple_function_67dis_cluster = {"dis_cluster", (PyCFunction)__pyx_pw_10vapor_vali_15Simple_function_67dis_cluster, METH_VARARGS|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_67dis_cluster(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_dis_to_diagnal = 0;
  PyObject *__pyx_v_dis_cff = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("dis_cluster (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_dis_to_diagnal,&__pyx_n_s_dis_cff,0};
    PyObject* values[2] = {0,0};
    values[1] = ((PyObject *)__pyx_int_10);
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_dis_to_diagnal)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (kw_args > 0) {
          PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_dis_cff);
          if (value) { values[1] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "dis_cluster") < 0)) __PYX_ERR(0, 533, __pyx_L3_error)
      }
    } else {
      switch (PyTuple_GET_SIZE(__pyx_args)) {
        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_dis_to_diagnal = values[0];
    __pyx_v_dis_cff = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("dis_cluster", 0, 1, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 533, __pyx_L3_error)
  __pyx_L3_error:;
  __Pyx_AddTraceback("vapor_vali.Simple_function.dis_cluster", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_10vapor_vali_15Simple_function_66dis_cluster(__pyx_self, __pyx_v_dis_to_diagnal, __pyx_v_dis_cff);

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10vapor_vali_15Simple_function_66dis_cluster(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_dis_to_diagnal, PyObject *__pyx_v_dis_cff) {
  PyObject *__pyx_v_sorted_list = NULL;
  PyObject *__pyx_v_sub_group1 = NULL;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_v_remove_noise_1 = NULL;
  PyObject *__pyx_v_lenght_list = NULL;
  PyObject *__pyx_v_j = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  int __pyx_t_3;
  Py_ssize_t __pyx_t_4;
  PyObject *__pyx_t_5 = NULL;
  int __pyx_t_6;
  Py_ssize_t __pyx_t_7;
  PyObject *__pyx_t_8 = NULL;
  PyObject *__pyx_t_9 = NULL;
  PyObject *(*__pyx_t_10)(PyObject *);
  int __pyx_t_11;
  __Pyx_RefNannySetupContext("dis_cluster", 0);

  /* "vapor_vali/Simple_function.pyx":535
 * def dis_cluster(dis_to_diagnal,dis_cff=10):
 *     #eg of dis_list=[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 683, 854, 0, 683, 854, 0, 683, 854, 0, 683, 854, 0, 683, 0, 683, 0, 683, 0, 683, 0, 341, 512, 683, 0, 341, 512, 683, 0, 341, 512, 683, 0, 341, 512, 683, 1025, 0, 341, 512, 683, 1025, 0, 170, 341, 512, 683, 1025, 0, 170, 341, 683, 854, 1025, 0, 170, 683, 854, 1025, 0, 683, 1025, 0, 0, 0, 0, 0, 0, 0, 0, 512, 0, 512, 0, 512, 1196, 0, 170, 341, 512, 854, 1196, 1367, 0, 170, 341, 512, 854, 1196, 1367, 0]
 *     sorted_list=sorted(dis_to_diagnal)             # <<<<<<<<<<<<<<
 *     sub_group1=[[sorted_list[0]]]
 *     for i in sorted_list[1:]:
 */
  __pyx_t_2 = PySequence_List(__pyx_v_dis_to_diagnal); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 535, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_1 = ((PyObject*)__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_3 = PyList_Sort(__pyx_t_1); if (unlikely(__pyx_t_3 == -1)) __PYX_ERR(0, 535, __pyx_L1_error)
  __pyx_v_sorted_list = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":536
 *     #eg of dis_list=[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 683, 854, 0, 683, 854, 0, 683, 854, 0, 683, 854, 0, 683, 0, 683, 0, 683, 0, 683, 0, 341, 512, 683, 0, 341, 512, 683, 0, 341, 512, 683, 0, 341, 512, 683, 1025, 0, 341, 512, 683, 1025, 0, 170, 341, 512, 683, 1025, 0, 170, 341, 683, 854, 1025, 0, 170, 683, 854, 1025, 0, 683, 1025, 0, 0, 0, 0, 0, 0, 0, 0, 512, 0, 512, 0, 512, 1196, 0, 170, 341, 512, 854, 1196, 1367, 0, 170, 341, 512, 854, 1196, 1367, 0]
 *     sorted_list=sorted(dis_to_diagnal)
 *     sub_group1=[[sorted_list[0]]]             # <<<<<<<<<<<<<<
 *     for i in sorted_list[1:]:
 *         if i-sub_group1[-1][-1]<dis_cff:
 */
  if (unlikely(__pyx_v_sorted_list == Py_None)) {
    PyErr_SetString(PyExc_TypeError, "'NoneType' object is not subscriptable");
    __PYX_ERR(0, 536, __pyx_L1_error)
  }
  __pyx_t_1 = __Pyx_GetItemInt_List(__pyx_v_sorted_list, 0, long, 1, __Pyx_PyInt_From_long, 1, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 536, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = PyList_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 536, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_GIVEREF(__pyx_t_1);
  PyList_SET_ITEM(__pyx_t_2, 0, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = PyList_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 536, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_GIVEREF(__pyx_t_2);
  PyList_SET_ITEM(__pyx_t_1, 0, __pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_v_sub_group1 = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":537
 *     sorted_list=sorted(dis_to_diagnal)
 *     sub_group1=[[sorted_list[0]]]
 *     for i in sorted_list[1:]:             # <<<<<<<<<<<<<<
 *         if i-sub_group1[-1][-1]<dis_cff:
 *             sub_group1[-1].append(i)
 */
  if (unlikely(__pyx_v_sorted_list == Py_None)) {
    PyErr_SetString(PyExc_TypeError, "'NoneType' object is not subscriptable");
    __PYX_ERR(0, 537, __pyx_L1_error)
  }
  __pyx_t_1 = __Pyx_PyList_GetSlice(__pyx_v_sorted_list, 1, PY_SSIZE_T_MAX); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 537, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __pyx_t_1; __Pyx_INCREF(__pyx_t_2); __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  for (;;) {
    if (__pyx_t_4 >= PyList_GET_SIZE(__pyx_t_2)) break;
    #if CYTHON_COMPILING_IN_CPYTHON
    __pyx_t_1 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_4); __Pyx_INCREF(__pyx_t_1); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 537, __pyx_L1_error)
    #else
    __pyx_t_1 = PySequence_ITEM(__pyx_t_2, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 537, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    #endif
    __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_1);
    __pyx_t_1 = 0;

    /* "vapor_vali/Simple_function.pyx":538
 *     sub_group1=[[sorted_list[0]]]
 *     for i in sorted_list[1:]:
 *         if i-sub_group1[-1][-1]<dis_cff:             # <<<<<<<<<<<<<<
 *             sub_group1[-1].append(i)
 *         else:
 */
    __pyx_t_1 = __Pyx_GetItemInt_List(__pyx_v_sub_group1, -1L, long, 1, __Pyx_PyInt_From_long, 1, 1, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 538, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_5 = __Pyx_GetItemInt(__pyx_t_1, -1L, long, 1, __Pyx_PyInt_From_long, 0, 1, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 538, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = PyNumber_Subtract(__pyx_v_i, __pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 538, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = PyObject_RichCompare(__pyx_t_1, __pyx_v_dis_cff, Py_LT); __Pyx_XGOTREF(__pyx_t_5); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 538, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 538, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    if (__pyx_t_6) {

      /* "vapor_vali/Simple_function.pyx":539
 *     for i in sorted_list[1:]:
 *         if i-sub_group1[-1][-1]<dis_cff:
 *             sub_group1[-1].append(i)             # <<<<<<<<<<<<<<
 *         else:
 *             sub_group1.append([i])
 */
      __pyx_t_5 = __Pyx_GetItemInt_List(__pyx_v_sub_group1, -1L, long, 1, __Pyx_PyInt_From_long, 1, 1, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 539, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_5);
      __pyx_t_3 = __Pyx_PyObject_Append(__pyx_t_5, __pyx_v_i); if (unlikely(__pyx_t_3 == -1)) __PYX_ERR(0, 539, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;

      /* "vapor_vali/Simple_function.pyx":538
 *     sub_group1=[[sorted_list[0]]]
 *     for i in sorted_list[1:]:
 *         if i-sub_group1[-1][-1]<dis_cff:             # <<<<<<<<<<<<<<
 *             sub_group1[-1].append(i)
 *         else:
 */
      goto __pyx_L5;
    }

    /* "vapor_vali/Simple_function.pyx":541
 *             sub_group1[-1].append(i)
 *         else:
 *             sub_group1.append([i])             # <<<<<<<<<<<<<<
 *     remove_noise_1=[i for i in sub_group1 if len(i)>50]
 *     if remove_noise_1==[]:
 */
    /*else*/ {
      __pyx_t_5 = PyList_New(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 541, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_5);
      __Pyx_INCREF(__pyx_v_i);
      __Pyx_GIVEREF(__pyx_v_i);
      PyList_SET_ITEM(__pyx_t_5, 0, __pyx_v_i);
      __pyx_t_3 = __Pyx_PyList_Append(__pyx_v_sub_group1, __pyx_t_5); if (unlikely(__pyx_t_3 == -1)) __PYX_ERR(0, 541, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    }
    __pyx_L5:;

    /* "vapor_vali/Simple_function.pyx":537
 *     sorted_list=sorted(dis_to_diagnal)
 *     sub_group1=[[sorted_list[0]]]
 *     for i in sorted_list[1:]:             # <<<<<<<<<<<<<<
 *         if i-sub_group1[-1][-1]<dis_cff:
 *             sub_group1[-1].append(i)
 */
  }
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":542
 *         else:
 *             sub_group1.append([i])
 *     remove_noise_1=[i for i in sub_group1 if len(i)>50]             # <<<<<<<<<<<<<<
 *     if remove_noise_1==[]:
 *         lenght_list=[len(i) for i in sub_group1]
 */
  __pyx_t_2 = PyList_New(0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 542, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_5 = __pyx_v_sub_group1; __Pyx_INCREF(__pyx_t_5); __pyx_t_4 = 0;
  for (;;) {
    if (__pyx_t_4 >= PyList_GET_SIZE(__pyx_t_5)) break;
    #if CYTHON_COMPILING_IN_CPYTHON
    __pyx_t_1 = PyList_GET_ITEM(__pyx_t_5, __pyx_t_4); __Pyx_INCREF(__pyx_t_1); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 542, __pyx_L1_error)
    #else
    __pyx_t_1 = PySequence_ITEM(__pyx_t_5, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 542, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    #endif
    __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_1);
    __pyx_t_1 = 0;
    __pyx_t_7 = PyObject_Length(__pyx_v_i); if (unlikely(__pyx_t_7 == -1)) __PYX_ERR(0, 542, __pyx_L1_error)
    __pyx_t_6 = ((__pyx_t_7 > 50) != 0);
    if (__pyx_t_6) {
      if (unlikely(__Pyx_ListComp_Append(__pyx_t_2, (PyObject*)__pyx_v_i))) __PYX_ERR(0, 542, __pyx_L1_error)
    }
  }
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v_remove_noise_1 = ((PyObject*)__pyx_t_2);
  __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":543
 *             sub_group1.append([i])
 *     remove_noise_1=[i for i in sub_group1 if len(i)>50]
 *     if remove_noise_1==[]:             # <<<<<<<<<<<<<<
 *         lenght_list=[len(i) for i in sub_group1]
 *         remove_noise_1=[i for i in sub_group1 if len(i)==max(lenght_list)]
 */
  __pyx_t_2 = PyList_New(0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 543, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_5 = PyObject_RichCompare(__pyx_v_remove_noise_1, __pyx_t_2, Py_EQ); __Pyx_XGOTREF(__pyx_t_5); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 543, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 543, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  if (__pyx_t_6) {

    /* "vapor_vali/Simple_function.pyx":544
 *     remove_noise_1=[i for i in sub_group1 if len(i)>50]
 *     if remove_noise_1==[]:
 *         lenght_list=[len(i) for i in sub_group1]             # <<<<<<<<<<<<<<
 *         remove_noise_1=[i for i in sub_group1 if len(i)==max(lenght_list)]
 *     return [[i for i in range(len(dis_to_diagnal)) if dis_to_diagnal[i] in j] for j in remove_noise_1]
 */
    __pyx_t_5 = PyList_New(0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 544, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __pyx_t_2 = __pyx_v_sub_group1; __Pyx_INCREF(__pyx_t_2); __pyx_t_4 = 0;
    for (;;) {
      if (__pyx_t_4 >= PyList_GET_SIZE(__pyx_t_2)) break;
      #if CYTHON_COMPILING_IN_CPYTHON
      __pyx_t_1 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_4); __Pyx_INCREF(__pyx_t_1); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 544, __pyx_L1_error)
      #else
      __pyx_t_1 = PySequence_ITEM(__pyx_t_2, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 544, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      #endif
      __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_1);
      __pyx_t_1 = 0;
      __pyx_t_7 = PyObject_Length(__pyx_v_i); if (unlikely(__pyx_t_7 == -1)) __PYX_ERR(0, 544, __pyx_L1_error)
      __pyx_t_1 = PyInt_FromSsize_t(__pyx_t_7); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 544, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      if (unlikely(__Pyx_ListComp_Append(__pyx_t_5, (PyObject*)__pyx_t_1))) __PYX_ERR(0, 544, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    }
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_v_lenght_list = ((PyObject*)__pyx_t_5);
    __pyx_t_5 = 0;

    /* "vapor_vali/Simple_function.pyx":545
 *     if remove_noise_1==[]:
 *         lenght_list=[len(i) for i in sub_group1]
 *         remove_noise_1=[i for i in sub_group1 if len(i)==max(lenght_list)]             # <<<<<<<<<<<<<<
 *     return [[i for i in range(len(dis_to_diagnal)) if dis_to_diagnal[i] in j] for j in remove_noise_1]
 * 
 */
    __pyx_t_5 = PyList_New(0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 545, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __pyx_t_2 = __pyx_v_sub_group1; __Pyx_INCREF(__pyx_t_2); __pyx_t_4 = 0;
    for (;;) {
      if (__pyx_t_4 >= PyList_GET_SIZE(__pyx_t_2)) break;
      #if CYTHON_COMPILING_IN_CPYTHON
      __pyx_t_1 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_4); __Pyx_INCREF(__pyx_t_1); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 545, __pyx_L1_error)
      #else
      __pyx_t_1 = PySequence_ITEM(__pyx_t_2, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 545, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      #endif
      __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_1);
      __pyx_t_1 = 0;
      __pyx_t_7 = PyObject_Length(__pyx_v_i); if (unlikely(__pyx_t_7 == -1)) __PYX_ERR(0, 545, __pyx_L1_error)
      __pyx_t_1 = PyInt_FromSsize_t(__pyx_t_7); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 545, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __pyx_t_8 = PyTuple_New(1); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 545, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_8);
      __Pyx_INCREF(__pyx_v_lenght_list);
      __Pyx_GIVEREF(__pyx_v_lenght_list);
      PyTuple_SET_ITEM(__pyx_t_8, 0, __pyx_v_lenght_list);
      __pyx_t_9 = __Pyx_PyObject_Call(__pyx_builtin_max, __pyx_t_8, NULL); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 545, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_9);
      __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
      __pyx_t_8 = PyObject_RichCompare(__pyx_t_1, __pyx_t_9, Py_EQ); __Pyx_XGOTREF(__pyx_t_8); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 545, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
      __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_8); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 545, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
      if (__pyx_t_6) {
        if (unlikely(__Pyx_ListComp_Append(__pyx_t_5, (PyObject*)__pyx_v_i))) __PYX_ERR(0, 545, __pyx_L1_error)
      }
    }
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __Pyx_DECREF_SET(__pyx_v_remove_noise_1, ((PyObject*)__pyx_t_5));
    __pyx_t_5 = 0;

    /* "vapor_vali/Simple_function.pyx":543
 *             sub_group1.append([i])
 *     remove_noise_1=[i for i in sub_group1 if len(i)>50]
 *     if remove_noise_1==[]:             # <<<<<<<<<<<<<<
 *         lenght_list=[len(i) for i in sub_group1]
 *         remove_noise_1=[i for i in sub_group1 if len(i)==max(lenght_list)]
 */
  }

  /* "vapor_vali/Simple_function.pyx":546
 *         lenght_list=[len(i) for i in sub_group1]
 *         remove_noise_1=[i for i in sub_group1 if len(i)==max(lenght_list)]
 *     return [[i for i in range(len(dis_to_diagnal)) if dis_to_diagnal[i] in j] for j in remove_noise_1]             # <<<<<<<<<<<<<<
 * 
 * def dis_cluster_2(dis_to_diagnal,dis_cff=10):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_5 = PyList_New(0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 546, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_2 = __pyx_v_remove_noise_1; __Pyx_INCREF(__pyx_t_2); __pyx_t_4 = 0;
  for (;;) {
    if (__pyx_t_4 >= PyList_GET_SIZE(__pyx_t_2)) break;
    #if CYTHON_COMPILING_IN_CPYTHON
    __pyx_t_8 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_4); __Pyx_INCREF(__pyx_t_8); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 546, __pyx_L1_error)
    #else
    __pyx_t_8 = PySequence_ITEM(__pyx_t_2, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 546, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_8);
    #endif
    __Pyx_XDECREF_SET(__pyx_v_j, __pyx_t_8);
    __pyx_t_8 = 0;
    __pyx_t_8 = PyList_New(0); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 546, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_8);
    __pyx_t_7 = PyObject_Length(__pyx_v_dis_to_diagnal); if (unlikely(__pyx_t_7 == -1)) __PYX_ERR(0, 546, __pyx_L1_error)
    __pyx_t_9 = PyInt_FromSsize_t(__pyx_t_7); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 546, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_9);
    __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 546, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_GIVEREF(__pyx_t_9);
    PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_9);
    __pyx_t_9 = 0;
    __pyx_t_9 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_t_1, NULL); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 546, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_9);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    if (likely(PyList_CheckExact(__pyx_t_9)) || PyTuple_CheckExact(__pyx_t_9)) {
      __pyx_t_1 = __pyx_t_9; __Pyx_INCREF(__pyx_t_1); __pyx_t_7 = 0;
      __pyx_t_10 = NULL;
    } else {
      __pyx_t_7 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_t_9); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 546, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __pyx_t_10 = Py_TYPE(__pyx_t_1)->tp_iternext; if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 546, __pyx_L1_error)
    }
    __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
    for (;;) {
      if (likely(!__pyx_t_10)) {
        if (likely(PyList_CheckExact(__pyx_t_1))) {
          if (__pyx_t_7 >= PyList_GET_SIZE(__pyx_t_1)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_9 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_7); __Pyx_INCREF(__pyx_t_9); __pyx_t_7++; if (unlikely(0 < 0)) __PYX_ERR(0, 546, __pyx_L1_error)
          #else
          __pyx_t_9 = PySequence_ITEM(__pyx_t_1, __pyx_t_7); __pyx_t_7++; if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 546, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_9);
          #endif
        } else {
          if (__pyx_t_7 >= PyTuple_GET_SIZE(__pyx_t_1)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_9 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_7); __Pyx_INCREF(__pyx_t_9); __pyx_t_7++; if (unlikely(0 < 0)) __PYX_ERR(0, 546, __pyx_L1_error)
          #else
          __pyx_t_9 = PySequence_ITEM(__pyx_t_1, __pyx_t_7); __pyx_t_7++; if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 546, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_9);
          #endif
        }
      } else {
        __pyx_t_9 = __pyx_t_10(__pyx_t_1);
        if (unlikely(!__pyx_t_9)) {
          PyObject* exc_type = PyErr_Occurred();
          if (exc_type) {
            if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
            else __PYX_ERR(0, 546, __pyx_L1_error)
          }
          break;
        }
        __Pyx_GOTREF(__pyx_t_9);
      }
      __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_9);
      __pyx_t_9 = 0;
      __pyx_t_9 = PyObject_GetItem(__pyx_v_dis_to_diagnal, __pyx_v_i); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 546, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_9);
      __pyx_t_6 = (__Pyx_PySequence_ContainsTF(__pyx_t_9, __pyx_v_j, Py_EQ)); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 546, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
      __pyx_t_11 = (__pyx_t_6 != 0);
      if (__pyx_t_11) {
        if (unlikely(__Pyx_ListComp_Append(__pyx_t_8, (PyObject*)__pyx_v_i))) __PYX_ERR(0, 546, __pyx_L1_error)
      }
    }
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    if (unlikely(__Pyx_ListComp_Append(__pyx_t_5, (PyObject*)__pyx_t_8))) __PYX_ERR(0, 546, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
  }
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_r = __pyx_t_5;
  __pyx_t_5 = 0;
  goto __pyx_L0;

  /* "vapor_vali/Simple_function.pyx":533
 *     return hits
 * 
 * def dis_cluster(dis_to_diagnal,dis_cff=10):             # <<<<<<<<<<<<<<
 *     #eg of dis_list=[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 683, 854, 0, 683, 854, 0, 683, 854, 0, 683, 854, 0, 683, 0, 683, 0, 683, 0, 683, 0, 341, 512, 683, 0, 341, 512, 683, 0, 341, 512, 683, 0, 341, 512, 683, 1025, 0, 341, 512, 683, 1025, 0, 170, 341, 512, 683, 1025, 0, 170, 341, 683, 854, 1025, 0, 170, 683, 854, 1025, 0, 683, 1025, 0, 0, 0, 0, 0, 0, 0, 0, 512, 0, 512, 0, 512, 1196, 0, 170, 341, 512, 854, 1196, 1367, 0, 170, 341, 512, 854, 1196, 1367, 0]
 *     sorted_list=sorted(dis_to_diagnal)
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_8);
  __Pyx_XDECREF(__pyx_t_9);
  __Pyx_AddTraceback("vapor_vali.Simple_function.dis_cluster", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_sorted_list);
  __Pyx_XDECREF(__pyx_v_sub_group1);
  __Pyx_XDECREF(__pyx_v_i);
  __Pyx_XDECREF(__pyx_v_remove_noise_1);
  __Pyx_XDECREF(__pyx_v_lenght_list);
  __Pyx_XDECREF(__pyx_v_j);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "vapor_vali/Simple_function.pyx":548
 *     return [[i for i in range(len(dis_to_diagnal)) if dis_to_diagnal[i] in j] for j in remove_noise_1]
 * 
 * def dis_cluster_2(dis_to_diagnal,dis_cff=10):             # <<<<<<<<<<<<<<
 *     #eg of dis_list=[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 683, 854, 0, 683, 854, 0, 683, 854, 0, 683, 854, 0, 683, 0, 683, 0, 683, 0, 683, 0, 341, 512, 683, 0, 341, 512, 683, 0, 341, 512, 683, 0, 341, 512, 683, 1025, 0, 341, 512, 683, 1025, 0, 170, 341, 512, 683, 1025, 0, 170, 341, 683, 854, 1025, 0, 170, 683, 854, 1025, 0, 683, 1025, 0, 0, 0, 0, 0, 0, 0, 0, 512, 0, 512, 0, 512, 1196, 0, 170, 341, 512, 854, 1196, 1367, 0, 170, 341, 512, 854, 1196, 1367, 0]
 *     sorted_list=sorted(dis_to_diagnal)
 */

/* Python wrapper */
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_69dis_cluster_2(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_10vapor_vali_15Simple_function_69dis_cluster_2 = {"dis_cluster_2", (PyCFunction)__pyx_pw_10vapor_vali_15Simple_function_69dis_cluster_2, METH_VARARGS|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_69dis_cluster_2(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_dis_to_diagnal = 0;
  PyObject *__pyx_v_dis_cff = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("dis_cluster_2 (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_dis_to_diagnal,&__pyx_n_s_dis_cff,0};
    PyObject* values[2] = {0,0};
    values[1] = ((PyObject *)__pyx_int_10);
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_dis_to_diagnal)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (kw_args > 0) {
          PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_dis_cff);
          if (value) { values[1] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "dis_cluster_2") < 0)) __PYX_ERR(0, 548, __pyx_L3_error)
      }
    } else {
      switch (PyTuple_GET_SIZE(__pyx_args)) {
        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_dis_to_diagnal = values[0];
    __pyx_v_dis_cff = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("dis_cluster_2", 0, 1, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 548, __pyx_L3_error)
  __pyx_L3_error:;
  __Pyx_AddTraceback("vapor_vali.Simple_function.dis_cluster_2", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_10vapor_vali_15Simple_function_68dis_cluster_2(__pyx_self, __pyx_v_dis_to_diagnal, __pyx_v_dis_cff);

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10vapor_vali_15Simple_function_68dis_cluster_2(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_dis_to_diagnal, PyObject *__pyx_v_dis_cff) {
  PyObject *__pyx_v_sorted_list = NULL;
  PyObject *__pyx_v_sub_group1 = NULL;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_v_remove_noise_1 = NULL;
  PyObject *__pyx_v_out1 = NULL;
  PyObject *__pyx_v_out_total = NULL;
  PyObject *__pyx_v_out2 = NULL;
  PyObject *__pyx_v_j = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  int __pyx_t_3;
  Py_ssize_t __pyx_t_4;
  PyObject *__pyx_t_5 = NULL;
  int __pyx_t_6;
  Py_ssize_t __pyx_t_7;
  PyObject *__pyx_t_8 = NULL;
  PyObject *__pyx_t_9 = NULL;
  PyObject *(*__pyx_t_10)(PyObject *);
  int __pyx_t_11;
  __Pyx_RefNannySetupContext("dis_cluster_2", 0);

  /* "vapor_vali/Simple_function.pyx":550
 * def dis_cluster_2(dis_to_diagnal,dis_cff=10):
 *     #eg of dis_list=[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 683, 854, 0, 683, 854, 0, 683, 854, 0, 683, 854, 0, 683, 0, 683, 0, 683, 0, 683, 0, 341, 512, 683, 0, 341, 512, 683, 0, 341, 512, 683, 0, 341, 512, 683, 1025, 0, 341, 512, 683, 1025, 0, 170, 341, 512, 683, 1025, 0, 170, 341, 683, 854, 1025, 0, 170, 683, 854, 1025, 0, 683, 1025, 0, 0, 0, 0, 0, 0, 0, 0, 512, 0, 512, 0, 512, 1196, 0, 170, 341, 512, 854, 1196, 1367, 0, 170, 341, 512, 854, 1196, 1367, 0]
 *     sorted_list=sorted(dis_to_diagnal)             # <<<<<<<<<<<<<<
 *     sub_group1=[[sorted_list[0]]]
 *     for i in sorted_list[1:]:
 */
  __pyx_t_2 = PySequence_List(__pyx_v_dis_to_diagnal); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 550, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_1 = ((PyObject*)__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_3 = PyList_Sort(__pyx_t_1); if (unlikely(__pyx_t_3 == -1)) __PYX_ERR(0, 550, __pyx_L1_error)
  __pyx_v_sorted_list = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":551
 *     #eg of dis_list=[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 683, 854, 0, 683, 854, 0, 683, 854, 0, 683, 854, 0, 683, 0, 683, 0, 683, 0, 683, 0, 341, 512, 683, 0, 341, 512, 683, 0, 341, 512, 683, 0, 341, 512, 683, 1025, 0, 341, 512, 683, 1025, 0, 170, 341, 512, 683, 1025, 0, 170, 341, 683, 854, 1025, 0, 170, 683, 854, 1025, 0, 683, 1025, 0, 0, 0, 0, 0, 0, 0, 0, 512, 0, 512, 0, 512, 1196, 0, 170, 341, 512, 854, 1196, 1367, 0, 170, 341, 512, 854, 1196, 1367, 0]
 *     sorted_list=sorted(dis_to_diagnal)
 *     sub_group1=[[sorted_list[0]]]             # <<<<<<<<<<<<<<
 *     for i in sorted_list[1:]:
 *         if i-sub_group1[-1][-1]<dis_cff:
 */
  if (unlikely(__pyx_v_sorted_list == Py_None)) {
    PyErr_SetString(PyExc_TypeError, "'NoneType' object is not subscriptable");
    __PYX_ERR(0, 551, __pyx_L1_error)
  }
  __pyx_t_1 = __Pyx_GetItemInt_List(__pyx_v_sorted_list, 0, long, 1, __Pyx_PyInt_From_long, 1, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 551, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = PyList_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 551, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_GIVEREF(__pyx_t_1);
  PyList_SET_ITEM(__pyx_t_2, 0, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = PyList_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 551, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_GIVEREF(__pyx_t_2);
  PyList_SET_ITEM(__pyx_t_1, 0, __pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_v_sub_group1 = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":552
 *     sorted_list=sorted(dis_to_diagnal)
 *     sub_group1=[[sorted_list[0]]]
 *     for i in sorted_list[1:]:             # <<<<<<<<<<<<<<
 *         if i-sub_group1[-1][-1]<dis_cff:
 *             sub_group1[-1].append(i)
 */
  if (unlikely(__pyx_v_sorted_list == Py_None)) {
    PyErr_SetString(PyExc_TypeError, "'NoneType' object is not subscriptable");
    __PYX_ERR(0, 552, __pyx_L1_error)
  }
  __pyx_t_1 = __Pyx_PyList_GetSlice(__pyx_v_sorted_list, 1, PY_SSIZE_T_MAX); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 552, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __pyx_t_1; __Pyx_INCREF(__pyx_t_2); __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  for (;;) {
    if (__pyx_t_4 >= PyList_GET_SIZE(__pyx_t_2)) break;
    #if CYTHON_COMPILING_IN_CPYTHON
    __pyx_t_1 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_4); __Pyx_INCREF(__pyx_t_1); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 552, __pyx_L1_error)
    #else
    __pyx_t_1 = PySequence_ITEM(__pyx_t_2, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 552, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    #endif
    __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_1);
    __pyx_t_1 = 0;

    /* "vapor_vali/Simple_function.pyx":553
 *     sub_group1=[[sorted_list[0]]]
 *     for i in sorted_list[1:]:
 *         if i-sub_group1[-1][-1]<dis_cff:             # <<<<<<<<<<<<<<
 *             sub_group1[-1].append(i)
 *         else:
 */
    __pyx_t_1 = __Pyx_GetItemInt_List(__pyx_v_sub_group1, -1L, long, 1, __Pyx_PyInt_From_long, 1, 1, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 553, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_5 = __Pyx_GetItemInt(__pyx_t_1, -1L, long, 1, __Pyx_PyInt_From_long, 0, 1, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 553, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = PyNumber_Subtract(__pyx_v_i, __pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 553, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = PyObject_RichCompare(__pyx_t_1, __pyx_v_dis_cff, Py_LT); __Pyx_XGOTREF(__pyx_t_5); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 553, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 553, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    if (__pyx_t_6) {

      /* "vapor_vali/Simple_function.pyx":554
 *     for i in sorted_list[1:]:
 *         if i-sub_group1[-1][-1]<dis_cff:
 *             sub_group1[-1].append(i)             # <<<<<<<<<<<<<<
 *         else:
 *             sub_group1.append([i])
 */
      __pyx_t_5 = __Pyx_GetItemInt_List(__pyx_v_sub_group1, -1L, long, 1, __Pyx_PyInt_From_long, 1, 1, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 554, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_5);
      __pyx_t_3 = __Pyx_PyObject_Append(__pyx_t_5, __pyx_v_i); if (unlikely(__pyx_t_3 == -1)) __PYX_ERR(0, 554, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;

      /* "vapor_vali/Simple_function.pyx":553
 *     sub_group1=[[sorted_list[0]]]
 *     for i in sorted_list[1:]:
 *         if i-sub_group1[-1][-1]<dis_cff:             # <<<<<<<<<<<<<<
 *             sub_group1[-1].append(i)
 *         else:
 */
      goto __pyx_L5;
    }

    /* "vapor_vali/Simple_function.pyx":556
 *             sub_group1[-1].append(i)
 *         else:
 *             sub_group1.append([i])             # <<<<<<<<<<<<<<
 *     remove_noise_1=[i for i in sub_group1 if len(i)>10]
 *     out1=[[i for i in range(len(dis_to_diagnal)) if dis_to_diagnal[i] in j] for j in remove_noise_1]
 */
    /*else*/ {
      __pyx_t_5 = PyList_New(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 556, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_5);
      __Pyx_INCREF(__pyx_v_i);
      __Pyx_GIVEREF(__pyx_v_i);
      PyList_SET_ITEM(__pyx_t_5, 0, __pyx_v_i);
      __pyx_t_3 = __Pyx_PyList_Append(__pyx_v_sub_group1, __pyx_t_5); if (unlikely(__pyx_t_3 == -1)) __PYX_ERR(0, 556, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    }
    __pyx_L5:;

    /* "vapor_vali/Simple_function.pyx":552
 *     sorted_list=sorted(dis_to_diagnal)
 *     sub_group1=[[sorted_list[0]]]
 *     for i in sorted_list[1:]:             # <<<<<<<<<<<<<<
 *         if i-sub_group1[-1][-1]<dis_cff:
 *             sub_group1[-1].append(i)
 */
  }
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":557
 *         else:
 *             sub_group1.append([i])
 *     remove_noise_1=[i for i in sub_group1 if len(i)>10]             # <<<<<<<<<<<<<<
 *     out1=[[i for i in range(len(dis_to_diagnal)) if dis_to_diagnal[i] in j] for j in remove_noise_1]
 *     out_total=[]
 */
  __pyx_t_2 = PyList_New(0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 557, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_5 = __pyx_v_sub_group1; __Pyx_INCREF(__pyx_t_5); __pyx_t_4 = 0;
  for (;;) {
    if (__pyx_t_4 >= PyList_GET_SIZE(__pyx_t_5)) break;
    #if CYTHON_COMPILING_IN_CPYTHON
    __pyx_t_1 = PyList_GET_ITEM(__pyx_t_5, __pyx_t_4); __Pyx_INCREF(__pyx_t_1); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 557, __pyx_L1_error)
    #else
    __pyx_t_1 = PySequence_ITEM(__pyx_t_5, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 557, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    #endif
    __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_1);
    __pyx_t_1 = 0;
    __pyx_t_7 = PyObject_Length(__pyx_v_i); if (unlikely(__pyx_t_7 == -1)) __PYX_ERR(0, 557, __pyx_L1_error)
    __pyx_t_6 = ((__pyx_t_7 > 10) != 0);
    if (__pyx_t_6) {
      if (unlikely(__Pyx_ListComp_Append(__pyx_t_2, (PyObject*)__pyx_v_i))) __PYX_ERR(0, 557, __pyx_L1_error)
    }
  }
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v_remove_noise_1 = ((PyObject*)__pyx_t_2);
  __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":558
 *             sub_group1.append([i])
 *     remove_noise_1=[i for i in sub_group1 if len(i)>10]
 *     out1=[[i for i in range(len(dis_to_diagnal)) if dis_to_diagnal[i] in j] for j in remove_noise_1]             # <<<<<<<<<<<<<<
 *     out_total=[]
 *     for i in out1:  out_total+=i
 */
  __pyx_t_2 = PyList_New(0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 558, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_5 = __pyx_v_remove_noise_1; __Pyx_INCREF(__pyx_t_5); __pyx_t_4 = 0;
  for (;;) {
    if (__pyx_t_4 >= PyList_GET_SIZE(__pyx_t_5)) break;
    #if CYTHON_COMPILING_IN_CPYTHON
    __pyx_t_1 = PyList_GET_ITEM(__pyx_t_5, __pyx_t_4); __Pyx_INCREF(__pyx_t_1); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 558, __pyx_L1_error)
    #else
    __pyx_t_1 = PySequence_ITEM(__pyx_t_5, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 558, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    #endif
    __Pyx_XDECREF_SET(__pyx_v_j, __pyx_t_1);
    __pyx_t_1 = 0;
    __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 558, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_7 = PyObject_Length(__pyx_v_dis_to_diagnal); if (unlikely(__pyx_t_7 == -1)) __PYX_ERR(0, 558, __pyx_L1_error)
    __pyx_t_8 = PyInt_FromSsize_t(__pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 558, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_8);
    __pyx_t_9 = PyTuple_New(1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 558, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_9);
    __Pyx_GIVEREF(__pyx_t_8);
    PyTuple_SET_ITEM(__pyx_t_9, 0, __pyx_t_8);
    __pyx_t_8 = 0;
    __pyx_t_8 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_t_9, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 558, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_8);
    __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
    if (likely(PyList_CheckExact(__pyx_t_8)) || PyTuple_CheckExact(__pyx_t_8)) {
      __pyx_t_9 = __pyx_t_8; __Pyx_INCREF(__pyx_t_9); __pyx_t_7 = 0;
      __pyx_t_10 = NULL;
    } else {
      __pyx_t_7 = -1; __pyx_t_9 = PyObject_GetIter(__pyx_t_8); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 558, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_9);
      __pyx_t_10 = Py_TYPE(__pyx_t_9)->tp_iternext; if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 558, __pyx_L1_error)
    }
    __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
    for (;;) {
      if (likely(!__pyx_t_10)) {
        if (likely(PyList_CheckExact(__pyx_t_9))) {
          if (__pyx_t_7 >= PyList_GET_SIZE(__pyx_t_9)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_8 = PyList_GET_ITEM(__pyx_t_9, __pyx_t_7); __Pyx_INCREF(__pyx_t_8); __pyx_t_7++; if (unlikely(0 < 0)) __PYX_ERR(0, 558, __pyx_L1_error)
          #else
          __pyx_t_8 = PySequence_ITEM(__pyx_t_9, __pyx_t_7); __pyx_t_7++; if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 558, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_8);
          #endif
        } else {
          if (__pyx_t_7 >= PyTuple_GET_SIZE(__pyx_t_9)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_8 = PyTuple_GET_ITEM(__pyx_t_9, __pyx_t_7); __Pyx_INCREF(__pyx_t_8); __pyx_t_7++; if (unlikely(0 < 0)) __PYX_ERR(0, 558, __pyx_L1_error)
          #else
          __pyx_t_8 = PySequence_ITEM(__pyx_t_9, __pyx_t_7); __pyx_t_7++; if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 558, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_8);
          #endif
        }
      } else {
        __pyx_t_8 = __pyx_t_10(__pyx_t_9);
        if (unlikely(!__pyx_t_8)) {
          PyObject* exc_type = PyErr_Occurred();
          if (exc_type) {
            if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
            else __PYX_ERR(0, 558, __pyx_L1_error)
          }
          break;
        }
        __Pyx_GOTREF(__pyx_t_8);
      }
      __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_8);
      __pyx_t_8 = 0;
      __pyx_t_8 = PyObject_GetItem(__pyx_v_dis_to_diagnal, __pyx_v_i); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 558, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_8);
      __pyx_t_6 = (__Pyx_PySequence_ContainsTF(__pyx_t_8, __pyx_v_j, Py_EQ)); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 558, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
      __pyx_t_11 = (__pyx_t_6 != 0);
      if (__pyx_t_11) {
        if (unlikely(__Pyx_ListComp_Append(__pyx_t_1, (PyObject*)__pyx_v_i))) __PYX_ERR(0, 558, __pyx_L1_error)
      }
    }
    __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
    if (unlikely(__Pyx_ListComp_Append(__pyx_t_2, (PyObject*)__pyx_t_1))) __PYX_ERR(0, 558, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  }
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v_out1 = ((PyObject*)__pyx_t_2);
  __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":559
 *     remove_noise_1=[i for i in sub_group1 if len(i)>10]
 *     out1=[[i for i in range(len(dis_to_diagnal)) if dis_to_diagnal[i] in j] for j in remove_noise_1]
 *     out_total=[]             # <<<<<<<<<<<<<<
 *     for i in out1:  out_total+=i
 *     out2=[i for i in range(len(dis_to_diagnal)) if not i in out_total]
 */
  __pyx_t_2 = PyList_New(0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 559, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_v_out_total = __pyx_t_2;
  __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":560
 *     out1=[[i for i in range(len(dis_to_diagnal)) if dis_to_diagnal[i] in j] for j in remove_noise_1]
 *     out_total=[]
 *     for i in out1:  out_total+=i             # <<<<<<<<<<<<<<
 *     out2=[i for i in range(len(dis_to_diagnal)) if not i in out_total]
 *     return [out1,out2]
 */
  __pyx_t_2 = __pyx_v_out1; __Pyx_INCREF(__pyx_t_2); __pyx_t_4 = 0;
  for (;;) {
    if (__pyx_t_4 >= PyList_GET_SIZE(__pyx_t_2)) break;
    #if CYTHON_COMPILING_IN_CPYTHON
    __pyx_t_5 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_4); __Pyx_INCREF(__pyx_t_5); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 560, __pyx_L1_error)
    #else
    __pyx_t_5 = PySequence_ITEM(__pyx_t_2, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 560, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    #endif
    __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_5);
    __pyx_t_5 = 0;
    __pyx_t_5 = PyNumber_InPlaceAdd(__pyx_v_out_total, __pyx_v_i); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 560, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_DECREF_SET(__pyx_v_out_total, __pyx_t_5);
    __pyx_t_5 = 0;
  }
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":561
 *     out_total=[]
 *     for i in out1:  out_total+=i
 *     out2=[i for i in range(len(dis_to_diagnal)) if not i in out_total]             # <<<<<<<<<<<<<<
 *     return [out1,out2]
 * 
 */
  __pyx_t_2 = PyList_New(0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 561, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_4 = PyObject_Length(__pyx_v_dis_to_diagnal); if (unlikely(__pyx_t_4 == -1)) __PYX_ERR(0, 561, __pyx_L1_error)
  __pyx_t_5 = PyInt_FromSsize_t(__pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 561, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 561, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_GIVEREF(__pyx_t_5);
  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_5);
  __pyx_t_5 = 0;
  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_t_1, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 561, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  if (likely(PyList_CheckExact(__pyx_t_5)) || PyTuple_CheckExact(__pyx_t_5)) {
    __pyx_t_1 = __pyx_t_5; __Pyx_INCREF(__pyx_t_1); __pyx_t_4 = 0;
    __pyx_t_10 = NULL;
  } else {
    __pyx_t_4 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 561, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_10 = Py_TYPE(__pyx_t_1)->tp_iternext; if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 561, __pyx_L1_error)
  }
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  for (;;) {
    if (likely(!__pyx_t_10)) {
      if (likely(PyList_CheckExact(__pyx_t_1))) {
        if (__pyx_t_4 >= PyList_GET_SIZE(__pyx_t_1)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_5 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_4); __Pyx_INCREF(__pyx_t_5); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 561, __pyx_L1_error)
        #else
        __pyx_t_5 = PySequence_ITEM(__pyx_t_1, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 561, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_5);
        #endif
      } else {
        if (__pyx_t_4 >= PyTuple_GET_SIZE(__pyx_t_1)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_5 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_4); __Pyx_INCREF(__pyx_t_5); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 561, __pyx_L1_error)
        #else
        __pyx_t_5 = PySequence_ITEM(__pyx_t_1, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 561, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_5);
        #endif
      }
    } else {
      __pyx_t_5 = __pyx_t_10(__pyx_t_1);
      if (unlikely(!__pyx_t_5)) {
        PyObject* exc_type = PyErr_Occurred();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
          else __PYX_ERR(0, 561, __pyx_L1_error)
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_5);
    }
    __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_5);
    __pyx_t_5 = 0;
    __pyx_t_11 = (__Pyx_PySequence_ContainsTF(__pyx_v_i, __pyx_v_out_total, Py_NE)); if (unlikely(__pyx_t_11 < 0)) __PYX_ERR(0, 561, __pyx_L1_error)
    __pyx_t_6 = (__pyx_t_11 != 0);
    if (__pyx_t_6) {
      if (unlikely(__Pyx_ListComp_Append(__pyx_t_2, (PyObject*)__pyx_v_i))) __PYX_ERR(0, 561, __pyx_L1_error)
    }
  }
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_out2 = ((PyObject*)__pyx_t_2);
  __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":562
 *     for i in out1:  out_total+=i
 *     out2=[i for i in range(len(dis_to_diagnal)) if not i in out_total]
 *     return [out1,out2]             # <<<<<<<<<<<<<<
 * 
 * def dis_to_diagnal_most_abundant_defined(alt_clean_dotdata):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_2 = PyList_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 562, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_INCREF(__pyx_v_out1);
  __Pyx_GIVEREF(__pyx_v_out1);
  PyList_SET_ITEM(__pyx_t_2, 0, __pyx_v_out1);
  __Pyx_INCREF(__pyx_v_out2);
  __Pyx_GIVEREF(__pyx_v_out2);
  PyList_SET_ITEM(__pyx_t_2, 1, __pyx_v_out2);
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  /* "vapor_vali/Simple_function.pyx":548
 *     return [[i for i in range(len(dis_to_diagnal)) if dis_to_diagnal[i] in j] for j in remove_noise_1]
 * 
 * def dis_cluster_2(dis_to_diagnal,dis_cff=10):             # <<<<<<<<<<<<<<
 *     #eg of dis_list=[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 683, 854, 0, 683, 854, 0, 683, 854, 0, 683, 854, 0, 683, 0, 683, 0, 683, 0, 683, 0, 341, 512, 683, 0, 341, 512, 683, 0, 341, 512, 683, 0, 341, 512, 683, 1025, 0, 341, 512, 683, 1025, 0, 170, 341, 512, 683, 1025, 0, 170, 341, 683, 854, 1025, 0, 170, 683, 854, 1025, 0, 683, 1025, 0, 0, 0, 0, 0, 0, 0, 0, 512, 0, 512, 0, 512, 1196, 0, 170, 341, 512, 854, 1196, 1367, 0, 170, 341, 512, 854, 1196, 1367, 0]
 *     sorted_list=sorted(dis_to_diagnal)
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_8);
  __Pyx_XDECREF(__pyx_t_9);
  __Pyx_AddTraceback("vapor_vali.Simple_function.dis_cluster_2", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_sorted_list);
  __Pyx_XDECREF(__pyx_v_sub_group1);
  __Pyx_XDECREF(__pyx_v_i);
  __Pyx_XDECREF(__pyx_v_remove_noise_1);
  __Pyx_XDECREF(__pyx_v_out1);
  __Pyx_XDECREF(__pyx_v_out_total);
  __Pyx_XDECREF(__pyx_v_out2);
  __Pyx_XDECREF(__pyx_v_j);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "vapor_vali/Simple_function.pyx":564
 *     return [out1,out2]
 * 
 * def dis_to_diagnal_most_abundant_defined(alt_clean_dotdata):             # <<<<<<<<<<<<<<
 *     dis_to_diagnal_list=[i[1]-i[0] for i in alt_clean_dotdata]
 *     dis_range=[min(dis_to_diagnal_list)+i*float(max(dis_to_diagnal_list)-min(dis_to_diagnal_list))/10.0 for i in range(11)]
 */

/* Python wrapper */
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_71dis_to_diagnal_most_abundant_defined(PyObject *__pyx_self, PyObject *__pyx_v_alt_clean_dotdata); /*proto*/
static PyMethodDef __pyx_mdef_10vapor_vali_15Simple_function_71dis_to_diagnal_most_abundant_defined = {"dis_to_diagnal_most_abundant_defined", (PyCFunction)__pyx_pw_10vapor_vali_15Simple_function_71dis_to_diagnal_most_abundant_defined, METH_O, 0};
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_71dis_to_diagnal_most_abundant_defined(PyObject *__pyx_self, PyObject *__pyx_v_alt_clean_dotdata) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("dis_to_diagnal_most_abundant_defined (wrapper)", 0);
  __pyx_r = __pyx_pf_10vapor_vali_15Simple_function_70dis_to_diagnal_most_abundant_defined(__pyx_self, ((PyObject *)__pyx_v_alt_clean_dotdata));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10vapor_vali_15Simple_function_70dis_to_diagnal_most_abundant_defined(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_alt_clean_dotdata) {
  PyObject *__pyx_v_dis_to_diagnal_list = NULL;
  PyObject *__pyx_v_dis_range = NULL;
  PyObject *__pyx_v_kept_list1 = NULL;
  PyObject *__pyx_v_kept_list2 = NULL;
  PyObject *__pyx_v_km = NULL;
  PyObject *__pyx_v_j = NULL;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  Py_ssize_t __pyx_t_3;
  PyObject *(*__pyx_t_4)(PyObject *);
  PyObject *__pyx_t_5 = NULL;
  PyObject *__pyx_t_6 = NULL;
  PyObject *__pyx_t_7 = NULL;
  PyObject *__pyx_t_8 = NULL;
  Py_ssize_t __pyx_t_9;
  PyObject *(*__pyx_t_10)(PyObject *);
  PyObject *__pyx_t_11 = NULL;
  int __pyx_t_12;
  __Pyx_RefNannySetupContext("dis_to_diagnal_most_abundant_defined", 0);

  /* "vapor_vali/Simple_function.pyx":565
 * 
 * def dis_to_diagnal_most_abundant_defined(alt_clean_dotdata):
 *     dis_to_diagnal_list=[i[1]-i[0] for i in alt_clean_dotdata]             # <<<<<<<<<<<<<<
 *     dis_range=[min(dis_to_diagnal_list)+i*float(max(dis_to_diagnal_list)-min(dis_to_diagnal_list))/10.0 for i in range(11)]
 *     kept_list1=find_longest_list(number_cluster(dis_to_diagnal_list,dis_range))
 */
  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 565, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  if (likely(PyList_CheckExact(__pyx_v_alt_clean_dotdata)) || PyTuple_CheckExact(__pyx_v_alt_clean_dotdata)) {
    __pyx_t_2 = __pyx_v_alt_clean_dotdata; __Pyx_INCREF(__pyx_t_2); __pyx_t_3 = 0;
    __pyx_t_4 = NULL;
  } else {
    __pyx_t_3 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_v_alt_clean_dotdata); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 565, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_4 = Py_TYPE(__pyx_t_2)->tp_iternext; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 565, __pyx_L1_error)
  }
  for (;;) {
    if (likely(!__pyx_t_4)) {
      if (likely(PyList_CheckExact(__pyx_t_2))) {
        if (__pyx_t_3 >= PyList_GET_SIZE(__pyx_t_2)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_5 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_3); __Pyx_INCREF(__pyx_t_5); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 565, __pyx_L1_error)
        #else
        __pyx_t_5 = PySequence_ITEM(__pyx_t_2, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 565, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_5);
        #endif
      } else {
        if (__pyx_t_3 >= PyTuple_GET_SIZE(__pyx_t_2)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_5 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_3); __Pyx_INCREF(__pyx_t_5); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 565, __pyx_L1_error)
        #else
        __pyx_t_5 = PySequence_ITEM(__pyx_t_2, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 565, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_5);
        #endif
      }
    } else {
      __pyx_t_5 = __pyx_t_4(__pyx_t_2);
      if (unlikely(!__pyx_t_5)) {
        PyObject* exc_type = PyErr_Occurred();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
          else __PYX_ERR(0, 565, __pyx_L1_error)
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_5);
    }
    __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_5);
    __pyx_t_5 = 0;
    __pyx_t_5 = __Pyx_GetItemInt(__pyx_v_i, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 565, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __pyx_t_6 = __Pyx_GetItemInt(__pyx_v_i, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 565, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __pyx_t_7 = PyNumber_Subtract(__pyx_t_5, __pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 565, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    if (unlikely(__Pyx_ListComp_Append(__pyx_t_1, (PyObject*)__pyx_t_7))) __PYX_ERR(0, 565, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
  }
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_dis_to_diagnal_list = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":566
 * def dis_to_diagnal_most_abundant_defined(alt_clean_dotdata):
 *     dis_to_diagnal_list=[i[1]-i[0] for i in alt_clean_dotdata]
 *     dis_range=[min(dis_to_diagnal_list)+i*float(max(dis_to_diagnal_list)-min(dis_to_diagnal_list))/10.0 for i in range(11)]             # <<<<<<<<<<<<<<
 *     kept_list1=find_longest_list(number_cluster(dis_to_diagnal_list,dis_range))
 *     kept_list2=[]
 */
  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 566, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_tuple__33, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 566, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (likely(PyList_CheckExact(__pyx_t_2)) || PyTuple_CheckExact(__pyx_t_2)) {
    __pyx_t_7 = __pyx_t_2; __Pyx_INCREF(__pyx_t_7); __pyx_t_3 = 0;
    __pyx_t_4 = NULL;
  } else {
    __pyx_t_3 = -1; __pyx_t_7 = PyObject_GetIter(__pyx_t_2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 566, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    __pyx_t_4 = Py_TYPE(__pyx_t_7)->tp_iternext; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 566, __pyx_L1_error)
  }
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  for (;;) {
    if (likely(!__pyx_t_4)) {
      if (likely(PyList_CheckExact(__pyx_t_7))) {
        if (__pyx_t_3 >= PyList_GET_SIZE(__pyx_t_7)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_2 = PyList_GET_ITEM(__pyx_t_7, __pyx_t_3); __Pyx_INCREF(__pyx_t_2); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 566, __pyx_L1_error)
        #else
        __pyx_t_2 = PySequence_ITEM(__pyx_t_7, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 566, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
        #endif
      } else {
        if (__pyx_t_3 >= PyTuple_GET_SIZE(__pyx_t_7)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_2 = PyTuple_GET_ITEM(__pyx_t_7, __pyx_t_3); __Pyx_INCREF(__pyx_t_2); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 566, __pyx_L1_error)
        #else
        __pyx_t_2 = PySequence_ITEM(__pyx_t_7, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 566, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
        #endif
      }
    } else {
      __pyx_t_2 = __pyx_t_4(__pyx_t_7);
      if (unlikely(!__pyx_t_2)) {
        PyObject* exc_type = PyErr_Occurred();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
          else __PYX_ERR(0, 566, __pyx_L1_error)
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_2);
    }
    __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_2);
    __pyx_t_2 = 0;
    __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 566, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_INCREF(__pyx_v_dis_to_diagnal_list);
    __Pyx_GIVEREF(__pyx_v_dis_to_diagnal_list);
    PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_v_dis_to_diagnal_list);
    __pyx_t_6 = __Pyx_PyObject_Call(__pyx_builtin_min, __pyx_t_2, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 566, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 566, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_INCREF(__pyx_v_dis_to_diagnal_list);
    __Pyx_GIVEREF(__pyx_v_dis_to_diagnal_list);
    PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_v_dis_to_diagnal_list);
    __pyx_t_5 = __Pyx_PyObject_Call(__pyx_builtin_max, __pyx_t_2, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 566, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 566, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_INCREF(__pyx_v_dis_to_diagnal_list);
    __Pyx_GIVEREF(__pyx_v_dis_to_diagnal_list);
    PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_v_dis_to_diagnal_list);
    __pyx_t_8 = __Pyx_PyObject_Call(__pyx_builtin_min, __pyx_t_2, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 566, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_8);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = PyNumber_Subtract(__pyx_t_5, __pyx_t_8); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 566, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
    __pyx_t_8 = __Pyx_PyNumber_Float(__pyx_t_2); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 566, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_8);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = PyNumber_Multiply(__pyx_v_i, __pyx_t_8); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 566, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
    __pyx_t_8 = __Pyx_PyFloat_DivideObjC(__pyx_t_2, __pyx_float_10_0, 10.0, 0); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 566, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_8);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = PyNumber_Add(__pyx_t_6, __pyx_t_8); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 566, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
    if (unlikely(__Pyx_ListComp_Append(__pyx_t_1, (PyObject*)__pyx_t_2))) __PYX_ERR(0, 566, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  }
  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_v_dis_range = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":567
 *     dis_to_diagnal_list=[i[1]-i[0] for i in alt_clean_dotdata]
 *     dis_range=[min(dis_to_diagnal_list)+i*float(max(dis_to_diagnal_list)-min(dis_to_diagnal_list))/10.0 for i in range(11)]
 *     kept_list1=find_longest_list(number_cluster(dis_to_diagnal_list,dis_range))             # <<<<<<<<<<<<<<
 *     kept_list2=[]
 *     for km in kept_list1:
 */
  __pyx_t_7 = __Pyx_GetModuleGlobalName(__pyx_n_s_find_longest_list); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 567, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  __pyx_t_8 = __Pyx_GetModuleGlobalName(__pyx_n_s_number_cluster); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 567, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_8);
  __pyx_t_6 = NULL;
  __pyx_t_3 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_8))) {
    __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_8);
    if (likely(__pyx_t_6)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_8);
      __Pyx_INCREF(__pyx_t_6);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_8, function);
      __pyx_t_3 = 1;
    }
  }
  __pyx_t_5 = PyTuple_New(2+__pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 567, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  if (__pyx_t_6) {
    __Pyx_GIVEREF(__pyx_t_6); PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_6); __pyx_t_6 = NULL;
  }
  __Pyx_INCREF(__pyx_v_dis_to_diagnal_list);
  __Pyx_GIVEREF(__pyx_v_dis_to_diagnal_list);
  PyTuple_SET_ITEM(__pyx_t_5, 0+__pyx_t_3, __pyx_v_dis_to_diagnal_list);
  __Pyx_INCREF(__pyx_v_dis_range);
  __Pyx_GIVEREF(__pyx_v_dis_range);
  PyTuple_SET_ITEM(__pyx_t_5, 1+__pyx_t_3, __pyx_v_dis_range);
  __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_8, __pyx_t_5, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 567, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
  __pyx_t_8 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_7))) {
    __pyx_t_8 = PyMethod_GET_SELF(__pyx_t_7);
    if (likely(__pyx_t_8)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_7);
      __Pyx_INCREF(__pyx_t_8);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_7, function);
    }
  }
  if (!__pyx_t_8) {
    __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_7, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 567, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __Pyx_GOTREF(__pyx_t_1);
  } else {
    __pyx_t_5 = PyTuple_New(1+1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 567, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_GIVEREF(__pyx_t_8); PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_8); __pyx_t_8 = NULL;
    __Pyx_GIVEREF(__pyx_t_2);
    PyTuple_SET_ITEM(__pyx_t_5, 0+1, __pyx_t_2);
    __pyx_t_2 = 0;
    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_7, __pyx_t_5, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 567, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  }
  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_v_kept_list1 = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":568
 *     dis_range=[min(dis_to_diagnal_list)+i*float(max(dis_to_diagnal_list)-min(dis_to_diagnal_list))/10.0 for i in range(11)]
 *     kept_list1=find_longest_list(number_cluster(dis_to_diagnal_list,dis_range))
 *     kept_list2=[]             # <<<<<<<<<<<<<<
 *     for km in kept_list1:
 *         j=[min(km)+i*float(max(km)-min(km))/10.0 for i in range(11)]
 */
  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 568, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_kept_list2 = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":569
 *     kept_list1=find_longest_list(number_cluster(dis_to_diagnal_list,dis_range))
 *     kept_list2=[]
 *     for km in kept_list1:             # <<<<<<<<<<<<<<
 *         j=[min(km)+i*float(max(km)-min(km))/10.0 for i in range(11)]
 *         kept_list2+=find_longest_list(number_cluster(km,j))
 */
  if (likely(PyList_CheckExact(__pyx_v_kept_list1)) || PyTuple_CheckExact(__pyx_v_kept_list1)) {
    __pyx_t_1 = __pyx_v_kept_list1; __Pyx_INCREF(__pyx_t_1); __pyx_t_3 = 0;
    __pyx_t_4 = NULL;
  } else {
    __pyx_t_3 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_v_kept_list1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 569, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_4 = Py_TYPE(__pyx_t_1)->tp_iternext; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 569, __pyx_L1_error)
  }
  for (;;) {
    if (likely(!__pyx_t_4)) {
      if (likely(PyList_CheckExact(__pyx_t_1))) {
        if (__pyx_t_3 >= PyList_GET_SIZE(__pyx_t_1)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_7 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_3); __Pyx_INCREF(__pyx_t_7); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 569, __pyx_L1_error)
        #else
        __pyx_t_7 = PySequence_ITEM(__pyx_t_1, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 569, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_7);
        #endif
      } else {
        if (__pyx_t_3 >= PyTuple_GET_SIZE(__pyx_t_1)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_7 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_3); __Pyx_INCREF(__pyx_t_7); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 569, __pyx_L1_error)
        #else
        __pyx_t_7 = PySequence_ITEM(__pyx_t_1, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 569, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_7);
        #endif
      }
    } else {
      __pyx_t_7 = __pyx_t_4(__pyx_t_1);
      if (unlikely(!__pyx_t_7)) {
        PyObject* exc_type = PyErr_Occurred();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
          else __PYX_ERR(0, 569, __pyx_L1_error)
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_7);
    }
    __Pyx_XDECREF_SET(__pyx_v_km, __pyx_t_7);
    __pyx_t_7 = 0;

    /* "vapor_vali/Simple_function.pyx":570
 *     kept_list2=[]
 *     for km in kept_list1:
 *         j=[min(km)+i*float(max(km)-min(km))/10.0 for i in range(11)]             # <<<<<<<<<<<<<<
 *         kept_list2+=find_longest_list(number_cluster(km,j))
 *     if len(kept_list2)==1:  return np.median(kept_list2[0])
 */
    __pyx_t_7 = PyList_New(0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 570, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    __pyx_t_5 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_tuple__34, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 570, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    if (likely(PyList_CheckExact(__pyx_t_5)) || PyTuple_CheckExact(__pyx_t_5)) {
      __pyx_t_2 = __pyx_t_5; __Pyx_INCREF(__pyx_t_2); __pyx_t_9 = 0;
      __pyx_t_10 = NULL;
    } else {
      __pyx_t_9 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_t_5); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 570, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __pyx_t_10 = Py_TYPE(__pyx_t_2)->tp_iternext; if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 570, __pyx_L1_error)
    }
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    for (;;) {
      if (likely(!__pyx_t_10)) {
        if (likely(PyList_CheckExact(__pyx_t_2))) {
          if (__pyx_t_9 >= PyList_GET_SIZE(__pyx_t_2)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_5 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_9); __Pyx_INCREF(__pyx_t_5); __pyx_t_9++; if (unlikely(0 < 0)) __PYX_ERR(0, 570, __pyx_L1_error)
          #else
          __pyx_t_5 = PySequence_ITEM(__pyx_t_2, __pyx_t_9); __pyx_t_9++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 570, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_5);
          #endif
        } else {
          if (__pyx_t_9 >= PyTuple_GET_SIZE(__pyx_t_2)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_5 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_9); __Pyx_INCREF(__pyx_t_5); __pyx_t_9++; if (unlikely(0 < 0)) __PYX_ERR(0, 570, __pyx_L1_error)
          #else
          __pyx_t_5 = PySequence_ITEM(__pyx_t_2, __pyx_t_9); __pyx_t_9++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 570, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_5);
          #endif
        }
      } else {
        __pyx_t_5 = __pyx_t_10(__pyx_t_2);
        if (unlikely(!__pyx_t_5)) {
          PyObject* exc_type = PyErr_Occurred();
          if (exc_type) {
            if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
            else __PYX_ERR(0, 570, __pyx_L1_error)
          }
          break;
        }
        __Pyx_GOTREF(__pyx_t_5);
      }
      __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_5);
      __pyx_t_5 = 0;
      __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 570, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_5);
      __Pyx_INCREF(__pyx_v_km);
      __Pyx_GIVEREF(__pyx_v_km);
      PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_v_km);
      __pyx_t_8 = __Pyx_PyObject_Call(__pyx_builtin_min, __pyx_t_5, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 570, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_8);
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
      __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 570, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_5);
      __Pyx_INCREF(__pyx_v_km);
      __Pyx_GIVEREF(__pyx_v_km);
      PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_v_km);
      __pyx_t_6 = __Pyx_PyObject_Call(__pyx_builtin_max, __pyx_t_5, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 570, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_6);
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
      __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 570, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_5);
      __Pyx_INCREF(__pyx_v_km);
      __Pyx_GIVEREF(__pyx_v_km);
      PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_v_km);
      __pyx_t_11 = __Pyx_PyObject_Call(__pyx_builtin_min, __pyx_t_5, NULL); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 570, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_11);
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
      __pyx_t_5 = PyNumber_Subtract(__pyx_t_6, __pyx_t_11); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 570, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_5);
      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
      __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
      __pyx_t_11 = __Pyx_PyNumber_Float(__pyx_t_5); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 570, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_11);
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
      __pyx_t_5 = PyNumber_Multiply(__pyx_v_i, __pyx_t_11); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 570, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_5);
      __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
      __pyx_t_11 = __Pyx_PyFloat_DivideObjC(__pyx_t_5, __pyx_float_10_0, 10.0, 0); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 570, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_11);
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
      __pyx_t_5 = PyNumber_Add(__pyx_t_8, __pyx_t_11); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 570, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_5);
      __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
      __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
      if (unlikely(__Pyx_ListComp_Append(__pyx_t_7, (PyObject*)__pyx_t_5))) __PYX_ERR(0, 570, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    }
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __Pyx_XDECREF_SET(__pyx_v_j, ((PyObject*)__pyx_t_7));
    __pyx_t_7 = 0;

    /* "vapor_vali/Simple_function.pyx":571
 *     for km in kept_list1:
 *         j=[min(km)+i*float(max(km)-min(km))/10.0 for i in range(11)]
 *         kept_list2+=find_longest_list(number_cluster(km,j))             # <<<<<<<<<<<<<<
 *     if len(kept_list2)==1:  return np.median(kept_list2[0])
 *     else:                   return 0
 */
    __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_find_longest_list); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 571, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_11 = __Pyx_GetModuleGlobalName(__pyx_n_s_number_cluster); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 571, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_11);
    __pyx_t_8 = NULL;
    __pyx_t_9 = 0;
    if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_11))) {
      __pyx_t_8 = PyMethod_GET_SELF(__pyx_t_11);
      if (likely(__pyx_t_8)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_11);
        __Pyx_INCREF(__pyx_t_8);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_11, function);
        __pyx_t_9 = 1;
      }
    }
    __pyx_t_6 = PyTuple_New(2+__pyx_t_9); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 571, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    if (__pyx_t_8) {
      __Pyx_GIVEREF(__pyx_t_8); PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_8); __pyx_t_8 = NULL;
    }
    __Pyx_INCREF(__pyx_v_km);
    __Pyx_GIVEREF(__pyx_v_km);
    PyTuple_SET_ITEM(__pyx_t_6, 0+__pyx_t_9, __pyx_v_km);
    __Pyx_INCREF(__pyx_v_j);
    __Pyx_GIVEREF(__pyx_v_j);
    PyTuple_SET_ITEM(__pyx_t_6, 1+__pyx_t_9, __pyx_v_j);
    __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_11, __pyx_t_6, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 571, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
    __pyx_t_11 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_2))) {
      __pyx_t_11 = PyMethod_GET_SELF(__pyx_t_2);
      if (likely(__pyx_t_11)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
        __Pyx_INCREF(__pyx_t_11);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_2, function);
      }
    }
    if (!__pyx_t_11) {
      __pyx_t_7 = __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_5); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 571, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
      __Pyx_GOTREF(__pyx_t_7);
    } else {
      __pyx_t_6 = PyTuple_New(1+1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 571, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_6);
      __Pyx_GIVEREF(__pyx_t_11); PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_11); __pyx_t_11 = NULL;
      __Pyx_GIVEREF(__pyx_t_5);
      PyTuple_SET_ITEM(__pyx_t_6, 0+1, __pyx_t_5);
      __pyx_t_5 = 0;
      __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_6, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 571, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_7);
      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    }
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = PyNumber_InPlaceAdd(__pyx_v_kept_list2, __pyx_t_7); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 571, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
    __Pyx_DECREF_SET(__pyx_v_kept_list2, __pyx_t_2);
    __pyx_t_2 = 0;

    /* "vapor_vali/Simple_function.pyx":569
 *     kept_list1=find_longest_list(number_cluster(dis_to_diagnal_list,dis_range))
 *     kept_list2=[]
 *     for km in kept_list1:             # <<<<<<<<<<<<<<
 *         j=[min(km)+i*float(max(km)-min(km))/10.0 for i in range(11)]
 *         kept_list2+=find_longest_list(number_cluster(km,j))
 */
  }
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":572
 *         j=[min(km)+i*float(max(km)-min(km))/10.0 for i in range(11)]
 *         kept_list2+=find_longest_list(number_cluster(km,j))
 *     if len(kept_list2)==1:  return np.median(kept_list2[0])             # <<<<<<<<<<<<<<
 *     else:                   return 0
 * 
 */
  __pyx_t_3 = PyObject_Length(__pyx_v_kept_list2); if (unlikely(__pyx_t_3 == -1)) __PYX_ERR(0, 572, __pyx_L1_error)
  __pyx_t_12 = ((__pyx_t_3 == 1) != 0);
  if (__pyx_t_12) {
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 572, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_median); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 572, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_kept_list2, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 572, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_6 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_7))) {
      __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_7);
      if (likely(__pyx_t_6)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_7);
        __Pyx_INCREF(__pyx_t_6);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_7, function);
      }
    }
    if (!__pyx_t_6) {
      __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_7, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 572, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      __Pyx_GOTREF(__pyx_t_1);
    } else {
      __pyx_t_5 = PyTuple_New(1+1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 572, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_5);
      __Pyx_GIVEREF(__pyx_t_6); PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_6); __pyx_t_6 = NULL;
      __Pyx_GIVEREF(__pyx_t_2);
      PyTuple_SET_ITEM(__pyx_t_5, 0+1, __pyx_t_2);
      __pyx_t_2 = 0;
      __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_7, __pyx_t_5, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 572, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    }
    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;
  }

  /* "vapor_vali/Simple_function.pyx":573
 *         kept_list2+=find_longest_list(number_cluster(km,j))
 *     if len(kept_list2)==1:  return np.median(kept_list2[0])
 *     else:                   return 0             # <<<<<<<<<<<<<<
 * 
 * def dot_to_line(list_dotdata,gap=50,length=10):
 */
  /*else*/ {
    __Pyx_XDECREF(__pyx_r);
    __Pyx_INCREF(__pyx_int_0);
    __pyx_r = __pyx_int_0;
    goto __pyx_L0;
  }

  /* "vapor_vali/Simple_function.pyx":564
 *     return [out1,out2]
 * 
 * def dis_to_diagnal_most_abundant_defined(alt_clean_dotdata):             # <<<<<<<<<<<<<<
 *     dis_to_diagnal_list=[i[1]-i[0] for i in alt_clean_dotdata]
 *     dis_range=[min(dis_to_diagnal_list)+i*float(max(dis_to_diagnal_list)-min(dis_to_diagnal_list))/10.0 for i in range(11)]
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_XDECREF(__pyx_t_7);
  __Pyx_XDECREF(__pyx_t_8);
  __Pyx_XDECREF(__pyx_t_11);
  __Pyx_AddTraceback("vapor_vali.Simple_function.dis_to_diagnal_most_abundant_defined", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_dis_to_diagnal_list);
  __Pyx_XDECREF(__pyx_v_dis_range);
  __Pyx_XDECREF(__pyx_v_kept_list1);
  __Pyx_XDECREF(__pyx_v_kept_list2);
  __Pyx_XDECREF(__pyx_v_km);
  __Pyx_XDECREF(__pyx_v_j);
  __Pyx_XDECREF(__pyx_v_i);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "vapor_vali/Simple_function.pyx":575
 *     else:                   return 0
 * 
 * def dot_to_line(list_dotdata,gap=50,length=10):             # <<<<<<<<<<<<<<
 *     ####This function try to recognize lines in the dot plot
 *     dis_to_diagnal=[i[1]-i[0] for i in list_dotdata]
 */

/* Python wrapper */
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_73dot_to_line(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_10vapor_vali_15Simple_function_73dot_to_line = {"dot_to_line", (PyCFunction)__pyx_pw_10vapor_vali_15Simple_function_73dot_to_line, METH_VARARGS|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_73dot_to_line(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_list_dotdata = 0;
  PyObject *__pyx_v_gap = 0;
  PyObject *__pyx_v_length = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("dot_to_line (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_list_dotdata,&__pyx_n_s_gap,&__pyx_n_s_length,0};
    PyObject* values[3] = {0,0,0};
    values[1] = ((PyObject *)__pyx_int_50);
    values[2] = ((PyObject *)__pyx_int_10);
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
      switch (pos_args) {
        case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_list_dotdata)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (kw_args > 0) {
          PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_gap);
          if (value) { values[1] = value; kw_args--; }
        }
        case  2:
        if (kw_args > 0) {
          PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_length);
          if (value) { values[2] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "dot_to_line") < 0)) __PYX_ERR(0, 575, __pyx_L3_error)
      }
    } else {
      switch (PyTuple_GET_SIZE(__pyx_args)) {
        case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_list_dotdata = values[0];
    __pyx_v_gap = values[1];
    __pyx_v_length = values[2];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("dot_to_line", 0, 1, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 575, __pyx_L3_error)
  __pyx_L3_error:;
  __Pyx_AddTraceback("vapor_vali.Simple_function.dot_to_line", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_10vapor_vali_15Simple_function_72dot_to_line(__pyx_self, __pyx_v_list_dotdata, __pyx_v_gap, __pyx_v_length);

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10vapor_vali_15Simple_function_72dot_to_line(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_list_dotdata, PyObject *__pyx_v_gap, PyObject *__pyx_v_length) {
  PyObject *__pyx_v_dis_to_diagnal = NULL;
  PyObject *__pyx_v_cluster1 = NULL;
  PyObject *__pyx_v_dot_cluster1 = NULL;
  PyObject *__pyx_v_dis_to_anti_diagnal = NULL;
  PyObject *__pyx_v_cluster2 = NULL;
  PyObject *__pyx_v_dot_cluster2 = NULL;
  PyObject *__pyx_v_out = NULL;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_v_j = NULL;
  Py_ssize_t __pyx_v_k;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  Py_ssize_t __pyx_t_3;
  PyObject *(*__pyx_t_4)(PyObject *);
  PyObject *__pyx_t_5 = NULL;
  PyObject *__pyx_t_6 = NULL;
  PyObject *__pyx_t_7 = NULL;
  Py_ssize_t __pyx_t_8;
  PyObject *(*__pyx_t_9)(PyObject *);
  PyObject *__pyx_t_10 = NULL;
  PyObject *__pyx_t_11 = NULL;
  Py_ssize_t __pyx_t_12;
  Py_ssize_t __pyx_t_13;
  int __pyx_t_14;
  __Pyx_RefNannySetupContext("dot_to_line", 0);

  /* "vapor_vali/Simple_function.pyx":577
 * def dot_to_line(list_dotdata,gap=50,length=10):
 *     ####This function try to recognize lines in the dot plot
 *     dis_to_diagnal=[i[1]-i[0] for i in list_dotdata]             # <<<<<<<<<<<<<<
 *     cluster1=one_dimention_cluster_by_gap(dis_to_diagnal,gap,length)
 *     dot_cluster1=[[list_dotdata[i] for i in j] for j in cluster1]
 */
  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 577, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  if (likely(PyList_CheckExact(__pyx_v_list_dotdata)) || PyTuple_CheckExact(__pyx_v_list_dotdata)) {
    __pyx_t_2 = __pyx_v_list_dotdata; __Pyx_INCREF(__pyx_t_2); __pyx_t_3 = 0;
    __pyx_t_4 = NULL;
  } else {
    __pyx_t_3 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_v_list_dotdata); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 577, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_4 = Py_TYPE(__pyx_t_2)->tp_iternext; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 577, __pyx_L1_error)
  }
  for (;;) {
    if (likely(!__pyx_t_4)) {
      if (likely(PyList_CheckExact(__pyx_t_2))) {
        if (__pyx_t_3 >= PyList_GET_SIZE(__pyx_t_2)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_5 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_3); __Pyx_INCREF(__pyx_t_5); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 577, __pyx_L1_error)
        #else
        __pyx_t_5 = PySequence_ITEM(__pyx_t_2, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 577, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_5);
        #endif
      } else {
        if (__pyx_t_3 >= PyTuple_GET_SIZE(__pyx_t_2)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_5 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_3); __Pyx_INCREF(__pyx_t_5); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 577, __pyx_L1_error)
        #else
        __pyx_t_5 = PySequence_ITEM(__pyx_t_2, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 577, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_5);
        #endif
      }
    } else {
      __pyx_t_5 = __pyx_t_4(__pyx_t_2);
      if (unlikely(!__pyx_t_5)) {
        PyObject* exc_type = PyErr_Occurred();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
          else __PYX_ERR(0, 577, __pyx_L1_error)
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_5);
    }
    __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_5);
    __pyx_t_5 = 0;
    __pyx_t_5 = __Pyx_GetItemInt(__pyx_v_i, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 577, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __pyx_t_6 = __Pyx_GetItemInt(__pyx_v_i, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 577, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __pyx_t_7 = PyNumber_Subtract(__pyx_t_5, __pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 577, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    if (unlikely(__Pyx_ListComp_Append(__pyx_t_1, (PyObject*)__pyx_t_7))) __PYX_ERR(0, 577, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
  }
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_dis_to_diagnal = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":578
 *     ####This function try to recognize lines in the dot plot
 *     dis_to_diagnal=[i[1]-i[0] for i in list_dotdata]
 *     cluster1=one_dimention_cluster_by_gap(dis_to_diagnal,gap,length)             # <<<<<<<<<<<<<<
 *     dot_cluster1=[[list_dotdata[i] for i in j] for j in cluster1]
 *     dis_to_anti_diagnal=[[i[1]+i[0] for i in j] for j in dot_cluster1]
 */
  __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_one_dimention_cluster_by_gap); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 578, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_7 = NULL;
  __pyx_t_3 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_2);
    if (likely(__pyx_t_7)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_7);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_2, function);
      __pyx_t_3 = 1;
    }
  }
  __pyx_t_6 = PyTuple_New(3+__pyx_t_3); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 578, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  if (__pyx_t_7) {
    __Pyx_GIVEREF(__pyx_t_7); PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_7); __pyx_t_7 = NULL;
  }
  __Pyx_INCREF(__pyx_v_dis_to_diagnal);
  __Pyx_GIVEREF(__pyx_v_dis_to_diagnal);
  PyTuple_SET_ITEM(__pyx_t_6, 0+__pyx_t_3, __pyx_v_dis_to_diagnal);
  __Pyx_INCREF(__pyx_v_gap);
  __Pyx_GIVEREF(__pyx_v_gap);
  PyTuple_SET_ITEM(__pyx_t_6, 1+__pyx_t_3, __pyx_v_gap);
  __Pyx_INCREF(__pyx_v_length);
  __Pyx_GIVEREF(__pyx_v_length);
  PyTuple_SET_ITEM(__pyx_t_6, 2+__pyx_t_3, __pyx_v_length);
  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_6, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 578, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_cluster1 = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":579
 *     dis_to_diagnal=[i[1]-i[0] for i in list_dotdata]
 *     cluster1=one_dimention_cluster_by_gap(dis_to_diagnal,gap,length)
 *     dot_cluster1=[[list_dotdata[i] for i in j] for j in cluster1]             # <<<<<<<<<<<<<<
 *     dis_to_anti_diagnal=[[i[1]+i[0] for i in j] for j in dot_cluster1]
 *     cluster2=[one_dimention_cluster_by_gap(i,gap,length) for i in dis_to_anti_diagnal]
 */
  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 579, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  if (likely(PyList_CheckExact(__pyx_v_cluster1)) || PyTuple_CheckExact(__pyx_v_cluster1)) {
    __pyx_t_2 = __pyx_v_cluster1; __Pyx_INCREF(__pyx_t_2); __pyx_t_3 = 0;
    __pyx_t_4 = NULL;
  } else {
    __pyx_t_3 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_v_cluster1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 579, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_4 = Py_TYPE(__pyx_t_2)->tp_iternext; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 579, __pyx_L1_error)
  }
  for (;;) {
    if (likely(!__pyx_t_4)) {
      if (likely(PyList_CheckExact(__pyx_t_2))) {
        if (__pyx_t_3 >= PyList_GET_SIZE(__pyx_t_2)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_6 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_3); __Pyx_INCREF(__pyx_t_6); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 579, __pyx_L1_error)
        #else
        __pyx_t_6 = PySequence_ITEM(__pyx_t_2, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 579, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_6);
        #endif
      } else {
        if (__pyx_t_3 >= PyTuple_GET_SIZE(__pyx_t_2)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_6 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_3); __Pyx_INCREF(__pyx_t_6); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 579, __pyx_L1_error)
        #else
        __pyx_t_6 = PySequence_ITEM(__pyx_t_2, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 579, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_6);
        #endif
      }
    } else {
      __pyx_t_6 = __pyx_t_4(__pyx_t_2);
      if (unlikely(!__pyx_t_6)) {
        PyObject* exc_type = PyErr_Occurred();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
          else __PYX_ERR(0, 579, __pyx_L1_error)
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_6);
    }
    __Pyx_XDECREF_SET(__pyx_v_j, __pyx_t_6);
    __pyx_t_6 = 0;
    __pyx_t_6 = PyList_New(0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 579, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    if (likely(PyList_CheckExact(__pyx_v_j)) || PyTuple_CheckExact(__pyx_v_j)) {
      __pyx_t_7 = __pyx_v_j; __Pyx_INCREF(__pyx_t_7); __pyx_t_8 = 0;
      __pyx_t_9 = NULL;
    } else {
      __pyx_t_8 = -1; __pyx_t_7 = PyObject_GetIter(__pyx_v_j); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 579, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_7);
      __pyx_t_9 = Py_TYPE(__pyx_t_7)->tp_iternext; if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 579, __pyx_L1_error)
    }
    for (;;) {
      if (likely(!__pyx_t_9)) {
        if (likely(PyList_CheckExact(__pyx_t_7))) {
          if (__pyx_t_8 >= PyList_GET_SIZE(__pyx_t_7)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_5 = PyList_GET_ITEM(__pyx_t_7, __pyx_t_8); __Pyx_INCREF(__pyx_t_5); __pyx_t_8++; if (unlikely(0 < 0)) __PYX_ERR(0, 579, __pyx_L1_error)
          #else
          __pyx_t_5 = PySequence_ITEM(__pyx_t_7, __pyx_t_8); __pyx_t_8++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 579, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_5);
          #endif
        } else {
          if (__pyx_t_8 >= PyTuple_GET_SIZE(__pyx_t_7)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_5 = PyTuple_GET_ITEM(__pyx_t_7, __pyx_t_8); __Pyx_INCREF(__pyx_t_5); __pyx_t_8++; if (unlikely(0 < 0)) __PYX_ERR(0, 579, __pyx_L1_error)
          #else
          __pyx_t_5 = PySequence_ITEM(__pyx_t_7, __pyx_t_8); __pyx_t_8++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 579, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_5);
          #endif
        }
      } else {
        __pyx_t_5 = __pyx_t_9(__pyx_t_7);
        if (unlikely(!__pyx_t_5)) {
          PyObject* exc_type = PyErr_Occurred();
          if (exc_type) {
            if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
            else __PYX_ERR(0, 579, __pyx_L1_error)
          }
          break;
        }
        __Pyx_GOTREF(__pyx_t_5);
      }
      __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_5);
      __pyx_t_5 = 0;
      __pyx_t_5 = PyObject_GetItem(__pyx_v_list_dotdata, __pyx_v_i); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 579, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_5);
      if (unlikely(__Pyx_ListComp_Append(__pyx_t_6, (PyObject*)__pyx_t_5))) __PYX_ERR(0, 579, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    }
    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
    if (unlikely(__Pyx_ListComp_Append(__pyx_t_1, (PyObject*)__pyx_t_6))) __PYX_ERR(0, 579, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  }
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_dot_cluster1 = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":580
 *     cluster1=one_dimention_cluster_by_gap(dis_to_diagnal,gap,length)
 *     dot_cluster1=[[list_dotdata[i] for i in j] for j in cluster1]
 *     dis_to_anti_diagnal=[[i[1]+i[0] for i in j] for j in dot_cluster1]             # <<<<<<<<<<<<<<
 *     cluster2=[one_dimention_cluster_by_gap(i,gap,length) for i in dis_to_anti_diagnal]
 *     dot_cluster2=[ [[dot_cluster1[k][i] for i in j] for j in cluster2[k]] for k in range(len(cluster2))]
 */
  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 580, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __pyx_v_dot_cluster1; __Pyx_INCREF(__pyx_t_2); __pyx_t_3 = 0;
  for (;;) {
    if (__pyx_t_3 >= PyList_GET_SIZE(__pyx_t_2)) break;
    #if CYTHON_COMPILING_IN_CPYTHON
    __pyx_t_6 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_3); __Pyx_INCREF(__pyx_t_6); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 580, __pyx_L1_error)
    #else
    __pyx_t_6 = PySequence_ITEM(__pyx_t_2, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 580, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    #endif
    __Pyx_XDECREF_SET(__pyx_v_j, __pyx_t_6);
    __pyx_t_6 = 0;
    __pyx_t_6 = PyList_New(0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 580, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    if (likely(PyList_CheckExact(__pyx_v_j)) || PyTuple_CheckExact(__pyx_v_j)) {
      __pyx_t_7 = __pyx_v_j; __Pyx_INCREF(__pyx_t_7); __pyx_t_8 = 0;
      __pyx_t_4 = NULL;
    } else {
      __pyx_t_8 = -1; __pyx_t_7 = PyObject_GetIter(__pyx_v_j); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 580, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_7);
      __pyx_t_4 = Py_TYPE(__pyx_t_7)->tp_iternext; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 580, __pyx_L1_error)
    }
    for (;;) {
      if (likely(!__pyx_t_4)) {
        if (likely(PyList_CheckExact(__pyx_t_7))) {
          if (__pyx_t_8 >= PyList_GET_SIZE(__pyx_t_7)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_5 = PyList_GET_ITEM(__pyx_t_7, __pyx_t_8); __Pyx_INCREF(__pyx_t_5); __pyx_t_8++; if (unlikely(0 < 0)) __PYX_ERR(0, 580, __pyx_L1_error)
          #else
          __pyx_t_5 = PySequence_ITEM(__pyx_t_7, __pyx_t_8); __pyx_t_8++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 580, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_5);
          #endif
        } else {
          if (__pyx_t_8 >= PyTuple_GET_SIZE(__pyx_t_7)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_5 = PyTuple_GET_ITEM(__pyx_t_7, __pyx_t_8); __Pyx_INCREF(__pyx_t_5); __pyx_t_8++; if (unlikely(0 < 0)) __PYX_ERR(0, 580, __pyx_L1_error)
          #else
          __pyx_t_5 = PySequence_ITEM(__pyx_t_7, __pyx_t_8); __pyx_t_8++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 580, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_5);
          #endif
        }
      } else {
        __pyx_t_5 = __pyx_t_4(__pyx_t_7);
        if (unlikely(!__pyx_t_5)) {
          PyObject* exc_type = PyErr_Occurred();
          if (exc_type) {
            if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
            else __PYX_ERR(0, 580, __pyx_L1_error)
          }
          break;
        }
        __Pyx_GOTREF(__pyx_t_5);
      }
      __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_5);
      __pyx_t_5 = 0;
      __pyx_t_5 = __Pyx_GetItemInt(__pyx_v_i, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 580, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_5);
      __pyx_t_10 = __Pyx_GetItemInt(__pyx_v_i, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 580, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_10);
      __pyx_t_11 = PyNumber_Add(__pyx_t_5, __pyx_t_10); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 580, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_11);
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
      __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
      if (unlikely(__Pyx_ListComp_Append(__pyx_t_6, (PyObject*)__pyx_t_11))) __PYX_ERR(0, 580, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
    }
    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
    if (unlikely(__Pyx_ListComp_Append(__pyx_t_1, (PyObject*)__pyx_t_6))) __PYX_ERR(0, 580, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  }
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_dis_to_anti_diagnal = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":581
 *     dot_cluster1=[[list_dotdata[i] for i in j] for j in cluster1]
 *     dis_to_anti_diagnal=[[i[1]+i[0] for i in j] for j in dot_cluster1]
 *     cluster2=[one_dimention_cluster_by_gap(i,gap,length) for i in dis_to_anti_diagnal]             # <<<<<<<<<<<<<<
 *     dot_cluster2=[ [[dot_cluster1[k][i] for i in j] for j in cluster2[k]] for k in range(len(cluster2))]
 *     out=[]
 */
  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 581, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __pyx_v_dis_to_anti_diagnal; __Pyx_INCREF(__pyx_t_2); __pyx_t_3 = 0;
  for (;;) {
    if (__pyx_t_3 >= PyList_GET_SIZE(__pyx_t_2)) break;
    #if CYTHON_COMPILING_IN_CPYTHON
    __pyx_t_6 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_3); __Pyx_INCREF(__pyx_t_6); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 581, __pyx_L1_error)
    #else
    __pyx_t_6 = PySequence_ITEM(__pyx_t_2, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 581, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    #endif
    __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_6);
    __pyx_t_6 = 0;
    __pyx_t_7 = __Pyx_GetModuleGlobalName(__pyx_n_s_one_dimention_cluster_by_gap); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 581, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    __pyx_t_11 = NULL;
    __pyx_t_8 = 0;
    if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_7))) {
      __pyx_t_11 = PyMethod_GET_SELF(__pyx_t_7);
      if (likely(__pyx_t_11)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_7);
        __Pyx_INCREF(__pyx_t_11);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_7, function);
        __pyx_t_8 = 1;
      }
    }
    __pyx_t_10 = PyTuple_New(3+__pyx_t_8); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 581, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_10);
    if (__pyx_t_11) {
      __Pyx_GIVEREF(__pyx_t_11); PyTuple_SET_ITEM(__pyx_t_10, 0, __pyx_t_11); __pyx_t_11 = NULL;
    }
    __Pyx_INCREF(__pyx_v_i);
    __Pyx_GIVEREF(__pyx_v_i);
    PyTuple_SET_ITEM(__pyx_t_10, 0+__pyx_t_8, __pyx_v_i);
    __Pyx_INCREF(__pyx_v_gap);
    __Pyx_GIVEREF(__pyx_v_gap);
    PyTuple_SET_ITEM(__pyx_t_10, 1+__pyx_t_8, __pyx_v_gap);
    __Pyx_INCREF(__pyx_v_length);
    __Pyx_GIVEREF(__pyx_v_length);
    PyTuple_SET_ITEM(__pyx_t_10, 2+__pyx_t_8, __pyx_v_length);
    __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_7, __pyx_t_10, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 581, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
    if (unlikely(__Pyx_ListComp_Append(__pyx_t_1, (PyObject*)__pyx_t_6))) __PYX_ERR(0, 581, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  }
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_cluster2 = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":582
 *     dis_to_anti_diagnal=[[i[1]+i[0] for i in j] for j in dot_cluster1]
 *     cluster2=[one_dimention_cluster_by_gap(i,gap,length) for i in dis_to_anti_diagnal]
 *     dot_cluster2=[ [[dot_cluster1[k][i] for i in j] for j in cluster2[k]] for k in range(len(cluster2))]             # <<<<<<<<<<<<<<
 *     out=[]
 *     for i in dot_cluster2:
 */
  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 582, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_3 = PyList_GET_SIZE(__pyx_v_cluster2); if (unlikely(__pyx_t_3 == -1)) __PYX_ERR(0, 582, __pyx_L1_error)
  for (__pyx_t_8 = 0; __pyx_t_8 < __pyx_t_3; __pyx_t_8+=1) {
    __pyx_v_k = __pyx_t_8;
    __pyx_t_2 = PyList_New(0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 582, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_6 = __Pyx_GetItemInt_List(__pyx_v_cluster2, __pyx_v_k, Py_ssize_t, 1, PyInt_FromSsize_t, 1, 1, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 582, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    if (likely(PyList_CheckExact(__pyx_t_6)) || PyTuple_CheckExact(__pyx_t_6)) {
      __pyx_t_7 = __pyx_t_6; __Pyx_INCREF(__pyx_t_7); __pyx_t_12 = 0;
      __pyx_t_4 = NULL;
    } else {
      __pyx_t_12 = -1; __pyx_t_7 = PyObject_GetIter(__pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 582, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_7);
      __pyx_t_4 = Py_TYPE(__pyx_t_7)->tp_iternext; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 582, __pyx_L1_error)
    }
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    for (;;) {
      if (likely(!__pyx_t_4)) {
        if (likely(PyList_CheckExact(__pyx_t_7))) {
          if (__pyx_t_12 >= PyList_GET_SIZE(__pyx_t_7)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_6 = PyList_GET_ITEM(__pyx_t_7, __pyx_t_12); __Pyx_INCREF(__pyx_t_6); __pyx_t_12++; if (unlikely(0 < 0)) __PYX_ERR(0, 582, __pyx_L1_error)
          #else
          __pyx_t_6 = PySequence_ITEM(__pyx_t_7, __pyx_t_12); __pyx_t_12++; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 582, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_6);
          #endif
        } else {
          if (__pyx_t_12 >= PyTuple_GET_SIZE(__pyx_t_7)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_6 = PyTuple_GET_ITEM(__pyx_t_7, __pyx_t_12); __Pyx_INCREF(__pyx_t_6); __pyx_t_12++; if (unlikely(0 < 0)) __PYX_ERR(0, 582, __pyx_L1_error)
          #else
          __pyx_t_6 = PySequence_ITEM(__pyx_t_7, __pyx_t_12); __pyx_t_12++; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 582, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_6);
          #endif
        }
      } else {
        __pyx_t_6 = __pyx_t_4(__pyx_t_7);
        if (unlikely(!__pyx_t_6)) {
          PyObject* exc_type = PyErr_Occurred();
          if (exc_type) {
            if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
            else __PYX_ERR(0, 582, __pyx_L1_error)
          }
          break;
        }
        __Pyx_GOTREF(__pyx_t_6);
      }
      __Pyx_XDECREF_SET(__pyx_v_j, __pyx_t_6);
      __pyx_t_6 = 0;
      __pyx_t_6 = PyList_New(0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 582, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_6);
      if (likely(PyList_CheckExact(__pyx_v_j)) || PyTuple_CheckExact(__pyx_v_j)) {
        __pyx_t_10 = __pyx_v_j; __Pyx_INCREF(__pyx_t_10); __pyx_t_13 = 0;
        __pyx_t_9 = NULL;
      } else {
        __pyx_t_13 = -1; __pyx_t_10 = PyObject_GetIter(__pyx_v_j); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 582, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_10);
        __pyx_t_9 = Py_TYPE(__pyx_t_10)->tp_iternext; if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 582, __pyx_L1_error)
      }
      for (;;) {
        if (likely(!__pyx_t_9)) {
          if (likely(PyList_CheckExact(__pyx_t_10))) {
            if (__pyx_t_13 >= PyList_GET_SIZE(__pyx_t_10)) break;
            #if CYTHON_COMPILING_IN_CPYTHON
            __pyx_t_11 = PyList_GET_ITEM(__pyx_t_10, __pyx_t_13); __Pyx_INCREF(__pyx_t_11); __pyx_t_13++; if (unlikely(0 < 0)) __PYX_ERR(0, 582, __pyx_L1_error)
            #else
            __pyx_t_11 = PySequence_ITEM(__pyx_t_10, __pyx_t_13); __pyx_t_13++; if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 582, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_11);
            #endif
          } else {
            if (__pyx_t_13 >= PyTuple_GET_SIZE(__pyx_t_10)) break;
            #if CYTHON_COMPILING_IN_CPYTHON
            __pyx_t_11 = PyTuple_GET_ITEM(__pyx_t_10, __pyx_t_13); __Pyx_INCREF(__pyx_t_11); __pyx_t_13++; if (unlikely(0 < 0)) __PYX_ERR(0, 582, __pyx_L1_error)
            #else
            __pyx_t_11 = PySequence_ITEM(__pyx_t_10, __pyx_t_13); __pyx_t_13++; if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 582, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_11);
            #endif
          }
        } else {
          __pyx_t_11 = __pyx_t_9(__pyx_t_10);
          if (unlikely(!__pyx_t_11)) {
            PyObject* exc_type = PyErr_Occurred();
            if (exc_type) {
              if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
              else __PYX_ERR(0, 582, __pyx_L1_error)
            }
            break;
          }
          __Pyx_GOTREF(__pyx_t_11);
        }
        __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_11);
        __pyx_t_11 = 0;
        __pyx_t_11 = __Pyx_GetItemInt_List(__pyx_v_dot_cluster1, __pyx_v_k, Py_ssize_t, 1, PyInt_FromSsize_t, 1, 1, 1); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 582, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_11);
        __pyx_t_5 = PyObject_GetItem(__pyx_t_11, __pyx_v_i); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 582, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_5);
        __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
        if (unlikely(__Pyx_ListComp_Append(__pyx_t_6, (PyObject*)__pyx_t_5))) __PYX_ERR(0, 582, __pyx_L1_error)
        __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
      }
      __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
      if (unlikely(__Pyx_ListComp_Append(__pyx_t_2, (PyObject*)__pyx_t_6))) __PYX_ERR(0, 582, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    }
    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
    if (unlikely(__Pyx_ListComp_Append(__pyx_t_1, (PyObject*)__pyx_t_2))) __PYX_ERR(0, 582, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  }
  __pyx_v_dot_cluster2 = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":583
 *     cluster2=[one_dimention_cluster_by_gap(i,gap,length) for i in dis_to_anti_diagnal]
 *     dot_cluster2=[ [[dot_cluster1[k][i] for i in j] for j in cluster2[k]] for k in range(len(cluster2))]
 *     out=[]             # <<<<<<<<<<<<<<
 *     for i in dot_cluster2:
 *         for j in i: out.append(j)
 */
  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 583, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_out = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":584
 *     dot_cluster2=[ [[dot_cluster1[k][i] for i in j] for j in cluster2[k]] for k in range(len(cluster2))]
 *     out=[]
 *     for i in dot_cluster2:             # <<<<<<<<<<<<<<
 *         for j in i: out.append(j)
 *     return [[i[0],i[-1]] for i in out]
 */
  __pyx_t_1 = __pyx_v_dot_cluster2; __Pyx_INCREF(__pyx_t_1); __pyx_t_3 = 0;
  for (;;) {
    if (__pyx_t_3 >= PyList_GET_SIZE(__pyx_t_1)) break;
    #if CYTHON_COMPILING_IN_CPYTHON
    __pyx_t_2 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_3); __Pyx_INCREF(__pyx_t_2); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 584, __pyx_L1_error)
    #else
    __pyx_t_2 = PySequence_ITEM(__pyx_t_1, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 584, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    #endif
    __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_2);
    __pyx_t_2 = 0;

    /* "vapor_vali/Simple_function.pyx":585
 *     out=[]
 *     for i in dot_cluster2:
 *         for j in i: out.append(j)             # <<<<<<<<<<<<<<
 *     return [[i[0],i[-1]] for i in out]
 * 
 */
    if (likely(PyList_CheckExact(__pyx_v_i)) || PyTuple_CheckExact(__pyx_v_i)) {
      __pyx_t_2 = __pyx_v_i; __Pyx_INCREF(__pyx_t_2); __pyx_t_8 = 0;
      __pyx_t_4 = NULL;
    } else {
      __pyx_t_8 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_v_i); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 585, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __pyx_t_4 = Py_TYPE(__pyx_t_2)->tp_iternext; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 585, __pyx_L1_error)
    }
    for (;;) {
      if (likely(!__pyx_t_4)) {
        if (likely(PyList_CheckExact(__pyx_t_2))) {
          if (__pyx_t_8 >= PyList_GET_SIZE(__pyx_t_2)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_7 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_8); __Pyx_INCREF(__pyx_t_7); __pyx_t_8++; if (unlikely(0 < 0)) __PYX_ERR(0, 585, __pyx_L1_error)
          #else
          __pyx_t_7 = PySequence_ITEM(__pyx_t_2, __pyx_t_8); __pyx_t_8++; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 585, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_7);
          #endif
        } else {
          if (__pyx_t_8 >= PyTuple_GET_SIZE(__pyx_t_2)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_7 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_8); __Pyx_INCREF(__pyx_t_7); __pyx_t_8++; if (unlikely(0 < 0)) __PYX_ERR(0, 585, __pyx_L1_error)
          #else
          __pyx_t_7 = PySequence_ITEM(__pyx_t_2, __pyx_t_8); __pyx_t_8++; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 585, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_7);
          #endif
        }
      } else {
        __pyx_t_7 = __pyx_t_4(__pyx_t_2);
        if (unlikely(!__pyx_t_7)) {
          PyObject* exc_type = PyErr_Occurred();
          if (exc_type) {
            if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
            else __PYX_ERR(0, 585, __pyx_L1_error)
          }
          break;
        }
        __Pyx_GOTREF(__pyx_t_7);
      }
      __Pyx_XDECREF_SET(__pyx_v_j, __pyx_t_7);
      __pyx_t_7 = 0;
      __pyx_t_14 = __Pyx_PyList_Append(__pyx_v_out, __pyx_v_j); if (unlikely(__pyx_t_14 == -1)) __PYX_ERR(0, 585, __pyx_L1_error)
    }
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

    /* "vapor_vali/Simple_function.pyx":584
 *     dot_cluster2=[ [[dot_cluster1[k][i] for i in j] for j in cluster2[k]] for k in range(len(cluster2))]
 *     out=[]
 *     for i in dot_cluster2:             # <<<<<<<<<<<<<<
 *         for j in i: out.append(j)
 *     return [[i[0],i[-1]] for i in out]
 */
  }
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":586
 *     for i in dot_cluster2:
 *         for j in i: out.append(j)
 *     return [[i[0],i[-1]] for i in out]             # <<<<<<<<<<<<<<
 * 
 * def dup_block_combine(dup_block,k1_hap,k2_hap):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 586, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __pyx_v_out; __Pyx_INCREF(__pyx_t_2); __pyx_t_3 = 0;
  for (;;) {
    if (__pyx_t_3 >= PyList_GET_SIZE(__pyx_t_2)) break;
    #if CYTHON_COMPILING_IN_CPYTHON
    __pyx_t_7 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_3); __Pyx_INCREF(__pyx_t_7); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 586, __pyx_L1_error)
    #else
    __pyx_t_7 = PySequence_ITEM(__pyx_t_2, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 586, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    #endif
    __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_7);
    __pyx_t_7 = 0;
    __pyx_t_7 = __Pyx_GetItemInt(__pyx_v_i, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 586, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    __pyx_t_6 = __Pyx_GetItemInt(__pyx_v_i, -1L, long, 1, __Pyx_PyInt_From_long, 0, 1, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 586, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __pyx_t_10 = PyList_New(2); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 586, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_10);
    __Pyx_GIVEREF(__pyx_t_7);
    PyList_SET_ITEM(__pyx_t_10, 0, __pyx_t_7);
    __Pyx_GIVEREF(__pyx_t_6);
    PyList_SET_ITEM(__pyx_t_10, 1, __pyx_t_6);
    __pyx_t_7 = 0;
    __pyx_t_6 = 0;
    if (unlikely(__Pyx_ListComp_Append(__pyx_t_1, (PyObject*)__pyx_t_10))) __PYX_ERR(0, 586, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
  }
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* "vapor_vali/Simple_function.pyx":575
 *     else:                   return 0
 * 
 * def dot_to_line(list_dotdata,gap=50,length=10):             # <<<<<<<<<<<<<<
 *     ####This function try to recognize lines in the dot plot
 *     dis_to_diagnal=[i[1]-i[0] for i in list_dotdata]
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_XDECREF(__pyx_t_7);
  __Pyx_XDECREF(__pyx_t_10);
  __Pyx_XDECREF(__pyx_t_11);
  __Pyx_AddTraceback("vapor_vali.Simple_function.dot_to_line", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_dis_to_diagnal);
  __Pyx_XDECREF(__pyx_v_cluster1);
  __Pyx_XDECREF(__pyx_v_dot_cluster1);
  __Pyx_XDECREF(__pyx_v_dis_to_anti_diagnal);
  __Pyx_XDECREF(__pyx_v_cluster2);
  __Pyx_XDECREF(__pyx_v_dot_cluster2);
  __Pyx_XDECREF(__pyx_v_out);
  __Pyx_XDECREF(__pyx_v_i);
  __Pyx_XDECREF(__pyx_v_j);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "vapor_vali/Simple_function.pyx":588
 *     return [[i[0],i[-1]] for i in out]
 * 
 * def dup_block_combine(dup_block,k1_hap,k2_hap):             # <<<<<<<<<<<<<<
 *     #eg of dup_block=['a', 'b'];     k1_hap='abcd'   ; k2_hap='abab'
 *     all_combines=[]
 */

/* Python wrapper */
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_75dup_block_combine(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_10vapor_vali_15Simple_function_75dup_block_combine = {"dup_block_combine", (PyCFunction)__pyx_pw_10vapor_vali_15Simple_function_75dup_block_combine, METH_VARARGS|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_75dup_block_combine(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_dup_block = 0;
  CYTHON_UNUSED PyObject *__pyx_v_k1_hap = 0;
  PyObject *__pyx_v_k2_hap = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("dup_block_combine (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_dup_block,&__pyx_n_s_k1_hap,&__pyx_n_s_k2_hap,0};
    PyObject* values[3] = {0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
      switch (pos_args) {
        case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_dup_block)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_k1_hap)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("dup_block_combine", 1, 3, 3, 1); __PYX_ERR(0, 588, __pyx_L3_error)
        }
        case  2:
        if (likely((values[2] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_k2_hap)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("dup_block_combine", 1, 3, 3, 2); __PYX_ERR(0, 588, __pyx_L3_error)
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "dup_block_combine") < 0)) __PYX_ERR(0, 588, __pyx_L3_error)
      }
    } else if (PyTuple_GET_SIZE(__pyx_args) != 3) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
    }
    __pyx_v_dup_block = values[0];
    __pyx_v_k1_hap = values[1];
    __pyx_v_k2_hap = values[2];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("dup_block_combine", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 588, __pyx_L3_error)
  __pyx_L3_error:;
  __Pyx_AddTraceback("vapor_vali.Simple_function.dup_block_combine", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_10vapor_vali_15Simple_function_74dup_block_combine(__pyx_self, __pyx_v_dup_block, __pyx_v_k1_hap, __pyx_v_k2_hap);

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10vapor_vali_15Simple_function_74dup_block_combine(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_dup_block, CYTHON_UNUSED PyObject *__pyx_v_k1_hap, PyObject *__pyx_v_k2_hap) {
  PyObject *__pyx_v_all_combines = NULL;
  PyObject *__pyx_v_x = NULL;
  PyObject *__pyx_v_kept_dup = NULL;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  Py_ssize_t __pyx_t_2;
  PyObject *__pyx_t_3 = NULL;
  PyObject *(*__pyx_t_4)(PyObject *);
  PyObject *__pyx_t_5 = NULL;
  PyObject *__pyx_t_6 = NULL;
  PyObject *__pyx_t_7 = NULL;
  PyObject *__pyx_t_8 = NULL;
  Py_ssize_t __pyx_t_9;
  PyObject *__pyx_t_10 = NULL;
  int __pyx_t_11;
  int __pyx_t_12;
  __Pyx_RefNannySetupContext("dup_block_combine", 0);

  /* "vapor_vali/Simple_function.pyx":590
 * def dup_block_combine(dup_block,k1_hap,k2_hap):
 *     #eg of dup_block=['a', 'b'];     k1_hap='abcd'   ; k2_hap='abab'
 *     all_combines=[]             # <<<<<<<<<<<<<<
 *     for x in range(len(dup_block)):
 *         all_combines+=[''.join(list(i)) for i in list(itertools.combinations(dup_block,x+1))]
 */
  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 590, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_all_combines = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":591
 *     #eg of dup_block=['a', 'b'];     k1_hap='abcd'   ; k2_hap='abab'
 *     all_combines=[]
 *     for x in range(len(dup_block)):             # <<<<<<<<<<<<<<
 *         all_combines+=[''.join(list(i)) for i in list(itertools.combinations(dup_block,x+1))]
 *     all_combines=dup_block_combined_qc(all_combines)
 */
  __pyx_t_2 = PyObject_Length(__pyx_v_dup_block); if (unlikely(__pyx_t_2 == -1)) __PYX_ERR(0, 591, __pyx_L1_error)
  __pyx_t_1 = PyInt_FromSsize_t(__pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 591, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 591, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_GIVEREF(__pyx_t_1);
  PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_t_3, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 591, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  if (likely(PyList_CheckExact(__pyx_t_1)) || PyTuple_CheckExact(__pyx_t_1)) {
    __pyx_t_3 = __pyx_t_1; __Pyx_INCREF(__pyx_t_3); __pyx_t_2 = 0;
    __pyx_t_4 = NULL;
  } else {
    __pyx_t_2 = -1; __pyx_t_3 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 591, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_4 = Py_TYPE(__pyx_t_3)->tp_iternext; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 591, __pyx_L1_error)
  }
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  for (;;) {
    if (likely(!__pyx_t_4)) {
      if (likely(PyList_CheckExact(__pyx_t_3))) {
        if (__pyx_t_2 >= PyList_GET_SIZE(__pyx_t_3)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_1 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_2); __Pyx_INCREF(__pyx_t_1); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 591, __pyx_L1_error)
        #else
        __pyx_t_1 = PySequence_ITEM(__pyx_t_3, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 591, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        #endif
      } else {
        if (__pyx_t_2 >= PyTuple_GET_SIZE(__pyx_t_3)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_2); __Pyx_INCREF(__pyx_t_1); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 591, __pyx_L1_error)
        #else
        __pyx_t_1 = PySequence_ITEM(__pyx_t_3, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 591, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        #endif
      }
    } else {
      __pyx_t_1 = __pyx_t_4(__pyx_t_3);
      if (unlikely(!__pyx_t_1)) {
        PyObject* exc_type = PyErr_Occurred();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
          else __PYX_ERR(0, 591, __pyx_L1_error)
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_1);
    }
    __Pyx_XDECREF_SET(__pyx_v_x, __pyx_t_1);
    __pyx_t_1 = 0;

    /* "vapor_vali/Simple_function.pyx":592
 *     all_combines=[]
 *     for x in range(len(dup_block)):
 *         all_combines+=[''.join(list(i)) for i in list(itertools.combinations(dup_block,x+1))]             # <<<<<<<<<<<<<<
 *     all_combines=dup_block_combined_qc(all_combines)
 *     kept_dup=[]
 */
    __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 592, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_6 = __Pyx_GetModuleGlobalName(__pyx_n_s_itertools); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 592, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_combinations); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 592, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = __Pyx_PyInt_AddObjC(__pyx_v_x, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 592, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __pyx_t_8 = NULL;
    __pyx_t_9 = 0;
    if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_7))) {
      __pyx_t_8 = PyMethod_GET_SELF(__pyx_t_7);
      if (likely(__pyx_t_8)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_7);
        __Pyx_INCREF(__pyx_t_8);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_7, function);
        __pyx_t_9 = 1;
      }
    }
    __pyx_t_10 = PyTuple_New(2+__pyx_t_9); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 592, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_10);
    if (__pyx_t_8) {
      __Pyx_GIVEREF(__pyx_t_8); PyTuple_SET_ITEM(__pyx_t_10, 0, __pyx_t_8); __pyx_t_8 = NULL;
    }
    __Pyx_INCREF(__pyx_v_dup_block);
    __Pyx_GIVEREF(__pyx_v_dup_block);
    PyTuple_SET_ITEM(__pyx_t_10, 0+__pyx_t_9, __pyx_v_dup_block);
    __Pyx_GIVEREF(__pyx_t_6);
    PyTuple_SET_ITEM(__pyx_t_10, 1+__pyx_t_9, __pyx_t_6);
    __pyx_t_6 = 0;
    __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_7, __pyx_t_10, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 592, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_t_7 = PySequence_List(__pyx_t_5); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 592, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = __pyx_t_7; __Pyx_INCREF(__pyx_t_5); __pyx_t_9 = 0;
    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
    for (;;) {
      if (__pyx_t_9 >= PyList_GET_SIZE(__pyx_t_5)) break;
      #if CYTHON_COMPILING_IN_CPYTHON
      __pyx_t_7 = PyList_GET_ITEM(__pyx_t_5, __pyx_t_9); __Pyx_INCREF(__pyx_t_7); __pyx_t_9++; if (unlikely(0 < 0)) __PYX_ERR(0, 592, __pyx_L1_error)
      #else
      __pyx_t_7 = PySequence_ITEM(__pyx_t_5, __pyx_t_9); __pyx_t_9++; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 592, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_7);
      #endif
      __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_7);
      __pyx_t_7 = 0;
      __pyx_t_7 = PySequence_List(__pyx_v_i); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 592, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_7);
      __pyx_t_10 = __Pyx_PyString_Join(__pyx_kp_s__24, __pyx_t_7); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 592, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_10);
      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
      if (unlikely(__Pyx_ListComp_Append(__pyx_t_1, (PyObject*)__pyx_t_10))) __PYX_ERR(0, 592, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
    }
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = PyNumber_InPlaceAdd(__pyx_v_all_combines, __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 592, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __Pyx_DECREF_SET(__pyx_v_all_combines, __pyx_t_5);
    __pyx_t_5 = 0;

    /* "vapor_vali/Simple_function.pyx":591
 *     #eg of dup_block=['a', 'b'];     k1_hap='abcd'   ; k2_hap='abab'
 *     all_combines=[]
 *     for x in range(len(dup_block)):             # <<<<<<<<<<<<<<
 *         all_combines+=[''.join(list(i)) for i in list(itertools.combinations(dup_block,x+1))]
 *     all_combines=dup_block_combined_qc(all_combines)
 */
  }
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;

  /* "vapor_vali/Simple_function.pyx":593
 *     for x in range(len(dup_block)):
 *         all_combines+=[''.join(list(i)) for i in list(itertools.combinations(dup_block,x+1))]
 *     all_combines=dup_block_combined_qc(all_combines)             # <<<<<<<<<<<<<<
 *     kept_dup=[]
 *     for x in all_combines[::-1]:
 */
  __pyx_t_5 = __Pyx_GetModuleGlobalName(__pyx_n_s_dup_block_combined_qc); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 593, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_1 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_5))) {
    __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_5);
    if (likely(__pyx_t_1)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
      __Pyx_INCREF(__pyx_t_1);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_5, function);
    }
  }
  if (!__pyx_t_1) {
    __pyx_t_3 = __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_v_all_combines); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 593, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
  } else {
    __pyx_t_10 = PyTuple_New(1+1); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 593, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_10);
    __Pyx_GIVEREF(__pyx_t_1); PyTuple_SET_ITEM(__pyx_t_10, 0, __pyx_t_1); __pyx_t_1 = NULL;
    __Pyx_INCREF(__pyx_v_all_combines);
    __Pyx_GIVEREF(__pyx_v_all_combines);
    PyTuple_SET_ITEM(__pyx_t_10, 0+1, __pyx_v_all_combines);
    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_10, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 593, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
  }
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __Pyx_DECREF_SET(__pyx_v_all_combines, __pyx_t_3);
  __pyx_t_3 = 0;

  /* "vapor_vali/Simple_function.pyx":594
 *         all_combines+=[''.join(list(i)) for i in list(itertools.combinations(dup_block,x+1))]
 *     all_combines=dup_block_combined_qc(all_combines)
 *     kept_dup=[]             # <<<<<<<<<<<<<<
 *     for x in all_combines[::-1]:
 *         if k2_hap.count(x)>1:
 */
  __pyx_t_3 = PyList_New(0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 594, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_v_kept_dup = ((PyObject*)__pyx_t_3);
  __pyx_t_3 = 0;

  /* "vapor_vali/Simple_function.pyx":595
 *     all_combines=dup_block_combined_qc(all_combines)
 *     kept_dup=[]
 *     for x in all_combines[::-1]:             # <<<<<<<<<<<<<<
 *         if k2_hap.count(x)>1:
 *             kept_dup.append(x)
 */
  __pyx_t_3 = PyObject_GetItem(__pyx_v_all_combines, __pyx_slice__35); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 595, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  if (likely(PyList_CheckExact(__pyx_t_3)) || PyTuple_CheckExact(__pyx_t_3)) {
    __pyx_t_5 = __pyx_t_3; __Pyx_INCREF(__pyx_t_5); __pyx_t_2 = 0;
    __pyx_t_4 = NULL;
  } else {
    __pyx_t_2 = -1; __pyx_t_5 = PyObject_GetIter(__pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 595, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __pyx_t_4 = Py_TYPE(__pyx_t_5)->tp_iternext; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 595, __pyx_L1_error)
  }
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  for (;;) {
    if (likely(!__pyx_t_4)) {
      if (likely(PyList_CheckExact(__pyx_t_5))) {
        if (__pyx_t_2 >= PyList_GET_SIZE(__pyx_t_5)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_3 = PyList_GET_ITEM(__pyx_t_5, __pyx_t_2); __Pyx_INCREF(__pyx_t_3); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 595, __pyx_L1_error)
        #else
        __pyx_t_3 = PySequence_ITEM(__pyx_t_5, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 595, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_3);
        #endif
      } else {
        if (__pyx_t_2 >= PyTuple_GET_SIZE(__pyx_t_5)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_3 = PyTuple_GET_ITEM(__pyx_t_5, __pyx_t_2); __Pyx_INCREF(__pyx_t_3); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 595, __pyx_L1_error)
        #else
        __pyx_t_3 = PySequence_ITEM(__pyx_t_5, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 595, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_3);
        #endif
      }
    } else {
      __pyx_t_3 = __pyx_t_4(__pyx_t_5);
      if (unlikely(!__pyx_t_3)) {
        PyObject* exc_type = PyErr_Occurred();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
          else __PYX_ERR(0, 595, __pyx_L1_error)
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_3);
    }
    __Pyx_XDECREF_SET(__pyx_v_x, __pyx_t_3);
    __pyx_t_3 = 0;

    /* "vapor_vali/Simple_function.pyx":596
 *     kept_dup=[]
 *     for x in all_combines[::-1]:
 *         if k2_hap.count(x)>1:             # <<<<<<<<<<<<<<
 *             kept_dup.append(x)
 *     return dup_block_kept_qc(kept_dup)[::-1]
 */
    __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_v_k2_hap, __pyx_n_s_count); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 596, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_10);
    __pyx_t_1 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_10))) {
      __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_10);
      if (likely(__pyx_t_1)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_10);
        __Pyx_INCREF(__pyx_t_1);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_10, function);
      }
    }
    if (!__pyx_t_1) {
      __pyx_t_3 = __Pyx_PyObject_CallOneArg(__pyx_t_10, __pyx_v_x); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 596, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
    } else {
      __pyx_t_7 = PyTuple_New(1+1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 596, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_7);
      __Pyx_GIVEREF(__pyx_t_1); PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_1); __pyx_t_1 = NULL;
      __Pyx_INCREF(__pyx_v_x);
      __Pyx_GIVEREF(__pyx_v_x);
      PyTuple_SET_ITEM(__pyx_t_7, 0+1, __pyx_v_x);
      __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_10, __pyx_t_7, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 596, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
    }
    __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
    __pyx_t_10 = PyObject_RichCompare(__pyx_t_3, __pyx_int_1, Py_GT); __Pyx_XGOTREF(__pyx_t_10); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 596, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_11 = __Pyx_PyObject_IsTrue(__pyx_t_10); if (unlikely(__pyx_t_11 < 0)) __PYX_ERR(0, 596, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
    if (__pyx_t_11) {

      /* "vapor_vali/Simple_function.pyx":597
 *     for x in all_combines[::-1]:
 *         if k2_hap.count(x)>1:
 *             kept_dup.append(x)             # <<<<<<<<<<<<<<
 *     return dup_block_kept_qc(kept_dup)[::-1]
 * 
 */
      __pyx_t_12 = __Pyx_PyList_Append(__pyx_v_kept_dup, __pyx_v_x); if (unlikely(__pyx_t_12 == -1)) __PYX_ERR(0, 597, __pyx_L1_error)

      /* "vapor_vali/Simple_function.pyx":596
 *     kept_dup=[]
 *     for x in all_combines[::-1]:
 *         if k2_hap.count(x)>1:             # <<<<<<<<<<<<<<
 *             kept_dup.append(x)
 *     return dup_block_kept_qc(kept_dup)[::-1]
 */
    }

    /* "vapor_vali/Simple_function.pyx":595
 *     all_combines=dup_block_combined_qc(all_combines)
 *     kept_dup=[]
 *     for x in all_combines[::-1]:             # <<<<<<<<<<<<<<
 *         if k2_hap.count(x)>1:
 *             kept_dup.append(x)
 */
  }
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;

  /* "vapor_vali/Simple_function.pyx":598
 *         if k2_hap.count(x)>1:
 *             kept_dup.append(x)
 *     return dup_block_kept_qc(kept_dup)[::-1]             # <<<<<<<<<<<<<<
 * 
 * def dup_block_combined_qc(all_combines):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_10 = __Pyx_GetModuleGlobalName(__pyx_n_s_dup_block_kept_qc); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 598, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_10);
  __pyx_t_3 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_10))) {
    __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_10);
    if (likely(__pyx_t_3)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_10);
      __Pyx_INCREF(__pyx_t_3);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_10, function);
    }
  }
  if (!__pyx_t_3) {
    __pyx_t_5 = __Pyx_PyObject_CallOneArg(__pyx_t_10, __pyx_v_kept_dup); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 598, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
  } else {
    __pyx_t_7 = PyTuple_New(1+1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 598, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    __Pyx_GIVEREF(__pyx_t_3); PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_3); __pyx_t_3 = NULL;
    __Pyx_INCREF(__pyx_v_kept_dup);
    __Pyx_GIVEREF(__pyx_v_kept_dup);
    PyTuple_SET_ITEM(__pyx_t_7, 0+1, __pyx_v_kept_dup);
    __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_10, __pyx_t_7, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 598, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
  }
  __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
  __pyx_t_10 = PyObject_GetItem(__pyx_t_5, __pyx_slice__36); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 598, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_10);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_r = __pyx_t_10;
  __pyx_t_10 = 0;
  goto __pyx_L0;

  /* "vapor_vali/Simple_function.pyx":588
 *     return [[i[0],i[-1]] for i in out]
 * 
 * def dup_block_combine(dup_block,k1_hap,k2_hap):             # <<<<<<<<<<<<<<
 *     #eg of dup_block=['a', 'b'];     k1_hap='abcd'   ; k2_hap='abab'
 *     all_combines=[]
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_XDECREF(__pyx_t_7);
  __Pyx_XDECREF(__pyx_t_8);
  __Pyx_XDECREF(__pyx_t_10);
  __Pyx_AddTraceback("vapor_vali.Simple_function.dup_block_combine", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_all_combines);
  __Pyx_XDECREF(__pyx_v_x);
  __Pyx_XDECREF(__pyx_v_kept_dup);
  __Pyx_XDECREF(__pyx_v_i);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "vapor_vali/Simple_function.pyx":600
 *     return dup_block_kept_qc(kept_dup)[::-1]
 * 
 * def dup_block_combined_qc(all_combines):             # <<<<<<<<<<<<<<
 *     #eg of all_combines=['a', 'b', 'c', 'd', 'ab', 'ac', 'ad', 'bc', 'bd', 'cd', 'abc', 'abd', 'acd', 'bcd', 'abcd']
 *     out=[]
 */

/* Python wrapper */
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_77dup_block_combined_qc(PyObject *__pyx_self, PyObject *__pyx_v_all_combines); /*proto*/
static PyMethodDef __pyx_mdef_10vapor_vali_15Simple_function_77dup_block_combined_qc = {"dup_block_combined_qc", (PyCFunction)__pyx_pw_10vapor_vali_15Simple_function_77dup_block_combined_qc, METH_O, 0};
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_77dup_block_combined_qc(PyObject *__pyx_self, PyObject *__pyx_v_all_combines) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("dup_block_combined_qc (wrapper)", 0);
  __pyx_r = __pyx_pf_10vapor_vali_15Simple_function_76dup_block_combined_qc(__pyx_self, ((PyObject *)__pyx_v_all_combines));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10vapor_vali_15Simple_function_76dup_block_combined_qc(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_all_combines) {
  PyObject *__pyx_v_out = NULL;
  PyObject *__pyx_v_x = NULL;
  PyObject *__pyx_v_temp = NULL;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  Py_ssize_t __pyx_t_2;
  PyObject *(*__pyx_t_3)(PyObject *);
  PyObject *__pyx_t_4 = NULL;
  Py_ssize_t __pyx_t_5;
  int __pyx_t_6;
  int __pyx_t_7;
  PyObject *__pyx_t_8 = NULL;
  PyObject *(*__pyx_t_9)(PyObject *);
  PyObject *__pyx_t_10 = NULL;
  long __pyx_t_11;
  PyObject *__pyx_t_12 = NULL;
  __Pyx_RefNannySetupContext("dup_block_combined_qc", 0);

  /* "vapor_vali/Simple_function.pyx":602
 * def dup_block_combined_qc(all_combines):
 *     #eg of all_combines=['a', 'b', 'c', 'd', 'ab', 'ac', 'ad', 'bc', 'bd', 'cd', 'abc', 'abd', 'acd', 'bcd', 'abcd']
 *     out=[]             # <<<<<<<<<<<<<<
 *     for x in all_combines:
 *         if len(x)==1:   out.append(x)
 */
  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 602, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_out = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":603
 *     #eg of all_combines=['a', 'b', 'c', 'd', 'ab', 'ac', 'ad', 'bc', 'bd', 'cd', 'abc', 'abd', 'acd', 'bcd', 'abcd']
 *     out=[]
 *     for x in all_combines:             # <<<<<<<<<<<<<<
 *         if len(x)==1:   out.append(x)
 *         else:
 */
  if (likely(PyList_CheckExact(__pyx_v_all_combines)) || PyTuple_CheckExact(__pyx_v_all_combines)) {
    __pyx_t_1 = __pyx_v_all_combines; __Pyx_INCREF(__pyx_t_1); __pyx_t_2 = 0;
    __pyx_t_3 = NULL;
  } else {
    __pyx_t_2 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_v_all_combines); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 603, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_3 = Py_TYPE(__pyx_t_1)->tp_iternext; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 603, __pyx_L1_error)
  }
  for (;;) {
    if (likely(!__pyx_t_3)) {
      if (likely(PyList_CheckExact(__pyx_t_1))) {
        if (__pyx_t_2 >= PyList_GET_SIZE(__pyx_t_1)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_4 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_4); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 603, __pyx_L1_error)
        #else
        __pyx_t_4 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 603, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_4);
        #endif
      } else {
        if (__pyx_t_2 >= PyTuple_GET_SIZE(__pyx_t_1)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_4 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_4); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 603, __pyx_L1_error)
        #else
        __pyx_t_4 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 603, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_4);
        #endif
      }
    } else {
      __pyx_t_4 = __pyx_t_3(__pyx_t_1);
      if (unlikely(!__pyx_t_4)) {
        PyObject* exc_type = PyErr_Occurred();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
          else __PYX_ERR(0, 603, __pyx_L1_error)
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_4);
    }
    __Pyx_XDECREF_SET(__pyx_v_x, __pyx_t_4);
    __pyx_t_4 = 0;

    /* "vapor_vali/Simple_function.pyx":604
 *     out=[]
 *     for x in all_combines:
 *         if len(x)==1:   out.append(x)             # <<<<<<<<<<<<<<
 *         else:
 *             temp=[ord(i) for i in x]
 */
    __pyx_t_5 = PyObject_Length(__pyx_v_x); if (unlikely(__pyx_t_5 == -1)) __PYX_ERR(0, 604, __pyx_L1_error)
    __pyx_t_6 = ((__pyx_t_5 == 1) != 0);
    if (__pyx_t_6) {
      __pyx_t_7 = __Pyx_PyList_Append(__pyx_v_out, __pyx_v_x); if (unlikely(__pyx_t_7 == -1)) __PYX_ERR(0, 604, __pyx_L1_error)
      goto __pyx_L5;
    }

    /* "vapor_vali/Simple_function.pyx":606
 *         if len(x)==1:   out.append(x)
 *         else:
 *             temp=[ord(i) for i in x]             # <<<<<<<<<<<<<<
 *             if interval_dis_calcu_max(temp)>1: continue
 *             else:   out.append(x)
 */
    /*else*/ {
      __pyx_t_4 = PyList_New(0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 606, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      if (likely(PyList_CheckExact(__pyx_v_x)) || PyTuple_CheckExact(__pyx_v_x)) {
        __pyx_t_8 = __pyx_v_x; __Pyx_INCREF(__pyx_t_8); __pyx_t_5 = 0;
        __pyx_t_9 = NULL;
      } else {
        __pyx_t_5 = -1; __pyx_t_8 = PyObject_GetIter(__pyx_v_x); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 606, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_8);
        __pyx_t_9 = Py_TYPE(__pyx_t_8)->tp_iternext; if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 606, __pyx_L1_error)
      }
      for (;;) {
        if (likely(!__pyx_t_9)) {
          if (likely(PyList_CheckExact(__pyx_t_8))) {
            if (__pyx_t_5 >= PyList_GET_SIZE(__pyx_t_8)) break;
            #if CYTHON_COMPILING_IN_CPYTHON
            __pyx_t_10 = PyList_GET_ITEM(__pyx_t_8, __pyx_t_5); __Pyx_INCREF(__pyx_t_10); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 606, __pyx_L1_error)
            #else
            __pyx_t_10 = PySequence_ITEM(__pyx_t_8, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 606, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_10);
            #endif
          } else {
            if (__pyx_t_5 >= PyTuple_GET_SIZE(__pyx_t_8)) break;
            #if CYTHON_COMPILING_IN_CPYTHON
            __pyx_t_10 = PyTuple_GET_ITEM(__pyx_t_8, __pyx_t_5); __Pyx_INCREF(__pyx_t_10); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 606, __pyx_L1_error)
            #else
            __pyx_t_10 = PySequence_ITEM(__pyx_t_8, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 606, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_10);
            #endif
          }
        } else {
          __pyx_t_10 = __pyx_t_9(__pyx_t_8);
          if (unlikely(!__pyx_t_10)) {
            PyObject* exc_type = PyErr_Occurred();
            if (exc_type) {
              if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
              else __PYX_ERR(0, 606, __pyx_L1_error)
            }
            break;
          }
          __Pyx_GOTREF(__pyx_t_10);
        }
        __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_10);
        __pyx_t_10 = 0;
        __pyx_t_11 = __Pyx_PyObject_Ord(__pyx_v_i); if (unlikely(__pyx_t_11 == (long)(Py_UCS4)-1)) __PYX_ERR(0, 606, __pyx_L1_error)
        __pyx_t_10 = __Pyx_PyInt_From_long(__pyx_t_11); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 606, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_10);
        if (unlikely(__Pyx_ListComp_Append(__pyx_t_4, (PyObject*)__pyx_t_10))) __PYX_ERR(0, 606, __pyx_L1_error)
        __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
      }
      __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
      __Pyx_XDECREF_SET(__pyx_v_temp, ((PyObject*)__pyx_t_4));
      __pyx_t_4 = 0;

      /* "vapor_vali/Simple_function.pyx":607
 *         else:
 *             temp=[ord(i) for i in x]
 *             if interval_dis_calcu_max(temp)>1: continue             # <<<<<<<<<<<<<<
 *             else:   out.append(x)
 *     return out
 */
      __pyx_t_8 = __Pyx_GetModuleGlobalName(__pyx_n_s_interval_dis_calcu_max); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 607, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_8);
      __pyx_t_10 = NULL;
      if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_8))) {
        __pyx_t_10 = PyMethod_GET_SELF(__pyx_t_8);
        if (likely(__pyx_t_10)) {
          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_8);
          __Pyx_INCREF(__pyx_t_10);
          __Pyx_INCREF(function);
          __Pyx_DECREF_SET(__pyx_t_8, function);
        }
      }
      if (!__pyx_t_10) {
        __pyx_t_4 = __Pyx_PyObject_CallOneArg(__pyx_t_8, __pyx_v_temp); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 607, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_4);
      } else {
        __pyx_t_12 = PyTuple_New(1+1); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 607, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_12);
        __Pyx_GIVEREF(__pyx_t_10); PyTuple_SET_ITEM(__pyx_t_12, 0, __pyx_t_10); __pyx_t_10 = NULL;
        __Pyx_INCREF(__pyx_v_temp);
        __Pyx_GIVEREF(__pyx_v_temp);
        PyTuple_SET_ITEM(__pyx_t_12, 0+1, __pyx_v_temp);
        __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_8, __pyx_t_12, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 607, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_4);
        __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
      }
      __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
      __pyx_t_8 = PyObject_RichCompare(__pyx_t_4, __pyx_int_1, Py_GT); __Pyx_XGOTREF(__pyx_t_8); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 607, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_8); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 607, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
      if (__pyx_t_6) {
        goto __pyx_L3_continue;
      }

      /* "vapor_vali/Simple_function.pyx":608
 *             temp=[ord(i) for i in x]
 *             if interval_dis_calcu_max(temp)>1: continue
 *             else:   out.append(x)             # <<<<<<<<<<<<<<
 *     return out
 * 
 */
      /*else*/ {
        __pyx_t_7 = __Pyx_PyList_Append(__pyx_v_out, __pyx_v_x); if (unlikely(__pyx_t_7 == -1)) __PYX_ERR(0, 608, __pyx_L1_error)
      }
    }
    __pyx_L5:;

    /* "vapor_vali/Simple_function.pyx":603
 *     #eg of all_combines=['a', 'b', 'c', 'd', 'ab', 'ac', 'ad', 'bc', 'bd', 'cd', 'abc', 'abd', 'acd', 'bcd', 'abcd']
 *     out=[]
 *     for x in all_combines:             # <<<<<<<<<<<<<<
 *         if len(x)==1:   out.append(x)
 *         else:
 */
    __pyx_L3_continue:;
  }
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":609
 *             if interval_dis_calcu_max(temp)>1: continue
 *             else:   out.append(x)
 *     return out             # <<<<<<<<<<<<<<
 * 
 * def dup_block_kept_qc(kept_dup):
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_out);
  __pyx_r = __pyx_v_out;
  goto __pyx_L0;

  /* "vapor_vali/Simple_function.pyx":600
 *     return dup_block_kept_qc(kept_dup)[::-1]
 * 
 * def dup_block_combined_qc(all_combines):             # <<<<<<<<<<<<<<
 *     #eg of all_combines=['a', 'b', 'c', 'd', 'ab', 'ac', 'ad', 'bc', 'bd', 'cd', 'abc', 'abd', 'acd', 'bcd', 'abcd']
 *     out=[]
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_8);
  __Pyx_XDECREF(__pyx_t_10);
  __Pyx_XDECREF(__pyx_t_12);
  __Pyx_AddTraceback("vapor_vali.Simple_function.dup_block_combined_qc", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_out);
  __Pyx_XDECREF(__pyx_v_x);
  __Pyx_XDECREF(__pyx_v_temp);
  __Pyx_XDECREF(__pyx_v_i);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "vapor_vali/Simple_function.pyx":611
 *     return out
 * 
 * def dup_block_kept_qc(kept_dup):             # <<<<<<<<<<<<<<
 *     #eg of kept_dup:
 *     out=[]
 */

/* Python wrapper */
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_79dup_block_kept_qc(PyObject *__pyx_self, PyObject *__pyx_v_kept_dup); /*proto*/
static PyMethodDef __pyx_mdef_10vapor_vali_15Simple_function_79dup_block_kept_qc = {"dup_block_kept_qc", (PyCFunction)__pyx_pw_10vapor_vali_15Simple_function_79dup_block_kept_qc, METH_O, 0};
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_79dup_block_kept_qc(PyObject *__pyx_self, PyObject *__pyx_v_kept_dup) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("dup_block_kept_qc (wrapper)", 0);
  __pyx_r = __pyx_pf_10vapor_vali_15Simple_function_78dup_block_kept_qc(__pyx_self, ((PyObject *)__pyx_v_kept_dup));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10vapor_vali_15Simple_function_78dup_block_kept_qc(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_kept_dup) {
  PyObject *__pyx_v_out = NULL;
  PyObject *__pyx_v_y = NULL;
  PyObject *__pyx_v_flag_y = NULL;
  PyObject *__pyx_v_z = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  Py_ssize_t __pyx_t_2;
  int __pyx_t_3;
  int __pyx_t_4;
  PyObject *__pyx_t_5 = NULL;
  PyObject *(*__pyx_t_6)(PyObject *);
  Py_ssize_t __pyx_t_7;
  PyObject *__pyx_t_8 = NULL;
  int __pyx_t_9;
  __Pyx_RefNannySetupContext("dup_block_kept_qc", 0);

  /* "vapor_vali/Simple_function.pyx":613
 * def dup_block_kept_qc(kept_dup):
 *     #eg of kept_dup:
 *     out=[]             # <<<<<<<<<<<<<<
 *     if len(kept_dup)>0:
 *         out.append(kept_dup[0])
 */
  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 613, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_out = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":614
 *     #eg of kept_dup:
 *     out=[]
 *     if len(kept_dup)>0:             # <<<<<<<<<<<<<<
 *         out.append(kept_dup[0])
 *         for y in kept_dup[1:]:
 */
  __pyx_t_2 = PyObject_Length(__pyx_v_kept_dup); if (unlikely(__pyx_t_2 == -1)) __PYX_ERR(0, 614, __pyx_L1_error)
  __pyx_t_3 = ((__pyx_t_2 > 0) != 0);
  if (__pyx_t_3) {

    /* "vapor_vali/Simple_function.pyx":615
 *     out=[]
 *     if len(kept_dup)>0:
 *         out.append(kept_dup[0])             # <<<<<<<<<<<<<<
 *         for y in kept_dup[1:]:
 *             flag_y=0
 */
    __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_kept_dup, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 615, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_4 = __Pyx_PyList_Append(__pyx_v_out, __pyx_t_1); if (unlikely(__pyx_t_4 == -1)) __PYX_ERR(0, 615, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "vapor_vali/Simple_function.pyx":616
 *     if len(kept_dup)>0:
 *         out.append(kept_dup[0])
 *         for y in kept_dup[1:]:             # <<<<<<<<<<<<<<
 *             flag_y=0
 *             for z in out:
 */
    __pyx_t_1 = __Pyx_PyObject_GetSlice(__pyx_v_kept_dup, 1, 0, NULL, NULL, &__pyx_slice__37, 1, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 616, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    if (likely(PyList_CheckExact(__pyx_t_1)) || PyTuple_CheckExact(__pyx_t_1)) {
      __pyx_t_5 = __pyx_t_1; __Pyx_INCREF(__pyx_t_5); __pyx_t_2 = 0;
      __pyx_t_6 = NULL;
    } else {
      __pyx_t_2 = -1; __pyx_t_5 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 616, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_5);
      __pyx_t_6 = Py_TYPE(__pyx_t_5)->tp_iternext; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 616, __pyx_L1_error)
    }
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    for (;;) {
      if (likely(!__pyx_t_6)) {
        if (likely(PyList_CheckExact(__pyx_t_5))) {
          if (__pyx_t_2 >= PyList_GET_SIZE(__pyx_t_5)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_1 = PyList_GET_ITEM(__pyx_t_5, __pyx_t_2); __Pyx_INCREF(__pyx_t_1); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 616, __pyx_L1_error)
          #else
          __pyx_t_1 = PySequence_ITEM(__pyx_t_5, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 616, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_1);
          #endif
        } else {
          if (__pyx_t_2 >= PyTuple_GET_SIZE(__pyx_t_5)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_5, __pyx_t_2); __Pyx_INCREF(__pyx_t_1); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 616, __pyx_L1_error)
          #else
          __pyx_t_1 = PySequence_ITEM(__pyx_t_5, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 616, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_1);
          #endif
        }
      } else {
        __pyx_t_1 = __pyx_t_6(__pyx_t_5);
        if (unlikely(!__pyx_t_1)) {
          PyObject* exc_type = PyErr_Occurred();
          if (exc_type) {
            if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
            else __PYX_ERR(0, 616, __pyx_L1_error)
          }
          break;
        }
        __Pyx_GOTREF(__pyx_t_1);
      }
      __Pyx_XDECREF_SET(__pyx_v_y, __pyx_t_1);
      __pyx_t_1 = 0;

      /* "vapor_vali/Simple_function.pyx":617
 *         out.append(kept_dup[0])
 *         for y in kept_dup[1:]:
 *             flag_y=0             # <<<<<<<<<<<<<<
 *             for z in out:
 *                 if y in z:  flag_y+=1
 */
      __Pyx_INCREF(__pyx_int_0);
      __Pyx_XDECREF_SET(__pyx_v_flag_y, __pyx_int_0);

      /* "vapor_vali/Simple_function.pyx":618
 *         for y in kept_dup[1:]:
 *             flag_y=0
 *             for z in out:             # <<<<<<<<<<<<<<
 *                 if y in z:  flag_y+=1
 *             if flag_y==0:   out.append(y)
 */
      __pyx_t_1 = __pyx_v_out; __Pyx_INCREF(__pyx_t_1); __pyx_t_7 = 0;
      for (;;) {
        if (__pyx_t_7 >= PyList_GET_SIZE(__pyx_t_1)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_8 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_7); __Pyx_INCREF(__pyx_t_8); __pyx_t_7++; if (unlikely(0 < 0)) __PYX_ERR(0, 618, __pyx_L1_error)
        #else
        __pyx_t_8 = PySequence_ITEM(__pyx_t_1, __pyx_t_7); __pyx_t_7++; if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 618, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_8);
        #endif
        __Pyx_XDECREF_SET(__pyx_v_z, __pyx_t_8);
        __pyx_t_8 = 0;

        /* "vapor_vali/Simple_function.pyx":619
 *             flag_y=0
 *             for z in out:
 *                 if y in z:  flag_y+=1             # <<<<<<<<<<<<<<
 *             if flag_y==0:   out.append(y)
 *     return out
 */
        __pyx_t_3 = (__Pyx_PySequence_ContainsTF(__pyx_v_y, __pyx_v_z, Py_EQ)); if (unlikely(__pyx_t_3 < 0)) __PYX_ERR(0, 619, __pyx_L1_error)
        __pyx_t_9 = (__pyx_t_3 != 0);
        if (__pyx_t_9) {
          __pyx_t_8 = __Pyx_PyInt_AddObjC(__pyx_v_flag_y, __pyx_int_1, 1, 1); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 619, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_8);
          __Pyx_DECREF_SET(__pyx_v_flag_y, __pyx_t_8);
          __pyx_t_8 = 0;
        }

        /* "vapor_vali/Simple_function.pyx":618
 *         for y in kept_dup[1:]:
 *             flag_y=0
 *             for z in out:             # <<<<<<<<<<<<<<
 *                 if y in z:  flag_y+=1
 *             if flag_y==0:   out.append(y)
 */
      }
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

      /* "vapor_vali/Simple_function.pyx":620
 *             for z in out:
 *                 if y in z:  flag_y+=1
 *             if flag_y==0:   out.append(y)             # <<<<<<<<<<<<<<
 *     return out
 * 
 */
      __pyx_t_1 = __Pyx_PyInt_EqObjC(__pyx_v_flag_y, __pyx_int_0, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 620, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __pyx_t_9 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_9 < 0)) __PYX_ERR(0, 620, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      if (__pyx_t_9) {
        __pyx_t_4 = __Pyx_PyList_Append(__pyx_v_out, __pyx_v_y); if (unlikely(__pyx_t_4 == -1)) __PYX_ERR(0, 620, __pyx_L1_error)
      }

      /* "vapor_vali/Simple_function.pyx":616
 *     if len(kept_dup)>0:
 *         out.append(kept_dup[0])
 *         for y in kept_dup[1:]:             # <<<<<<<<<<<<<<
 *             flag_y=0
 *             for z in out:
 */
    }
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;

    /* "vapor_vali/Simple_function.pyx":614
 *     #eg of kept_dup:
 *     out=[]
 *     if len(kept_dup)>0:             # <<<<<<<<<<<<<<
 *         out.append(kept_dup[0])
 *         for y in kept_dup[1:]:
 */
  }

  /* "vapor_vali/Simple_function.pyx":621
 *                 if y in z:  flag_y+=1
 *             if flag_y==0:   out.append(y)
 *     return out             # <<<<<<<<<<<<<<
 * 
 * def dup_let_recombind(vec_in):
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_out);
  __pyx_r = __pyx_v_out;
  goto __pyx_L0;

  /* "vapor_vali/Simple_function.pyx":611
 *     return out
 * 
 * def dup_block_kept_qc(kept_dup):             # <<<<<<<<<<<<<<
 *     #eg of kept_dup:
 *     out=[]
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_8);
  __Pyx_AddTraceback("vapor_vali.Simple_function.dup_block_kept_qc", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_out);
  __Pyx_XDECREF(__pyx_v_y);
  __Pyx_XDECREF(__pyx_v_flag_y);
  __Pyx_XDECREF(__pyx_v_z);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "vapor_vali/Simple_function.pyx":623
 *     return out
 * 
 * def dup_let_recombind(vec_in):             # <<<<<<<<<<<<<<
 *     if vec_in==[]:
 *         return []
 */

/* Python wrapper */
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_81dup_let_recombind(PyObject *__pyx_self, PyObject *__pyx_v_vec_in); /*proto*/
static PyMethodDef __pyx_mdef_10vapor_vali_15Simple_function_81dup_let_recombind = {"dup_let_recombind", (PyCFunction)__pyx_pw_10vapor_vali_15Simple_function_81dup_let_recombind, METH_O, 0};
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_81dup_let_recombind(PyObject *__pyx_self, PyObject *__pyx_v_vec_in) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("dup_let_recombind (wrapper)", 0);
  __pyx_r = __pyx_pf_10vapor_vali_15Simple_function_80dup_let_recombind(__pyx_self, ((PyObject *)__pyx_v_vec_in));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10vapor_vali_15Simple_function_80dup_let_recombind(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_vec_in) {
  PyObject *__pyx_v_vec2 = NULL;
  PyObject *__pyx_v_vec = NULL;
  PyObject *__pyx_v_ka = NULL;
  PyObject *__pyx_v_vec3 = NULL;
  PyObject *__pyx_v_kb = NULL;
  PyObject *__pyx_v_kc = NULL;
  PyObject *__pyx_v_kd = NULL;
  PyObject *__pyx_v_vec4 = NULL;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  int __pyx_t_3;
  int __pyx_t_4;
  Py_ssize_t __pyx_t_5;
  long __pyx_t_6;
  PyObject *__pyx_t_7 = NULL;
  long __pyx_t_8;
  Py_ssize_t __pyx_t_9;
  PyObject *(*__pyx_t_10)(PyObject *);
  PyObject *__pyx_t_11 = NULL;
  Py_ssize_t __pyx_t_12;
  PyObject *(*__pyx_t_13)(PyObject *);
  PyObject *__pyx_t_14 = NULL;
  Py_ssize_t __pyx_t_15;
  PyObject *(*__pyx_t_16)(PyObject *);
  PyObject *__pyx_t_17 = NULL;
  PyObject *__pyx_t_18 = NULL;
  PyObject *__pyx_t_19 = NULL;
  PyObject *__pyx_t_20 = NULL;
  __Pyx_RefNannySetupContext("dup_let_recombind", 0);

  /* "vapor_vali/Simple_function.pyx":624
 * 
 * def dup_let_recombind(vec_in):
 *     if vec_in==[]:             # <<<<<<<<<<<<<<
 *         return []
 *     else:
 */
  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 624, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = PyObject_RichCompare(__pyx_v_vec_in, __pyx_t_1, Py_EQ); __Pyx_XGOTREF(__pyx_t_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 624, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_3 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_3 < 0)) __PYX_ERR(0, 624, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  if (__pyx_t_3) {

    /* "vapor_vali/Simple_function.pyx":625
 * def dup_let_recombind(vec_in):
 *     if vec_in==[]:
 *         return []             # <<<<<<<<<<<<<<
 *     else:
 *         vec2=sorted(vec_in)
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = PyList_New(0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 625, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    /* "vapor_vali/Simple_function.pyx":624
 * 
 * def dup_let_recombind(vec_in):
 *     if vec_in==[]:             # <<<<<<<<<<<<<<
 *         return []
 *     else:
 */
  }

  /* "vapor_vali/Simple_function.pyx":627
 *         return []
 *     else:
 *         vec2=sorted(vec_in)             # <<<<<<<<<<<<<<
 *         vec=[[vec2[0]]]
 *         for ka in vec2[1:]:
 */
  /*else*/ {
    __pyx_t_1 = PySequence_List(__pyx_v_vec_in); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 627, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_2 = ((PyObject*)__pyx_t_1);
    __pyx_t_1 = 0;
    __pyx_t_4 = PyList_Sort(__pyx_t_2); if (unlikely(__pyx_t_4 == -1)) __PYX_ERR(0, 627, __pyx_L1_error)
    __pyx_v_vec2 = ((PyObject*)__pyx_t_2);
    __pyx_t_2 = 0;

    /* "vapor_vali/Simple_function.pyx":628
 *     else:
 *         vec2=sorted(vec_in)
 *         vec=[[vec2[0]]]             # <<<<<<<<<<<<<<
 *         for ka in vec2[1:]:
 *             if ord(ka)-ord(vec[-1][-1])==1:
 */
    if (unlikely(__pyx_v_vec2 == Py_None)) {
      PyErr_SetString(PyExc_TypeError, "'NoneType' object is not subscriptable");
      __PYX_ERR(0, 628, __pyx_L1_error)
    }
    __pyx_t_2 = __Pyx_GetItemInt_List(__pyx_v_vec2, 0, long, 1, __Pyx_PyInt_From_long, 1, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 628, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_1 = PyList_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 628, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_GIVEREF(__pyx_t_2);
    PyList_SET_ITEM(__pyx_t_1, 0, __pyx_t_2);
    __pyx_t_2 = 0;
    __pyx_t_2 = PyList_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 628, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_GIVEREF(__pyx_t_1);
    PyList_SET_ITEM(__pyx_t_2, 0, __pyx_t_1);
    __pyx_t_1 = 0;
    __pyx_v_vec = ((PyObject*)__pyx_t_2);
    __pyx_t_2 = 0;

    /* "vapor_vali/Simple_function.pyx":629
 *         vec2=sorted(vec_in)
 *         vec=[[vec2[0]]]
 *         for ka in vec2[1:]:             # <<<<<<<<<<<<<<
 *             if ord(ka)-ord(vec[-1][-1])==1:
 *                 vec[-1].append(ka)
 */
    if (unlikely(__pyx_v_vec2 == Py_None)) {
      PyErr_SetString(PyExc_TypeError, "'NoneType' object is not subscriptable");
      __PYX_ERR(0, 629, __pyx_L1_error)
    }
    __pyx_t_2 = __Pyx_PyList_GetSlice(__pyx_v_vec2, 1, PY_SSIZE_T_MAX); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 629, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_1 = __pyx_t_2; __Pyx_INCREF(__pyx_t_1); __pyx_t_5 = 0;
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    for (;;) {
      if (__pyx_t_5 >= PyList_GET_SIZE(__pyx_t_1)) break;
      #if CYTHON_COMPILING_IN_CPYTHON
      __pyx_t_2 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_5); __Pyx_INCREF(__pyx_t_2); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 629, __pyx_L1_error)
      #else
      __pyx_t_2 = PySequence_ITEM(__pyx_t_1, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 629, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      #endif
      __Pyx_XDECREF_SET(__pyx_v_ka, __pyx_t_2);
      __pyx_t_2 = 0;

      /* "vapor_vali/Simple_function.pyx":630
 *         vec=[[vec2[0]]]
 *         for ka in vec2[1:]:
 *             if ord(ka)-ord(vec[-1][-1])==1:             # <<<<<<<<<<<<<<
 *                 vec[-1].append(ka)
 *             else:
 */
      __pyx_t_6 = __Pyx_PyObject_Ord(__pyx_v_ka); if (unlikely(__pyx_t_6 == (long)(Py_UCS4)-1)) __PYX_ERR(0, 630, __pyx_L1_error)
      __pyx_t_2 = __Pyx_GetItemInt_List(__pyx_v_vec, -1L, long, 1, __Pyx_PyInt_From_long, 1, 1, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 630, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __pyx_t_7 = __Pyx_GetItemInt(__pyx_t_2, -1L, long, 1, __Pyx_PyInt_From_long, 0, 1, 1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 630, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_7);
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_8 = __Pyx_PyObject_Ord(__pyx_t_7); if (unlikely(__pyx_t_8 == (long)(Py_UCS4)-1)) __PYX_ERR(0, 630, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
      __pyx_t_3 = (((__pyx_t_6 - __pyx_t_8) == 1) != 0);
      if (__pyx_t_3) {

        /* "vapor_vali/Simple_function.pyx":631
 *         for ka in vec2[1:]:
 *             if ord(ka)-ord(vec[-1][-1])==1:
 *                 vec[-1].append(ka)             # <<<<<<<<<<<<<<
 *             else:
 *                 vec.append([ka])
 */
        __pyx_t_7 = __Pyx_GetItemInt_List(__pyx_v_vec, -1L, long, 1, __Pyx_PyInt_From_long, 1, 1, 1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 631, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_7);
        __pyx_t_4 = __Pyx_PyObject_Append(__pyx_t_7, __pyx_v_ka); if (unlikely(__pyx_t_4 == -1)) __PYX_ERR(0, 631, __pyx_L1_error)
        __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;

        /* "vapor_vali/Simple_function.pyx":630
 *         vec=[[vec2[0]]]
 *         for ka in vec2[1:]:
 *             if ord(ka)-ord(vec[-1][-1])==1:             # <<<<<<<<<<<<<<
 *                 vec[-1].append(ka)
 *             else:
 */
        goto __pyx_L6;
      }

      /* "vapor_vali/Simple_function.pyx":633
 *                 vec[-1].append(ka)
 *             else:
 *                 vec.append([ka])             # <<<<<<<<<<<<<<
 *         vec3=[]
 *         for ka in vec:
 */
      /*else*/ {
        __pyx_t_7 = PyList_New(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 633, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_7);
        __Pyx_INCREF(__pyx_v_ka);
        __Pyx_GIVEREF(__pyx_v_ka);
        PyList_SET_ITEM(__pyx_t_7, 0, __pyx_v_ka);
        __pyx_t_4 = __Pyx_PyList_Append(__pyx_v_vec, __pyx_t_7); if (unlikely(__pyx_t_4 == -1)) __PYX_ERR(0, 633, __pyx_L1_error)
        __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
      }
      __pyx_L6:;

      /* "vapor_vali/Simple_function.pyx":629
 *         vec2=sorted(vec_in)
 *         vec=[[vec2[0]]]
 *         for ka in vec2[1:]:             # <<<<<<<<<<<<<<
 *             if ord(ka)-ord(vec[-1][-1])==1:
 *                 vec[-1].append(ka)
 */
    }
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "vapor_vali/Simple_function.pyx":634
 *             else:
 *                 vec.append([ka])
 *         vec3=[]             # <<<<<<<<<<<<<<
 *         for ka in vec:
 *             if len(ka)==1:
 */
    __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 634, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_vec3 = ((PyObject*)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "vapor_vali/Simple_function.pyx":635
 *                 vec.append([ka])
 *         vec3=[]
 *         for ka in vec:             # <<<<<<<<<<<<<<
 *             if len(ka)==1:
 *                 vec3.append(ka)
 */
    __pyx_t_1 = __pyx_v_vec; __Pyx_INCREF(__pyx_t_1); __pyx_t_5 = 0;
    for (;;) {
      if (__pyx_t_5 >= PyList_GET_SIZE(__pyx_t_1)) break;
      #if CYTHON_COMPILING_IN_CPYTHON
      __pyx_t_7 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_5); __Pyx_INCREF(__pyx_t_7); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 635, __pyx_L1_error)
      #else
      __pyx_t_7 = PySequence_ITEM(__pyx_t_1, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 635, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_7);
      #endif
      __Pyx_XDECREF_SET(__pyx_v_ka, __pyx_t_7);
      __pyx_t_7 = 0;

      /* "vapor_vali/Simple_function.pyx":636
 *         vec3=[]
 *         for ka in vec:
 *             if len(ka)==1:             # <<<<<<<<<<<<<<
 *                 vec3.append(ka)
 *             else:
 */
      __pyx_t_9 = PyObject_Length(__pyx_v_ka); if (unlikely(__pyx_t_9 == -1)) __PYX_ERR(0, 636, __pyx_L1_error)
      __pyx_t_3 = ((__pyx_t_9 == 1) != 0);
      if (__pyx_t_3) {

        /* "vapor_vali/Simple_function.pyx":637
 *         for ka in vec:
 *             if len(ka)==1:
 *                 vec3.append(ka)             # <<<<<<<<<<<<<<
 *             else:
 *                 for kb in range(2,len(ka)+1):
 */
        __pyx_t_4 = __Pyx_PyList_Append(__pyx_v_vec3, __pyx_v_ka); if (unlikely(__pyx_t_4 == -1)) __PYX_ERR(0, 637, __pyx_L1_error)

        /* "vapor_vali/Simple_function.pyx":636
 *         vec3=[]
 *         for ka in vec:
 *             if len(ka)==1:             # <<<<<<<<<<<<<<
 *                 vec3.append(ka)
 *             else:
 */
        goto __pyx_L9;
      }

      /* "vapor_vali/Simple_function.pyx":639
 *                 vec3.append(ka)
 *             else:
 *                 for kb in range(2,len(ka)+1):             # <<<<<<<<<<<<<<
 *                     for kc in ka[:(1-kb)]:
 *                         vec3.append([])
 */
      /*else*/ {
        __pyx_t_9 = PyObject_Length(__pyx_v_ka); if (unlikely(__pyx_t_9 == -1)) __PYX_ERR(0, 639, __pyx_L1_error)
        __pyx_t_7 = PyInt_FromSsize_t((__pyx_t_9 + 1)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 639, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_7);
        __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 639, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
        __Pyx_INCREF(__pyx_int_2);
        __Pyx_GIVEREF(__pyx_int_2);
        PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_int_2);
        __Pyx_GIVEREF(__pyx_t_7);
        PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_t_7);
        __pyx_t_7 = 0;
        __pyx_t_7 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_t_2, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 639, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_7);
        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
        if (likely(PyList_CheckExact(__pyx_t_7)) || PyTuple_CheckExact(__pyx_t_7)) {
          __pyx_t_2 = __pyx_t_7; __Pyx_INCREF(__pyx_t_2); __pyx_t_9 = 0;
          __pyx_t_10 = NULL;
        } else {
          __pyx_t_9 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_t_7); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 639, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_2);
          __pyx_t_10 = Py_TYPE(__pyx_t_2)->tp_iternext; if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 639, __pyx_L1_error)
        }
        __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
        for (;;) {
          if (likely(!__pyx_t_10)) {
            if (likely(PyList_CheckExact(__pyx_t_2))) {
              if (__pyx_t_9 >= PyList_GET_SIZE(__pyx_t_2)) break;
              #if CYTHON_COMPILING_IN_CPYTHON
              __pyx_t_7 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_9); __Pyx_INCREF(__pyx_t_7); __pyx_t_9++; if (unlikely(0 < 0)) __PYX_ERR(0, 639, __pyx_L1_error)
              #else
              __pyx_t_7 = PySequence_ITEM(__pyx_t_2, __pyx_t_9); __pyx_t_9++; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 639, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_7);
              #endif
            } else {
              if (__pyx_t_9 >= PyTuple_GET_SIZE(__pyx_t_2)) break;
              #if CYTHON_COMPILING_IN_CPYTHON
              __pyx_t_7 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_9); __Pyx_INCREF(__pyx_t_7); __pyx_t_9++; if (unlikely(0 < 0)) __PYX_ERR(0, 639, __pyx_L1_error)
              #else
              __pyx_t_7 = PySequence_ITEM(__pyx_t_2, __pyx_t_9); __pyx_t_9++; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 639, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_7);
              #endif
            }
          } else {
            __pyx_t_7 = __pyx_t_10(__pyx_t_2);
            if (unlikely(!__pyx_t_7)) {
              PyObject* exc_type = PyErr_Occurred();
              if (exc_type) {
                if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
                else __PYX_ERR(0, 639, __pyx_L1_error)
              }
              break;
            }
            __Pyx_GOTREF(__pyx_t_7);
          }
          __Pyx_XDECREF_SET(__pyx_v_kb, __pyx_t_7);
          __pyx_t_7 = 0;

          /* "vapor_vali/Simple_function.pyx":640
 *             else:
 *                 for kb in range(2,len(ka)+1):
 *                     for kc in ka[:(1-kb)]:             # <<<<<<<<<<<<<<
 *                         vec3.append([])
 *                         for kd in range(kb):
 */
          __pyx_t_7 = __Pyx_PyInt_SubtractCObj(__pyx_int_1, __pyx_v_kb, 1, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 640, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_7);
          __pyx_t_11 = __Pyx_PyObject_GetSlice(__pyx_v_ka, 0, 0, NULL, &__pyx_t_7, NULL, 0, 0, 1); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 640, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_11);
          __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
          if (likely(PyList_CheckExact(__pyx_t_11)) || PyTuple_CheckExact(__pyx_t_11)) {
            __pyx_t_7 = __pyx_t_11; __Pyx_INCREF(__pyx_t_7); __pyx_t_12 = 0;
            __pyx_t_13 = NULL;
          } else {
            __pyx_t_12 = -1; __pyx_t_7 = PyObject_GetIter(__pyx_t_11); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 640, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_7);
            __pyx_t_13 = Py_TYPE(__pyx_t_7)->tp_iternext; if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 640, __pyx_L1_error)
          }
          __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
          for (;;) {
            if (likely(!__pyx_t_13)) {
              if (likely(PyList_CheckExact(__pyx_t_7))) {
                if (__pyx_t_12 >= PyList_GET_SIZE(__pyx_t_7)) break;
                #if CYTHON_COMPILING_IN_CPYTHON
                __pyx_t_11 = PyList_GET_ITEM(__pyx_t_7, __pyx_t_12); __Pyx_INCREF(__pyx_t_11); __pyx_t_12++; if (unlikely(0 < 0)) __PYX_ERR(0, 640, __pyx_L1_error)
                #else
                __pyx_t_11 = PySequence_ITEM(__pyx_t_7, __pyx_t_12); __pyx_t_12++; if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 640, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_11);
                #endif
              } else {
                if (__pyx_t_12 >= PyTuple_GET_SIZE(__pyx_t_7)) break;
                #if CYTHON_COMPILING_IN_CPYTHON
                __pyx_t_11 = PyTuple_GET_ITEM(__pyx_t_7, __pyx_t_12); __Pyx_INCREF(__pyx_t_11); __pyx_t_12++; if (unlikely(0 < 0)) __PYX_ERR(0, 640, __pyx_L1_error)
                #else
                __pyx_t_11 = PySequence_ITEM(__pyx_t_7, __pyx_t_12); __pyx_t_12++; if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 640, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_11);
                #endif
              }
            } else {
              __pyx_t_11 = __pyx_t_13(__pyx_t_7);
              if (unlikely(!__pyx_t_11)) {
                PyObject* exc_type = PyErr_Occurred();
                if (exc_type) {
                  if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
                  else __PYX_ERR(0, 640, __pyx_L1_error)
                }
                break;
              }
              __Pyx_GOTREF(__pyx_t_11);
            }
            __Pyx_XDECREF_SET(__pyx_v_kc, __pyx_t_11);
            __pyx_t_11 = 0;

            /* "vapor_vali/Simple_function.pyx":641
 *                 for kb in range(2,len(ka)+1):
 *                     for kc in ka[:(1-kb)]:
 *                         vec3.append([])             # <<<<<<<<<<<<<<
 *                         for kd in range(kb):
 *                             vec3[-1].append(ka[ka.index(kc)+kd])
 */
            __pyx_t_11 = PyList_New(0); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 641, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_11);
            __pyx_t_4 = __Pyx_PyList_Append(__pyx_v_vec3, __pyx_t_11); if (unlikely(__pyx_t_4 == -1)) __PYX_ERR(0, 641, __pyx_L1_error)
            __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;

            /* "vapor_vali/Simple_function.pyx":642
 *                     for kc in ka[:(1-kb)]:
 *                         vec3.append([])
 *                         for kd in range(kb):             # <<<<<<<<<<<<<<
 *                             vec3[-1].append(ka[ka.index(kc)+kd])
 *         vec4=[''.join(i) for i in vec3]
 */
            __pyx_t_11 = PyTuple_New(1); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 642, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_11);
            __Pyx_INCREF(__pyx_v_kb);
            __Pyx_GIVEREF(__pyx_v_kb);
            PyTuple_SET_ITEM(__pyx_t_11, 0, __pyx_v_kb);
            __pyx_t_14 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_t_11, NULL); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 642, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_14);
            __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
            if (likely(PyList_CheckExact(__pyx_t_14)) || PyTuple_CheckExact(__pyx_t_14)) {
              __pyx_t_11 = __pyx_t_14; __Pyx_INCREF(__pyx_t_11); __pyx_t_15 = 0;
              __pyx_t_16 = NULL;
            } else {
              __pyx_t_15 = -1; __pyx_t_11 = PyObject_GetIter(__pyx_t_14); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 642, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_11);
              __pyx_t_16 = Py_TYPE(__pyx_t_11)->tp_iternext; if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 642, __pyx_L1_error)
            }
            __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
            for (;;) {
              if (likely(!__pyx_t_16)) {
                if (likely(PyList_CheckExact(__pyx_t_11))) {
                  if (__pyx_t_15 >= PyList_GET_SIZE(__pyx_t_11)) break;
                  #if CYTHON_COMPILING_IN_CPYTHON
                  __pyx_t_14 = PyList_GET_ITEM(__pyx_t_11, __pyx_t_15); __Pyx_INCREF(__pyx_t_14); __pyx_t_15++; if (unlikely(0 < 0)) __PYX_ERR(0, 642, __pyx_L1_error)
                  #else
                  __pyx_t_14 = PySequence_ITEM(__pyx_t_11, __pyx_t_15); __pyx_t_15++; if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 642, __pyx_L1_error)
                  __Pyx_GOTREF(__pyx_t_14);
                  #endif
                } else {
                  if (__pyx_t_15 >= PyTuple_GET_SIZE(__pyx_t_11)) break;
                  #if CYTHON_COMPILING_IN_CPYTHON
                  __pyx_t_14 = PyTuple_GET_ITEM(__pyx_t_11, __pyx_t_15); __Pyx_INCREF(__pyx_t_14); __pyx_t_15++; if (unlikely(0 < 0)) __PYX_ERR(0, 642, __pyx_L1_error)
                  #else
                  __pyx_t_14 = PySequence_ITEM(__pyx_t_11, __pyx_t_15); __pyx_t_15++; if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 642, __pyx_L1_error)
                  __Pyx_GOTREF(__pyx_t_14);
                  #endif
                }
              } else {
                __pyx_t_14 = __pyx_t_16(__pyx_t_11);
                if (unlikely(!__pyx_t_14)) {
                  PyObject* exc_type = PyErr_Occurred();
                  if (exc_type) {
                    if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
                    else __PYX_ERR(0, 642, __pyx_L1_error)
                  }
                  break;
                }
                __Pyx_GOTREF(__pyx_t_14);
              }
              __Pyx_XDECREF_SET(__pyx_v_kd, __pyx_t_14);
              __pyx_t_14 = 0;

              /* "vapor_vali/Simple_function.pyx":643
 *                         vec3.append([])
 *                         for kd in range(kb):
 *                             vec3[-1].append(ka[ka.index(kc)+kd])             # <<<<<<<<<<<<<<
 *         vec4=[''.join(i) for i in vec3]
 *         return vec4
 */
              __pyx_t_14 = __Pyx_GetItemInt_List(__pyx_v_vec3, -1L, long, 1, __Pyx_PyInt_From_long, 1, 1, 1); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 643, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_14);
              __pyx_t_18 = __Pyx_PyObject_GetAttrStr(__pyx_v_ka, __pyx_n_s_index); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 643, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_18);
              __pyx_t_19 = NULL;
              if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_18))) {
                __pyx_t_19 = PyMethod_GET_SELF(__pyx_t_18);
                if (likely(__pyx_t_19)) {
                  PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_18);
                  __Pyx_INCREF(__pyx_t_19);
                  __Pyx_INCREF(function);
                  __Pyx_DECREF_SET(__pyx_t_18, function);
                }
              }
              if (!__pyx_t_19) {
                __pyx_t_17 = __Pyx_PyObject_CallOneArg(__pyx_t_18, __pyx_v_kc); if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 643, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_17);
              } else {
                __pyx_t_20 = PyTuple_New(1+1); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 643, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_20);
                __Pyx_GIVEREF(__pyx_t_19); PyTuple_SET_ITEM(__pyx_t_20, 0, __pyx_t_19); __pyx_t_19 = NULL;
                __Pyx_INCREF(__pyx_v_kc);
                __Pyx_GIVEREF(__pyx_v_kc);
                PyTuple_SET_ITEM(__pyx_t_20, 0+1, __pyx_v_kc);
                __pyx_t_17 = __Pyx_PyObject_Call(__pyx_t_18, __pyx_t_20, NULL); if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 643, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_17);
                __Pyx_DECREF(__pyx_t_20); __pyx_t_20 = 0;
              }
              __Pyx_DECREF(__pyx_t_18); __pyx_t_18 = 0;
              __pyx_t_18 = PyNumber_Add(__pyx_t_17, __pyx_v_kd); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 643, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_18);
              __Pyx_DECREF(__pyx_t_17); __pyx_t_17 = 0;
              __pyx_t_17 = PyObject_GetItem(__pyx_v_ka, __pyx_t_18); if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 643, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_17);
              __Pyx_DECREF(__pyx_t_18); __pyx_t_18 = 0;
              __pyx_t_4 = __Pyx_PyObject_Append(__pyx_t_14, __pyx_t_17); if (unlikely(__pyx_t_4 == -1)) __PYX_ERR(0, 643, __pyx_L1_error)
              __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
              __Pyx_DECREF(__pyx_t_17); __pyx_t_17 = 0;

              /* "vapor_vali/Simple_function.pyx":642
 *                     for kc in ka[:(1-kb)]:
 *                         vec3.append([])
 *                         for kd in range(kb):             # <<<<<<<<<<<<<<
 *                             vec3[-1].append(ka[ka.index(kc)+kd])
 *         vec4=[''.join(i) for i in vec3]
 */
            }
            __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;

            /* "vapor_vali/Simple_function.pyx":640
 *             else:
 *                 for kb in range(2,len(ka)+1):
 *                     for kc in ka[:(1-kb)]:             # <<<<<<<<<<<<<<
 *                         vec3.append([])
 *                         for kd in range(kb):
 */
          }
          __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;

          /* "vapor_vali/Simple_function.pyx":639
 *                 vec3.append(ka)
 *             else:
 *                 for kb in range(2,len(ka)+1):             # <<<<<<<<<<<<<<
 *                     for kc in ka[:(1-kb)]:
 *                         vec3.append([])
 */
        }
        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      }
      __pyx_L9:;

      /* "vapor_vali/Simple_function.pyx":635
 *                 vec.append([ka])
 *         vec3=[]
 *         for ka in vec:             # <<<<<<<<<<<<<<
 *             if len(ka)==1:
 *                 vec3.append(ka)
 */
    }
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "vapor_vali/Simple_function.pyx":644
 *                         for kd in range(kb):
 *                             vec3[-1].append(ka[ka.index(kc)+kd])
 *         vec4=[''.join(i) for i in vec3]             # <<<<<<<<<<<<<<
 *         return vec4
 * 
 */
    __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 644, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_2 = __pyx_v_vec3; __Pyx_INCREF(__pyx_t_2); __pyx_t_5 = 0;
    for (;;) {
      if (__pyx_t_5 >= PyList_GET_SIZE(__pyx_t_2)) break;
      #if CYTHON_COMPILING_IN_CPYTHON
      __pyx_t_7 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_5); __Pyx_INCREF(__pyx_t_7); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 644, __pyx_L1_error)
      #else
      __pyx_t_7 = PySequence_ITEM(__pyx_t_2, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 644, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_7);
      #endif
      __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_7);
      __pyx_t_7 = 0;
      __pyx_t_7 = __Pyx_PyString_Join(__pyx_kp_s__24, __pyx_v_i); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 644, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_7);
      if (unlikely(__Pyx_ListComp_Append(__pyx_t_1, (PyObject*)__pyx_t_7))) __PYX_ERR(0, 644, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
    }
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_v_vec4 = ((PyObject*)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "vapor_vali/Simple_function.pyx":645
 *                             vec3[-1].append(ka[ka.index(kc)+kd])
 *         vec4=[''.join(i) for i in vec3]
 *         return vec4             # <<<<<<<<<<<<<<
 * 
 * def editDistance(seq1,seq2,cost_matrix,move_matrix,r,c):
 */
    __Pyx_XDECREF(__pyx_r);
    __Pyx_INCREF(__pyx_v_vec4);
    __pyx_r = __pyx_v_vec4;
    goto __pyx_L0;
  }

  /* "vapor_vali/Simple_function.pyx":623
 *     return out
 * 
 * def dup_let_recombind(vec_in):             # <<<<<<<<<<<<<<
 *     if vec_in==[]:
 *         return []
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_7);
  __Pyx_XDECREF(__pyx_t_11);
  __Pyx_XDECREF(__pyx_t_14);
  __Pyx_XDECREF(__pyx_t_17);
  __Pyx_XDECREF(__pyx_t_18);
  __Pyx_XDECREF(__pyx_t_19);
  __Pyx_XDECREF(__pyx_t_20);
  __Pyx_AddTraceback("vapor_vali.Simple_function.dup_let_recombind", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_vec2);
  __Pyx_XDECREF(__pyx_v_vec);
  __Pyx_XDECREF(__pyx_v_ka);
  __Pyx_XDECREF(__pyx_v_vec3);
  __Pyx_XDECREF(__pyx_v_kb);
  __Pyx_XDECREF(__pyx_v_kc);
  __Pyx_XDECREF(__pyx_v_kd);
  __Pyx_XDECREF(__pyx_v_vec4);
  __Pyx_XDECREF(__pyx_v_i);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "vapor_vali/Simple_function.pyx":647
 *         return vec4
 * 
 * def editDistance(seq1,seq2,cost_matrix,move_matrix,r,c):             # <<<<<<<<<<<<<<
 *     [iCost, dCost , mCost]=[1,1,1]
 *     if cost_matrix[r][c]==float('inf'):
 */

/* Python wrapper */
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_83editDistance(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_10vapor_vali_15Simple_function_83editDistance = {"editDistance", (PyCFunction)__pyx_pw_10vapor_vali_15Simple_function_83editDistance, METH_VARARGS|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_83editDistance(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_seq1 = 0;
  PyObject *__pyx_v_seq2 = 0;
  PyObject *__pyx_v_cost_matrix = 0;
  PyObject *__pyx_v_move_matrix = 0;
  PyObject *__pyx_v_r = 0;
  PyObject *__pyx_v_c = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("editDistance (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_seq1,&__pyx_n_s_seq2,&__pyx_n_s_cost_matrix,&__pyx_n_s_move_matrix,&__pyx_n_s_r,&__pyx_n_s_c,0};
    PyObject* values[6] = {0,0,0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
      switch (pos_args) {
        case  6: values[5] = PyTuple_GET_ITEM(__pyx_args, 5);
        case  5: values[4] = PyTuple_GET_ITEM(__pyx_args, 4);
        case  4: values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
        case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_seq1)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_seq2)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("editDistance", 1, 6, 6, 1); __PYX_ERR(0, 647, __pyx_L3_error)
        }
        case  2:
        if (likely((values[2] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_cost_matrix)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("editDistance", 1, 6, 6, 2); __PYX_ERR(0, 647, __pyx_L3_error)
        }
        case  3:
        if (likely((values[3] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_move_matrix)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("editDistance", 1, 6, 6, 3); __PYX_ERR(0, 647, __pyx_L3_error)
        }
        case  4:
        if (likely((values[4] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_r)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("editDistance", 1, 6, 6, 4); __PYX_ERR(0, 647, __pyx_L3_error)
        }
        case  5:
        if (likely((values[5] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_c)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("editDistance", 1, 6, 6, 5); __PYX_ERR(0, 647, __pyx_L3_error)
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "editDistance") < 0)) __PYX_ERR(0, 647, __pyx_L3_error)
      }
    } else if (PyTuple_GET_SIZE(__pyx_args) != 6) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
      values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
      values[4] = PyTuple_GET_ITEM(__pyx_args, 4);
      values[5] = PyTuple_GET_ITEM(__pyx_args, 5);
    }
    __pyx_v_seq1 = values[0];
    __pyx_v_seq2 = values[1];
    __pyx_v_cost_matrix = values[2];
    __pyx_v_move_matrix = values[3];
    __pyx_v_r = values[4];
    __pyx_v_c = values[5];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("editDistance", 1, 6, 6, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 647, __pyx_L3_error)
  __pyx_L3_error:;
  __Pyx_AddTraceback("vapor_vali.Simple_function.editDistance", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_10vapor_vali_15Simple_function_82editDistance(__pyx_self, __pyx_v_seq1, __pyx_v_seq2, __pyx_v_cost_matrix, __pyx_v_move_matrix, __pyx_v_r, __pyx_v_c);

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10vapor_vali_15Simple_function_82editDistance(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_seq1, PyObject *__pyx_v_seq2, PyObject *__pyx_v_cost_matrix, PyObject *__pyx_v_move_matrix, PyObject *__pyx_v_r, PyObject *__pyx_v_c) {
  PyObject *__pyx_v_iCost = NULL;
  PyObject *__pyx_v_dCost = NULL;
  PyObject *__pyx_v_mCost = NULL;
  PyObject *__pyx_v_iDist = NULL;
  PyObject *__pyx_v_dDist = NULL;
  PyObject *__pyx_v_mDist = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  int __pyx_t_4;
  int __pyx_t_5;
  PyObject *__pyx_t_6 = NULL;
  Py_ssize_t __pyx_t_7;
  PyObject *__pyx_t_8 = NULL;
  PyObject *__pyx_t_9 = NULL;
  __Pyx_RefNannySetupContext("editDistance", 0);

  /* "vapor_vali/Simple_function.pyx":648
 * 
 * def editDistance(seq1,seq2,cost_matrix,move_matrix,r,c):
 *     [iCost, dCost , mCost]=[1,1,1]             # <<<<<<<<<<<<<<
 *     if cost_matrix[r][c]==float('inf'):
 *         if r==0 and c==0:
 */
  __pyx_t_1 = __pyx_int_1;
  __Pyx_INCREF(__pyx_t_1);
  __pyx_t_2 = __pyx_int_1;
  __Pyx_INCREF(__pyx_t_2);
  __pyx_t_3 = __pyx_int_1;
  __Pyx_INCREF(__pyx_t_3);
  __pyx_v_iCost = __pyx_t_1;
  __pyx_t_1 = 0;
  __pyx_v_dCost = __pyx_t_2;
  __pyx_t_2 = 0;
  __pyx_v_mCost = __pyx_t_3;
  __pyx_t_3 = 0;

  /* "vapor_vali/Simple_function.pyx":649
 * def editDistance(seq1,seq2,cost_matrix,move_matrix,r,c):
 *     [iCost, dCost , mCost]=[1,1,1]
 *     if cost_matrix[r][c]==float('inf'):             # <<<<<<<<<<<<<<
 *         if r==0 and c==0:
 *             cost_matrix[r][c]=0
 */
  __pyx_t_3 = PyObject_GetItem(__pyx_v_cost_matrix, __pyx_v_r); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 649, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_2 = PyObject_GetItem(__pyx_t_3, __pyx_v_c); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 649, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = __Pyx_PyNumber_Float(__pyx_n_s_inf); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 649, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_1 = PyObject_RichCompare(__pyx_t_2, __pyx_t_3, Py_EQ); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 649, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 649, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  if (__pyx_t_4) {

    /* "vapor_vali/Simple_function.pyx":650
 *     [iCost, dCost , mCost]=[1,1,1]
 *     if cost_matrix[r][c]==float('inf'):
 *         if r==0 and c==0:             # <<<<<<<<<<<<<<
 *             cost_matrix[r][c]=0
 *         elif r==0:
 */
    __pyx_t_1 = __Pyx_PyInt_EqObjC(__pyx_v_r, __pyx_int_0, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 650, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 650, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    if (__pyx_t_5) {
    } else {
      __pyx_t_4 = __pyx_t_5;
      goto __pyx_L5_bool_binop_done;
    }
    __pyx_t_1 = __Pyx_PyInt_EqObjC(__pyx_v_c, __pyx_int_0, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 650, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 650, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_4 = __pyx_t_5;
    __pyx_L5_bool_binop_done:;
    if (__pyx_t_4) {

      /* "vapor_vali/Simple_function.pyx":651
 *     if cost_matrix[r][c]==float('inf'):
 *         if r==0 and c==0:
 *             cost_matrix[r][c]=0             # <<<<<<<<<<<<<<
 *         elif r==0:
 *             move_matrix[r][c]=0
 */
      __pyx_t_1 = PyObject_GetItem(__pyx_v_cost_matrix, __pyx_v_r); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 651, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      if (unlikely(PyObject_SetItem(__pyx_t_1, __pyx_v_c, __pyx_int_0) < 0)) __PYX_ERR(0, 651, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

      /* "vapor_vali/Simple_function.pyx":650
 *     [iCost, dCost , mCost]=[1,1,1]
 *     if cost_matrix[r][c]==float('inf'):
 *         if r==0 and c==0:             # <<<<<<<<<<<<<<
 *             cost_matrix[r][c]=0
 *         elif r==0:
 */
      goto __pyx_L4;
    }

    /* "vapor_vali/Simple_function.pyx":652
 *         if r==0 and c==0:
 *             cost_matrix[r][c]=0
 *         elif r==0:             # <<<<<<<<<<<<<<
 *             move_matrix[r][c]=0
 *             cost_matrix[r][c]=editDistance(seq1,seq2,cost_matrix,move_matrix,r,c-1)+iCost
 */
    __pyx_t_1 = __Pyx_PyInt_EqObjC(__pyx_v_r, __pyx_int_0, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 652, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 652, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    if (__pyx_t_4) {

      /* "vapor_vali/Simple_function.pyx":653
 *             cost_matrix[r][c]=0
 *         elif r==0:
 *             move_matrix[r][c]=0             # <<<<<<<<<<<<<<
 *             cost_matrix[r][c]=editDistance(seq1,seq2,cost_matrix,move_matrix,r,c-1)+iCost
 *         elif c==0:
 */
      __pyx_t_1 = PyObject_GetItem(__pyx_v_move_matrix, __pyx_v_r); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 653, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      if (unlikely(PyObject_SetItem(__pyx_t_1, __pyx_v_c, __pyx_int_0) < 0)) __PYX_ERR(0, 653, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

      /* "vapor_vali/Simple_function.pyx":654
 *         elif r==0:
 *             move_matrix[r][c]=0
 *             cost_matrix[r][c]=editDistance(seq1,seq2,cost_matrix,move_matrix,r,c-1)+iCost             # <<<<<<<<<<<<<<
 *         elif c==0:
 *             move_matrix[r][c]=1
 */
      __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_editDistance); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 654, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __pyx_t_2 = __Pyx_PyInt_SubtractObjC(__pyx_v_c, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 654, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __pyx_t_6 = NULL;
      __pyx_t_7 = 0;
      if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_3))) {
        __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_3);
        if (likely(__pyx_t_6)) {
          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
          __Pyx_INCREF(__pyx_t_6);
          __Pyx_INCREF(function);
          __Pyx_DECREF_SET(__pyx_t_3, function);
          __pyx_t_7 = 1;
        }
      }
      __pyx_t_8 = PyTuple_New(6+__pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 654, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_8);
      if (__pyx_t_6) {
        __Pyx_GIVEREF(__pyx_t_6); PyTuple_SET_ITEM(__pyx_t_8, 0, __pyx_t_6); __pyx_t_6 = NULL;
      }
      __Pyx_INCREF(__pyx_v_seq1);
      __Pyx_GIVEREF(__pyx_v_seq1);
      PyTuple_SET_ITEM(__pyx_t_8, 0+__pyx_t_7, __pyx_v_seq1);
      __Pyx_INCREF(__pyx_v_seq2);
      __Pyx_GIVEREF(__pyx_v_seq2);
      PyTuple_SET_ITEM(__pyx_t_8, 1+__pyx_t_7, __pyx_v_seq2);
      __Pyx_INCREF(__pyx_v_cost_matrix);
      __Pyx_GIVEREF(__pyx_v_cost_matrix);
      PyTuple_SET_ITEM(__pyx_t_8, 2+__pyx_t_7, __pyx_v_cost_matrix);
      __Pyx_INCREF(__pyx_v_move_matrix);
      __Pyx_GIVEREF(__pyx_v_move_matrix);
      PyTuple_SET_ITEM(__pyx_t_8, 3+__pyx_t_7, __pyx_v_move_matrix);
      __Pyx_INCREF(__pyx_v_r);
      __Pyx_GIVEREF(__pyx_v_r);
      PyTuple_SET_ITEM(__pyx_t_8, 4+__pyx_t_7, __pyx_v_r);
      __Pyx_GIVEREF(__pyx_t_2);
      PyTuple_SET_ITEM(__pyx_t_8, 5+__pyx_t_7, __pyx_t_2);
      __pyx_t_2 = 0;
      __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_8, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 654, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_3 = PyNumber_Add(__pyx_t_1, __pyx_v_iCost); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 654, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_1 = PyObject_GetItem(__pyx_v_cost_matrix, __pyx_v_r); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 654, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      if (unlikely(PyObject_SetItem(__pyx_t_1, __pyx_v_c, __pyx_t_3) < 0)) __PYX_ERR(0, 654, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;

      /* "vapor_vali/Simple_function.pyx":652
 *         if r==0 and c==0:
 *             cost_matrix[r][c]=0
 *         elif r==0:             # <<<<<<<<<<<<<<
 *             move_matrix[r][c]=0
 *             cost_matrix[r][c]=editDistance(seq1,seq2,cost_matrix,move_matrix,r,c-1)+iCost
 */
      goto __pyx_L4;
    }

    /* "vapor_vali/Simple_function.pyx":655
 *             move_matrix[r][c]=0
 *             cost_matrix[r][c]=editDistance(seq1,seq2,cost_matrix,move_matrix,r,c-1)+iCost
 *         elif c==0:             # <<<<<<<<<<<<<<
 *             move_matrix[r][c]=1
 *             cost_matrix[r][c] = editDistance(seq1,seq2,cost_matrix,move_matrix,r-1,c)+dCost
 */
    __pyx_t_3 = __Pyx_PyInt_EqObjC(__pyx_v_c, __pyx_int_0, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 655, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 655, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    if (__pyx_t_4) {

      /* "vapor_vali/Simple_function.pyx":656
 *             cost_matrix[r][c]=editDistance(seq1,seq2,cost_matrix,move_matrix,r,c-1)+iCost
 *         elif c==0:
 *             move_matrix[r][c]=1             # <<<<<<<<<<<<<<
 *             cost_matrix[r][c] = editDistance(seq1,seq2,cost_matrix,move_matrix,r-1,c)+dCost
 *         else:
 */
      __pyx_t_3 = PyObject_GetItem(__pyx_v_move_matrix, __pyx_v_r); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 656, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      if (unlikely(PyObject_SetItem(__pyx_t_3, __pyx_v_c, __pyx_int_1) < 0)) __PYX_ERR(0, 656, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;

      /* "vapor_vali/Simple_function.pyx":657
 *         elif c==0:
 *             move_matrix[r][c]=1
 *             cost_matrix[r][c] = editDistance(seq1,seq2,cost_matrix,move_matrix,r-1,c)+dCost             # <<<<<<<<<<<<<<
 *         else:
 *             iDist=editDistance(seq1,seq2,cost_matrix,move_matrix,r,c-1) + iCost
 */
      __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_editDistance); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 657, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __pyx_t_8 = __Pyx_PyInt_SubtractObjC(__pyx_v_r, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 657, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_8);
      __pyx_t_2 = NULL;
      __pyx_t_7 = 0;
      if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_1))) {
        __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_1);
        if (likely(__pyx_t_2)) {
          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
          __Pyx_INCREF(__pyx_t_2);
          __Pyx_INCREF(function);
          __Pyx_DECREF_SET(__pyx_t_1, function);
          __pyx_t_7 = 1;
        }
      }
      __pyx_t_6 = PyTuple_New(6+__pyx_t_7); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 657, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_6);
      if (__pyx_t_2) {
        __Pyx_GIVEREF(__pyx_t_2); PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_2); __pyx_t_2 = NULL;
      }
      __Pyx_INCREF(__pyx_v_seq1);
      __Pyx_GIVEREF(__pyx_v_seq1);
      PyTuple_SET_ITEM(__pyx_t_6, 0+__pyx_t_7, __pyx_v_seq1);
      __Pyx_INCREF(__pyx_v_seq2);
      __Pyx_GIVEREF(__pyx_v_seq2);
      PyTuple_SET_ITEM(__pyx_t_6, 1+__pyx_t_7, __pyx_v_seq2);
      __Pyx_INCREF(__pyx_v_cost_matrix);
      __Pyx_GIVEREF(__pyx_v_cost_matrix);
      PyTuple_SET_ITEM(__pyx_t_6, 2+__pyx_t_7, __pyx_v_cost_matrix);
      __Pyx_INCREF(__pyx_v_move_matrix);
      __Pyx_GIVEREF(__pyx_v_move_matrix);
      PyTuple_SET_ITEM(__pyx_t_6, 3+__pyx_t_7, __pyx_v_move_matrix);
      __Pyx_GIVEREF(__pyx_t_8);
      PyTuple_SET_ITEM(__pyx_t_6, 4+__pyx_t_7, __pyx_t_8);
      __Pyx_INCREF(__pyx_v_c);
      __Pyx_GIVEREF(__pyx_v_c);
      PyTuple_SET_ITEM(__pyx_t_6, 5+__pyx_t_7, __pyx_v_c);
      __pyx_t_8 = 0;
      __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_6, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 657, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_1 = PyNumber_Add(__pyx_t_3, __pyx_v_dCost); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 657, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_3 = PyObject_GetItem(__pyx_v_cost_matrix, __pyx_v_r); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 657, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      if (unlikely(PyObject_SetItem(__pyx_t_3, __pyx_v_c, __pyx_t_1) < 0)) __PYX_ERR(0, 657, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

      /* "vapor_vali/Simple_function.pyx":655
 *             move_matrix[r][c]=0
 *             cost_matrix[r][c]=editDistance(seq1,seq2,cost_matrix,move_matrix,r,c-1)+iCost
 *         elif c==0:             # <<<<<<<<<<<<<<
 *             move_matrix[r][c]=1
 *             cost_matrix[r][c] = editDistance(seq1,seq2,cost_matrix,move_matrix,r-1,c)+dCost
 */
      goto __pyx_L4;
    }

    /* "vapor_vali/Simple_function.pyx":659
 *             cost_matrix[r][c] = editDistance(seq1,seq2,cost_matrix,move_matrix,r-1,c)+dCost
 *         else:
 *             iDist=editDistance(seq1,seq2,cost_matrix,move_matrix,r,c-1) + iCost             # <<<<<<<<<<<<<<
 *             dDist=editDistance(seq1,seq2,cost_matrix,move_matrix,r-1,c) + dCost
 *             if seq1[r-1] == seq2[c-1]:
 */
    /*else*/ {
      __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_editDistance); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 659, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __pyx_t_6 = __Pyx_PyInt_SubtractObjC(__pyx_v_c, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 659, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_6);
      __pyx_t_8 = NULL;
      __pyx_t_7 = 0;
      if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_3))) {
        __pyx_t_8 = PyMethod_GET_SELF(__pyx_t_3);
        if (likely(__pyx_t_8)) {
          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
          __Pyx_INCREF(__pyx_t_8);
          __Pyx_INCREF(function);
          __Pyx_DECREF_SET(__pyx_t_3, function);
          __pyx_t_7 = 1;
        }
      }
      __pyx_t_2 = PyTuple_New(6+__pyx_t_7); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 659, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      if (__pyx_t_8) {
        __Pyx_GIVEREF(__pyx_t_8); PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_8); __pyx_t_8 = NULL;
      }
      __Pyx_INCREF(__pyx_v_seq1);
      __Pyx_GIVEREF(__pyx_v_seq1);
      PyTuple_SET_ITEM(__pyx_t_2, 0+__pyx_t_7, __pyx_v_seq1);
      __Pyx_INCREF(__pyx_v_seq2);
      __Pyx_GIVEREF(__pyx_v_seq2);
      PyTuple_SET_ITEM(__pyx_t_2, 1+__pyx_t_7, __pyx_v_seq2);
      __Pyx_INCREF(__pyx_v_cost_matrix);
      __Pyx_GIVEREF(__pyx_v_cost_matrix);
      PyTuple_SET_ITEM(__pyx_t_2, 2+__pyx_t_7, __pyx_v_cost_matrix);
      __Pyx_INCREF(__pyx_v_move_matrix);
      __Pyx_GIVEREF(__pyx_v_move_matrix);
      PyTuple_SET_ITEM(__pyx_t_2, 3+__pyx_t_7, __pyx_v_move_matrix);
      __Pyx_INCREF(__pyx_v_r);
      __Pyx_GIVEREF(__pyx_v_r);
      PyTuple_SET_ITEM(__pyx_t_2, 4+__pyx_t_7, __pyx_v_r);
      __Pyx_GIVEREF(__pyx_t_6);
      PyTuple_SET_ITEM(__pyx_t_2, 5+__pyx_t_7, __pyx_t_6);
      __pyx_t_6 = 0;
      __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_2, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 659, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_3 = PyNumber_Add(__pyx_t_1, __pyx_v_iCost); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 659, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_v_iDist = __pyx_t_3;
      __pyx_t_3 = 0;

      /* "vapor_vali/Simple_function.pyx":660
 *         else:
 *             iDist=editDistance(seq1,seq2,cost_matrix,move_matrix,r,c-1) + iCost
 *             dDist=editDistance(seq1,seq2,cost_matrix,move_matrix,r-1,c) + dCost             # <<<<<<<<<<<<<<
 *             if seq1[r-1] == seq2[c-1]:
 *                 mDist=editDistance(seq1,seq2,cost_matrix,move_matrix,r-1,c-1)
 */
      __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_editDistance); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 660, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __pyx_t_2 = __Pyx_PyInt_SubtractObjC(__pyx_v_r, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 660, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __pyx_t_6 = NULL;
      __pyx_t_7 = 0;
      if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_1))) {
        __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_1);
        if (likely(__pyx_t_6)) {
          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
          __Pyx_INCREF(__pyx_t_6);
          __Pyx_INCREF(function);
          __Pyx_DECREF_SET(__pyx_t_1, function);
          __pyx_t_7 = 1;
        }
      }
      __pyx_t_8 = PyTuple_New(6+__pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 660, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_8);
      if (__pyx_t_6) {
        __Pyx_GIVEREF(__pyx_t_6); PyTuple_SET_ITEM(__pyx_t_8, 0, __pyx_t_6); __pyx_t_6 = NULL;
      }
      __Pyx_INCREF(__pyx_v_seq1);
      __Pyx_GIVEREF(__pyx_v_seq1);
      PyTuple_SET_ITEM(__pyx_t_8, 0+__pyx_t_7, __pyx_v_seq1);
      __Pyx_INCREF(__pyx_v_seq2);
      __Pyx_GIVEREF(__pyx_v_seq2);
      PyTuple_SET_ITEM(__pyx_t_8, 1+__pyx_t_7, __pyx_v_seq2);
      __Pyx_INCREF(__pyx_v_cost_matrix);
      __Pyx_GIVEREF(__pyx_v_cost_matrix);
      PyTuple_SET_ITEM(__pyx_t_8, 2+__pyx_t_7, __pyx_v_cost_matrix);
      __Pyx_INCREF(__pyx_v_move_matrix);
      __Pyx_GIVEREF(__pyx_v_move_matrix);
      PyTuple_SET_ITEM(__pyx_t_8, 3+__pyx_t_7, __pyx_v_move_matrix);
      __Pyx_GIVEREF(__pyx_t_2);
      PyTuple_SET_ITEM(__pyx_t_8, 4+__pyx_t_7, __pyx_t_2);
      __Pyx_INCREF(__pyx_v_c);
      __Pyx_GIVEREF(__pyx_v_c);
      PyTuple_SET_ITEM(__pyx_t_8, 5+__pyx_t_7, __pyx_v_c);
      __pyx_t_2 = 0;
      __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_8, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 660, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_1 = PyNumber_Add(__pyx_t_3, __pyx_v_dCost); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 660, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_v_dDist = __pyx_t_1;
      __pyx_t_1 = 0;

      /* "vapor_vali/Simple_function.pyx":661
 *             iDist=editDistance(seq1,seq2,cost_matrix,move_matrix,r,c-1) + iCost
 *             dDist=editDistance(seq1,seq2,cost_matrix,move_matrix,r-1,c) + dCost
 *             if seq1[r-1] == seq2[c-1]:             # <<<<<<<<<<<<<<
 *                 mDist=editDistance(seq1,seq2,cost_matrix,move_matrix,r-1,c-1)
 *             else:
 */
      __pyx_t_1 = __Pyx_PyInt_SubtractObjC(__pyx_v_r, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 661, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __pyx_t_3 = PyObject_GetItem(__pyx_v_seq1, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 661, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_1 = __Pyx_PyInt_SubtractObjC(__pyx_v_c, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 661, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __pyx_t_8 = PyObject_GetItem(__pyx_v_seq2, __pyx_t_1); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 661, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_8);
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_1 = PyObject_RichCompare(__pyx_t_3, __pyx_t_8, Py_EQ); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 661, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
      __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 661, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      if (__pyx_t_4) {

        /* "vapor_vali/Simple_function.pyx":662
 *             dDist=editDistance(seq1,seq2,cost_matrix,move_matrix,r-1,c) + dCost
 *             if seq1[r-1] == seq2[c-1]:
 *                 mDist=editDistance(seq1,seq2,cost_matrix,move_matrix,r-1,c-1)             # <<<<<<<<<<<<<<
 *             else:
 *                 mDist=editDistance(seq1,seq2,cost_matrix,move_matrix,r-1,c-1)+mCost
 */
        __pyx_t_8 = __Pyx_GetModuleGlobalName(__pyx_n_s_editDistance); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 662, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_8);
        __pyx_t_3 = __Pyx_PyInt_SubtractObjC(__pyx_v_r, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 662, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_3);
        __pyx_t_2 = __Pyx_PyInt_SubtractObjC(__pyx_v_c, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 662, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
        __pyx_t_6 = NULL;
        __pyx_t_7 = 0;
        if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_8))) {
          __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_8);
          if (likely(__pyx_t_6)) {
            PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_8);
            __Pyx_INCREF(__pyx_t_6);
            __Pyx_INCREF(function);
            __Pyx_DECREF_SET(__pyx_t_8, function);
            __pyx_t_7 = 1;
          }
        }
        __pyx_t_9 = PyTuple_New(6+__pyx_t_7); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 662, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_9);
        if (__pyx_t_6) {
          __Pyx_GIVEREF(__pyx_t_6); PyTuple_SET_ITEM(__pyx_t_9, 0, __pyx_t_6); __pyx_t_6 = NULL;
        }
        __Pyx_INCREF(__pyx_v_seq1);
        __Pyx_GIVEREF(__pyx_v_seq1);
        PyTuple_SET_ITEM(__pyx_t_9, 0+__pyx_t_7, __pyx_v_seq1);
        __Pyx_INCREF(__pyx_v_seq2);
        __Pyx_GIVEREF(__pyx_v_seq2);
        PyTuple_SET_ITEM(__pyx_t_9, 1+__pyx_t_7, __pyx_v_seq2);
        __Pyx_INCREF(__pyx_v_cost_matrix);
        __Pyx_GIVEREF(__pyx_v_cost_matrix);
        PyTuple_SET_ITEM(__pyx_t_9, 2+__pyx_t_7, __pyx_v_cost_matrix);
        __Pyx_INCREF(__pyx_v_move_matrix);
        __Pyx_GIVEREF(__pyx_v_move_matrix);
        PyTuple_SET_ITEM(__pyx_t_9, 3+__pyx_t_7, __pyx_v_move_matrix);
        __Pyx_GIVEREF(__pyx_t_3);
        PyTuple_SET_ITEM(__pyx_t_9, 4+__pyx_t_7, __pyx_t_3);
        __Pyx_GIVEREF(__pyx_t_2);
        PyTuple_SET_ITEM(__pyx_t_9, 5+__pyx_t_7, __pyx_t_2);
        __pyx_t_3 = 0;
        __pyx_t_2 = 0;
        __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_8, __pyx_t_9, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 662, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
        __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
        __pyx_v_mDist = __pyx_t_1;
        __pyx_t_1 = 0;

        /* "vapor_vali/Simple_function.pyx":661
 *             iDist=editDistance(seq1,seq2,cost_matrix,move_matrix,r,c-1) + iCost
 *             dDist=editDistance(seq1,seq2,cost_matrix,move_matrix,r-1,c) + dCost
 *             if seq1[r-1] == seq2[c-1]:             # <<<<<<<<<<<<<<
 *                 mDist=editDistance(seq1,seq2,cost_matrix,move_matrix,r-1,c-1)
 *             else:
 */
        goto __pyx_L7;
      }

      /* "vapor_vali/Simple_function.pyx":664
 *                 mDist=editDistance(seq1,seq2,cost_matrix,move_matrix,r-1,c-1)
 *             else:
 *                 mDist=editDistance(seq1,seq2,cost_matrix,move_matrix,r-1,c-1)+mCost             # <<<<<<<<<<<<<<
 *             if iDist<dDist:
 *                 if iDist < mDist:  # insertion is optimal
 */
      /*else*/ {
        __pyx_t_8 = __Pyx_GetModuleGlobalName(__pyx_n_s_editDistance); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 664, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_8);
        __pyx_t_9 = __Pyx_PyInt_SubtractObjC(__pyx_v_r, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 664, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_9);
        __pyx_t_2 = __Pyx_PyInt_SubtractObjC(__pyx_v_c, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 664, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
        __pyx_t_3 = NULL;
        __pyx_t_7 = 0;
        if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_8))) {
          __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_8);
          if (likely(__pyx_t_3)) {
            PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_8);
            __Pyx_INCREF(__pyx_t_3);
            __Pyx_INCREF(function);
            __Pyx_DECREF_SET(__pyx_t_8, function);
            __pyx_t_7 = 1;
          }
        }
        __pyx_t_6 = PyTuple_New(6+__pyx_t_7); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 664, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_6);
        if (__pyx_t_3) {
          __Pyx_GIVEREF(__pyx_t_3); PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_3); __pyx_t_3 = NULL;
        }
        __Pyx_INCREF(__pyx_v_seq1);
        __Pyx_GIVEREF(__pyx_v_seq1);
        PyTuple_SET_ITEM(__pyx_t_6, 0+__pyx_t_7, __pyx_v_seq1);
        __Pyx_INCREF(__pyx_v_seq2);
        __Pyx_GIVEREF(__pyx_v_seq2);
        PyTuple_SET_ITEM(__pyx_t_6, 1+__pyx_t_7, __pyx_v_seq2);
        __Pyx_INCREF(__pyx_v_cost_matrix);
        __Pyx_GIVEREF(__pyx_v_cost_matrix);
        PyTuple_SET_ITEM(__pyx_t_6, 2+__pyx_t_7, __pyx_v_cost_matrix);
        __Pyx_INCREF(__pyx_v_move_matrix);
        __Pyx_GIVEREF(__pyx_v_move_matrix);
        PyTuple_SET_ITEM(__pyx_t_6, 3+__pyx_t_7, __pyx_v_move_matrix);
        __Pyx_GIVEREF(__pyx_t_9);
        PyTuple_SET_ITEM(__pyx_t_6, 4+__pyx_t_7, __pyx_t_9);
        __Pyx_GIVEREF(__pyx_t_2);
        PyTuple_SET_ITEM(__pyx_t_6, 5+__pyx_t_7, __pyx_t_2);
        __pyx_t_9 = 0;
        __pyx_t_2 = 0;
        __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_8, __pyx_t_6, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 664, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
        __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
        __pyx_t_8 = PyNumber_Add(__pyx_t_1, __pyx_v_mCost); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 664, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_8);
        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
        __pyx_v_mDist = __pyx_t_8;
        __pyx_t_8 = 0;
      }
      __pyx_L7:;

      /* "vapor_vali/Simple_function.pyx":665
 *             else:
 *                 mDist=editDistance(seq1,seq2,cost_matrix,move_matrix,r-1,c-1)+mCost
 *             if iDist<dDist:             # <<<<<<<<<<<<<<
 *                 if iDist < mDist:  # insertion is optimal
 *                     move_matrix[r][c] = 0
 */
      __pyx_t_8 = PyObject_RichCompare(__pyx_v_iDist, __pyx_v_dDist, Py_LT); __Pyx_XGOTREF(__pyx_t_8); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 665, __pyx_L1_error)
      __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_8); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 665, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
      if (__pyx_t_4) {

        /* "vapor_vali/Simple_function.pyx":666
 *                 mDist=editDistance(seq1,seq2,cost_matrix,move_matrix,r-1,c-1)+mCost
 *             if iDist<dDist:
 *                 if iDist < mDist:  # insertion is optimal             # <<<<<<<<<<<<<<
 *                     move_matrix[r][c] = 0
 *                     cost_matrix[r][c] = iDist
 */
        __pyx_t_8 = PyObject_RichCompare(__pyx_v_iDist, __pyx_v_mDist, Py_LT); __Pyx_XGOTREF(__pyx_t_8); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 666, __pyx_L1_error)
        __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_8); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 666, __pyx_L1_error)
        __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
        if (__pyx_t_4) {

          /* "vapor_vali/Simple_function.pyx":667
 *             if iDist<dDist:
 *                 if iDist < mDist:  # insertion is optimal
 *                     move_matrix[r][c] = 0             # <<<<<<<<<<<<<<
 *                     cost_matrix[r][c] = iDist
 *                 else:    #match is optimal
 */
          __pyx_t_8 = PyObject_GetItem(__pyx_v_move_matrix, __pyx_v_r); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 667, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_8);
          if (unlikely(PyObject_SetItem(__pyx_t_8, __pyx_v_c, __pyx_int_0) < 0)) __PYX_ERR(0, 667, __pyx_L1_error)
          __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;

          /* "vapor_vali/Simple_function.pyx":668
 *                 if iDist < mDist:  # insertion is optimal
 *                     move_matrix[r][c] = 0
 *                     cost_matrix[r][c] = iDist             # <<<<<<<<<<<<<<
 *                 else:    #match is optimal
 *                     move_matrix[r][c] = 2
 */
          __pyx_t_8 = PyObject_GetItem(__pyx_v_cost_matrix, __pyx_v_r); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 668, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_8);
          if (unlikely(PyObject_SetItem(__pyx_t_8, __pyx_v_c, __pyx_v_iDist) < 0)) __PYX_ERR(0, 668, __pyx_L1_error)
          __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;

          /* "vapor_vali/Simple_function.pyx":666
 *                 mDist=editDistance(seq1,seq2,cost_matrix,move_matrix,r-1,c-1)+mCost
 *             if iDist<dDist:
 *                 if iDist < mDist:  # insertion is optimal             # <<<<<<<<<<<<<<
 *                     move_matrix[r][c] = 0
 *                     cost_matrix[r][c] = iDist
 */
          goto __pyx_L9;
        }

        /* "vapor_vali/Simple_function.pyx":670
 *                     cost_matrix[r][c] = iDist
 *                 else:    #match is optimal
 *                     move_matrix[r][c] = 2             # <<<<<<<<<<<<<<
 *                     cost_matrix[r][c] = mDist
 *             else:
 */
        /*else*/ {
          __pyx_t_8 = PyObject_GetItem(__pyx_v_move_matrix, __pyx_v_r); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 670, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_8);
          if (unlikely(PyObject_SetItem(__pyx_t_8, __pyx_v_c, __pyx_int_2) < 0)) __PYX_ERR(0, 670, __pyx_L1_error)
          __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;

          /* "vapor_vali/Simple_function.pyx":671
 *                 else:    #match is optimal
 *                     move_matrix[r][c] = 2
 *                     cost_matrix[r][c] = mDist             # <<<<<<<<<<<<<<
 *             else:
 *                 if dDist < mDist:    #deletion is optimal
 */
          __pyx_t_8 = PyObject_GetItem(__pyx_v_cost_matrix, __pyx_v_r); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 671, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_8);
          if (unlikely(PyObject_SetItem(__pyx_t_8, __pyx_v_c, __pyx_v_mDist) < 0)) __PYX_ERR(0, 671, __pyx_L1_error)
          __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
        }
        __pyx_L9:;

        /* "vapor_vali/Simple_function.pyx":665
 *             else:
 *                 mDist=editDistance(seq1,seq2,cost_matrix,move_matrix,r-1,c-1)+mCost
 *             if iDist<dDist:             # <<<<<<<<<<<<<<
 *                 if iDist < mDist:  # insertion is optimal
 *                     move_matrix[r][c] = 0
 */
        goto __pyx_L8;
      }

      /* "vapor_vali/Simple_function.pyx":673
 *                     cost_matrix[r][c] = mDist
 *             else:
 *                 if dDist < mDist:    #deletion is optimal             # <<<<<<<<<<<<<<
 *                     move_matrix[r][c]=1
 *                     cost_matrix[r][c]=dDist
 */
      /*else*/ {
        __pyx_t_8 = PyObject_RichCompare(__pyx_v_dDist, __pyx_v_mDist, Py_LT); __Pyx_XGOTREF(__pyx_t_8); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 673, __pyx_L1_error)
        __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_8); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 673, __pyx_L1_error)
        __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
        if (__pyx_t_4) {

          /* "vapor_vali/Simple_function.pyx":674
 *             else:
 *                 if dDist < mDist:    #deletion is optimal
 *                     move_matrix[r][c]=1             # <<<<<<<<<<<<<<
 *                     cost_matrix[r][c]=dDist
 *                 else:    #match is optimal
 */
          __pyx_t_8 = PyObject_GetItem(__pyx_v_move_matrix, __pyx_v_r); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 674, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_8);
          if (unlikely(PyObject_SetItem(__pyx_t_8, __pyx_v_c, __pyx_int_1) < 0)) __PYX_ERR(0, 674, __pyx_L1_error)
          __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;

          /* "vapor_vali/Simple_function.pyx":675
 *                 if dDist < mDist:    #deletion is optimal
 *                     move_matrix[r][c]=1
 *                     cost_matrix[r][c]=dDist             # <<<<<<<<<<<<<<
 *                 else:    #match is optimal
 *                     move_matrix[r][c]=2
 */
          __pyx_t_8 = PyObject_GetItem(__pyx_v_cost_matrix, __pyx_v_r); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 675, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_8);
          if (unlikely(PyObject_SetItem(__pyx_t_8, __pyx_v_c, __pyx_v_dDist) < 0)) __PYX_ERR(0, 675, __pyx_L1_error)
          __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;

          /* "vapor_vali/Simple_function.pyx":673
 *                     cost_matrix[r][c] = mDist
 *             else:
 *                 if dDist < mDist:    #deletion is optimal             # <<<<<<<<<<<<<<
 *                     move_matrix[r][c]=1
 *                     cost_matrix[r][c]=dDist
 */
          goto __pyx_L10;
        }

        /* "vapor_vali/Simple_function.pyx":677
 *                     cost_matrix[r][c]=dDist
 *                 else:    #match is optimal
 *                     move_matrix[r][c]=2             # <<<<<<<<<<<<<<
 *                     cost_matrix[r][c]=mDist
 *     return cost_matrix[r][c]
 */
        /*else*/ {
          __pyx_t_8 = PyObject_GetItem(__pyx_v_move_matrix, __pyx_v_r); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 677, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_8);
          if (unlikely(PyObject_SetItem(__pyx_t_8, __pyx_v_c, __pyx_int_2) < 0)) __PYX_ERR(0, 677, __pyx_L1_error)
          __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;

          /* "vapor_vali/Simple_function.pyx":678
 *                 else:    #match is optimal
 *                     move_matrix[r][c]=2
 *                     cost_matrix[r][c]=mDist             # <<<<<<<<<<<<<<
 *     return cost_matrix[r][c]
 * 
 */
          __pyx_t_8 = PyObject_GetItem(__pyx_v_cost_matrix, __pyx_v_r); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 678, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_8);
          if (unlikely(PyObject_SetItem(__pyx_t_8, __pyx_v_c, __pyx_v_mDist) < 0)) __PYX_ERR(0, 678, __pyx_L1_error)
          __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
        }
        __pyx_L10:;
      }
      __pyx_L8:;
    }
    __pyx_L4:;

    /* "vapor_vali/Simple_function.pyx":649
 * def editDistance(seq1,seq2,cost_matrix,move_matrix,r,c):
 *     [iCost, dCost , mCost]=[1,1,1]
 *     if cost_matrix[r][c]==float('inf'):             # <<<<<<<<<<<<<<
 *         if r==0 and c==0:
 *             cost_matrix[r][c]=0
 */
  }

  /* "vapor_vali/Simple_function.pyx":679
 *                     move_matrix[r][c]=2
 *                     cost_matrix[r][c]=mDist
 *     return cost_matrix[r][c]             # <<<<<<<<<<<<<<
 * 
 * def edit_dis_setup(seq1,seq2):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_8 = PyObject_GetItem(__pyx_v_cost_matrix, __pyx_v_r); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 679, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_8);
  __pyx_t_1 = PyObject_GetItem(__pyx_t_8, __pyx_v_c); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 679, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* "vapor_vali/Simple_function.pyx":647
 *         return vec4
 * 
 * def editDistance(seq1,seq2,cost_matrix,move_matrix,r,c):             # <<<<<<<<<<<<<<
 *     [iCost, dCost , mCost]=[1,1,1]
 *     if cost_matrix[r][c]==float('inf'):
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_XDECREF(__pyx_t_8);
  __Pyx_XDECREF(__pyx_t_9);
  __Pyx_AddTraceback("vapor_vali.Simple_function.editDistance", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_iCost);
  __Pyx_XDECREF(__pyx_v_dCost);
  __Pyx_XDECREF(__pyx_v_mCost);
  __Pyx_XDECREF(__pyx_v_iDist);
  __Pyx_XDECREF(__pyx_v_dDist);
  __Pyx_XDECREF(__pyx_v_mDist);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "vapor_vali/Simple_function.pyx":681
 *     return cost_matrix[r][c]
 * 
 * def edit_dis_setup(seq1,seq2):             # <<<<<<<<<<<<<<
 *     cost_matrix=np.full((len(seq1)+1,len(seq2)+1),np.inf)
 *     move_matrix=np.full((len(seq1)+1,len(seq2)+1),-1.0)
 */

/* Python wrapper */
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_85edit_dis_setup(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_10vapor_vali_15Simple_function_85edit_dis_setup = {"edit_dis_setup", (PyCFunction)__pyx_pw_10vapor_vali_15Simple_function_85edit_dis_setup, METH_VARARGS|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_85edit_dis_setup(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_seq1 = 0;
  PyObject *__pyx_v_seq2 = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("edit_dis_setup (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_seq1,&__pyx_n_s_seq2,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_seq1)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_seq2)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("edit_dis_setup", 1, 2, 2, 1); __PYX_ERR(0, 681, __pyx_L3_error)
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "edit_dis_setup") < 0)) __PYX_ERR(0, 681, __pyx_L3_error)
      }
    } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
    }
    __pyx_v_seq1 = values[0];
    __pyx_v_seq2 = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("edit_dis_setup", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 681, __pyx_L3_error)
  __pyx_L3_error:;
  __Pyx_AddTraceback("vapor_vali.Simple_function.edit_dis_setup", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_10vapor_vali_15Simple_function_84edit_dis_setup(__pyx_self, __pyx_v_seq1, __pyx_v_seq2);

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10vapor_vali_15Simple_function_84edit_dis_setup(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_seq1, PyObject *__pyx_v_seq2) {
  PyObject *__pyx_v_cost_matrix = NULL;
  PyObject *__pyx_v_move_matrix = NULL;
  PyObject *__pyx_v_opt_dist = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  Py_ssize_t __pyx_t_4;
  PyObject *__pyx_t_5 = NULL;
  PyObject *__pyx_t_6 = NULL;
  PyObject *__pyx_t_7 = NULL;
  __Pyx_RefNannySetupContext("edit_dis_setup", 0);

  /* "vapor_vali/Simple_function.pyx":682
 * 
 * def edit_dis_setup(seq1,seq2):
 *     cost_matrix=np.full((len(seq1)+1,len(seq2)+1),np.inf)             # <<<<<<<<<<<<<<
 *     move_matrix=np.full((len(seq1)+1,len(seq2)+1),-1.0)
 *     opt_dist=editDistance(seq1, seq2, cost_matrix,move_matrix, len(seq1), len(seq2))
 */
  __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 682, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_full); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 682, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_4 = PyObject_Length(__pyx_v_seq1); if (unlikely(__pyx_t_4 == -1)) __PYX_ERR(0, 682, __pyx_L1_error)
  __pyx_t_2 = PyInt_FromSsize_t((__pyx_t_4 + 1)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 682, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_4 = PyObject_Length(__pyx_v_seq2); if (unlikely(__pyx_t_4 == -1)) __PYX_ERR(0, 682, __pyx_L1_error)
  __pyx_t_5 = PyInt_FromSsize_t((__pyx_t_4 + 1)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 682, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_6 = PyTuple_New(2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 682, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_GIVEREF(__pyx_t_2);
  PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_2);
  __Pyx_GIVEREF(__pyx_t_5);
  PyTuple_SET_ITEM(__pyx_t_6, 1, __pyx_t_5);
  __pyx_t_2 = 0;
  __pyx_t_5 = 0;
  __pyx_t_5 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 682, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_inf); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 682, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = NULL;
  __pyx_t_4 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_3))) {
    __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_3);
    if (likely(__pyx_t_5)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
      __Pyx_INCREF(__pyx_t_5);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_3, function);
      __pyx_t_4 = 1;
    }
  }
  __pyx_t_7 = PyTuple_New(2+__pyx_t_4); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 682, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  if (__pyx_t_5) {
    __Pyx_GIVEREF(__pyx_t_5); PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_5); __pyx_t_5 = NULL;
  }
  __Pyx_GIVEREF(__pyx_t_6);
  PyTuple_SET_ITEM(__pyx_t_7, 0+__pyx_t_4, __pyx_t_6);
  __Pyx_GIVEREF(__pyx_t_2);
  PyTuple_SET_ITEM(__pyx_t_7, 1+__pyx_t_4, __pyx_t_2);
  __pyx_t_6 = 0;
  __pyx_t_2 = 0;
  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_7, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 682, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_cost_matrix = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":683
 * def edit_dis_setup(seq1,seq2):
 *     cost_matrix=np.full((len(seq1)+1,len(seq2)+1),np.inf)
 *     move_matrix=np.full((len(seq1)+1,len(seq2)+1),-1.0)             # <<<<<<<<<<<<<<
 *     opt_dist=editDistance(seq1, seq2, cost_matrix,move_matrix, len(seq1), len(seq2))
 *     return opt_dist
 */
  __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 683, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_full); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 683, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_4 = PyObject_Length(__pyx_v_seq1); if (unlikely(__pyx_t_4 == -1)) __PYX_ERR(0, 683, __pyx_L1_error)
  __pyx_t_3 = PyInt_FromSsize_t((__pyx_t_4 + 1)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 683, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_4 = PyObject_Length(__pyx_v_seq2); if (unlikely(__pyx_t_4 == -1)) __PYX_ERR(0, 683, __pyx_L1_error)
  __pyx_t_2 = PyInt_FromSsize_t((__pyx_t_4 + 1)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 683, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_6 = PyTuple_New(2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 683, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_GIVEREF(__pyx_t_3);
  PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_3);
  __Pyx_GIVEREF(__pyx_t_2);
  PyTuple_SET_ITEM(__pyx_t_6, 1, __pyx_t_2);
  __pyx_t_3 = 0;
  __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  __pyx_t_4 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_7))) {
    __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_7);
    if (likely(__pyx_t_2)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_7);
      __Pyx_INCREF(__pyx_t_2);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_7, function);
      __pyx_t_4 = 1;
    }
  }
  __pyx_t_3 = PyTuple_New(2+__pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 683, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  if (__pyx_t_2) {
    __Pyx_GIVEREF(__pyx_t_2); PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_2); __pyx_t_2 = NULL;
  }
  __Pyx_GIVEREF(__pyx_t_6);
  PyTuple_SET_ITEM(__pyx_t_3, 0+__pyx_t_4, __pyx_t_6);
  __Pyx_INCREF(__pyx_float_neg_1_0);
  __Pyx_GIVEREF(__pyx_float_neg_1_0);
  PyTuple_SET_ITEM(__pyx_t_3, 1+__pyx_t_4, __pyx_float_neg_1_0);
  __pyx_t_6 = 0;
  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_7, __pyx_t_3, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 683, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_v_move_matrix = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":684
 *     cost_matrix=np.full((len(seq1)+1,len(seq2)+1),np.inf)
 *     move_matrix=np.full((len(seq1)+1,len(seq2)+1),-1.0)
 *     opt_dist=editDistance(seq1, seq2, cost_matrix,move_matrix, len(seq1), len(seq2))             # <<<<<<<<<<<<<<
 *     return opt_dist
 * 
 */
  __pyx_t_7 = __Pyx_GetModuleGlobalName(__pyx_n_s_editDistance); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 684, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  __pyx_t_4 = PyObject_Length(__pyx_v_seq1); if (unlikely(__pyx_t_4 == -1)) __PYX_ERR(0, 684, __pyx_L1_error)
  __pyx_t_3 = PyInt_FromSsize_t(__pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 684, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_4 = PyObject_Length(__pyx_v_seq2); if (unlikely(__pyx_t_4 == -1)) __PYX_ERR(0, 684, __pyx_L1_error)
  __pyx_t_6 = PyInt_FromSsize_t(__pyx_t_4); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 684, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_2 = NULL;
  __pyx_t_4 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_7))) {
    __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_7);
    if (likely(__pyx_t_2)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_7);
      __Pyx_INCREF(__pyx_t_2);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_7, function);
      __pyx_t_4 = 1;
    }
  }
  __pyx_t_5 = PyTuple_New(6+__pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 684, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  if (__pyx_t_2) {
    __Pyx_GIVEREF(__pyx_t_2); PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_2); __pyx_t_2 = NULL;
  }
  __Pyx_INCREF(__pyx_v_seq1);
  __Pyx_GIVEREF(__pyx_v_seq1);
  PyTuple_SET_ITEM(__pyx_t_5, 0+__pyx_t_4, __pyx_v_seq1);
  __Pyx_INCREF(__pyx_v_seq2);
  __Pyx_GIVEREF(__pyx_v_seq2);
  PyTuple_SET_ITEM(__pyx_t_5, 1+__pyx_t_4, __pyx_v_seq2);
  __Pyx_INCREF(__pyx_v_cost_matrix);
  __Pyx_GIVEREF(__pyx_v_cost_matrix);
  PyTuple_SET_ITEM(__pyx_t_5, 2+__pyx_t_4, __pyx_v_cost_matrix);
  __Pyx_INCREF(__pyx_v_move_matrix);
  __Pyx_GIVEREF(__pyx_v_move_matrix);
  PyTuple_SET_ITEM(__pyx_t_5, 3+__pyx_t_4, __pyx_v_move_matrix);
  __Pyx_GIVEREF(__pyx_t_3);
  PyTuple_SET_ITEM(__pyx_t_5, 4+__pyx_t_4, __pyx_t_3);
  __Pyx_GIVEREF(__pyx_t_6);
  PyTuple_SET_ITEM(__pyx_t_5, 5+__pyx_t_4, __pyx_t_6);
  __pyx_t_3 = 0;
  __pyx_t_6 = 0;
  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_7, __pyx_t_5, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 684, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_v_opt_dist = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":685
 *     move_matrix=np.full((len(seq1)+1,len(seq2)+1),-1.0)
 *     opt_dist=editDistance(seq1, seq2, cost_matrix,move_matrix, len(seq1), len(seq2))
 *     return opt_dist             # <<<<<<<<<<<<<<
 * 
 * def eu_dis_abs_calcu(ref_clean_dotdata):
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_opt_dist);
  __pyx_r = __pyx_v_opt_dist;
  goto __pyx_L0;

  /* "vapor_vali/Simple_function.pyx":681
 *     return cost_matrix[r][c]
 * 
 * def edit_dis_setup(seq1,seq2):             # <<<<<<<<<<<<<<
 *     cost_matrix=np.full((len(seq1)+1,len(seq2)+1),np.inf)
 *     move_matrix=np.full((len(seq1)+1,len(seq2)+1),-1.0)
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_XDECREF(__pyx_t_7);
  __Pyx_AddTraceback("vapor_vali.Simple_function.edit_dis_setup", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_cost_matrix);
  __Pyx_XDECREF(__pyx_v_move_matrix);
  __Pyx_XDECREF(__pyx_v_opt_dist);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "vapor_vali/Simple_function.pyx":687
 *     return opt_dist
 * 
 * def eu_dis_abs_calcu(ref_clean_dotdata):             # <<<<<<<<<<<<<<
 *     #eg of ref_clean_dotdata=[[2380, 471], [2381, 472], [2382, 472], [2383, 472], [2384, 472], [2385, 472], [2386, 472], [2387, 472], [2388, 472], [2389, 473], [2390, 474], [2391, 475], [2402, 486], [2403, 487], [2404, 488], [2405, 489], [2406, 490], [2407, 491], [2408, 492], [2409, 493], [2410, 494], [2411, 495], [2418, 504], [2440, 528], [2441, 529], [2442, 530], [2443, 531], [2454, 542], [2455, 543], [2456, 544], [2473, 563], [2474, 564], [2475, 565], [2476, 566], [2477, 567], [2478, 568], [2479, 569], [2480, 570], [2481, 571], [2482, 572], [2483, 573], [2484, 574], [2485, 575], [2486, 576], [2487, 577], [2488, 578], [2489, 579], [2490, 580], [2500, 589], [2501, 590], [2502, 591], [2503, 592], [2504, 593], [2523, 613], [2524, 614], [2525, 615], [2526, 616], [2527, 617], [2528, 618], [2529, 619], [2530, 620], [2531, 621], [2532, 622], [2533, 623], [2557, 642], [2558, 643], [2559, 644], [2560, 645], [2561, 646], [2562, 647]]
 *     eu_dis_abs=[abs(i[0]-i[1]) for i in ref_clean_dotdata]
 */

/* Python wrapper */
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_87eu_dis_abs_calcu(PyObject *__pyx_self, PyObject *__pyx_v_ref_clean_dotdata); /*proto*/
static PyMethodDef __pyx_mdef_10vapor_vali_15Simple_function_87eu_dis_abs_calcu = {"eu_dis_abs_calcu", (PyCFunction)__pyx_pw_10vapor_vali_15Simple_function_87eu_dis_abs_calcu, METH_O, 0};
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_87eu_dis_abs_calcu(PyObject *__pyx_self, PyObject *__pyx_v_ref_clean_dotdata) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("eu_dis_abs_calcu (wrapper)", 0);
  __pyx_r = __pyx_pf_10vapor_vali_15Simple_function_86eu_dis_abs_calcu(__pyx_self, ((PyObject *)__pyx_v_ref_clean_dotdata));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10vapor_vali_15Simple_function_86eu_dis_abs_calcu(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_ref_clean_dotdata) {
  PyObject *__pyx_v_eu_dis_abs = NULL;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  Py_ssize_t __pyx_t_3;
  PyObject *(*__pyx_t_4)(PyObject *);
  PyObject *__pyx_t_5 = NULL;
  PyObject *__pyx_t_6 = NULL;
  PyObject *__pyx_t_7 = NULL;
  __Pyx_RefNannySetupContext("eu_dis_abs_calcu", 0);

  /* "vapor_vali/Simple_function.pyx":689
 * def eu_dis_abs_calcu(ref_clean_dotdata):
 *     #eg of ref_clean_dotdata=[[2380, 471], [2381, 472], [2382, 472], [2383, 472], [2384, 472], [2385, 472], [2386, 472], [2387, 472], [2388, 472], [2389, 473], [2390, 474], [2391, 475], [2402, 486], [2403, 487], [2404, 488], [2405, 489], [2406, 490], [2407, 491], [2408, 492], [2409, 493], [2410, 494], [2411, 495], [2418, 504], [2440, 528], [2441, 529], [2442, 530], [2443, 531], [2454, 542], [2455, 543], [2456, 544], [2473, 563], [2474, 564], [2475, 565], [2476, 566], [2477, 567], [2478, 568], [2479, 569], [2480, 570], [2481, 571], [2482, 572], [2483, 573], [2484, 574], [2485, 575], [2486, 576], [2487, 577], [2488, 578], [2489, 579], [2490, 580], [2500, 589], [2501, 590], [2502, 591], [2503, 592], [2504, 593], [2523, 613], [2524, 614], [2525, 615], [2526, 616], [2527, 617], [2528, 618], [2529, 619], [2530, 620], [2531, 621], [2532, 622], [2533, 623], [2557, 642], [2558, 643], [2559, 644], [2560, 645], [2561, 646], [2562, 647]]
 *     eu_dis_abs=[abs(i[0]-i[1]) for i in ref_clean_dotdata]             # <<<<<<<<<<<<<<
 *     return np.mean(eu_dis_abs)
 * 
 */
  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 689, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  if (likely(PyList_CheckExact(__pyx_v_ref_clean_dotdata)) || PyTuple_CheckExact(__pyx_v_ref_clean_dotdata)) {
    __pyx_t_2 = __pyx_v_ref_clean_dotdata; __Pyx_INCREF(__pyx_t_2); __pyx_t_3 = 0;
    __pyx_t_4 = NULL;
  } else {
    __pyx_t_3 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_v_ref_clean_dotdata); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 689, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_4 = Py_TYPE(__pyx_t_2)->tp_iternext; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 689, __pyx_L1_error)
  }
  for (;;) {
    if (likely(!__pyx_t_4)) {
      if (likely(PyList_CheckExact(__pyx_t_2))) {
        if (__pyx_t_3 >= PyList_GET_SIZE(__pyx_t_2)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_5 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_3); __Pyx_INCREF(__pyx_t_5); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 689, __pyx_L1_error)
        #else
        __pyx_t_5 = PySequence_ITEM(__pyx_t_2, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 689, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_5);
        #endif
      } else {
        if (__pyx_t_3 >= PyTuple_GET_SIZE(__pyx_t_2)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_5 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_3); __Pyx_INCREF(__pyx_t_5); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 689, __pyx_L1_error)
        #else
        __pyx_t_5 = PySequence_ITEM(__pyx_t_2, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 689, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_5);
        #endif
      }
    } else {
      __pyx_t_5 = __pyx_t_4(__pyx_t_2);
      if (unlikely(!__pyx_t_5)) {
        PyObject* exc_type = PyErr_Occurred();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
          else __PYX_ERR(0, 689, __pyx_L1_error)
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_5);
    }
    __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_5);
    __pyx_t_5 = 0;
    __pyx_t_5 = __Pyx_GetItemInt(__pyx_v_i, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 689, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __pyx_t_6 = __Pyx_GetItemInt(__pyx_v_i, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 689, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __pyx_t_7 = PyNumber_Subtract(__pyx_t_5, __pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 689, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = PyNumber_Absolute(__pyx_t_7); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 689, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
    if (unlikely(__Pyx_ListComp_Append(__pyx_t_1, (PyObject*)__pyx_t_6))) __PYX_ERR(0, 689, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  }
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_eu_dis_abs = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":690
 *     #eg of ref_clean_dotdata=[[2380, 471], [2381, 472], [2382, 472], [2383, 472], [2384, 472], [2385, 472], [2386, 472], [2387, 472], [2388, 472], [2389, 473], [2390, 474], [2391, 475], [2402, 486], [2403, 487], [2404, 488], [2405, 489], [2406, 490], [2407, 491], [2408, 492], [2409, 493], [2410, 494], [2411, 495], [2418, 504], [2440, 528], [2441, 529], [2442, 530], [2443, 531], [2454, 542], [2455, 543], [2456, 544], [2473, 563], [2474, 564], [2475, 565], [2476, 566], [2477, 567], [2478, 568], [2479, 569], [2480, 570], [2481, 571], [2482, 572], [2483, 573], [2484, 574], [2485, 575], [2486, 576], [2487, 577], [2488, 578], [2489, 579], [2490, 580], [2500, 589], [2501, 590], [2502, 591], [2503, 592], [2504, 593], [2523, 613], [2524, 614], [2525, 615], [2526, 616], [2527, 617], [2528, 618], [2529, 619], [2530, 620], [2531, 621], [2532, 622], [2533, 623], [2557, 642], [2558, 643], [2559, 644], [2560, 645], [2561, 646], [2562, 647]]
 *     eu_dis_abs=[abs(i[0]-i[1]) for i in ref_clean_dotdata]
 *     return np.mean(eu_dis_abs)             # <<<<<<<<<<<<<<
 * 
 * def eu_dis_single_dot(dot_pos):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 690, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_mean); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 690, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_6))) {
    __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_6);
    if (likely(__pyx_t_2)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
      __Pyx_INCREF(__pyx_t_2);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_6, function);
    }
  }
  if (!__pyx_t_2) {
    __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_v_eu_dis_abs); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 690, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
  } else {
    __pyx_t_7 = PyTuple_New(1+1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 690, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    __Pyx_GIVEREF(__pyx_t_2); PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_2); __pyx_t_2 = NULL;
    __Pyx_INCREF(__pyx_v_eu_dis_abs);
    __Pyx_GIVEREF(__pyx_v_eu_dis_abs);
    PyTuple_SET_ITEM(__pyx_t_7, 0+1, __pyx_v_eu_dis_abs);
    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_7, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 690, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
  }
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* "vapor_vali/Simple_function.pyx":687
 *     return opt_dist
 * 
 * def eu_dis_abs_calcu(ref_clean_dotdata):             # <<<<<<<<<<<<<<
 *     #eg of ref_clean_dotdata=[[2380, 471], [2381, 472], [2382, 472], [2383, 472], [2384, 472], [2385, 472], [2386, 472], [2387, 472], [2388, 472], [2389, 473], [2390, 474], [2391, 475], [2402, 486], [2403, 487], [2404, 488], [2405, 489], [2406, 490], [2407, 491], [2408, 492], [2409, 493], [2410, 494], [2411, 495], [2418, 504], [2440, 528], [2441, 529], [2442, 530], [2443, 531], [2454, 542], [2455, 543], [2456, 544], [2473, 563], [2474, 564], [2475, 565], [2476, 566], [2477, 567], [2478, 568], [2479, 569], [2480, 570], [2481, 571], [2482, 572], [2483, 573], [2484, 574], [2485, 575], [2486, 576], [2487, 577], [2488, 578], [2489, 579], [2490, 580], [2500, 589], [2501, 590], [2502, 591], [2503, 592], [2504, 593], [2523, 613], [2524, 614], [2525, 615], [2526, 616], [2527, 617], [2528, 618], [2529, 619], [2530, 620], [2531, 621], [2532, 622], [2533, 623], [2557, 642], [2558, 643], [2559, 644], [2560, 645], [2561, 646], [2562, 647]]
 *     eu_dis_abs=[abs(i[0]-i[1]) for i in ref_clean_dotdata]
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_XDECREF(__pyx_t_7);
  __Pyx_AddTraceback("vapor_vali.Simple_function.eu_dis_abs_calcu", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_eu_dis_abs);
  __Pyx_XDECREF(__pyx_v_i);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "vapor_vali/Simple_function.pyx":692
 *     return np.mean(eu_dis_abs)
 * 
 * def eu_dis_single_dot(dot_pos):             # <<<<<<<<<<<<<<
 *     #############################################
 *     ####eg of dot_pos=(1212, 1217)
 */

/* Python wrapper */
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_89eu_dis_single_dot(PyObject *__pyx_self, PyObject *__pyx_v_dot_pos); /*proto*/
static PyMethodDef __pyx_mdef_10vapor_vali_15Simple_function_89eu_dis_single_dot = {"eu_dis_single_dot", (PyCFunction)__pyx_pw_10vapor_vali_15Simple_function_89eu_dis_single_dot, METH_O, 0};
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_89eu_dis_single_dot(PyObject *__pyx_self, PyObject *__pyx_v_dot_pos) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("eu_dis_single_dot (wrapper)", 0);
  __pyx_r = __pyx_pf_10vapor_vali_15Simple_function_88eu_dis_single_dot(__pyx_self, ((PyObject *)__pyx_v_dot_pos));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10vapor_vali_15Simple_function_88eu_dis_single_dot(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_dot_pos) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  int __pyx_t_3;
  PyObject *__pyx_t_4 = NULL;
  double __pyx_t_5;
  double __pyx_t_6;
  __Pyx_RefNannySetupContext("eu_dis_single_dot", 0);

  /* "vapor_vali/Simple_function.pyx":697
 *     ####this function returns %deviation of the dot from diagnal
 *     #############################################
 *     if dot_pos[0]==0:   return abs(float(dot_pos[0]-dot_pos[1])/float(dot_pos[0]+1))             # <<<<<<<<<<<<<<
 *     else:               return abs(float(dot_pos[0]-dot_pos[1])/float(dot_pos[0]))
 * 
 */
  __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_dot_pos, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 697, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyInt_EqObjC(__pyx_t_1, __pyx_int_0, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 697, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_3 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_3 < 0)) __PYX_ERR(0, 697, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  if (__pyx_t_3) {
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_dot_pos, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 697, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_dot_pos, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 697, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_4 = PyNumber_Subtract(__pyx_t_2, __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 697, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_5 = __Pyx_PyObject_AsDouble(__pyx_t_4); if (unlikely(__pyx_t_5 == ((double)-1) && PyErr_Occurred())) __PYX_ERR(0, 697, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = __Pyx_GetItemInt(__pyx_v_dot_pos, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 697, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_1 = __Pyx_PyInt_AddObjC(__pyx_t_4, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 697, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_6 = __Pyx_PyObject_AsDouble(__pyx_t_1); if (unlikely(__pyx_t_6 == ((double)-1) && PyErr_Occurred())) __PYX_ERR(0, 697, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    if (unlikely(__pyx_t_6 == 0)) {
      PyErr_SetString(PyExc_ZeroDivisionError, "float division");
      __PYX_ERR(0, 697, __pyx_L1_error)
    }
    __pyx_t_1 = PyFloat_FromDouble(fabs((__pyx_t_5 / __pyx_t_6))); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 697, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;
  }

  /* "vapor_vali/Simple_function.pyx":698
 *     #############################################
 *     if dot_pos[0]==0:   return abs(float(dot_pos[0]-dot_pos[1])/float(dot_pos[0]+1))
 *     else:               return abs(float(dot_pos[0]-dot_pos[1])/float(dot_pos[0]))             # <<<<<<<<<<<<<<
 * 
 * def eu_dis_dir_calcu(list_dotdata):
 */
  /*else*/ {
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_dot_pos, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 698, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_4 = __Pyx_GetItemInt(__pyx_v_dot_pos, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 698, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_2 = PyNumber_Subtract(__pyx_t_1, __pyx_t_4); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 698, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_6 = __Pyx_PyObject_AsDouble(__pyx_t_2); if (unlikely(__pyx_t_6 == ((double)-1) && PyErr_Occurred())) __PYX_ERR(0, 698, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_dot_pos, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 698, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_5 = __Pyx_PyObject_AsDouble(__pyx_t_2); if (unlikely(__pyx_t_5 == ((double)-1) && PyErr_Occurred())) __PYX_ERR(0, 698, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    if (unlikely(__pyx_t_5 == 0)) {
      PyErr_SetString(PyExc_ZeroDivisionError, "float division");
      __PYX_ERR(0, 698, __pyx_L1_error)
    }
    __pyx_t_2 = PyFloat_FromDouble(fabs((__pyx_t_6 / __pyx_t_5))); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 698, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;
  }

  /* "vapor_vali/Simple_function.pyx":692
 *     return np.mean(eu_dis_abs)
 * 
 * def eu_dis_single_dot(dot_pos):             # <<<<<<<<<<<<<<
 *     #############################################
 *     ####eg of dot_pos=(1212, 1217)
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_AddTraceback("vapor_vali.Simple_function.eu_dis_single_dot", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "vapor_vali/Simple_function.pyx":700
 *     else:               return abs(float(dot_pos[0]-dot_pos[1])/float(dot_pos[0]))
 * 
 * def eu_dis_dir_calcu(list_dotdata):             # <<<<<<<<<<<<<<
 *     #eg of list_dotdata=[[2380, 471], [2381, 472], [2382, 472], [2383, 472], [2384, 472], [2385, 472], [2386, 472], [2387, 472], [2388, 472], [2389, 473], [2390, 474], [2391, 475], [2402, 486], [2403, 487], [2404, 488], [2405, 489], [2406, 490], [2407, 491], [2408, 492], [2409, 493], [2410, 494], [2411, 495], [2418, 504], [2440, 528], [2441, 529], [2442, 530], [2443, 531], [2454, 542], [2455, 543], [2456, 544], [2473, 563], [2474, 564], [2475, 565], [2476, 566], [2477, 567], [2478, 568], [2479, 569], [2480, 570], [2481, 571], [2482, 572], [2483, 573], [2484, 574], [2485, 575], [2486, 576], [2487, 577], [2488, 578], [2489, 579], [2490, 580], [2500, 589], [2501, 590], [2502, 591], [2503, 592], [2504, 593], [2523, 613], [2524, 614], [2525, 615], [2526, 616], [2527, 617], [2528, 618], [2529, 619], [2530, 620], [2531, 621], [2532, 622], [2533, 623], [2557, 642], [2558, 643], [2559, 644], [2560, 645], [2561, 646], [2562, 647]]
 *     eu_dis_abs=[i[0]-i[1] for i in list_dotdata if eu_dis_single_dot(i)>0.1]
 */

/* Python wrapper */
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_91eu_dis_dir_calcu(PyObject *__pyx_self, PyObject *__pyx_v_list_dotdata); /*proto*/
static PyMethodDef __pyx_mdef_10vapor_vali_15Simple_function_91eu_dis_dir_calcu = {"eu_dis_dir_calcu", (PyCFunction)__pyx_pw_10vapor_vali_15Simple_function_91eu_dis_dir_calcu, METH_O, 0};
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_91eu_dis_dir_calcu(PyObject *__pyx_self, PyObject *__pyx_v_list_dotdata) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("eu_dis_dir_calcu (wrapper)", 0);
  __pyx_r = __pyx_pf_10vapor_vali_15Simple_function_90eu_dis_dir_calcu(__pyx_self, ((PyObject *)__pyx_v_list_dotdata));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10vapor_vali_15Simple_function_90eu_dis_dir_calcu(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_list_dotdata) {
  PyObject *__pyx_v_eu_dis_abs = NULL;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  Py_ssize_t __pyx_t_3;
  PyObject *(*__pyx_t_4)(PyObject *);
  PyObject *__pyx_t_5 = NULL;
  PyObject *__pyx_t_6 = NULL;
  PyObject *__pyx_t_7 = NULL;
  PyObject *__pyx_t_8 = NULL;
  int __pyx_t_9;
  __Pyx_RefNannySetupContext("eu_dis_dir_calcu", 0);

  /* "vapor_vali/Simple_function.pyx":702
 * def eu_dis_dir_calcu(list_dotdata):
 *     #eg of list_dotdata=[[2380, 471], [2381, 472], [2382, 472], [2383, 472], [2384, 472], [2385, 472], [2386, 472], [2387, 472], [2388, 472], [2389, 473], [2390, 474], [2391, 475], [2402, 486], [2403, 487], [2404, 488], [2405, 489], [2406, 490], [2407, 491], [2408, 492], [2409, 493], [2410, 494], [2411, 495], [2418, 504], [2440, 528], [2441, 529], [2442, 530], [2443, 531], [2454, 542], [2455, 543], [2456, 544], [2473, 563], [2474, 564], [2475, 565], [2476, 566], [2477, 567], [2478, 568], [2479, 569], [2480, 570], [2481, 571], [2482, 572], [2483, 573], [2484, 574], [2485, 575], [2486, 576], [2487, 577], [2488, 578], [2489, 579], [2490, 580], [2500, 589], [2501, 590], [2502, 591], [2503, 592], [2504, 593], [2523, 613], [2524, 614], [2525, 615], [2526, 616], [2527, 617], [2528, 618], [2529, 619], [2530, 620], [2531, 621], [2532, 622], [2533, 623], [2557, 642], [2558, 643], [2559, 644], [2560, 645], [2561, 646], [2562, 647]]
 *     eu_dis_abs=[i[0]-i[1] for i in list_dotdata if eu_dis_single_dot(i)>0.1]             # <<<<<<<<<<<<<<
 *     if eu_dis_abs==[]:  return 0.0001
 *     else:               return np.mean(eu_dis_abs)
 */
  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 702, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  if (likely(PyList_CheckExact(__pyx_v_list_dotdata)) || PyTuple_CheckExact(__pyx_v_list_dotdata)) {
    __pyx_t_2 = __pyx_v_list_dotdata; __Pyx_INCREF(__pyx_t_2); __pyx_t_3 = 0;
    __pyx_t_4 = NULL;
  } else {
    __pyx_t_3 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_v_list_dotdata); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 702, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_4 = Py_TYPE(__pyx_t_2)->tp_iternext; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 702, __pyx_L1_error)
  }
  for (;;) {
    if (likely(!__pyx_t_4)) {
      if (likely(PyList_CheckExact(__pyx_t_2))) {
        if (__pyx_t_3 >= PyList_GET_SIZE(__pyx_t_2)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_5 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_3); __Pyx_INCREF(__pyx_t_5); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 702, __pyx_L1_error)
        #else
        __pyx_t_5 = PySequence_ITEM(__pyx_t_2, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 702, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_5);
        #endif
      } else {
        if (__pyx_t_3 >= PyTuple_GET_SIZE(__pyx_t_2)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_5 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_3); __Pyx_INCREF(__pyx_t_5); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 702, __pyx_L1_error)
        #else
        __pyx_t_5 = PySequence_ITEM(__pyx_t_2, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 702, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_5);
        #endif
      }
    } else {
      __pyx_t_5 = __pyx_t_4(__pyx_t_2);
      if (unlikely(!__pyx_t_5)) {
        PyObject* exc_type = PyErr_Occurred();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
          else __PYX_ERR(0, 702, __pyx_L1_error)
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_5);
    }
    __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_5);
    __pyx_t_5 = 0;
    __pyx_t_6 = __Pyx_GetModuleGlobalName(__pyx_n_s_eu_dis_single_dot); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 702, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __pyx_t_7 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_6))) {
      __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_6);
      if (likely(__pyx_t_7)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
        __Pyx_INCREF(__pyx_t_7);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_6, function);
      }
    }
    if (!__pyx_t_7) {
      __pyx_t_5 = __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_v_i); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 702, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_5);
    } else {
      __pyx_t_8 = PyTuple_New(1+1); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 702, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_8);
      __Pyx_GIVEREF(__pyx_t_7); PyTuple_SET_ITEM(__pyx_t_8, 0, __pyx_t_7); __pyx_t_7 = NULL;
      __Pyx_INCREF(__pyx_v_i);
      __Pyx_GIVEREF(__pyx_v_i);
      PyTuple_SET_ITEM(__pyx_t_8, 0+1, __pyx_v_i);
      __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_8, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 702, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_5);
      __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
    }
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = PyObject_RichCompare(__pyx_t_5, __pyx_float_0_1, Py_GT); __Pyx_XGOTREF(__pyx_t_6); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 702, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_9 = __Pyx_PyObject_IsTrue(__pyx_t_6); if (unlikely(__pyx_t_9 < 0)) __PYX_ERR(0, 702, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    if (__pyx_t_9) {
      __pyx_t_6 = __Pyx_GetItemInt(__pyx_v_i, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 702, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_6);
      __pyx_t_5 = __Pyx_GetItemInt(__pyx_v_i, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 702, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_5);
      __pyx_t_8 = PyNumber_Subtract(__pyx_t_6, __pyx_t_5); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 702, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_8);
      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
      if (unlikely(__Pyx_ListComp_Append(__pyx_t_1, (PyObject*)__pyx_t_8))) __PYX_ERR(0, 702, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
    }
  }
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_eu_dis_abs = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":703
 *     #eg of list_dotdata=[[2380, 471], [2381, 472], [2382, 472], [2383, 472], [2384, 472], [2385, 472], [2386, 472], [2387, 472], [2388, 472], [2389, 473], [2390, 474], [2391, 475], [2402, 486], [2403, 487], [2404, 488], [2405, 489], [2406, 490], [2407, 491], [2408, 492], [2409, 493], [2410, 494], [2411, 495], [2418, 504], [2440, 528], [2441, 529], [2442, 530], [2443, 531], [2454, 542], [2455, 543], [2456, 544], [2473, 563], [2474, 564], [2475, 565], [2476, 566], [2477, 567], [2478, 568], [2479, 569], [2480, 570], [2481, 571], [2482, 572], [2483, 573], [2484, 574], [2485, 575], [2486, 576], [2487, 577], [2488, 578], [2489, 579], [2490, 580], [2500, 589], [2501, 590], [2502, 591], [2503, 592], [2504, 593], [2523, 613], [2524, 614], [2525, 615], [2526, 616], [2527, 617], [2528, 618], [2529, 619], [2530, 620], [2531, 621], [2532, 622], [2533, 623], [2557, 642], [2558, 643], [2559, 644], [2560, 645], [2561, 646], [2562, 647]]
 *     eu_dis_abs=[i[0]-i[1] for i in list_dotdata if eu_dis_single_dot(i)>0.1]
 *     if eu_dis_abs==[]:  return 0.0001             # <<<<<<<<<<<<<<
 *     else:               return np.mean(eu_dis_abs)
 * 
 */
  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 703, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = PyObject_RichCompare(__pyx_v_eu_dis_abs, __pyx_t_1, Py_EQ); __Pyx_XGOTREF(__pyx_t_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 703, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_9 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_9 < 0)) __PYX_ERR(0, 703, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  if (__pyx_t_9) {
    __Pyx_XDECREF(__pyx_r);
    __Pyx_INCREF(__pyx_float_0_0001);
    __pyx_r = __pyx_float_0_0001;
    goto __pyx_L0;
  }

  /* "vapor_vali/Simple_function.pyx":704
 *     eu_dis_abs=[i[0]-i[1] for i in list_dotdata if eu_dis_single_dot(i)>0.1]
 *     if eu_dis_abs==[]:  return 0.0001
 *     else:               return np.mean(eu_dis_abs)             # <<<<<<<<<<<<<<
 * 
 * def eu_dis_reg_calcu(list_dotdata):
 */
  /*else*/ {
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 704, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_mean); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 704, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_8);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_8))) {
      __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_8);
      if (likely(__pyx_t_1)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_8);
        __Pyx_INCREF(__pyx_t_1);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_8, function);
      }
    }
    if (!__pyx_t_1) {
      __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_t_8, __pyx_v_eu_dis_abs); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 704, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
    } else {
      __pyx_t_5 = PyTuple_New(1+1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 704, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_5);
      __Pyx_GIVEREF(__pyx_t_1); PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_1); __pyx_t_1 = NULL;
      __Pyx_INCREF(__pyx_v_eu_dis_abs);
      __Pyx_GIVEREF(__pyx_v_eu_dis_abs);
      PyTuple_SET_ITEM(__pyx_t_5, 0+1, __pyx_v_eu_dis_abs);
      __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_8, __pyx_t_5, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 704, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    }
    __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;
  }

  /* "vapor_vali/Simple_function.pyx":700
 *     else:               return abs(float(dot_pos[0]-dot_pos[1])/float(dot_pos[0]))
 * 
 * def eu_dis_dir_calcu(list_dotdata):             # <<<<<<<<<<<<<<
 *     #eg of list_dotdata=[[2380, 471], [2381, 472], [2382, 472], [2383, 472], [2384, 472], [2385, 472], [2386, 472], [2387, 472], [2388, 472], [2389, 473], [2390, 474], [2391, 475], [2402, 486], [2403, 487], [2404, 488], [2405, 489], [2406, 490], [2407, 491], [2408, 492], [2409, 493], [2410, 494], [2411, 495], [2418, 504], [2440, 528], [2441, 529], [2442, 530], [2443, 531], [2454, 542], [2455, 543], [2456, 544], [2473, 563], [2474, 564], [2475, 565], [2476, 566], [2477, 567], [2478, 568], [2479, 569], [2480, 570], [2481, 571], [2482, 572], [2483, 573], [2484, 574], [2485, 575], [2486, 576], [2487, 577], [2488, 578], [2489, 579], [2490, 580], [2500, 589], [2501, 590], [2502, 591], [2503, 592], [2504, 593], [2523, 613], [2524, 614], [2525, 615], [2526, 616], [2527, 617], [2528, 618], [2529, 619], [2530, 620], [2531, 621], [2532, 622], [2533, 623], [2557, 642], [2558, 643], [2559, 644], [2560, 645], [2561, 646], [2562, 647]]
 *     eu_dis_abs=[i[0]-i[1] for i in list_dotdata if eu_dis_single_dot(i)>0.1]
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_XDECREF(__pyx_t_7);
  __Pyx_XDECREF(__pyx_t_8);
  __Pyx_AddTraceback("vapor_vali.Simple_function.eu_dis_dir_calcu", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_eu_dis_abs);
  __Pyx_XDECREF(__pyx_v_i);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "vapor_vali/Simple_function.pyx":706
 *     else:               return np.mean(eu_dis_abs)
 * 
 * def eu_dis_reg_calcu(list_dotdata):             # <<<<<<<<<<<<<<
 *     ratio_new=eu_y_vs_x_ratio_calcu(list_dotdata)
 *     eu_dis_abs=[ratio_new*i[0]-i[1] for i in list_dotdata if eu_dis_single_dot([ratio_new*i[0],i[1]])>0.15]
 */

/* Python wrapper */
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_93eu_dis_reg_calcu(PyObject *__pyx_self, PyObject *__pyx_v_list_dotdata); /*proto*/
static PyMethodDef __pyx_mdef_10vapor_vali_15Simple_function_93eu_dis_reg_calcu = {"eu_dis_reg_calcu", (PyCFunction)__pyx_pw_10vapor_vali_15Simple_function_93eu_dis_reg_calcu, METH_O, 0};
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_93eu_dis_reg_calcu(PyObject *__pyx_self, PyObject *__pyx_v_list_dotdata) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("eu_dis_reg_calcu (wrapper)", 0);
  __pyx_r = __pyx_pf_10vapor_vali_15Simple_function_92eu_dis_reg_calcu(__pyx_self, ((PyObject *)__pyx_v_list_dotdata));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10vapor_vali_15Simple_function_92eu_dis_reg_calcu(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_list_dotdata) {
  PyObject *__pyx_v_ratio_new = NULL;
  PyObject *__pyx_v_eu_dis_abs = NULL;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  Py_ssize_t __pyx_t_5;
  PyObject *(*__pyx_t_6)(PyObject *);
  PyObject *__pyx_t_7 = NULL;
  PyObject *__pyx_t_8 = NULL;
  PyObject *__pyx_t_9 = NULL;
  int __pyx_t_10;
  __Pyx_RefNannySetupContext("eu_dis_reg_calcu", 0);

  /* "vapor_vali/Simple_function.pyx":707
 * 
 * def eu_dis_reg_calcu(list_dotdata):
 *     ratio_new=eu_y_vs_x_ratio_calcu(list_dotdata)             # <<<<<<<<<<<<<<
 *     eu_dis_abs=[ratio_new*i[0]-i[1] for i in list_dotdata if eu_dis_single_dot([ratio_new*i[0],i[1]])>0.15]
 *     if eu_dis_abs==[]:  return 0.0001
 */
  __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_eu_y_vs_x_ratio_calcu); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 707, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_3);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_2, function);
    }
  }
  if (!__pyx_t_3) {
    __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_v_list_dotdata); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 707, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
  } else {
    __pyx_t_4 = PyTuple_New(1+1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 707, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_GIVEREF(__pyx_t_3); PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3); __pyx_t_3 = NULL;
    __Pyx_INCREF(__pyx_v_list_dotdata);
    __Pyx_GIVEREF(__pyx_v_list_dotdata);
    PyTuple_SET_ITEM(__pyx_t_4, 0+1, __pyx_v_list_dotdata);
    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_4, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 707, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  }
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_ratio_new = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":708
 * def eu_dis_reg_calcu(list_dotdata):
 *     ratio_new=eu_y_vs_x_ratio_calcu(list_dotdata)
 *     eu_dis_abs=[ratio_new*i[0]-i[1] for i in list_dotdata if eu_dis_single_dot([ratio_new*i[0],i[1]])>0.15]             # <<<<<<<<<<<<<<
 *     if eu_dis_abs==[]:  return 0.0001
 *     else:               return abs(np.mean(eu_dis_abs))
 */
  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 708, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  if (likely(PyList_CheckExact(__pyx_v_list_dotdata)) || PyTuple_CheckExact(__pyx_v_list_dotdata)) {
    __pyx_t_2 = __pyx_v_list_dotdata; __Pyx_INCREF(__pyx_t_2); __pyx_t_5 = 0;
    __pyx_t_6 = NULL;
  } else {
    __pyx_t_5 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_v_list_dotdata); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 708, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_6 = Py_TYPE(__pyx_t_2)->tp_iternext; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 708, __pyx_L1_error)
  }
  for (;;) {
    if (likely(!__pyx_t_6)) {
      if (likely(PyList_CheckExact(__pyx_t_2))) {
        if (__pyx_t_5 >= PyList_GET_SIZE(__pyx_t_2)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_4 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_5); __Pyx_INCREF(__pyx_t_4); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 708, __pyx_L1_error)
        #else
        __pyx_t_4 = PySequence_ITEM(__pyx_t_2, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 708, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_4);
        #endif
      } else {
        if (__pyx_t_5 >= PyTuple_GET_SIZE(__pyx_t_2)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_4 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_5); __Pyx_INCREF(__pyx_t_4); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 708, __pyx_L1_error)
        #else
        __pyx_t_4 = PySequence_ITEM(__pyx_t_2, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 708, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_4);
        #endif
      }
    } else {
      __pyx_t_4 = __pyx_t_6(__pyx_t_2);
      if (unlikely(!__pyx_t_4)) {
        PyObject* exc_type = PyErr_Occurred();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
          else __PYX_ERR(0, 708, __pyx_L1_error)
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_4);
    }
    __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_4);
    __pyx_t_4 = 0;
    __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_eu_dis_single_dot); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 708, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_7 = __Pyx_GetItemInt(__pyx_v_i, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 708, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    __pyx_t_8 = PyNumber_Multiply(__pyx_v_ratio_new, __pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 708, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_8);
    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_t_7 = __Pyx_GetItemInt(__pyx_v_i, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 708, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    __pyx_t_9 = PyList_New(2); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 708, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_9);
    __Pyx_GIVEREF(__pyx_t_8);
    PyList_SET_ITEM(__pyx_t_9, 0, __pyx_t_8);
    __Pyx_GIVEREF(__pyx_t_7);
    PyList_SET_ITEM(__pyx_t_9, 1, __pyx_t_7);
    __pyx_t_8 = 0;
    __pyx_t_7 = 0;
    __pyx_t_7 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_3))) {
      __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_3);
      if (likely(__pyx_t_7)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
        __Pyx_INCREF(__pyx_t_7);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_3, function);
      }
    }
    if (!__pyx_t_7) {
      __pyx_t_4 = __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_9); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 708, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
      __Pyx_GOTREF(__pyx_t_4);
    } else {
      __pyx_t_8 = PyTuple_New(1+1); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 708, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_8);
      __Pyx_GIVEREF(__pyx_t_7); PyTuple_SET_ITEM(__pyx_t_8, 0, __pyx_t_7); __pyx_t_7 = NULL;
      __Pyx_GIVEREF(__pyx_t_9);
      PyTuple_SET_ITEM(__pyx_t_8, 0+1, __pyx_t_9);
      __pyx_t_9 = 0;
      __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_8, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 708, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
    }
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = PyObject_RichCompare(__pyx_t_4, __pyx_float_0_15, Py_GT); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 708, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_10 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_10 < 0)) __PYX_ERR(0, 708, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    if (__pyx_t_10) {
      __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_i, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 708, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __pyx_t_4 = PyNumber_Multiply(__pyx_v_ratio_new, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 708, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_i, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 708, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __pyx_t_8 = PyNumber_Subtract(__pyx_t_4, __pyx_t_3); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 708, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_8);
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      if (unlikely(__Pyx_ListComp_Append(__pyx_t_1, (PyObject*)__pyx_t_8))) __PYX_ERR(0, 708, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
    }
  }
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_eu_dis_abs = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":709
 *     ratio_new=eu_y_vs_x_ratio_calcu(list_dotdata)
 *     eu_dis_abs=[ratio_new*i[0]-i[1] for i in list_dotdata if eu_dis_single_dot([ratio_new*i[0],i[1]])>0.15]
 *     if eu_dis_abs==[]:  return 0.0001             # <<<<<<<<<<<<<<
 *     else:               return abs(np.mean(eu_dis_abs))
 * 
 */
  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 709, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = PyObject_RichCompare(__pyx_v_eu_dis_abs, __pyx_t_1, Py_EQ); __Pyx_XGOTREF(__pyx_t_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 709, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_10 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_10 < 0)) __PYX_ERR(0, 709, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  if (__pyx_t_10) {
    __Pyx_XDECREF(__pyx_r);
    __Pyx_INCREF(__pyx_float_0_0001);
    __pyx_r = __pyx_float_0_0001;
    goto __pyx_L0;
  }

  /* "vapor_vali/Simple_function.pyx":710
 *     eu_dis_abs=[ratio_new*i[0]-i[1] for i in list_dotdata if eu_dis_single_dot([ratio_new*i[0],i[1]])>0.15]
 *     if eu_dis_abs==[]:  return 0.0001
 *     else:               return abs(np.mean(eu_dis_abs))             # <<<<<<<<<<<<<<
 * 
 * def eu_dis_dots_within_10perc(ref_clean_dotdata):
 */
  /*else*/ {
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 710, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_mean); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 710, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_8);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_8))) {
      __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_8);
      if (likely(__pyx_t_1)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_8);
        __Pyx_INCREF(__pyx_t_1);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_8, function);
      }
    }
    if (!__pyx_t_1) {
      __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_t_8, __pyx_v_eu_dis_abs); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 710, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
    } else {
      __pyx_t_3 = PyTuple_New(1+1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 710, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __Pyx_GIVEREF(__pyx_t_1); PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_1); __pyx_t_1 = NULL;
      __Pyx_INCREF(__pyx_v_eu_dis_abs);
      __Pyx_GIVEREF(__pyx_v_eu_dis_abs);
      PyTuple_SET_ITEM(__pyx_t_3, 0+1, __pyx_v_eu_dis_abs);
      __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_8, __pyx_t_3, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 710, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    }
    __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
    __pyx_t_8 = PyNumber_Absolute(__pyx_t_2); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 710, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_8);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_r = __pyx_t_8;
    __pyx_t_8 = 0;
    goto __pyx_L0;
  }

  /* "vapor_vali/Simple_function.pyx":706
 *     else:               return np.mean(eu_dis_abs)
 * 
 * def eu_dis_reg_calcu(list_dotdata):             # <<<<<<<<<<<<<<
 *     ratio_new=eu_y_vs_x_ratio_calcu(list_dotdata)
 *     eu_dis_abs=[ratio_new*i[0]-i[1] for i in list_dotdata if eu_dis_single_dot([ratio_new*i[0],i[1]])>0.15]
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_7);
  __Pyx_XDECREF(__pyx_t_8);
  __Pyx_XDECREF(__pyx_t_9);
  __Pyx_AddTraceback("vapor_vali.Simple_function.eu_dis_reg_calcu", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_ratio_new);
  __Pyx_XDECREF(__pyx_v_eu_dis_abs);
  __Pyx_XDECREF(__pyx_v_i);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "vapor_vali/Simple_function.pyx":712
 *     else:               return abs(np.mean(eu_dis_abs))
 * 
 * def eu_dis_dots_within_10perc(ref_clean_dotdata):             # <<<<<<<<<<<<<<
 *     #eg of ref_clean_dotdata=[[2380, 471], [2381, 472], [2382, 472], [2383, 472], [2384, 472], [2385, 472], [2386, 472], [2387, 472], [2388, 472], [2389, 473], [2390, 474], [2391, 475], [2402, 486], [2403, 487], [2404, 488], [2405, 489], [2406, 490], [2407, 491], [2408, 492], [2409, 493], [2410, 494], [2411, 495], [2418, 504], [2440, 528], [2441, 529], [2442, 530], [2443, 531], [2454, 542], [2455, 543], [2456, 544], [2473, 563], [2474, 564], [2475, 565], [2476, 566], [2477, 567], [2478, 568], [2479, 569], [2480, 570], [2481, 571], [2482, 572], [2483, 573], [2484, 574], [2485, 575], [2486, 576], [2487, 577], [2488, 578], [2489, 579], [2490, 580], [2500, 589], [2501, 590], [2502, 591], [2503, 592], [2504, 593], [2523, 613], [2524, 614], [2525, 615], [2526, 616], [2527, 617], [2528, 618], [2529, 619], [2530, 620], [2531, 621], [2532, 622], [2533, 623], [2557, 642], [2558, 643], [2559, 644], [2560, 645], [2561, 646], [2562, 647]]
 *     dis_10perc=[abs(float(i[0]-i[1])/float(i[0])) for i in ref_clean_dotdata if i[0]>0]
 */

/* Python wrapper */
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_95eu_dis_dots_within_10perc(PyObject *__pyx_self, PyObject *__pyx_v_ref_clean_dotdata); /*proto*/
static PyMethodDef __pyx_mdef_10vapor_vali_15Simple_function_95eu_dis_dots_within_10perc = {"eu_dis_dots_within_10perc", (PyCFunction)__pyx_pw_10vapor_vali_15Simple_function_95eu_dis_dots_within_10perc, METH_O, 0};
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_95eu_dis_dots_within_10perc(PyObject *__pyx_self, PyObject *__pyx_v_ref_clean_dotdata) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("eu_dis_dots_within_10perc (wrapper)", 0);
  __pyx_r = __pyx_pf_10vapor_vali_15Simple_function_94eu_dis_dots_within_10perc(__pyx_self, ((PyObject *)__pyx_v_ref_clean_dotdata));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10vapor_vali_15Simple_function_94eu_dis_dots_within_10perc(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_ref_clean_dotdata) {
  PyObject *__pyx_v_dis_10perc = NULL;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  Py_ssize_t __pyx_t_3;
  PyObject *(*__pyx_t_4)(PyObject *);
  PyObject *__pyx_t_5 = NULL;
  PyObject *__pyx_t_6 = NULL;
  int __pyx_t_7;
  PyObject *__pyx_t_8 = NULL;
  double __pyx_t_9;
  double __pyx_t_10;
  __Pyx_RefNannySetupContext("eu_dis_dots_within_10perc", 0);

  /* "vapor_vali/Simple_function.pyx":714
 * def eu_dis_dots_within_10perc(ref_clean_dotdata):
 *     #eg of ref_clean_dotdata=[[2380, 471], [2381, 472], [2382, 472], [2383, 472], [2384, 472], [2385, 472], [2386, 472], [2387, 472], [2388, 472], [2389, 473], [2390, 474], [2391, 475], [2402, 486], [2403, 487], [2404, 488], [2405, 489], [2406, 490], [2407, 491], [2408, 492], [2409, 493], [2410, 494], [2411, 495], [2418, 504], [2440, 528], [2441, 529], [2442, 530], [2443, 531], [2454, 542], [2455, 543], [2456, 544], [2473, 563], [2474, 564], [2475, 565], [2476, 566], [2477, 567], [2478, 568], [2479, 569], [2480, 570], [2481, 571], [2482, 572], [2483, 573], [2484, 574], [2485, 575], [2486, 576], [2487, 577], [2488, 578], [2489, 579], [2490, 580], [2500, 589], [2501, 590], [2502, 591], [2503, 592], [2504, 593], [2523, 613], [2524, 614], [2525, 615], [2526, 616], [2527, 617], [2528, 618], [2529, 619], [2530, 620], [2531, 621], [2532, 622], [2533, 623], [2557, 642], [2558, 643], [2559, 644], [2560, 645], [2561, 646], [2562, 647]]
 *     dis_10perc=[abs(float(i[0]-i[1])/float(i[0])) for i in ref_clean_dotdata if i[0]>0]             # <<<<<<<<<<<<<<
 *     return len([i for i in dis_10perc if i <0.16])
 * 
 */
  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 714, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  if (likely(PyList_CheckExact(__pyx_v_ref_clean_dotdata)) || PyTuple_CheckExact(__pyx_v_ref_clean_dotdata)) {
    __pyx_t_2 = __pyx_v_ref_clean_dotdata; __Pyx_INCREF(__pyx_t_2); __pyx_t_3 = 0;
    __pyx_t_4 = NULL;
  } else {
    __pyx_t_3 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_v_ref_clean_dotdata); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 714, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_4 = Py_TYPE(__pyx_t_2)->tp_iternext; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 714, __pyx_L1_error)
  }
  for (;;) {
    if (likely(!__pyx_t_4)) {
      if (likely(PyList_CheckExact(__pyx_t_2))) {
        if (__pyx_t_3 >= PyList_GET_SIZE(__pyx_t_2)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_5 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_3); __Pyx_INCREF(__pyx_t_5); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 714, __pyx_L1_error)
        #else
        __pyx_t_5 = PySequence_ITEM(__pyx_t_2, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 714, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_5);
        #endif
      } else {
        if (__pyx_t_3 >= PyTuple_GET_SIZE(__pyx_t_2)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_5 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_3); __Pyx_INCREF(__pyx_t_5); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 714, __pyx_L1_error)
        #else
        __pyx_t_5 = PySequence_ITEM(__pyx_t_2, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 714, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_5);
        #endif
      }
    } else {
      __pyx_t_5 = __pyx_t_4(__pyx_t_2);
      if (unlikely(!__pyx_t_5)) {
        PyObject* exc_type = PyErr_Occurred();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
          else __PYX_ERR(0, 714, __pyx_L1_error)
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_5);
    }
    __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_5);
    __pyx_t_5 = 0;
    __pyx_t_5 = __Pyx_GetItemInt(__pyx_v_i, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 714, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __pyx_t_6 = PyObject_RichCompare(__pyx_t_5, __pyx_int_0, Py_GT); __Pyx_XGOTREF(__pyx_t_6); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 714, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_7 = __Pyx_PyObject_IsTrue(__pyx_t_6); if (unlikely(__pyx_t_7 < 0)) __PYX_ERR(0, 714, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    if (__pyx_t_7) {
      __pyx_t_6 = __Pyx_GetItemInt(__pyx_v_i, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 714, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_6);
      __pyx_t_5 = __Pyx_GetItemInt(__pyx_v_i, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 714, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_5);
      __pyx_t_8 = PyNumber_Subtract(__pyx_t_6, __pyx_t_5); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 714, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_8);
      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
      __pyx_t_9 = __Pyx_PyObject_AsDouble(__pyx_t_8); if (unlikely(__pyx_t_9 == ((double)-1) && PyErr_Occurred())) __PYX_ERR(0, 714, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
      __pyx_t_8 = __Pyx_GetItemInt(__pyx_v_i, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 714, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_8);
      __pyx_t_10 = __Pyx_PyObject_AsDouble(__pyx_t_8); if (unlikely(__pyx_t_10 == ((double)-1) && PyErr_Occurred())) __PYX_ERR(0, 714, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
      if (unlikely(__pyx_t_10 == 0)) {
        PyErr_SetString(PyExc_ZeroDivisionError, "float division");
        __PYX_ERR(0, 714, __pyx_L1_error)
      }
      __pyx_t_8 = PyFloat_FromDouble(fabs((__pyx_t_9 / __pyx_t_10))); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 714, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_8);
      if (unlikely(__Pyx_ListComp_Append(__pyx_t_1, (PyObject*)__pyx_t_8))) __PYX_ERR(0, 714, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
    }
  }
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_dis_10perc = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":715
 *     #eg of ref_clean_dotdata=[[2380, 471], [2381, 472], [2382, 472], [2383, 472], [2384, 472], [2385, 472], [2386, 472], [2387, 472], [2388, 472], [2389, 473], [2390, 474], [2391, 475], [2402, 486], [2403, 487], [2404, 488], [2405, 489], [2406, 490], [2407, 491], [2408, 492], [2409, 493], [2410, 494], [2411, 495], [2418, 504], [2440, 528], [2441, 529], [2442, 530], [2443, 531], [2454, 542], [2455, 543], [2456, 544], [2473, 563], [2474, 564], [2475, 565], [2476, 566], [2477, 567], [2478, 568], [2479, 569], [2480, 570], [2481, 571], [2482, 572], [2483, 573], [2484, 574], [2485, 575], [2486, 576], [2487, 577], [2488, 578], [2489, 579], [2490, 580], [2500, 589], [2501, 590], [2502, 591], [2503, 592], [2504, 593], [2523, 613], [2524, 614], [2525, 615], [2526, 616], [2527, 617], [2528, 618], [2529, 619], [2530, 620], [2531, 621], [2532, 622], [2533, 623], [2557, 642], [2558, 643], [2559, 644], [2560, 645], [2561, 646], [2562, 647]]
 *     dis_10perc=[abs(float(i[0]-i[1])/float(i[0])) for i in ref_clean_dotdata if i[0]>0]
 *     return len([i for i in dis_10perc if i <0.16])             # <<<<<<<<<<<<<<
 * 
 * def eu_dis_region_calcu(list_dotdata,list_bps):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 715, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __pyx_v_dis_10perc; __Pyx_INCREF(__pyx_t_2); __pyx_t_3 = 0;
  for (;;) {
    if (__pyx_t_3 >= PyList_GET_SIZE(__pyx_t_2)) break;
    #if CYTHON_COMPILING_IN_CPYTHON
    __pyx_t_8 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_3); __Pyx_INCREF(__pyx_t_8); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 715, __pyx_L1_error)
    #else
    __pyx_t_8 = PySequence_ITEM(__pyx_t_2, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 715, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_8);
    #endif
    __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_8);
    __pyx_t_8 = 0;
    __pyx_t_8 = PyObject_RichCompare(__pyx_v_i, __pyx_float_0_16, Py_LT); __Pyx_XGOTREF(__pyx_t_8); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 715, __pyx_L1_error)
    __pyx_t_7 = __Pyx_PyObject_IsTrue(__pyx_t_8); if (unlikely(__pyx_t_7 < 0)) __PYX_ERR(0, 715, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
    if (__pyx_t_7) {
      if (unlikely(__Pyx_ListComp_Append(__pyx_t_1, (PyObject*)__pyx_v_i))) __PYX_ERR(0, 715, __pyx_L1_error)
    }
  }
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_3 = PyList_GET_SIZE(__pyx_t_1); if (unlikely(__pyx_t_3 == -1)) __PYX_ERR(0, 715, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = PyInt_FromSsize_t(__pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 715, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* "vapor_vali/Simple_function.pyx":712
 *     else:               return abs(np.mean(eu_dis_abs))
 * 
 * def eu_dis_dots_within_10perc(ref_clean_dotdata):             # <<<<<<<<<<<<<<
 *     #eg of ref_clean_dotdata=[[2380, 471], [2381, 472], [2382, 472], [2383, 472], [2384, 472], [2385, 472], [2386, 472], [2387, 472], [2388, 472], [2389, 473], [2390, 474], [2391, 475], [2402, 486], [2403, 487], [2404, 488], [2405, 489], [2406, 490], [2407, 491], [2408, 492], [2409, 493], [2410, 494], [2411, 495], [2418, 504], [2440, 528], [2441, 529], [2442, 530], [2443, 531], [2454, 542], [2455, 543], [2456, 544], [2473, 563], [2474, 564], [2475, 565], [2476, 566], [2477, 567], [2478, 568], [2479, 569], [2480, 570], [2481, 571], [2482, 572], [2483, 573], [2484, 574], [2485, 575], [2486, 576], [2487, 577], [2488, 578], [2489, 579], [2490, 580], [2500, 589], [2501, 590], [2502, 591], [2503, 592], [2504, 593], [2523, 613], [2524, 614], [2525, 615], [2526, 616], [2527, 617], [2528, 618], [2529, 619], [2530, 620], [2531, 621], [2532, 622], [2533, 623], [2557, 642], [2558, 643], [2559, 644], [2560, 645], [2561, 646], [2562, 647]]
 *     dis_10perc=[abs(float(i[0]-i[1])/float(i[0])) for i in ref_clean_dotdata if i[0]>0]
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_XDECREF(__pyx_t_8);
  __Pyx_AddTraceback("vapor_vali.Simple_function.eu_dis_dots_within_10perc", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_dis_10perc);
  __Pyx_XDECREF(__pyx_v_i);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "vapor_vali/Simple_function.pyx":717
 *     return len([i for i in dis_10perc if i <0.16])
 * 
 * def eu_dis_region_calcu(list_dotdata,list_bps):             # <<<<<<<<<<<<<<
 *     #eg of list_bps=[127906399, 127906515, 127907283, 127907399, 127907515]
 *     ref_bps_new=[i-list_bps[0] for i in list_bps]
 */

/* Python wrapper */
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_97eu_dis_region_calcu(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_10vapor_vali_15Simple_function_97eu_dis_region_calcu = {"eu_dis_region_calcu", (PyCFunction)__pyx_pw_10vapor_vali_15Simple_function_97eu_dis_region_calcu, METH_VARARGS|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_97eu_dis_region_calcu(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_list_dotdata = 0;
  PyObject *__pyx_v_list_bps = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("eu_dis_region_calcu (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_list_dotdata,&__pyx_n_s_list_bps,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_list_dotdata)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_list_bps)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("eu_dis_region_calcu", 1, 2, 2, 1); __PYX_ERR(0, 717, __pyx_L3_error)
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "eu_dis_region_calcu") < 0)) __PYX_ERR(0, 717, __pyx_L3_error)
      }
    } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
    }
    __pyx_v_list_dotdata = values[0];
    __pyx_v_list_bps = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("eu_dis_region_calcu", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 717, __pyx_L3_error)
  __pyx_L3_error:;
  __Pyx_AddTraceback("vapor_vali.Simple_function.eu_dis_region_calcu", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_10vapor_vali_15Simple_function_96eu_dis_region_calcu(__pyx_self, __pyx_v_list_dotdata, __pyx_v_list_bps);

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10vapor_vali_15Simple_function_96eu_dis_region_calcu(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_list_dotdata, PyObject *__pyx_v_list_bps) {
  PyObject *__pyx_v_ref_bps_new = NULL;
  PyObject *__pyx_v_ref_region = NULL;
  PyObject *__pyx_v_reca = NULL;
  PyObject *__pyx_v_recb = NULL;
  PyObject *__pyx_v_out = NULL;
  PyObject *__pyx_v_out_new = NULL;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  Py_ssize_t __pyx_t_3;
  PyObject *(*__pyx_t_4)(PyObject *);
  PyObject *__pyx_t_5 = NULL;
  PyObject *__pyx_t_6 = NULL;
  int __pyx_t_7;
  int __pyx_t_8;
  int __pyx_t_9;
  PyObject *__pyx_t_10 = NULL;
  PyObject *__pyx_t_11 = NULL;
  __Pyx_RefNannySetupContext("eu_dis_region_calcu", 0);

  /* "vapor_vali/Simple_function.pyx":719
 * def eu_dis_region_calcu(list_dotdata,list_bps):
 *     #eg of list_bps=[127906399, 127906515, 127907283, 127907399, 127907515]
 *     ref_bps_new=[i-list_bps[0] for i in list_bps]             # <<<<<<<<<<<<<<
 *     ref_region=[[] for i in range(len(ref_bps_new)-1)]
 *     reca=0
 */
  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 719, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  if (likely(PyList_CheckExact(__pyx_v_list_bps)) || PyTuple_CheckExact(__pyx_v_list_bps)) {
    __pyx_t_2 = __pyx_v_list_bps; __Pyx_INCREF(__pyx_t_2); __pyx_t_3 = 0;
    __pyx_t_4 = NULL;
  } else {
    __pyx_t_3 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_v_list_bps); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 719, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_4 = Py_TYPE(__pyx_t_2)->tp_iternext; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 719, __pyx_L1_error)
  }
  for (;;) {
    if (likely(!__pyx_t_4)) {
      if (likely(PyList_CheckExact(__pyx_t_2))) {
        if (__pyx_t_3 >= PyList_GET_SIZE(__pyx_t_2)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_5 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_3); __Pyx_INCREF(__pyx_t_5); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 719, __pyx_L1_error)
        #else
        __pyx_t_5 = PySequence_ITEM(__pyx_t_2, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 719, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_5);
        #endif
      } else {
        if (__pyx_t_3 >= PyTuple_GET_SIZE(__pyx_t_2)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_5 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_3); __Pyx_INCREF(__pyx_t_5); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 719, __pyx_L1_error)
        #else
        __pyx_t_5 = PySequence_ITEM(__pyx_t_2, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 719, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_5);
        #endif
      }
    } else {
      __pyx_t_5 = __pyx_t_4(__pyx_t_2);
      if (unlikely(!__pyx_t_5)) {
        PyObject* exc_type = PyErr_Occurred();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
          else __PYX_ERR(0, 719, __pyx_L1_error)
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_5);
    }
    __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_5);
    __pyx_t_5 = 0;
    __pyx_t_5 = __Pyx_GetItemInt(__pyx_v_list_bps, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 719, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __pyx_t_6 = PyNumber_Subtract(__pyx_v_i, __pyx_t_5); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 719, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    if (unlikely(__Pyx_ListComp_Append(__pyx_t_1, (PyObject*)__pyx_t_6))) __PYX_ERR(0, 719, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  }
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_ref_bps_new = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":720
 *     #eg of list_bps=[127906399, 127906515, 127907283, 127907399, 127907515]
 *     ref_bps_new=[i-list_bps[0] for i in list_bps]
 *     ref_region=[[] for i in range(len(ref_bps_new)-1)]             # <<<<<<<<<<<<<<
 *     reca=0
 *     recb=0
 */
  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 720, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_3 = PyList_GET_SIZE(__pyx_v_ref_bps_new); if (unlikely(__pyx_t_3 == -1)) __PYX_ERR(0, 720, __pyx_L1_error)
  __pyx_t_2 = PyInt_FromSsize_t((__pyx_t_3 - 1)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 720, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_6 = PyTuple_New(1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 720, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_GIVEREF(__pyx_t_2);
  PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_t_6, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 720, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  if (likely(PyList_CheckExact(__pyx_t_2)) || PyTuple_CheckExact(__pyx_t_2)) {
    __pyx_t_6 = __pyx_t_2; __Pyx_INCREF(__pyx_t_6); __pyx_t_3 = 0;
    __pyx_t_4 = NULL;
  } else {
    __pyx_t_3 = -1; __pyx_t_6 = PyObject_GetIter(__pyx_t_2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 720, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __pyx_t_4 = Py_TYPE(__pyx_t_6)->tp_iternext; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 720, __pyx_L1_error)
  }
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  for (;;) {
    if (likely(!__pyx_t_4)) {
      if (likely(PyList_CheckExact(__pyx_t_6))) {
        if (__pyx_t_3 >= PyList_GET_SIZE(__pyx_t_6)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_2 = PyList_GET_ITEM(__pyx_t_6, __pyx_t_3); __Pyx_INCREF(__pyx_t_2); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 720, __pyx_L1_error)
        #else
        __pyx_t_2 = PySequence_ITEM(__pyx_t_6, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 720, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
        #endif
      } else {
        if (__pyx_t_3 >= PyTuple_GET_SIZE(__pyx_t_6)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_2 = PyTuple_GET_ITEM(__pyx_t_6, __pyx_t_3); __Pyx_INCREF(__pyx_t_2); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 720, __pyx_L1_error)
        #else
        __pyx_t_2 = PySequence_ITEM(__pyx_t_6, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 720, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
        #endif
      }
    } else {
      __pyx_t_2 = __pyx_t_4(__pyx_t_6);
      if (unlikely(!__pyx_t_2)) {
        PyObject* exc_type = PyErr_Occurred();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
          else __PYX_ERR(0, 720, __pyx_L1_error)
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_2);
    }
    __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_2);
    __pyx_t_2 = 0;
    __pyx_t_2 = PyList_New(0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 720, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    if (unlikely(__Pyx_ListComp_Append(__pyx_t_1, (PyObject*)__pyx_t_2))) __PYX_ERR(0, 720, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  }
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_v_ref_region = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":721
 *     ref_bps_new=[i-list_bps[0] for i in list_bps]
 *     ref_region=[[] for i in range(len(ref_bps_new)-1)]
 *     reca=0             # <<<<<<<<<<<<<<
 *     recb=0
 *     while True:
 */
  __Pyx_INCREF(__pyx_int_0);
  __pyx_v_reca = __pyx_int_0;

  /* "vapor_vali/Simple_function.pyx":722
 *     ref_region=[[] for i in range(len(ref_bps_new)-1)]
 *     reca=0
 *     recb=0             # <<<<<<<<<<<<<<
 *     while True:
 *         if reca==len(list_dotdata) or recb==len(ref_region): break
 */
  __Pyx_INCREF(__pyx_int_0);
  __pyx_v_recb = __pyx_int_0;

  /* "vapor_vali/Simple_function.pyx":723
 *     reca=0
 *     recb=0
 *     while True:             # <<<<<<<<<<<<<<
 *         if reca==len(list_dotdata) or recb==len(ref_region): break
 *         if list_dotdata[reca][0]<ref_bps_new[recb+1]:
 */
  while (1) {

    /* "vapor_vali/Simple_function.pyx":724
 *     recb=0
 *     while True:
 *         if reca==len(list_dotdata) or recb==len(ref_region): break             # <<<<<<<<<<<<<<
 *         if list_dotdata[reca][0]<ref_bps_new[recb+1]:
 *             ref_region[recb].append(list_dotdata[reca])
 */
    __pyx_t_3 = PyObject_Length(__pyx_v_list_dotdata); if (unlikely(__pyx_t_3 == -1)) __PYX_ERR(0, 724, __pyx_L1_error)
    __pyx_t_1 = PyInt_FromSsize_t(__pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 724, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_6 = PyObject_RichCompare(__pyx_v_reca, __pyx_t_1, Py_EQ); __Pyx_XGOTREF(__pyx_t_6); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 724, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_8 = __Pyx_PyObject_IsTrue(__pyx_t_6); if (unlikely(__pyx_t_8 < 0)) __PYX_ERR(0, 724, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    if (!__pyx_t_8) {
    } else {
      __pyx_t_7 = __pyx_t_8;
      goto __pyx_L10_bool_binop_done;
    }
    __pyx_t_3 = PyList_GET_SIZE(__pyx_v_ref_region); if (unlikely(__pyx_t_3 == -1)) __PYX_ERR(0, 724, __pyx_L1_error)
    __pyx_t_6 = PyInt_FromSsize_t(__pyx_t_3); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 724, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __pyx_t_1 = PyObject_RichCompare(__pyx_v_recb, __pyx_t_6, Py_EQ); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 724, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_8 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_8 < 0)) __PYX_ERR(0, 724, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_7 = __pyx_t_8;
    __pyx_L10_bool_binop_done:;
    if (__pyx_t_7) {
      goto __pyx_L8_break;
    }

    /* "vapor_vali/Simple_function.pyx":725
 *     while True:
 *         if reca==len(list_dotdata) or recb==len(ref_region): break
 *         if list_dotdata[reca][0]<ref_bps_new[recb+1]:             # <<<<<<<<<<<<<<
 *             ref_region[recb].append(list_dotdata[reca])
 *             reca+=1
 */
    __pyx_t_1 = PyObject_GetItem(__pyx_v_list_dotdata, __pyx_v_reca); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 725, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_6 = __Pyx_GetItemInt(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 725, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = __Pyx_PyInt_AddObjC(__pyx_v_recb, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 725, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_2 = PyObject_GetItem(__pyx_v_ref_bps_new, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 725, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = PyObject_RichCompare(__pyx_t_6, __pyx_t_2, Py_LT); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 725, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_7 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_7 < 0)) __PYX_ERR(0, 725, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    if (__pyx_t_7) {

      /* "vapor_vali/Simple_function.pyx":726
 *         if reca==len(list_dotdata) or recb==len(ref_region): break
 *         if list_dotdata[reca][0]<ref_bps_new[recb+1]:
 *             ref_region[recb].append(list_dotdata[reca])             # <<<<<<<<<<<<<<
 *             reca+=1
 *         else:
 */
      __pyx_t_1 = PyObject_GetItem(__pyx_v_ref_region, __pyx_v_recb); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 726, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __pyx_t_2 = PyObject_GetItem(__pyx_v_list_dotdata, __pyx_v_reca); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 726, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __pyx_t_9 = __Pyx_PyObject_Append(__pyx_t_1, __pyx_t_2); if (unlikely(__pyx_t_9 == -1)) __PYX_ERR(0, 726, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

      /* "vapor_vali/Simple_function.pyx":727
 *         if list_dotdata[reca][0]<ref_bps_new[recb+1]:
 *             ref_region[recb].append(list_dotdata[reca])
 *             reca+=1             # <<<<<<<<<<<<<<
 *         else:
 *             recb+=1
 */
      __pyx_t_2 = __Pyx_PyInt_AddObjC(__pyx_v_reca, __pyx_int_1, 1, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 727, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __Pyx_DECREF_SET(__pyx_v_reca, __pyx_t_2);
      __pyx_t_2 = 0;

      /* "vapor_vali/Simple_function.pyx":725
 *     while True:
 *         if reca==len(list_dotdata) or recb==len(ref_region): break
 *         if list_dotdata[reca][0]<ref_bps_new[recb+1]:             # <<<<<<<<<<<<<<
 *             ref_region[recb].append(list_dotdata[reca])
 *             reca+=1
 */
      goto __pyx_L12;
    }

    /* "vapor_vali/Simple_function.pyx":729
 *             reca+=1
 *         else:
 *             recb+=1             # <<<<<<<<<<<<<<
 *     if reca<len(list_dotdata):
 *         ref_region[-1]+=list_dotdata[reca:]
 */
    /*else*/ {
      __pyx_t_2 = __Pyx_PyInt_AddObjC(__pyx_v_recb, __pyx_int_1, 1, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 729, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __Pyx_DECREF_SET(__pyx_v_recb, __pyx_t_2);
      __pyx_t_2 = 0;
    }
    __pyx_L12:;
  }
  __pyx_L8_break:;

  /* "vapor_vali/Simple_function.pyx":730
 *         else:
 *             recb+=1
 *     if reca<len(list_dotdata):             # <<<<<<<<<<<<<<
 *         ref_region[-1]+=list_dotdata[reca:]
 *     out=[eu_dis_dir_calcu(i) for i in ref_region]
 */
  __pyx_t_3 = PyObject_Length(__pyx_v_list_dotdata); if (unlikely(__pyx_t_3 == -1)) __PYX_ERR(0, 730, __pyx_L1_error)
  __pyx_t_2 = PyInt_FromSsize_t(__pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 730, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_1 = PyObject_RichCompare(__pyx_v_reca, __pyx_t_2, Py_LT); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 730, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_7 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_7 < 0)) __PYX_ERR(0, 730, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  if (__pyx_t_7) {

    /* "vapor_vali/Simple_function.pyx":731
 *             recb+=1
 *     if reca<len(list_dotdata):
 *         ref_region[-1]+=list_dotdata[reca:]             # <<<<<<<<<<<<<<
 *     out=[eu_dis_dir_calcu(i) for i in ref_region]
 *     print (out)
 */
    __pyx_t_3 = -1L;
    __pyx_t_1 = __Pyx_GetItemInt_List(__pyx_v_ref_region, __pyx_t_3, Py_ssize_t, 1, PyInt_FromSsize_t, 1, 1, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 731, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_2 = __Pyx_PyObject_GetSlice(__pyx_v_list_dotdata, 0, 0, &__pyx_v_reca, NULL, NULL, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 731, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_6 = PyNumber_InPlaceAdd(__pyx_t_1, __pyx_t_2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 731, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    if (unlikely(__Pyx_SetItemInt(__pyx_v_ref_region, __pyx_t_3, __pyx_t_6, Py_ssize_t, 1, PyInt_FromSsize_t, 1, 1, 1) < 0)) __PYX_ERR(0, 731, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

    /* "vapor_vali/Simple_function.pyx":730
 *         else:
 *             recb+=1
 *     if reca<len(list_dotdata):             # <<<<<<<<<<<<<<
 *         ref_region[-1]+=list_dotdata[reca:]
 *     out=[eu_dis_dir_calcu(i) for i in ref_region]
 */
  }

  /* "vapor_vali/Simple_function.pyx":732
 *     if reca<len(list_dotdata):
 *         ref_region[-1]+=list_dotdata[reca:]
 *     out=[eu_dis_dir_calcu(i) for i in ref_region]             # <<<<<<<<<<<<<<
 *     print (out)
 *     out_new=[i for i in out if abs(i)>1]
 */
  __pyx_t_6 = PyList_New(0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 732, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_2 = __pyx_v_ref_region; __Pyx_INCREF(__pyx_t_2); __pyx_t_3 = 0;
  for (;;) {
    if (__pyx_t_3 >= PyList_GET_SIZE(__pyx_t_2)) break;
    #if CYTHON_COMPILING_IN_CPYTHON
    __pyx_t_1 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_3); __Pyx_INCREF(__pyx_t_1); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 732, __pyx_L1_error)
    #else
    __pyx_t_1 = PySequence_ITEM(__pyx_t_2, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 732, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    #endif
    __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_1);
    __pyx_t_1 = 0;
    __pyx_t_5 = __Pyx_GetModuleGlobalName(__pyx_n_s_eu_dis_dir_calcu); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 732, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __pyx_t_10 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_5))) {
      __pyx_t_10 = PyMethod_GET_SELF(__pyx_t_5);
      if (likely(__pyx_t_10)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
        __Pyx_INCREF(__pyx_t_10);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_5, function);
      }
    }
    if (!__pyx_t_10) {
      __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_v_i); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 732, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
    } else {
      __pyx_t_11 = PyTuple_New(1+1); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 732, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_11);
      __Pyx_GIVEREF(__pyx_t_10); PyTuple_SET_ITEM(__pyx_t_11, 0, __pyx_t_10); __pyx_t_10 = NULL;
      __Pyx_INCREF(__pyx_v_i);
      __Pyx_GIVEREF(__pyx_v_i);
      PyTuple_SET_ITEM(__pyx_t_11, 0+1, __pyx_v_i);
      __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_11, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 732, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
    }
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    if (unlikely(__Pyx_ListComp_Append(__pyx_t_6, (PyObject*)__pyx_t_1))) __PYX_ERR(0, 732, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  }
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_out = ((PyObject*)__pyx_t_6);
  __pyx_t_6 = 0;

  /* "vapor_vali/Simple_function.pyx":733
 *         ref_region[-1]+=list_dotdata[reca:]
 *     out=[eu_dis_dir_calcu(i) for i in ref_region]
 *     print (out)             # <<<<<<<<<<<<<<
 *     out_new=[i for i in out if abs(i)>1]
 *     if out_new==[]:     return 0.0001
 */
  __pyx_t_6 = PyTuple_New(1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 733, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_INCREF(__pyx_v_out);
  __Pyx_GIVEREF(__pyx_v_out);
  PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_v_out);
  __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_print, __pyx_t_6, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 733, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":734
 *     out=[eu_dis_dir_calcu(i) for i in ref_region]
 *     print (out)
 *     out_new=[i for i in out if abs(i)>1]             # <<<<<<<<<<<<<<
 *     if out_new==[]:     return 0.0001
 *     else:               return np.mean(out_new)
 */
  __pyx_t_2 = PyList_New(0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 734, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_6 = __pyx_v_out; __Pyx_INCREF(__pyx_t_6); __pyx_t_3 = 0;
  for (;;) {
    if (__pyx_t_3 >= PyList_GET_SIZE(__pyx_t_6)) break;
    #if CYTHON_COMPILING_IN_CPYTHON
    __pyx_t_1 = PyList_GET_ITEM(__pyx_t_6, __pyx_t_3); __Pyx_INCREF(__pyx_t_1); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 734, __pyx_L1_error)
    #else
    __pyx_t_1 = PySequence_ITEM(__pyx_t_6, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 734, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    #endif
    __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_1);
    __pyx_t_1 = 0;
    __pyx_t_1 = PyNumber_Absolute(__pyx_v_i); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 734, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_5 = PyObject_RichCompare(__pyx_t_1, __pyx_int_1, Py_GT); __Pyx_XGOTREF(__pyx_t_5); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 734, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_7 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_7 < 0)) __PYX_ERR(0, 734, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    if (__pyx_t_7) {
      if (unlikely(__Pyx_ListComp_Append(__pyx_t_2, (PyObject*)__pyx_v_i))) __PYX_ERR(0, 734, __pyx_L1_error)
    }
  }
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_v_out_new = ((PyObject*)__pyx_t_2);
  __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":735
 *     print (out)
 *     out_new=[i for i in out if abs(i)>1]
 *     if out_new==[]:     return 0.0001             # <<<<<<<<<<<<<<
 *     else:               return np.mean(out_new)
 * 
 */
  __pyx_t_2 = PyList_New(0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 735, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_6 = PyObject_RichCompare(__pyx_v_out_new, __pyx_t_2, Py_EQ); __Pyx_XGOTREF(__pyx_t_6); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 735, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_7 = __Pyx_PyObject_IsTrue(__pyx_t_6); if (unlikely(__pyx_t_7 < 0)) __PYX_ERR(0, 735, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  if (__pyx_t_7) {
    __Pyx_XDECREF(__pyx_r);
    __Pyx_INCREF(__pyx_float_0_0001);
    __pyx_r = __pyx_float_0_0001;
    goto __pyx_L0;
  }

  /* "vapor_vali/Simple_function.pyx":736
 *     out_new=[i for i in out if abs(i)>1]
 *     if out_new==[]:     return 0.0001
 *     else:               return np.mean(out_new)             # <<<<<<<<<<<<<<
 * 
 * def eu_dis_reg_dup_block_calcu(list_dotdata,dup_block_bps):
 */
  /*else*/ {
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 736, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_mean); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 736, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_5))) {
      __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_5);
      if (likely(__pyx_t_2)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
        __Pyx_INCREF(__pyx_t_2);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_5, function);
      }
    }
    if (!__pyx_t_2) {
      __pyx_t_6 = __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_v_out_new); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 736, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_6);
    } else {
      __pyx_t_1 = PyTuple_New(1+1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 736, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_GIVEREF(__pyx_t_2); PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_2); __pyx_t_2 = NULL;
      __Pyx_INCREF(__pyx_v_out_new);
      __Pyx_GIVEREF(__pyx_v_out_new);
      PyTuple_SET_ITEM(__pyx_t_1, 0+1, __pyx_v_out_new);
      __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_1, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 736, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_6);
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    }
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_r = __pyx_t_6;
    __pyx_t_6 = 0;
    goto __pyx_L0;
  }

  /* "vapor_vali/Simple_function.pyx":717
 *     return len([i for i in dis_10perc if i <0.16])
 * 
 * def eu_dis_region_calcu(list_dotdata,list_bps):             # <<<<<<<<<<<<<<
 *     #eg of list_bps=[127906399, 127906515, 127907283, 127907399, 127907515]
 *     ref_bps_new=[i-list_bps[0] for i in list_bps]
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_XDECREF(__pyx_t_10);
  __Pyx_XDECREF(__pyx_t_11);
  __Pyx_AddTraceback("vapor_vali.Simple_function.eu_dis_region_calcu", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_ref_bps_new);
  __Pyx_XDECREF(__pyx_v_ref_region);
  __Pyx_XDECREF(__pyx_v_reca);
  __Pyx_XDECREF(__pyx_v_recb);
  __Pyx_XDECREF(__pyx_v_out);
  __Pyx_XDECREF(__pyx_v_out_new);
  __Pyx_XDECREF(__pyx_v_i);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "vapor_vali/Simple_function.pyx":738
 *     else:               return np.mean(out_new)
 * 
 * def eu_dis_reg_dup_block_calcu(list_dotdata,dup_block_bps):             # <<<<<<<<<<<<<<
 *     ref_region=[[] for i in range(len(dup_block_bps)+1)]
 *     for x in list_dotdata:
 */

/* Python wrapper */
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_99eu_dis_reg_dup_block_calcu(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_10vapor_vali_15Simple_function_99eu_dis_reg_dup_block_calcu = {"eu_dis_reg_dup_block_calcu", (PyCFunction)__pyx_pw_10vapor_vali_15Simple_function_99eu_dis_reg_dup_block_calcu, METH_VARARGS|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_99eu_dis_reg_dup_block_calcu(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_list_dotdata = 0;
  PyObject *__pyx_v_dup_block_bps = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("eu_dis_reg_dup_block_calcu (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_list_dotdata,&__pyx_n_s_dup_block_bps,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_list_dotdata)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_dup_block_bps)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("eu_dis_reg_dup_block_calcu", 1, 2, 2, 1); __PYX_ERR(0, 738, __pyx_L3_error)
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "eu_dis_reg_dup_block_calcu") < 0)) __PYX_ERR(0, 738, __pyx_L3_error)
      }
    } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
    }
    __pyx_v_list_dotdata = values[0];
    __pyx_v_dup_block_bps = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("eu_dis_reg_dup_block_calcu", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 738, __pyx_L3_error)
  __pyx_L3_error:;
  __Pyx_AddTraceback("vapor_vali.Simple_function.eu_dis_reg_dup_block_calcu", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_10vapor_vali_15Simple_function_98eu_dis_reg_dup_block_calcu(__pyx_self, __pyx_v_list_dotdata, __pyx_v_dup_block_bps);

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10vapor_vali_15Simple_function_98eu_dis_reg_dup_block_calcu(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_list_dotdata, PyObject *__pyx_v_dup_block_bps) {
  PyObject *__pyx_v_ref_region = NULL;
  PyObject *__pyx_v_x = NULL;
  PyObject *__pyx_v_out = NULL;
  PyObject *__pyx_v_out_new = NULL;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  Py_ssize_t __pyx_t_2;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  PyObject *(*__pyx_t_5)(PyObject *);
  int __pyx_t_6;
  PyObject *__pyx_t_7 = NULL;
  int __pyx_t_8;
  int __pyx_t_9;
  int __pyx_t_10;
  PyObject *__pyx_t_11 = NULL;
  PyObject *__pyx_t_12 = NULL;
  __Pyx_RefNannySetupContext("eu_dis_reg_dup_block_calcu", 0);

  /* "vapor_vali/Simple_function.pyx":739
 * 
 * def eu_dis_reg_dup_block_calcu(list_dotdata,dup_block_bps):
 *     ref_region=[[] for i in range(len(dup_block_bps)+1)]             # <<<<<<<<<<<<<<
 *     for x in list_dotdata:
 *         if not x[0]<dup_block_bps[0][0] and not x[0]>dup_block_bps[0][1]:   ref_region[0].append(x)
 */
  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 739, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = PyObject_Length(__pyx_v_dup_block_bps); if (unlikely(__pyx_t_2 == -1)) __PYX_ERR(0, 739, __pyx_L1_error)
  __pyx_t_3 = PyInt_FromSsize_t((__pyx_t_2 + 1)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 739, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 739, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_GIVEREF(__pyx_t_3);
  PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_t_4, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 739, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  if (likely(PyList_CheckExact(__pyx_t_3)) || PyTuple_CheckExact(__pyx_t_3)) {
    __pyx_t_4 = __pyx_t_3; __Pyx_INCREF(__pyx_t_4); __pyx_t_2 = 0;
    __pyx_t_5 = NULL;
  } else {
    __pyx_t_2 = -1; __pyx_t_4 = PyObject_GetIter(__pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 739, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_5 = Py_TYPE(__pyx_t_4)->tp_iternext; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 739, __pyx_L1_error)
  }
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  for (;;) {
    if (likely(!__pyx_t_5)) {
      if (likely(PyList_CheckExact(__pyx_t_4))) {
        if (__pyx_t_2 >= PyList_GET_SIZE(__pyx_t_4)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_3 = PyList_GET_ITEM(__pyx_t_4, __pyx_t_2); __Pyx_INCREF(__pyx_t_3); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 739, __pyx_L1_error)
        #else
        __pyx_t_3 = PySequence_ITEM(__pyx_t_4, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 739, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_3);
        #endif
      } else {
        if (__pyx_t_2 >= PyTuple_GET_SIZE(__pyx_t_4)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_3 = PyTuple_GET_ITEM(__pyx_t_4, __pyx_t_2); __Pyx_INCREF(__pyx_t_3); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 739, __pyx_L1_error)
        #else
        __pyx_t_3 = PySequence_ITEM(__pyx_t_4, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 739, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_3);
        #endif
      }
    } else {
      __pyx_t_3 = __pyx_t_5(__pyx_t_4);
      if (unlikely(!__pyx_t_3)) {
        PyObject* exc_type = PyErr_Occurred();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
          else __PYX_ERR(0, 739, __pyx_L1_error)
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_3);
    }
    __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_3);
    __pyx_t_3 = 0;
    __pyx_t_3 = PyList_New(0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 739, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    if (unlikely(__Pyx_ListComp_Append(__pyx_t_1, (PyObject*)__pyx_t_3))) __PYX_ERR(0, 739, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  }
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_ref_region = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":740
 * def eu_dis_reg_dup_block_calcu(list_dotdata,dup_block_bps):
 *     ref_region=[[] for i in range(len(dup_block_bps)+1)]
 *     for x in list_dotdata:             # <<<<<<<<<<<<<<
 *         if not x[0]<dup_block_bps[0][0] and not x[0]>dup_block_bps[0][1]:   ref_region[0].append(x)
 *         elif not x[0]<dup_block_bps[1][0] and not x[0]>dup_block_bps[1][1]: ref_region[1].append(x)
 */
  if (likely(PyList_CheckExact(__pyx_v_list_dotdata)) || PyTuple_CheckExact(__pyx_v_list_dotdata)) {
    __pyx_t_1 = __pyx_v_list_dotdata; __Pyx_INCREF(__pyx_t_1); __pyx_t_2 = 0;
    __pyx_t_5 = NULL;
  } else {
    __pyx_t_2 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_v_list_dotdata); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 740, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_5 = Py_TYPE(__pyx_t_1)->tp_iternext; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 740, __pyx_L1_error)
  }
  for (;;) {
    if (likely(!__pyx_t_5)) {
      if (likely(PyList_CheckExact(__pyx_t_1))) {
        if (__pyx_t_2 >= PyList_GET_SIZE(__pyx_t_1)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_4 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_4); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 740, __pyx_L1_error)
        #else
        __pyx_t_4 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 740, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_4);
        #endif
      } else {
        if (__pyx_t_2 >= PyTuple_GET_SIZE(__pyx_t_1)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_4 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_4); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 740, __pyx_L1_error)
        #else
        __pyx_t_4 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 740, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_4);
        #endif
      }
    } else {
      __pyx_t_4 = __pyx_t_5(__pyx_t_1);
      if (unlikely(!__pyx_t_4)) {
        PyObject* exc_type = PyErr_Occurred();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
          else __PYX_ERR(0, 740, __pyx_L1_error)
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_4);
    }
    __Pyx_XDECREF_SET(__pyx_v_x, __pyx_t_4);
    __pyx_t_4 = 0;

    /* "vapor_vali/Simple_function.pyx":741
 *     ref_region=[[] for i in range(len(dup_block_bps)+1)]
 *     for x in list_dotdata:
 *         if not x[0]<dup_block_bps[0][0] and not x[0]>dup_block_bps[0][1]:   ref_region[0].append(x)             # <<<<<<<<<<<<<<
 *         elif not x[0]<dup_block_bps[1][0] and not x[0]>dup_block_bps[1][1]: ref_region[1].append(x)
 *         else:                                                               ref_region[2].append(x)
 */
    __pyx_t_4 = __Pyx_GetItemInt(__pyx_v_x, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 741, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_dup_block_bps, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 741, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_7 = __Pyx_GetItemInt(__pyx_t_3, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 741, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = PyObject_RichCompare(__pyx_t_4, __pyx_t_7, Py_LT); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 741, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_t_8 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_8 < 0)) __PYX_ERR(0, 741, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_9 = ((!__pyx_t_8) != 0);
    if (__pyx_t_9) {
    } else {
      __pyx_t_6 = __pyx_t_9;
      goto __pyx_L8_bool_binop_done;
    }
    __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_x, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 741, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_7 = __Pyx_GetItemInt(__pyx_v_dup_block_bps, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 741, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    __pyx_t_4 = __Pyx_GetItemInt(__pyx_t_7, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 741, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_t_7 = PyObject_RichCompare(__pyx_t_3, __pyx_t_4, Py_GT); __Pyx_XGOTREF(__pyx_t_7); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 741, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_9 = __Pyx_PyObject_IsTrue(__pyx_t_7); if (unlikely(__pyx_t_9 < 0)) __PYX_ERR(0, 741, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_t_8 = ((!__pyx_t_9) != 0);
    __pyx_t_6 = __pyx_t_8;
    __pyx_L8_bool_binop_done:;
    if (__pyx_t_6) {
      __pyx_t_7 = __Pyx_GetItemInt_List(__pyx_v_ref_region, 0, long, 1, __Pyx_PyInt_From_long, 1, 0, 1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 741, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_7);
      __pyx_t_10 = __Pyx_PyObject_Append(__pyx_t_7, __pyx_v_x); if (unlikely(__pyx_t_10 == -1)) __PYX_ERR(0, 741, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
      goto __pyx_L7;
    }

    /* "vapor_vali/Simple_function.pyx":742
 *     for x in list_dotdata:
 *         if not x[0]<dup_block_bps[0][0] and not x[0]>dup_block_bps[0][1]:   ref_region[0].append(x)
 *         elif not x[0]<dup_block_bps[1][0] and not x[0]>dup_block_bps[1][1]: ref_region[1].append(x)             # <<<<<<<<<<<<<<
 *         else:                                                               ref_region[2].append(x)
 *     out=[eu_dis_dir_calcu(i) for i in ref_region]
 */
    __pyx_t_7 = __Pyx_GetItemInt(__pyx_v_x, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 742, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    __pyx_t_4 = __Pyx_GetItemInt(__pyx_v_dup_block_bps, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 742, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_3 = __Pyx_GetItemInt(__pyx_t_4, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 742, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = PyObject_RichCompare(__pyx_t_7, __pyx_t_3, Py_LT); __Pyx_XGOTREF(__pyx_t_4); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 742, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_8 = __Pyx_PyObject_IsTrue(__pyx_t_4); if (unlikely(__pyx_t_8 < 0)) __PYX_ERR(0, 742, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_9 = ((!__pyx_t_8) != 0);
    if (__pyx_t_9) {
    } else {
      __pyx_t_6 = __pyx_t_9;
      goto __pyx_L10_bool_binop_done;
    }
    __pyx_t_4 = __Pyx_GetItemInt(__pyx_v_x, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 742, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_dup_block_bps, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 742, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_7 = __Pyx_GetItemInt(__pyx_t_3, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 742, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = PyObject_RichCompare(__pyx_t_4, __pyx_t_7, Py_GT); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 742, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_t_9 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_9 < 0)) __PYX_ERR(0, 742, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_8 = ((!__pyx_t_9) != 0);
    __pyx_t_6 = __pyx_t_8;
    __pyx_L10_bool_binop_done:;
    if (__pyx_t_6) {
      __pyx_t_3 = __Pyx_GetItemInt_List(__pyx_v_ref_region, 1, long, 1, __Pyx_PyInt_From_long, 1, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 742, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __pyx_t_10 = __Pyx_PyObject_Append(__pyx_t_3, __pyx_v_x); if (unlikely(__pyx_t_10 == -1)) __PYX_ERR(0, 742, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      goto __pyx_L7;
    }

    /* "vapor_vali/Simple_function.pyx":743
 *         if not x[0]<dup_block_bps[0][0] and not x[0]>dup_block_bps[0][1]:   ref_region[0].append(x)
 *         elif not x[0]<dup_block_bps[1][0] and not x[0]>dup_block_bps[1][1]: ref_region[1].append(x)
 *         else:                                                               ref_region[2].append(x)             # <<<<<<<<<<<<<<
 *     out=[eu_dis_dir_calcu(i) for i in ref_region]
 *     out[-1]=abs(out[-1])
 */
    /*else*/ {
      __pyx_t_3 = __Pyx_GetItemInt_List(__pyx_v_ref_region, 2, long, 1, __Pyx_PyInt_From_long, 1, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 743, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __pyx_t_10 = __Pyx_PyObject_Append(__pyx_t_3, __pyx_v_x); if (unlikely(__pyx_t_10 == -1)) __PYX_ERR(0, 743, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    }
    __pyx_L7:;

    /* "vapor_vali/Simple_function.pyx":740
 * def eu_dis_reg_dup_block_calcu(list_dotdata,dup_block_bps):
 *     ref_region=[[] for i in range(len(dup_block_bps)+1)]
 *     for x in list_dotdata:             # <<<<<<<<<<<<<<
 *         if not x[0]<dup_block_bps[0][0] and not x[0]>dup_block_bps[0][1]:   ref_region[0].append(x)
 *         elif not x[0]<dup_block_bps[1][0] and not x[0]>dup_block_bps[1][1]: ref_region[1].append(x)
 */
  }
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":744
 *         elif not x[0]<dup_block_bps[1][0] and not x[0]>dup_block_bps[1][1]: ref_region[1].append(x)
 *         else:                                                               ref_region[2].append(x)
 *     out=[eu_dis_dir_calcu(i) for i in ref_region]             # <<<<<<<<<<<<<<
 *     out[-1]=abs(out[-1])
 *     out_new=[i for i in out if abs(i)>1]
 */
  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 744, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_3 = __pyx_v_ref_region; __Pyx_INCREF(__pyx_t_3); __pyx_t_2 = 0;
  for (;;) {
    if (__pyx_t_2 >= PyList_GET_SIZE(__pyx_t_3)) break;
    #if CYTHON_COMPILING_IN_CPYTHON
    __pyx_t_7 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_2); __Pyx_INCREF(__pyx_t_7); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 744, __pyx_L1_error)
    #else
    __pyx_t_7 = PySequence_ITEM(__pyx_t_3, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 744, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    #endif
    __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_7);
    __pyx_t_7 = 0;
    __pyx_t_4 = __Pyx_GetModuleGlobalName(__pyx_n_s_eu_dis_dir_calcu); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 744, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_11 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_4))) {
      __pyx_t_11 = PyMethod_GET_SELF(__pyx_t_4);
      if (likely(__pyx_t_11)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
        __Pyx_INCREF(__pyx_t_11);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_4, function);
      }
    }
    if (!__pyx_t_11) {
      __pyx_t_7 = __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_v_i); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 744, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_7);
    } else {
      __pyx_t_12 = PyTuple_New(1+1); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 744, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_12);
      __Pyx_GIVEREF(__pyx_t_11); PyTuple_SET_ITEM(__pyx_t_12, 0, __pyx_t_11); __pyx_t_11 = NULL;
      __Pyx_INCREF(__pyx_v_i);
      __Pyx_GIVEREF(__pyx_v_i);
      PyTuple_SET_ITEM(__pyx_t_12, 0+1, __pyx_v_i);
      __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_12, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 744, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_7);
      __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
    }
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    if (unlikely(__Pyx_ListComp_Append(__pyx_t_1, (PyObject*)__pyx_t_7))) __PYX_ERR(0, 744, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
  }
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_out = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":745
 *         else:                                                               ref_region[2].append(x)
 *     out=[eu_dis_dir_calcu(i) for i in ref_region]
 *     out[-1]=abs(out[-1])             # <<<<<<<<<<<<<<
 *     out_new=[i for i in out if abs(i)>1]
 *     if out_new==[]:     return 0.0001
 */
  __pyx_t_1 = __Pyx_GetItemInt_List(__pyx_v_out, -1L, long, 1, __Pyx_PyInt_From_long, 1, 1, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 745, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_3 = PyNumber_Absolute(__pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 745, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  if (unlikely(__Pyx_SetItemInt(__pyx_v_out, -1L, __pyx_t_3, long, 1, __Pyx_PyInt_From_long, 1, 1, 1) < 0)) __PYX_ERR(0, 745, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;

  /* "vapor_vali/Simple_function.pyx":746
 *     out=[eu_dis_dir_calcu(i) for i in ref_region]
 *     out[-1]=abs(out[-1])
 *     out_new=[i for i in out if abs(i)>1]             # <<<<<<<<<<<<<<
 *     if out_new==[]:     return 0.0001
 *     else:               return np.mean(out_new)
 */
  __pyx_t_3 = PyList_New(0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 746, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_1 = __pyx_v_out; __Pyx_INCREF(__pyx_t_1); __pyx_t_2 = 0;
  for (;;) {
    if (__pyx_t_2 >= PyList_GET_SIZE(__pyx_t_1)) break;
    #if CYTHON_COMPILING_IN_CPYTHON
    __pyx_t_7 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_7); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 746, __pyx_L1_error)
    #else
    __pyx_t_7 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 746, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    #endif
    __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_7);
    __pyx_t_7 = 0;
    __pyx_t_7 = PyNumber_Absolute(__pyx_v_i); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 746, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    __pyx_t_4 = PyObject_RichCompare(__pyx_t_7, __pyx_int_1, Py_GT); __Pyx_XGOTREF(__pyx_t_4); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 746, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_4); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 746, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    if (__pyx_t_6) {
      if (unlikely(__Pyx_ListComp_Append(__pyx_t_3, (PyObject*)__pyx_v_i))) __PYX_ERR(0, 746, __pyx_L1_error)
    }
  }
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_out_new = ((PyObject*)__pyx_t_3);
  __pyx_t_3 = 0;

  /* "vapor_vali/Simple_function.pyx":747
 *     out[-1]=abs(out[-1])
 *     out_new=[i for i in out if abs(i)>1]
 *     if out_new==[]:     return 0.0001             # <<<<<<<<<<<<<<
 *     else:               return np.mean(out_new)
 * 
 */
  __pyx_t_3 = PyList_New(0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 747, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_1 = PyObject_RichCompare(__pyx_v_out_new, __pyx_t_3, Py_EQ); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 747, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 747, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  if (__pyx_t_6) {
    __Pyx_XDECREF(__pyx_r);
    __Pyx_INCREF(__pyx_float_0_0001);
    __pyx_r = __pyx_float_0_0001;
    goto __pyx_L0;
  }

  /* "vapor_vali/Simple_function.pyx":748
 *     out_new=[i for i in out if abs(i)>1]
 *     if out_new==[]:     return 0.0001
 *     else:               return np.mean(out_new)             # <<<<<<<<<<<<<<
 * 
 * def eu_y_vs_x_ratio_single_dot(dot_pos):
 */
  /*else*/ {
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 748, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_mean); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 748, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_4))) {
      __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_4);
      if (likely(__pyx_t_3)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
        __Pyx_INCREF(__pyx_t_3);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_4, function);
      }
    }
    if (!__pyx_t_3) {
      __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_v_out_new); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 748, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
    } else {
      __pyx_t_7 = PyTuple_New(1+1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 748, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_7);
      __Pyx_GIVEREF(__pyx_t_3); PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_3); __pyx_t_3 = NULL;
      __Pyx_INCREF(__pyx_v_out_new);
      __Pyx_GIVEREF(__pyx_v_out_new);
      PyTuple_SET_ITEM(__pyx_t_7, 0+1, __pyx_v_out_new);
      __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_7, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 748, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
    }
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;
  }

  /* "vapor_vali/Simple_function.pyx":738
 *     else:               return np.mean(out_new)
 * 
 * def eu_dis_reg_dup_block_calcu(list_dotdata,dup_block_bps):             # <<<<<<<<<<<<<<
 *     ref_region=[[] for i in range(len(dup_block_bps)+1)]
 *     for x in list_dotdata:
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_7);
  __Pyx_XDECREF(__pyx_t_11);
  __Pyx_XDECREF(__pyx_t_12);
  __Pyx_AddTraceback("vapor_vali.Simple_function.eu_dis_reg_dup_block_calcu", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_ref_region);
  __Pyx_XDECREF(__pyx_v_x);
  __Pyx_XDECREF(__pyx_v_out);
  __Pyx_XDECREF(__pyx_v_out_new);
  __Pyx_XDECREF(__pyx_v_i);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "vapor_vali/Simple_function.pyx":750
 *     else:               return np.mean(out_new)
 * 
 * def eu_y_vs_x_ratio_single_dot(dot_pos):             # <<<<<<<<<<<<<<
 *     #############################################
 *     ####eg of dot_pos=(1212, 1217)
 */

/* Python wrapper */
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_101eu_y_vs_x_ratio_single_dot(PyObject *__pyx_self, PyObject *__pyx_v_dot_pos); /*proto*/
static PyMethodDef __pyx_mdef_10vapor_vali_15Simple_function_101eu_y_vs_x_ratio_single_dot = {"eu_y_vs_x_ratio_single_dot", (PyCFunction)__pyx_pw_10vapor_vali_15Simple_function_101eu_y_vs_x_ratio_single_dot, METH_O, 0};
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_101eu_y_vs_x_ratio_single_dot(PyObject *__pyx_self, PyObject *__pyx_v_dot_pos) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("eu_y_vs_x_ratio_single_dot (wrapper)", 0);
  __pyx_r = __pyx_pf_10vapor_vali_15Simple_function_100eu_y_vs_x_ratio_single_dot(__pyx_self, ((PyObject *)__pyx_v_dot_pos));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10vapor_vali_15Simple_function_100eu_y_vs_x_ratio_single_dot(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_dot_pos) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  int __pyx_t_3;
  double __pyx_t_4;
  double __pyx_t_5;
  __Pyx_RefNannySetupContext("eu_y_vs_x_ratio_single_dot", 0);

  /* "vapor_vali/Simple_function.pyx":755
 *     ####this function returns %deviation of the dot from diagnal
 *     #############################################
 *     if dot_pos[0]==0:   return 1             # <<<<<<<<<<<<<<
 *     else:               return abs(float(dot_pos[1])/float(dot_pos[0]))
 * 
 */
  __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_dot_pos, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 755, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyInt_EqObjC(__pyx_t_1, __pyx_int_0, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 755, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_3 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_3 < 0)) __PYX_ERR(0, 755, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  if (__pyx_t_3) {
    __Pyx_XDECREF(__pyx_r);
    __Pyx_INCREF(__pyx_int_1);
    __pyx_r = __pyx_int_1;
    goto __pyx_L0;
  }

  /* "vapor_vali/Simple_function.pyx":756
 *     #############################################
 *     if dot_pos[0]==0:   return 1
 *     else:               return abs(float(dot_pos[1])/float(dot_pos[0]))             # <<<<<<<<<<<<<<
 * 
 * def eu_y_vs_x_ratio_calcu(ref_clean_dotdata):
 */
  /*else*/ {
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_dot_pos, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 756, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_4 = __Pyx_PyObject_AsDouble(__pyx_t_2); if (unlikely(__pyx_t_4 == ((double)-1) && PyErr_Occurred())) __PYX_ERR(0, 756, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_dot_pos, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 756, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_5 = __Pyx_PyObject_AsDouble(__pyx_t_2); if (unlikely(__pyx_t_5 == ((double)-1) && PyErr_Occurred())) __PYX_ERR(0, 756, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    if (unlikely(__pyx_t_5 == 0)) {
      PyErr_SetString(PyExc_ZeroDivisionError, "float division");
      __PYX_ERR(0, 756, __pyx_L1_error)
    }
    __pyx_t_2 = PyFloat_FromDouble(fabs((__pyx_t_4 / __pyx_t_5))); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 756, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;
  }

  /* "vapor_vali/Simple_function.pyx":750
 *     else:               return np.mean(out_new)
 * 
 * def eu_y_vs_x_ratio_single_dot(dot_pos):             # <<<<<<<<<<<<<<
 *     #############################################
 *     ####eg of dot_pos=(1212, 1217)
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_AddTraceback("vapor_vali.Simple_function.eu_y_vs_x_ratio_single_dot", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "vapor_vali/Simple_function.pyx":758
 *     else:               return abs(float(dot_pos[1])/float(dot_pos[0]))
 * 
 * def eu_y_vs_x_ratio_calcu(ref_clean_dotdata):             # <<<<<<<<<<<<<<
 *     y_x_ratio_list=[round(eu_y_vs_x_ratio_single_dot(i),2) for i in ref_clean_dotdata if eu_dis_single_dot(i)<0.15]
 *     if y_x_ratio_list==[]:  return 1
 */

/* Python wrapper */
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_103eu_y_vs_x_ratio_calcu(PyObject *__pyx_self, PyObject *__pyx_v_ref_clean_dotdata); /*proto*/
static PyMethodDef __pyx_mdef_10vapor_vali_15Simple_function_103eu_y_vs_x_ratio_calcu = {"eu_y_vs_x_ratio_calcu", (PyCFunction)__pyx_pw_10vapor_vali_15Simple_function_103eu_y_vs_x_ratio_calcu, METH_O, 0};
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_103eu_y_vs_x_ratio_calcu(PyObject *__pyx_self, PyObject *__pyx_v_ref_clean_dotdata) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("eu_y_vs_x_ratio_calcu (wrapper)", 0);
  __pyx_r = __pyx_pf_10vapor_vali_15Simple_function_102eu_y_vs_x_ratio_calcu(__pyx_self, ((PyObject *)__pyx_v_ref_clean_dotdata));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "vapor_vali/Simple_function.pyx":764
 *         if len(unify_list(y_x_ratio_list))>1:
 *             nparam_density = scipy.stats.gaussian_kde(y_x_ratio_list)
 *             test=scipy.optimize.fmin(lambda x:-nparam_density.pdf(x),1)             # <<<<<<<<<<<<<<
 *             if abs(test[0]-1) <0.15:        return test[0]
 *             else:   return 1
 */

/* Python wrapper */
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_21eu_y_vs_x_ratio_calcu_lambda(PyObject *__pyx_self, PyObject *__pyx_v_x); /*proto*/
static PyMethodDef __pyx_mdef_10vapor_vali_15Simple_function_21eu_y_vs_x_ratio_calcu_lambda = {"lambda", (PyCFunction)__pyx_pw_10vapor_vali_15Simple_function_21eu_y_vs_x_ratio_calcu_lambda, METH_O, 0};
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_21eu_y_vs_x_ratio_calcu_lambda(PyObject *__pyx_self, PyObject *__pyx_v_x) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("lambda (wrapper)", 0);
  __pyx_r = __pyx_lambda_funcdef_lambda(__pyx_self, ((PyObject *)__pyx_v_x));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_lambda_funcdef_lambda(PyObject *__pyx_self, PyObject *__pyx_v_x) {
  struct __pyx_obj_10vapor_vali_15Simple_function___pyx_scope_struct__eu_y_vs_x_ratio_calcu *__pyx_cur_scope;
  struct __pyx_obj_10vapor_vali_15Simple_function___pyx_scope_struct__eu_y_vs_x_ratio_calcu *__pyx_outer_scope;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  __Pyx_RefNannySetupContext("lambda", 0);
  __pyx_outer_scope = (struct __pyx_obj_10vapor_vali_15Simple_function___pyx_scope_struct__eu_y_vs_x_ratio_calcu *) __Pyx_CyFunction_GetClosure(__pyx_self);
  __pyx_cur_scope = __pyx_outer_scope;
  __Pyx_XDECREF(__pyx_r);
  if (unlikely(!__pyx_cur_scope->__pyx_v_nparam_density)) { __Pyx_RaiseClosureNameError("nparam_density"); __PYX_ERR(0, 764, __pyx_L1_error) }
  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_nparam_density, __pyx_n_s_pdf); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 764, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_3);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_2, function);
    }
  }
  if (!__pyx_t_3) {
    __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_v_x); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 764, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
  } else {
    __pyx_t_4 = PyTuple_New(1+1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 764, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_GIVEREF(__pyx_t_3); PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3); __pyx_t_3 = NULL;
    __Pyx_INCREF(__pyx_v_x);
    __Pyx_GIVEREF(__pyx_v_x);
    PyTuple_SET_ITEM(__pyx_t_4, 0+1, __pyx_v_x);
    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_4, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 764, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  }
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = PyNumber_Negative(__pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 764, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_AddTraceback("vapor_vali.Simple_function.eu_y_vs_x_ratio_calcu.lambda", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "vapor_vali/Simple_function.pyx":758
 *     else:               return abs(float(dot_pos[1])/float(dot_pos[0]))
 * 
 * def eu_y_vs_x_ratio_calcu(ref_clean_dotdata):             # <<<<<<<<<<<<<<
 *     y_x_ratio_list=[round(eu_y_vs_x_ratio_single_dot(i),2) for i in ref_clean_dotdata if eu_dis_single_dot(i)<0.15]
 *     if y_x_ratio_list==[]:  return 1
 */

static PyObject *__pyx_pf_10vapor_vali_15Simple_function_102eu_y_vs_x_ratio_calcu(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_ref_clean_dotdata) {
  struct __pyx_obj_10vapor_vali_15Simple_function___pyx_scope_struct__eu_y_vs_x_ratio_calcu *__pyx_cur_scope;
  PyObject *__pyx_v_y_x_ratio_list = NULL;
  PyObject *__pyx_v_test = NULL;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  Py_ssize_t __pyx_t_3;
  PyObject *(*__pyx_t_4)(PyObject *);
  PyObject *__pyx_t_5 = NULL;
  PyObject *__pyx_t_6 = NULL;
  PyObject *__pyx_t_7 = NULL;
  PyObject *__pyx_t_8 = NULL;
  int __pyx_t_9;
  __Pyx_RefNannySetupContext("eu_y_vs_x_ratio_calcu", 0);
  __pyx_cur_scope = (struct __pyx_obj_10vapor_vali_15Simple_function___pyx_scope_struct__eu_y_vs_x_ratio_calcu *)__pyx_tp_new_10vapor_vali_15Simple_function___pyx_scope_struct__eu_y_vs_x_ratio_calcu(__pyx_ptype_10vapor_vali_15Simple_function___pyx_scope_struct__eu_y_vs_x_ratio_calcu, __pyx_empty_tuple, NULL);
  if (unlikely(!__pyx_cur_scope)) {
    __Pyx_RefNannyFinishContext();
    return NULL;
  }
  __Pyx_GOTREF(__pyx_cur_scope);

  /* "vapor_vali/Simple_function.pyx":759
 * 
 * def eu_y_vs_x_ratio_calcu(ref_clean_dotdata):
 *     y_x_ratio_list=[round(eu_y_vs_x_ratio_single_dot(i),2) for i in ref_clean_dotdata if eu_dis_single_dot(i)<0.15]             # <<<<<<<<<<<<<<
 *     if y_x_ratio_list==[]:  return 1
 *     else:
 */
  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 759, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  if (likely(PyList_CheckExact(__pyx_v_ref_clean_dotdata)) || PyTuple_CheckExact(__pyx_v_ref_clean_dotdata)) {
    __pyx_t_2 = __pyx_v_ref_clean_dotdata; __Pyx_INCREF(__pyx_t_2); __pyx_t_3 = 0;
    __pyx_t_4 = NULL;
  } else {
    __pyx_t_3 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_v_ref_clean_dotdata); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 759, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_4 = Py_TYPE(__pyx_t_2)->tp_iternext; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 759, __pyx_L1_error)
  }
  for (;;) {
    if (likely(!__pyx_t_4)) {
      if (likely(PyList_CheckExact(__pyx_t_2))) {
        if (__pyx_t_3 >= PyList_GET_SIZE(__pyx_t_2)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_5 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_3); __Pyx_INCREF(__pyx_t_5); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 759, __pyx_L1_error)
        #else
        __pyx_t_5 = PySequence_ITEM(__pyx_t_2, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 759, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_5);
        #endif
      } else {
        if (__pyx_t_3 >= PyTuple_GET_SIZE(__pyx_t_2)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_5 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_3); __Pyx_INCREF(__pyx_t_5); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 759, __pyx_L1_error)
        #else
        __pyx_t_5 = PySequence_ITEM(__pyx_t_2, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 759, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_5);
        #endif
      }
    } else {
      __pyx_t_5 = __pyx_t_4(__pyx_t_2);
      if (unlikely(!__pyx_t_5)) {
        PyObject* exc_type = PyErr_Occurred();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
          else __PYX_ERR(0, 759, __pyx_L1_error)
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_5);
    }
    __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_5);
    __pyx_t_5 = 0;
    __pyx_t_6 = __Pyx_GetModuleGlobalName(__pyx_n_s_eu_dis_single_dot); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 759, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __pyx_t_7 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_6))) {
      __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_6);
      if (likely(__pyx_t_7)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
        __Pyx_INCREF(__pyx_t_7);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_6, function);
      }
    }
    if (!__pyx_t_7) {
      __pyx_t_5 = __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_v_i); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 759, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_5);
    } else {
      __pyx_t_8 = PyTuple_New(1+1); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 759, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_8);
      __Pyx_GIVEREF(__pyx_t_7); PyTuple_SET_ITEM(__pyx_t_8, 0, __pyx_t_7); __pyx_t_7 = NULL;
      __Pyx_INCREF(__pyx_v_i);
      __Pyx_GIVEREF(__pyx_v_i);
      PyTuple_SET_ITEM(__pyx_t_8, 0+1, __pyx_v_i);
      __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_8, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 759, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_5);
      __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
    }
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = PyObject_RichCompare(__pyx_t_5, __pyx_float_0_15, Py_LT); __Pyx_XGOTREF(__pyx_t_6); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 759, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_9 = __Pyx_PyObject_IsTrue(__pyx_t_6); if (unlikely(__pyx_t_9 < 0)) __PYX_ERR(0, 759, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    if (__pyx_t_9) {
      __pyx_t_5 = __Pyx_GetModuleGlobalName(__pyx_n_s_eu_y_vs_x_ratio_single_dot); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 759, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_5);
      __pyx_t_8 = NULL;
      if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_5))) {
        __pyx_t_8 = PyMethod_GET_SELF(__pyx_t_5);
        if (likely(__pyx_t_8)) {
          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
          __Pyx_INCREF(__pyx_t_8);
          __Pyx_INCREF(function);
          __Pyx_DECREF_SET(__pyx_t_5, function);
        }
      }
      if (!__pyx_t_8) {
        __pyx_t_6 = __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_v_i); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 759, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_6);
      } else {
        __pyx_t_7 = PyTuple_New(1+1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 759, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_7);
        __Pyx_GIVEREF(__pyx_t_8); PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_8); __pyx_t_8 = NULL;
        __Pyx_INCREF(__pyx_v_i);
        __Pyx_GIVEREF(__pyx_v_i);
        PyTuple_SET_ITEM(__pyx_t_7, 0+1, __pyx_v_i);
        __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_7, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 759, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_6);
        __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
      }
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
      __pyx_t_5 = PyTuple_New(2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 759, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_5);
      __Pyx_GIVEREF(__pyx_t_6);
      PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_6);
      __Pyx_INCREF(__pyx_int_2);
      __Pyx_GIVEREF(__pyx_int_2);
      PyTuple_SET_ITEM(__pyx_t_5, 1, __pyx_int_2);
      __pyx_t_6 = 0;
      __pyx_t_6 = __Pyx_PyObject_Call(__pyx_builtin_round, __pyx_t_5, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 759, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_6);
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
      if (unlikely(__Pyx_ListComp_Append(__pyx_t_1, (PyObject*)__pyx_t_6))) __PYX_ERR(0, 759, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    }
  }
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_y_x_ratio_list = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":760
 * def eu_y_vs_x_ratio_calcu(ref_clean_dotdata):
 *     y_x_ratio_list=[round(eu_y_vs_x_ratio_single_dot(i),2) for i in ref_clean_dotdata if eu_dis_single_dot(i)<0.15]
 *     if y_x_ratio_list==[]:  return 1             # <<<<<<<<<<<<<<
 *     else:
 *         if len(unify_list(y_x_ratio_list))>1:
 */
  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 760, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = PyObject_RichCompare(__pyx_v_y_x_ratio_list, __pyx_t_1, Py_EQ); __Pyx_XGOTREF(__pyx_t_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 760, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_9 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_9 < 0)) __PYX_ERR(0, 760, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  if (__pyx_t_9) {
    __Pyx_XDECREF(__pyx_r);
    __Pyx_INCREF(__pyx_int_1);
    __pyx_r = __pyx_int_1;
    goto __pyx_L0;
  }

  /* "vapor_vali/Simple_function.pyx":762
 *     if y_x_ratio_list==[]:  return 1
 *     else:
 *         if len(unify_list(y_x_ratio_list))>1:             # <<<<<<<<<<<<<<
 *             nparam_density = scipy.stats.gaussian_kde(y_x_ratio_list)
 *             test=scipy.optimize.fmin(lambda x:-nparam_density.pdf(x),1)
 */
  /*else*/ {
    __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_unify_list); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 762, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_6 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_1))) {
      __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_1);
      if (likely(__pyx_t_6)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
        __Pyx_INCREF(__pyx_t_6);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_1, function);
      }
    }
    if (!__pyx_t_6) {
      __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_v_y_x_ratio_list); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 762, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
    } else {
      __pyx_t_5 = PyTuple_New(1+1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 762, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_5);
      __Pyx_GIVEREF(__pyx_t_6); PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_6); __pyx_t_6 = NULL;
      __Pyx_INCREF(__pyx_v_y_x_ratio_list);
      __Pyx_GIVEREF(__pyx_v_y_x_ratio_list);
      PyTuple_SET_ITEM(__pyx_t_5, 0+1, __pyx_v_y_x_ratio_list);
      __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_5, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 762, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    }
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_3 = PyObject_Length(__pyx_t_2); if (unlikely(__pyx_t_3 == -1)) __PYX_ERR(0, 762, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_9 = ((__pyx_t_3 > 1) != 0);
    if (__pyx_t_9) {

      /* "vapor_vali/Simple_function.pyx":763
 *     else:
 *         if len(unify_list(y_x_ratio_list))>1:
 *             nparam_density = scipy.stats.gaussian_kde(y_x_ratio_list)             # <<<<<<<<<<<<<<
 *             test=scipy.optimize.fmin(lambda x:-nparam_density.pdf(x),1)
 *             if abs(test[0]-1) <0.15:        return test[0]
 */
      __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_scipy); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 763, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_stats); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 763, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_5);
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_gaussian_kde); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 763, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
      __pyx_t_5 = NULL;
      if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_1))) {
        __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_1);
        if (likely(__pyx_t_5)) {
          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
          __Pyx_INCREF(__pyx_t_5);
          __Pyx_INCREF(function);
          __Pyx_DECREF_SET(__pyx_t_1, function);
        }
      }
      if (!__pyx_t_5) {
        __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_v_y_x_ratio_list); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 763, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
      } else {
        __pyx_t_6 = PyTuple_New(1+1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 763, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_6);
        __Pyx_GIVEREF(__pyx_t_5); PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_5); __pyx_t_5 = NULL;
        __Pyx_INCREF(__pyx_v_y_x_ratio_list);
        __Pyx_GIVEREF(__pyx_v_y_x_ratio_list);
        PyTuple_SET_ITEM(__pyx_t_6, 0+1, __pyx_v_y_x_ratio_list);
        __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_6, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 763, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
        __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
      }
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      __Pyx_GIVEREF(__pyx_t_2);
      __pyx_cur_scope->__pyx_v_nparam_density = __pyx_t_2;
      __pyx_t_2 = 0;

      /* "vapor_vali/Simple_function.pyx":764
 *         if len(unify_list(y_x_ratio_list))>1:
 *             nparam_density = scipy.stats.gaussian_kde(y_x_ratio_list)
 *             test=scipy.optimize.fmin(lambda x:-nparam_density.pdf(x),1)             # <<<<<<<<<<<<<<
 *             if abs(test[0]-1) <0.15:        return test[0]
 *             else:   return 1
 */
      __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_scipy); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 764, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_optimize); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 764, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_6);
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_fmin); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 764, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
      __pyx_t_6 = __Pyx_CyFunction_NewEx(&__pyx_mdef_10vapor_vali_15Simple_function_21eu_y_vs_x_ratio_calcu_lambda, 0, __pyx_n_s_eu_y_vs_x_ratio_calcu_locals_lam, ((PyObject*)__pyx_cur_scope), __pyx_n_s_vapor_vali_Simple_function, __pyx_d, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 764, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_6);
      __pyx_t_5 = NULL;
      __pyx_t_3 = 0;
      if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_1))) {
        __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_1);
        if (likely(__pyx_t_5)) {
          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
          __Pyx_INCREF(__pyx_t_5);
          __Pyx_INCREF(function);
          __Pyx_DECREF_SET(__pyx_t_1, function);
          __pyx_t_3 = 1;
        }
      }
      __pyx_t_7 = PyTuple_New(2+__pyx_t_3); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 764, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_7);
      if (__pyx_t_5) {
        __Pyx_GIVEREF(__pyx_t_5); PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_5); __pyx_t_5 = NULL;
      }
      __Pyx_GIVEREF(__pyx_t_6);
      PyTuple_SET_ITEM(__pyx_t_7, 0+__pyx_t_3, __pyx_t_6);
      __Pyx_INCREF(__pyx_int_1);
      __Pyx_GIVEREF(__pyx_int_1);
      PyTuple_SET_ITEM(__pyx_t_7, 1+__pyx_t_3, __pyx_int_1);
      __pyx_t_6 = 0;
      __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_7, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 764, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_v_test = __pyx_t_2;
      __pyx_t_2 = 0;

      /* "vapor_vali/Simple_function.pyx":765
 *             nparam_density = scipy.stats.gaussian_kde(y_x_ratio_list)
 *             test=scipy.optimize.fmin(lambda x:-nparam_density.pdf(x),1)
 *             if abs(test[0]-1) <0.15:        return test[0]             # <<<<<<<<<<<<<<
 *             else:   return 1
 *         else:
 */
      __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_test, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 765, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __pyx_t_1 = __Pyx_PyInt_SubtractObjC(__pyx_t_2, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 765, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_2 = PyNumber_Absolute(__pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 765, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_1 = PyObject_RichCompare(__pyx_t_2, __pyx_float_0_15, Py_LT); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 765, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_9 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_9 < 0)) __PYX_ERR(0, 765, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      if (__pyx_t_9) {
        __Pyx_XDECREF(__pyx_r);
        __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_test, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 765, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        __pyx_r = __pyx_t_1;
        __pyx_t_1 = 0;
        goto __pyx_L0;
      }

      /* "vapor_vali/Simple_function.pyx":766
 *             test=scipy.optimize.fmin(lambda x:-nparam_density.pdf(x),1)
 *             if abs(test[0]-1) <0.15:        return test[0]
 *             else:   return 1             # <<<<<<<<<<<<<<
 *         else:
 *             return unify_list(y_x_ratio_list)[0]
 */
      /*else*/ {
        __Pyx_XDECREF(__pyx_r);
        __Pyx_INCREF(__pyx_int_1);
        __pyx_r = __pyx_int_1;
        goto __pyx_L0;
      }

      /* "vapor_vali/Simple_function.pyx":762
 *     if y_x_ratio_list==[]:  return 1
 *     else:
 *         if len(unify_list(y_x_ratio_list))>1:             # <<<<<<<<<<<<<<
 *             nparam_density = scipy.stats.gaussian_kde(y_x_ratio_list)
 *             test=scipy.optimize.fmin(lambda x:-nparam_density.pdf(x),1)
 */
    }

    /* "vapor_vali/Simple_function.pyx":768
 *             else:   return 1
 *         else:
 *             return unify_list(y_x_ratio_list)[0]             # <<<<<<<<<<<<<<
 * 
 * def find_longest_list(list_set):
 */
    /*else*/ {
      __Pyx_XDECREF(__pyx_r);
      __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_unify_list); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 768, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __pyx_t_7 = NULL;
      if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_2))) {
        __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_2);
        if (likely(__pyx_t_7)) {
          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
          __Pyx_INCREF(__pyx_t_7);
          __Pyx_INCREF(function);
          __Pyx_DECREF_SET(__pyx_t_2, function);
        }
      }
      if (!__pyx_t_7) {
        __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_v_y_x_ratio_list); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 768, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
      } else {
        __pyx_t_6 = PyTuple_New(1+1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 768, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_6);
        __Pyx_GIVEREF(__pyx_t_7); PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_7); __pyx_t_7 = NULL;
        __Pyx_INCREF(__pyx_v_y_x_ratio_list);
        __Pyx_GIVEREF(__pyx_v_y_x_ratio_list);
        PyTuple_SET_ITEM(__pyx_t_6, 0+1, __pyx_v_y_x_ratio_list);
        __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_6, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 768, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
      }
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_2 = __Pyx_GetItemInt(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 768, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_r = __pyx_t_2;
      __pyx_t_2 = 0;
      goto __pyx_L0;
    }
  }

  /* "vapor_vali/Simple_function.pyx":758
 *     else:               return abs(float(dot_pos[1])/float(dot_pos[0]))
 * 
 * def eu_y_vs_x_ratio_calcu(ref_clean_dotdata):             # <<<<<<<<<<<<<<
 *     y_x_ratio_list=[round(eu_y_vs_x_ratio_single_dot(i),2) for i in ref_clean_dotdata if eu_dis_single_dot(i)<0.15]
 *     if y_x_ratio_list==[]:  return 1
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_XDECREF(__pyx_t_7);
  __Pyx_XDECREF(__pyx_t_8);
  __Pyx_AddTraceback("vapor_vali.Simple_function.eu_y_vs_x_ratio_calcu", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_y_x_ratio_list);
  __Pyx_XDECREF(__pyx_v_test);
  __Pyx_XDECREF(__pyx_v_i);
  __Pyx_DECREF(((PyObject *)__pyx_cur_scope));
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "vapor_vali/Simple_function.pyx":770
 *             return unify_list(y_x_ratio_list)[0]
 * 
 * def find_longest_list(list_set):             # <<<<<<<<<<<<<<
 *     length=[len(i) for i in list_set]
 *     out_pos=[i for i in range(len(list_set)) if len(list_set[i])==max(length)]
 */

/* Python wrapper */
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_105find_longest_list(PyObject *__pyx_self, PyObject *__pyx_v_list_set); /*proto*/
static PyMethodDef __pyx_mdef_10vapor_vali_15Simple_function_105find_longest_list = {"find_longest_list", (PyCFunction)__pyx_pw_10vapor_vali_15Simple_function_105find_longest_list, METH_O, 0};
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_105find_longest_list(PyObject *__pyx_self, PyObject *__pyx_v_list_set) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("find_longest_list (wrapper)", 0);
  __pyx_r = __pyx_pf_10vapor_vali_15Simple_function_104find_longest_list(__pyx_self, ((PyObject *)__pyx_v_list_set));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10vapor_vali_15Simple_function_104find_longest_list(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_list_set) {
  PyObject *__pyx_v_length = NULL;
  PyObject *__pyx_v_out_pos = NULL;
  PyObject *__pyx_v_out = NULL;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  Py_ssize_t __pyx_t_3;
  PyObject *(*__pyx_t_4)(PyObject *);
  PyObject *__pyx_t_5 = NULL;
  Py_ssize_t __pyx_t_6;
  PyObject *__pyx_t_7 = NULL;
  PyObject *__pyx_t_8 = NULL;
  int __pyx_t_9;
  __Pyx_RefNannySetupContext("find_longest_list", 0);

  /* "vapor_vali/Simple_function.pyx":771
 * 
 * def find_longest_list(list_set):
 *     length=[len(i) for i in list_set]             # <<<<<<<<<<<<<<
 *     out_pos=[i for i in range(len(list_set)) if len(list_set[i])==max(length)]
 *     out=[list_set[i] for i in out_pos]
 */
  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 771, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  if (likely(PyList_CheckExact(__pyx_v_list_set)) || PyTuple_CheckExact(__pyx_v_list_set)) {
    __pyx_t_2 = __pyx_v_list_set; __Pyx_INCREF(__pyx_t_2); __pyx_t_3 = 0;
    __pyx_t_4 = NULL;
  } else {
    __pyx_t_3 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_v_list_set); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 771, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_4 = Py_TYPE(__pyx_t_2)->tp_iternext; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 771, __pyx_L1_error)
  }
  for (;;) {
    if (likely(!__pyx_t_4)) {
      if (likely(PyList_CheckExact(__pyx_t_2))) {
        if (__pyx_t_3 >= PyList_GET_SIZE(__pyx_t_2)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_5 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_3); __Pyx_INCREF(__pyx_t_5); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 771, __pyx_L1_error)
        #else
        __pyx_t_5 = PySequence_ITEM(__pyx_t_2, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 771, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_5);
        #endif
      } else {
        if (__pyx_t_3 >= PyTuple_GET_SIZE(__pyx_t_2)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_5 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_3); __Pyx_INCREF(__pyx_t_5); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 771, __pyx_L1_error)
        #else
        __pyx_t_5 = PySequence_ITEM(__pyx_t_2, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 771, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_5);
        #endif
      }
    } else {
      __pyx_t_5 = __pyx_t_4(__pyx_t_2);
      if (unlikely(!__pyx_t_5)) {
        PyObject* exc_type = PyErr_Occurred();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
          else __PYX_ERR(0, 771, __pyx_L1_error)
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_5);
    }
    __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_5);
    __pyx_t_5 = 0;
    __pyx_t_6 = PyObject_Length(__pyx_v_i); if (unlikely(__pyx_t_6 == -1)) __PYX_ERR(0, 771, __pyx_L1_error)
    __pyx_t_5 = PyInt_FromSsize_t(__pyx_t_6); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 771, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    if (unlikely(__Pyx_ListComp_Append(__pyx_t_1, (PyObject*)__pyx_t_5))) __PYX_ERR(0, 771, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  }
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_length = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":772
 * def find_longest_list(list_set):
 *     length=[len(i) for i in list_set]
 *     out_pos=[i for i in range(len(list_set)) if len(list_set[i])==max(length)]             # <<<<<<<<<<<<<<
 *     out=[list_set[i] for i in out_pos]
 *     return unify_list(out)
 */
  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 772, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_3 = PyObject_Length(__pyx_v_list_set); if (unlikely(__pyx_t_3 == -1)) __PYX_ERR(0, 772, __pyx_L1_error)
  __pyx_t_2 = PyInt_FromSsize_t(__pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 772, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 772, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_GIVEREF(__pyx_t_2);
  PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_t_5, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 772, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  if (likely(PyList_CheckExact(__pyx_t_2)) || PyTuple_CheckExact(__pyx_t_2)) {
    __pyx_t_5 = __pyx_t_2; __Pyx_INCREF(__pyx_t_5); __pyx_t_3 = 0;
    __pyx_t_4 = NULL;
  } else {
    __pyx_t_3 = -1; __pyx_t_5 = PyObject_GetIter(__pyx_t_2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 772, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __pyx_t_4 = Py_TYPE(__pyx_t_5)->tp_iternext; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 772, __pyx_L1_error)
  }
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  for (;;) {
    if (likely(!__pyx_t_4)) {
      if (likely(PyList_CheckExact(__pyx_t_5))) {
        if (__pyx_t_3 >= PyList_GET_SIZE(__pyx_t_5)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_2 = PyList_GET_ITEM(__pyx_t_5, __pyx_t_3); __Pyx_INCREF(__pyx_t_2); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 772, __pyx_L1_error)
        #else
        __pyx_t_2 = PySequence_ITEM(__pyx_t_5, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 772, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
        #endif
      } else {
        if (__pyx_t_3 >= PyTuple_GET_SIZE(__pyx_t_5)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_2 = PyTuple_GET_ITEM(__pyx_t_5, __pyx_t_3); __Pyx_INCREF(__pyx_t_2); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 772, __pyx_L1_error)
        #else
        __pyx_t_2 = PySequence_ITEM(__pyx_t_5, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 772, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
        #endif
      }
    } else {
      __pyx_t_2 = __pyx_t_4(__pyx_t_5);
      if (unlikely(!__pyx_t_2)) {
        PyObject* exc_type = PyErr_Occurred();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
          else __PYX_ERR(0, 772, __pyx_L1_error)
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_2);
    }
    __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_2);
    __pyx_t_2 = 0;
    __pyx_t_2 = PyObject_GetItem(__pyx_v_list_set, __pyx_v_i); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 772, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_6 = PyObject_Length(__pyx_t_2); if (unlikely(__pyx_t_6 == -1)) __PYX_ERR(0, 772, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = PyInt_FromSsize_t(__pyx_t_6); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 772, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_7 = PyTuple_New(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 772, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    __Pyx_INCREF(__pyx_v_length);
    __Pyx_GIVEREF(__pyx_v_length);
    PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_v_length);
    __pyx_t_8 = __Pyx_PyObject_Call(__pyx_builtin_max, __pyx_t_7, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 772, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_8);
    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_t_7 = PyObject_RichCompare(__pyx_t_2, __pyx_t_8, Py_EQ); __Pyx_XGOTREF(__pyx_t_7); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 772, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
    __pyx_t_9 = __Pyx_PyObject_IsTrue(__pyx_t_7); if (unlikely(__pyx_t_9 < 0)) __PYX_ERR(0, 772, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
    if (__pyx_t_9) {
      if (unlikely(__Pyx_ListComp_Append(__pyx_t_1, (PyObject*)__pyx_v_i))) __PYX_ERR(0, 772, __pyx_L1_error)
    }
  }
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v_out_pos = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":773
 *     length=[len(i) for i in list_set]
 *     out_pos=[i for i in range(len(list_set)) if len(list_set[i])==max(length)]
 *     out=[list_set[i] for i in out_pos]             # <<<<<<<<<<<<<<
 *     return unify_list(out)
 * 
 */
  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 773, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_5 = __pyx_v_out_pos; __Pyx_INCREF(__pyx_t_5); __pyx_t_3 = 0;
  for (;;) {
    if (__pyx_t_3 >= PyList_GET_SIZE(__pyx_t_5)) break;
    #if CYTHON_COMPILING_IN_CPYTHON
    __pyx_t_7 = PyList_GET_ITEM(__pyx_t_5, __pyx_t_3); __Pyx_INCREF(__pyx_t_7); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 773, __pyx_L1_error)
    #else
    __pyx_t_7 = PySequence_ITEM(__pyx_t_5, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 773, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    #endif
    __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_7);
    __pyx_t_7 = 0;
    __pyx_t_7 = PyObject_GetItem(__pyx_v_list_set, __pyx_v_i); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 773, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    if (unlikely(__Pyx_ListComp_Append(__pyx_t_1, (PyObject*)__pyx_t_7))) __PYX_ERR(0, 773, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
  }
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v_out = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":774
 *     out_pos=[i for i in range(len(list_set)) if len(list_set[i])==max(length)]
 *     out=[list_set[i] for i in out_pos]
 *     return unify_list(out)             # <<<<<<<<<<<<<<
 * 
 * def flank_length_calculate(bps):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_5 = __Pyx_GetModuleGlobalName(__pyx_n_s_unify_list); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 774, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_7 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_5))) {
    __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_5);
    if (likely(__pyx_t_7)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
      __Pyx_INCREF(__pyx_t_7);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_5, function);
    }
  }
  if (!__pyx_t_7) {
    __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_v_out); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 774, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
  } else {
    __pyx_t_8 = PyTuple_New(1+1); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 774, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_8);
    __Pyx_GIVEREF(__pyx_t_7); PyTuple_SET_ITEM(__pyx_t_8, 0, __pyx_t_7); __pyx_t_7 = NULL;
    __Pyx_INCREF(__pyx_v_out);
    __Pyx_GIVEREF(__pyx_v_out);
    PyTuple_SET_ITEM(__pyx_t_8, 0+1, __pyx_v_out);
    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_8, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 774, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
  }
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* "vapor_vali/Simple_function.pyx":770
 *             return unify_list(y_x_ratio_list)[0]
 * 
 * def find_longest_list(list_set):             # <<<<<<<<<<<<<<
 *     length=[len(i) for i in list_set]
 *     out_pos=[i for i in range(len(list_set)) if len(list_set[i])==max(length)]
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_7);
  __Pyx_XDECREF(__pyx_t_8);
  __Pyx_AddTraceback("vapor_vali.Simple_function.find_longest_list", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_length);
  __Pyx_XDECREF(__pyx_v_out_pos);
  __Pyx_XDECREF(__pyx_v_out);
  __Pyx_XDECREF(__pyx_v_i);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "vapor_vali/Simple_function.pyx":776
 *     return unify_list(out)
 * 
 * def flank_length_calculate(bps):             # <<<<<<<<<<<<<<
 *     if int(bps[-1])-int(bps[1])<100:
 *         flank_length=(int(bps[-1])-int(bps[1]))
 */

/* Python wrapper */
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_107flank_length_calculate(PyObject *__pyx_self, PyObject *__pyx_v_bps); /*proto*/
static PyMethodDef __pyx_mdef_10vapor_vali_15Simple_function_107flank_length_calculate = {"flank_length_calculate", (PyCFunction)__pyx_pw_10vapor_vali_15Simple_function_107flank_length_calculate, METH_O, 0};
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_107flank_length_calculate(PyObject *__pyx_self, PyObject *__pyx_v_bps) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("flank_length_calculate (wrapper)", 0);
  __pyx_r = __pyx_pf_10vapor_vali_15Simple_function_106flank_length_calculate(__pyx_self, ((PyObject *)__pyx_v_bps));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10vapor_vali_15Simple_function_106flank_length_calculate(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_bps) {
  PyObject *__pyx_v_flank_length = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  int __pyx_t_4;
  __Pyx_RefNannySetupContext("flank_length_calculate", 0);

  /* "vapor_vali/Simple_function.pyx":777
 * 
 * def flank_length_calculate(bps):
 *     if int(bps[-1])-int(bps[1])<100:             # <<<<<<<<<<<<<<
 *         flank_length=(int(bps[-1])-int(bps[1]))
 *     else:
 */
  __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_bps, -1L, long, 1, __Pyx_PyInt_From_long, 0, 1, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 777, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyNumber_Int(__pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 777, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_bps, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 777, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_3 = __Pyx_PyNumber_Int(__pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 777, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = PyNumber_Subtract(__pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 777, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = PyObject_RichCompare(__pyx_t_1, __pyx_int_100, Py_LT); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 777, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 777, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  if (__pyx_t_4) {

    /* "vapor_vali/Simple_function.pyx":778
 * def flank_length_calculate(bps):
 *     if int(bps[-1])-int(bps[1])<100:
 *         flank_length=(int(bps[-1])-int(bps[1]))             # <<<<<<<<<<<<<<
 *     else:
 *         if int(bps[-1])-int(bps[1])<500:
 */
    __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_bps, -1L, long, 1, __Pyx_PyInt_From_long, 0, 1, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 778, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_1 = __Pyx_PyNumber_Int(__pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 778, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_bps, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 778, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_2 = __Pyx_PyNumber_Int(__pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 778, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = PyNumber_Subtract(__pyx_t_1, __pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 778, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_v_flank_length = __pyx_t_3;
    __pyx_t_3 = 0;

    /* "vapor_vali/Simple_function.pyx":777
 * 
 * def flank_length_calculate(bps):
 *     if int(bps[-1])-int(bps[1])<100:             # <<<<<<<<<<<<<<
 *         flank_length=(int(bps[-1])-int(bps[1]))
 *     else:
 */
    goto __pyx_L3;
  }

  /* "vapor_vali/Simple_function.pyx":780
 *         flank_length=(int(bps[-1])-int(bps[1]))
 *     else:
 *         if int(bps[-1])-int(bps[1])<500:             # <<<<<<<<<<<<<<
 *             flank_length=int(bps[-1])-int(bps[1])
 *         else:
 */
  /*else*/ {
    __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_bps, -1L, long, 1, __Pyx_PyInt_From_long, 0, 1, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 780, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_2 = __Pyx_PyNumber_Int(__pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 780, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_bps, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 780, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_1 = __Pyx_PyNumber_Int(__pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 780, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = PyNumber_Subtract(__pyx_t_2, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 780, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = PyObject_RichCompare(__pyx_t_3, __pyx_int_500, Py_LT); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 780, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 780, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    if (__pyx_t_4) {

      /* "vapor_vali/Simple_function.pyx":781
 *     else:
 *         if int(bps[-1])-int(bps[1])<500:
 *             flank_length=int(bps[-1])-int(bps[1])             # <<<<<<<<<<<<<<
 *         else:
 *             flank_length=500
 */
      __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_bps, -1L, long, 1, __Pyx_PyInt_From_long, 0, 1, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 781, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __pyx_t_3 = __Pyx_PyNumber_Int(__pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 781, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_bps, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 781, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __pyx_t_2 = __Pyx_PyNumber_Int(__pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 781, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_1 = PyNumber_Subtract(__pyx_t_3, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 781, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_v_flank_length = __pyx_t_1;
      __pyx_t_1 = 0;

      /* "vapor_vali/Simple_function.pyx":780
 *         flank_length=(int(bps[-1])-int(bps[1]))
 *     else:
 *         if int(bps[-1])-int(bps[1])<500:             # <<<<<<<<<<<<<<
 *             flank_length=int(bps[-1])-int(bps[1])
 *         else:
 */
      goto __pyx_L4;
    }

    /* "vapor_vali/Simple_function.pyx":783
 *             flank_length=int(bps[-1])-int(bps[1])
 *         else:
 *             flank_length=500             # <<<<<<<<<<<<<<
 *     return flank_length
 * 
 */
    /*else*/ {
      __Pyx_INCREF(__pyx_int_500);
      __pyx_v_flank_length = __pyx_int_500;
    }
    __pyx_L4:;
  }
  __pyx_L3:;

  /* "vapor_vali/Simple_function.pyx":784
 *         else:
 *             flank_length=500
 *     return flank_length             # <<<<<<<<<<<<<<
 * 
 * def genoCN_extract(pin):
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_flank_length);
  __pyx_r = __pyx_v_flank_length;
  goto __pyx_L0;

  /* "vapor_vali/Simple_function.pyx":776
 *     return unify_list(out)
 * 
 * def flank_length_calculate(bps):             # <<<<<<<<<<<<<<
 *     if int(bps[-1])-int(bps[1])<100:
 *         flank_length=(int(bps[-1])-int(bps[1]))
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_AddTraceback("vapor_vali.Simple_function.flank_length_calculate", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_flank_length);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "vapor_vali/Simple_function.pyx":786
 *     return flank_length
 * 
 * def genoCN_extract(pin):             # <<<<<<<<<<<<<<
 *     out=[0,0]
 *     rec_pos=-1
 */

/* Python wrapper */
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_109genoCN_extract(PyObject *__pyx_self, PyObject *__pyx_v_pin); /*proto*/
static PyMethodDef __pyx_mdef_10vapor_vali_15Simple_function_109genoCN_extract = {"genoCN_extract", (PyCFunction)__pyx_pw_10vapor_vali_15Simple_function_109genoCN_extract, METH_O, 0};
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_109genoCN_extract(PyObject *__pyx_self, PyObject *__pyx_v_pin) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("genoCN_extract (wrapper)", 0);
  __pyx_r = __pyx_pf_10vapor_vali_15Simple_function_108genoCN_extract(__pyx_self, ((PyObject *)__pyx_v_pin));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10vapor_vali_15Simple_function_108genoCN_extract(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_pin) {
  PyObject *__pyx_v_out = NULL;
  PyObject *__pyx_v_rec_pos = NULL;
  PyObject *__pyx_v_x = NULL;
  PyObject *__pyx_v_geno = NULL;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_t_2;
  int __pyx_t_3;
  PyObject *__pyx_t_4 = NULL;
  Py_ssize_t __pyx_t_5;
  PyObject *(*__pyx_t_6)(PyObject *);
  PyObject *__pyx_t_7 = NULL;
  PyObject *__pyx_t_8 = NULL;
  __Pyx_RefNannySetupContext("genoCN_extract", 0);

  /* "vapor_vali/Simple_function.pyx":787
 * 
 * def genoCN_extract(pin):
 *     out=[0,0]             # <<<<<<<<<<<<<<
 *     rec_pos=-1
 *     if 'CN' in pin[8]:
 */
  __pyx_t_1 = PyList_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 787, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_INCREF(__pyx_int_0);
  __Pyx_GIVEREF(__pyx_int_0);
  PyList_SET_ITEM(__pyx_t_1, 0, __pyx_int_0);
  __Pyx_INCREF(__pyx_int_0);
  __Pyx_GIVEREF(__pyx_int_0);
  PyList_SET_ITEM(__pyx_t_1, 1, __pyx_int_0);
  __pyx_v_out = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":788
 * def genoCN_extract(pin):
 *     out=[0,0]
 *     rec_pos=-1             # <<<<<<<<<<<<<<
 *     if 'CN' in pin[8]:
 *         for x in pin[8].split(':'):
 */
  __Pyx_INCREF(__pyx_int_neg_1);
  __pyx_v_rec_pos = __pyx_int_neg_1;

  /* "vapor_vali/Simple_function.pyx":789
 *     out=[0,0]
 *     rec_pos=-1
 *     if 'CN' in pin[8]:             # <<<<<<<<<<<<<<
 *         for x in pin[8].split(':'):
 *             rec_pos+=1
 */
  __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_pin, 8, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 789, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = (__Pyx_PySequence_ContainsTF(__pyx_n_s_CN, __pyx_t_1, Py_EQ)); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 789, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_3 = (__pyx_t_2 != 0);
  if (__pyx_t_3) {

    /* "vapor_vali/Simple_function.pyx":790
 *     rec_pos=-1
 *     if 'CN' in pin[8]:
 *         for x in pin[8].split(':'):             # <<<<<<<<<<<<<<
 *             rec_pos+=1
 *             if x=='CN': break
 */
    __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_pin, 8, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 790, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_split); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 790, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_tuple__39, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 790, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    if (likely(PyList_CheckExact(__pyx_t_1)) || PyTuple_CheckExact(__pyx_t_1)) {
      __pyx_t_4 = __pyx_t_1; __Pyx_INCREF(__pyx_t_4); __pyx_t_5 = 0;
      __pyx_t_6 = NULL;
    } else {
      __pyx_t_5 = -1; __pyx_t_4 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 790, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_t_6 = Py_TYPE(__pyx_t_4)->tp_iternext; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 790, __pyx_L1_error)
    }
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    for (;;) {
      if (likely(!__pyx_t_6)) {
        if (likely(PyList_CheckExact(__pyx_t_4))) {
          if (__pyx_t_5 >= PyList_GET_SIZE(__pyx_t_4)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_1 = PyList_GET_ITEM(__pyx_t_4, __pyx_t_5); __Pyx_INCREF(__pyx_t_1); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 790, __pyx_L1_error)
          #else
          __pyx_t_1 = PySequence_ITEM(__pyx_t_4, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 790, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_1);
          #endif
        } else {
          if (__pyx_t_5 >= PyTuple_GET_SIZE(__pyx_t_4)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_4, __pyx_t_5); __Pyx_INCREF(__pyx_t_1); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 790, __pyx_L1_error)
          #else
          __pyx_t_1 = PySequence_ITEM(__pyx_t_4, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 790, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_1);
          #endif
        }
      } else {
        __pyx_t_1 = __pyx_t_6(__pyx_t_4);
        if (unlikely(!__pyx_t_1)) {
          PyObject* exc_type = PyErr_Occurred();
          if (exc_type) {
            if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
            else __PYX_ERR(0, 790, __pyx_L1_error)
          }
          break;
        }
        __Pyx_GOTREF(__pyx_t_1);
      }
      __Pyx_XDECREF_SET(__pyx_v_x, __pyx_t_1);
      __pyx_t_1 = 0;

      /* "vapor_vali/Simple_function.pyx":791
 *     if 'CN' in pin[8]:
 *         for x in pin[8].split(':'):
 *             rec_pos+=1             # <<<<<<<<<<<<<<
 *             if x=='CN': break
 *     geno=[i.split(':')[rec_pos] for i in pin[9:]]
 */
      __pyx_t_1 = __Pyx_PyInt_AddObjC(__pyx_v_rec_pos, __pyx_int_1, 1, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 791, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_DECREF_SET(__pyx_v_rec_pos, __pyx_t_1);
      __pyx_t_1 = 0;

      /* "vapor_vali/Simple_function.pyx":792
 *         for x in pin[8].split(':'):
 *             rec_pos+=1
 *             if x=='CN': break             # <<<<<<<<<<<<<<
 *     geno=[i.split(':')[rec_pos] for i in pin[9:]]
 *     out=[0 if i=='2' else 1 for i in geno]
 */
      __pyx_t_3 = (__Pyx_PyString_Equals(__pyx_v_x, __pyx_n_s_CN, Py_EQ)); if (unlikely(__pyx_t_3 < 0)) __PYX_ERR(0, 792, __pyx_L1_error)
      if (__pyx_t_3) {
        goto __pyx_L5_break;
      }

      /* "vapor_vali/Simple_function.pyx":790
 *     rec_pos=-1
 *     if 'CN' in pin[8]:
 *         for x in pin[8].split(':'):             # <<<<<<<<<<<<<<
 *             rec_pos+=1
 *             if x=='CN': break
 */
    }
    __pyx_L5_break:;
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;

    /* "vapor_vali/Simple_function.pyx":789
 *     out=[0,0]
 *     rec_pos=-1
 *     if 'CN' in pin[8]:             # <<<<<<<<<<<<<<
 *         for x in pin[8].split(':'):
 *             rec_pos+=1
 */
  }

  /* "vapor_vali/Simple_function.pyx":793
 *             rec_pos+=1
 *             if x=='CN': break
 *     geno=[i.split(':')[rec_pos] for i in pin[9:]]             # <<<<<<<<<<<<<<
 *     out=[0 if i=='2' else 1 for i in geno]
 *     return out
 */
  __pyx_t_4 = PyList_New(0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 793, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_1 = __Pyx_PyObject_GetSlice(__pyx_v_pin, 9, 0, NULL, NULL, &__pyx_slice__40, 1, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 793, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  if (likely(PyList_CheckExact(__pyx_t_1)) || PyTuple_CheckExact(__pyx_t_1)) {
    __pyx_t_7 = __pyx_t_1; __Pyx_INCREF(__pyx_t_7); __pyx_t_5 = 0;
    __pyx_t_6 = NULL;
  } else {
    __pyx_t_5 = -1; __pyx_t_7 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 793, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    __pyx_t_6 = Py_TYPE(__pyx_t_7)->tp_iternext; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 793, __pyx_L1_error)
  }
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  for (;;) {
    if (likely(!__pyx_t_6)) {
      if (likely(PyList_CheckExact(__pyx_t_7))) {
        if (__pyx_t_5 >= PyList_GET_SIZE(__pyx_t_7)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_1 = PyList_GET_ITEM(__pyx_t_7, __pyx_t_5); __Pyx_INCREF(__pyx_t_1); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 793, __pyx_L1_error)
        #else
        __pyx_t_1 = PySequence_ITEM(__pyx_t_7, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 793, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        #endif
      } else {
        if (__pyx_t_5 >= PyTuple_GET_SIZE(__pyx_t_7)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_7, __pyx_t_5); __Pyx_INCREF(__pyx_t_1); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 793, __pyx_L1_error)
        #else
        __pyx_t_1 = PySequence_ITEM(__pyx_t_7, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 793, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        #endif
      }
    } else {
      __pyx_t_1 = __pyx_t_6(__pyx_t_7);
      if (unlikely(!__pyx_t_1)) {
        PyObject* exc_type = PyErr_Occurred();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
          else __PYX_ERR(0, 793, __pyx_L1_error)
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_1);
    }
    __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_1);
    __pyx_t_1 = 0;
    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_i, __pyx_n_s_split); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 793, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_8 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_tuple__41, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 793, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_8);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = PyObject_GetItem(__pyx_t_8, __pyx_v_rec_pos); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 793, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
    if (unlikely(__Pyx_ListComp_Append(__pyx_t_4, (PyObject*)__pyx_t_1))) __PYX_ERR(0, 793, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  }
  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_v_geno = ((PyObject*)__pyx_t_4);
  __pyx_t_4 = 0;

  /* "vapor_vali/Simple_function.pyx":794
 *             if x=='CN': break
 *     geno=[i.split(':')[rec_pos] for i in pin[9:]]
 *     out=[0 if i=='2' else 1 for i in geno]             # <<<<<<<<<<<<<<
 *     return out
 * 
 */
  __pyx_t_4 = PyList_New(0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 794, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_7 = __pyx_v_geno; __Pyx_INCREF(__pyx_t_7); __pyx_t_5 = 0;
  for (;;) {
    if (__pyx_t_5 >= PyList_GET_SIZE(__pyx_t_7)) break;
    #if CYTHON_COMPILING_IN_CPYTHON
    __pyx_t_1 = PyList_GET_ITEM(__pyx_t_7, __pyx_t_5); __Pyx_INCREF(__pyx_t_1); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 794, __pyx_L1_error)
    #else
    __pyx_t_1 = PySequence_ITEM(__pyx_t_7, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 794, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    #endif
    __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_1);
    __pyx_t_1 = 0;
    __pyx_t_3 = (__Pyx_PyString_Equals(__pyx_v_i, __pyx_kp_s_2, Py_EQ)); if (unlikely(__pyx_t_3 < 0)) __PYX_ERR(0, 794, __pyx_L1_error)
    if (__pyx_t_3) {
      __Pyx_INCREF(__pyx_int_0);
      __pyx_t_1 = __pyx_int_0;
    } else {
      __Pyx_INCREF(__pyx_int_1);
      __pyx_t_1 = __pyx_int_1;
    }
    if (unlikely(__Pyx_ListComp_Append(__pyx_t_4, (PyObject*)__pyx_t_1))) __PYX_ERR(0, 794, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  }
  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
  __Pyx_DECREF_SET(__pyx_v_out, ((PyObject*)__pyx_t_4));
  __pyx_t_4 = 0;

  /* "vapor_vali/Simple_function.pyx":795
 *     geno=[i.split(':')[rec_pos] for i in pin[9:]]
 *     out=[0 if i=='2' else 1 for i in geno]
 *     return out             # <<<<<<<<<<<<<<
 * 
 * def genotype_extract(pin):
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_out);
  __pyx_r = __pyx_v_out;
  goto __pyx_L0;

  /* "vapor_vali/Simple_function.pyx":786
 *     return flank_length
 * 
 * def genoCN_extract(pin):             # <<<<<<<<<<<<<<
 *     out=[0,0]
 *     rec_pos=-1
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_7);
  __Pyx_XDECREF(__pyx_t_8);
  __Pyx_AddTraceback("vapor_vali.Simple_function.genoCN_extract", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_out);
  __Pyx_XDECREF(__pyx_v_rec_pos);
  __Pyx_XDECREF(__pyx_v_x);
  __Pyx_XDECREF(__pyx_v_geno);
  __Pyx_XDECREF(__pyx_v_i);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "vapor_vali/Simple_function.pyx":797
 *     return out
 * 
 * def genotype_extract(pin):             # <<<<<<<<<<<<<<
 *     out=[0,0]
 *     rec_pos=-1
 */

/* Python wrapper */
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_111genotype_extract(PyObject *__pyx_self, PyObject *__pyx_v_pin); /*proto*/
static PyMethodDef __pyx_mdef_10vapor_vali_15Simple_function_111genotype_extract = {"genotype_extract", (PyCFunction)__pyx_pw_10vapor_vali_15Simple_function_111genotype_extract, METH_O, 0};
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_111genotype_extract(PyObject *__pyx_self, PyObject *__pyx_v_pin) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("genotype_extract (wrapper)", 0);
  __pyx_r = __pyx_pf_10vapor_vali_15Simple_function_110genotype_extract(__pyx_self, ((PyObject *)__pyx_v_pin));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10vapor_vali_15Simple_function_110genotype_extract(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_pin) {
  PyObject *__pyx_v_out = NULL;
  PyObject *__pyx_v_rec_pos = NULL;
  PyObject *__pyx_v_x = NULL;
  PyObject *__pyx_v_geno = NULL;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_v_j = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_t_2;
  int __pyx_t_3;
  PyObject *__pyx_t_4 = NULL;
  Py_ssize_t __pyx_t_5;
  PyObject *(*__pyx_t_6)(PyObject *);
  PyObject *__pyx_t_7 = NULL;
  PyObject *__pyx_t_8 = NULL;
  int __pyx_t_9;
  Py_ssize_t __pyx_t_10;
  __Pyx_RefNannySetupContext("genotype_extract", 0);

  /* "vapor_vali/Simple_function.pyx":798
 * 
 * def genotype_extract(pin):
 *     out=[0,0]             # <<<<<<<<<<<<<<
 *     rec_pos=-1
 *     if 'GT' in pin[8]:
 */
  __pyx_t_1 = PyList_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 798, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_INCREF(__pyx_int_0);
  __Pyx_GIVEREF(__pyx_int_0);
  PyList_SET_ITEM(__pyx_t_1, 0, __pyx_int_0);
  __Pyx_INCREF(__pyx_int_0);
  __Pyx_GIVEREF(__pyx_int_0);
  PyList_SET_ITEM(__pyx_t_1, 1, __pyx_int_0);
  __pyx_v_out = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":799
 * def genotype_extract(pin):
 *     out=[0,0]
 *     rec_pos=-1             # <<<<<<<<<<<<<<
 *     if 'GT' in pin[8]:
 *         for x in pin[8].split(':'):
 */
  __Pyx_INCREF(__pyx_int_neg_1);
  __pyx_v_rec_pos = __pyx_int_neg_1;

  /* "vapor_vali/Simple_function.pyx":800
 *     out=[0,0]
 *     rec_pos=-1
 *     if 'GT' in pin[8]:             # <<<<<<<<<<<<<<
 *         for x in pin[8].split(':'):
 *             rec_pos+=1
 */
  __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_pin, 8, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 800, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = (__Pyx_PySequence_ContainsTF(__pyx_n_s_GT, __pyx_t_1, Py_EQ)); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 800, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_3 = (__pyx_t_2 != 0);
  if (__pyx_t_3) {

    /* "vapor_vali/Simple_function.pyx":801
 *     rec_pos=-1
 *     if 'GT' in pin[8]:
 *         for x in pin[8].split(':'):             # <<<<<<<<<<<<<<
 *             rec_pos+=1
 *             if x=='GT': break
 */
    __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_pin, 8, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 801, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_split); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 801, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_tuple__42, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 801, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    if (likely(PyList_CheckExact(__pyx_t_1)) || PyTuple_CheckExact(__pyx_t_1)) {
      __pyx_t_4 = __pyx_t_1; __Pyx_INCREF(__pyx_t_4); __pyx_t_5 = 0;
      __pyx_t_6 = NULL;
    } else {
      __pyx_t_5 = -1; __pyx_t_4 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 801, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_t_6 = Py_TYPE(__pyx_t_4)->tp_iternext; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 801, __pyx_L1_error)
    }
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    for (;;) {
      if (likely(!__pyx_t_6)) {
        if (likely(PyList_CheckExact(__pyx_t_4))) {
          if (__pyx_t_5 >= PyList_GET_SIZE(__pyx_t_4)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_1 = PyList_GET_ITEM(__pyx_t_4, __pyx_t_5); __Pyx_INCREF(__pyx_t_1); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 801, __pyx_L1_error)
          #else
          __pyx_t_1 = PySequence_ITEM(__pyx_t_4, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 801, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_1);
          #endif
        } else {
          if (__pyx_t_5 >= PyTuple_GET_SIZE(__pyx_t_4)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_4, __pyx_t_5); __Pyx_INCREF(__pyx_t_1); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 801, __pyx_L1_error)
          #else
          __pyx_t_1 = PySequence_ITEM(__pyx_t_4, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 801, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_1);
          #endif
        }
      } else {
        __pyx_t_1 = __pyx_t_6(__pyx_t_4);
        if (unlikely(!__pyx_t_1)) {
          PyObject* exc_type = PyErr_Occurred();
          if (exc_type) {
            if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
            else __PYX_ERR(0, 801, __pyx_L1_error)
          }
          break;
        }
        __Pyx_GOTREF(__pyx_t_1);
      }
      __Pyx_XDECREF_SET(__pyx_v_x, __pyx_t_1);
      __pyx_t_1 = 0;

      /* "vapor_vali/Simple_function.pyx":802
 *     if 'GT' in pin[8]:
 *         for x in pin[8].split(':'):
 *             rec_pos+=1             # <<<<<<<<<<<<<<
 *             if x=='GT': break
 *     geno=[i.split(':')[rec_pos] for i in pin[9:]]
 */
      __pyx_t_1 = __Pyx_PyInt_AddObjC(__pyx_v_rec_pos, __pyx_int_1, 1, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 802, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_DECREF_SET(__pyx_v_rec_pos, __pyx_t_1);
      __pyx_t_1 = 0;

      /* "vapor_vali/Simple_function.pyx":803
 *         for x in pin[8].split(':'):
 *             rec_pos+=1
 *             if x=='GT': break             # <<<<<<<<<<<<<<
 *     geno=[i.split(':')[rec_pos] for i in pin[9:]]
 *     for i in geno:
 */
      __pyx_t_3 = (__Pyx_PyString_Equals(__pyx_v_x, __pyx_n_s_GT, Py_EQ)); if (unlikely(__pyx_t_3 < 0)) __PYX_ERR(0, 803, __pyx_L1_error)
      if (__pyx_t_3) {
        goto __pyx_L5_break;
      }

      /* "vapor_vali/Simple_function.pyx":801
 *     rec_pos=-1
 *     if 'GT' in pin[8]:
 *         for x in pin[8].split(':'):             # <<<<<<<<<<<<<<
 *             rec_pos+=1
 *             if x=='GT': break
 */
    }
    __pyx_L5_break:;
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;

    /* "vapor_vali/Simple_function.pyx":800
 *     out=[0,0]
 *     rec_pos=-1
 *     if 'GT' in pin[8]:             # <<<<<<<<<<<<<<
 *         for x in pin[8].split(':'):
 *             rec_pos+=1
 */
  }

  /* "vapor_vali/Simple_function.pyx":804
 *             rec_pos+=1
 *             if x=='GT': break
 *     geno=[i.split(':')[rec_pos] for i in pin[9:]]             # <<<<<<<<<<<<<<
 *     for i in geno:
 *         if '/' in i:
 */
  __pyx_t_4 = PyList_New(0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 804, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_1 = __Pyx_PyObject_GetSlice(__pyx_v_pin, 9, 0, NULL, NULL, &__pyx_slice__43, 1, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 804, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  if (likely(PyList_CheckExact(__pyx_t_1)) || PyTuple_CheckExact(__pyx_t_1)) {
    __pyx_t_7 = __pyx_t_1; __Pyx_INCREF(__pyx_t_7); __pyx_t_5 = 0;
    __pyx_t_6 = NULL;
  } else {
    __pyx_t_5 = -1; __pyx_t_7 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 804, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    __pyx_t_6 = Py_TYPE(__pyx_t_7)->tp_iternext; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 804, __pyx_L1_error)
  }
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  for (;;) {
    if (likely(!__pyx_t_6)) {
      if (likely(PyList_CheckExact(__pyx_t_7))) {
        if (__pyx_t_5 >= PyList_GET_SIZE(__pyx_t_7)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_1 = PyList_GET_ITEM(__pyx_t_7, __pyx_t_5); __Pyx_INCREF(__pyx_t_1); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 804, __pyx_L1_error)
        #else
        __pyx_t_1 = PySequence_ITEM(__pyx_t_7, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 804, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        #endif
      } else {
        if (__pyx_t_5 >= PyTuple_GET_SIZE(__pyx_t_7)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_7, __pyx_t_5); __Pyx_INCREF(__pyx_t_1); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 804, __pyx_L1_error)
        #else
        __pyx_t_1 = PySequence_ITEM(__pyx_t_7, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 804, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        #endif
      }
    } else {
      __pyx_t_1 = __pyx_t_6(__pyx_t_7);
      if (unlikely(!__pyx_t_1)) {
        PyObject* exc_type = PyErr_Occurred();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
          else __PYX_ERR(0, 804, __pyx_L1_error)
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_1);
    }
    __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_1);
    __pyx_t_1 = 0;
    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_i, __pyx_n_s_split); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 804, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_8 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_tuple__44, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 804, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_8);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = PyObject_GetItem(__pyx_t_8, __pyx_v_rec_pos); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 804, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
    if (unlikely(__Pyx_ListComp_Append(__pyx_t_4, (PyObject*)__pyx_t_1))) __PYX_ERR(0, 804, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  }
  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_v_geno = ((PyObject*)__pyx_t_4);
  __pyx_t_4 = 0;

  /* "vapor_vali/Simple_function.pyx":805
 *             if x=='GT': break
 *     geno=[i.split(':')[rec_pos] for i in pin[9:]]
 *     for i in geno:             # <<<<<<<<<<<<<<
 *         if '/' in i:
 *             if i=='./.': out.append(1)
 */
  __pyx_t_4 = __pyx_v_geno; __Pyx_INCREF(__pyx_t_4); __pyx_t_5 = 0;
  for (;;) {
    if (__pyx_t_5 >= PyList_GET_SIZE(__pyx_t_4)) break;
    #if CYTHON_COMPILING_IN_CPYTHON
    __pyx_t_7 = PyList_GET_ITEM(__pyx_t_4, __pyx_t_5); __Pyx_INCREF(__pyx_t_7); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 805, __pyx_L1_error)
    #else
    __pyx_t_7 = PySequence_ITEM(__pyx_t_4, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 805, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    #endif
    __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_7);
    __pyx_t_7 = 0;

    /* "vapor_vali/Simple_function.pyx":806
 *     geno=[i.split(':')[rec_pos] for i in pin[9:]]
 *     for i in geno:
 *         if '/' in i:             # <<<<<<<<<<<<<<
 *             if i=='./.': out.append(1)
 *             else:   out.append(sum([int(j) for j in i.split('/')]))
 */
    __pyx_t_3 = (__Pyx_PySequence_ContainsTF(__pyx_kp_s__3, __pyx_v_i, Py_EQ)); if (unlikely(__pyx_t_3 < 0)) __PYX_ERR(0, 806, __pyx_L1_error)
    __pyx_t_2 = (__pyx_t_3 != 0);
    if (__pyx_t_2) {

      /* "vapor_vali/Simple_function.pyx":807
 *     for i in geno:
 *         if '/' in i:
 *             if i=='./.': out.append(1)             # <<<<<<<<<<<<<<
 *             else:   out.append(sum([int(j) for j in i.split('/')]))
 *         elif '|' in i:
 */
      __pyx_t_2 = (__Pyx_PyString_Equals(__pyx_v_i, __pyx_kp_s__45, Py_EQ)); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 807, __pyx_L1_error)
      if (__pyx_t_2) {
        __pyx_t_9 = __Pyx_PyList_Append(__pyx_v_out, __pyx_int_1); if (unlikely(__pyx_t_9 == -1)) __PYX_ERR(0, 807, __pyx_L1_error)
        goto __pyx_L12;
      }

      /* "vapor_vali/Simple_function.pyx":808
 *         if '/' in i:
 *             if i=='./.': out.append(1)
 *             else:   out.append(sum([int(j) for j in i.split('/')]))             # <<<<<<<<<<<<<<
 *         elif '|' in i:
 *             if i=='.|.': out.append(1)
 */
      /*else*/ {
        __pyx_t_7 = PyList_New(0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 808, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_7);
        __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_i, __pyx_n_s_split); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 808, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        __pyx_t_8 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_tuple__46, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 808, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_8);
        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
        if (likely(PyList_CheckExact(__pyx_t_8)) || PyTuple_CheckExact(__pyx_t_8)) {
          __pyx_t_1 = __pyx_t_8; __Pyx_INCREF(__pyx_t_1); __pyx_t_10 = 0;
          __pyx_t_6 = NULL;
        } else {
          __pyx_t_10 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_t_8); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 808, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_1);
          __pyx_t_6 = Py_TYPE(__pyx_t_1)->tp_iternext; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 808, __pyx_L1_error)
        }
        __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
        for (;;) {
          if (likely(!__pyx_t_6)) {
            if (likely(PyList_CheckExact(__pyx_t_1))) {
              if (__pyx_t_10 >= PyList_GET_SIZE(__pyx_t_1)) break;
              #if CYTHON_COMPILING_IN_CPYTHON
              __pyx_t_8 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_10); __Pyx_INCREF(__pyx_t_8); __pyx_t_10++; if (unlikely(0 < 0)) __PYX_ERR(0, 808, __pyx_L1_error)
              #else
              __pyx_t_8 = PySequence_ITEM(__pyx_t_1, __pyx_t_10); __pyx_t_10++; if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 808, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_8);
              #endif
            } else {
              if (__pyx_t_10 >= PyTuple_GET_SIZE(__pyx_t_1)) break;
              #if CYTHON_COMPILING_IN_CPYTHON
              __pyx_t_8 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_10); __Pyx_INCREF(__pyx_t_8); __pyx_t_10++; if (unlikely(0 < 0)) __PYX_ERR(0, 808, __pyx_L1_error)
              #else
              __pyx_t_8 = PySequence_ITEM(__pyx_t_1, __pyx_t_10); __pyx_t_10++; if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 808, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_8);
              #endif
            }
          } else {
            __pyx_t_8 = __pyx_t_6(__pyx_t_1);
            if (unlikely(!__pyx_t_8)) {
              PyObject* exc_type = PyErr_Occurred();
              if (exc_type) {
                if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
                else __PYX_ERR(0, 808, __pyx_L1_error)
              }
              break;
            }
            __Pyx_GOTREF(__pyx_t_8);
          }
          __Pyx_XDECREF_SET(__pyx_v_j, __pyx_t_8);
          __pyx_t_8 = 0;
          __pyx_t_8 = __Pyx_PyNumber_Int(__pyx_v_j); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 808, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_8);
          if (unlikely(__Pyx_ListComp_Append(__pyx_t_7, (PyObject*)__pyx_t_8))) __PYX_ERR(0, 808, __pyx_L1_error)
          __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
        }
        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
        __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 808, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        __Pyx_GIVEREF(__pyx_t_7);
        PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_7);
        __pyx_t_7 = 0;
        __pyx_t_7 = __Pyx_PyObject_Call(__pyx_builtin_sum, __pyx_t_1, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 808, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_7);
        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
        __pyx_t_9 = __Pyx_PyList_Append(__pyx_v_out, __pyx_t_7); if (unlikely(__pyx_t_9 == -1)) __PYX_ERR(0, 808, __pyx_L1_error)
        __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
      }
      __pyx_L12:;

      /* "vapor_vali/Simple_function.pyx":806
 *     geno=[i.split(':')[rec_pos] for i in pin[9:]]
 *     for i in geno:
 *         if '/' in i:             # <<<<<<<<<<<<<<
 *             if i=='./.': out.append(1)
 *             else:   out.append(sum([int(j) for j in i.split('/')]))
 */
      goto __pyx_L11;
    }

    /* "vapor_vali/Simple_function.pyx":809
 *             if i=='./.': out.append(1)
 *             else:   out.append(sum([int(j) for j in i.split('/')]))
 *         elif '|' in i:             # <<<<<<<<<<<<<<
 *             if i=='.|.': out.append(1)
 *             else:   out.append(sum([int(j) for j in i.split('|')]))
 */
    __pyx_t_2 = (__Pyx_PySequence_ContainsTF(__pyx_kp_s__47, __pyx_v_i, Py_EQ)); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 809, __pyx_L1_error)
    __pyx_t_3 = (__pyx_t_2 != 0);
    if (__pyx_t_3) {

      /* "vapor_vali/Simple_function.pyx":810
 *             else:   out.append(sum([int(j) for j in i.split('/')]))
 *         elif '|' in i:
 *             if i=='.|.': out.append(1)             # <<<<<<<<<<<<<<
 *             else:   out.append(sum([int(j) for j in i.split('|')]))
 *         elif i=='.':    out.append(1)
 */
      __pyx_t_3 = (__Pyx_PyString_Equals(__pyx_v_i, __pyx_kp_s__48, Py_EQ)); if (unlikely(__pyx_t_3 < 0)) __PYX_ERR(0, 810, __pyx_L1_error)
      if (__pyx_t_3) {
        __pyx_t_9 = __Pyx_PyList_Append(__pyx_v_out, __pyx_int_1); if (unlikely(__pyx_t_9 == -1)) __PYX_ERR(0, 810, __pyx_L1_error)
        goto __pyx_L15;
      }

      /* "vapor_vali/Simple_function.pyx":811
 *         elif '|' in i:
 *             if i=='.|.': out.append(1)
 *             else:   out.append(sum([int(j) for j in i.split('|')]))             # <<<<<<<<<<<<<<
 *         elif i=='.':    out.append(1)
 *     return out
 */
      /*else*/ {
        __pyx_t_7 = PyList_New(0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 811, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_7);
        __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_i, __pyx_n_s_split); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 811, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        __pyx_t_8 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_tuple__49, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 811, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_8);
        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
        if (likely(PyList_CheckExact(__pyx_t_8)) || PyTuple_CheckExact(__pyx_t_8)) {
          __pyx_t_1 = __pyx_t_8; __Pyx_INCREF(__pyx_t_1); __pyx_t_10 = 0;
          __pyx_t_6 = NULL;
        } else {
          __pyx_t_10 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_t_8); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 811, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_1);
          __pyx_t_6 = Py_TYPE(__pyx_t_1)->tp_iternext; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 811, __pyx_L1_error)
        }
        __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
        for (;;) {
          if (likely(!__pyx_t_6)) {
            if (likely(PyList_CheckExact(__pyx_t_1))) {
              if (__pyx_t_10 >= PyList_GET_SIZE(__pyx_t_1)) break;
              #if CYTHON_COMPILING_IN_CPYTHON
              __pyx_t_8 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_10); __Pyx_INCREF(__pyx_t_8); __pyx_t_10++; if (unlikely(0 < 0)) __PYX_ERR(0, 811, __pyx_L1_error)
              #else
              __pyx_t_8 = PySequence_ITEM(__pyx_t_1, __pyx_t_10); __pyx_t_10++; if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 811, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_8);
              #endif
            } else {
              if (__pyx_t_10 >= PyTuple_GET_SIZE(__pyx_t_1)) break;
              #if CYTHON_COMPILING_IN_CPYTHON
              __pyx_t_8 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_10); __Pyx_INCREF(__pyx_t_8); __pyx_t_10++; if (unlikely(0 < 0)) __PYX_ERR(0, 811, __pyx_L1_error)
              #else
              __pyx_t_8 = PySequence_ITEM(__pyx_t_1, __pyx_t_10); __pyx_t_10++; if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 811, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_8);
              #endif
            }
          } else {
            __pyx_t_8 = __pyx_t_6(__pyx_t_1);
            if (unlikely(!__pyx_t_8)) {
              PyObject* exc_type = PyErr_Occurred();
              if (exc_type) {
                if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
                else __PYX_ERR(0, 811, __pyx_L1_error)
              }
              break;
            }
            __Pyx_GOTREF(__pyx_t_8);
          }
          __Pyx_XDECREF_SET(__pyx_v_j, __pyx_t_8);
          __pyx_t_8 = 0;
          __pyx_t_8 = __Pyx_PyNumber_Int(__pyx_v_j); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 811, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_8);
          if (unlikely(__Pyx_ListComp_Append(__pyx_t_7, (PyObject*)__pyx_t_8))) __PYX_ERR(0, 811, __pyx_L1_error)
          __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
        }
        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
        __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 811, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        __Pyx_GIVEREF(__pyx_t_7);
        PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_7);
        __pyx_t_7 = 0;
        __pyx_t_7 = __Pyx_PyObject_Call(__pyx_builtin_sum, __pyx_t_1, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 811, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_7);
        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
        __pyx_t_9 = __Pyx_PyList_Append(__pyx_v_out, __pyx_t_7); if (unlikely(__pyx_t_9 == -1)) __PYX_ERR(0, 811, __pyx_L1_error)
        __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
      }
      __pyx_L15:;

      /* "vapor_vali/Simple_function.pyx":809
 *             if i=='./.': out.append(1)
 *             else:   out.append(sum([int(j) for j in i.split('/')]))
 *         elif '|' in i:             # <<<<<<<<<<<<<<
 *             if i=='.|.': out.append(1)
 *             else:   out.append(sum([int(j) for j in i.split('|')]))
 */
      goto __pyx_L11;
    }

    /* "vapor_vali/Simple_function.pyx":812
 *             if i=='.|.': out.append(1)
 *             else:   out.append(sum([int(j) for j in i.split('|')]))
 *         elif i=='.':    out.append(1)             # <<<<<<<<<<<<<<
 *     return out
 * 
 */
    __pyx_t_3 = (__Pyx_PyString_Equals(__pyx_v_i, __pyx_kp_s__19, Py_EQ)); if (unlikely(__pyx_t_3 < 0)) __PYX_ERR(0, 812, __pyx_L1_error)
    if (__pyx_t_3) {
      __pyx_t_9 = __Pyx_PyList_Append(__pyx_v_out, __pyx_int_1); if (unlikely(__pyx_t_9 == -1)) __PYX_ERR(0, 812, __pyx_L1_error)
    }
    __pyx_L11:;

    /* "vapor_vali/Simple_function.pyx":805
 *             if x=='GT': break
 *     geno=[i.split(':')[rec_pos] for i in pin[9:]]
 *     for i in geno:             # <<<<<<<<<<<<<<
 *         if '/' in i:
 *             if i=='./.': out.append(1)
 */
  }
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;

  /* "vapor_vali/Simple_function.pyx":813
 *             else:   out.append(sum([int(j) for j in i.split('|')]))
 *         elif i=='.':    out.append(1)
 *     return out             # <<<<<<<<<<<<<<
 * 
 * def INS_length_detect(pin):
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_out);
  __pyx_r = __pyx_v_out;
  goto __pyx_L0;

  /* "vapor_vali/Simple_function.pyx":797
 *     return out
 * 
 * def genotype_extract(pin):             # <<<<<<<<<<<<<<
 *     out=[0,0]
 *     rec_pos=-1
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_7);
  __Pyx_XDECREF(__pyx_t_8);
  __Pyx_AddTraceback("vapor_vali.Simple_function.genotype_extract", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_out);
  __Pyx_XDECREF(__pyx_v_rec_pos);
  __Pyx_XDECREF(__pyx_v_x);
  __Pyx_XDECREF(__pyx_v_geno);
  __Pyx_XDECREF(__pyx_v_i);
  __Pyx_XDECREF(__pyx_v_j);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "vapor_vali/Simple_function.pyx":815
 *     return out
 * 
 * def INS_length_detect(pin):             # <<<<<<<<<<<<<<
 *     out=0
 *     for x in pin[7].split(';'):
 */

/* Python wrapper */
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_113INS_length_detect(PyObject *__pyx_self, PyObject *__pyx_v_pin); /*proto*/
static PyMethodDef __pyx_mdef_10vapor_vali_15Simple_function_113INS_length_detect = {"INS_length_detect", (PyCFunction)__pyx_pw_10vapor_vali_15Simple_function_113INS_length_detect, METH_O, 0};
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_113INS_length_detect(PyObject *__pyx_self, PyObject *__pyx_v_pin) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("INS_length_detect (wrapper)", 0);
  __pyx_r = __pyx_pf_10vapor_vali_15Simple_function_112INS_length_detect(__pyx_self, ((PyObject *)__pyx_v_pin));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10vapor_vali_15Simple_function_112INS_length_detect(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_pin) {
  PyObject *__pyx_v_out = NULL;
  PyObject *__pyx_v_x = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  Py_ssize_t __pyx_t_3;
  PyObject *(*__pyx_t_4)(PyObject *);
  int __pyx_t_5;
  int __pyx_t_6;
  PyObject *__pyx_t_7 = NULL;
  __Pyx_RefNannySetupContext("INS_length_detect", 0);

  /* "vapor_vali/Simple_function.pyx":816
 * 
 * def INS_length_detect(pin):
 *     out=0             # <<<<<<<<<<<<<<
 *     for x in pin[7].split(';'):
 *         if 'SVLEN=' in x:
 */
  __Pyx_INCREF(__pyx_int_0);
  __pyx_v_out = __pyx_int_0;

  /* "vapor_vali/Simple_function.pyx":817
 * def INS_length_detect(pin):
 *     out=0
 *     for x in pin[7].split(';'):             # <<<<<<<<<<<<<<
 *         if 'SVLEN=' in x:
 *             out=int(x.split('=')[1])
 */
  __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_pin, 7, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 817, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_split); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 817, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_tuple__50, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 817, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  if (likely(PyList_CheckExact(__pyx_t_1)) || PyTuple_CheckExact(__pyx_t_1)) {
    __pyx_t_2 = __pyx_t_1; __Pyx_INCREF(__pyx_t_2); __pyx_t_3 = 0;
    __pyx_t_4 = NULL;
  } else {
    __pyx_t_3 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 817, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_4 = Py_TYPE(__pyx_t_2)->tp_iternext; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 817, __pyx_L1_error)
  }
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  for (;;) {
    if (likely(!__pyx_t_4)) {
      if (likely(PyList_CheckExact(__pyx_t_2))) {
        if (__pyx_t_3 >= PyList_GET_SIZE(__pyx_t_2)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_1 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_3); __Pyx_INCREF(__pyx_t_1); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 817, __pyx_L1_error)
        #else
        __pyx_t_1 = PySequence_ITEM(__pyx_t_2, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 817, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        #endif
      } else {
        if (__pyx_t_3 >= PyTuple_GET_SIZE(__pyx_t_2)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_3); __Pyx_INCREF(__pyx_t_1); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 817, __pyx_L1_error)
        #else
        __pyx_t_1 = PySequence_ITEM(__pyx_t_2, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 817, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        #endif
      }
    } else {
      __pyx_t_1 = __pyx_t_4(__pyx_t_2);
      if (unlikely(!__pyx_t_1)) {
        PyObject* exc_type = PyErr_Occurred();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
          else __PYX_ERR(0, 817, __pyx_L1_error)
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_1);
    }
    __Pyx_XDECREF_SET(__pyx_v_x, __pyx_t_1);
    __pyx_t_1 = 0;

    /* "vapor_vali/Simple_function.pyx":818
 *     out=0
 *     for x in pin[7].split(';'):
 *         if 'SVLEN=' in x:             # <<<<<<<<<<<<<<
 *             out=int(x.split('=')[1])
 *     return out
 */
    __pyx_t_5 = (__Pyx_PySequence_ContainsTF(__pyx_kp_s_SVLEN, __pyx_v_x, Py_EQ)); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 818, __pyx_L1_error)
    __pyx_t_6 = (__pyx_t_5 != 0);
    if (__pyx_t_6) {

      /* "vapor_vali/Simple_function.pyx":819
 *     for x in pin[7].split(';'):
 *         if 'SVLEN=' in x:
 *             out=int(x.split('=')[1])             # <<<<<<<<<<<<<<
 *     return out
 * 
 */
      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_x, __pyx_n_s_split); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 819, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_tuple__51, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 819, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_7);
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_1 = __Pyx_GetItemInt(__pyx_t_7, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 819, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
      __pyx_t_7 = __Pyx_PyNumber_Int(__pyx_t_1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 819, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_7);
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      __Pyx_DECREF_SET(__pyx_v_out, __pyx_t_7);
      __pyx_t_7 = 0;

      /* "vapor_vali/Simple_function.pyx":818
 *     out=0
 *     for x in pin[7].split(';'):
 *         if 'SVLEN=' in x:             # <<<<<<<<<<<<<<
 *             out=int(x.split('=')[1])
 *     return out
 */
    }

    /* "vapor_vali/Simple_function.pyx":817
 * def INS_length_detect(pin):
 *     out=0
 *     for x in pin[7].split(';'):             # <<<<<<<<<<<<<<
 *         if 'SVLEN=' in x:
 *             out=int(x.split('=')[1])
 */
  }
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":820
 *         if 'SVLEN=' in x:
 *             out=int(x.split('=')[1])
 *     return out             # <<<<<<<<<<<<<<
 * 
 * def intersect(a, b):
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_out);
  __pyx_r = __pyx_v_out;
  goto __pyx_L0;

  /* "vapor_vali/Simple_function.pyx":815
 *     return out
 * 
 * def INS_length_detect(pin):             # <<<<<<<<<<<<<<
 *     out=0
 *     for x in pin[7].split(';'):
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_7);
  __Pyx_AddTraceback("vapor_vali.Simple_function.INS_length_detect", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_out);
  __Pyx_XDECREF(__pyx_v_x);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "vapor_vali/Simple_function.pyx":822
 *     return out
 * 
 * def intersect(a, b):             # <<<<<<<<<<<<<<
 *     return ''.join(sorted(list(set(a) & set(b))))
 * 
 */

/* Python wrapper */
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_115intersect(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_10vapor_vali_15Simple_function_115intersect = {"intersect", (PyCFunction)__pyx_pw_10vapor_vali_15Simple_function_115intersect, METH_VARARGS|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_115intersect(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_a = 0;
  PyObject *__pyx_v_b = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("intersect (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_a,&__pyx_n_s_b,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_a)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_b)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("intersect", 1, 2, 2, 1); __PYX_ERR(0, 822, __pyx_L3_error)
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "intersect") < 0)) __PYX_ERR(0, 822, __pyx_L3_error)
      }
    } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
    }
    __pyx_v_a = values[0];
    __pyx_v_b = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("intersect", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 822, __pyx_L3_error)
  __pyx_L3_error:;
  __Pyx_AddTraceback("vapor_vali.Simple_function.intersect", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_10vapor_vali_15Simple_function_114intersect(__pyx_self, __pyx_v_a, __pyx_v_b);

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10vapor_vali_15Simple_function_114intersect(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_a, PyObject *__pyx_v_b) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  int __pyx_t_5;
  __Pyx_RefNannySetupContext("intersect", 0);

  /* "vapor_vali/Simple_function.pyx":823
 * 
 * def intersect(a, b):
 *     return ''.join(sorted(list(set(a) & set(b))))             # <<<<<<<<<<<<<<
 * 
 * def interval_dis_calcu_max(pos_check):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_2 = PySet_New(__pyx_v_a); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 823, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = PySet_New(__pyx_v_b); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 823, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_4 = PyNumber_And(__pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 823, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = PySequence_List(__pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 823, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = PySequence_List(__pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 823, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_1 = ((PyObject*)__pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_5 = PyList_Sort(__pyx_t_1); if (unlikely(__pyx_t_5 == -1)) __PYX_ERR(0, 823, __pyx_L1_error)
  __pyx_t_4 = __Pyx_PyString_Join(__pyx_kp_s__24, __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 823, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_r = __pyx_t_4;
  __pyx_t_4 = 0;
  goto __pyx_L0;

  /* "vapor_vali/Simple_function.pyx":822
 *     return out
 * 
 * def intersect(a, b):             # <<<<<<<<<<<<<<
 *     return ''.join(sorted(list(set(a) & set(b))))
 * 
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_AddTraceback("vapor_vali.Simple_function.intersect", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "vapor_vali/Simple_function.pyx":825
 *     return ''.join(sorted(list(set(a) & set(b))))
 * 
 * def interval_dis_calcu_max(pos_check):             # <<<<<<<<<<<<<<
 *     #eg of pos_check=[97,98]
 *     if len(pos_check)>1:
 */

/* Python wrapper */
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_117interval_dis_calcu_max(PyObject *__pyx_self, PyObject *__pyx_v_pos_check); /*proto*/
static PyMethodDef __pyx_mdef_10vapor_vali_15Simple_function_117interval_dis_calcu_max = {"interval_dis_calcu_max", (PyCFunction)__pyx_pw_10vapor_vali_15Simple_function_117interval_dis_calcu_max, METH_O, 0};
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_117interval_dis_calcu_max(PyObject *__pyx_self, PyObject *__pyx_v_pos_check) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("interval_dis_calcu_max (wrapper)", 0);
  __pyx_r = __pyx_pf_10vapor_vali_15Simple_function_116interval_dis_calcu_max(__pyx_self, ((PyObject *)__pyx_v_pos_check));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10vapor_vali_15Simple_function_116interval_dis_calcu_max(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_pos_check) {
  PyObject *__pyx_v_out = NULL;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  Py_ssize_t __pyx_t_1;
  int __pyx_t_2;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  PyObject *(*__pyx_t_6)(PyObject *);
  PyObject *__pyx_t_7 = NULL;
  PyObject *__pyx_t_8 = NULL;
  __Pyx_RefNannySetupContext("interval_dis_calcu_max", 0);

  /* "vapor_vali/Simple_function.pyx":827
 * def interval_dis_calcu_max(pos_check):
 *     #eg of pos_check=[97,98]
 *     if len(pos_check)>1:             # <<<<<<<<<<<<<<
 *         out=[pos_check[i+1]-pos_check[i] for i in range(len(pos_check)-1)]
 *         return max(out)
 */
  __pyx_t_1 = PyObject_Length(__pyx_v_pos_check); if (unlikely(__pyx_t_1 == -1)) __PYX_ERR(0, 827, __pyx_L1_error)
  __pyx_t_2 = ((__pyx_t_1 > 1) != 0);
  if (__pyx_t_2) {

    /* "vapor_vali/Simple_function.pyx":828
 *     #eg of pos_check=[97,98]
 *     if len(pos_check)>1:
 *         out=[pos_check[i+1]-pos_check[i] for i in range(len(pos_check)-1)]             # <<<<<<<<<<<<<<
 *         return max(out)
 *     else:
 */
    __pyx_t_3 = PyList_New(0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 828, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_1 = PyObject_Length(__pyx_v_pos_check); if (unlikely(__pyx_t_1 == -1)) __PYX_ERR(0, 828, __pyx_L1_error)
    __pyx_t_4 = PyInt_FromSsize_t((__pyx_t_1 - 1)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 828, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 828, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_GIVEREF(__pyx_t_4);
    PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_4);
    __pyx_t_4 = 0;
    __pyx_t_4 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_t_5, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 828, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    if (likely(PyList_CheckExact(__pyx_t_4)) || PyTuple_CheckExact(__pyx_t_4)) {
      __pyx_t_5 = __pyx_t_4; __Pyx_INCREF(__pyx_t_5); __pyx_t_1 = 0;
      __pyx_t_6 = NULL;
    } else {
      __pyx_t_1 = -1; __pyx_t_5 = PyObject_GetIter(__pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 828, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_5);
      __pyx_t_6 = Py_TYPE(__pyx_t_5)->tp_iternext; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 828, __pyx_L1_error)
    }
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    for (;;) {
      if (likely(!__pyx_t_6)) {
        if (likely(PyList_CheckExact(__pyx_t_5))) {
          if (__pyx_t_1 >= PyList_GET_SIZE(__pyx_t_5)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_4 = PyList_GET_ITEM(__pyx_t_5, __pyx_t_1); __Pyx_INCREF(__pyx_t_4); __pyx_t_1++; if (unlikely(0 < 0)) __PYX_ERR(0, 828, __pyx_L1_error)
          #else
          __pyx_t_4 = PySequence_ITEM(__pyx_t_5, __pyx_t_1); __pyx_t_1++; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 828, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_4);
          #endif
        } else {
          if (__pyx_t_1 >= PyTuple_GET_SIZE(__pyx_t_5)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_4 = PyTuple_GET_ITEM(__pyx_t_5, __pyx_t_1); __Pyx_INCREF(__pyx_t_4); __pyx_t_1++; if (unlikely(0 < 0)) __PYX_ERR(0, 828, __pyx_L1_error)
          #else
          __pyx_t_4 = PySequence_ITEM(__pyx_t_5, __pyx_t_1); __pyx_t_1++; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 828, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_4);
          #endif
        }
      } else {
        __pyx_t_4 = __pyx_t_6(__pyx_t_5);
        if (unlikely(!__pyx_t_4)) {
          PyObject* exc_type = PyErr_Occurred();
          if (exc_type) {
            if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
            else __PYX_ERR(0, 828, __pyx_L1_error)
          }
          break;
        }
        __Pyx_GOTREF(__pyx_t_4);
      }
      __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_4);
      __pyx_t_4 = 0;
      __pyx_t_4 = __Pyx_PyInt_AddObjC(__pyx_v_i, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 828, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_t_7 = PyObject_GetItem(__pyx_v_pos_check, __pyx_t_4); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 828, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_7);
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_4 = PyObject_GetItem(__pyx_v_pos_check, __pyx_v_i); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 828, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_t_8 = PyNumber_Subtract(__pyx_t_7, __pyx_t_4); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 828, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_8);
      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      if (unlikely(__Pyx_ListComp_Append(__pyx_t_3, (PyObject*)__pyx_t_8))) __PYX_ERR(0, 828, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
    }
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_v_out = ((PyObject*)__pyx_t_3);
    __pyx_t_3 = 0;

    /* "vapor_vali/Simple_function.pyx":829
 *     if len(pos_check)>1:
 *         out=[pos_check[i+1]-pos_check[i] for i in range(len(pos_check)-1)]
 *         return max(out)             # <<<<<<<<<<<<<<
 *     else:
 *         return 'NA'
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 829, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_INCREF(__pyx_v_out);
    __Pyx_GIVEREF(__pyx_v_out);
    PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_v_out);
    __pyx_t_5 = __Pyx_PyObject_Call(__pyx_builtin_max, __pyx_t_3, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 829, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_r = __pyx_t_5;
    __pyx_t_5 = 0;
    goto __pyx_L0;

    /* "vapor_vali/Simple_function.pyx":827
 * def interval_dis_calcu_max(pos_check):
 *     #eg of pos_check=[97,98]
 *     if len(pos_check)>1:             # <<<<<<<<<<<<<<
 *         out=[pos_check[i+1]-pos_check[i] for i in range(len(pos_check)-1)]
 *         return max(out)
 */
  }

  /* "vapor_vali/Simple_function.pyx":831
 *         return max(out)
 *     else:
 *         return 'NA'             # <<<<<<<<<<<<<<
 * 
 * def kept_lines_size_filter(size_list,square_size=400):
 */
  /*else*/ {
    __Pyx_XDECREF(__pyx_r);
    __Pyx_INCREF(__pyx_n_s_NA);
    __pyx_r = __pyx_n_s_NA;
    goto __pyx_L0;
  }

  /* "vapor_vali/Simple_function.pyx":825
 *     return ''.join(sorted(list(set(a) & set(b))))
 * 
 * def interval_dis_calcu_max(pos_check):             # <<<<<<<<<<<<<<
 *     #eg of pos_check=[97,98]
 *     if len(pos_check)>1:
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_7);
  __Pyx_XDECREF(__pyx_t_8);
  __Pyx_AddTraceback("vapor_vali.Simple_function.interval_dis_calcu_max", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_out);
  __Pyx_XDECREF(__pyx_v_i);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "vapor_vali/Simple_function.pyx":833
 *         return 'NA'
 * 
 * def kept_lines_size_filter(size_list,square_size=400):             # <<<<<<<<<<<<<<
 *     #eg of size_list=[(1582, 415), (1677, 506)]
 *     if abs((size_list[1][0]-size_list[0][0])*(size_list[1][1]-size_list[0][1]))>square_size:    return 'TRUE'
 */

/* Python wrapper */
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_119kept_lines_size_filter(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_10vapor_vali_15Simple_function_119kept_lines_size_filter = {"kept_lines_size_filter", (PyCFunction)__pyx_pw_10vapor_vali_15Simple_function_119kept_lines_size_filter, METH_VARARGS|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_119kept_lines_size_filter(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_size_list = 0;
  PyObject *__pyx_v_square_size = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("kept_lines_size_filter (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_size_list,&__pyx_n_s_square_size,0};
    PyObject* values[2] = {0,0};
    values[1] = ((PyObject *)__pyx_int_400);
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_size_list)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (kw_args > 0) {
          PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_square_size);
          if (value) { values[1] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "kept_lines_size_filter") < 0)) __PYX_ERR(0, 833, __pyx_L3_error)
      }
    } else {
      switch (PyTuple_GET_SIZE(__pyx_args)) {
        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_size_list = values[0];
    __pyx_v_square_size = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("kept_lines_size_filter", 0, 1, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 833, __pyx_L3_error)
  __pyx_L3_error:;
  __Pyx_AddTraceback("vapor_vali.Simple_function.kept_lines_size_filter", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_10vapor_vali_15Simple_function_118kept_lines_size_filter(__pyx_self, __pyx_v_size_list, __pyx_v_square_size);

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10vapor_vali_15Simple_function_118kept_lines_size_filter(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_size_list, PyObject *__pyx_v_square_size) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  int __pyx_t_5;
  __Pyx_RefNannySetupContext("kept_lines_size_filter", 0);

  /* "vapor_vali/Simple_function.pyx":835
 * def kept_lines_size_filter(size_list,square_size=400):
 *     #eg of size_list=[(1582, 415), (1677, 506)]
 *     if abs((size_list[1][0]-size_list[0][0])*(size_list[1][1]-size_list[0][1]))>square_size:    return 'TRUE'             # <<<<<<<<<<<<<<
 *     else:                                                                                       return 'FALSE'
 * 
 */
  __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_size_list, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 835, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_GetItemInt(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 835, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_size_list, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 835, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_3 = __Pyx_GetItemInt(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 835, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = PyNumber_Subtract(__pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 835, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_size_list, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 835, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_2 = __Pyx_GetItemInt(__pyx_t_3, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 835, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_size_list, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 835, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_4 = __Pyx_GetItemInt(__pyx_t_3, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 835, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = PyNumber_Subtract(__pyx_t_2, __pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 835, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = PyNumber_Multiply(__pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 835, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = PyNumber_Absolute(__pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 835, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = PyObject_RichCompare(__pyx_t_3, __pyx_v_square_size, Py_GT); __Pyx_XGOTREF(__pyx_t_4); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 835, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_4); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 835, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  if (__pyx_t_5) {
    __Pyx_XDECREF(__pyx_r);
    __Pyx_INCREF(__pyx_n_s_TRUE);
    __pyx_r = __pyx_n_s_TRUE;
    goto __pyx_L0;
  }

  /* "vapor_vali/Simple_function.pyx":836
 *     #eg of size_list=[(1582, 415), (1677, 506)]
 *     if abs((size_list[1][0]-size_list[0][0])*(size_list[1][1]-size_list[0][1]))>square_size:    return 'TRUE'
 *     else:                                                                                       return 'FALSE'             # <<<<<<<<<<<<<<
 * 
 * def k_means_cluster(data_list):
 */
  /*else*/ {
    __Pyx_XDECREF(__pyx_r);
    __Pyx_INCREF(__pyx_n_s_FALSE);
    __pyx_r = __pyx_n_s_FALSE;
    goto __pyx_L0;
  }

  /* "vapor_vali/Simple_function.pyx":833
 *         return 'NA'
 * 
 * def kept_lines_size_filter(size_list,square_size=400):             # <<<<<<<<<<<<<<
 *     #eg of size_list=[(1582, 415), (1677, 506)]
 *     if abs((size_list[1][0]-size_list[0][0])*(size_list[1][1]-size_list[0][1]))>square_size:    return 'TRUE'
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_AddTraceback("vapor_vali.Simple_function.kept_lines_size_filter", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "vapor_vali/Simple_function.pyx":838
 *     else:                                                                                       return 'FALSE'
 * 
 * def k_means_cluster(data_list):             # <<<<<<<<<<<<<<
 *     if max(data_list[0])-min(data_list[0])>10 and max(data_list[1])-min(data_list[1])>10:
 *         array_diagnal=np.array([[data_list[0][x],data_list[1][x]] for x in range(len(data_list[0]))])
 */

/* Python wrapper */
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_121k_means_cluster(PyObject *__pyx_self, PyObject *__pyx_v_data_list); /*proto*/
static PyMethodDef __pyx_mdef_10vapor_vali_15Simple_function_121k_means_cluster = {"k_means_cluster", (PyCFunction)__pyx_pw_10vapor_vali_15Simple_function_121k_means_cluster, METH_O, 0};
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_121k_means_cluster(PyObject *__pyx_self, PyObject *__pyx_v_data_list) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("k_means_cluster (wrapper)", 0);
  __pyx_r = __pyx_pf_10vapor_vali_15Simple_function_120k_means_cluster(__pyx_self, ((PyObject *)__pyx_v_data_list));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10vapor_vali_15Simple_function_120k_means_cluster(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_data_list) {
  PyObject *__pyx_v_array_diagnal = NULL;
  PyObject *__pyx_v_ks = NULL;
  PyObject *__pyx_v_KMeans = NULL;
  PyObject *__pyx_v_KMeans_predict = NULL;
  PyObject *__pyx_v_BIC = NULL;
  PyObject *__pyx_v_BIC_rec = NULL;
  PyObject *__pyx_v_x = NULL;
  PyObject *__pyx_v_BIC_i = NULL;
  PyObject *__pyx_v_ks_picked = NULL;
  PyObject *__pyx_v_out = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_std_rec = NULL;
  PyObject *__pyx_v_whitened = NULL;
  PyObject *__pyx_v_centroids = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_distortion = NULL;
  PyObject *__pyx_v_idx = NULL;
  CYTHON_UNUSED PyObject *__pyx_v__ = NULL;
  PyObject *__pyx_v_group1 = NULL;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  int __pyx_t_5;
  PyObject *__pyx_t_6 = NULL;
  Py_ssize_t __pyx_t_7;
  PyObject *__pyx_t_8 = NULL;
  PyObject *(*__pyx_t_9)(PyObject *);
  PyObject *__pyx_t_10 = NULL;
  PyObject *__pyx_t_11 = NULL;
  Py_ssize_t __pyx_t_12;
  long __pyx_t_13;
  int __pyx_t_14;
  PyObject *(*__pyx_t_15)(PyObject *);
  PyObject *(*__pyx_t_16)(PyObject *);
  __Pyx_RefNannySetupContext("k_means_cluster", 0);

  /* "vapor_vali/Simple_function.pyx":839
 * 
 * def k_means_cluster(data_list):
 *     if max(data_list[0])-min(data_list[0])>10 and max(data_list[1])-min(data_list[1])>10:             # <<<<<<<<<<<<<<
 *         array_diagnal=np.array([[data_list[0][x],data_list[1][x]] for x in range(len(data_list[0]))])
 *         ks = list(range(1,min([5,len(data_list[0])+1])))
 */
  __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_data_list, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 839, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 839, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_GIVEREF(__pyx_t_2);
  PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_max, __pyx_t_3, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 839, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_data_list, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 839, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 839, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_GIVEREF(__pyx_t_3);
  PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_min, __pyx_t_4, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 839, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = PyNumber_Subtract(__pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 839, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = PyObject_RichCompare(__pyx_t_4, __pyx_int_10, Py_GT); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 839, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 839, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  if (__pyx_t_5) {
  } else {
    __pyx_t_1 = __pyx_t_5;
    goto __pyx_L4_bool_binop_done;
  }
  __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_data_list, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 839, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 839, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_GIVEREF(__pyx_t_3);
  PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_max, __pyx_t_4, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 839, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = __Pyx_GetItemInt(__pyx_v_data_list, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 839, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 839, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_GIVEREF(__pyx_t_4);
  PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_builtin_min, __pyx_t_2, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 839, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = PyNumber_Subtract(__pyx_t_3, __pyx_t_4); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 839, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = PyObject_RichCompare(__pyx_t_2, __pyx_int_10, Py_GT); __Pyx_XGOTREF(__pyx_t_4); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 839, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_4); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 839, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_1 = __pyx_t_5;
  __pyx_L4_bool_binop_done:;
  if (__pyx_t_1) {

    /* "vapor_vali/Simple_function.pyx":840
 * def k_means_cluster(data_list):
 *     if max(data_list[0])-min(data_list[0])>10 and max(data_list[1])-min(data_list[1])>10:
 *         array_diagnal=np.array([[data_list[0][x],data_list[1][x]] for x in range(len(data_list[0]))])             # <<<<<<<<<<<<<<
 *         ks = list(range(1,min([5,len(data_list[0])+1])))
 *         KMeans = [cluster.KMeans(n_clusters = i, init="k-means++").fit(array_diagnal) for i in ks]
 */
    __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 840, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_array); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 840, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = PyList_New(0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 840, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_6 = __Pyx_GetItemInt(__pyx_v_data_list, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 840, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __pyx_t_7 = PyObject_Length(__pyx_t_6); if (unlikely(__pyx_t_7 == -1)) __PYX_ERR(0, 840, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = PyInt_FromSsize_t(__pyx_t_7); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 840, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __pyx_t_8 = PyTuple_New(1); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 840, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_8);
    __Pyx_GIVEREF(__pyx_t_6);
    PyTuple_SET_ITEM(__pyx_t_8, 0, __pyx_t_6);
    __pyx_t_6 = 0;
    __pyx_t_6 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_t_8, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 840, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
    if (likely(PyList_CheckExact(__pyx_t_6)) || PyTuple_CheckExact(__pyx_t_6)) {
      __pyx_t_8 = __pyx_t_6; __Pyx_INCREF(__pyx_t_8); __pyx_t_7 = 0;
      __pyx_t_9 = NULL;
    } else {
      __pyx_t_7 = -1; __pyx_t_8 = PyObject_GetIter(__pyx_t_6); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 840, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_8);
      __pyx_t_9 = Py_TYPE(__pyx_t_8)->tp_iternext; if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 840, __pyx_L1_error)
    }
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    for (;;) {
      if (likely(!__pyx_t_9)) {
        if (likely(PyList_CheckExact(__pyx_t_8))) {
          if (__pyx_t_7 >= PyList_GET_SIZE(__pyx_t_8)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_6 = PyList_GET_ITEM(__pyx_t_8, __pyx_t_7); __Pyx_INCREF(__pyx_t_6); __pyx_t_7++; if (unlikely(0 < 0)) __PYX_ERR(0, 840, __pyx_L1_error)
          #else
          __pyx_t_6 = PySequence_ITEM(__pyx_t_8, __pyx_t_7); __pyx_t_7++; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 840, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_6);
          #endif
        } else {
          if (__pyx_t_7 >= PyTuple_GET_SIZE(__pyx_t_8)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_6 = PyTuple_GET_ITEM(__pyx_t_8, __pyx_t_7); __Pyx_INCREF(__pyx_t_6); __pyx_t_7++; if (unlikely(0 < 0)) __PYX_ERR(0, 840, __pyx_L1_error)
          #else
          __pyx_t_6 = PySequence_ITEM(__pyx_t_8, __pyx_t_7); __pyx_t_7++; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 840, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_6);
          #endif
        }
      } else {
        __pyx_t_6 = __pyx_t_9(__pyx_t_8);
        if (unlikely(!__pyx_t_6)) {
          PyObject* exc_type = PyErr_Occurred();
          if (exc_type) {
            if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
            else __PYX_ERR(0, 840, __pyx_L1_error)
          }
          break;
        }
        __Pyx_GOTREF(__pyx_t_6);
      }
      __Pyx_XDECREF_SET(__pyx_v_x, __pyx_t_6);
      __pyx_t_6 = 0;
      __pyx_t_6 = __Pyx_GetItemInt(__pyx_v_data_list, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 840, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_6);
      __pyx_t_10 = PyObject_GetItem(__pyx_t_6, __pyx_v_x); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 840, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_10);
      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
      __pyx_t_6 = __Pyx_GetItemInt(__pyx_v_data_list, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 840, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_6);
      __pyx_t_11 = PyObject_GetItem(__pyx_t_6, __pyx_v_x); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 840, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_11);
      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
      __pyx_t_6 = PyList_New(2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 840, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_6);
      __Pyx_GIVEREF(__pyx_t_10);
      PyList_SET_ITEM(__pyx_t_6, 0, __pyx_t_10);
      __Pyx_GIVEREF(__pyx_t_11);
      PyList_SET_ITEM(__pyx_t_6, 1, __pyx_t_11);
      __pyx_t_10 = 0;
      __pyx_t_11 = 0;
      if (unlikely(__Pyx_ListComp_Append(__pyx_t_2, (PyObject*)__pyx_t_6))) __PYX_ERR(0, 840, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    }
    __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
    __pyx_t_8 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_3))) {
      __pyx_t_8 = PyMethod_GET_SELF(__pyx_t_3);
      if (likely(__pyx_t_8)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
        __Pyx_INCREF(__pyx_t_8);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_3, function);
      }
    }
    if (!__pyx_t_8) {
      __pyx_t_4 = __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 840, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      __Pyx_GOTREF(__pyx_t_4);
    } else {
      __pyx_t_6 = PyTuple_New(1+1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 840, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_6);
      __Pyx_GIVEREF(__pyx_t_8); PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_8); __pyx_t_8 = NULL;
      __Pyx_GIVEREF(__pyx_t_2);
      PyTuple_SET_ITEM(__pyx_t_6, 0+1, __pyx_t_2);
      __pyx_t_2 = 0;
      __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_6, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 840, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    }
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_v_array_diagnal = __pyx_t_4;
    __pyx_t_4 = 0;

    /* "vapor_vali/Simple_function.pyx":841
 *     if max(data_list[0])-min(data_list[0])>10 and max(data_list[1])-min(data_list[1])>10:
 *         array_diagnal=np.array([[data_list[0][x],data_list[1][x]] for x in range(len(data_list[0]))])
 *         ks = list(range(1,min([5,len(data_list[0])+1])))             # <<<<<<<<<<<<<<
 *         KMeans = [cluster.KMeans(n_clusters = i, init="k-means++").fit(array_diagnal) for i in ks]
 *         KMeans_predict=[cluster.KMeans(n_clusters = i, init="k-means++").fit_predict(array_diagnal) for i in ks]
 */
    __pyx_t_4 = __Pyx_GetItemInt(__pyx_v_data_list, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 841, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_7 = PyObject_Length(__pyx_t_4); if (unlikely(__pyx_t_7 == -1)) __PYX_ERR(0, 841, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_12 = (__pyx_t_7 + 1);
    __pyx_t_13 = 5;
    if (((__pyx_t_12 < __pyx_t_13) != 0)) {
      __pyx_t_7 = __pyx_t_12;
    } else {
      __pyx_t_7 = __pyx_t_13;
    }
    __pyx_t_4 = PyInt_FromSsize_t(__pyx_t_7); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 841, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 841, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_INCREF(__pyx_int_1);
    __Pyx_GIVEREF(__pyx_int_1);
    PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_int_1);
    __Pyx_GIVEREF(__pyx_t_4);
    PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_t_4);
    __pyx_t_4 = 0;
    __pyx_t_4 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_t_3, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 841, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = PySequence_List(__pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 841, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_v_ks = ((PyObject*)__pyx_t_3);
    __pyx_t_3 = 0;

    /* "vapor_vali/Simple_function.pyx":842
 *         array_diagnal=np.array([[data_list[0][x],data_list[1][x]] for x in range(len(data_list[0]))])
 *         ks = list(range(1,min([5,len(data_list[0])+1])))
 *         KMeans = [cluster.KMeans(n_clusters = i, init="k-means++").fit(array_diagnal) for i in ks]             # <<<<<<<<<<<<<<
 *         KMeans_predict=[cluster.KMeans(n_clusters = i, init="k-means++").fit_predict(array_diagnal) for i in ks]
 *         BIC=[]
 */
    __pyx_t_3 = PyList_New(0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 842, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_4 = __pyx_v_ks; __Pyx_INCREF(__pyx_t_4); __pyx_t_7 = 0;
    for (;;) {
      if (__pyx_t_7 >= PyList_GET_SIZE(__pyx_t_4)) break;
      #if CYTHON_COMPILING_IN_CPYTHON
      __pyx_t_6 = PyList_GET_ITEM(__pyx_t_4, __pyx_t_7); __Pyx_INCREF(__pyx_t_6); __pyx_t_7++; if (unlikely(0 < 0)) __PYX_ERR(0, 842, __pyx_L1_error)
      #else
      __pyx_t_6 = PySequence_ITEM(__pyx_t_4, __pyx_t_7); __pyx_t_7++; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 842, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_6);
      #endif
      __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_6);
      __pyx_t_6 = 0;
      __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_cluster); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 842, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_KMeans); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 842, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_8);
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_2 = PyDict_New(); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 842, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_n_clusters, __pyx_v_i) < 0) __PYX_ERR(0, 842, __pyx_L1_error)
      if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_init, __pyx_kp_s_k_means) < 0) __PYX_ERR(0, 842, __pyx_L1_error)
      __pyx_t_11 = __Pyx_PyObject_Call(__pyx_t_8, __pyx_empty_tuple, __pyx_t_2); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 842, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_11);
      __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_11, __pyx_n_s_fit); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 842, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
      __pyx_t_11 = NULL;
      if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_2))) {
        __pyx_t_11 = PyMethod_GET_SELF(__pyx_t_2);
        if (likely(__pyx_t_11)) {
          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
          __Pyx_INCREF(__pyx_t_11);
          __Pyx_INCREF(function);
          __Pyx_DECREF_SET(__pyx_t_2, function);
        }
      }
      if (!__pyx_t_11) {
        __pyx_t_6 = __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_v_array_diagnal); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 842, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_6);
      } else {
        __pyx_t_8 = PyTuple_New(1+1); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 842, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_8);
        __Pyx_GIVEREF(__pyx_t_11); PyTuple_SET_ITEM(__pyx_t_8, 0, __pyx_t_11); __pyx_t_11 = NULL;
        __Pyx_INCREF(__pyx_v_array_diagnal);
        __Pyx_GIVEREF(__pyx_v_array_diagnal);
        PyTuple_SET_ITEM(__pyx_t_8, 0+1, __pyx_v_array_diagnal);
        __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_8, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 842, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_6);
        __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
      }
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      if (unlikely(__Pyx_ListComp_Append(__pyx_t_3, (PyObject*)__pyx_t_6))) __PYX_ERR(0, 842, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    }
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_v_KMeans = ((PyObject*)__pyx_t_3);
    __pyx_t_3 = 0;

    /* "vapor_vali/Simple_function.pyx":843
 *         ks = list(range(1,min([5,len(data_list[0])+1])))
 *         KMeans = [cluster.KMeans(n_clusters = i, init="k-means++").fit(array_diagnal) for i in ks]
 *         KMeans_predict=[cluster.KMeans(n_clusters = i, init="k-means++").fit_predict(array_diagnal) for i in ks]             # <<<<<<<<<<<<<<
 *         BIC=[]
 *         BIC_rec=[]
 */
    __pyx_t_3 = PyList_New(0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 843, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_4 = __pyx_v_ks; __Pyx_INCREF(__pyx_t_4); __pyx_t_7 = 0;
    for (;;) {
      if (__pyx_t_7 >= PyList_GET_SIZE(__pyx_t_4)) break;
      #if CYTHON_COMPILING_IN_CPYTHON
      __pyx_t_6 = PyList_GET_ITEM(__pyx_t_4, __pyx_t_7); __Pyx_INCREF(__pyx_t_6); __pyx_t_7++; if (unlikely(0 < 0)) __PYX_ERR(0, 843, __pyx_L1_error)
      #else
      __pyx_t_6 = PySequence_ITEM(__pyx_t_4, __pyx_t_7); __pyx_t_7++; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 843, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_6);
      #endif
      __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_6);
      __pyx_t_6 = 0;
      __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_cluster); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 843, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_KMeans); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 843, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_8);
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_2 = PyDict_New(); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 843, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_n_clusters, __pyx_v_i) < 0) __PYX_ERR(0, 843, __pyx_L1_error)
      if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_init, __pyx_kp_s_k_means) < 0) __PYX_ERR(0, 843, __pyx_L1_error)
      __pyx_t_11 = __Pyx_PyObject_Call(__pyx_t_8, __pyx_empty_tuple, __pyx_t_2); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 843, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_11);
      __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_11, __pyx_n_s_fit_predict); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 843, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
      __pyx_t_11 = NULL;
      if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_2))) {
        __pyx_t_11 = PyMethod_GET_SELF(__pyx_t_2);
        if (likely(__pyx_t_11)) {
          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
          __Pyx_INCREF(__pyx_t_11);
          __Pyx_INCREF(function);
          __Pyx_DECREF_SET(__pyx_t_2, function);
        }
      }
      if (!__pyx_t_11) {
        __pyx_t_6 = __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_v_array_diagnal); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 843, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_6);
      } else {
        __pyx_t_8 = PyTuple_New(1+1); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 843, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_8);
        __Pyx_GIVEREF(__pyx_t_11); PyTuple_SET_ITEM(__pyx_t_8, 0, __pyx_t_11); __pyx_t_11 = NULL;
        __Pyx_INCREF(__pyx_v_array_diagnal);
        __Pyx_GIVEREF(__pyx_v_array_diagnal);
        PyTuple_SET_ITEM(__pyx_t_8, 0+1, __pyx_v_array_diagnal);
        __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_8, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 843, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_6);
        __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
      }
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      if (unlikely(__Pyx_ListComp_Append(__pyx_t_3, (PyObject*)__pyx_t_6))) __PYX_ERR(0, 843, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    }
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_v_KMeans_predict = ((PyObject*)__pyx_t_3);
    __pyx_t_3 = 0;

    /* "vapor_vali/Simple_function.pyx":844
 *         KMeans = [cluster.KMeans(n_clusters = i, init="k-means++").fit(array_diagnal) for i in ks]
 *         KMeans_predict=[cluster.KMeans(n_clusters = i, init="k-means++").fit_predict(array_diagnal) for i in ks]
 *         BIC=[]             # <<<<<<<<<<<<<<
 *         BIC_rec=[]
 *         for x in ks:
 */
    __pyx_t_3 = PyList_New(0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 844, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_v_BIC = ((PyObject*)__pyx_t_3);
    __pyx_t_3 = 0;

    /* "vapor_vali/Simple_function.pyx":845
 *         KMeans_predict=[cluster.KMeans(n_clusters = i, init="k-means++").fit_predict(array_diagnal) for i in ks]
 *         BIC=[]
 *         BIC_rec=[]             # <<<<<<<<<<<<<<
 *         for x in ks:
 *             if KMeans_predict[x-1].max()<x-1: continue
 */
    __pyx_t_3 = PyList_New(0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 845, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_v_BIC_rec = ((PyObject*)__pyx_t_3);
    __pyx_t_3 = 0;

    /* "vapor_vali/Simple_function.pyx":846
 *         BIC=[]
 *         BIC_rec=[]
 *         for x in ks:             # <<<<<<<<<<<<<<
 *             if KMeans_predict[x-1].max()<x-1: continue
 *             else:
 */
    __pyx_t_3 = __pyx_v_ks; __Pyx_INCREF(__pyx_t_3); __pyx_t_7 = 0;
    for (;;) {
      if (__pyx_t_7 >= PyList_GET_SIZE(__pyx_t_3)) break;
      #if CYTHON_COMPILING_IN_CPYTHON
      __pyx_t_4 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_7); __Pyx_INCREF(__pyx_t_4); __pyx_t_7++; if (unlikely(0 < 0)) __PYX_ERR(0, 846, __pyx_L1_error)
      #else
      __pyx_t_4 = PySequence_ITEM(__pyx_t_3, __pyx_t_7); __pyx_t_7++; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 846, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      #endif
      __Pyx_XDECREF_SET(__pyx_v_x, __pyx_t_4);
      __pyx_t_4 = 0;

      /* "vapor_vali/Simple_function.pyx":847
 *         BIC_rec=[]
 *         for x in ks:
 *             if KMeans_predict[x-1].max()<x-1: continue             # <<<<<<<<<<<<<<
 *             else:
 *                 BIC_i=compute_bic(KMeans[x-1],array_diagnal)
 */
      __pyx_t_6 = __Pyx_PyInt_SubtractObjC(__pyx_v_x, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 847, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_6);
      __pyx_t_2 = PyObject_GetItem(__pyx_v_KMeans_predict, __pyx_t_6); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 847, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
      __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_max); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 847, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_6);
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_2 = NULL;
      if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_6))) {
        __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_6);
        if (likely(__pyx_t_2)) {
          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
          __Pyx_INCREF(__pyx_t_2);
          __Pyx_INCREF(function);
          __Pyx_DECREF_SET(__pyx_t_6, function);
        }
      }
      if (__pyx_t_2) {
        __pyx_t_4 = __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 847, __pyx_L1_error)
        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      } else {
        __pyx_t_4 = __Pyx_PyObject_CallNoArg(__pyx_t_6); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 847, __pyx_L1_error)
      }
      __Pyx_GOTREF(__pyx_t_4);
      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
      __pyx_t_6 = __Pyx_PyInt_SubtractObjC(__pyx_v_x, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 847, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_6);
      __pyx_t_2 = PyObject_RichCompare(__pyx_t_4, __pyx_t_6, Py_LT); __Pyx_XGOTREF(__pyx_t_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 847, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
      __pyx_t_1 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(0, 847, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      if (__pyx_t_1) {
        goto __pyx_L12_continue;
      }

      /* "vapor_vali/Simple_function.pyx":849
 *             if KMeans_predict[x-1].max()<x-1: continue
 *             else:
 *                 BIC_i=compute_bic(KMeans[x-1],array_diagnal)             # <<<<<<<<<<<<<<
 *                 if abs(BIC_i)<10**8:
 *                     BIC.append(BIC_i)
 */
      /*else*/ {
        __pyx_t_6 = __Pyx_GetModuleGlobalName(__pyx_n_s_compute_bic); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 849, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_6);
        __pyx_t_4 = __Pyx_PyInt_SubtractObjC(__pyx_v_x, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 849, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_4);
        __pyx_t_8 = PyObject_GetItem(__pyx_v_KMeans, __pyx_t_4); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 849, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_8);
        __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
        __pyx_t_4 = NULL;
        __pyx_t_12 = 0;
        if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_6))) {
          __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_6);
          if (likely(__pyx_t_4)) {
            PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
            __Pyx_INCREF(__pyx_t_4);
            __Pyx_INCREF(function);
            __Pyx_DECREF_SET(__pyx_t_6, function);
            __pyx_t_12 = 1;
          }
        }
        __pyx_t_11 = PyTuple_New(2+__pyx_t_12); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 849, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_11);
        if (__pyx_t_4) {
          __Pyx_GIVEREF(__pyx_t_4); PyTuple_SET_ITEM(__pyx_t_11, 0, __pyx_t_4); __pyx_t_4 = NULL;
        }
        __Pyx_GIVEREF(__pyx_t_8);
        PyTuple_SET_ITEM(__pyx_t_11, 0+__pyx_t_12, __pyx_t_8);
        __Pyx_INCREF(__pyx_v_array_diagnal);
        __Pyx_GIVEREF(__pyx_v_array_diagnal);
        PyTuple_SET_ITEM(__pyx_t_11, 1+__pyx_t_12, __pyx_v_array_diagnal);
        __pyx_t_8 = 0;
        __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_11, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 849, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
        __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
        __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
        __Pyx_XDECREF_SET(__pyx_v_BIC_i, __pyx_t_2);
        __pyx_t_2 = 0;

        /* "vapor_vali/Simple_function.pyx":850
 *             else:
 *                 BIC_i=compute_bic(KMeans[x-1],array_diagnal)
 *                 if abs(BIC_i)<10**8:             # <<<<<<<<<<<<<<
 *                     BIC.append(BIC_i)
 *                     BIC_rec.append(x)
 */
        __pyx_t_2 = PyNumber_Absolute(__pyx_v_BIC_i); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 850, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
        __pyx_t_6 = PyObject_RichCompare(__pyx_t_2, __pyx_int_100000000, Py_LT); __Pyx_XGOTREF(__pyx_t_6); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 850, __pyx_L1_error)
        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
        __pyx_t_1 = __Pyx_PyObject_IsTrue(__pyx_t_6); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(0, 850, __pyx_L1_error)
        __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
        if (__pyx_t_1) {

          /* "vapor_vali/Simple_function.pyx":851
 *                 BIC_i=compute_bic(KMeans[x-1],array_diagnal)
 *                 if abs(BIC_i)<10**8:
 *                     BIC.append(BIC_i)             # <<<<<<<<<<<<<<
 *                     BIC_rec.append(x)
 *         #BIC = [compute_bic(kmeansi,array_diagnal) for kmeansi in KMeans]
 */
          __pyx_t_14 = __Pyx_PyList_Append(__pyx_v_BIC, __pyx_v_BIC_i); if (unlikely(__pyx_t_14 == -1)) __PYX_ERR(0, 851, __pyx_L1_error)

          /* "vapor_vali/Simple_function.pyx":852
 *                 if abs(BIC_i)<10**8:
 *                     BIC.append(BIC_i)
 *                     BIC_rec.append(x)             # <<<<<<<<<<<<<<
 *         #BIC = [compute_bic(kmeansi,array_diagnal) for kmeansi in KMeans]
 *         #ks_picked=ks[BIC.index(max(BIC))]
 */
          __pyx_t_14 = __Pyx_PyList_Append(__pyx_v_BIC_rec, __pyx_v_x); if (unlikely(__pyx_t_14 == -1)) __PYX_ERR(0, 852, __pyx_L1_error)

          /* "vapor_vali/Simple_function.pyx":850
 *             else:
 *                 BIC_i=compute_bic(KMeans[x-1],array_diagnal)
 *                 if abs(BIC_i)<10**8:             # <<<<<<<<<<<<<<
 *                     BIC.append(BIC_i)
 *                     BIC_rec.append(x)
 */
        }
      }

      /* "vapor_vali/Simple_function.pyx":846
 *         BIC=[]
 *         BIC_rec=[]
 *         for x in ks:             # <<<<<<<<<<<<<<
 *             if KMeans_predict[x-1].max()<x-1: continue
 *             else:
 */
      __pyx_L12_continue:;
    }
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;

    /* "vapor_vali/Simple_function.pyx":855
 *         #BIC = [compute_bic(kmeansi,array_diagnal) for kmeansi in KMeans]
 *         #ks_picked=ks[BIC.index(max(BIC))]
 *         ks_picked=BIC_rec[BIC.index(max(BIC))]             # <<<<<<<<<<<<<<
 *         if ks_picked==1:
 *             return [data_list]
 */
    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_BIC, __pyx_n_s_index); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 855, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 855, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_INCREF(__pyx_v_BIC);
    __Pyx_GIVEREF(__pyx_v_BIC);
    PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_v_BIC);
    __pyx_t_11 = __Pyx_PyObject_Call(__pyx_builtin_max, __pyx_t_2, NULL); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 855, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_11);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_6))) {
      __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_6);
      if (likely(__pyx_t_2)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
        __Pyx_INCREF(__pyx_t_2);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_6, function);
      }
    }
    if (!__pyx_t_2) {
      __pyx_t_3 = __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_11); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 855, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
      __Pyx_GOTREF(__pyx_t_3);
    } else {
      __pyx_t_8 = PyTuple_New(1+1); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 855, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_8);
      __Pyx_GIVEREF(__pyx_t_2); PyTuple_SET_ITEM(__pyx_t_8, 0, __pyx_t_2); __pyx_t_2 = NULL;
      __Pyx_GIVEREF(__pyx_t_11);
      PyTuple_SET_ITEM(__pyx_t_8, 0+1, __pyx_t_11);
      __pyx_t_11 = 0;
      __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_8, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 855, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
    }
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = PyObject_GetItem(__pyx_v_BIC_rec, __pyx_t_3); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 855, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_v_ks_picked = __pyx_t_6;
    __pyx_t_6 = 0;

    /* "vapor_vali/Simple_function.pyx":856
 *         #ks_picked=ks[BIC.index(max(BIC))]
 *         ks_picked=BIC_rec[BIC.index(max(BIC))]
 *         if ks_picked==1:             # <<<<<<<<<<<<<<
 *             return [data_list]
 *         else:
 */
    __pyx_t_6 = __Pyx_PyInt_EqObjC(__pyx_v_ks_picked, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 856, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __pyx_t_1 = __Pyx_PyObject_IsTrue(__pyx_t_6); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(0, 856, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    if (__pyx_t_1) {

      /* "vapor_vali/Simple_function.pyx":857
 *         ks_picked=BIC_rec[BIC.index(max(BIC))]
 *         if ks_picked==1:
 *             return [data_list]             # <<<<<<<<<<<<<<
 *         else:
 *             out=[]
 */
      __Pyx_XDECREF(__pyx_r);
      __pyx_t_6 = PyList_New(1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 857, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_6);
      __Pyx_INCREF(__pyx_v_data_list);
      __Pyx_GIVEREF(__pyx_v_data_list);
      PyList_SET_ITEM(__pyx_t_6, 0, __pyx_v_data_list);
      __pyx_r = __pyx_t_6;
      __pyx_t_6 = 0;
      goto __pyx_L0;

      /* "vapor_vali/Simple_function.pyx":856
 *         #ks_picked=ks[BIC.index(max(BIC))]
 *         ks_picked=BIC_rec[BIC.index(max(BIC))]
 *         if ks_picked==1:             # <<<<<<<<<<<<<<
 *             return [data_list]
 *         else:
 */
    }

    /* "vapor_vali/Simple_function.pyx":859
 *             return [data_list]
 *         else:
 *             out=[]             # <<<<<<<<<<<<<<
 *             std_rec=[scipy.std(data_list[0]),scipy.std(data_list[1])]
 *             whitened = whiten(array_diagnal)
 */
    /*else*/ {
      __pyx_t_6 = PyList_New(0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 859, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_6);
      __pyx_v_out = ((PyObject*)__pyx_t_6);
      __pyx_t_6 = 0;

      /* "vapor_vali/Simple_function.pyx":860
 *         else:
 *             out=[]
 *             std_rec=[scipy.std(data_list[0]),scipy.std(data_list[1])]             # <<<<<<<<<<<<<<
 *             whitened = whiten(array_diagnal)
 *             centroids, distortion=kmeans(whitened,ks_picked)
 */
      __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_scipy); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 860, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_std); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 860, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_8);
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_data_list, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 860, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __pyx_t_11 = NULL;
      if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_8))) {
        __pyx_t_11 = PyMethod_GET_SELF(__pyx_t_8);
        if (likely(__pyx_t_11)) {
          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_8);
          __Pyx_INCREF(__pyx_t_11);
          __Pyx_INCREF(function);
          __Pyx_DECREF_SET(__pyx_t_8, function);
        }
      }
      if (!__pyx_t_11) {
        __pyx_t_6 = __Pyx_PyObject_CallOneArg(__pyx_t_8, __pyx_t_3); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 860, __pyx_L1_error)
        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
        __Pyx_GOTREF(__pyx_t_6);
      } else {
        __pyx_t_2 = PyTuple_New(1+1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 860, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
        __Pyx_GIVEREF(__pyx_t_11); PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_11); __pyx_t_11 = NULL;
        __Pyx_GIVEREF(__pyx_t_3);
        PyTuple_SET_ITEM(__pyx_t_2, 0+1, __pyx_t_3);
        __pyx_t_3 = 0;
        __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_8, __pyx_t_2, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 860, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_6);
        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      }
      __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
      __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_scipy); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 860, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_std); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 860, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_data_list, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 860, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __pyx_t_11 = NULL;
      if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_3))) {
        __pyx_t_11 = PyMethod_GET_SELF(__pyx_t_3);
        if (likely(__pyx_t_11)) {
          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
          __Pyx_INCREF(__pyx_t_11);
          __Pyx_INCREF(function);
          __Pyx_DECREF_SET(__pyx_t_3, function);
        }
      }
      if (!__pyx_t_11) {
        __pyx_t_8 = __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_2); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 860, __pyx_L1_error)
        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
        __Pyx_GOTREF(__pyx_t_8);
      } else {
        __pyx_t_4 = PyTuple_New(1+1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 860, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_4);
        __Pyx_GIVEREF(__pyx_t_11); PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_11); __pyx_t_11 = NULL;
        __Pyx_GIVEREF(__pyx_t_2);
        PyTuple_SET_ITEM(__pyx_t_4, 0+1, __pyx_t_2);
        __pyx_t_2 = 0;
        __pyx_t_8 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_4, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 860, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_8);
        __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      }
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_3 = PyList_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 860, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __Pyx_GIVEREF(__pyx_t_6);
      PyList_SET_ITEM(__pyx_t_3, 0, __pyx_t_6);
      __Pyx_GIVEREF(__pyx_t_8);
      PyList_SET_ITEM(__pyx_t_3, 1, __pyx_t_8);
      __pyx_t_6 = 0;
      __pyx_t_8 = 0;
      __pyx_v_std_rec = ((PyObject*)__pyx_t_3);
      __pyx_t_3 = 0;

      /* "vapor_vali/Simple_function.pyx":861
 *             out=[]
 *             std_rec=[scipy.std(data_list[0]),scipy.std(data_list[1])]
 *             whitened = whiten(array_diagnal)             # <<<<<<<<<<<<<<
 *             centroids, distortion=kmeans(whitened,ks_picked)
 *             idx,_= vq(whitened,centroids)
 */
      __pyx_t_8 = __Pyx_GetModuleGlobalName(__pyx_n_s_whiten); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 861, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_8);
      __pyx_t_6 = NULL;
      if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_8))) {
        __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_8);
        if (likely(__pyx_t_6)) {
          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_8);
          __Pyx_INCREF(__pyx_t_6);
          __Pyx_INCREF(function);
          __Pyx_DECREF_SET(__pyx_t_8, function);
        }
      }
      if (!__pyx_t_6) {
        __pyx_t_3 = __Pyx_PyObject_CallOneArg(__pyx_t_8, __pyx_v_array_diagnal); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 861, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_3);
      } else {
        __pyx_t_4 = PyTuple_New(1+1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 861, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_4);
        __Pyx_GIVEREF(__pyx_t_6); PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_6); __pyx_t_6 = NULL;
        __Pyx_INCREF(__pyx_v_array_diagnal);
        __Pyx_GIVEREF(__pyx_v_array_diagnal);
        PyTuple_SET_ITEM(__pyx_t_4, 0+1, __pyx_v_array_diagnal);
        __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_8, __pyx_t_4, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 861, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_3);
        __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      }
      __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
      __pyx_v_whitened = __pyx_t_3;
      __pyx_t_3 = 0;

      /* "vapor_vali/Simple_function.pyx":862
 *             std_rec=[scipy.std(data_list[0]),scipy.std(data_list[1])]
 *             whitened = whiten(array_diagnal)
 *             centroids, distortion=kmeans(whitened,ks_picked)             # <<<<<<<<<<<<<<
 *             idx,_= vq(whitened,centroids)
 *             for x in range(ks_picked):
 */
      __pyx_t_8 = __Pyx_GetModuleGlobalName(__pyx_n_s_kmeans); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 862, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_8);
      __pyx_t_4 = NULL;
      __pyx_t_7 = 0;
      if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_8))) {
        __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_8);
        if (likely(__pyx_t_4)) {
          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_8);
          __Pyx_INCREF(__pyx_t_4);
          __Pyx_INCREF(function);
          __Pyx_DECREF_SET(__pyx_t_8, function);
          __pyx_t_7 = 1;
        }
      }
      __pyx_t_6 = PyTuple_New(2+__pyx_t_7); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 862, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_6);
      if (__pyx_t_4) {
        __Pyx_GIVEREF(__pyx_t_4); PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_4); __pyx_t_4 = NULL;
      }
      __Pyx_INCREF(__pyx_v_whitened);
      __Pyx_GIVEREF(__pyx_v_whitened);
      PyTuple_SET_ITEM(__pyx_t_6, 0+__pyx_t_7, __pyx_v_whitened);
      __Pyx_INCREF(__pyx_v_ks_picked);
      __Pyx_GIVEREF(__pyx_v_ks_picked);
      PyTuple_SET_ITEM(__pyx_t_6, 1+__pyx_t_7, __pyx_v_ks_picked);
      __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_8, __pyx_t_6, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 862, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
      __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
      if ((likely(PyTuple_CheckExact(__pyx_t_3))) || (PyList_CheckExact(__pyx_t_3))) {
        PyObject* sequence = __pyx_t_3;
        #if CYTHON_COMPILING_IN_CPYTHON
        Py_ssize_t size = Py_SIZE(sequence);
        #else
        Py_ssize_t size = PySequence_Size(sequence);
        #endif
        if (unlikely(size != 2)) {
          if (size > 2) __Pyx_RaiseTooManyValuesError(2);
          else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
          __PYX_ERR(0, 862, __pyx_L1_error)
        }
        #if CYTHON_COMPILING_IN_CPYTHON
        if (likely(PyTuple_CheckExact(sequence))) {
          __pyx_t_8 = PyTuple_GET_ITEM(sequence, 0); 
          __pyx_t_6 = PyTuple_GET_ITEM(sequence, 1); 
        } else {
          __pyx_t_8 = PyList_GET_ITEM(sequence, 0); 
          __pyx_t_6 = PyList_GET_ITEM(sequence, 1); 
        }
        __Pyx_INCREF(__pyx_t_8);
        __Pyx_INCREF(__pyx_t_6);
        #else
        __pyx_t_8 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 862, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_8);
        __pyx_t_6 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 862, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_6);
        #endif
        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      } else {
        Py_ssize_t index = -1;
        __pyx_t_4 = PyObject_GetIter(__pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 862, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_4);
        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
        __pyx_t_15 = Py_TYPE(__pyx_t_4)->tp_iternext;
        index = 0; __pyx_t_8 = __pyx_t_15(__pyx_t_4); if (unlikely(!__pyx_t_8)) goto __pyx_L17_unpacking_failed;
        __Pyx_GOTREF(__pyx_t_8);
        index = 1; __pyx_t_6 = __pyx_t_15(__pyx_t_4); if (unlikely(!__pyx_t_6)) goto __pyx_L17_unpacking_failed;
        __Pyx_GOTREF(__pyx_t_6);
        if (__Pyx_IternextUnpackEndCheck(__pyx_t_15(__pyx_t_4), 2) < 0) __PYX_ERR(0, 862, __pyx_L1_error)
        __pyx_t_15 = NULL;
        __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
        goto __pyx_L18_unpacking_done;
        __pyx_L17_unpacking_failed:;
        __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
        __pyx_t_15 = NULL;
        if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
        __PYX_ERR(0, 862, __pyx_L1_error)
        __pyx_L18_unpacking_done:;
      }
      __pyx_v_centroids = __pyx_t_8;
      __pyx_t_8 = 0;
      __pyx_v_distortion = __pyx_t_6;
      __pyx_t_6 = 0;

      /* "vapor_vali/Simple_function.pyx":863
 *             whitened = whiten(array_diagnal)
 *             centroids, distortion=kmeans(whitened,ks_picked)
 *             idx,_= vq(whitened,centroids)             # <<<<<<<<<<<<<<
 *             for x in range(ks_picked):
 *                 group1=[[int(i) for i in array_diagnal[idx==x,0]],[int(i) for i in array_diagnal[idx==x,1]]]
 */
      __pyx_t_6 = __Pyx_GetModuleGlobalName(__pyx_n_s_vq); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 863, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_6);
      __pyx_t_8 = NULL;
      __pyx_t_7 = 0;
      if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_6))) {
        __pyx_t_8 = PyMethod_GET_SELF(__pyx_t_6);
        if (likely(__pyx_t_8)) {
          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
          __Pyx_INCREF(__pyx_t_8);
          __Pyx_INCREF(function);
          __Pyx_DECREF_SET(__pyx_t_6, function);
          __pyx_t_7 = 1;
        }
      }
      __pyx_t_4 = PyTuple_New(2+__pyx_t_7); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 863, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      if (__pyx_t_8) {
        __Pyx_GIVEREF(__pyx_t_8); PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_8); __pyx_t_8 = NULL;
      }
      __Pyx_INCREF(__pyx_v_whitened);
      __Pyx_GIVEREF(__pyx_v_whitened);
      PyTuple_SET_ITEM(__pyx_t_4, 0+__pyx_t_7, __pyx_v_whitened);
      __Pyx_INCREF(__pyx_v_centroids);
      __Pyx_GIVEREF(__pyx_v_centroids);
      PyTuple_SET_ITEM(__pyx_t_4, 1+__pyx_t_7, __pyx_v_centroids);
      __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_4, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 863, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
      if ((likely(PyTuple_CheckExact(__pyx_t_3))) || (PyList_CheckExact(__pyx_t_3))) {
        PyObject* sequence = __pyx_t_3;
        #if CYTHON_COMPILING_IN_CPYTHON
        Py_ssize_t size = Py_SIZE(sequence);
        #else
        Py_ssize_t size = PySequence_Size(sequence);
        #endif
        if (unlikely(size != 2)) {
          if (size > 2) __Pyx_RaiseTooManyValuesError(2);
          else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
          __PYX_ERR(0, 863, __pyx_L1_error)
        }
        #if CYTHON_COMPILING_IN_CPYTHON
        if (likely(PyTuple_CheckExact(sequence))) {
          __pyx_t_6 = PyTuple_GET_ITEM(sequence, 0); 
          __pyx_t_4 = PyTuple_GET_ITEM(sequence, 1); 
        } else {
          __pyx_t_6 = PyList_GET_ITEM(sequence, 0); 
          __pyx_t_4 = PyList_GET_ITEM(sequence, 1); 
        }
        __Pyx_INCREF(__pyx_t_6);
        __Pyx_INCREF(__pyx_t_4);
        #else
        __pyx_t_6 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 863, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_6);
        __pyx_t_4 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 863, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_4);
        #endif
        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      } else {
        Py_ssize_t index = -1;
        __pyx_t_8 = PyObject_GetIter(__pyx_t_3); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 863, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_8);
        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
        __pyx_t_15 = Py_TYPE(__pyx_t_8)->tp_iternext;
        index = 0; __pyx_t_6 = __pyx_t_15(__pyx_t_8); if (unlikely(!__pyx_t_6)) goto __pyx_L19_unpacking_failed;
        __Pyx_GOTREF(__pyx_t_6);
        index = 1; __pyx_t_4 = __pyx_t_15(__pyx_t_8); if (unlikely(!__pyx_t_4)) goto __pyx_L19_unpacking_failed;
        __Pyx_GOTREF(__pyx_t_4);
        if (__Pyx_IternextUnpackEndCheck(__pyx_t_15(__pyx_t_8), 2) < 0) __PYX_ERR(0, 863, __pyx_L1_error)
        __pyx_t_15 = NULL;
        __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
        goto __pyx_L20_unpacking_done;
        __pyx_L19_unpacking_failed:;
        __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
        __pyx_t_15 = NULL;
        if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
        __PYX_ERR(0, 863, __pyx_L1_error)
        __pyx_L20_unpacking_done:;
      }
      __pyx_v_idx = __pyx_t_6;
      __pyx_t_6 = 0;
      __pyx_v__ = __pyx_t_4;
      __pyx_t_4 = 0;

      /* "vapor_vali/Simple_function.pyx":864
 *             centroids, distortion=kmeans(whitened,ks_picked)
 *             idx,_= vq(whitened,centroids)
 *             for x in range(ks_picked):             # <<<<<<<<<<<<<<
 *                 group1=[[int(i) for i in array_diagnal[idx==x,0]],[int(i) for i in array_diagnal[idx==x,1]]]
 *                 out.append(group1)
 */
      __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 864, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __Pyx_INCREF(__pyx_v_ks_picked);
      __Pyx_GIVEREF(__pyx_v_ks_picked);
      PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_v_ks_picked);
      __pyx_t_4 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_t_3, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 864, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      if (likely(PyList_CheckExact(__pyx_t_4)) || PyTuple_CheckExact(__pyx_t_4)) {
        __pyx_t_3 = __pyx_t_4; __Pyx_INCREF(__pyx_t_3); __pyx_t_7 = 0;
        __pyx_t_9 = NULL;
      } else {
        __pyx_t_7 = -1; __pyx_t_3 = PyObject_GetIter(__pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 864, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_3);
        __pyx_t_9 = Py_TYPE(__pyx_t_3)->tp_iternext; if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 864, __pyx_L1_error)
      }
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      for (;;) {
        if (likely(!__pyx_t_9)) {
          if (likely(PyList_CheckExact(__pyx_t_3))) {
            if (__pyx_t_7 >= PyList_GET_SIZE(__pyx_t_3)) break;
            #if CYTHON_COMPILING_IN_CPYTHON
            __pyx_t_4 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_7); __Pyx_INCREF(__pyx_t_4); __pyx_t_7++; if (unlikely(0 < 0)) __PYX_ERR(0, 864, __pyx_L1_error)
            #else
            __pyx_t_4 = PySequence_ITEM(__pyx_t_3, __pyx_t_7); __pyx_t_7++; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 864, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_4);
            #endif
          } else {
            if (__pyx_t_7 >= PyTuple_GET_SIZE(__pyx_t_3)) break;
            #if CYTHON_COMPILING_IN_CPYTHON
            __pyx_t_4 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_7); __Pyx_INCREF(__pyx_t_4); __pyx_t_7++; if (unlikely(0 < 0)) __PYX_ERR(0, 864, __pyx_L1_error)
            #else
            __pyx_t_4 = PySequence_ITEM(__pyx_t_3, __pyx_t_7); __pyx_t_7++; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 864, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_4);
            #endif
          }
        } else {
          __pyx_t_4 = __pyx_t_9(__pyx_t_3);
          if (unlikely(!__pyx_t_4)) {
            PyObject* exc_type = PyErr_Occurred();
            if (exc_type) {
              if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
              else __PYX_ERR(0, 864, __pyx_L1_error)
            }
            break;
          }
          __Pyx_GOTREF(__pyx_t_4);
        }
        __Pyx_XDECREF_SET(__pyx_v_x, __pyx_t_4);
        __pyx_t_4 = 0;

        /* "vapor_vali/Simple_function.pyx":865
 *             idx,_= vq(whitened,centroids)
 *             for x in range(ks_picked):
 *                 group1=[[int(i) for i in array_diagnal[idx==x,0]],[int(i) for i in array_diagnal[idx==x,1]]]             # <<<<<<<<<<<<<<
 *                 out.append(group1)
 *             return out
 */
        __pyx_t_4 = PyList_New(0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 865, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_4);
        __pyx_t_6 = PyObject_RichCompare(__pyx_v_idx, __pyx_v_x, Py_EQ); __Pyx_XGOTREF(__pyx_t_6); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 865, __pyx_L1_error)
        __pyx_t_8 = PyTuple_New(2); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 865, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_8);
        __Pyx_GIVEREF(__pyx_t_6);
        PyTuple_SET_ITEM(__pyx_t_8, 0, __pyx_t_6);
        __Pyx_INCREF(__pyx_int_0);
        __Pyx_GIVEREF(__pyx_int_0);
        PyTuple_SET_ITEM(__pyx_t_8, 1, __pyx_int_0);
        __pyx_t_6 = 0;
        __pyx_t_6 = PyObject_GetItem(__pyx_v_array_diagnal, __pyx_t_8); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 865, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_6);
        __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
        if (likely(PyList_CheckExact(__pyx_t_6)) || PyTuple_CheckExact(__pyx_t_6)) {
          __pyx_t_8 = __pyx_t_6; __Pyx_INCREF(__pyx_t_8); __pyx_t_12 = 0;
          __pyx_t_16 = NULL;
        } else {
          __pyx_t_12 = -1; __pyx_t_8 = PyObject_GetIter(__pyx_t_6); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 865, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_8);
          __pyx_t_16 = Py_TYPE(__pyx_t_8)->tp_iternext; if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 865, __pyx_L1_error)
        }
        __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
        for (;;) {
          if (likely(!__pyx_t_16)) {
            if (likely(PyList_CheckExact(__pyx_t_8))) {
              if (__pyx_t_12 >= PyList_GET_SIZE(__pyx_t_8)) break;
              #if CYTHON_COMPILING_IN_CPYTHON
              __pyx_t_6 = PyList_GET_ITEM(__pyx_t_8, __pyx_t_12); __Pyx_INCREF(__pyx_t_6); __pyx_t_12++; if (unlikely(0 < 0)) __PYX_ERR(0, 865, __pyx_L1_error)
              #else
              __pyx_t_6 = PySequence_ITEM(__pyx_t_8, __pyx_t_12); __pyx_t_12++; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 865, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_6);
              #endif
            } else {
              if (__pyx_t_12 >= PyTuple_GET_SIZE(__pyx_t_8)) break;
              #if CYTHON_COMPILING_IN_CPYTHON
              __pyx_t_6 = PyTuple_GET_ITEM(__pyx_t_8, __pyx_t_12); __Pyx_INCREF(__pyx_t_6); __pyx_t_12++; if (unlikely(0 < 0)) __PYX_ERR(0, 865, __pyx_L1_error)
              #else
              __pyx_t_6 = PySequence_ITEM(__pyx_t_8, __pyx_t_12); __pyx_t_12++; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 865, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_6);
              #endif
            }
          } else {
            __pyx_t_6 = __pyx_t_16(__pyx_t_8);
            if (unlikely(!__pyx_t_6)) {
              PyObject* exc_type = PyErr_Occurred();
              if (exc_type) {
                if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
                else __PYX_ERR(0, 865, __pyx_L1_error)
              }
              break;
            }
            __Pyx_GOTREF(__pyx_t_6);
          }
          __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_6);
          __pyx_t_6 = 0;
          __pyx_t_6 = __Pyx_PyNumber_Int(__pyx_v_i); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 865, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_6);
          if (unlikely(__Pyx_ListComp_Append(__pyx_t_4, (PyObject*)__pyx_t_6))) __PYX_ERR(0, 865, __pyx_L1_error)
          __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
        }
        __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
        __pyx_t_8 = PyList_New(0); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 865, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_8);
        __pyx_t_6 = PyObject_RichCompare(__pyx_v_idx, __pyx_v_x, Py_EQ); __Pyx_XGOTREF(__pyx_t_6); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 865, __pyx_L1_error)
        __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 865, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
        __Pyx_GIVEREF(__pyx_t_6);
        PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_6);
        __Pyx_INCREF(__pyx_int_1);
        __Pyx_GIVEREF(__pyx_int_1);
        PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_int_1);
        __pyx_t_6 = 0;
        __pyx_t_6 = PyObject_GetItem(__pyx_v_array_diagnal, __pyx_t_2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 865, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_6);
        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
        if (likely(PyList_CheckExact(__pyx_t_6)) || PyTuple_CheckExact(__pyx_t_6)) {
          __pyx_t_2 = __pyx_t_6; __Pyx_INCREF(__pyx_t_2); __pyx_t_12 = 0;
          __pyx_t_16 = NULL;
        } else {
          __pyx_t_12 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_t_6); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 865, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_2);
          __pyx_t_16 = Py_TYPE(__pyx_t_2)->tp_iternext; if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 865, __pyx_L1_error)
        }
        __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
        for (;;) {
          if (likely(!__pyx_t_16)) {
            if (likely(PyList_CheckExact(__pyx_t_2))) {
              if (__pyx_t_12 >= PyList_GET_SIZE(__pyx_t_2)) break;
              #if CYTHON_COMPILING_IN_CPYTHON
              __pyx_t_6 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_12); __Pyx_INCREF(__pyx_t_6); __pyx_t_12++; if (unlikely(0 < 0)) __PYX_ERR(0, 865, __pyx_L1_error)
              #else
              __pyx_t_6 = PySequence_ITEM(__pyx_t_2, __pyx_t_12); __pyx_t_12++; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 865, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_6);
              #endif
            } else {
              if (__pyx_t_12 >= PyTuple_GET_SIZE(__pyx_t_2)) break;
              #if CYTHON_COMPILING_IN_CPYTHON
              __pyx_t_6 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_12); __Pyx_INCREF(__pyx_t_6); __pyx_t_12++; if (unlikely(0 < 0)) __PYX_ERR(0, 865, __pyx_L1_error)
              #else
              __pyx_t_6 = PySequence_ITEM(__pyx_t_2, __pyx_t_12); __pyx_t_12++; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 865, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_6);
              #endif
            }
          } else {
            __pyx_t_6 = __pyx_t_16(__pyx_t_2);
            if (unlikely(!__pyx_t_6)) {
              PyObject* exc_type = PyErr_Occurred();
              if (exc_type) {
                if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
                else __PYX_ERR(0, 865, __pyx_L1_error)
              }
              break;
            }
            __Pyx_GOTREF(__pyx_t_6);
          }
          __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_6);
          __pyx_t_6 = 0;
          __pyx_t_6 = __Pyx_PyNumber_Int(__pyx_v_i); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 865, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_6);
          if (unlikely(__Pyx_ListComp_Append(__pyx_t_8, (PyObject*)__pyx_t_6))) __PYX_ERR(0, 865, __pyx_L1_error)
          __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
        }
        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
        __pyx_t_2 = PyList_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 865, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
        __Pyx_GIVEREF(__pyx_t_4);
        PyList_SET_ITEM(__pyx_t_2, 0, __pyx_t_4);
        __Pyx_GIVEREF(__pyx_t_8);
        PyList_SET_ITEM(__pyx_t_2, 1, __pyx_t_8);
        __pyx_t_4 = 0;
        __pyx_t_8 = 0;
        __Pyx_XDECREF_SET(__pyx_v_group1, ((PyObject*)__pyx_t_2));
        __pyx_t_2 = 0;

        /* "vapor_vali/Simple_function.pyx":866
 *             for x in range(ks_picked):
 *                 group1=[[int(i) for i in array_diagnal[idx==x,0]],[int(i) for i in array_diagnal[idx==x,1]]]
 *                 out.append(group1)             # <<<<<<<<<<<<<<
 *             return out
 *     else:
 */
        __pyx_t_14 = __Pyx_PyList_Append(__pyx_v_out, __pyx_v_group1); if (unlikely(__pyx_t_14 == -1)) __PYX_ERR(0, 866, __pyx_L1_error)

        /* "vapor_vali/Simple_function.pyx":864
 *             centroids, distortion=kmeans(whitened,ks_picked)
 *             idx,_= vq(whitened,centroids)
 *             for x in range(ks_picked):             # <<<<<<<<<<<<<<
 *                 group1=[[int(i) for i in array_diagnal[idx==x,0]],[int(i) for i in array_diagnal[idx==x,1]]]
 *                 out.append(group1)
 */
      }
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;

      /* "vapor_vali/Simple_function.pyx":867
 *                 group1=[[int(i) for i in array_diagnal[idx==x,0]],[int(i) for i in array_diagnal[idx==x,1]]]
 *                 out.append(group1)
 *             return out             # <<<<<<<<<<<<<<
 *     else:
 *         return [data_list]
 */
      __Pyx_XDECREF(__pyx_r);
      __Pyx_INCREF(__pyx_v_out);
      __pyx_r = __pyx_v_out;
      goto __pyx_L0;
    }

    /* "vapor_vali/Simple_function.pyx":839
 * 
 * def k_means_cluster(data_list):
 *     if max(data_list[0])-min(data_list[0])>10 and max(data_list[1])-min(data_list[1])>10:             # <<<<<<<<<<<<<<
 *         array_diagnal=np.array([[data_list[0][x],data_list[1][x]] for x in range(len(data_list[0]))])
 *         ks = list(range(1,min([5,len(data_list[0])+1])))
 */
  }

  /* "vapor_vali/Simple_function.pyx":869
 *             return out
 *     else:
 *         return [data_list]             # <<<<<<<<<<<<<<
 * 
 * def k_means_cluster_Predict(data_list,info):
 */
  /*else*/ {
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_3 = PyList_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 869, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_INCREF(__pyx_v_data_list);
    __Pyx_GIVEREF(__pyx_v_data_list);
    PyList_SET_ITEM(__pyx_t_3, 0, __pyx_v_data_list);
    __pyx_r = __pyx_t_3;
    __pyx_t_3 = 0;
    goto __pyx_L0;
  }

  /* "vapor_vali/Simple_function.pyx":838
 *     else:                                                                                       return 'FALSE'
 * 
 * def k_means_cluster(data_list):             # <<<<<<<<<<<<<<
 *     if max(data_list[0])-min(data_list[0])>10 and max(data_list[1])-min(data_list[1])>10:
 *         array_diagnal=np.array([[data_list[0][x],data_list[1][x]] for x in range(len(data_list[0]))])
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_XDECREF(__pyx_t_8);
  __Pyx_XDECREF(__pyx_t_10);
  __Pyx_XDECREF(__pyx_t_11);
  __Pyx_AddTraceback("vapor_vali.Simple_function.k_means_cluster", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_array_diagnal);
  __Pyx_XDECREF(__pyx_v_ks);
  __Pyx_XDECREF(__pyx_v_KMeans);
  __Pyx_XDECREF(__pyx_v_KMeans_predict);
  __Pyx_XDECREF(__pyx_v_BIC);
  __Pyx_XDECREF(__pyx_v_BIC_rec);
  __Pyx_XDECREF(__pyx_v_x);
  __Pyx_XDECREF(__pyx_v_BIC_i);
  __Pyx_XDECREF(__pyx_v_ks_picked);
  __Pyx_XDECREF(__pyx_v_out);
  __Pyx_XDECREF(__pyx_v_std_rec);
  __Pyx_XDECREF(__pyx_v_whitened);
  __Pyx_XDECREF(__pyx_v_centroids);
  __Pyx_XDECREF(__pyx_v_distortion);
  __Pyx_XDECREF(__pyx_v_idx);
  __Pyx_XDECREF(__pyx_v__);
  __Pyx_XDECREF(__pyx_v_group1);
  __Pyx_XDECREF(__pyx_v_i);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "vapor_vali/Simple_function.pyx":871
 *         return [data_list]
 * 
 * def k_means_cluster_Predict(data_list,info):             # <<<<<<<<<<<<<<
 *     array_diagnal=np.array([[data_list[0][x],data_list[1][x]] for x in range(len(data_list[0]))])
 *     ks = list(range(1,len(info)))
 */

/* Python wrapper */
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_123k_means_cluster_Predict(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_10vapor_vali_15Simple_function_123k_means_cluster_Predict = {"k_means_cluster_Predict", (PyCFunction)__pyx_pw_10vapor_vali_15Simple_function_123k_means_cluster_Predict, METH_VARARGS|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_123k_means_cluster_Predict(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_data_list = 0;
  PyObject *__pyx_v_info = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("k_means_cluster_Predict (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_data_list,&__pyx_n_s_info,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_data_list)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_info)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("k_means_cluster_Predict", 1, 2, 2, 1); __PYX_ERR(0, 871, __pyx_L3_error)
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "k_means_cluster_Predict") < 0)) __PYX_ERR(0, 871, __pyx_L3_error)
      }
    } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
    }
    __pyx_v_data_list = values[0];
    __pyx_v_info = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("k_means_cluster_Predict", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 871, __pyx_L3_error)
  __pyx_L3_error:;
  __Pyx_AddTraceback("vapor_vali.Simple_function.k_means_cluster_Predict", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_10vapor_vali_15Simple_function_122k_means_cluster_Predict(__pyx_self, __pyx_v_data_list, __pyx_v_info);

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10vapor_vali_15Simple_function_122k_means_cluster_Predict(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_data_list, PyObject *__pyx_v_info) {
  PyObject *__pyx_v_array_diagnal = NULL;
  PyObject *__pyx_v_ks = NULL;
  PyObject *__pyx_v_KMeans = NULL;
  PyObject *__pyx_v_BIC = NULL;
  PyObject *__pyx_v_ks_picked = NULL;
  PyObject *__pyx_v_out = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_std_rec = NULL;
  PyObject *__pyx_v_whitened = NULL;
  PyObject *__pyx_v_centroids = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_distortion = NULL;
  PyObject *__pyx_v_idx = NULL;
  CYTHON_UNUSED PyObject *__pyx_v__ = NULL;
  PyObject *__pyx_v_x = NULL;
  PyObject *__pyx_v_group1 = NULL;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_v_kmeansi = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  Py_ssize_t __pyx_t_5;
  PyObject *__pyx_t_6 = NULL;
  PyObject *(*__pyx_t_7)(PyObject *);
  PyObject *__pyx_t_8 = NULL;
  PyObject *__pyx_t_9 = NULL;
  Py_ssize_t __pyx_t_10;
  int __pyx_t_11;
  PyObject *(*__pyx_t_12)(PyObject *);
  PyObject *(*__pyx_t_13)(PyObject *);
  int __pyx_t_14;
  __Pyx_RefNannySetupContext("k_means_cluster_Predict", 0);

  /* "vapor_vali/Simple_function.pyx":872
 * 
 * def k_means_cluster_Predict(data_list,info):
 *     array_diagnal=np.array([[data_list[0][x],data_list[1][x]] for x in range(len(data_list[0]))])             # <<<<<<<<<<<<<<
 *     ks = list(range(1,len(info)))
 *     KMeans = [cluster.KMeans(n_clusters = i, init="k-means++").fit(array_diagnal) for i in ks]
 */
  __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 872, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_array); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 872, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = PyList_New(0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 872, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_4 = __Pyx_GetItemInt(__pyx_v_data_list, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 872, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_5 = PyObject_Length(__pyx_t_4); if (unlikely(__pyx_t_5 == -1)) __PYX_ERR(0, 872, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = PyInt_FromSsize_t(__pyx_t_5); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 872, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_6 = PyTuple_New(1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 872, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_GIVEREF(__pyx_t_4);
  PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_t_6, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 872, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  if (likely(PyList_CheckExact(__pyx_t_4)) || PyTuple_CheckExact(__pyx_t_4)) {
    __pyx_t_6 = __pyx_t_4; __Pyx_INCREF(__pyx_t_6); __pyx_t_5 = 0;
    __pyx_t_7 = NULL;
  } else {
    __pyx_t_5 = -1; __pyx_t_6 = PyObject_GetIter(__pyx_t_4); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 872, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __pyx_t_7 = Py_TYPE(__pyx_t_6)->tp_iternext; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 872, __pyx_L1_error)
  }
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  for (;;) {
    if (likely(!__pyx_t_7)) {
      if (likely(PyList_CheckExact(__pyx_t_6))) {
        if (__pyx_t_5 >= PyList_GET_SIZE(__pyx_t_6)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_4 = PyList_GET_ITEM(__pyx_t_6, __pyx_t_5); __Pyx_INCREF(__pyx_t_4); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 872, __pyx_L1_error)
        #else
        __pyx_t_4 = PySequence_ITEM(__pyx_t_6, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 872, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_4);
        #endif
      } else {
        if (__pyx_t_5 >= PyTuple_GET_SIZE(__pyx_t_6)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_4 = PyTuple_GET_ITEM(__pyx_t_6, __pyx_t_5); __Pyx_INCREF(__pyx_t_4); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 872, __pyx_L1_error)
        #else
        __pyx_t_4 = PySequence_ITEM(__pyx_t_6, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 872, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_4);
        #endif
      }
    } else {
      __pyx_t_4 = __pyx_t_7(__pyx_t_6);
      if (unlikely(!__pyx_t_4)) {
        PyObject* exc_type = PyErr_Occurred();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
          else __PYX_ERR(0, 872, __pyx_L1_error)
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_4);
    }
    __Pyx_XDECREF_SET(__pyx_v_x, __pyx_t_4);
    __pyx_t_4 = 0;
    __pyx_t_4 = __Pyx_GetItemInt(__pyx_v_data_list, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 872, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_8 = PyObject_GetItem(__pyx_t_4, __pyx_v_x); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 872, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_8);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = __Pyx_GetItemInt(__pyx_v_data_list, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 872, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_9 = PyObject_GetItem(__pyx_t_4, __pyx_v_x); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 872, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_9);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = PyList_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 872, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_GIVEREF(__pyx_t_8);
    PyList_SET_ITEM(__pyx_t_4, 0, __pyx_t_8);
    __Pyx_GIVEREF(__pyx_t_9);
    PyList_SET_ITEM(__pyx_t_4, 1, __pyx_t_9);
    __pyx_t_8 = 0;
    __pyx_t_9 = 0;
    if (unlikely(__Pyx_ListComp_Append(__pyx_t_2, (PyObject*)__pyx_t_4))) __PYX_ERR(0, 872, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  }
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_3))) {
    __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_3);
    if (likely(__pyx_t_6)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
      __Pyx_INCREF(__pyx_t_6);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_3, function);
    }
  }
  if (!__pyx_t_6) {
    __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 872, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __Pyx_GOTREF(__pyx_t_1);
  } else {
    __pyx_t_4 = PyTuple_New(1+1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 872, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_GIVEREF(__pyx_t_6); PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_6); __pyx_t_6 = NULL;
    __Pyx_GIVEREF(__pyx_t_2);
    PyTuple_SET_ITEM(__pyx_t_4, 0+1, __pyx_t_2);
    __pyx_t_2 = 0;
    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_4, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 872, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  }
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_array_diagnal = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":873
 * def k_means_cluster_Predict(data_list,info):
 *     array_diagnal=np.array([[data_list[0][x],data_list[1][x]] for x in range(len(data_list[0]))])
 *     ks = list(range(1,len(info)))             # <<<<<<<<<<<<<<
 *     KMeans = [cluster.KMeans(n_clusters = i, init="k-means++").fit(array_diagnal) for i in ks]
 *     BIC = [compute_bic(kmeansi,array_diagnal) for kmeansi in KMeans]
 */
  __pyx_t_5 = PyObject_Length(__pyx_v_info); if (unlikely(__pyx_t_5 == -1)) __PYX_ERR(0, 873, __pyx_L1_error)
  __pyx_t_1 = PyInt_FromSsize_t(__pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 873, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 873, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_INCREF(__pyx_int_1);
  __Pyx_GIVEREF(__pyx_int_1);
  PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_int_1);
  __Pyx_GIVEREF(__pyx_t_1);
  PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_t_3, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 873, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = PySequence_List(__pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 873, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_ks = ((PyObject*)__pyx_t_3);
  __pyx_t_3 = 0;

  /* "vapor_vali/Simple_function.pyx":874
 *     array_diagnal=np.array([[data_list[0][x],data_list[1][x]] for x in range(len(data_list[0]))])
 *     ks = list(range(1,len(info)))
 *     KMeans = [cluster.KMeans(n_clusters = i, init="k-means++").fit(array_diagnal) for i in ks]             # <<<<<<<<<<<<<<
 *     BIC = [compute_bic(kmeansi,array_diagnal) for kmeansi in KMeans]
 *     ks_picked=ks[BIC.index(max(BIC))]
 */
  __pyx_t_3 = PyList_New(0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 874, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_1 = __pyx_v_ks; __Pyx_INCREF(__pyx_t_1); __pyx_t_5 = 0;
  for (;;) {
    if (__pyx_t_5 >= PyList_GET_SIZE(__pyx_t_1)) break;
    #if CYTHON_COMPILING_IN_CPYTHON
    __pyx_t_4 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_5); __Pyx_INCREF(__pyx_t_4); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 874, __pyx_L1_error)
    #else
    __pyx_t_4 = PySequence_ITEM(__pyx_t_1, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 874, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    #endif
    __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_4);
    __pyx_t_4 = 0;
    __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_cluster); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 874, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_KMeans); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 874, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = PyDict_New(); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 874, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_n_clusters, __pyx_v_i) < 0) __PYX_ERR(0, 874, __pyx_L1_error)
    if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_init, __pyx_kp_s_k_means) < 0) __PYX_ERR(0, 874, __pyx_L1_error)
    __pyx_t_9 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_empty_tuple, __pyx_t_2); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 874, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_9);
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_9, __pyx_n_s_fit); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 874, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_t_9 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_2))) {
      __pyx_t_9 = PyMethod_GET_SELF(__pyx_t_2);
      if (likely(__pyx_t_9)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
        __Pyx_INCREF(__pyx_t_9);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_2, function);
      }
    }
    if (!__pyx_t_9) {
      __pyx_t_4 = __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_v_array_diagnal); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 874, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
    } else {
      __pyx_t_6 = PyTuple_New(1+1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 874, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_6);
      __Pyx_GIVEREF(__pyx_t_9); PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_9); __pyx_t_9 = NULL;
      __Pyx_INCREF(__pyx_v_array_diagnal);
      __Pyx_GIVEREF(__pyx_v_array_diagnal);
      PyTuple_SET_ITEM(__pyx_t_6, 0+1, __pyx_v_array_diagnal);
      __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_6, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 874, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    }
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    if (unlikely(__Pyx_ListComp_Append(__pyx_t_3, (PyObject*)__pyx_t_4))) __PYX_ERR(0, 874, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  }
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_KMeans = ((PyObject*)__pyx_t_3);
  __pyx_t_3 = 0;

  /* "vapor_vali/Simple_function.pyx":875
 *     ks = list(range(1,len(info)))
 *     KMeans = [cluster.KMeans(n_clusters = i, init="k-means++").fit(array_diagnal) for i in ks]
 *     BIC = [compute_bic(kmeansi,array_diagnal) for kmeansi in KMeans]             # <<<<<<<<<<<<<<
 *     ks_picked=ks[BIC.index(max(BIC))]
 *     if ks_picked==1:
 */
  __pyx_t_3 = PyList_New(0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 875, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_1 = __pyx_v_KMeans; __Pyx_INCREF(__pyx_t_1); __pyx_t_5 = 0;
  for (;;) {
    if (__pyx_t_5 >= PyList_GET_SIZE(__pyx_t_1)) break;
    #if CYTHON_COMPILING_IN_CPYTHON
    __pyx_t_4 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_5); __Pyx_INCREF(__pyx_t_4); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 875, __pyx_L1_error)
    #else
    __pyx_t_4 = PySequence_ITEM(__pyx_t_1, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 875, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    #endif
    __Pyx_XDECREF_SET(__pyx_v_kmeansi, __pyx_t_4);
    __pyx_t_4 = 0;
    __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_compute_bic); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 875, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_6 = NULL;
    __pyx_t_10 = 0;
    if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_2))) {
      __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_2);
      if (likely(__pyx_t_6)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
        __Pyx_INCREF(__pyx_t_6);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_2, function);
        __pyx_t_10 = 1;
      }
    }
    __pyx_t_9 = PyTuple_New(2+__pyx_t_10); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 875, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_9);
    if (__pyx_t_6) {
      __Pyx_GIVEREF(__pyx_t_6); PyTuple_SET_ITEM(__pyx_t_9, 0, __pyx_t_6); __pyx_t_6 = NULL;
    }
    __Pyx_INCREF(__pyx_v_kmeansi);
    __Pyx_GIVEREF(__pyx_v_kmeansi);
    PyTuple_SET_ITEM(__pyx_t_9, 0+__pyx_t_10, __pyx_v_kmeansi);
    __Pyx_INCREF(__pyx_v_array_diagnal);
    __Pyx_GIVEREF(__pyx_v_array_diagnal);
    PyTuple_SET_ITEM(__pyx_t_9, 1+__pyx_t_10, __pyx_v_array_diagnal);
    __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_9, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 875, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    if (unlikely(__Pyx_ListComp_Append(__pyx_t_3, (PyObject*)__pyx_t_4))) __PYX_ERR(0, 875, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  }
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_BIC = ((PyObject*)__pyx_t_3);
  __pyx_t_3 = 0;

  /* "vapor_vali/Simple_function.pyx":876
 *     KMeans = [cluster.KMeans(n_clusters = i, init="k-means++").fit(array_diagnal) for i in ks]
 *     BIC = [compute_bic(kmeansi,array_diagnal) for kmeansi in KMeans]
 *     ks_picked=ks[BIC.index(max(BIC))]             # <<<<<<<<<<<<<<
 *     if ks_picked==1:
 *         return [data_list]
 */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_BIC, __pyx_n_s_index); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 876, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 876, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_INCREF(__pyx_v_BIC);
  __Pyx_GIVEREF(__pyx_v_BIC);
  PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_v_BIC);
  __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_max, __pyx_t_4, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 876, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_1))) {
    __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_1);
    if (likely(__pyx_t_4)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
      __Pyx_INCREF(__pyx_t_4);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_1, function);
    }
  }
  if (!__pyx_t_4) {
    __pyx_t_3 = __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 876, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __Pyx_GOTREF(__pyx_t_3);
  } else {
    __pyx_t_9 = PyTuple_New(1+1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 876, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_9);
    __Pyx_GIVEREF(__pyx_t_4); PyTuple_SET_ITEM(__pyx_t_9, 0, __pyx_t_4); __pyx_t_4 = NULL;
    __Pyx_GIVEREF(__pyx_t_2);
    PyTuple_SET_ITEM(__pyx_t_9, 0+1, __pyx_t_2);
    __pyx_t_2 = 0;
    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_9, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 876, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
  }
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = PyObject_GetItem(__pyx_v_ks, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 876, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_ks_picked = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":877
 *     BIC = [compute_bic(kmeansi,array_diagnal) for kmeansi in KMeans]
 *     ks_picked=ks[BIC.index(max(BIC))]
 *     if ks_picked==1:             # <<<<<<<<<<<<<<
 *         return [data_list]
 *     else:
 */
  __pyx_t_1 = __Pyx_PyInt_EqObjC(__pyx_v_ks_picked, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 877, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_11 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_11 < 0)) __PYX_ERR(0, 877, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  if (__pyx_t_11) {

    /* "vapor_vali/Simple_function.pyx":878
 *     ks_picked=ks[BIC.index(max(BIC))]
 *     if ks_picked==1:
 *         return [data_list]             # <<<<<<<<<<<<<<
 *     else:
 *         out=[]
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = PyList_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 878, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_INCREF(__pyx_v_data_list);
    __Pyx_GIVEREF(__pyx_v_data_list);
    PyList_SET_ITEM(__pyx_t_1, 0, __pyx_v_data_list);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "vapor_vali/Simple_function.pyx":877
 *     BIC = [compute_bic(kmeansi,array_diagnal) for kmeansi in KMeans]
 *     ks_picked=ks[BIC.index(max(BIC))]
 *     if ks_picked==1:             # <<<<<<<<<<<<<<
 *         return [data_list]
 *     else:
 */
  }

  /* "vapor_vali/Simple_function.pyx":880
 *         return [data_list]
 *     else:
 *         out=[]             # <<<<<<<<<<<<<<
 *         std_rec=[scipy.std(data_list[0]),scipy.std(data_list[1])]
 *         whitened = whiten(array_diagnal)
 */
  /*else*/ {
    __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 880, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_out = ((PyObject*)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "vapor_vali/Simple_function.pyx":881
 *     else:
 *         out=[]
 *         std_rec=[scipy.std(data_list[0]),scipy.std(data_list[1])]             # <<<<<<<<<<<<<<
 *         whitened = whiten(array_diagnal)
 *         centroids, distortion=kmeans(whitened,ks_picked)
 */
    __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_scipy); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 881, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_std); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 881, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_9);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_data_list, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 881, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_2 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_9))) {
      __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_9);
      if (likely(__pyx_t_2)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_9);
        __Pyx_INCREF(__pyx_t_2);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_9, function);
      }
    }
    if (!__pyx_t_2) {
      __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_9, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 881, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      __Pyx_GOTREF(__pyx_t_1);
    } else {
      __pyx_t_4 = PyTuple_New(1+1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 881, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      __Pyx_GIVEREF(__pyx_t_2); PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_2); __pyx_t_2 = NULL;
      __Pyx_GIVEREF(__pyx_t_3);
      PyTuple_SET_ITEM(__pyx_t_4, 0+1, __pyx_t_3);
      __pyx_t_3 = 0;
      __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_9, __pyx_t_4, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 881, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    }
    __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_t_4 = __Pyx_GetModuleGlobalName(__pyx_n_s_scipy); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 881, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_std); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 881, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = __Pyx_GetItemInt(__pyx_v_data_list, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 881, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_2 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_3))) {
      __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_3);
      if (likely(__pyx_t_2)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
        __Pyx_INCREF(__pyx_t_2);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_3, function);
      }
    }
    if (!__pyx_t_2) {
      __pyx_t_9 = __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_4); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 881, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      __Pyx_GOTREF(__pyx_t_9);
    } else {
      __pyx_t_6 = PyTuple_New(1+1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 881, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_6);
      __Pyx_GIVEREF(__pyx_t_2); PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_2); __pyx_t_2 = NULL;
      __Pyx_GIVEREF(__pyx_t_4);
      PyTuple_SET_ITEM(__pyx_t_6, 0+1, __pyx_t_4);
      __pyx_t_4 = 0;
      __pyx_t_9 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_6, NULL); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 881, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_9);
      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    }
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = PyList_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 881, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_GIVEREF(__pyx_t_1);
    PyList_SET_ITEM(__pyx_t_3, 0, __pyx_t_1);
    __Pyx_GIVEREF(__pyx_t_9);
    PyList_SET_ITEM(__pyx_t_3, 1, __pyx_t_9);
    __pyx_t_1 = 0;
    __pyx_t_9 = 0;
    __pyx_v_std_rec = ((PyObject*)__pyx_t_3);
    __pyx_t_3 = 0;

    /* "vapor_vali/Simple_function.pyx":882
 *         out=[]
 *         std_rec=[scipy.std(data_list[0]),scipy.std(data_list[1])]
 *         whitened = whiten(array_diagnal)             # <<<<<<<<<<<<<<
 *         centroids, distortion=kmeans(whitened,ks_picked)
 *         idx,_= vq(whitened,centroids)
 */
    __pyx_t_9 = __Pyx_GetModuleGlobalName(__pyx_n_s_whiten); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 882, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_9);
    __pyx_t_1 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_9))) {
      __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_9);
      if (likely(__pyx_t_1)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_9);
        __Pyx_INCREF(__pyx_t_1);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_9, function);
      }
    }
    if (!__pyx_t_1) {
      __pyx_t_3 = __Pyx_PyObject_CallOneArg(__pyx_t_9, __pyx_v_array_diagnal); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 882, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
    } else {
      __pyx_t_6 = PyTuple_New(1+1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 882, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_6);
      __Pyx_GIVEREF(__pyx_t_1); PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_1); __pyx_t_1 = NULL;
      __Pyx_INCREF(__pyx_v_array_diagnal);
      __Pyx_GIVEREF(__pyx_v_array_diagnal);
      PyTuple_SET_ITEM(__pyx_t_6, 0+1, __pyx_v_array_diagnal);
      __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_9, __pyx_t_6, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 882, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    }
    __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_v_whitened = __pyx_t_3;
    __pyx_t_3 = 0;

    /* "vapor_vali/Simple_function.pyx":883
 *         std_rec=[scipy.std(data_list[0]),scipy.std(data_list[1])]
 *         whitened = whiten(array_diagnal)
 *         centroids, distortion=kmeans(whitened,ks_picked)             # <<<<<<<<<<<<<<
 *         idx,_= vq(whitened,centroids)
 *         for x in range(ks_picked):
 */
    __pyx_t_9 = __Pyx_GetModuleGlobalName(__pyx_n_s_kmeans); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 883, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_9);
    __pyx_t_6 = NULL;
    __pyx_t_5 = 0;
    if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_9))) {
      __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_9);
      if (likely(__pyx_t_6)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_9);
        __Pyx_INCREF(__pyx_t_6);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_9, function);
        __pyx_t_5 = 1;
      }
    }
    __pyx_t_1 = PyTuple_New(2+__pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 883, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    if (__pyx_t_6) {
      __Pyx_GIVEREF(__pyx_t_6); PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_6); __pyx_t_6 = NULL;
    }
    __Pyx_INCREF(__pyx_v_whitened);
    __Pyx_GIVEREF(__pyx_v_whitened);
    PyTuple_SET_ITEM(__pyx_t_1, 0+__pyx_t_5, __pyx_v_whitened);
    __Pyx_INCREF(__pyx_v_ks_picked);
    __Pyx_GIVEREF(__pyx_v_ks_picked);
    PyTuple_SET_ITEM(__pyx_t_1, 1+__pyx_t_5, __pyx_v_ks_picked);
    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_9, __pyx_t_1, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 883, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
    if ((likely(PyTuple_CheckExact(__pyx_t_3))) || (PyList_CheckExact(__pyx_t_3))) {
      PyObject* sequence = __pyx_t_3;
      #if CYTHON_COMPILING_IN_CPYTHON
      Py_ssize_t size = Py_SIZE(sequence);
      #else
      Py_ssize_t size = PySequence_Size(sequence);
      #endif
      if (unlikely(size != 2)) {
        if (size > 2) __Pyx_RaiseTooManyValuesError(2);
        else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
        __PYX_ERR(0, 883, __pyx_L1_error)
      }
      #if CYTHON_COMPILING_IN_CPYTHON
      if (likely(PyTuple_CheckExact(sequence))) {
        __pyx_t_9 = PyTuple_GET_ITEM(sequence, 0); 
        __pyx_t_1 = PyTuple_GET_ITEM(sequence, 1); 
      } else {
        __pyx_t_9 = PyList_GET_ITEM(sequence, 0); 
        __pyx_t_1 = PyList_GET_ITEM(sequence, 1); 
      }
      __Pyx_INCREF(__pyx_t_9);
      __Pyx_INCREF(__pyx_t_1);
      #else
      __pyx_t_9 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 883, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_9);
      __pyx_t_1 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 883, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      #endif
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    } else {
      Py_ssize_t index = -1;
      __pyx_t_6 = PyObject_GetIter(__pyx_t_3); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 883, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_6);
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_12 = Py_TYPE(__pyx_t_6)->tp_iternext;
      index = 0; __pyx_t_9 = __pyx_t_12(__pyx_t_6); if (unlikely(!__pyx_t_9)) goto __pyx_L10_unpacking_failed;
      __Pyx_GOTREF(__pyx_t_9);
      index = 1; __pyx_t_1 = __pyx_t_12(__pyx_t_6); if (unlikely(!__pyx_t_1)) goto __pyx_L10_unpacking_failed;
      __Pyx_GOTREF(__pyx_t_1);
      if (__Pyx_IternextUnpackEndCheck(__pyx_t_12(__pyx_t_6), 2) < 0) __PYX_ERR(0, 883, __pyx_L1_error)
      __pyx_t_12 = NULL;
      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
      goto __pyx_L11_unpacking_done;
      __pyx_L10_unpacking_failed:;
      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
      __pyx_t_12 = NULL;
      if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
      __PYX_ERR(0, 883, __pyx_L1_error)
      __pyx_L11_unpacking_done:;
    }
    __pyx_v_centroids = __pyx_t_9;
    __pyx_t_9 = 0;
    __pyx_v_distortion = __pyx_t_1;
    __pyx_t_1 = 0;

    /* "vapor_vali/Simple_function.pyx":884
 *         whitened = whiten(array_diagnal)
 *         centroids, distortion=kmeans(whitened,ks_picked)
 *         idx,_= vq(whitened,centroids)             # <<<<<<<<<<<<<<
 *         for x in range(ks_picked):
 *             group1=[[int(i) for i in array_diagnal[idx==x,0]],[int(i) for i in array_diagnal[idx==x,1]]]
 */
    __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_vq); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 884, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_9 = NULL;
    __pyx_t_5 = 0;
    if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_1))) {
      __pyx_t_9 = PyMethod_GET_SELF(__pyx_t_1);
      if (likely(__pyx_t_9)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
        __Pyx_INCREF(__pyx_t_9);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_1, function);
        __pyx_t_5 = 1;
      }
    }
    __pyx_t_6 = PyTuple_New(2+__pyx_t_5); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 884, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    if (__pyx_t_9) {
      __Pyx_GIVEREF(__pyx_t_9); PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_9); __pyx_t_9 = NULL;
    }
    __Pyx_INCREF(__pyx_v_whitened);
    __Pyx_GIVEREF(__pyx_v_whitened);
    PyTuple_SET_ITEM(__pyx_t_6, 0+__pyx_t_5, __pyx_v_whitened);
    __Pyx_INCREF(__pyx_v_centroids);
    __Pyx_GIVEREF(__pyx_v_centroids);
    PyTuple_SET_ITEM(__pyx_t_6, 1+__pyx_t_5, __pyx_v_centroids);
    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_6, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 884, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    if ((likely(PyTuple_CheckExact(__pyx_t_3))) || (PyList_CheckExact(__pyx_t_3))) {
      PyObject* sequence = __pyx_t_3;
      #if CYTHON_COMPILING_IN_CPYTHON
      Py_ssize_t size = Py_SIZE(sequence);
      #else
      Py_ssize_t size = PySequence_Size(sequence);
      #endif
      if (unlikely(size != 2)) {
        if (size > 2) __Pyx_RaiseTooManyValuesError(2);
        else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
        __PYX_ERR(0, 884, __pyx_L1_error)
      }
      #if CYTHON_COMPILING_IN_CPYTHON
      if (likely(PyTuple_CheckExact(sequence))) {
        __pyx_t_1 = PyTuple_GET_ITEM(sequence, 0); 
        __pyx_t_6 = PyTuple_GET_ITEM(sequence, 1); 
      } else {
        __pyx_t_1 = PyList_GET_ITEM(sequence, 0); 
        __pyx_t_6 = PyList_GET_ITEM(sequence, 1); 
      }
      __Pyx_INCREF(__pyx_t_1);
      __Pyx_INCREF(__pyx_t_6);
      #else
      __pyx_t_1 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 884, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __pyx_t_6 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 884, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_6);
      #endif
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    } else {
      Py_ssize_t index = -1;
      __pyx_t_9 = PyObject_GetIter(__pyx_t_3); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 884, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_9);
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_12 = Py_TYPE(__pyx_t_9)->tp_iternext;
      index = 0; __pyx_t_1 = __pyx_t_12(__pyx_t_9); if (unlikely(!__pyx_t_1)) goto __pyx_L12_unpacking_failed;
      __Pyx_GOTREF(__pyx_t_1);
      index = 1; __pyx_t_6 = __pyx_t_12(__pyx_t_9); if (unlikely(!__pyx_t_6)) goto __pyx_L12_unpacking_failed;
      __Pyx_GOTREF(__pyx_t_6);
      if (__Pyx_IternextUnpackEndCheck(__pyx_t_12(__pyx_t_9), 2) < 0) __PYX_ERR(0, 884, __pyx_L1_error)
      __pyx_t_12 = NULL;
      __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
      goto __pyx_L13_unpacking_done;
      __pyx_L12_unpacking_failed:;
      __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
      __pyx_t_12 = NULL;
      if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
      __PYX_ERR(0, 884, __pyx_L1_error)
      __pyx_L13_unpacking_done:;
    }
    __pyx_v_idx = __pyx_t_1;
    __pyx_t_1 = 0;
    __pyx_v__ = __pyx_t_6;
    __pyx_t_6 = 0;

    /* "vapor_vali/Simple_function.pyx":885
 *         centroids, distortion=kmeans(whitened,ks_picked)
 *         idx,_= vq(whitened,centroids)
 *         for x in range(ks_picked):             # <<<<<<<<<<<<<<
 *             group1=[[int(i) for i in array_diagnal[idx==x,0]],[int(i) for i in array_diagnal[idx==x,1]]]
 *             out.append(group1)
 */
    __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 885, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_INCREF(__pyx_v_ks_picked);
    __Pyx_GIVEREF(__pyx_v_ks_picked);
    PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_v_ks_picked);
    __pyx_t_6 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_t_3, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 885, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    if (likely(PyList_CheckExact(__pyx_t_6)) || PyTuple_CheckExact(__pyx_t_6)) {
      __pyx_t_3 = __pyx_t_6; __Pyx_INCREF(__pyx_t_3); __pyx_t_5 = 0;
      __pyx_t_7 = NULL;
    } else {
      __pyx_t_5 = -1; __pyx_t_3 = PyObject_GetIter(__pyx_t_6); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 885, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __pyx_t_7 = Py_TYPE(__pyx_t_3)->tp_iternext; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 885, __pyx_L1_error)
    }
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    for (;;) {
      if (likely(!__pyx_t_7)) {
        if (likely(PyList_CheckExact(__pyx_t_3))) {
          if (__pyx_t_5 >= PyList_GET_SIZE(__pyx_t_3)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_6 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_5); __Pyx_INCREF(__pyx_t_6); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 885, __pyx_L1_error)
          #else
          __pyx_t_6 = PySequence_ITEM(__pyx_t_3, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 885, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_6);
          #endif
        } else {
          if (__pyx_t_5 >= PyTuple_GET_SIZE(__pyx_t_3)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_6 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_5); __Pyx_INCREF(__pyx_t_6); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 885, __pyx_L1_error)
          #else
          __pyx_t_6 = PySequence_ITEM(__pyx_t_3, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 885, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_6);
          #endif
        }
      } else {
        __pyx_t_6 = __pyx_t_7(__pyx_t_3);
        if (unlikely(!__pyx_t_6)) {
          PyObject* exc_type = PyErr_Occurred();
          if (exc_type) {
            if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
            else __PYX_ERR(0, 885, __pyx_L1_error)
          }
          break;
        }
        __Pyx_GOTREF(__pyx_t_6);
      }
      __Pyx_XDECREF_SET(__pyx_v_x, __pyx_t_6);
      __pyx_t_6 = 0;

      /* "vapor_vali/Simple_function.pyx":886
 *         idx,_= vq(whitened,centroids)
 *         for x in range(ks_picked):
 *             group1=[[int(i) for i in array_diagnal[idx==x,0]],[int(i) for i in array_diagnal[idx==x,1]]]             # <<<<<<<<<<<<<<
 *             out.append(group1)
 *         return out
 */
      __pyx_t_6 = PyList_New(0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 886, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_6);
      __pyx_t_1 = PyObject_RichCompare(__pyx_v_idx, __pyx_v_x, Py_EQ); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 886, __pyx_L1_error)
      __pyx_t_9 = PyTuple_New(2); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 886, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_9);
      __Pyx_GIVEREF(__pyx_t_1);
      PyTuple_SET_ITEM(__pyx_t_9, 0, __pyx_t_1);
      __Pyx_INCREF(__pyx_int_0);
      __Pyx_GIVEREF(__pyx_int_0);
      PyTuple_SET_ITEM(__pyx_t_9, 1, __pyx_int_0);
      __pyx_t_1 = 0;
      __pyx_t_1 = PyObject_GetItem(__pyx_v_array_diagnal, __pyx_t_9); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 886, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
      if (likely(PyList_CheckExact(__pyx_t_1)) || PyTuple_CheckExact(__pyx_t_1)) {
        __pyx_t_9 = __pyx_t_1; __Pyx_INCREF(__pyx_t_9); __pyx_t_10 = 0;
        __pyx_t_13 = NULL;
      } else {
        __pyx_t_10 = -1; __pyx_t_9 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 886, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_9);
        __pyx_t_13 = Py_TYPE(__pyx_t_9)->tp_iternext; if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 886, __pyx_L1_error)
      }
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      for (;;) {
        if (likely(!__pyx_t_13)) {
          if (likely(PyList_CheckExact(__pyx_t_9))) {
            if (__pyx_t_10 >= PyList_GET_SIZE(__pyx_t_9)) break;
            #if CYTHON_COMPILING_IN_CPYTHON
            __pyx_t_1 = PyList_GET_ITEM(__pyx_t_9, __pyx_t_10); __Pyx_INCREF(__pyx_t_1); __pyx_t_10++; if (unlikely(0 < 0)) __PYX_ERR(0, 886, __pyx_L1_error)
            #else
            __pyx_t_1 = PySequence_ITEM(__pyx_t_9, __pyx_t_10); __pyx_t_10++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 886, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_1);
            #endif
          } else {
            if (__pyx_t_10 >= PyTuple_GET_SIZE(__pyx_t_9)) break;
            #if CYTHON_COMPILING_IN_CPYTHON
            __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_9, __pyx_t_10); __Pyx_INCREF(__pyx_t_1); __pyx_t_10++; if (unlikely(0 < 0)) __PYX_ERR(0, 886, __pyx_L1_error)
            #else
            __pyx_t_1 = PySequence_ITEM(__pyx_t_9, __pyx_t_10); __pyx_t_10++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 886, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_1);
            #endif
          }
        } else {
          __pyx_t_1 = __pyx_t_13(__pyx_t_9);
          if (unlikely(!__pyx_t_1)) {
            PyObject* exc_type = PyErr_Occurred();
            if (exc_type) {
              if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
              else __PYX_ERR(0, 886, __pyx_L1_error)
            }
            break;
          }
          __Pyx_GOTREF(__pyx_t_1);
        }
        __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_1);
        __pyx_t_1 = 0;
        __pyx_t_1 = __Pyx_PyNumber_Int(__pyx_v_i); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 886, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        if (unlikely(__Pyx_ListComp_Append(__pyx_t_6, (PyObject*)__pyx_t_1))) __PYX_ERR(0, 886, __pyx_L1_error)
        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      }
      __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
      __pyx_t_9 = PyList_New(0); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 886, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_9);
      __pyx_t_1 = PyObject_RichCompare(__pyx_v_idx, __pyx_v_x, Py_EQ); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 886, __pyx_L1_error)
      __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 886, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      __Pyx_GIVEREF(__pyx_t_1);
      PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_1);
      __Pyx_INCREF(__pyx_int_1);
      __Pyx_GIVEREF(__pyx_int_1);
      PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_int_1);
      __pyx_t_1 = 0;
      __pyx_t_1 = PyObject_GetItem(__pyx_v_array_diagnal, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 886, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      if (likely(PyList_CheckExact(__pyx_t_1)) || PyTuple_CheckExact(__pyx_t_1)) {
        __pyx_t_4 = __pyx_t_1; __Pyx_INCREF(__pyx_t_4); __pyx_t_10 = 0;
        __pyx_t_13 = NULL;
      } else {
        __pyx_t_10 = -1; __pyx_t_4 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 886, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_4);
        __pyx_t_13 = Py_TYPE(__pyx_t_4)->tp_iternext; if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 886, __pyx_L1_error)
      }
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      for (;;) {
        if (likely(!__pyx_t_13)) {
          if (likely(PyList_CheckExact(__pyx_t_4))) {
            if (__pyx_t_10 >= PyList_GET_SIZE(__pyx_t_4)) break;
            #if CYTHON_COMPILING_IN_CPYTHON
            __pyx_t_1 = PyList_GET_ITEM(__pyx_t_4, __pyx_t_10); __Pyx_INCREF(__pyx_t_1); __pyx_t_10++; if (unlikely(0 < 0)) __PYX_ERR(0, 886, __pyx_L1_error)
            #else
            __pyx_t_1 = PySequence_ITEM(__pyx_t_4, __pyx_t_10); __pyx_t_10++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 886, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_1);
            #endif
          } else {
            if (__pyx_t_10 >= PyTuple_GET_SIZE(__pyx_t_4)) break;
            #if CYTHON_COMPILING_IN_CPYTHON
            __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_4, __pyx_t_10); __Pyx_INCREF(__pyx_t_1); __pyx_t_10++; if (unlikely(0 < 0)) __PYX_ERR(0, 886, __pyx_L1_error)
            #else
            __pyx_t_1 = PySequence_ITEM(__pyx_t_4, __pyx_t_10); __pyx_t_10++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 886, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_1);
            #endif
          }
        } else {
          __pyx_t_1 = __pyx_t_13(__pyx_t_4);
          if (unlikely(!__pyx_t_1)) {
            PyObject* exc_type = PyErr_Occurred();
            if (exc_type) {
              if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
              else __PYX_ERR(0, 886, __pyx_L1_error)
            }
            break;
          }
          __Pyx_GOTREF(__pyx_t_1);
        }
        __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_1);
        __pyx_t_1 = 0;
        __pyx_t_1 = __Pyx_PyNumber_Int(__pyx_v_i); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 886, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        if (unlikely(__Pyx_ListComp_Append(__pyx_t_9, (PyObject*)__pyx_t_1))) __PYX_ERR(0, 886, __pyx_L1_error)
        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      }
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_4 = PyList_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 886, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      __Pyx_GIVEREF(__pyx_t_6);
      PyList_SET_ITEM(__pyx_t_4, 0, __pyx_t_6);
      __Pyx_GIVEREF(__pyx_t_9);
      PyList_SET_ITEM(__pyx_t_4, 1, __pyx_t_9);
      __pyx_t_6 = 0;
      __pyx_t_9 = 0;
      __Pyx_XDECREF_SET(__pyx_v_group1, ((PyObject*)__pyx_t_4));
      __pyx_t_4 = 0;

      /* "vapor_vali/Simple_function.pyx":887
 *         for x in range(ks_picked):
 *             group1=[[int(i) for i in array_diagnal[idx==x,0]],[int(i) for i in array_diagnal[idx==x,1]]]
 *             out.append(group1)             # <<<<<<<<<<<<<<
 *         return out
 * 
 */
      __pyx_t_14 = __Pyx_PyList_Append(__pyx_v_out, __pyx_v_group1); if (unlikely(__pyx_t_14 == -1)) __PYX_ERR(0, 887, __pyx_L1_error)

      /* "vapor_vali/Simple_function.pyx":885
 *         centroids, distortion=kmeans(whitened,ks_picked)
 *         idx,_= vq(whitened,centroids)
 *         for x in range(ks_picked):             # <<<<<<<<<<<<<<
 *             group1=[[int(i) for i in array_diagnal[idx==x,0]],[int(i) for i in array_diagnal[idx==x,1]]]
 *             out.append(group1)
 */
    }
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;

    /* "vapor_vali/Simple_function.pyx":888
 *             group1=[[int(i) for i in array_diagnal[idx==x,0]],[int(i) for i in array_diagnal[idx==x,1]]]
 *             out.append(group1)
 *         return out             # <<<<<<<<<<<<<<
 * 
 * def key_modify(key):
 */
    __Pyx_XDECREF(__pyx_r);
    __Pyx_INCREF(__pyx_v_out);
    __pyx_r = __pyx_v_out;
    goto __pyx_L0;
  }

  /* "vapor_vali/Simple_function.pyx":871
 *         return [data_list]
 * 
 * def k_means_cluster_Predict(data_list,info):             # <<<<<<<<<<<<<<
 *     array_diagnal=np.array([[data_list[0][x],data_list[1][x]] for x in range(len(data_list[0]))])
 *     ks = list(range(1,len(info)))
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_XDECREF(__pyx_t_8);
  __Pyx_XDECREF(__pyx_t_9);
  __Pyx_AddTraceback("vapor_vali.Simple_function.k_means_cluster_Predict", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_array_diagnal);
  __Pyx_XDECREF(__pyx_v_ks);
  __Pyx_XDECREF(__pyx_v_KMeans);
  __Pyx_XDECREF(__pyx_v_BIC);
  __Pyx_XDECREF(__pyx_v_ks_picked);
  __Pyx_XDECREF(__pyx_v_out);
  __Pyx_XDECREF(__pyx_v_std_rec);
  __Pyx_XDECREF(__pyx_v_whitened);
  __Pyx_XDECREF(__pyx_v_centroids);
  __Pyx_XDECREF(__pyx_v_distortion);
  __Pyx_XDECREF(__pyx_v_idx);
  __Pyx_XDECREF(__pyx_v__);
  __Pyx_XDECREF(__pyx_v_x);
  __Pyx_XDECREF(__pyx_v_group1);
  __Pyx_XDECREF(__pyx_v_i);
  __Pyx_XDECREF(__pyx_v_kmeansi);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "vapor_vali/Simple_function.pyx":890
 *         return out
 * 
 * def key_modify(key):             # <<<<<<<<<<<<<<
 *     if 'R' in key:
 *             key=key.replace('R','N')
 */

/* Python wrapper */
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_125key_modify(PyObject *__pyx_self, PyObject *__pyx_v_key); /*proto*/
static PyMethodDef __pyx_mdef_10vapor_vali_15Simple_function_125key_modify = {"key_modify", (PyCFunction)__pyx_pw_10vapor_vali_15Simple_function_125key_modify, METH_O, 0};
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_125key_modify(PyObject *__pyx_self, PyObject *__pyx_v_key) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("key_modify (wrapper)", 0);
  __pyx_r = __pyx_pf_10vapor_vali_15Simple_function_124key_modify(__pyx_self, ((PyObject *)__pyx_v_key));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10vapor_vali_15Simple_function_124key_modify(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_key) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  int __pyx_t_2;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  __Pyx_RefNannySetupContext("key_modify", 0);
  __Pyx_INCREF(__pyx_v_key);

  /* "vapor_vali/Simple_function.pyx":891
 * 
 * def key_modify(key):
 *     if 'R' in key:             # <<<<<<<<<<<<<<
 *             key=key.replace('R','N')
 *     if 'r' in key:
 */
  __pyx_t_1 = (__Pyx_PySequence_ContainsTF(__pyx_n_s_R, __pyx_v_key, Py_EQ)); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(0, 891, __pyx_L1_error)
  __pyx_t_2 = (__pyx_t_1 != 0);
  if (__pyx_t_2) {

    /* "vapor_vali/Simple_function.pyx":892
 * def key_modify(key):
 *     if 'R' in key:
 *             key=key.replace('R','N')             # <<<<<<<<<<<<<<
 *     if 'r' in key:
 *             key=key.replace('r','n')
 */
    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_key, __pyx_n_s_replace); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 892, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_tuple__52, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 892, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __Pyx_DECREF_SET(__pyx_v_key, __pyx_t_4);
    __pyx_t_4 = 0;

    /* "vapor_vali/Simple_function.pyx":891
 * 
 * def key_modify(key):
 *     if 'R' in key:             # <<<<<<<<<<<<<<
 *             key=key.replace('R','N')
 *     if 'r' in key:
 */
  }

  /* "vapor_vali/Simple_function.pyx":893
 *     if 'R' in key:
 *             key=key.replace('R','N')
 *     if 'r' in key:             # <<<<<<<<<<<<<<
 *             key=key.replace('r','n')
 *     if 'Y' in key:
 */
  __pyx_t_2 = (__Pyx_PySequence_ContainsTF(__pyx_n_s_r, __pyx_v_key, Py_EQ)); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 893, __pyx_L1_error)
  __pyx_t_1 = (__pyx_t_2 != 0);
  if (__pyx_t_1) {

    /* "vapor_vali/Simple_function.pyx":894
 *             key=key.replace('R','N')
 *     if 'r' in key:
 *             key=key.replace('r','n')             # <<<<<<<<<<<<<<
 *     if 'Y' in key:
 *             key=key.replace('Y','N')
 */
    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_key, __pyx_n_s_replace); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 894, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_tuple__53, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 894, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __Pyx_DECREF_SET(__pyx_v_key, __pyx_t_3);
    __pyx_t_3 = 0;

    /* "vapor_vali/Simple_function.pyx":893
 *     if 'R' in key:
 *             key=key.replace('R','N')
 *     if 'r' in key:             # <<<<<<<<<<<<<<
 *             key=key.replace('r','n')
 *     if 'Y' in key:
 */
  }

  /* "vapor_vali/Simple_function.pyx":895
 *     if 'r' in key:
 *             key=key.replace('r','n')
 *     if 'Y' in key:             # <<<<<<<<<<<<<<
 *             key=key.replace('Y','N')
 *     if 'y' in key:
 */
  __pyx_t_1 = (__Pyx_PySequence_ContainsTF(__pyx_n_s_Y, __pyx_v_key, Py_EQ)); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(0, 895, __pyx_L1_error)
  __pyx_t_2 = (__pyx_t_1 != 0);
  if (__pyx_t_2) {

    /* "vapor_vali/Simple_function.pyx":896
 *             key=key.replace('r','n')
 *     if 'Y' in key:
 *             key=key.replace('Y','N')             # <<<<<<<<<<<<<<
 *     if 'y' in key:
 *             key=key.replace('y','n')
 */
    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_key, __pyx_n_s_replace); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 896, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_tuple__54, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 896, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __Pyx_DECREF_SET(__pyx_v_key, __pyx_t_4);
    __pyx_t_4 = 0;

    /* "vapor_vali/Simple_function.pyx":895
 *     if 'r' in key:
 *             key=key.replace('r','n')
 *     if 'Y' in key:             # <<<<<<<<<<<<<<
 *             key=key.replace('Y','N')
 *     if 'y' in key:
 */
  }

  /* "vapor_vali/Simple_function.pyx":897
 *     if 'Y' in key:
 *             key=key.replace('Y','N')
 *     if 'y' in key:             # <<<<<<<<<<<<<<
 *             key=key.replace('y','n')
 *     if 'S' in key:
 */
  __pyx_t_2 = (__Pyx_PySequence_ContainsTF(__pyx_n_s_y, __pyx_v_key, Py_EQ)); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 897, __pyx_L1_error)
  __pyx_t_1 = (__pyx_t_2 != 0);
  if (__pyx_t_1) {

    /* "vapor_vali/Simple_function.pyx":898
 *             key=key.replace('Y','N')
 *     if 'y' in key:
 *             key=key.replace('y','n')             # <<<<<<<<<<<<<<
 *     if 'S' in key:
 *             key=key.replace('S','N')
 */
    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_key, __pyx_n_s_replace); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 898, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_tuple__55, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 898, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __Pyx_DECREF_SET(__pyx_v_key, __pyx_t_3);
    __pyx_t_3 = 0;

    /* "vapor_vali/Simple_function.pyx":897
 *     if 'Y' in key:
 *             key=key.replace('Y','N')
 *     if 'y' in key:             # <<<<<<<<<<<<<<
 *             key=key.replace('y','n')
 *     if 'S' in key:
 */
  }

  /* "vapor_vali/Simple_function.pyx":899
 *     if 'y' in key:
 *             key=key.replace('y','n')
 *     if 'S' in key:             # <<<<<<<<<<<<<<
 *             key=key.replace('S','N')
 *     if 's' in key:
 */
  __pyx_t_1 = (__Pyx_PySequence_ContainsTF(__pyx_n_s_S, __pyx_v_key, Py_EQ)); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(0, 899, __pyx_L1_error)
  __pyx_t_2 = (__pyx_t_1 != 0);
  if (__pyx_t_2) {

    /* "vapor_vali/Simple_function.pyx":900
 *             key=key.replace('y','n')
 *     if 'S' in key:
 *             key=key.replace('S','N')             # <<<<<<<<<<<<<<
 *     if 's' in key:
 *             key=key.replace('s','n')
 */
    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_key, __pyx_n_s_replace); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 900, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_tuple__56, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 900, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __Pyx_DECREF_SET(__pyx_v_key, __pyx_t_4);
    __pyx_t_4 = 0;

    /* "vapor_vali/Simple_function.pyx":899
 *     if 'y' in key:
 *             key=key.replace('y','n')
 *     if 'S' in key:             # <<<<<<<<<<<<<<
 *             key=key.replace('S','N')
 *     if 's' in key:
 */
  }

  /* "vapor_vali/Simple_function.pyx":901
 *     if 'S' in key:
 *             key=key.replace('S','N')
 *     if 's' in key:             # <<<<<<<<<<<<<<
 *             key=key.replace('s','n')
 *     if 'W' in key:
 */
  __pyx_t_2 = (__Pyx_PySequence_ContainsTF(__pyx_n_s_s, __pyx_v_key, Py_EQ)); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 901, __pyx_L1_error)
  __pyx_t_1 = (__pyx_t_2 != 0);
  if (__pyx_t_1) {

    /* "vapor_vali/Simple_function.pyx":902
 *             key=key.replace('S','N')
 *     if 's' in key:
 *             key=key.replace('s','n')             # <<<<<<<<<<<<<<
 *     if 'W' in key:
 *             key=key.replace('W','N')
 */
    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_key, __pyx_n_s_replace); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 902, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_tuple__57, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 902, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __Pyx_DECREF_SET(__pyx_v_key, __pyx_t_3);
    __pyx_t_3 = 0;

    /* "vapor_vali/Simple_function.pyx":901
 *     if 'S' in key:
 *             key=key.replace('S','N')
 *     if 's' in key:             # <<<<<<<<<<<<<<
 *             key=key.replace('s','n')
 *     if 'W' in key:
 */
  }

  /* "vapor_vali/Simple_function.pyx":903
 *     if 's' in key:
 *             key=key.replace('s','n')
 *     if 'W' in key:             # <<<<<<<<<<<<<<
 *             key=key.replace('W','N')
 *     if 'w' in key:
 */
  __pyx_t_1 = (__Pyx_PySequence_ContainsTF(__pyx_n_s_W, __pyx_v_key, Py_EQ)); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(0, 903, __pyx_L1_error)
  __pyx_t_2 = (__pyx_t_1 != 0);
  if (__pyx_t_2) {

    /* "vapor_vali/Simple_function.pyx":904
 *             key=key.replace('s','n')
 *     if 'W' in key:
 *             key=key.replace('W','N')             # <<<<<<<<<<<<<<
 *     if 'w' in key:
 *             key=key.replace('w','n')
 */
    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_key, __pyx_n_s_replace); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 904, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_tuple__58, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 904, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __Pyx_DECREF_SET(__pyx_v_key, __pyx_t_4);
    __pyx_t_4 = 0;

    /* "vapor_vali/Simple_function.pyx":903
 *     if 's' in key:
 *             key=key.replace('s','n')
 *     if 'W' in key:             # <<<<<<<<<<<<<<
 *             key=key.replace('W','N')
 *     if 'w' in key:
 */
  }

  /* "vapor_vali/Simple_function.pyx":905
 *     if 'W' in key:
 *             key=key.replace('W','N')
 *     if 'w' in key:             # <<<<<<<<<<<<<<
 *             key=key.replace('w','n')
 *     if 'K' in key:
 */
  __pyx_t_2 = (__Pyx_PySequence_ContainsTF(__pyx_n_s_w, __pyx_v_key, Py_EQ)); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 905, __pyx_L1_error)
  __pyx_t_1 = (__pyx_t_2 != 0);
  if (__pyx_t_1) {

    /* "vapor_vali/Simple_function.pyx":906
 *             key=key.replace('W','N')
 *     if 'w' in key:
 *             key=key.replace('w','n')             # <<<<<<<<<<<<<<
 *     if 'K' in key:
 *             key=key.replace('K','N')
 */
    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_key, __pyx_n_s_replace); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 906, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_tuple__59, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 906, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __Pyx_DECREF_SET(__pyx_v_key, __pyx_t_3);
    __pyx_t_3 = 0;

    /* "vapor_vali/Simple_function.pyx":905
 *     if 'W' in key:
 *             key=key.replace('W','N')
 *     if 'w' in key:             # <<<<<<<<<<<<<<
 *             key=key.replace('w','n')
 *     if 'K' in key:
 */
  }

  /* "vapor_vali/Simple_function.pyx":907
 *     if 'w' in key:
 *             key=key.replace('w','n')
 *     if 'K' in key:             # <<<<<<<<<<<<<<
 *             key=key.replace('K','N')
 *     if 'k' in key:
 */
  __pyx_t_1 = (__Pyx_PySequence_ContainsTF(__pyx_n_s_K, __pyx_v_key, Py_EQ)); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(0, 907, __pyx_L1_error)
  __pyx_t_2 = (__pyx_t_1 != 0);
  if (__pyx_t_2) {

    /* "vapor_vali/Simple_function.pyx":908
 *             key=key.replace('w','n')
 *     if 'K' in key:
 *             key=key.replace('K','N')             # <<<<<<<<<<<<<<
 *     if 'k' in key:
 *             key=key.replace('k','n')
 */
    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_key, __pyx_n_s_replace); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 908, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_tuple__60, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 908, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __Pyx_DECREF_SET(__pyx_v_key, __pyx_t_4);
    __pyx_t_4 = 0;

    /* "vapor_vali/Simple_function.pyx":907
 *     if 'w' in key:
 *             key=key.replace('w','n')
 *     if 'K' in key:             # <<<<<<<<<<<<<<
 *             key=key.replace('K','N')
 *     if 'k' in key:
 */
  }

  /* "vapor_vali/Simple_function.pyx":909
 *     if 'K' in key:
 *             key=key.replace('K','N')
 *     if 'k' in key:             # <<<<<<<<<<<<<<
 *             key=key.replace('k','n')
 *     if 'M' in key:
 */
  __pyx_t_2 = (__Pyx_PySequence_ContainsTF(__pyx_n_s_k, __pyx_v_key, Py_EQ)); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 909, __pyx_L1_error)
  __pyx_t_1 = (__pyx_t_2 != 0);
  if (__pyx_t_1) {

    /* "vapor_vali/Simple_function.pyx":910
 *             key=key.replace('K','N')
 *     if 'k' in key:
 *             key=key.replace('k','n')             # <<<<<<<<<<<<<<
 *     if 'M' in key:
 *             key=key.replace('M','N')
 */
    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_key, __pyx_n_s_replace); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 910, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_tuple__61, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 910, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __Pyx_DECREF_SET(__pyx_v_key, __pyx_t_3);
    __pyx_t_3 = 0;

    /* "vapor_vali/Simple_function.pyx":909
 *     if 'K' in key:
 *             key=key.replace('K','N')
 *     if 'k' in key:             # <<<<<<<<<<<<<<
 *             key=key.replace('k','n')
 *     if 'M' in key:
 */
  }

  /* "vapor_vali/Simple_function.pyx":911
 *     if 'k' in key:
 *             key=key.replace('k','n')
 *     if 'M' in key:             # <<<<<<<<<<<<<<
 *             key=key.replace('M','N')
 *     if 'm' in key:
 */
  __pyx_t_1 = (__Pyx_PySequence_ContainsTF(__pyx_n_s_M, __pyx_v_key, Py_EQ)); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(0, 911, __pyx_L1_error)
  __pyx_t_2 = (__pyx_t_1 != 0);
  if (__pyx_t_2) {

    /* "vapor_vali/Simple_function.pyx":912
 *             key=key.replace('k','n')
 *     if 'M' in key:
 *             key=key.replace('M','N')             # <<<<<<<<<<<<<<
 *     if 'm' in key:
 *             key=key.replace('m','n')
 */
    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_key, __pyx_n_s_replace); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 912, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_tuple__62, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 912, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __Pyx_DECREF_SET(__pyx_v_key, __pyx_t_4);
    __pyx_t_4 = 0;

    /* "vapor_vali/Simple_function.pyx":911
 *     if 'k' in key:
 *             key=key.replace('k','n')
 *     if 'M' in key:             # <<<<<<<<<<<<<<
 *             key=key.replace('M','N')
 *     if 'm' in key:
 */
  }

  /* "vapor_vali/Simple_function.pyx":913
 *     if 'M' in key:
 *             key=key.replace('M','N')
 *     if 'm' in key:             # <<<<<<<<<<<<<<
 *             key=key.replace('m','n')
 *     if 'B' in key:
 */
  __pyx_t_2 = (__Pyx_PySequence_ContainsTF(__pyx_n_s_m, __pyx_v_key, Py_EQ)); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 913, __pyx_L1_error)
  __pyx_t_1 = (__pyx_t_2 != 0);
  if (__pyx_t_1) {

    /* "vapor_vali/Simple_function.pyx":914
 *             key=key.replace('M','N')
 *     if 'm' in key:
 *             key=key.replace('m','n')             # <<<<<<<<<<<<<<
 *     if 'B' in key:
 *             key=key.replace('B','N')
 */
    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_key, __pyx_n_s_replace); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 914, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_tuple__63, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 914, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __Pyx_DECREF_SET(__pyx_v_key, __pyx_t_3);
    __pyx_t_3 = 0;

    /* "vapor_vali/Simple_function.pyx":913
 *     if 'M' in key:
 *             key=key.replace('M','N')
 *     if 'm' in key:             # <<<<<<<<<<<<<<
 *             key=key.replace('m','n')
 *     if 'B' in key:
 */
  }

  /* "vapor_vali/Simple_function.pyx":915
 *     if 'm' in key:
 *             key=key.replace('m','n')
 *     if 'B' in key:             # <<<<<<<<<<<<<<
 *             key=key.replace('B','N')
 *     if 'b' in key:
 */
  __pyx_t_1 = (__Pyx_PySequence_ContainsTF(__pyx_n_s_B, __pyx_v_key, Py_EQ)); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(0, 915, __pyx_L1_error)
  __pyx_t_2 = (__pyx_t_1 != 0);
  if (__pyx_t_2) {

    /* "vapor_vali/Simple_function.pyx":916
 *             key=key.replace('m','n')
 *     if 'B' in key:
 *             key=key.replace('B','N')             # <<<<<<<<<<<<<<
 *     if 'b' in key:
 *             key=key.replace('b','n')
 */
    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_key, __pyx_n_s_replace); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 916, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_tuple__64, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 916, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __Pyx_DECREF_SET(__pyx_v_key, __pyx_t_4);
    __pyx_t_4 = 0;

    /* "vapor_vali/Simple_function.pyx":915
 *     if 'm' in key:
 *             key=key.replace('m','n')
 *     if 'B' in key:             # <<<<<<<<<<<<<<
 *             key=key.replace('B','N')
 *     if 'b' in key:
 */
  }

  /* "vapor_vali/Simple_function.pyx":917
 *     if 'B' in key:
 *             key=key.replace('B','N')
 *     if 'b' in key:             # <<<<<<<<<<<<<<
 *             key=key.replace('b','n')
 *     if 'D' in key:
 */
  __pyx_t_2 = (__Pyx_PySequence_ContainsTF(__pyx_n_s_b, __pyx_v_key, Py_EQ)); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 917, __pyx_L1_error)
  __pyx_t_1 = (__pyx_t_2 != 0);
  if (__pyx_t_1) {

    /* "vapor_vali/Simple_function.pyx":918
 *             key=key.replace('B','N')
 *     if 'b' in key:
 *             key=key.replace('b','n')             # <<<<<<<<<<<<<<
 *     if 'D' in key:
 *             key=key.replace('D','N')
 */
    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_key, __pyx_n_s_replace); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 918, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_tuple__65, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 918, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __Pyx_DECREF_SET(__pyx_v_key, __pyx_t_3);
    __pyx_t_3 = 0;

    /* "vapor_vali/Simple_function.pyx":917
 *     if 'B' in key:
 *             key=key.replace('B','N')
 *     if 'b' in key:             # <<<<<<<<<<<<<<
 *             key=key.replace('b','n')
 *     if 'D' in key:
 */
  }

  /* "vapor_vali/Simple_function.pyx":919
 *     if 'b' in key:
 *             key=key.replace('b','n')
 *     if 'D' in key:             # <<<<<<<<<<<<<<
 *             key=key.replace('D','N')
 *     if 'd' in key:
 */
  __pyx_t_1 = (__Pyx_PySequence_ContainsTF(__pyx_n_s_D, __pyx_v_key, Py_EQ)); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(0, 919, __pyx_L1_error)
  __pyx_t_2 = (__pyx_t_1 != 0);
  if (__pyx_t_2) {

    /* "vapor_vali/Simple_function.pyx":920
 *             key=key.replace('b','n')
 *     if 'D' in key:
 *             key=key.replace('D','N')             # <<<<<<<<<<<<<<
 *     if 'd' in key:
 *             key=key.replace('d','n')
 */
    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_key, __pyx_n_s_replace); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 920, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_tuple__66, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 920, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __Pyx_DECREF_SET(__pyx_v_key, __pyx_t_4);
    __pyx_t_4 = 0;

    /* "vapor_vali/Simple_function.pyx":919
 *     if 'b' in key:
 *             key=key.replace('b','n')
 *     if 'D' in key:             # <<<<<<<<<<<<<<
 *             key=key.replace('D','N')
 *     if 'd' in key:
 */
  }

  /* "vapor_vali/Simple_function.pyx":921
 *     if 'D' in key:
 *             key=key.replace('D','N')
 *     if 'd' in key:             # <<<<<<<<<<<<<<
 *             key=key.replace('d','n')
 *     if 'H' in key:
 */
  __pyx_t_2 = (__Pyx_PySequence_ContainsTF(__pyx_n_s_d, __pyx_v_key, Py_EQ)); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 921, __pyx_L1_error)
  __pyx_t_1 = (__pyx_t_2 != 0);
  if (__pyx_t_1) {

    /* "vapor_vali/Simple_function.pyx":922
 *             key=key.replace('D','N')
 *     if 'd' in key:
 *             key=key.replace('d','n')             # <<<<<<<<<<<<<<
 *     if 'H' in key:
 *             key=key.replace('H','N')
 */
    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_key, __pyx_n_s_replace); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 922, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_tuple__67, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 922, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __Pyx_DECREF_SET(__pyx_v_key, __pyx_t_3);
    __pyx_t_3 = 0;

    /* "vapor_vali/Simple_function.pyx":921
 *     if 'D' in key:
 *             key=key.replace('D','N')
 *     if 'd' in key:             # <<<<<<<<<<<<<<
 *             key=key.replace('d','n')
 *     if 'H' in key:
 */
  }

  /* "vapor_vali/Simple_function.pyx":923
 *     if 'd' in key:
 *             key=key.replace('d','n')
 *     if 'H' in key:             # <<<<<<<<<<<<<<
 *             key=key.replace('H','N')
 *     if 'h' in key:
 */
  __pyx_t_1 = (__Pyx_PySequence_ContainsTF(__pyx_n_s_H, __pyx_v_key, Py_EQ)); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(0, 923, __pyx_L1_error)
  __pyx_t_2 = (__pyx_t_1 != 0);
  if (__pyx_t_2) {

    /* "vapor_vali/Simple_function.pyx":924
 *             key=key.replace('d','n')
 *     if 'H' in key:
 *             key=key.replace('H','N')             # <<<<<<<<<<<<<<
 *     if 'h' in key:
 *             key=key.replace('h','n')
 */
    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_key, __pyx_n_s_replace); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 924, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_tuple__68, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 924, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __Pyx_DECREF_SET(__pyx_v_key, __pyx_t_4);
    __pyx_t_4 = 0;

    /* "vapor_vali/Simple_function.pyx":923
 *     if 'd' in key:
 *             key=key.replace('d','n')
 *     if 'H' in key:             # <<<<<<<<<<<<<<
 *             key=key.replace('H','N')
 *     if 'h' in key:
 */
  }

  /* "vapor_vali/Simple_function.pyx":925
 *     if 'H' in key:
 *             key=key.replace('H','N')
 *     if 'h' in key:             # <<<<<<<<<<<<<<
 *             key=key.replace('h','n')
 *     if 'V' in key:
 */
  __pyx_t_2 = (__Pyx_PySequence_ContainsTF(__pyx_n_s_h, __pyx_v_key, Py_EQ)); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 925, __pyx_L1_error)
  __pyx_t_1 = (__pyx_t_2 != 0);
  if (__pyx_t_1) {

    /* "vapor_vali/Simple_function.pyx":926
 *             key=key.replace('H','N')
 *     if 'h' in key:
 *             key=key.replace('h','n')             # <<<<<<<<<<<<<<
 *     if 'V' in key:
 *             key=key.replace('V','N')
 */
    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_key, __pyx_n_s_replace); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 926, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_tuple__69, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 926, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __Pyx_DECREF_SET(__pyx_v_key, __pyx_t_3);
    __pyx_t_3 = 0;

    /* "vapor_vali/Simple_function.pyx":925
 *     if 'H' in key:
 *             key=key.replace('H','N')
 *     if 'h' in key:             # <<<<<<<<<<<<<<
 *             key=key.replace('h','n')
 *     if 'V' in key:
 */
  }

  /* "vapor_vali/Simple_function.pyx":927
 *     if 'h' in key:
 *             key=key.replace('h','n')
 *     if 'V' in key:             # <<<<<<<<<<<<<<
 *             key=key.replace('V','N')
 *     if 'v' in key:
 */
  __pyx_t_1 = (__Pyx_PySequence_ContainsTF(__pyx_n_s_V, __pyx_v_key, Py_EQ)); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(0, 927, __pyx_L1_error)
  __pyx_t_2 = (__pyx_t_1 != 0);
  if (__pyx_t_2) {

    /* "vapor_vali/Simple_function.pyx":928
 *             key=key.replace('h','n')
 *     if 'V' in key:
 *             key=key.replace('V','N')             # <<<<<<<<<<<<<<
 *     if 'v' in key:
 *             key=key.replace('v','n')
 */
    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_key, __pyx_n_s_replace); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 928, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_tuple__70, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 928, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __Pyx_DECREF_SET(__pyx_v_key, __pyx_t_4);
    __pyx_t_4 = 0;

    /* "vapor_vali/Simple_function.pyx":927
 *     if 'h' in key:
 *             key=key.replace('h','n')
 *     if 'V' in key:             # <<<<<<<<<<<<<<
 *             key=key.replace('V','N')
 *     if 'v' in key:
 */
  }

  /* "vapor_vali/Simple_function.pyx":929
 *     if 'V' in key:
 *             key=key.replace('V','N')
 *     if 'v' in key:             # <<<<<<<<<<<<<<
 *             key=key.replace('v','n')
 *     return key
 */
  __pyx_t_2 = (__Pyx_PySequence_ContainsTF(__pyx_n_s_v, __pyx_v_key, Py_EQ)); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 929, __pyx_L1_error)
  __pyx_t_1 = (__pyx_t_2 != 0);
  if (__pyx_t_1) {

    /* "vapor_vali/Simple_function.pyx":930
 *             key=key.replace('V','N')
 *     if 'v' in key:
 *             key=key.replace('v','n')             # <<<<<<<<<<<<<<
 *     return key
 * 
 */
    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_key, __pyx_n_s_replace); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 930, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_tuple__71, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 930, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __Pyx_DECREF_SET(__pyx_v_key, __pyx_t_3);
    __pyx_t_3 = 0;

    /* "vapor_vali/Simple_function.pyx":929
 *     if 'V' in key:
 *             key=key.replace('V','N')
 *     if 'v' in key:             # <<<<<<<<<<<<<<
 *             key=key.replace('v','n')
 *     return key
 */
  }

  /* "vapor_vali/Simple_function.pyx":931
 *     if 'v' in key:
 *             key=key.replace('v','n')
 *     return key             # <<<<<<<<<<<<<<
 * 
 * def kmerhits(seq1, seq2, kmerlen, nth_base=1, inversions=False):
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_key);
  __pyx_r = __pyx_v_key;
  goto __pyx_L0;

  /* "vapor_vali/Simple_function.pyx":890
 *         return out
 * 
 * def key_modify(key):             # <<<<<<<<<<<<<<
 *     if 'R' in key:
 *             key=key.replace('R','N')
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_AddTraceback("vapor_vali.Simple_function.key_modify", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_key);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "vapor_vali/Simple_function.pyx":933
 *     return key
 * 
 * def kmerhits(seq1, seq2, kmerlen, nth_base=1, inversions=False):             # <<<<<<<<<<<<<<
 *     # hash table for finding hits
 *     lookup = {}
 */

/* Python wrapper */
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_127kmerhits(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_10vapor_vali_15Simple_function_127kmerhits = {"kmerhits", (PyCFunction)__pyx_pw_10vapor_vali_15Simple_function_127kmerhits, METH_VARARGS|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_127kmerhits(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_seq1 = 0;
  PyObject *__pyx_v_seq2 = 0;
  PyObject *__pyx_v_kmerlen = 0;
  PyObject *__pyx_v_nth_base = 0;
  PyObject *__pyx_v_inversions = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("kmerhits (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_seq1,&__pyx_n_s_seq2,&__pyx_n_s_kmerlen,&__pyx_n_s_nth_base,&__pyx_n_s_inversions,0};
    PyObject* values[5] = {0,0,0,0,0};
    values[3] = ((PyObject *)__pyx_int_1);
    values[4] = ((PyObject *)Py_False);
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
      switch (pos_args) {
        case  5: values[4] = PyTuple_GET_ITEM(__pyx_args, 4);
        case  4: values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
        case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_seq1)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_seq2)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("kmerhits", 0, 3, 5, 1); __PYX_ERR(0, 933, __pyx_L3_error)
        }
        case  2:
        if (likely((values[2] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_kmerlen)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("kmerhits", 0, 3, 5, 2); __PYX_ERR(0, 933, __pyx_L3_error)
        }
        case  3:
        if (kw_args > 0) {
          PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_nth_base);
          if (value) { values[3] = value; kw_args--; }
        }
        case  4:
        if (kw_args > 0) {
          PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_inversions);
          if (value) { values[4] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "kmerhits") < 0)) __PYX_ERR(0, 933, __pyx_L3_error)
      }
    } else {
      switch (PyTuple_GET_SIZE(__pyx_args)) {
        case  5: values[4] = PyTuple_GET_ITEM(__pyx_args, 4);
        case  4: values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
        case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
        values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_seq1 = values[0];
    __pyx_v_seq2 = values[1];
    __pyx_v_kmerlen = values[2];
    __pyx_v_nth_base = values[3];
    __pyx_v_inversions = values[4];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("kmerhits", 0, 3, 5, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 933, __pyx_L3_error)
  __pyx_L3_error:;
  __Pyx_AddTraceback("vapor_vali.Simple_function.kmerhits", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_10vapor_vali_15Simple_function_126kmerhits(__pyx_self, __pyx_v_seq1, __pyx_v_seq2, __pyx_v_kmerlen, __pyx_v_nth_base, __pyx_v_inversions);

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10vapor_vali_15Simple_function_126kmerhits(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_seq1, PyObject *__pyx_v_seq2, PyObject *__pyx_v_kmerlen, PyObject *__pyx_v_nth_base, PyObject *__pyx_v_inversions) {
  PyObject *__pyx_v_lookup = NULL;
  PyObject *__pyx_v_seq1len = NULL;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_v_key = NULL;
  PyObject *__pyx_v_subkey = NULL;
  PyObject *__pyx_v_hits = NULL;
  PyObject *__pyx_v_subhits = NULL;
  PyObject *__pyx_v_k1 = NULL;
  PyObject *__pyx_v_hit = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  Py_ssize_t __pyx_t_2;
  PyObject *__pyx_t_3 = NULL;
  PyObject *(*__pyx_t_4)(PyObject *);
  PyObject *__pyx_t_5 = NULL;
  PyObject *__pyx_t_6 = NULL;
  Py_ssize_t __pyx_t_7;
  PyObject *__pyx_t_8 = NULL;
  PyObject *(*__pyx_t_9)(PyObject *);
  int __pyx_t_10;
  int __pyx_t_11;
  Py_ssize_t __pyx_t_12;
  PyObject *__pyx_t_13 = NULL;
  Py_ssize_t __pyx_t_14;
  PyObject *__pyx_t_15 = NULL;
  PyObject *(*__pyx_t_16)(PyObject *);
  __Pyx_RefNannySetupContext("kmerhits", 0);

  /* "vapor_vali/Simple_function.pyx":935
 * def kmerhits(seq1, seq2, kmerlen, nth_base=1, inversions=False):
 *     # hash table for finding hits
 *     lookup = {}             # <<<<<<<<<<<<<<
 *     # store sequence hashes in hash table
 *     #print ("hashing seq1...")
 */
  __pyx_t_1 = PyDict_New(); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 935, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_lookup = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":938
 *     # store sequence hashes in hash table
 *     #print ("hashing seq1...")
 *     seq1len = len(seq1)             # <<<<<<<<<<<<<<
 *     for i in range(seq1len - kmerlen + 1):
 *         key = seq1[i:i+kmerlen]
 */
  __pyx_t_2 = PyObject_Length(__pyx_v_seq1); if (unlikely(__pyx_t_2 == -1)) __PYX_ERR(0, 938, __pyx_L1_error)
  __pyx_t_1 = PyInt_FromSsize_t(__pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 938, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_seq1len = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":939
 *     #print ("hashing seq1...")
 *     seq1len = len(seq1)
 *     for i in range(seq1len - kmerlen + 1):             # <<<<<<<<<<<<<<
 *         key = seq1[i:i+kmerlen]
 *         for subkey in subkeys(key, nth_base, inversions):
 */
  __pyx_t_1 = PyNumber_Subtract(__pyx_v_seq1len, __pyx_v_kmerlen); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 939, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_3 = __Pyx_PyInt_AddObjC(__pyx_t_1, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 939, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 939, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_GIVEREF(__pyx_t_3);
  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_t_1, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 939, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  if (likely(PyList_CheckExact(__pyx_t_3)) || PyTuple_CheckExact(__pyx_t_3)) {
    __pyx_t_1 = __pyx_t_3; __Pyx_INCREF(__pyx_t_1); __pyx_t_2 = 0;
    __pyx_t_4 = NULL;
  } else {
    __pyx_t_2 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 939, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_4 = Py_TYPE(__pyx_t_1)->tp_iternext; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 939, __pyx_L1_error)
  }
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  for (;;) {
    if (likely(!__pyx_t_4)) {
      if (likely(PyList_CheckExact(__pyx_t_1))) {
        if (__pyx_t_2 >= PyList_GET_SIZE(__pyx_t_1)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_3 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_3); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 939, __pyx_L1_error)
        #else
        __pyx_t_3 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 939, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_3);
        #endif
      } else {
        if (__pyx_t_2 >= PyTuple_GET_SIZE(__pyx_t_1)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_3 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_3); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 939, __pyx_L1_error)
        #else
        __pyx_t_3 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 939, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_3);
        #endif
      }
    } else {
      __pyx_t_3 = __pyx_t_4(__pyx_t_1);
      if (unlikely(!__pyx_t_3)) {
        PyObject* exc_type = PyErr_Occurred();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
          else __PYX_ERR(0, 939, __pyx_L1_error)
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_3);
    }
    __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_3);
    __pyx_t_3 = 0;

    /* "vapor_vali/Simple_function.pyx":940
 *     seq1len = len(seq1)
 *     for i in range(seq1len - kmerlen + 1):
 *         key = seq1[i:i+kmerlen]             # <<<<<<<<<<<<<<
 *         for subkey in subkeys(key, nth_base, inversions):
 *             lookup.setdefault(subkey, []).append(i)
 */
    __pyx_t_3 = PyNumber_Add(__pyx_v_i, __pyx_v_kmerlen); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 940, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_5 = __Pyx_PyObject_GetSlice(__pyx_v_seq1, 0, 0, &__pyx_v_i, &__pyx_t_3, NULL, 0, 0, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 940, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __Pyx_XDECREF_SET(__pyx_v_key, __pyx_t_5);
    __pyx_t_5 = 0;

    /* "vapor_vali/Simple_function.pyx":941
 *     for i in range(seq1len - kmerlen + 1):
 *         key = seq1[i:i+kmerlen]
 *         for subkey in subkeys(key, nth_base, inversions):             # <<<<<<<<<<<<<<
 *             lookup.setdefault(subkey, []).append(i)
 *     # match every nth base by look up hashes in hash table
 */
    __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_subkeys); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 941, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_6 = NULL;
    __pyx_t_7 = 0;
    if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_3))) {
      __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_3);
      if (likely(__pyx_t_6)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
        __Pyx_INCREF(__pyx_t_6);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_3, function);
        __pyx_t_7 = 1;
      }
    }
    __pyx_t_8 = PyTuple_New(3+__pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 941, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_8);
    if (__pyx_t_6) {
      __Pyx_GIVEREF(__pyx_t_6); PyTuple_SET_ITEM(__pyx_t_8, 0, __pyx_t_6); __pyx_t_6 = NULL;
    }
    __Pyx_INCREF(__pyx_v_key);
    __Pyx_GIVEREF(__pyx_v_key);
    PyTuple_SET_ITEM(__pyx_t_8, 0+__pyx_t_7, __pyx_v_key);
    __Pyx_INCREF(__pyx_v_nth_base);
    __Pyx_GIVEREF(__pyx_v_nth_base);
    PyTuple_SET_ITEM(__pyx_t_8, 1+__pyx_t_7, __pyx_v_nth_base);
    __Pyx_INCREF(__pyx_v_inversions);
    __Pyx_GIVEREF(__pyx_v_inversions);
    PyTuple_SET_ITEM(__pyx_t_8, 2+__pyx_t_7, __pyx_v_inversions);
    __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_8, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 941, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    if (likely(PyList_CheckExact(__pyx_t_5)) || PyTuple_CheckExact(__pyx_t_5)) {
      __pyx_t_3 = __pyx_t_5; __Pyx_INCREF(__pyx_t_3); __pyx_t_7 = 0;
      __pyx_t_9 = NULL;
    } else {
      __pyx_t_7 = -1; __pyx_t_3 = PyObject_GetIter(__pyx_t_5); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 941, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __pyx_t_9 = Py_TYPE(__pyx_t_3)->tp_iternext; if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 941, __pyx_L1_error)
    }
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    for (;;) {
      if (likely(!__pyx_t_9)) {
        if (likely(PyList_CheckExact(__pyx_t_3))) {
          if (__pyx_t_7 >= PyList_GET_SIZE(__pyx_t_3)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_5 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_7); __Pyx_INCREF(__pyx_t_5); __pyx_t_7++; if (unlikely(0 < 0)) __PYX_ERR(0, 941, __pyx_L1_error)
          #else
          __pyx_t_5 = PySequence_ITEM(__pyx_t_3, __pyx_t_7); __pyx_t_7++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 941, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_5);
          #endif
        } else {
          if (__pyx_t_7 >= PyTuple_GET_SIZE(__pyx_t_3)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_5 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_7); __Pyx_INCREF(__pyx_t_5); __pyx_t_7++; if (unlikely(0 < 0)) __PYX_ERR(0, 941, __pyx_L1_error)
          #else
          __pyx_t_5 = PySequence_ITEM(__pyx_t_3, __pyx_t_7); __pyx_t_7++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 941, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_5);
          #endif
        }
      } else {
        __pyx_t_5 = __pyx_t_9(__pyx_t_3);
        if (unlikely(!__pyx_t_5)) {
          PyObject* exc_type = PyErr_Occurred();
          if (exc_type) {
            if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
            else __PYX_ERR(0, 941, __pyx_L1_error)
          }
          break;
        }
        __Pyx_GOTREF(__pyx_t_5);
      }
      __Pyx_XDECREF_SET(__pyx_v_subkey, __pyx_t_5);
      __pyx_t_5 = 0;

      /* "vapor_vali/Simple_function.pyx":942
 *         key = seq1[i:i+kmerlen]
 *         for subkey in subkeys(key, nth_base, inversions):
 *             lookup.setdefault(subkey, []).append(i)             # <<<<<<<<<<<<<<
 *     # match every nth base by look up hashes in hash table
 *     #print ("hashing seq2...")
 */
      __pyx_t_5 = PyList_New(0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 942, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_5);
      __pyx_t_8 = __Pyx_PyDict_SetDefault(__pyx_v_lookup, __pyx_v_subkey, __pyx_t_5, -1L); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 942, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_8);
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
      __pyx_t_10 = __Pyx_PyObject_Append(__pyx_t_8, __pyx_v_i); if (unlikely(__pyx_t_10 == -1)) __PYX_ERR(0, 942, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;

      /* "vapor_vali/Simple_function.pyx":941
 *     for i in range(seq1len - kmerlen + 1):
 *         key = seq1[i:i+kmerlen]
 *         for subkey in subkeys(key, nth_base, inversions):             # <<<<<<<<<<<<<<
 *             lookup.setdefault(subkey, []).append(i)
 *     # match every nth base by look up hashes in hash table
 */
    }
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;

    /* "vapor_vali/Simple_function.pyx":939
 *     #print ("hashing seq1...")
 *     seq1len = len(seq1)
 *     for i in range(seq1len - kmerlen + 1):             # <<<<<<<<<<<<<<
 *         key = seq1[i:i+kmerlen]
 *         for subkey in subkeys(key, nth_base, inversions):
 */
  }
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":945
 *     # match every nth base by look up hashes in hash table
 *     #print ("hashing seq2...")
 *     hits = []             # <<<<<<<<<<<<<<
 *     for i in range(len(seq2) - kmerlen + 1):
 *         key = seq2[i:i+kmerlen]
 */
  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 945, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_hits = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":946
 *     #print ("hashing seq2...")
 *     hits = []
 *     for i in range(len(seq2) - kmerlen + 1):             # <<<<<<<<<<<<<<
 *         key = seq2[i:i+kmerlen]
 *         # only need to specify inversions for one seq
 */
  __pyx_t_2 = PyObject_Length(__pyx_v_seq2); if (unlikely(__pyx_t_2 == -1)) __PYX_ERR(0, 946, __pyx_L1_error)
  __pyx_t_1 = PyInt_FromSsize_t(__pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 946, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_3 = PyNumber_Subtract(__pyx_t_1, __pyx_v_kmerlen); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 946, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_PyInt_AddObjC(__pyx_t_3, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 946, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 946, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_GIVEREF(__pyx_t_1);
  PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_t_3, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 946, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  if (likely(PyList_CheckExact(__pyx_t_1)) || PyTuple_CheckExact(__pyx_t_1)) {
    __pyx_t_3 = __pyx_t_1; __Pyx_INCREF(__pyx_t_3); __pyx_t_2 = 0;
    __pyx_t_4 = NULL;
  } else {
    __pyx_t_2 = -1; __pyx_t_3 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 946, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_4 = Py_TYPE(__pyx_t_3)->tp_iternext; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 946, __pyx_L1_error)
  }
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  for (;;) {
    if (likely(!__pyx_t_4)) {
      if (likely(PyList_CheckExact(__pyx_t_3))) {
        if (__pyx_t_2 >= PyList_GET_SIZE(__pyx_t_3)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_1 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_2); __Pyx_INCREF(__pyx_t_1); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 946, __pyx_L1_error)
        #else
        __pyx_t_1 = PySequence_ITEM(__pyx_t_3, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 946, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        #endif
      } else {
        if (__pyx_t_2 >= PyTuple_GET_SIZE(__pyx_t_3)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_2); __Pyx_INCREF(__pyx_t_1); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 946, __pyx_L1_error)
        #else
        __pyx_t_1 = PySequence_ITEM(__pyx_t_3, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 946, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        #endif
      }
    } else {
      __pyx_t_1 = __pyx_t_4(__pyx_t_3);
      if (unlikely(!__pyx_t_1)) {
        PyObject* exc_type = PyErr_Occurred();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
          else __PYX_ERR(0, 946, __pyx_L1_error)
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_1);
    }
    __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_1);
    __pyx_t_1 = 0;

    /* "vapor_vali/Simple_function.pyx":947
 *     hits = []
 *     for i in range(len(seq2) - kmerlen + 1):
 *         key = seq2[i:i+kmerlen]             # <<<<<<<<<<<<<<
 *         # only need to specify inversions for one seq
 *         for subkey in subkeys(key, nth_base, False):
 */
    __pyx_t_1 = PyNumber_Add(__pyx_v_i, __pyx_v_kmerlen); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 947, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_8 = __Pyx_PyObject_GetSlice(__pyx_v_seq2, 0, 0, &__pyx_v_i, &__pyx_t_1, NULL, 0, 0, 1); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 947, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_8);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __Pyx_XDECREF_SET(__pyx_v_key, __pyx_t_8);
    __pyx_t_8 = 0;

    /* "vapor_vali/Simple_function.pyx":949
 *         key = seq2[i:i+kmerlen]
 *         # only need to specify inversions for one seq
 *         for subkey in subkeys(key, nth_base, False):             # <<<<<<<<<<<<<<
 *             subhits = []
 *             if kmerlen>40:
 */
    __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_subkeys); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 949, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_5 = NULL;
    __pyx_t_7 = 0;
    if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_1))) {
      __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_1);
      if (likely(__pyx_t_5)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
        __Pyx_INCREF(__pyx_t_5);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_1, function);
        __pyx_t_7 = 1;
      }
    }
    __pyx_t_6 = PyTuple_New(3+__pyx_t_7); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 949, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    if (__pyx_t_5) {
      __Pyx_GIVEREF(__pyx_t_5); PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_5); __pyx_t_5 = NULL;
    }
    __Pyx_INCREF(__pyx_v_key);
    __Pyx_GIVEREF(__pyx_v_key);
    PyTuple_SET_ITEM(__pyx_t_6, 0+__pyx_t_7, __pyx_v_key);
    __Pyx_INCREF(__pyx_v_nth_base);
    __Pyx_GIVEREF(__pyx_v_nth_base);
    PyTuple_SET_ITEM(__pyx_t_6, 1+__pyx_t_7, __pyx_v_nth_base);
    __Pyx_INCREF(Py_False);
    __Pyx_GIVEREF(Py_False);
    PyTuple_SET_ITEM(__pyx_t_6, 2+__pyx_t_7, Py_False);
    __pyx_t_8 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_6, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 949, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_8);
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    if (likely(PyList_CheckExact(__pyx_t_8)) || PyTuple_CheckExact(__pyx_t_8)) {
      __pyx_t_1 = __pyx_t_8; __Pyx_INCREF(__pyx_t_1); __pyx_t_7 = 0;
      __pyx_t_9 = NULL;
    } else {
      __pyx_t_7 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_t_8); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 949, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __pyx_t_9 = Py_TYPE(__pyx_t_1)->tp_iternext; if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 949, __pyx_L1_error)
    }
    __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
    for (;;) {
      if (likely(!__pyx_t_9)) {
        if (likely(PyList_CheckExact(__pyx_t_1))) {
          if (__pyx_t_7 >= PyList_GET_SIZE(__pyx_t_1)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_8 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_7); __Pyx_INCREF(__pyx_t_8); __pyx_t_7++; if (unlikely(0 < 0)) __PYX_ERR(0, 949, __pyx_L1_error)
          #else
          __pyx_t_8 = PySequence_ITEM(__pyx_t_1, __pyx_t_7); __pyx_t_7++; if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 949, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_8);
          #endif
        } else {
          if (__pyx_t_7 >= PyTuple_GET_SIZE(__pyx_t_1)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_8 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_7); __Pyx_INCREF(__pyx_t_8); __pyx_t_7++; if (unlikely(0 < 0)) __PYX_ERR(0, 949, __pyx_L1_error)
          #else
          __pyx_t_8 = PySequence_ITEM(__pyx_t_1, __pyx_t_7); __pyx_t_7++; if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 949, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_8);
          #endif
        }
      } else {
        __pyx_t_8 = __pyx_t_9(__pyx_t_1);
        if (unlikely(!__pyx_t_8)) {
          PyObject* exc_type = PyErr_Occurred();
          if (exc_type) {
            if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
            else __PYX_ERR(0, 949, __pyx_L1_error)
          }
          break;
        }
        __Pyx_GOTREF(__pyx_t_8);
      }
      __Pyx_XDECREF_SET(__pyx_v_subkey, __pyx_t_8);
      __pyx_t_8 = 0;

      /* "vapor_vali/Simple_function.pyx":950
 *         # only need to specify inversions for one seq
 *         for subkey in subkeys(key, nth_base, False):
 *             subhits = []             # <<<<<<<<<<<<<<
 *             if kmerlen>40:
 *                 print(('Window size:' +str(kmerlen)))
 */
      __pyx_t_8 = PyList_New(0); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 950, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_8);
      __Pyx_XDECREF_SET(__pyx_v_subhits, __pyx_t_8);
      __pyx_t_8 = 0;

      /* "vapor_vali/Simple_function.pyx":951
 *         for subkey in subkeys(key, nth_base, False):
 *             subhits = []
 *             if kmerlen>40:             # <<<<<<<<<<<<<<
 *                 print(('Window size:' +str(kmerlen)))
 *                 for k1 in list(lookup.keys()):
 */
      __pyx_t_8 = PyObject_RichCompare(__pyx_v_kmerlen, __pyx_int_40, Py_GT); __Pyx_XGOTREF(__pyx_t_8); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 951, __pyx_L1_error)
      __pyx_t_11 = __Pyx_PyObject_IsTrue(__pyx_t_8); if (unlikely(__pyx_t_11 < 0)) __PYX_ERR(0, 951, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
      if (__pyx_t_11) {

        /* "vapor_vali/Simple_function.pyx":952
 *             subhits = []
 *             if kmerlen>40:
 *                 print(('Window size:' +str(kmerlen)))             # <<<<<<<<<<<<<<
 *                 for k1 in list(lookup.keys()):
 *                     if edit_dis_setup(k1,subkey)<int(kmerlen/10)+1:
 */
        __pyx_t_8 = PyTuple_New(1); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 952, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_8);
        __Pyx_INCREF(__pyx_v_kmerlen);
        __Pyx_GIVEREF(__pyx_v_kmerlen);
        PyTuple_SET_ITEM(__pyx_t_8, 0, __pyx_v_kmerlen);
        __pyx_t_6 = __Pyx_PyObject_Call(((PyObject *)(&PyString_Type)), __pyx_t_8, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 952, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_6);
        __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
        __pyx_t_8 = PyNumber_Add(__pyx_kp_s_Window_size, __pyx_t_6); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 952, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_8);
        __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
        __pyx_t_6 = PyTuple_New(1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 952, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_6);
        __Pyx_GIVEREF(__pyx_t_8);
        PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_8);
        __pyx_t_8 = 0;
        __pyx_t_8 = __Pyx_PyObject_Call(__pyx_builtin_print, __pyx_t_6, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 952, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_8);
        __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
        __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;

        /* "vapor_vali/Simple_function.pyx":953
 *             if kmerlen>40:
 *                 print(('Window size:' +str(kmerlen)))
 *                 for k1 in list(lookup.keys()):             # <<<<<<<<<<<<<<
 *                     if edit_dis_setup(k1,subkey)<int(kmerlen/10)+1:
 *                         subhits+=lookup[k1]
 */
        __pyx_t_8 = __Pyx_PyDict_Keys(__pyx_v_lookup); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 953, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_8);
        __pyx_t_6 = PySequence_List(__pyx_t_8); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 953, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_6);
        __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
        __pyx_t_8 = __pyx_t_6; __Pyx_INCREF(__pyx_t_8); __pyx_t_12 = 0;
        __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
        for (;;) {
          if (__pyx_t_12 >= PyList_GET_SIZE(__pyx_t_8)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_6 = PyList_GET_ITEM(__pyx_t_8, __pyx_t_12); __Pyx_INCREF(__pyx_t_6); __pyx_t_12++; if (unlikely(0 < 0)) __PYX_ERR(0, 953, __pyx_L1_error)
          #else
          __pyx_t_6 = PySequence_ITEM(__pyx_t_8, __pyx_t_12); __pyx_t_12++; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 953, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_6);
          #endif
          __Pyx_XDECREF_SET(__pyx_v_k1, __pyx_t_6);
          __pyx_t_6 = 0;

          /* "vapor_vali/Simple_function.pyx":954
 *                 print(('Window size:' +str(kmerlen)))
 *                 for k1 in list(lookup.keys()):
 *                     if edit_dis_setup(k1,subkey)<int(kmerlen/10)+1:             # <<<<<<<<<<<<<<
 *                         subhits+=lookup[k1]
 *             else:
 */
          __pyx_t_5 = __Pyx_GetModuleGlobalName(__pyx_n_s_edit_dis_setup); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 954, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_5);
          __pyx_t_13 = NULL;
          __pyx_t_14 = 0;
          if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_5))) {
            __pyx_t_13 = PyMethod_GET_SELF(__pyx_t_5);
            if (likely(__pyx_t_13)) {
              PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
              __Pyx_INCREF(__pyx_t_13);
              __Pyx_INCREF(function);
              __Pyx_DECREF_SET(__pyx_t_5, function);
              __pyx_t_14 = 1;
            }
          }
          __pyx_t_15 = PyTuple_New(2+__pyx_t_14); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 954, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_15);
          if (__pyx_t_13) {
            __Pyx_GIVEREF(__pyx_t_13); PyTuple_SET_ITEM(__pyx_t_15, 0, __pyx_t_13); __pyx_t_13 = NULL;
          }
          __Pyx_INCREF(__pyx_v_k1);
          __Pyx_GIVEREF(__pyx_v_k1);
          PyTuple_SET_ITEM(__pyx_t_15, 0+__pyx_t_14, __pyx_v_k1);
          __Pyx_INCREF(__pyx_v_subkey);
          __Pyx_GIVEREF(__pyx_v_subkey);
          PyTuple_SET_ITEM(__pyx_t_15, 1+__pyx_t_14, __pyx_v_subkey);
          __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_15, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 954, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_6);
          __Pyx_DECREF(__pyx_t_15); __pyx_t_15 = 0;
          __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
          __pyx_t_5 = __Pyx_PyNumber_Divide(__pyx_v_kmerlen, __pyx_int_10); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 954, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_5);
          __pyx_t_15 = __Pyx_PyNumber_Int(__pyx_t_5); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 954, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_15);
          __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
          __pyx_t_5 = __Pyx_PyInt_AddObjC(__pyx_t_15, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 954, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_5);
          __Pyx_DECREF(__pyx_t_15); __pyx_t_15 = 0;
          __pyx_t_15 = PyObject_RichCompare(__pyx_t_6, __pyx_t_5, Py_LT); __Pyx_XGOTREF(__pyx_t_15); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 954, __pyx_L1_error)
          __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
          __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
          __pyx_t_11 = __Pyx_PyObject_IsTrue(__pyx_t_15); if (unlikely(__pyx_t_11 < 0)) __PYX_ERR(0, 954, __pyx_L1_error)
          __Pyx_DECREF(__pyx_t_15); __pyx_t_15 = 0;
          if (__pyx_t_11) {

            /* "vapor_vali/Simple_function.pyx":955
 *                 for k1 in list(lookup.keys()):
 *                     if edit_dis_setup(k1,subkey)<int(kmerlen/10)+1:
 *                         subhits+=lookup[k1]             # <<<<<<<<<<<<<<
 *             else:
 *                 subhits=lookup.get(subkey,[])
 */
            __pyx_t_15 = __Pyx_PyDict_GetItem(__pyx_v_lookup, __pyx_v_k1); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 955, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_15);
            __pyx_t_5 = PyNumber_InPlaceAdd(__pyx_v_subhits, __pyx_t_15); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 955, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_5);
            __Pyx_DECREF(__pyx_t_15); __pyx_t_15 = 0;
            __Pyx_DECREF_SET(__pyx_v_subhits, __pyx_t_5);
            __pyx_t_5 = 0;

            /* "vapor_vali/Simple_function.pyx":954
 *                 print(('Window size:' +str(kmerlen)))
 *                 for k1 in list(lookup.keys()):
 *                     if edit_dis_setup(k1,subkey)<int(kmerlen/10)+1:             # <<<<<<<<<<<<<<
 *                         subhits+=lookup[k1]
 *             else:
 */
          }

          /* "vapor_vali/Simple_function.pyx":953
 *             if kmerlen>40:
 *                 print(('Window size:' +str(kmerlen)))
 *                 for k1 in list(lookup.keys()):             # <<<<<<<<<<<<<<
 *                     if edit_dis_setup(k1,subkey)<int(kmerlen/10)+1:
 *                         subhits+=lookup[k1]
 */
        }
        __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;

        /* "vapor_vali/Simple_function.pyx":951
 *         for subkey in subkeys(key, nth_base, False):
 *             subhits = []
 *             if kmerlen>40:             # <<<<<<<<<<<<<<
 *                 print(('Window size:' +str(kmerlen)))
 *                 for k1 in list(lookup.keys()):
 */
        goto __pyx_L11;
      }

      /* "vapor_vali/Simple_function.pyx":957
 *                         subhits+=lookup[k1]
 *             else:
 *                 subhits=lookup.get(subkey,[])             # <<<<<<<<<<<<<<
 *             if subhits != []:
 *                 # store hits to hits list
 */
      /*else*/ {
        __pyx_t_8 = PyList_New(0); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 957, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_8);
        __pyx_t_5 = __Pyx_PyDict_GetItemDefault(__pyx_v_lookup, __pyx_v_subkey, __pyx_t_8); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 957, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_5);
        __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
        __Pyx_DECREF_SET(__pyx_v_subhits, __pyx_t_5);
        __pyx_t_5 = 0;
      }
      __pyx_L11:;

      /* "vapor_vali/Simple_function.pyx":958
 *             else:
 *                 subhits=lookup.get(subkey,[])
 *             if subhits != []:             # <<<<<<<<<<<<<<
 *                 # store hits to hits list
 *                 for hit in subhits:
 */
      __pyx_t_5 = PyList_New(0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 958, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_5);
      __pyx_t_8 = PyObject_RichCompare(__pyx_v_subhits, __pyx_t_5, Py_NE); __Pyx_XGOTREF(__pyx_t_8); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 958, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
      __pyx_t_11 = __Pyx_PyObject_IsTrue(__pyx_t_8); if (unlikely(__pyx_t_11 < 0)) __PYX_ERR(0, 958, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
      if (__pyx_t_11) {

        /* "vapor_vali/Simple_function.pyx":960
 *             if subhits != []:
 *                 # store hits to hits list
 *                 for hit in subhits:             # <<<<<<<<<<<<<<
 *                     hits.append((i, hit))
 *                 # break out of loop to avoid doubly counting
 */
        if (likely(PyList_CheckExact(__pyx_v_subhits)) || PyTuple_CheckExact(__pyx_v_subhits)) {
          __pyx_t_8 = __pyx_v_subhits; __Pyx_INCREF(__pyx_t_8); __pyx_t_12 = 0;
          __pyx_t_16 = NULL;
        } else {
          __pyx_t_12 = -1; __pyx_t_8 = PyObject_GetIter(__pyx_v_subhits); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 960, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_8);
          __pyx_t_16 = Py_TYPE(__pyx_t_8)->tp_iternext; if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 960, __pyx_L1_error)
        }
        for (;;) {
          if (likely(!__pyx_t_16)) {
            if (likely(PyList_CheckExact(__pyx_t_8))) {
              if (__pyx_t_12 >= PyList_GET_SIZE(__pyx_t_8)) break;
              #if CYTHON_COMPILING_IN_CPYTHON
              __pyx_t_5 = PyList_GET_ITEM(__pyx_t_8, __pyx_t_12); __Pyx_INCREF(__pyx_t_5); __pyx_t_12++; if (unlikely(0 < 0)) __PYX_ERR(0, 960, __pyx_L1_error)
              #else
              __pyx_t_5 = PySequence_ITEM(__pyx_t_8, __pyx_t_12); __pyx_t_12++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 960, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_5);
              #endif
            } else {
              if (__pyx_t_12 >= PyTuple_GET_SIZE(__pyx_t_8)) break;
              #if CYTHON_COMPILING_IN_CPYTHON
              __pyx_t_5 = PyTuple_GET_ITEM(__pyx_t_8, __pyx_t_12); __Pyx_INCREF(__pyx_t_5); __pyx_t_12++; if (unlikely(0 < 0)) __PYX_ERR(0, 960, __pyx_L1_error)
              #else
              __pyx_t_5 = PySequence_ITEM(__pyx_t_8, __pyx_t_12); __pyx_t_12++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 960, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_5);
              #endif
            }
          } else {
            __pyx_t_5 = __pyx_t_16(__pyx_t_8);
            if (unlikely(!__pyx_t_5)) {
              PyObject* exc_type = PyErr_Occurred();
              if (exc_type) {
                if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
                else __PYX_ERR(0, 960, __pyx_L1_error)
              }
              break;
            }
            __Pyx_GOTREF(__pyx_t_5);
          }
          __Pyx_XDECREF_SET(__pyx_v_hit, __pyx_t_5);
          __pyx_t_5 = 0;

          /* "vapor_vali/Simple_function.pyx":961
 *                 # store hits to hits list
 *                 for hit in subhits:
 *                     hits.append((i, hit))             # <<<<<<<<<<<<<<
 *                 # break out of loop to avoid doubly counting
 *                 # exact matches
 */
          __pyx_t_5 = PyTuple_New(2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 961, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_5);
          __Pyx_INCREF(__pyx_v_i);
          __Pyx_GIVEREF(__pyx_v_i);
          PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_v_i);
          __Pyx_INCREF(__pyx_v_hit);
          __Pyx_GIVEREF(__pyx_v_hit);
          PyTuple_SET_ITEM(__pyx_t_5, 1, __pyx_v_hit);
          __pyx_t_10 = __Pyx_PyList_Append(__pyx_v_hits, __pyx_t_5); if (unlikely(__pyx_t_10 == -1)) __PYX_ERR(0, 961, __pyx_L1_error)
          __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;

          /* "vapor_vali/Simple_function.pyx":960
 *             if subhits != []:
 *                 # store hits to hits list
 *                 for hit in subhits:             # <<<<<<<<<<<<<<
 *                     hits.append((i, hit))
 *                 # break out of loop to avoid doubly counting
 */
        }
        __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;

        /* "vapor_vali/Simple_function.pyx":964
 *                 # break out of loop to avoid doubly counting
 *                 # exact matches
 *                 break             # <<<<<<<<<<<<<<
 *     return hits
 * 
 */
        goto __pyx_L10_break;

        /* "vapor_vali/Simple_function.pyx":958
 *             else:
 *                 subhits=lookup.get(subkey,[])
 *             if subhits != []:             # <<<<<<<<<<<<<<
 *                 # store hits to hits list
 *                 for hit in subhits:
 */
      }

      /* "vapor_vali/Simple_function.pyx":949
 *         key = seq2[i:i+kmerlen]
 *         # only need to specify inversions for one seq
 *         for subkey in subkeys(key, nth_base, False):             # <<<<<<<<<<<<<<
 *             subhits = []
 *             if kmerlen>40:
 */
    }
    __pyx_L10_break:;
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "vapor_vali/Simple_function.pyx":946
 *     #print ("hashing seq2...")
 *     hits = []
 *     for i in range(len(seq2) - kmerlen + 1):             # <<<<<<<<<<<<<<
 *         key = seq2[i:i+kmerlen]
 *         # only need to specify inversions for one seq
 */
  }
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;

  /* "vapor_vali/Simple_function.pyx":965
 *                 # exact matches
 *                 break
 *     return hits             # <<<<<<<<<<<<<<
 * 
 * def let_to_block_info(let,let_hash,chromos):
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_hits);
  __pyx_r = __pyx_v_hits;
  goto __pyx_L0;

  /* "vapor_vali/Simple_function.pyx":933
 *     return key
 * 
 * def kmerhits(seq1, seq2, kmerlen, nth_base=1, inversions=False):             # <<<<<<<<<<<<<<
 *     # hash table for finding hits
 *     lookup = {}
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_XDECREF(__pyx_t_8);
  __Pyx_XDECREF(__pyx_t_13);
  __Pyx_XDECREF(__pyx_t_15);
  __Pyx_AddTraceback("vapor_vali.Simple_function.kmerhits", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_lookup);
  __Pyx_XDECREF(__pyx_v_seq1len);
  __Pyx_XDECREF(__pyx_v_i);
  __Pyx_XDECREF(__pyx_v_key);
  __Pyx_XDECREF(__pyx_v_subkey);
  __Pyx_XDECREF(__pyx_v_hits);
  __Pyx_XDECREF(__pyx_v_subhits);
  __Pyx_XDECREF(__pyx_v_k1);
  __Pyx_XDECREF(__pyx_v_hit);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "vapor_vali/Simple_function.pyx":967
 *     return hits
 * 
 * def let_to_block_info(let,let_hash,chromos):             # <<<<<<<<<<<<<<
 *     #eg of let='ab'; eg of let_hash={'a': ['chrY', '10818935', '10819073'], 'b': ['chrY', '10819073', '10926507'], '+': ['chrY', '10926507', '10927007'], '-': ['chrY', '10818435', 10818935]}
 *     out=[]
 */

/* Python wrapper */
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_129let_to_block_info(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_10vapor_vali_15Simple_function_129let_to_block_info = {"let_to_block_info", (PyCFunction)__pyx_pw_10vapor_vali_15Simple_function_129let_to_block_info, METH_VARARGS|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_129let_to_block_info(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_let = 0;
  PyObject *__pyx_v_let_hash = 0;
  PyObject *__pyx_v_chromos = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("let_to_block_info (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_let,&__pyx_n_s_let_hash,&__pyx_n_s_chromos,0};
    PyObject* values[3] = {0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
      switch (pos_args) {
        case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_let)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_let_hash)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("let_to_block_info", 1, 3, 3, 1); __PYX_ERR(0, 967, __pyx_L3_error)
        }
        case  2:
        if (likely((values[2] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_chromos)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("let_to_block_info", 1, 3, 3, 2); __PYX_ERR(0, 967, __pyx_L3_error)
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "let_to_block_info") < 0)) __PYX_ERR(0, 967, __pyx_L3_error)
      }
    } else if (PyTuple_GET_SIZE(__pyx_args) != 3) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
    }
    __pyx_v_let = values[0];
    __pyx_v_let_hash = values[1];
    __pyx_v_chromos = values[2];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("let_to_block_info", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 967, __pyx_L3_error)
  __pyx_L3_error:;
  __Pyx_AddTraceback("vapor_vali.Simple_function.let_to_block_info", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_10vapor_vali_15Simple_function_128let_to_block_info(__pyx_self, __pyx_v_let, __pyx_v_let_hash, __pyx_v_chromos);

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10vapor_vali_15Simple_function_128let_to_block_info(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_let, PyObject *__pyx_v_let_hash, PyObject *__pyx_v_chromos) {
  PyObject *__pyx_v_out = NULL;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  Py_ssize_t __pyx_t_2;
  PyObject *(*__pyx_t_3)(PyObject *);
  PyObject *__pyx_t_4 = NULL;
  int __pyx_t_5;
  int __pyx_t_6;
  PyObject *__pyx_t_7 = NULL;
  PyObject *__pyx_t_8 = NULL;
  __Pyx_RefNannySetupContext("let_to_block_info", 0);

  /* "vapor_vali/Simple_function.pyx":969
 * def let_to_block_info(let,let_hash,chromos):
 *     #eg of let='ab'; eg of let_hash={'a': ['chrY', '10818935', '10819073'], 'b': ['chrY', '10819073', '10926507'], '+': ['chrY', '10926507', '10927007'], '-': ['chrY', '10818435', 10818935]}
 *     out=[]             # <<<<<<<<<<<<<<
 *     for i in let:
 *         if not i=='^':
 */
  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 969, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_out = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":970
 *     #eg of let='ab'; eg of let_hash={'a': ['chrY', '10818935', '10819073'], 'b': ['chrY', '10819073', '10926507'], '+': ['chrY', '10926507', '10927007'], '-': ['chrY', '10818435', 10818935]}
 *     out=[]
 *     for i in let:             # <<<<<<<<<<<<<<
 *         if not i=='^':
 *             out+=let_hash[i]
 */
  if (likely(PyList_CheckExact(__pyx_v_let)) || PyTuple_CheckExact(__pyx_v_let)) {
    __pyx_t_1 = __pyx_v_let; __Pyx_INCREF(__pyx_t_1); __pyx_t_2 = 0;
    __pyx_t_3 = NULL;
  } else {
    __pyx_t_2 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_v_let); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 970, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_3 = Py_TYPE(__pyx_t_1)->tp_iternext; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 970, __pyx_L1_error)
  }
  for (;;) {
    if (likely(!__pyx_t_3)) {
      if (likely(PyList_CheckExact(__pyx_t_1))) {
        if (__pyx_t_2 >= PyList_GET_SIZE(__pyx_t_1)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_4 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_4); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 970, __pyx_L1_error)
        #else
        __pyx_t_4 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 970, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_4);
        #endif
      } else {
        if (__pyx_t_2 >= PyTuple_GET_SIZE(__pyx_t_1)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_4 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_4); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 970, __pyx_L1_error)
        #else
        __pyx_t_4 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 970, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_4);
        #endif
      }
    } else {
      __pyx_t_4 = __pyx_t_3(__pyx_t_1);
      if (unlikely(!__pyx_t_4)) {
        PyObject* exc_type = PyErr_Occurred();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
          else __PYX_ERR(0, 970, __pyx_L1_error)
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_4);
    }
    __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_4);
    __pyx_t_4 = 0;

    /* "vapor_vali/Simple_function.pyx":971
 *     out=[]
 *     for i in let:
 *         if not i=='^':             # <<<<<<<<<<<<<<
 *             out+=let_hash[i]
 *     return(block_modify(out,chromos))
 */
    __pyx_t_5 = (__Pyx_PyString_Equals(__pyx_v_i, __pyx_kp_s__7, Py_EQ)); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 971, __pyx_L1_error)
    __pyx_t_6 = ((!__pyx_t_5) != 0);
    if (__pyx_t_6) {

      /* "vapor_vali/Simple_function.pyx":972
 *     for i in let:
 *         if not i=='^':
 *             out+=let_hash[i]             # <<<<<<<<<<<<<<
 *     return(block_modify(out,chromos))
 * 
 */
      __pyx_t_4 = PyObject_GetItem(__pyx_v_let_hash, __pyx_v_i); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 972, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_t_7 = PyNumber_InPlaceAdd(__pyx_v_out, __pyx_t_4); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 972, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_7);
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      __Pyx_DECREF_SET(__pyx_v_out, __pyx_t_7);
      __pyx_t_7 = 0;

      /* "vapor_vali/Simple_function.pyx":971
 *     out=[]
 *     for i in let:
 *         if not i=='^':             # <<<<<<<<<<<<<<
 *             out+=let_hash[i]
 *     return(block_modify(out,chromos))
 */
    }

    /* "vapor_vali/Simple_function.pyx":970
 *     #eg of let='ab'; eg of let_hash={'a': ['chrY', '10818935', '10819073'], 'b': ['chrY', '10819073', '10926507'], '+': ['chrY', '10926507', '10927007'], '-': ['chrY', '10818435', 10818935]}
 *     out=[]
 *     for i in let:             # <<<<<<<<<<<<<<
 *         if not i=='^':
 *             out+=let_hash[i]
 */
  }
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":973
 *         if not i=='^':
 *             out+=let_hash[i]
 *     return(block_modify(out,chromos))             # <<<<<<<<<<<<<<
 * 
 * def letter_subgroup(k2_hap):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_7 = __Pyx_GetModuleGlobalName(__pyx_n_s_block_modify); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 973, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  __pyx_t_4 = NULL;
  __pyx_t_2 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_7))) {
    __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_7);
    if (likely(__pyx_t_4)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_7);
      __Pyx_INCREF(__pyx_t_4);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_7, function);
      __pyx_t_2 = 1;
    }
  }
  __pyx_t_8 = PyTuple_New(2+__pyx_t_2); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 973, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_8);
  if (__pyx_t_4) {
    __Pyx_GIVEREF(__pyx_t_4); PyTuple_SET_ITEM(__pyx_t_8, 0, __pyx_t_4); __pyx_t_4 = NULL;
  }
  __Pyx_INCREF(__pyx_v_out);
  __Pyx_GIVEREF(__pyx_v_out);
  PyTuple_SET_ITEM(__pyx_t_8, 0+__pyx_t_2, __pyx_v_out);
  __Pyx_INCREF(__pyx_v_chromos);
  __Pyx_GIVEREF(__pyx_v_chromos);
  PyTuple_SET_ITEM(__pyx_t_8, 1+__pyx_t_2, __pyx_v_chromos);
  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_7, __pyx_t_8, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 973, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* "vapor_vali/Simple_function.pyx":967
 *     return hits
 * 
 * def let_to_block_info(let,let_hash,chromos):             # <<<<<<<<<<<<<<
 *     #eg of let='ab'; eg of let_hash={'a': ['chrY', '10818935', '10819073'], 'b': ['chrY', '10819073', '10926507'], '+': ['chrY', '10926507', '10927007'], '-': ['chrY', '10818435', 10818935]}
 *     out=[]
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_7);
  __Pyx_XDECREF(__pyx_t_8);
  __Pyx_AddTraceback("vapor_vali.Simple_function.let_to_block_info", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_out);
  __Pyx_XDECREF(__pyx_v_i);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "vapor_vali/Simple_function.pyx":975
 *     return(block_modify(out,chromos))
 * 
 * def letter_subgroup(k2_hap):             # <<<<<<<<<<<<<<
 *     #eg of k2_hap='ac^b^'
 *     inverted_sv=[]
 */

/* Python wrapper */
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_131letter_subgroup(PyObject *__pyx_self, PyObject *__pyx_v_k2_hap); /*proto*/
static PyMethodDef __pyx_mdef_10vapor_vali_15Simple_function_131letter_subgroup = {"letter_subgroup", (PyCFunction)__pyx_pw_10vapor_vali_15Simple_function_131letter_subgroup, METH_O, 0};
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_131letter_subgroup(PyObject *__pyx_self, PyObject *__pyx_v_k2_hap) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("letter_subgroup (wrapper)", 0);
  __pyx_r = __pyx_pf_10vapor_vali_15Simple_function_130letter_subgroup(__pyx_self, ((PyObject *)__pyx_v_k2_hap));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10vapor_vali_15Simple_function_130letter_subgroup(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_k2_hap) {
  PyObject *__pyx_v_inverted_sv = NULL;
  PyObject *__pyx_v_x = NULL;
  PyObject *__pyx_v_inverted_sv_2 = NULL;
  PyObject *__pyx_v_inverted_sv_3 = NULL;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  Py_ssize_t __pyx_t_2;
  PyObject *(*__pyx_t_3)(PyObject *);
  PyObject *__pyx_t_4 = NULL;
  int __pyx_t_5;
  int __pyx_t_6;
  int __pyx_t_7;
  Py_ssize_t __pyx_t_8;
  PyObject *__pyx_t_9 = NULL;
  int __pyx_t_10;
  long __pyx_t_11;
  long __pyx_t_12;
  __Pyx_RefNannySetupContext("letter_subgroup", 0);

  /* "vapor_vali/Simple_function.pyx":977
 * def letter_subgroup(k2_hap):
 *     #eg of k2_hap='ac^b^'
 *     inverted_sv=[]             # <<<<<<<<<<<<<<
 *     for x in k2_hap:
 *         if not x=='^':  inverted_sv.append(x)
 */
  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 977, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_inverted_sv = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":978
 *     #eg of k2_hap='ac^b^'
 *     inverted_sv=[]
 *     for x in k2_hap:             # <<<<<<<<<<<<<<
 *         if not x=='^':  inverted_sv.append(x)
 *         else:   inverted_sv[-1]+='^'
 */
  if (likely(PyList_CheckExact(__pyx_v_k2_hap)) || PyTuple_CheckExact(__pyx_v_k2_hap)) {
    __pyx_t_1 = __pyx_v_k2_hap; __Pyx_INCREF(__pyx_t_1); __pyx_t_2 = 0;
    __pyx_t_3 = NULL;
  } else {
    __pyx_t_2 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_v_k2_hap); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 978, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_3 = Py_TYPE(__pyx_t_1)->tp_iternext; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 978, __pyx_L1_error)
  }
  for (;;) {
    if (likely(!__pyx_t_3)) {
      if (likely(PyList_CheckExact(__pyx_t_1))) {
        if (__pyx_t_2 >= PyList_GET_SIZE(__pyx_t_1)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_4 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_4); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 978, __pyx_L1_error)
        #else
        __pyx_t_4 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 978, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_4);
        #endif
      } else {
        if (__pyx_t_2 >= PyTuple_GET_SIZE(__pyx_t_1)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_4 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_4); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 978, __pyx_L1_error)
        #else
        __pyx_t_4 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 978, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_4);
        #endif
      }
    } else {
      __pyx_t_4 = __pyx_t_3(__pyx_t_1);
      if (unlikely(!__pyx_t_4)) {
        PyObject* exc_type = PyErr_Occurred();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
          else __PYX_ERR(0, 978, __pyx_L1_error)
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_4);
    }
    __Pyx_XDECREF_SET(__pyx_v_x, __pyx_t_4);
    __pyx_t_4 = 0;

    /* "vapor_vali/Simple_function.pyx":979
 *     inverted_sv=[]
 *     for x in k2_hap:
 *         if not x=='^':  inverted_sv.append(x)             # <<<<<<<<<<<<<<
 *         else:   inverted_sv[-1]+='^'
 *     inverted_sv_2=[]
 */
    __pyx_t_5 = (__Pyx_PyString_Equals(__pyx_v_x, __pyx_kp_s__7, Py_EQ)); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 979, __pyx_L1_error)
    __pyx_t_6 = ((!__pyx_t_5) != 0);
    if (__pyx_t_6) {
      __pyx_t_7 = __Pyx_PyList_Append(__pyx_v_inverted_sv, __pyx_v_x); if (unlikely(__pyx_t_7 == -1)) __PYX_ERR(0, 979, __pyx_L1_error)
      goto __pyx_L5;
    }

    /* "vapor_vali/Simple_function.pyx":980
 *     for x in k2_hap:
 *         if not x=='^':  inverted_sv.append(x)
 *         else:   inverted_sv[-1]+='^'             # <<<<<<<<<<<<<<
 *     inverted_sv_2=[]
 *     for x in inverted_sv:
 */
    /*else*/ {
      __pyx_t_8 = -1L;
      __pyx_t_4 = __Pyx_GetItemInt_List(__pyx_v_inverted_sv, __pyx_t_8, Py_ssize_t, 1, PyInt_FromSsize_t, 1, 1, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 980, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_t_9 = PyNumber_InPlaceAdd(__pyx_t_4, __pyx_kp_s__7); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 980, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_9);
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      if (unlikely(__Pyx_SetItemInt(__pyx_v_inverted_sv, __pyx_t_8, __pyx_t_9, Py_ssize_t, 1, PyInt_FromSsize_t, 1, 1, 1) < 0)) __PYX_ERR(0, 980, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
    }
    __pyx_L5:;

    /* "vapor_vali/Simple_function.pyx":978
 *     #eg of k2_hap='ac^b^'
 *     inverted_sv=[]
 *     for x in k2_hap:             # <<<<<<<<<<<<<<
 *         if not x=='^':  inverted_sv.append(x)
 *         else:   inverted_sv[-1]+='^'
 */
  }
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":981
 *         if not x=='^':  inverted_sv.append(x)
 *         else:   inverted_sv[-1]+='^'
 *     inverted_sv_2=[]             # <<<<<<<<<<<<<<
 *     for x in inverted_sv:
 *         if inverted_sv_2==[]: inverted_sv_2.append(x)
 */
  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 981, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_inverted_sv_2 = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":982
 *         else:   inverted_sv[-1]+='^'
 *     inverted_sv_2=[]
 *     for x in inverted_sv:             # <<<<<<<<<<<<<<
 *         if inverted_sv_2==[]: inverted_sv_2.append(x)
 *         else:
 */
  __pyx_t_1 = __pyx_v_inverted_sv; __Pyx_INCREF(__pyx_t_1); __pyx_t_2 = 0;
  for (;;) {
    if (__pyx_t_2 >= PyList_GET_SIZE(__pyx_t_1)) break;
    #if CYTHON_COMPILING_IN_CPYTHON
    __pyx_t_9 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_9); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 982, __pyx_L1_error)
    #else
    __pyx_t_9 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 982, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_9);
    #endif
    __Pyx_XDECREF_SET(__pyx_v_x, __pyx_t_9);
    __pyx_t_9 = 0;

    /* "vapor_vali/Simple_function.pyx":983
 *     inverted_sv_2=[]
 *     for x in inverted_sv:
 *         if inverted_sv_2==[]: inverted_sv_2.append(x)             # <<<<<<<<<<<<<<
 *         else:
 *             if not '^' in inverted_sv_2[-1] and not '^' in x and ord(x)-ord(inverted_sv_2[-1][-1])==1:  inverted_sv_2[-1]+=x
 */
    __pyx_t_9 = PyList_New(0); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 983, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_9);
    __pyx_t_4 = PyObject_RichCompare(__pyx_v_inverted_sv_2, __pyx_t_9, Py_EQ); __Pyx_XGOTREF(__pyx_t_4); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 983, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_4); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 983, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    if (__pyx_t_6) {
      __pyx_t_7 = __Pyx_PyList_Append(__pyx_v_inverted_sv_2, __pyx_v_x); if (unlikely(__pyx_t_7 == -1)) __PYX_ERR(0, 983, __pyx_L1_error)
      goto __pyx_L8;
    }

    /* "vapor_vali/Simple_function.pyx":985
 *         if inverted_sv_2==[]: inverted_sv_2.append(x)
 *         else:
 *             if not '^' in inverted_sv_2[-1] and not '^' in x and ord(x)-ord(inverted_sv_2[-1][-1])==1:  inverted_sv_2[-1]+=x             # <<<<<<<<<<<<<<
 *             elif '^' in inverted_sv_2[-1] and '^'  in x and ord(x[0])-ord(inverted_sv_2[-1][-2])==-1:   inverted_sv_2[-1]+=x
 *             else:   inverted_sv_2.append(x)
 */
    /*else*/ {
      __pyx_t_4 = __Pyx_GetItemInt_List(__pyx_v_inverted_sv_2, -1L, long, 1, __Pyx_PyInt_From_long, 1, 1, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 985, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_t_5 = (__Pyx_PySequence_ContainsTF(__pyx_kp_s__7, __pyx_t_4, Py_NE)); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 985, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_10 = (__pyx_t_5 != 0);
      if (__pyx_t_10) {
      } else {
        __pyx_t_6 = __pyx_t_10;
        goto __pyx_L10_bool_binop_done;
      }
      __pyx_t_10 = (__Pyx_PySequence_ContainsTF(__pyx_kp_s__7, __pyx_v_x, Py_NE)); if (unlikely(__pyx_t_10 < 0)) __PYX_ERR(0, 985, __pyx_L1_error)
      __pyx_t_5 = (__pyx_t_10 != 0);
      if (__pyx_t_5) {
      } else {
        __pyx_t_6 = __pyx_t_5;
        goto __pyx_L10_bool_binop_done;
      }
      __pyx_t_11 = __Pyx_PyObject_Ord(__pyx_v_x); if (unlikely(__pyx_t_11 == (long)(Py_UCS4)-1)) __PYX_ERR(0, 985, __pyx_L1_error)
      __pyx_t_4 = __Pyx_GetItemInt_List(__pyx_v_inverted_sv_2, -1L, long, 1, __Pyx_PyInt_From_long, 1, 1, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 985, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_t_9 = __Pyx_GetItemInt(__pyx_t_4, -1L, long, 1, __Pyx_PyInt_From_long, 0, 1, 1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 985, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_9);
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_12 = __Pyx_PyObject_Ord(__pyx_t_9); if (unlikely(__pyx_t_12 == (long)(Py_UCS4)-1)) __PYX_ERR(0, 985, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
      __pyx_t_5 = (((__pyx_t_11 - __pyx_t_12) == 1) != 0);
      __pyx_t_6 = __pyx_t_5;
      __pyx_L10_bool_binop_done:;
      if (__pyx_t_6) {
        __pyx_t_8 = -1L;
        __pyx_t_9 = __Pyx_GetItemInt_List(__pyx_v_inverted_sv_2, __pyx_t_8, Py_ssize_t, 1, PyInt_FromSsize_t, 1, 1, 1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 985, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_9);
        __pyx_t_4 = PyNumber_InPlaceAdd(__pyx_t_9, __pyx_v_x); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 985, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_4);
        __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
        if (unlikely(__Pyx_SetItemInt(__pyx_v_inverted_sv_2, __pyx_t_8, __pyx_t_4, Py_ssize_t, 1, PyInt_FromSsize_t, 1, 1, 1) < 0)) __PYX_ERR(0, 985, __pyx_L1_error)
        __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
        goto __pyx_L9;
      }

      /* "vapor_vali/Simple_function.pyx":986
 *         else:
 *             if not '^' in inverted_sv_2[-1] and not '^' in x and ord(x)-ord(inverted_sv_2[-1][-1])==1:  inverted_sv_2[-1]+=x
 *             elif '^' in inverted_sv_2[-1] and '^'  in x and ord(x[0])-ord(inverted_sv_2[-1][-2])==-1:   inverted_sv_2[-1]+=x             # <<<<<<<<<<<<<<
 *             else:   inverted_sv_2.append(x)
 *     inverted_sv_3=[]
 */
      __pyx_t_4 = __Pyx_GetItemInt_List(__pyx_v_inverted_sv_2, -1L, long, 1, __Pyx_PyInt_From_long, 1, 1, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 986, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_t_5 = (__Pyx_PySequence_ContainsTF(__pyx_kp_s__7, __pyx_t_4, Py_EQ)); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 986, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_10 = (__pyx_t_5 != 0);
      if (__pyx_t_10) {
      } else {
        __pyx_t_6 = __pyx_t_10;
        goto __pyx_L13_bool_binop_done;
      }
      __pyx_t_10 = (__Pyx_PySequence_ContainsTF(__pyx_kp_s__7, __pyx_v_x, Py_EQ)); if (unlikely(__pyx_t_10 < 0)) __PYX_ERR(0, 986, __pyx_L1_error)
      __pyx_t_5 = (__pyx_t_10 != 0);
      if (__pyx_t_5) {
      } else {
        __pyx_t_6 = __pyx_t_5;
        goto __pyx_L13_bool_binop_done;
      }
      __pyx_t_4 = __Pyx_GetItemInt(__pyx_v_x, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 986, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_t_12 = __Pyx_PyObject_Ord(__pyx_t_4); if (unlikely(__pyx_t_12 == (long)(Py_UCS4)-1)) __PYX_ERR(0, 986, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_4 = __Pyx_GetItemInt_List(__pyx_v_inverted_sv_2, -1L, long, 1, __Pyx_PyInt_From_long, 1, 1, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 986, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_t_9 = __Pyx_GetItemInt(__pyx_t_4, -2L, long, 1, __Pyx_PyInt_From_long, 0, 1, 1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 986, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_9);
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_11 = __Pyx_PyObject_Ord(__pyx_t_9); if (unlikely(__pyx_t_11 == (long)(Py_UCS4)-1)) __PYX_ERR(0, 986, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
      __pyx_t_5 = (((__pyx_t_12 - __pyx_t_11) == -1L) != 0);
      __pyx_t_6 = __pyx_t_5;
      __pyx_L13_bool_binop_done:;
      if (__pyx_t_6) {
        __pyx_t_8 = -1L;
        __pyx_t_9 = __Pyx_GetItemInt_List(__pyx_v_inverted_sv_2, __pyx_t_8, Py_ssize_t, 1, PyInt_FromSsize_t, 1, 1, 1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 986, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_9);
        __pyx_t_4 = PyNumber_InPlaceAdd(__pyx_t_9, __pyx_v_x); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 986, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_4);
        __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
        if (unlikely(__Pyx_SetItemInt(__pyx_v_inverted_sv_2, __pyx_t_8, __pyx_t_4, Py_ssize_t, 1, PyInt_FromSsize_t, 1, 1, 1) < 0)) __PYX_ERR(0, 986, __pyx_L1_error)
        __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
        goto __pyx_L9;
      }

      /* "vapor_vali/Simple_function.pyx":987
 *             if not '^' in inverted_sv_2[-1] and not '^' in x and ord(x)-ord(inverted_sv_2[-1][-1])==1:  inverted_sv_2[-1]+=x
 *             elif '^' in inverted_sv_2[-1] and '^'  in x and ord(x[0])-ord(inverted_sv_2[-1][-2])==-1:   inverted_sv_2[-1]+=x
 *             else:   inverted_sv_2.append(x)             # <<<<<<<<<<<<<<
 *     inverted_sv_3=[]
 *     for i in inverted_sv_2:
 */
      /*else*/ {
        __pyx_t_7 = __Pyx_PyList_Append(__pyx_v_inverted_sv_2, __pyx_v_x); if (unlikely(__pyx_t_7 == -1)) __PYX_ERR(0, 987, __pyx_L1_error)
      }
      __pyx_L9:;
    }
    __pyx_L8:;

    /* "vapor_vali/Simple_function.pyx":982
 *         else:   inverted_sv[-1]+='^'
 *     inverted_sv_2=[]
 *     for x in inverted_sv:             # <<<<<<<<<<<<<<
 *         if inverted_sv_2==[]: inverted_sv_2.append(x)
 *         else:
 */
  }
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":988
 *             elif '^' in inverted_sv_2[-1] and '^'  in x and ord(x[0])-ord(inverted_sv_2[-1][-2])==-1:   inverted_sv_2[-1]+=x
 *             else:   inverted_sv_2.append(x)
 *     inverted_sv_3=[]             # <<<<<<<<<<<<<<
 *     for i in inverted_sv_2:
 *         if not '^' in i:    inverted_sv_3.append(i)
 */
  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 988, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_inverted_sv_3 = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":989
 *             else:   inverted_sv_2.append(x)
 *     inverted_sv_3=[]
 *     for i in inverted_sv_2:             # <<<<<<<<<<<<<<
 *         if not '^' in i:    inverted_sv_3.append(i)
 *         else:
 */
  __pyx_t_1 = __pyx_v_inverted_sv_2; __Pyx_INCREF(__pyx_t_1); __pyx_t_2 = 0;
  for (;;) {
    if (__pyx_t_2 >= PyList_GET_SIZE(__pyx_t_1)) break;
    #if CYTHON_COMPILING_IN_CPYTHON
    __pyx_t_4 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_4); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 989, __pyx_L1_error)
    #else
    __pyx_t_4 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 989, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    #endif
    __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_4);
    __pyx_t_4 = 0;

    /* "vapor_vali/Simple_function.pyx":990
 *     inverted_sv_3=[]
 *     for i in inverted_sv_2:
 *         if not '^' in i:    inverted_sv_3.append(i)             # <<<<<<<<<<<<<<
 *         else:
 *             inverted_sv_3.append(i.replace('^','')[::-1]+'^')
 */
    __pyx_t_6 = (__Pyx_PySequence_ContainsTF(__pyx_kp_s__7, __pyx_v_i, Py_NE)); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 990, __pyx_L1_error)
    __pyx_t_5 = (__pyx_t_6 != 0);
    if (__pyx_t_5) {
      __pyx_t_7 = __Pyx_PyList_Append(__pyx_v_inverted_sv_3, __pyx_v_i); if (unlikely(__pyx_t_7 == -1)) __PYX_ERR(0, 990, __pyx_L1_error)
      goto __pyx_L18;
    }

    /* "vapor_vali/Simple_function.pyx":992
 *         if not '^' in i:    inverted_sv_3.append(i)
 *         else:
 *             inverted_sv_3.append(i.replace('^','')[::-1]+'^')             # <<<<<<<<<<<<<<
 *     return inverted_sv_3
 * 
 */
    /*else*/ {
      __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_i, __pyx_n_s_replace); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 992, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_t_9 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_tuple__72, NULL); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 992, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_9);
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_4 = PyObject_GetItem(__pyx_t_9, __pyx_slice__73); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 992, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
      __pyx_t_9 = PyNumber_Add(__pyx_t_4, __pyx_kp_s__7); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 992, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_9);
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_7 = __Pyx_PyList_Append(__pyx_v_inverted_sv_3, __pyx_t_9); if (unlikely(__pyx_t_7 == -1)) __PYX_ERR(0, 992, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
    }
    __pyx_L18:;

    /* "vapor_vali/Simple_function.pyx":989
 *             else:   inverted_sv_2.append(x)
 *     inverted_sv_3=[]
 *     for i in inverted_sv_2:             # <<<<<<<<<<<<<<
 *         if not '^' in i:    inverted_sv_3.append(i)
 *         else:
 */
  }
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":993
 *         else:
 *             inverted_sv_3.append(i.replace('^','')[::-1]+'^')
 *     return inverted_sv_3             # <<<<<<<<<<<<<<
 * 
 * def letter_split(let):
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_inverted_sv_3);
  __pyx_r = __pyx_v_inverted_sv_3;
  goto __pyx_L0;

  /* "vapor_vali/Simple_function.pyx":975
 *     return(block_modify(out,chromos))
 * 
 * def letter_subgroup(k2_hap):             # <<<<<<<<<<<<<<
 *     #eg of k2_hap='ac^b^'
 *     inverted_sv=[]
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_9);
  __Pyx_AddTraceback("vapor_vali.Simple_function.letter_subgroup", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_inverted_sv);
  __Pyx_XDECREF(__pyx_v_x);
  __Pyx_XDECREF(__pyx_v_inverted_sv_2);
  __Pyx_XDECREF(__pyx_v_inverted_sv_3);
  __Pyx_XDECREF(__pyx_v_i);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "vapor_vali/Simple_function.pyx":995
 *     return inverted_sv_3
 * 
 * def letter_split(let):             # <<<<<<<<<<<<<<
 *     #eg of let='c^ba'
 *     out=[]
 */

/* Python wrapper */
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_133letter_split(PyObject *__pyx_self, PyObject *__pyx_v_let); /*proto*/
static PyMethodDef __pyx_mdef_10vapor_vali_15Simple_function_133letter_split = {"letter_split", (PyCFunction)__pyx_pw_10vapor_vali_15Simple_function_133letter_split, METH_O, 0};
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_133letter_split(PyObject *__pyx_self, PyObject *__pyx_v_let) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("letter_split (wrapper)", 0);
  __pyx_r = __pyx_pf_10vapor_vali_15Simple_function_132letter_split(__pyx_self, ((PyObject *)__pyx_v_let));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10vapor_vali_15Simple_function_132letter_split(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_let) {
  PyObject *__pyx_v_out = NULL;
  PyObject *__pyx_v_x = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  Py_ssize_t __pyx_t_2;
  PyObject *(*__pyx_t_3)(PyObject *);
  PyObject *__pyx_t_4 = NULL;
  int __pyx_t_5;
  int __pyx_t_6;
  int __pyx_t_7;
  Py_ssize_t __pyx_t_8;
  PyObject *__pyx_t_9 = NULL;
  __Pyx_RefNannySetupContext("letter_split", 0);

  /* "vapor_vali/Simple_function.pyx":997
 * def letter_split(let):
 *     #eg of let='c^ba'
 *     out=[]             # <<<<<<<<<<<<<<
 *     for x in let:
 *         if not x=='^':  out.append(x)
 */
  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 997, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_out = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":998
 *     #eg of let='c^ba'
 *     out=[]
 *     for x in let:             # <<<<<<<<<<<<<<
 *         if not x=='^':  out.append(x)
 *         else:   out[-1]+=x
 */
  if (likely(PyList_CheckExact(__pyx_v_let)) || PyTuple_CheckExact(__pyx_v_let)) {
    __pyx_t_1 = __pyx_v_let; __Pyx_INCREF(__pyx_t_1); __pyx_t_2 = 0;
    __pyx_t_3 = NULL;
  } else {
    __pyx_t_2 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_v_let); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 998, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_3 = Py_TYPE(__pyx_t_1)->tp_iternext; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 998, __pyx_L1_error)
  }
  for (;;) {
    if (likely(!__pyx_t_3)) {
      if (likely(PyList_CheckExact(__pyx_t_1))) {
        if (__pyx_t_2 >= PyList_GET_SIZE(__pyx_t_1)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_4 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_4); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 998, __pyx_L1_error)
        #else
        __pyx_t_4 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 998, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_4);
        #endif
      } else {
        if (__pyx_t_2 >= PyTuple_GET_SIZE(__pyx_t_1)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_4 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_4); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 998, __pyx_L1_error)
        #else
        __pyx_t_4 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 998, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_4);
        #endif
      }
    } else {
      __pyx_t_4 = __pyx_t_3(__pyx_t_1);
      if (unlikely(!__pyx_t_4)) {
        PyObject* exc_type = PyErr_Occurred();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
          else __PYX_ERR(0, 998, __pyx_L1_error)
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_4);
    }
    __Pyx_XDECREF_SET(__pyx_v_x, __pyx_t_4);
    __pyx_t_4 = 0;

    /* "vapor_vali/Simple_function.pyx":999
 *     out=[]
 *     for x in let:
 *         if not x=='^':  out.append(x)             # <<<<<<<<<<<<<<
 *         else:   out[-1]+=x
 *     return out
 */
    __pyx_t_5 = (__Pyx_PyString_Equals(__pyx_v_x, __pyx_kp_s__7, Py_EQ)); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 999, __pyx_L1_error)
    __pyx_t_6 = ((!__pyx_t_5) != 0);
    if (__pyx_t_6) {
      __pyx_t_7 = __Pyx_PyList_Append(__pyx_v_out, __pyx_v_x); if (unlikely(__pyx_t_7 == -1)) __PYX_ERR(0, 999, __pyx_L1_error)
      goto __pyx_L5;
    }

    /* "vapor_vali/Simple_function.pyx":1000
 *     for x in let:
 *         if not x=='^':  out.append(x)
 *         else:   out[-1]+=x             # <<<<<<<<<<<<<<
 *     return out
 * 
 */
    /*else*/ {
      __pyx_t_8 = -1L;
      __pyx_t_4 = __Pyx_GetItemInt_List(__pyx_v_out, __pyx_t_8, Py_ssize_t, 1, PyInt_FromSsize_t, 1, 1, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1000, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_t_9 = PyNumber_InPlaceAdd(__pyx_t_4, __pyx_v_x); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1000, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_9);
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      if (unlikely(__Pyx_SetItemInt(__pyx_v_out, __pyx_t_8, __pyx_t_9, Py_ssize_t, 1, PyInt_FromSsize_t, 1, 1, 1) < 0)) __PYX_ERR(0, 1000, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
    }
    __pyx_L5:;

    /* "vapor_vali/Simple_function.pyx":998
 *     #eg of let='c^ba'
 *     out=[]
 *     for x in let:             # <<<<<<<<<<<<<<
 *         if not x=='^':  out.append(x)
 *         else:   out[-1]+=x
 */
  }
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":1001
 *         if not x=='^':  out.append(x)
 *         else:   out[-1]+=x
 *     return out             # <<<<<<<<<<<<<<
 * 
 * def list_unify(list):
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_out);
  __pyx_r = __pyx_v_out;
  goto __pyx_L0;

  /* "vapor_vali/Simple_function.pyx":995
 *     return inverted_sv_3
 * 
 * def letter_split(let):             # <<<<<<<<<<<<<<
 *     #eg of let='c^ba'
 *     out=[]
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_9);
  __Pyx_AddTraceback("vapor_vali.Simple_function.letter_split", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_out);
  __Pyx_XDECREF(__pyx_v_x);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "vapor_vali/Simple_function.pyx":1003
 *     return out
 * 
 * def list_unify(list):             # <<<<<<<<<<<<<<
 *     out=[]
 *     for i in list:
 */

/* Python wrapper */
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_135list_unify(PyObject *__pyx_self, PyObject *__pyx_v_list); /*proto*/
static PyMethodDef __pyx_mdef_10vapor_vali_15Simple_function_135list_unify = {"list_unify", (PyCFunction)__pyx_pw_10vapor_vali_15Simple_function_135list_unify, METH_O, 0};
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_135list_unify(PyObject *__pyx_self, PyObject *__pyx_v_list) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("list_unify (wrapper)", 0);
  __pyx_r = __pyx_pf_10vapor_vali_15Simple_function_134list_unify(__pyx_self, ((PyObject *)__pyx_v_list));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10vapor_vali_15Simple_function_134list_unify(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_list) {
  PyObject *__pyx_v_out = NULL;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  Py_ssize_t __pyx_t_2;
  PyObject *(*__pyx_t_3)(PyObject *);
  PyObject *__pyx_t_4 = NULL;
  int __pyx_t_5;
  int __pyx_t_6;
  int __pyx_t_7;
  __Pyx_RefNannySetupContext("list_unify", 0);

  /* "vapor_vali/Simple_function.pyx":1004
 * 
 * def list_unify(list):
 *     out=[]             # <<<<<<<<<<<<<<
 *     for i in list:
 *         if not i in out:    out.append(i)
 */
  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1004, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_out = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":1005
 * def list_unify(list):
 *     out=[]
 *     for i in list:             # <<<<<<<<<<<<<<
 *         if not i in out:    out.append(i)
 *     return out
 */
  if (likely(PyList_CheckExact(__pyx_v_list)) || PyTuple_CheckExact(__pyx_v_list)) {
    __pyx_t_1 = __pyx_v_list; __Pyx_INCREF(__pyx_t_1); __pyx_t_2 = 0;
    __pyx_t_3 = NULL;
  } else {
    __pyx_t_2 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_v_list); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1005, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_3 = Py_TYPE(__pyx_t_1)->tp_iternext; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1005, __pyx_L1_error)
  }
  for (;;) {
    if (likely(!__pyx_t_3)) {
      if (likely(PyList_CheckExact(__pyx_t_1))) {
        if (__pyx_t_2 >= PyList_GET_SIZE(__pyx_t_1)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_4 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_4); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 1005, __pyx_L1_error)
        #else
        __pyx_t_4 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1005, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_4);
        #endif
      } else {
        if (__pyx_t_2 >= PyTuple_GET_SIZE(__pyx_t_1)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_4 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_4); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 1005, __pyx_L1_error)
        #else
        __pyx_t_4 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1005, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_4);
        #endif
      }
    } else {
      __pyx_t_4 = __pyx_t_3(__pyx_t_1);
      if (unlikely(!__pyx_t_4)) {
        PyObject* exc_type = PyErr_Occurred();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
          else __PYX_ERR(0, 1005, __pyx_L1_error)
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_4);
    }
    __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_4);
    __pyx_t_4 = 0;

    /* "vapor_vali/Simple_function.pyx":1006
 *     out=[]
 *     for i in list:
 *         if not i in out:    out.append(i)             # <<<<<<<<<<<<<<
 *     return out
 * 
 */
    __pyx_t_5 = (__Pyx_PySequence_ContainsTF(__pyx_v_i, __pyx_v_out, Py_NE)); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 1006, __pyx_L1_error)
    __pyx_t_6 = (__pyx_t_5 != 0);
    if (__pyx_t_6) {
      __pyx_t_7 = __Pyx_PyList_Append(__pyx_v_out, __pyx_v_i); if (unlikely(__pyx_t_7 == -1)) __PYX_ERR(0, 1006, __pyx_L1_error)
    }

    /* "vapor_vali/Simple_function.pyx":1005
 * def list_unify(list):
 *     out=[]
 *     for i in list:             # <<<<<<<<<<<<<<
 *         if not i in out:    out.append(i)
 *     return out
 */
  }
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":1007
 *     for i in list:
 *         if not i in out:    out.append(i)
 *     return out             # <<<<<<<<<<<<<<
 * 
 * def make_event_figure_1(vapor_score_list,best_read_rec,window_size,ref_seq,alt_seq,out_figure_name):
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_out);
  __pyx_r = __pyx_v_out;
  goto __pyx_L0;

  /* "vapor_vali/Simple_function.pyx":1003
 *     return out
 * 
 * def list_unify(list):             # <<<<<<<<<<<<<<
 *     out=[]
 *     for i in list:
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_AddTraceback("vapor_vali.Simple_function.list_unify", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_out);
  __Pyx_XDECREF(__pyx_v_i);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "vapor_vali/Simple_function.pyx":1009
 *     return out
 * 
 * def make_event_figure_1(vapor_score_list,best_read_rec,window_size,ref_seq,alt_seq,out_figure_name):             # <<<<<<<<<<<<<<
 *     if not best_read_rec=='':
 *         if not best_read_rec==[]:
 */

/* Python wrapper */
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_137make_event_figure_1(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_10vapor_vali_15Simple_function_137make_event_figure_1 = {"make_event_figure_1", (PyCFunction)__pyx_pw_10vapor_vali_15Simple_function_137make_event_figure_1, METH_VARARGS|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_137make_event_figure_1(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  CYTHON_UNUSED PyObject *__pyx_v_vapor_score_list = 0;
  PyObject *__pyx_v_best_read_rec = 0;
  PyObject *__pyx_v_window_size = 0;
  PyObject *__pyx_v_ref_seq = 0;
  PyObject *__pyx_v_alt_seq = 0;
  PyObject *__pyx_v_out_figure_name = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("make_event_figure_1 (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_vapor_score_list,&__pyx_n_s_best_read_rec,&__pyx_n_s_window_size,&__pyx_n_s_ref_seq,&__pyx_n_s_alt_seq,&__pyx_n_s_out_figure_name,0};
    PyObject* values[6] = {0,0,0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
      switch (pos_args) {
        case  6: values[5] = PyTuple_GET_ITEM(__pyx_args, 5);
        case  5: values[4] = PyTuple_GET_ITEM(__pyx_args, 4);
        case  4: values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
        case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_vapor_score_list)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_best_read_rec)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("make_event_figure_1", 1, 6, 6, 1); __PYX_ERR(0, 1009, __pyx_L3_error)
        }
        case  2:
        if (likely((values[2] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_window_size)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("make_event_figure_1", 1, 6, 6, 2); __PYX_ERR(0, 1009, __pyx_L3_error)
        }
        case  3:
        if (likely((values[3] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_ref_seq)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("make_event_figure_1", 1, 6, 6, 3); __PYX_ERR(0, 1009, __pyx_L3_error)
        }
        case  4:
        if (likely((values[4] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_alt_seq)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("make_event_figure_1", 1, 6, 6, 4); __PYX_ERR(0, 1009, __pyx_L3_error)
        }
        case  5:
        if (likely((values[5] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_out_figure_name)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("make_event_figure_1", 1, 6, 6, 5); __PYX_ERR(0, 1009, __pyx_L3_error)
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "make_event_figure_1") < 0)) __PYX_ERR(0, 1009, __pyx_L3_error)
      }
    } else if (PyTuple_GET_SIZE(__pyx_args) != 6) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
      values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
      values[4] = PyTuple_GET_ITEM(__pyx_args, 4);
      values[5] = PyTuple_GET_ITEM(__pyx_args, 5);
    }
    __pyx_v_vapor_score_list = values[0];
    __pyx_v_best_read_rec = values[1];
    __pyx_v_window_size = values[2];
    __pyx_v_ref_seq = values[3];
    __pyx_v_alt_seq = values[4];
    __pyx_v_out_figure_name = values[5];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("make_event_figure_1", 1, 6, 6, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1009, __pyx_L3_error)
  __pyx_L3_error:;
  __Pyx_AddTraceback("vapor_vali.Simple_function.make_event_figure_1", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_10vapor_vali_15Simple_function_136make_event_figure_1(__pyx_self, __pyx_v_vapor_score_list, __pyx_v_best_read_rec, __pyx_v_window_size, __pyx_v_ref_seq, __pyx_v_alt_seq, __pyx_v_out_figure_name);

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10vapor_vali_15Simple_function_136make_event_figure_1(CYTHON_UNUSED PyObject *__pyx_self, CYTHON_UNUSED PyObject *__pyx_v_vapor_score_list, PyObject *__pyx_v_best_read_rec, PyObject *__pyx_v_window_size, PyObject *__pyx_v_ref_seq, PyObject *__pyx_v_alt_seq, PyObject *__pyx_v_out_figure_name) {
  PyObject *__pyx_v_dotdata_record = NULL;
  PyObject *__pyx_v_grdevices = NULL;
  PyObject *__pyx_v_graphics = NULL;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  int __pyx_t_2;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  Py_ssize_t __pyx_t_6;
  PyObject *__pyx_t_7 = NULL;
  PyObject *__pyx_t_8 = NULL;
  PyObject *__pyx_t_9 = NULL;
  PyObject *__pyx_t_10 = NULL;
  PyObject *__pyx_t_11 = NULL;
  PyObject *__pyx_t_12 = NULL;
  PyObject *(*__pyx_t_13)(PyObject *);
  __Pyx_RefNannySetupContext("make_event_figure_1", 0);
  __Pyx_INCREF(__pyx_v_out_figure_name);

  /* "vapor_vali/Simple_function.pyx":1010
 * 
 * def make_event_figure_1(vapor_score_list,best_read_rec,window_size,ref_seq,alt_seq,out_figure_name):
 *     if not best_read_rec=='':             # <<<<<<<<<<<<<<
 *         if not best_read_rec==[]:
 *             dotdata_record=[dotdata(window_size,ref_seq,ref_seq),    dotdata(window_size,alt_seq,alt_seq),    dotdata(window_size,best_read_rec[0],ref_seq[best_read_rec[1]:]),    dotdata(window_size,best_read_rec[0],alt_seq[best_read_rec[1]:])]
 */
  __pyx_t_1 = (__Pyx_PyString_Equals(__pyx_v_best_read_rec, __pyx_kp_s__24, Py_EQ)); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(0, 1010, __pyx_L1_error)
  __pyx_t_2 = ((!__pyx_t_1) != 0);
  if (__pyx_t_2) {

    /* "vapor_vali/Simple_function.pyx":1011
 * def make_event_figure_1(vapor_score_list,best_read_rec,window_size,ref_seq,alt_seq,out_figure_name):
 *     if not best_read_rec=='':
 *         if not best_read_rec==[]:             # <<<<<<<<<<<<<<
 *             dotdata_record=[dotdata(window_size,ref_seq,ref_seq),    dotdata(window_size,alt_seq,alt_seq),    dotdata(window_size,best_read_rec[0],ref_seq[best_read_rec[1]:]),    dotdata(window_size,best_read_rec[0],alt_seq[best_read_rec[1]:])]
 *             if not [] in dotdata_record:
 */
    __pyx_t_3 = PyList_New(0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1011, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_4 = PyObject_RichCompare(__pyx_v_best_read_rec, __pyx_t_3, Py_EQ); __Pyx_XGOTREF(__pyx_t_4); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1011, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_4); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 1011, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_1 = ((!__pyx_t_2) != 0);
    if (__pyx_t_1) {

      /* "vapor_vali/Simple_function.pyx":1012
 *     if not best_read_rec=='':
 *         if not best_read_rec==[]:
 *             dotdata_record=[dotdata(window_size,ref_seq,ref_seq),    dotdata(window_size,alt_seq,alt_seq),    dotdata(window_size,best_read_rec[0],ref_seq[best_read_rec[1]:]),    dotdata(window_size,best_read_rec[0],alt_seq[best_read_rec[1]:])]             # <<<<<<<<<<<<<<
 *             if not [] in dotdata_record:
 *                 grdevices = importr('grDevices')
 */
      __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_dotdata); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1012, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __pyx_t_5 = NULL;
      __pyx_t_6 = 0;
      if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_3))) {
        __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_3);
        if (likely(__pyx_t_5)) {
          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
          __Pyx_INCREF(__pyx_t_5);
          __Pyx_INCREF(function);
          __Pyx_DECREF_SET(__pyx_t_3, function);
          __pyx_t_6 = 1;
        }
      }
      __pyx_t_7 = PyTuple_New(3+__pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1012, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_7);
      if (__pyx_t_5) {
        __Pyx_GIVEREF(__pyx_t_5); PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_5); __pyx_t_5 = NULL;
      }
      __Pyx_INCREF(__pyx_v_window_size);
      __Pyx_GIVEREF(__pyx_v_window_size);
      PyTuple_SET_ITEM(__pyx_t_7, 0+__pyx_t_6, __pyx_v_window_size);
      __Pyx_INCREF(__pyx_v_ref_seq);
      __Pyx_GIVEREF(__pyx_v_ref_seq);
      PyTuple_SET_ITEM(__pyx_t_7, 1+__pyx_t_6, __pyx_v_ref_seq);
      __Pyx_INCREF(__pyx_v_ref_seq);
      __Pyx_GIVEREF(__pyx_v_ref_seq);
      PyTuple_SET_ITEM(__pyx_t_7, 2+__pyx_t_6, __pyx_v_ref_seq);
      __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_7, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1012, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_7 = __Pyx_GetModuleGlobalName(__pyx_n_s_dotdata); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1012, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_7);
      __pyx_t_5 = NULL;
      __pyx_t_6 = 0;
      if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_7))) {
        __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_7);
        if (likely(__pyx_t_5)) {
          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_7);
          __Pyx_INCREF(__pyx_t_5);
          __Pyx_INCREF(function);
          __Pyx_DECREF_SET(__pyx_t_7, function);
          __pyx_t_6 = 1;
        }
      }
      __pyx_t_8 = PyTuple_New(3+__pyx_t_6); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1012, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_8);
      if (__pyx_t_5) {
        __Pyx_GIVEREF(__pyx_t_5); PyTuple_SET_ITEM(__pyx_t_8, 0, __pyx_t_5); __pyx_t_5 = NULL;
      }
      __Pyx_INCREF(__pyx_v_window_size);
      __Pyx_GIVEREF(__pyx_v_window_size);
      PyTuple_SET_ITEM(__pyx_t_8, 0+__pyx_t_6, __pyx_v_window_size);
      __Pyx_INCREF(__pyx_v_alt_seq);
      __Pyx_GIVEREF(__pyx_v_alt_seq);
      PyTuple_SET_ITEM(__pyx_t_8, 1+__pyx_t_6, __pyx_v_alt_seq);
      __Pyx_INCREF(__pyx_v_alt_seq);
      __Pyx_GIVEREF(__pyx_v_alt_seq);
      PyTuple_SET_ITEM(__pyx_t_8, 2+__pyx_t_6, __pyx_v_alt_seq);
      __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_7, __pyx_t_8, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1012, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
      __pyx_t_8 = __Pyx_GetModuleGlobalName(__pyx_n_s_dotdata); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1012, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_8);
      __pyx_t_5 = __Pyx_GetItemInt(__pyx_v_best_read_rec, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1012, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_5);
      __pyx_t_9 = __Pyx_GetItemInt(__pyx_v_best_read_rec, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1012, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_9);
      __pyx_t_10 = __Pyx_PyObject_GetSlice(__pyx_v_ref_seq, 0, 0, &__pyx_t_9, NULL, NULL, 0, 0, 1); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1012, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_10);
      __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
      __pyx_t_9 = NULL;
      __pyx_t_6 = 0;
      if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_8))) {
        __pyx_t_9 = PyMethod_GET_SELF(__pyx_t_8);
        if (likely(__pyx_t_9)) {
          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_8);
          __Pyx_INCREF(__pyx_t_9);
          __Pyx_INCREF(function);
          __Pyx_DECREF_SET(__pyx_t_8, function);
          __pyx_t_6 = 1;
        }
      }
      __pyx_t_11 = PyTuple_New(3+__pyx_t_6); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1012, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_11);
      if (__pyx_t_9) {
        __Pyx_GIVEREF(__pyx_t_9); PyTuple_SET_ITEM(__pyx_t_11, 0, __pyx_t_9); __pyx_t_9 = NULL;
      }
      __Pyx_INCREF(__pyx_v_window_size);
      __Pyx_GIVEREF(__pyx_v_window_size);
      PyTuple_SET_ITEM(__pyx_t_11, 0+__pyx_t_6, __pyx_v_window_size);
      __Pyx_GIVEREF(__pyx_t_5);
      PyTuple_SET_ITEM(__pyx_t_11, 1+__pyx_t_6, __pyx_t_5);
      __Pyx_GIVEREF(__pyx_t_10);
      PyTuple_SET_ITEM(__pyx_t_11, 2+__pyx_t_6, __pyx_t_10);
      __pyx_t_5 = 0;
      __pyx_t_10 = 0;
      __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_8, __pyx_t_11, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1012, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_7);
      __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
      __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
      __pyx_t_11 = __Pyx_GetModuleGlobalName(__pyx_n_s_dotdata); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1012, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_11);
      __pyx_t_10 = __Pyx_GetItemInt(__pyx_v_best_read_rec, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1012, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_10);
      __pyx_t_5 = __Pyx_GetItemInt(__pyx_v_best_read_rec, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1012, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_5);
      __pyx_t_9 = __Pyx_PyObject_GetSlice(__pyx_v_alt_seq, 0, 0, &__pyx_t_5, NULL, NULL, 0, 0, 1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1012, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_9);
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
      __pyx_t_5 = NULL;
      __pyx_t_6 = 0;
      if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_11))) {
        __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_11);
        if (likely(__pyx_t_5)) {
          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_11);
          __Pyx_INCREF(__pyx_t_5);
          __Pyx_INCREF(function);
          __Pyx_DECREF_SET(__pyx_t_11, function);
          __pyx_t_6 = 1;
        }
      }
      __pyx_t_12 = PyTuple_New(3+__pyx_t_6); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1012, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_12);
      if (__pyx_t_5) {
        __Pyx_GIVEREF(__pyx_t_5); PyTuple_SET_ITEM(__pyx_t_12, 0, __pyx_t_5); __pyx_t_5 = NULL;
      }
      __Pyx_INCREF(__pyx_v_window_size);
      __Pyx_GIVEREF(__pyx_v_window_size);
      PyTuple_SET_ITEM(__pyx_t_12, 0+__pyx_t_6, __pyx_v_window_size);
      __Pyx_GIVEREF(__pyx_t_10);
      PyTuple_SET_ITEM(__pyx_t_12, 1+__pyx_t_6, __pyx_t_10);
      __Pyx_GIVEREF(__pyx_t_9);
      PyTuple_SET_ITEM(__pyx_t_12, 2+__pyx_t_6, __pyx_t_9);
      __pyx_t_10 = 0;
      __pyx_t_9 = 0;
      __pyx_t_8 = __Pyx_PyObject_Call(__pyx_t_11, __pyx_t_12, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1012, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_8);
      __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
      __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
      __pyx_t_11 = PyList_New(4); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1012, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_11);
      __Pyx_GIVEREF(__pyx_t_4);
      PyList_SET_ITEM(__pyx_t_11, 0, __pyx_t_4);
      __Pyx_GIVEREF(__pyx_t_3);
      PyList_SET_ITEM(__pyx_t_11, 1, __pyx_t_3);
      __Pyx_GIVEREF(__pyx_t_7);
      PyList_SET_ITEM(__pyx_t_11, 2, __pyx_t_7);
      __Pyx_GIVEREF(__pyx_t_8);
      PyList_SET_ITEM(__pyx_t_11, 3, __pyx_t_8);
      __pyx_t_4 = 0;
      __pyx_t_3 = 0;
      __pyx_t_7 = 0;
      __pyx_t_8 = 0;
      __pyx_v_dotdata_record = ((PyObject*)__pyx_t_11);
      __pyx_t_11 = 0;

      /* "vapor_vali/Simple_function.pyx":1013
 *         if not best_read_rec==[]:
 *             dotdata_record=[dotdata(window_size,ref_seq,ref_seq),    dotdata(window_size,alt_seq,alt_seq),    dotdata(window_size,best_read_rec[0],ref_seq[best_read_rec[1]:]),    dotdata(window_size,best_read_rec[0],alt_seq[best_read_rec[1]:])]
 *             if not [] in dotdata_record:             # <<<<<<<<<<<<<<
 *                 grdevices = importr('grDevices')
 *                 graphics = importr("graphics")
 */
      __pyx_t_11 = PyList_New(0); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1013, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_11);
      __pyx_t_1 = (__Pyx_PySequence_ContainsTF(__pyx_t_11, __pyx_v_dotdata_record, Py_NE)); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(0, 1013, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
      __pyx_t_2 = (__pyx_t_1 != 0);
      if (__pyx_t_2) {

        /* "vapor_vali/Simple_function.pyx":1014
 *             dotdata_record=[dotdata(window_size,ref_seq,ref_seq),    dotdata(window_size,alt_seq,alt_seq),    dotdata(window_size,best_read_rec[0],ref_seq[best_read_rec[1]:]),    dotdata(window_size,best_read_rec[0],alt_seq[best_read_rec[1]:])]
 *             if not [] in dotdata_record:
 *                 grdevices = importr('grDevices')             # <<<<<<<<<<<<<<
 *                 graphics = importr("graphics")
 *                 if  len(out_figure_name.split('/')[-1])>150:
 */
        __pyx_t_11 = __Pyx_GetModuleGlobalName(__pyx_n_s_importr); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1014, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_11);
        __pyx_t_8 = __Pyx_PyObject_Call(__pyx_t_11, __pyx_tuple__74, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1014, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_8);
        __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
        __pyx_v_grdevices = __pyx_t_8;
        __pyx_t_8 = 0;

        /* "vapor_vali/Simple_function.pyx":1015
 *             if not [] in dotdata_record:
 *                 grdevices = importr('grDevices')
 *                 graphics = importr("graphics")             # <<<<<<<<<<<<<<
 *                 if  len(out_figure_name.split('/')[-1])>150:
 *                     out_figure_name='/'.join(out_figure_name.split('/')[:-1])+'/'+out_figure_name.split('/')[-1][:140]+'.'+out_figure_name.split('.')[-1]
 */
        __pyx_t_8 = __Pyx_GetModuleGlobalName(__pyx_n_s_importr); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1015, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_8);
        __pyx_t_11 = __Pyx_PyObject_Call(__pyx_t_8, __pyx_tuple__75, NULL); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1015, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_11);
        __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
        __pyx_v_graphics = __pyx_t_11;
        __pyx_t_11 = 0;

        /* "vapor_vali/Simple_function.pyx":1016
 *                 grdevices = importr('grDevices')
 *                 graphics = importr("graphics")
 *                 if  len(out_figure_name.split('/')[-1])>150:             # <<<<<<<<<<<<<<
 *                     out_figure_name='/'.join(out_figure_name.split('/')[:-1])+'/'+out_figure_name.split('/')[-1][:140]+'.'+out_figure_name.split('.')[-1]
 *                 grdevices.png(file=out_figure_name, width=512, height=512)
 */
        __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_v_out_figure_name, __pyx_n_s_split); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1016, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_11);
        __pyx_t_8 = __Pyx_PyObject_Call(__pyx_t_11, __pyx_tuple__76, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1016, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_8);
        __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
        __pyx_t_11 = __Pyx_GetItemInt(__pyx_t_8, -1L, long, 1, __Pyx_PyInt_From_long, 0, 1, 1); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1016, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_11);
        __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
        __pyx_t_6 = PyObject_Length(__pyx_t_11); if (unlikely(__pyx_t_6 == -1)) __PYX_ERR(0, 1016, __pyx_L1_error)
        __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
        __pyx_t_2 = ((__pyx_t_6 > 0x96) != 0);
        if (__pyx_t_2) {

          /* "vapor_vali/Simple_function.pyx":1017
 *                 graphics = importr("graphics")
 *                 if  len(out_figure_name.split('/')[-1])>150:
 *                     out_figure_name='/'.join(out_figure_name.split('/')[:-1])+'/'+out_figure_name.split('/')[-1][:140]+'.'+out_figure_name.split('.')[-1]             # <<<<<<<<<<<<<<
 *                 grdevices.png(file=out_figure_name, width=512, height=512)
 *                 graphics.par(mfrow=IntVector([2,2]))
 */
          __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_v_out_figure_name, __pyx_n_s_split); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1017, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_11);
          __pyx_t_8 = __Pyx_PyObject_Call(__pyx_t_11, __pyx_tuple__77, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1017, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_8);
          __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
          __pyx_t_11 = __Pyx_PyObject_GetSlice(__pyx_t_8, 0, -1L, NULL, NULL, &__pyx_slice__78, 0, 1, 1); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1017, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_11);
          __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
          __pyx_t_8 = __Pyx_PyString_Join(__pyx_kp_s__3, __pyx_t_11); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1017, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_8);
          __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
          __pyx_t_11 = PyNumber_Add(__pyx_t_8, __pyx_kp_s__3); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1017, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_11);
          __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
          __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_v_out_figure_name, __pyx_n_s_split); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1017, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_8);
          __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_8, __pyx_tuple__79, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1017, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_7);
          __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
          __pyx_t_8 = __Pyx_GetItemInt(__pyx_t_7, -1L, long, 1, __Pyx_PyInt_From_long, 0, 1, 1); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1017, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_8);
          __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
          __pyx_t_7 = __Pyx_PyObject_GetSlice(__pyx_t_8, 0, 0x8C, NULL, NULL, &__pyx_slice__80, 0, 1, 1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1017, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_7);
          __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
          __pyx_t_8 = PyNumber_Add(__pyx_t_11, __pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1017, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_8);
          __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
          __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
          __pyx_t_7 = PyNumber_Add(__pyx_t_8, __pyx_kp_s__19); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1017, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_7);
          __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
          __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_v_out_figure_name, __pyx_n_s_split); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1017, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_8);
          __pyx_t_11 = __Pyx_PyObject_Call(__pyx_t_8, __pyx_tuple__81, NULL); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1017, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_11);
          __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
          __pyx_t_8 = __Pyx_GetItemInt(__pyx_t_11, -1L, long, 1, __Pyx_PyInt_From_long, 0, 1, 1); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1017, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_8);
          __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
          __pyx_t_11 = PyNumber_Add(__pyx_t_7, __pyx_t_8); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1017, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_11);
          __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
          __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
          __Pyx_DECREF_SET(__pyx_v_out_figure_name, __pyx_t_11);
          __pyx_t_11 = 0;

          /* "vapor_vali/Simple_function.pyx":1016
 *                 grdevices = importr('grDevices')
 *                 graphics = importr("graphics")
 *                 if  len(out_figure_name.split('/')[-1])>150:             # <<<<<<<<<<<<<<
 *                     out_figure_name='/'.join(out_figure_name.split('/')[:-1])+'/'+out_figure_name.split('/')[-1][:140]+'.'+out_figure_name.split('.')[-1]
 *                 grdevices.png(file=out_figure_name, width=512, height=512)
 */
        }

        /* "vapor_vali/Simple_function.pyx":1018
 *                 if  len(out_figure_name.split('/')[-1])>150:
 *                     out_figure_name='/'.join(out_figure_name.split('/')[:-1])+'/'+out_figure_name.split('/')[-1][:140]+'.'+out_figure_name.split('.')[-1]
 *                 grdevices.png(file=out_figure_name, width=512, height=512)             # <<<<<<<<<<<<<<
 *                 graphics.par(mfrow=IntVector([2,2]))
 *                 #penal 1
 */
        __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_v_grdevices, __pyx_n_s_png); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1018, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_11);
        __pyx_t_8 = PyDict_New(); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1018, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_8);
        if (PyDict_SetItem(__pyx_t_8, __pyx_n_s_file, __pyx_v_out_figure_name) < 0) __PYX_ERR(0, 1018, __pyx_L1_error)
        if (PyDict_SetItem(__pyx_t_8, __pyx_n_s_width, __pyx_int_512) < 0) __PYX_ERR(0, 1018, __pyx_L1_error)
        if (PyDict_SetItem(__pyx_t_8, __pyx_n_s_height, __pyx_int_512) < 0) __PYX_ERR(0, 1018, __pyx_L1_error)
        __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_11, __pyx_empty_tuple, __pyx_t_8); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1018, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_7);
        __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
        __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
        __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;

        /* "vapor_vali/Simple_function.pyx":1019
 *                     out_figure_name='/'.join(out_figure_name.split('/')[:-1])+'/'+out_figure_name.split('/')[-1][:140]+'.'+out_figure_name.split('.')[-1]
 *                 grdevices.png(file=out_figure_name, width=512, height=512)
 *                 graphics.par(mfrow=IntVector([2,2]))             # <<<<<<<<<<<<<<
 *                 #penal 1
 *                 graphics.plot([min([i[0] for i in dotdata_record[0]]),max([i[0] for i in dotdata_record[0]])],[min([i[1] for i in dotdata_record[0]]),max([i[1] for i in dotdata_record[0]])],type='n',xlab='oroginal_reference',ylab='oroginal_reference')
 */
        __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_graphics, __pyx_n_s_par); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1019, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_7);
        __pyx_t_8 = PyDict_New(); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1019, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_8);
        __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_IntVector); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1019, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_3);
        __pyx_t_4 = PyList_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1019, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_4);
        __Pyx_INCREF(__pyx_int_2);
        __Pyx_GIVEREF(__pyx_int_2);
        PyList_SET_ITEM(__pyx_t_4, 0, __pyx_int_2);
        __Pyx_INCREF(__pyx_int_2);
        __Pyx_GIVEREF(__pyx_int_2);
        PyList_SET_ITEM(__pyx_t_4, 1, __pyx_int_2);
        __pyx_t_12 = NULL;
        if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_3))) {
          __pyx_t_12 = PyMethod_GET_SELF(__pyx_t_3);
          if (likely(__pyx_t_12)) {
            PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
            __Pyx_INCREF(__pyx_t_12);
            __Pyx_INCREF(function);
            __Pyx_DECREF_SET(__pyx_t_3, function);
          }
        }
        if (!__pyx_t_12) {
          __pyx_t_11 = __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_4); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1019, __pyx_L1_error)
          __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
          __Pyx_GOTREF(__pyx_t_11);
        } else {
          __pyx_t_9 = PyTuple_New(1+1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1019, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_9);
          __Pyx_GIVEREF(__pyx_t_12); PyTuple_SET_ITEM(__pyx_t_9, 0, __pyx_t_12); __pyx_t_12 = NULL;
          __Pyx_GIVEREF(__pyx_t_4);
          PyTuple_SET_ITEM(__pyx_t_9, 0+1, __pyx_t_4);
          __pyx_t_4 = 0;
          __pyx_t_11 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_9, NULL); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1019, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_11);
          __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
        }
        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
        if (PyDict_SetItem(__pyx_t_8, __pyx_n_s_mfrow, __pyx_t_11) < 0) __PYX_ERR(0, 1019, __pyx_L1_error)
        __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
        __pyx_t_11 = __Pyx_PyObject_Call(__pyx_t_7, __pyx_empty_tuple, __pyx_t_8); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1019, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_11);
        __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
        __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
        __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;

        /* "vapor_vali/Simple_function.pyx":1021
 *                 graphics.par(mfrow=IntVector([2,2]))
 *                 #penal 1
 *                 graphics.plot([min([i[0] for i in dotdata_record[0]]),max([i[0] for i in dotdata_record[0]])],[min([i[1] for i in dotdata_record[0]]),max([i[1] for i in dotdata_record[0]])],type='n',xlab='oroginal_reference',ylab='oroginal_reference')             # <<<<<<<<<<<<<<
 *                 graphics.points([i[0] for i in dotdata_record[0]],[i[1] for i in dotdata_record[0]],col='red',pch='+')
 *                 #penal 2
 */
        __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_v_graphics, __pyx_n_s_plot); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1021, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_11);
        __pyx_t_8 = PyList_New(0); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1021, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_8);
        __pyx_t_7 = __Pyx_GetItemInt_List(__pyx_v_dotdata_record, 0, long, 1, __Pyx_PyInt_From_long, 1, 0, 1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1021, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_7);
        if (likely(PyList_CheckExact(__pyx_t_7)) || PyTuple_CheckExact(__pyx_t_7)) {
          __pyx_t_3 = __pyx_t_7; __Pyx_INCREF(__pyx_t_3); __pyx_t_6 = 0;
          __pyx_t_13 = NULL;
        } else {
          __pyx_t_6 = -1; __pyx_t_3 = PyObject_GetIter(__pyx_t_7); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1021, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_3);
          __pyx_t_13 = Py_TYPE(__pyx_t_3)->tp_iternext; if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1021, __pyx_L1_error)
        }
        __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
        for (;;) {
          if (likely(!__pyx_t_13)) {
            if (likely(PyList_CheckExact(__pyx_t_3))) {
              if (__pyx_t_6 >= PyList_GET_SIZE(__pyx_t_3)) break;
              #if CYTHON_COMPILING_IN_CPYTHON
              __pyx_t_7 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_6); __Pyx_INCREF(__pyx_t_7); __pyx_t_6++; if (unlikely(0 < 0)) __PYX_ERR(0, 1021, __pyx_L1_error)
              #else
              __pyx_t_7 = PySequence_ITEM(__pyx_t_3, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1021, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_7);
              #endif
            } else {
              if (__pyx_t_6 >= PyTuple_GET_SIZE(__pyx_t_3)) break;
              #if CYTHON_COMPILING_IN_CPYTHON
              __pyx_t_7 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_6); __Pyx_INCREF(__pyx_t_7); __pyx_t_6++; if (unlikely(0 < 0)) __PYX_ERR(0, 1021, __pyx_L1_error)
              #else
              __pyx_t_7 = PySequence_ITEM(__pyx_t_3, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1021, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_7);
              #endif
            }
          } else {
            __pyx_t_7 = __pyx_t_13(__pyx_t_3);
            if (unlikely(!__pyx_t_7)) {
              PyObject* exc_type = PyErr_Occurred();
              if (exc_type) {
                if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
                else __PYX_ERR(0, 1021, __pyx_L1_error)
              }
              break;
            }
            __Pyx_GOTREF(__pyx_t_7);
          }
          __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_7);
          __pyx_t_7 = 0;
          __pyx_t_7 = __Pyx_GetItemInt(__pyx_v_i, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1021, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_7);
          if (unlikely(__Pyx_ListComp_Append(__pyx_t_8, (PyObject*)__pyx_t_7))) __PYX_ERR(0, 1021, __pyx_L1_error)
          __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
        }
        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
        __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1021, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_3);
        __Pyx_GIVEREF(__pyx_t_8);
        PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_8);
        __pyx_t_8 = 0;
        __pyx_t_8 = __Pyx_PyObject_Call(__pyx_builtin_min, __pyx_t_3, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1021, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_8);
        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
        __pyx_t_3 = PyList_New(0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1021, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_3);
        __pyx_t_7 = __Pyx_GetItemInt_List(__pyx_v_dotdata_record, 0, long, 1, __Pyx_PyInt_From_long, 1, 0, 1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1021, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_7);
        if (likely(PyList_CheckExact(__pyx_t_7)) || PyTuple_CheckExact(__pyx_t_7)) {
          __pyx_t_9 = __pyx_t_7; __Pyx_INCREF(__pyx_t_9); __pyx_t_6 = 0;
          __pyx_t_13 = NULL;
        } else {
          __pyx_t_6 = -1; __pyx_t_9 = PyObject_GetIter(__pyx_t_7); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1021, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_9);
          __pyx_t_13 = Py_TYPE(__pyx_t_9)->tp_iternext; if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1021, __pyx_L1_error)
        }
        __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
        for (;;) {
          if (likely(!__pyx_t_13)) {
            if (likely(PyList_CheckExact(__pyx_t_9))) {
              if (__pyx_t_6 >= PyList_GET_SIZE(__pyx_t_9)) break;
              #if CYTHON_COMPILING_IN_CPYTHON
              __pyx_t_7 = PyList_GET_ITEM(__pyx_t_9, __pyx_t_6); __Pyx_INCREF(__pyx_t_7); __pyx_t_6++; if (unlikely(0 < 0)) __PYX_ERR(0, 1021, __pyx_L1_error)
              #else
              __pyx_t_7 = PySequence_ITEM(__pyx_t_9, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1021, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_7);
              #endif
            } else {
              if (__pyx_t_6 >= PyTuple_GET_SIZE(__pyx_t_9)) break;
              #if CYTHON_COMPILING_IN_CPYTHON
              __pyx_t_7 = PyTuple_GET_ITEM(__pyx_t_9, __pyx_t_6); __Pyx_INCREF(__pyx_t_7); __pyx_t_6++; if (unlikely(0 < 0)) __PYX_ERR(0, 1021, __pyx_L1_error)
              #else
              __pyx_t_7 = PySequence_ITEM(__pyx_t_9, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1021, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_7);
              #endif
            }
          } else {
            __pyx_t_7 = __pyx_t_13(__pyx_t_9);
            if (unlikely(!__pyx_t_7)) {
              PyObject* exc_type = PyErr_Occurred();
              if (exc_type) {
                if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
                else __PYX_ERR(0, 1021, __pyx_L1_error)
              }
              break;
            }
            __Pyx_GOTREF(__pyx_t_7);
          }
          __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_7);
          __pyx_t_7 = 0;
          __pyx_t_7 = __Pyx_GetItemInt(__pyx_v_i, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1021, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_7);
          if (unlikely(__Pyx_ListComp_Append(__pyx_t_3, (PyObject*)__pyx_t_7))) __PYX_ERR(0, 1021, __pyx_L1_error)
          __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
        }
        __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
        __pyx_t_9 = PyTuple_New(1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1021, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_9);
        __Pyx_GIVEREF(__pyx_t_3);
        PyTuple_SET_ITEM(__pyx_t_9, 0, __pyx_t_3);
        __pyx_t_3 = 0;
        __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_max, __pyx_t_9, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1021, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_3);
        __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
        __pyx_t_9 = PyList_New(2); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1021, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_9);
        __Pyx_GIVEREF(__pyx_t_8);
        PyList_SET_ITEM(__pyx_t_9, 0, __pyx_t_8);
        __Pyx_GIVEREF(__pyx_t_3);
        PyList_SET_ITEM(__pyx_t_9, 1, __pyx_t_3);
        __pyx_t_8 = 0;
        __pyx_t_3 = 0;
        __pyx_t_3 = PyList_New(0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1021, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_3);
        __pyx_t_8 = __Pyx_GetItemInt_List(__pyx_v_dotdata_record, 0, long, 1, __Pyx_PyInt_From_long, 1, 0, 1); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1021, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_8);
        if (likely(PyList_CheckExact(__pyx_t_8)) || PyTuple_CheckExact(__pyx_t_8)) {
          __pyx_t_7 = __pyx_t_8; __Pyx_INCREF(__pyx_t_7); __pyx_t_6 = 0;
          __pyx_t_13 = NULL;
        } else {
          __pyx_t_6 = -1; __pyx_t_7 = PyObject_GetIter(__pyx_t_8); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1021, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_7);
          __pyx_t_13 = Py_TYPE(__pyx_t_7)->tp_iternext; if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1021, __pyx_L1_error)
        }
        __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
        for (;;) {
          if (likely(!__pyx_t_13)) {
            if (likely(PyList_CheckExact(__pyx_t_7))) {
              if (__pyx_t_6 >= PyList_GET_SIZE(__pyx_t_7)) break;
              #if CYTHON_COMPILING_IN_CPYTHON
              __pyx_t_8 = PyList_GET_ITEM(__pyx_t_7, __pyx_t_6); __Pyx_INCREF(__pyx_t_8); __pyx_t_6++; if (unlikely(0 < 0)) __PYX_ERR(0, 1021, __pyx_L1_error)
              #else
              __pyx_t_8 = PySequence_ITEM(__pyx_t_7, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1021, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_8);
              #endif
            } else {
              if (__pyx_t_6 >= PyTuple_GET_SIZE(__pyx_t_7)) break;
              #if CYTHON_COMPILING_IN_CPYTHON
              __pyx_t_8 = PyTuple_GET_ITEM(__pyx_t_7, __pyx_t_6); __Pyx_INCREF(__pyx_t_8); __pyx_t_6++; if (unlikely(0 < 0)) __PYX_ERR(0, 1021, __pyx_L1_error)
              #else
              __pyx_t_8 = PySequence_ITEM(__pyx_t_7, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1021, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_8);
              #endif
            }
          } else {
            __pyx_t_8 = __pyx_t_13(__pyx_t_7);
            if (unlikely(!__pyx_t_8)) {
              PyObject* exc_type = PyErr_Occurred();
              if (exc_type) {
                if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
                else __PYX_ERR(0, 1021, __pyx_L1_error)
              }
              break;
            }
            __Pyx_GOTREF(__pyx_t_8);
          }
          __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_8);
          __pyx_t_8 = 0;
          __pyx_t_8 = __Pyx_GetItemInt(__pyx_v_i, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1021, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_8);
          if (unlikely(__Pyx_ListComp_Append(__pyx_t_3, (PyObject*)__pyx_t_8))) __PYX_ERR(0, 1021, __pyx_L1_error)
          __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
        }
        __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
        __pyx_t_7 = PyTuple_New(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1021, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_7);
        __Pyx_GIVEREF(__pyx_t_3);
        PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_3);
        __pyx_t_3 = 0;
        __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_min, __pyx_t_7, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1021, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_3);
        __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
        __pyx_t_7 = PyList_New(0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1021, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_7);
        __pyx_t_8 = __Pyx_GetItemInt_List(__pyx_v_dotdata_record, 0, long, 1, __Pyx_PyInt_From_long, 1, 0, 1); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1021, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_8);
        if (likely(PyList_CheckExact(__pyx_t_8)) || PyTuple_CheckExact(__pyx_t_8)) {
          __pyx_t_4 = __pyx_t_8; __Pyx_INCREF(__pyx_t_4); __pyx_t_6 = 0;
          __pyx_t_13 = NULL;
        } else {
          __pyx_t_6 = -1; __pyx_t_4 = PyObject_GetIter(__pyx_t_8); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1021, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_4);
          __pyx_t_13 = Py_TYPE(__pyx_t_4)->tp_iternext; if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1021, __pyx_L1_error)
        }
        __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
        for (;;) {
          if (likely(!__pyx_t_13)) {
            if (likely(PyList_CheckExact(__pyx_t_4))) {
              if (__pyx_t_6 >= PyList_GET_SIZE(__pyx_t_4)) break;
              #if CYTHON_COMPILING_IN_CPYTHON
              __pyx_t_8 = PyList_GET_ITEM(__pyx_t_4, __pyx_t_6); __Pyx_INCREF(__pyx_t_8); __pyx_t_6++; if (unlikely(0 < 0)) __PYX_ERR(0, 1021, __pyx_L1_error)
              #else
              __pyx_t_8 = PySequence_ITEM(__pyx_t_4, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1021, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_8);
              #endif
            } else {
              if (__pyx_t_6 >= PyTuple_GET_SIZE(__pyx_t_4)) break;
              #if CYTHON_COMPILING_IN_CPYTHON
              __pyx_t_8 = PyTuple_GET_ITEM(__pyx_t_4, __pyx_t_6); __Pyx_INCREF(__pyx_t_8); __pyx_t_6++; if (unlikely(0 < 0)) __PYX_ERR(0, 1021, __pyx_L1_error)
              #else
              __pyx_t_8 = PySequence_ITEM(__pyx_t_4, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1021, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_8);
              #endif
            }
          } else {
            __pyx_t_8 = __pyx_t_13(__pyx_t_4);
            if (unlikely(!__pyx_t_8)) {
              PyObject* exc_type = PyErr_Occurred();
              if (exc_type) {
                if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
                else __PYX_ERR(0, 1021, __pyx_L1_error)
              }
              break;
            }
            __Pyx_GOTREF(__pyx_t_8);
          }
          __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_8);
          __pyx_t_8 = 0;
          __pyx_t_8 = __Pyx_GetItemInt(__pyx_v_i, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1021, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_8);
          if (unlikely(__Pyx_ListComp_Append(__pyx_t_7, (PyObject*)__pyx_t_8))) __PYX_ERR(0, 1021, __pyx_L1_error)
          __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
        }
        __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
        __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1021, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_4);
        __Pyx_GIVEREF(__pyx_t_7);
        PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_7);
        __pyx_t_7 = 0;
        __pyx_t_7 = __Pyx_PyObject_Call(__pyx_builtin_max, __pyx_t_4, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1021, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_7);
        __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
        __pyx_t_4 = PyList_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1021, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_4);
        __Pyx_GIVEREF(__pyx_t_3);
        PyList_SET_ITEM(__pyx_t_4, 0, __pyx_t_3);
        __Pyx_GIVEREF(__pyx_t_7);
        PyList_SET_ITEM(__pyx_t_4, 1, __pyx_t_7);
        __pyx_t_3 = 0;
        __pyx_t_7 = 0;
        __pyx_t_7 = PyTuple_New(2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1021, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_7);
        __Pyx_GIVEREF(__pyx_t_9);
        PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_9);
        __Pyx_GIVEREF(__pyx_t_4);
        PyTuple_SET_ITEM(__pyx_t_7, 1, __pyx_t_4);
        __pyx_t_9 = 0;
        __pyx_t_4 = 0;
        __pyx_t_4 = PyDict_New(); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1021, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_4);
        if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_type, __pyx_n_s_n) < 0) __PYX_ERR(0, 1021, __pyx_L1_error)
        if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_xlab, __pyx_n_s_oroginal_reference) < 0) __PYX_ERR(0, 1021, __pyx_L1_error)
        if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_ylab, __pyx_n_s_oroginal_reference) < 0) __PYX_ERR(0, 1021, __pyx_L1_error)
        __pyx_t_9 = __Pyx_PyObject_Call(__pyx_t_11, __pyx_t_7, __pyx_t_4); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1021, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_9);
        __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
        __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
        __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
        __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;

        /* "vapor_vali/Simple_function.pyx":1022
 *                 #penal 1
 *                 graphics.plot([min([i[0] for i in dotdata_record[0]]),max([i[0] for i in dotdata_record[0]])],[min([i[1] for i in dotdata_record[0]]),max([i[1] for i in dotdata_record[0]])],type='n',xlab='oroginal_reference',ylab='oroginal_reference')
 *                 graphics.points([i[0] for i in dotdata_record[0]],[i[1] for i in dotdata_record[0]],col='red',pch='+')             # <<<<<<<<<<<<<<
 *                 #penal 2
 *                 graphics.plot([min([i[0] for i in dotdata_record[1]]),max([i[0] for i in dotdata_record[1]])],[min([i[1] for i in dotdata_record[1]]),max([i[1] for i in dotdata_record[1]])],type='n',xlab='altered_reference',ylab='altered_reference')
 */
        __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_v_graphics, __pyx_n_s_points); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1022, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_9);
        __pyx_t_4 = PyList_New(0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1022, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_4);
        __pyx_t_7 = __Pyx_GetItemInt_List(__pyx_v_dotdata_record, 0, long, 1, __Pyx_PyInt_From_long, 1, 0, 1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1022, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_7);
        if (likely(PyList_CheckExact(__pyx_t_7)) || PyTuple_CheckExact(__pyx_t_7)) {
          __pyx_t_11 = __pyx_t_7; __Pyx_INCREF(__pyx_t_11); __pyx_t_6 = 0;
          __pyx_t_13 = NULL;
        } else {
          __pyx_t_6 = -1; __pyx_t_11 = PyObject_GetIter(__pyx_t_7); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1022, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_11);
          __pyx_t_13 = Py_TYPE(__pyx_t_11)->tp_iternext; if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1022, __pyx_L1_error)
        }
        __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
        for (;;) {
          if (likely(!__pyx_t_13)) {
            if (likely(PyList_CheckExact(__pyx_t_11))) {
              if (__pyx_t_6 >= PyList_GET_SIZE(__pyx_t_11)) break;
              #if CYTHON_COMPILING_IN_CPYTHON
              __pyx_t_7 = PyList_GET_ITEM(__pyx_t_11, __pyx_t_6); __Pyx_INCREF(__pyx_t_7); __pyx_t_6++; if (unlikely(0 < 0)) __PYX_ERR(0, 1022, __pyx_L1_error)
              #else
              __pyx_t_7 = PySequence_ITEM(__pyx_t_11, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1022, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_7);
              #endif
            } else {
              if (__pyx_t_6 >= PyTuple_GET_SIZE(__pyx_t_11)) break;
              #if CYTHON_COMPILING_IN_CPYTHON
              __pyx_t_7 = PyTuple_GET_ITEM(__pyx_t_11, __pyx_t_6); __Pyx_INCREF(__pyx_t_7); __pyx_t_6++; if (unlikely(0 < 0)) __PYX_ERR(0, 1022, __pyx_L1_error)
              #else
              __pyx_t_7 = PySequence_ITEM(__pyx_t_11, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1022, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_7);
              #endif
            }
          } else {
            __pyx_t_7 = __pyx_t_13(__pyx_t_11);
            if (unlikely(!__pyx_t_7)) {
              PyObject* exc_type = PyErr_Occurred();
              if (exc_type) {
                if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
                else __PYX_ERR(0, 1022, __pyx_L1_error)
              }
              break;
            }
            __Pyx_GOTREF(__pyx_t_7);
          }
          __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_7);
          __pyx_t_7 = 0;
          __pyx_t_7 = __Pyx_GetItemInt(__pyx_v_i, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1022, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_7);
          if (unlikely(__Pyx_ListComp_Append(__pyx_t_4, (PyObject*)__pyx_t_7))) __PYX_ERR(0, 1022, __pyx_L1_error)
          __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
        }
        __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
        __pyx_t_11 = PyList_New(0); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1022, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_11);
        __pyx_t_7 = __Pyx_GetItemInt_List(__pyx_v_dotdata_record, 0, long, 1, __Pyx_PyInt_From_long, 1, 0, 1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1022, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_7);
        if (likely(PyList_CheckExact(__pyx_t_7)) || PyTuple_CheckExact(__pyx_t_7)) {
          __pyx_t_3 = __pyx_t_7; __Pyx_INCREF(__pyx_t_3); __pyx_t_6 = 0;
          __pyx_t_13 = NULL;
        } else {
          __pyx_t_6 = -1; __pyx_t_3 = PyObject_GetIter(__pyx_t_7); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1022, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_3);
          __pyx_t_13 = Py_TYPE(__pyx_t_3)->tp_iternext; if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1022, __pyx_L1_error)
        }
        __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
        for (;;) {
          if (likely(!__pyx_t_13)) {
            if (likely(PyList_CheckExact(__pyx_t_3))) {
              if (__pyx_t_6 >= PyList_GET_SIZE(__pyx_t_3)) break;
              #if CYTHON_COMPILING_IN_CPYTHON
              __pyx_t_7 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_6); __Pyx_INCREF(__pyx_t_7); __pyx_t_6++; if (unlikely(0 < 0)) __PYX_ERR(0, 1022, __pyx_L1_error)
              #else
              __pyx_t_7 = PySequence_ITEM(__pyx_t_3, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1022, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_7);
              #endif
            } else {
              if (__pyx_t_6 >= PyTuple_GET_SIZE(__pyx_t_3)) break;
              #if CYTHON_COMPILING_IN_CPYTHON
              __pyx_t_7 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_6); __Pyx_INCREF(__pyx_t_7); __pyx_t_6++; if (unlikely(0 < 0)) __PYX_ERR(0, 1022, __pyx_L1_error)
              #else
              __pyx_t_7 = PySequence_ITEM(__pyx_t_3, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1022, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_7);
              #endif
            }
          } else {
            __pyx_t_7 = __pyx_t_13(__pyx_t_3);
            if (unlikely(!__pyx_t_7)) {
              PyObject* exc_type = PyErr_Occurred();
              if (exc_type) {
                if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
                else __PYX_ERR(0, 1022, __pyx_L1_error)
              }
              break;
            }
            __Pyx_GOTREF(__pyx_t_7);
          }
          __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_7);
          __pyx_t_7 = 0;
          __pyx_t_7 = __Pyx_GetItemInt(__pyx_v_i, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1022, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_7);
          if (unlikely(__Pyx_ListComp_Append(__pyx_t_11, (PyObject*)__pyx_t_7))) __PYX_ERR(0, 1022, __pyx_L1_error)
          __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
        }
        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
        __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1022, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_3);
        __Pyx_GIVEREF(__pyx_t_4);
        PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_4);
        __Pyx_GIVEREF(__pyx_t_11);
        PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_t_11);
        __pyx_t_4 = 0;
        __pyx_t_11 = 0;
        __pyx_t_11 = PyDict_New(); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1022, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_11);
        if (PyDict_SetItem(__pyx_t_11, __pyx_n_s_col, __pyx_n_s_red) < 0) __PYX_ERR(0, 1022, __pyx_L1_error)
        if (PyDict_SetItem(__pyx_t_11, __pyx_n_s_pch, __pyx_kp_s__2) < 0) __PYX_ERR(0, 1022, __pyx_L1_error)
        __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_9, __pyx_t_3, __pyx_t_11); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1022, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_4);
        __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
        __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
        __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;

        /* "vapor_vali/Simple_function.pyx":1024
 *                 graphics.points([i[0] for i in dotdata_record[0]],[i[1] for i in dotdata_record[0]],col='red',pch='+')
 *                 #penal 2
 *                 graphics.plot([min([i[0] for i in dotdata_record[1]]),max([i[0] for i in dotdata_record[1]])],[min([i[1] for i in dotdata_record[1]]),max([i[1] for i in dotdata_record[1]])],type='n',xlab='altered_reference',ylab='altered_reference')             # <<<<<<<<<<<<<<
 *                 graphics.points([i[0] for i in dotdata_record[1]],[i[1] for i in dotdata_record[1]],col='red',pch='+')
 *                 #penal 3
 */
        __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_graphics, __pyx_n_s_plot); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1024, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_4);
        __pyx_t_11 = PyList_New(0); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1024, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_11);
        __pyx_t_3 = __Pyx_GetItemInt_List(__pyx_v_dotdata_record, 1, long, 1, __Pyx_PyInt_From_long, 1, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1024, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_3);
        if (likely(PyList_CheckExact(__pyx_t_3)) || PyTuple_CheckExact(__pyx_t_3)) {
          __pyx_t_9 = __pyx_t_3; __Pyx_INCREF(__pyx_t_9); __pyx_t_6 = 0;
          __pyx_t_13 = NULL;
        } else {
          __pyx_t_6 = -1; __pyx_t_9 = PyObject_GetIter(__pyx_t_3); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1024, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_9);
          __pyx_t_13 = Py_TYPE(__pyx_t_9)->tp_iternext; if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1024, __pyx_L1_error)
        }
        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
        for (;;) {
          if (likely(!__pyx_t_13)) {
            if (likely(PyList_CheckExact(__pyx_t_9))) {
              if (__pyx_t_6 >= PyList_GET_SIZE(__pyx_t_9)) break;
              #if CYTHON_COMPILING_IN_CPYTHON
              __pyx_t_3 = PyList_GET_ITEM(__pyx_t_9, __pyx_t_6); __Pyx_INCREF(__pyx_t_3); __pyx_t_6++; if (unlikely(0 < 0)) __PYX_ERR(0, 1024, __pyx_L1_error)
              #else
              __pyx_t_3 = PySequence_ITEM(__pyx_t_9, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1024, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_3);
              #endif
            } else {
              if (__pyx_t_6 >= PyTuple_GET_SIZE(__pyx_t_9)) break;
              #if CYTHON_COMPILING_IN_CPYTHON
              __pyx_t_3 = PyTuple_GET_ITEM(__pyx_t_9, __pyx_t_6); __Pyx_INCREF(__pyx_t_3); __pyx_t_6++; if (unlikely(0 < 0)) __PYX_ERR(0, 1024, __pyx_L1_error)
              #else
              __pyx_t_3 = PySequence_ITEM(__pyx_t_9, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1024, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_3);
              #endif
            }
          } else {
            __pyx_t_3 = __pyx_t_13(__pyx_t_9);
            if (unlikely(!__pyx_t_3)) {
              PyObject* exc_type = PyErr_Occurred();
              if (exc_type) {
                if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
                else __PYX_ERR(0, 1024, __pyx_L1_error)
              }
              break;
            }
            __Pyx_GOTREF(__pyx_t_3);
          }
          __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_3);
          __pyx_t_3 = 0;
          __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_i, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1024, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_3);
          if (unlikely(__Pyx_ListComp_Append(__pyx_t_11, (PyObject*)__pyx_t_3))) __PYX_ERR(0, 1024, __pyx_L1_error)
          __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
        }
        __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
        __pyx_t_9 = PyTuple_New(1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1024, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_9);
        __Pyx_GIVEREF(__pyx_t_11);
        PyTuple_SET_ITEM(__pyx_t_9, 0, __pyx_t_11);
        __pyx_t_11 = 0;
        __pyx_t_11 = __Pyx_PyObject_Call(__pyx_builtin_min, __pyx_t_9, NULL); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1024, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_11);
        __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
        __pyx_t_9 = PyList_New(0); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1024, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_9);
        __pyx_t_3 = __Pyx_GetItemInt_List(__pyx_v_dotdata_record, 1, long, 1, __Pyx_PyInt_From_long, 1, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1024, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_3);
        if (likely(PyList_CheckExact(__pyx_t_3)) || PyTuple_CheckExact(__pyx_t_3)) {
          __pyx_t_7 = __pyx_t_3; __Pyx_INCREF(__pyx_t_7); __pyx_t_6 = 0;
          __pyx_t_13 = NULL;
        } else {
          __pyx_t_6 = -1; __pyx_t_7 = PyObject_GetIter(__pyx_t_3); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1024, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_7);
          __pyx_t_13 = Py_TYPE(__pyx_t_7)->tp_iternext; if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1024, __pyx_L1_error)
        }
        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
        for (;;) {
          if (likely(!__pyx_t_13)) {
            if (likely(PyList_CheckExact(__pyx_t_7))) {
              if (__pyx_t_6 >= PyList_GET_SIZE(__pyx_t_7)) break;
              #if CYTHON_COMPILING_IN_CPYTHON
              __pyx_t_3 = PyList_GET_ITEM(__pyx_t_7, __pyx_t_6); __Pyx_INCREF(__pyx_t_3); __pyx_t_6++; if (unlikely(0 < 0)) __PYX_ERR(0, 1024, __pyx_L1_error)
              #else
              __pyx_t_3 = PySequence_ITEM(__pyx_t_7, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1024, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_3);
              #endif
            } else {
              if (__pyx_t_6 >= PyTuple_GET_SIZE(__pyx_t_7)) break;
              #if CYTHON_COMPILING_IN_CPYTHON
              __pyx_t_3 = PyTuple_GET_ITEM(__pyx_t_7, __pyx_t_6); __Pyx_INCREF(__pyx_t_3); __pyx_t_6++; if (unlikely(0 < 0)) __PYX_ERR(0, 1024, __pyx_L1_error)
              #else
              __pyx_t_3 = PySequence_ITEM(__pyx_t_7, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1024, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_3);
              #endif
            }
          } else {
            __pyx_t_3 = __pyx_t_13(__pyx_t_7);
            if (unlikely(!__pyx_t_3)) {
              PyObject* exc_type = PyErr_Occurred();
              if (exc_type) {
                if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
                else __PYX_ERR(0, 1024, __pyx_L1_error)
              }
              break;
            }
            __Pyx_GOTREF(__pyx_t_3);
          }
          __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_3);
          __pyx_t_3 = 0;
          __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_i, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1024, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_3);
          if (unlikely(__Pyx_ListComp_Append(__pyx_t_9, (PyObject*)__pyx_t_3))) __PYX_ERR(0, 1024, __pyx_L1_error)
          __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
        }
        __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
        __pyx_t_7 = PyTuple_New(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1024, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_7);
        __Pyx_GIVEREF(__pyx_t_9);
        PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_9);
        __pyx_t_9 = 0;
        __pyx_t_9 = __Pyx_PyObject_Call(__pyx_builtin_max, __pyx_t_7, NULL); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1024, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_9);
        __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
        __pyx_t_7 = PyList_New(2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1024, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_7);
        __Pyx_GIVEREF(__pyx_t_11);
        PyList_SET_ITEM(__pyx_t_7, 0, __pyx_t_11);
        __Pyx_GIVEREF(__pyx_t_9);
        PyList_SET_ITEM(__pyx_t_7, 1, __pyx_t_9);
        __pyx_t_11 = 0;
        __pyx_t_9 = 0;
        __pyx_t_9 = PyList_New(0); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1024, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_9);
        __pyx_t_11 = __Pyx_GetItemInt_List(__pyx_v_dotdata_record, 1, long, 1, __Pyx_PyInt_From_long, 1, 0, 1); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1024, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_11);
        if (likely(PyList_CheckExact(__pyx_t_11)) || PyTuple_CheckExact(__pyx_t_11)) {
          __pyx_t_3 = __pyx_t_11; __Pyx_INCREF(__pyx_t_3); __pyx_t_6 = 0;
          __pyx_t_13 = NULL;
        } else {
          __pyx_t_6 = -1; __pyx_t_3 = PyObject_GetIter(__pyx_t_11); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1024, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_3);
          __pyx_t_13 = Py_TYPE(__pyx_t_3)->tp_iternext; if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1024, __pyx_L1_error)
        }
        __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
        for (;;) {
          if (likely(!__pyx_t_13)) {
            if (likely(PyList_CheckExact(__pyx_t_3))) {
              if (__pyx_t_6 >= PyList_GET_SIZE(__pyx_t_3)) break;
              #if CYTHON_COMPILING_IN_CPYTHON
              __pyx_t_11 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_6); __Pyx_INCREF(__pyx_t_11); __pyx_t_6++; if (unlikely(0 < 0)) __PYX_ERR(0, 1024, __pyx_L1_error)
              #else
              __pyx_t_11 = PySequence_ITEM(__pyx_t_3, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1024, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_11);
              #endif
            } else {
              if (__pyx_t_6 >= PyTuple_GET_SIZE(__pyx_t_3)) break;
              #if CYTHON_COMPILING_IN_CPYTHON
              __pyx_t_11 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_6); __Pyx_INCREF(__pyx_t_11); __pyx_t_6++; if (unlikely(0 < 0)) __PYX_ERR(0, 1024, __pyx_L1_error)
              #else
              __pyx_t_11 = PySequence_ITEM(__pyx_t_3, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1024, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_11);
              #endif
            }
          } else {
            __pyx_t_11 = __pyx_t_13(__pyx_t_3);
            if (unlikely(!__pyx_t_11)) {
              PyObject* exc_type = PyErr_Occurred();
              if (exc_type) {
                if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
                else __PYX_ERR(0, 1024, __pyx_L1_error)
              }
              break;
            }
            __Pyx_GOTREF(__pyx_t_11);
          }
          __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_11);
          __pyx_t_11 = 0;
          __pyx_t_11 = __Pyx_GetItemInt(__pyx_v_i, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1024, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_11);
          if (unlikely(__Pyx_ListComp_Append(__pyx_t_9, (PyObject*)__pyx_t_11))) __PYX_ERR(0, 1024, __pyx_L1_error)
          __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
        }
        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
        __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1024, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_3);
        __Pyx_GIVEREF(__pyx_t_9);
        PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_9);
        __pyx_t_9 = 0;
        __pyx_t_9 = __Pyx_PyObject_Call(__pyx_builtin_min, __pyx_t_3, NULL); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1024, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_9);
        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
        __pyx_t_3 = PyList_New(0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1024, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_3);
        __pyx_t_11 = __Pyx_GetItemInt_List(__pyx_v_dotdata_record, 1, long, 1, __Pyx_PyInt_From_long, 1, 0, 1); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1024, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_11);
        if (likely(PyList_CheckExact(__pyx_t_11)) || PyTuple_CheckExact(__pyx_t_11)) {
          __pyx_t_8 = __pyx_t_11; __Pyx_INCREF(__pyx_t_8); __pyx_t_6 = 0;
          __pyx_t_13 = NULL;
        } else {
          __pyx_t_6 = -1; __pyx_t_8 = PyObject_GetIter(__pyx_t_11); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1024, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_8);
          __pyx_t_13 = Py_TYPE(__pyx_t_8)->tp_iternext; if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1024, __pyx_L1_error)
        }
        __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
        for (;;) {
          if (likely(!__pyx_t_13)) {
            if (likely(PyList_CheckExact(__pyx_t_8))) {
              if (__pyx_t_6 >= PyList_GET_SIZE(__pyx_t_8)) break;
              #if CYTHON_COMPILING_IN_CPYTHON
              __pyx_t_11 = PyList_GET_ITEM(__pyx_t_8, __pyx_t_6); __Pyx_INCREF(__pyx_t_11); __pyx_t_6++; if (unlikely(0 < 0)) __PYX_ERR(0, 1024, __pyx_L1_error)
              #else
              __pyx_t_11 = PySequence_ITEM(__pyx_t_8, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1024, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_11);
              #endif
            } else {
              if (__pyx_t_6 >= PyTuple_GET_SIZE(__pyx_t_8)) break;
              #if CYTHON_COMPILING_IN_CPYTHON
              __pyx_t_11 = PyTuple_GET_ITEM(__pyx_t_8, __pyx_t_6); __Pyx_INCREF(__pyx_t_11); __pyx_t_6++; if (unlikely(0 < 0)) __PYX_ERR(0, 1024, __pyx_L1_error)
              #else
              __pyx_t_11 = PySequence_ITEM(__pyx_t_8, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1024, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_11);
              #endif
            }
          } else {
            __pyx_t_11 = __pyx_t_13(__pyx_t_8);
            if (unlikely(!__pyx_t_11)) {
              PyObject* exc_type = PyErr_Occurred();
              if (exc_type) {
                if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
                else __PYX_ERR(0, 1024, __pyx_L1_error)
              }
              break;
            }
            __Pyx_GOTREF(__pyx_t_11);
          }
          __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_11);
          __pyx_t_11 = 0;
          __pyx_t_11 = __Pyx_GetItemInt(__pyx_v_i, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1024, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_11);
          if (unlikely(__Pyx_ListComp_Append(__pyx_t_3, (PyObject*)__pyx_t_11))) __PYX_ERR(0, 1024, __pyx_L1_error)
          __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
        }
        __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
        __pyx_t_8 = PyTuple_New(1); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1024, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_8);
        __Pyx_GIVEREF(__pyx_t_3);
        PyTuple_SET_ITEM(__pyx_t_8, 0, __pyx_t_3);
        __pyx_t_3 = 0;
        __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_max, __pyx_t_8, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1024, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_3);
        __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
        __pyx_t_8 = PyList_New(2); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1024, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_8);
        __Pyx_GIVEREF(__pyx_t_9);
        PyList_SET_ITEM(__pyx_t_8, 0, __pyx_t_9);
        __Pyx_GIVEREF(__pyx_t_3);
        PyList_SET_ITEM(__pyx_t_8, 1, __pyx_t_3);
        __pyx_t_9 = 0;
        __pyx_t_3 = 0;
        __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1024, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_3);
        __Pyx_GIVEREF(__pyx_t_7);
        PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_7);
        __Pyx_GIVEREF(__pyx_t_8);
        PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_t_8);
        __pyx_t_7 = 0;
        __pyx_t_8 = 0;
        __pyx_t_8 = PyDict_New(); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1024, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_8);
        if (PyDict_SetItem(__pyx_t_8, __pyx_n_s_type, __pyx_n_s_n) < 0) __PYX_ERR(0, 1024, __pyx_L1_error)
        if (PyDict_SetItem(__pyx_t_8, __pyx_n_s_xlab, __pyx_n_s_altered_reference) < 0) __PYX_ERR(0, 1024, __pyx_L1_error)
        if (PyDict_SetItem(__pyx_t_8, __pyx_n_s_ylab, __pyx_n_s_altered_reference) < 0) __PYX_ERR(0, 1024, __pyx_L1_error)
        __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_3, __pyx_t_8); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1024, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_7);
        __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
        __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
        __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;

        /* "vapor_vali/Simple_function.pyx":1025
 *                 #penal 2
 *                 graphics.plot([min([i[0] for i in dotdata_record[1]]),max([i[0] for i in dotdata_record[1]])],[min([i[1] for i in dotdata_record[1]]),max([i[1] for i in dotdata_record[1]])],type='n',xlab='altered_reference',ylab='altered_reference')
 *                 graphics.points([i[0] for i in dotdata_record[1]],[i[1] for i in dotdata_record[1]],col='red',pch='+')             # <<<<<<<<<<<<<<
 *                 #penal 3
 *                 graphics.plot([min([i[0] for i in dotdata_record[2]]),max([i[0] for i in dotdata_record[2]])],[min([i[1] for i in dotdata_record[2]]),max([i[1] for i in dotdata_record[2]])],type='n',ylab='PacBio read',xlab='oroginal_reference')
 */
        __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_graphics, __pyx_n_s_points); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1025, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_7);
        __pyx_t_8 = PyList_New(0); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1025, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_8);
        __pyx_t_3 = __Pyx_GetItemInt_List(__pyx_v_dotdata_record, 1, long, 1, __Pyx_PyInt_From_long, 1, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1025, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_3);
        if (likely(PyList_CheckExact(__pyx_t_3)) || PyTuple_CheckExact(__pyx_t_3)) {
          __pyx_t_4 = __pyx_t_3; __Pyx_INCREF(__pyx_t_4); __pyx_t_6 = 0;
          __pyx_t_13 = NULL;
        } else {
          __pyx_t_6 = -1; __pyx_t_4 = PyObject_GetIter(__pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1025, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_4);
          __pyx_t_13 = Py_TYPE(__pyx_t_4)->tp_iternext; if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1025, __pyx_L1_error)
        }
        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
        for (;;) {
          if (likely(!__pyx_t_13)) {
            if (likely(PyList_CheckExact(__pyx_t_4))) {
              if (__pyx_t_6 >= PyList_GET_SIZE(__pyx_t_4)) break;
              #if CYTHON_COMPILING_IN_CPYTHON
              __pyx_t_3 = PyList_GET_ITEM(__pyx_t_4, __pyx_t_6); __Pyx_INCREF(__pyx_t_3); __pyx_t_6++; if (unlikely(0 < 0)) __PYX_ERR(0, 1025, __pyx_L1_error)
              #else
              __pyx_t_3 = PySequence_ITEM(__pyx_t_4, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1025, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_3);
              #endif
            } else {
              if (__pyx_t_6 >= PyTuple_GET_SIZE(__pyx_t_4)) break;
              #if CYTHON_COMPILING_IN_CPYTHON
              __pyx_t_3 = PyTuple_GET_ITEM(__pyx_t_4, __pyx_t_6); __Pyx_INCREF(__pyx_t_3); __pyx_t_6++; if (unlikely(0 < 0)) __PYX_ERR(0, 1025, __pyx_L1_error)
              #else
              __pyx_t_3 = PySequence_ITEM(__pyx_t_4, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1025, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_3);
              #endif
            }
          } else {
            __pyx_t_3 = __pyx_t_13(__pyx_t_4);
            if (unlikely(!__pyx_t_3)) {
              PyObject* exc_type = PyErr_Occurred();
              if (exc_type) {
                if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
                else __PYX_ERR(0, 1025, __pyx_L1_error)
              }
              break;
            }
            __Pyx_GOTREF(__pyx_t_3);
          }
          __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_3);
          __pyx_t_3 = 0;
          __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_i, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1025, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_3);
          if (unlikely(__Pyx_ListComp_Append(__pyx_t_8, (PyObject*)__pyx_t_3))) __PYX_ERR(0, 1025, __pyx_L1_error)
          __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
        }
        __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
        __pyx_t_4 = PyList_New(0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1025, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_4);
        __pyx_t_3 = __Pyx_GetItemInt_List(__pyx_v_dotdata_record, 1, long, 1, __Pyx_PyInt_From_long, 1, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1025, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_3);
        if (likely(PyList_CheckExact(__pyx_t_3)) || PyTuple_CheckExact(__pyx_t_3)) {
          __pyx_t_9 = __pyx_t_3; __Pyx_INCREF(__pyx_t_9); __pyx_t_6 = 0;
          __pyx_t_13 = NULL;
        } else {
          __pyx_t_6 = -1; __pyx_t_9 = PyObject_GetIter(__pyx_t_3); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1025, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_9);
          __pyx_t_13 = Py_TYPE(__pyx_t_9)->tp_iternext; if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1025, __pyx_L1_error)
        }
        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
        for (;;) {
          if (likely(!__pyx_t_13)) {
            if (likely(PyList_CheckExact(__pyx_t_9))) {
              if (__pyx_t_6 >= PyList_GET_SIZE(__pyx_t_9)) break;
              #if CYTHON_COMPILING_IN_CPYTHON
              __pyx_t_3 = PyList_GET_ITEM(__pyx_t_9, __pyx_t_6); __Pyx_INCREF(__pyx_t_3); __pyx_t_6++; if (unlikely(0 < 0)) __PYX_ERR(0, 1025, __pyx_L1_error)
              #else
              __pyx_t_3 = PySequence_ITEM(__pyx_t_9, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1025, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_3);
              #endif
            } else {
              if (__pyx_t_6 >= PyTuple_GET_SIZE(__pyx_t_9)) break;
              #if CYTHON_COMPILING_IN_CPYTHON
              __pyx_t_3 = PyTuple_GET_ITEM(__pyx_t_9, __pyx_t_6); __Pyx_INCREF(__pyx_t_3); __pyx_t_6++; if (unlikely(0 < 0)) __PYX_ERR(0, 1025, __pyx_L1_error)
              #else
              __pyx_t_3 = PySequence_ITEM(__pyx_t_9, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1025, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_3);
              #endif
            }
          } else {
            __pyx_t_3 = __pyx_t_13(__pyx_t_9);
            if (unlikely(!__pyx_t_3)) {
              PyObject* exc_type = PyErr_Occurred();
              if (exc_type) {
                if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
                else __PYX_ERR(0, 1025, __pyx_L1_error)
              }
              break;
            }
            __Pyx_GOTREF(__pyx_t_3);
          }
          __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_3);
          __pyx_t_3 = 0;
          __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_i, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1025, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_3);
          if (unlikely(__Pyx_ListComp_Append(__pyx_t_4, (PyObject*)__pyx_t_3))) __PYX_ERR(0, 1025, __pyx_L1_error)
          __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
        }
        __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
        __pyx_t_9 = PyTuple_New(2); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1025, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_9);
        __Pyx_GIVEREF(__pyx_t_8);
        PyTuple_SET_ITEM(__pyx_t_9, 0, __pyx_t_8);
        __Pyx_GIVEREF(__pyx_t_4);
        PyTuple_SET_ITEM(__pyx_t_9, 1, __pyx_t_4);
        __pyx_t_8 = 0;
        __pyx_t_4 = 0;
        __pyx_t_4 = PyDict_New(); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1025, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_4);
        if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_col, __pyx_n_s_red) < 0) __PYX_ERR(0, 1025, __pyx_L1_error)
        if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_pch, __pyx_kp_s__2) < 0) __PYX_ERR(0, 1025, __pyx_L1_error)
        __pyx_t_8 = __Pyx_PyObject_Call(__pyx_t_7, __pyx_t_9, __pyx_t_4); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1025, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_8);
        __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
        __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
        __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
        __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;

        /* "vapor_vali/Simple_function.pyx":1027
 *                 graphics.points([i[0] for i in dotdata_record[1]],[i[1] for i in dotdata_record[1]],col='red',pch='+')
 *                 #penal 3
 *                 graphics.plot([min([i[0] for i in dotdata_record[2]]),max([i[0] for i in dotdata_record[2]])],[min([i[1] for i in dotdata_record[2]]),max([i[1] for i in dotdata_record[2]])],type='n',ylab='PacBio read',xlab='oroginal_reference')             # <<<<<<<<<<<<<<
 *                 graphics.points([i[0] for i in dotdata_record[2]],[i[1] for i in dotdata_record[2]],col='red',pch='+')
 *                 #penal 4
 */
        __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_v_graphics, __pyx_n_s_plot); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1027, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_8);
        __pyx_t_4 = PyList_New(0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1027, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_4);
        __pyx_t_9 = __Pyx_GetItemInt_List(__pyx_v_dotdata_record, 2, long, 1, __Pyx_PyInt_From_long, 1, 0, 1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1027, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_9);
        if (likely(PyList_CheckExact(__pyx_t_9)) || PyTuple_CheckExact(__pyx_t_9)) {
          __pyx_t_7 = __pyx_t_9; __Pyx_INCREF(__pyx_t_7); __pyx_t_6 = 0;
          __pyx_t_13 = NULL;
        } else {
          __pyx_t_6 = -1; __pyx_t_7 = PyObject_GetIter(__pyx_t_9); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1027, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_7);
          __pyx_t_13 = Py_TYPE(__pyx_t_7)->tp_iternext; if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1027, __pyx_L1_error)
        }
        __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
        for (;;) {
          if (likely(!__pyx_t_13)) {
            if (likely(PyList_CheckExact(__pyx_t_7))) {
              if (__pyx_t_6 >= PyList_GET_SIZE(__pyx_t_7)) break;
              #if CYTHON_COMPILING_IN_CPYTHON
              __pyx_t_9 = PyList_GET_ITEM(__pyx_t_7, __pyx_t_6); __Pyx_INCREF(__pyx_t_9); __pyx_t_6++; if (unlikely(0 < 0)) __PYX_ERR(0, 1027, __pyx_L1_error)
              #else
              __pyx_t_9 = PySequence_ITEM(__pyx_t_7, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1027, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_9);
              #endif
            } else {
              if (__pyx_t_6 >= PyTuple_GET_SIZE(__pyx_t_7)) break;
              #if CYTHON_COMPILING_IN_CPYTHON
              __pyx_t_9 = PyTuple_GET_ITEM(__pyx_t_7, __pyx_t_6); __Pyx_INCREF(__pyx_t_9); __pyx_t_6++; if (unlikely(0 < 0)) __PYX_ERR(0, 1027, __pyx_L1_error)
              #else
              __pyx_t_9 = PySequence_ITEM(__pyx_t_7, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1027, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_9);
              #endif
            }
          } else {
            __pyx_t_9 = __pyx_t_13(__pyx_t_7);
            if (unlikely(!__pyx_t_9)) {
              PyObject* exc_type = PyErr_Occurred();
              if (exc_type) {
                if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
                else __PYX_ERR(0, 1027, __pyx_L1_error)
              }
              break;
            }
            __Pyx_GOTREF(__pyx_t_9);
          }
          __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_9);
          __pyx_t_9 = 0;
          __pyx_t_9 = __Pyx_GetItemInt(__pyx_v_i, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1027, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_9);
          if (unlikely(__Pyx_ListComp_Append(__pyx_t_4, (PyObject*)__pyx_t_9))) __PYX_ERR(0, 1027, __pyx_L1_error)
          __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
        }
        __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
        __pyx_t_7 = PyTuple_New(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1027, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_7);
        __Pyx_GIVEREF(__pyx_t_4);
        PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_4);
        __pyx_t_4 = 0;
        __pyx_t_4 = __Pyx_PyObject_Call(__pyx_builtin_min, __pyx_t_7, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1027, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_4);
        __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
        __pyx_t_7 = PyList_New(0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1027, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_7);
        __pyx_t_9 = __Pyx_GetItemInt_List(__pyx_v_dotdata_record, 2, long, 1, __Pyx_PyInt_From_long, 1, 0, 1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1027, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_9);
        if (likely(PyList_CheckExact(__pyx_t_9)) || PyTuple_CheckExact(__pyx_t_9)) {
          __pyx_t_3 = __pyx_t_9; __Pyx_INCREF(__pyx_t_3); __pyx_t_6 = 0;
          __pyx_t_13 = NULL;
        } else {
          __pyx_t_6 = -1; __pyx_t_3 = PyObject_GetIter(__pyx_t_9); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1027, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_3);
          __pyx_t_13 = Py_TYPE(__pyx_t_3)->tp_iternext; if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1027, __pyx_L1_error)
        }
        __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
        for (;;) {
          if (likely(!__pyx_t_13)) {
            if (likely(PyList_CheckExact(__pyx_t_3))) {
              if (__pyx_t_6 >= PyList_GET_SIZE(__pyx_t_3)) break;
              #if CYTHON_COMPILING_IN_CPYTHON
              __pyx_t_9 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_6); __Pyx_INCREF(__pyx_t_9); __pyx_t_6++; if (unlikely(0 < 0)) __PYX_ERR(0, 1027, __pyx_L1_error)
              #else
              __pyx_t_9 = PySequence_ITEM(__pyx_t_3, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1027, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_9);
              #endif
            } else {
              if (__pyx_t_6 >= PyTuple_GET_SIZE(__pyx_t_3)) break;
              #if CYTHON_COMPILING_IN_CPYTHON
              __pyx_t_9 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_6); __Pyx_INCREF(__pyx_t_9); __pyx_t_6++; if (unlikely(0 < 0)) __PYX_ERR(0, 1027, __pyx_L1_error)
              #else
              __pyx_t_9 = PySequence_ITEM(__pyx_t_3, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1027, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_9);
              #endif
            }
          } else {
            __pyx_t_9 = __pyx_t_13(__pyx_t_3);
            if (unlikely(!__pyx_t_9)) {
              PyObject* exc_type = PyErr_Occurred();
              if (exc_type) {
                if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
                else __PYX_ERR(0, 1027, __pyx_L1_error)
              }
              break;
            }
            __Pyx_GOTREF(__pyx_t_9);
          }
          __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_9);
          __pyx_t_9 = 0;
          __pyx_t_9 = __Pyx_GetItemInt(__pyx_v_i, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1027, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_9);
          if (unlikely(__Pyx_ListComp_Append(__pyx_t_7, (PyObject*)__pyx_t_9))) __PYX_ERR(0, 1027, __pyx_L1_error)
          __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
        }
        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
        __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1027, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_3);
        __Pyx_GIVEREF(__pyx_t_7);
        PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_7);
        __pyx_t_7 = 0;
        __pyx_t_7 = __Pyx_PyObject_Call(__pyx_builtin_max, __pyx_t_3, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1027, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_7);
        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
        __pyx_t_3 = PyList_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1027, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_3);
        __Pyx_GIVEREF(__pyx_t_4);
        PyList_SET_ITEM(__pyx_t_3, 0, __pyx_t_4);
        __Pyx_GIVEREF(__pyx_t_7);
        PyList_SET_ITEM(__pyx_t_3, 1, __pyx_t_7);
        __pyx_t_4 = 0;
        __pyx_t_7 = 0;
        __pyx_t_7 = PyList_New(0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1027, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_7);
        __pyx_t_4 = __Pyx_GetItemInt_List(__pyx_v_dotdata_record, 2, long, 1, __Pyx_PyInt_From_long, 1, 0, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1027, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_4);
        if (likely(PyList_CheckExact(__pyx_t_4)) || PyTuple_CheckExact(__pyx_t_4)) {
          __pyx_t_9 = __pyx_t_4; __Pyx_INCREF(__pyx_t_9); __pyx_t_6 = 0;
          __pyx_t_13 = NULL;
        } else {
          __pyx_t_6 = -1; __pyx_t_9 = PyObject_GetIter(__pyx_t_4); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1027, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_9);
          __pyx_t_13 = Py_TYPE(__pyx_t_9)->tp_iternext; if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1027, __pyx_L1_error)
        }
        __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
        for (;;) {
          if (likely(!__pyx_t_13)) {
            if (likely(PyList_CheckExact(__pyx_t_9))) {
              if (__pyx_t_6 >= PyList_GET_SIZE(__pyx_t_9)) break;
              #if CYTHON_COMPILING_IN_CPYTHON
              __pyx_t_4 = PyList_GET_ITEM(__pyx_t_9, __pyx_t_6); __Pyx_INCREF(__pyx_t_4); __pyx_t_6++; if (unlikely(0 < 0)) __PYX_ERR(0, 1027, __pyx_L1_error)
              #else
              __pyx_t_4 = PySequence_ITEM(__pyx_t_9, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1027, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_4);
              #endif
            } else {
              if (__pyx_t_6 >= PyTuple_GET_SIZE(__pyx_t_9)) break;
              #if CYTHON_COMPILING_IN_CPYTHON
              __pyx_t_4 = PyTuple_GET_ITEM(__pyx_t_9, __pyx_t_6); __Pyx_INCREF(__pyx_t_4); __pyx_t_6++; if (unlikely(0 < 0)) __PYX_ERR(0, 1027, __pyx_L1_error)
              #else
              __pyx_t_4 = PySequence_ITEM(__pyx_t_9, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1027, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_4);
              #endif
            }
          } else {
            __pyx_t_4 = __pyx_t_13(__pyx_t_9);
            if (unlikely(!__pyx_t_4)) {
              PyObject* exc_type = PyErr_Occurred();
              if (exc_type) {
                if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
                else __PYX_ERR(0, 1027, __pyx_L1_error)
              }
              break;
            }
            __Pyx_GOTREF(__pyx_t_4);
          }
          __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_4);
          __pyx_t_4 = 0;
          __pyx_t_4 = __Pyx_GetItemInt(__pyx_v_i, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1027, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_4);
          if (unlikely(__Pyx_ListComp_Append(__pyx_t_7, (PyObject*)__pyx_t_4))) __PYX_ERR(0, 1027, __pyx_L1_error)
          __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
        }
        __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
        __pyx_t_9 = PyTuple_New(1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1027, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_9);
        __Pyx_GIVEREF(__pyx_t_7);
        PyTuple_SET_ITEM(__pyx_t_9, 0, __pyx_t_7);
        __pyx_t_7 = 0;
        __pyx_t_7 = __Pyx_PyObject_Call(__pyx_builtin_min, __pyx_t_9, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1027, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_7);
        __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
        __pyx_t_9 = PyList_New(0); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1027, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_9);
        __pyx_t_4 = __Pyx_GetItemInt_List(__pyx_v_dotdata_record, 2, long, 1, __Pyx_PyInt_From_long, 1, 0, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1027, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_4);
        if (likely(PyList_CheckExact(__pyx_t_4)) || PyTuple_CheckExact(__pyx_t_4)) {
          __pyx_t_11 = __pyx_t_4; __Pyx_INCREF(__pyx_t_11); __pyx_t_6 = 0;
          __pyx_t_13 = NULL;
        } else {
          __pyx_t_6 = -1; __pyx_t_11 = PyObject_GetIter(__pyx_t_4); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1027, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_11);
          __pyx_t_13 = Py_TYPE(__pyx_t_11)->tp_iternext; if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1027, __pyx_L1_error)
        }
        __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
        for (;;) {
          if (likely(!__pyx_t_13)) {
            if (likely(PyList_CheckExact(__pyx_t_11))) {
              if (__pyx_t_6 >= PyList_GET_SIZE(__pyx_t_11)) break;
              #if CYTHON_COMPILING_IN_CPYTHON
              __pyx_t_4 = PyList_GET_ITEM(__pyx_t_11, __pyx_t_6); __Pyx_INCREF(__pyx_t_4); __pyx_t_6++; if (unlikely(0 < 0)) __PYX_ERR(0, 1027, __pyx_L1_error)
              #else
              __pyx_t_4 = PySequence_ITEM(__pyx_t_11, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1027, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_4);
              #endif
            } else {
              if (__pyx_t_6 >= PyTuple_GET_SIZE(__pyx_t_11)) break;
              #if CYTHON_COMPILING_IN_CPYTHON
              __pyx_t_4 = PyTuple_GET_ITEM(__pyx_t_11, __pyx_t_6); __Pyx_INCREF(__pyx_t_4); __pyx_t_6++; if (unlikely(0 < 0)) __PYX_ERR(0, 1027, __pyx_L1_error)
              #else
              __pyx_t_4 = PySequence_ITEM(__pyx_t_11, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1027, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_4);
              #endif
            }
          } else {
            __pyx_t_4 = __pyx_t_13(__pyx_t_11);
            if (unlikely(!__pyx_t_4)) {
              PyObject* exc_type = PyErr_Occurred();
              if (exc_type) {
                if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
                else __PYX_ERR(0, 1027, __pyx_L1_error)
              }
              break;
            }
            __Pyx_GOTREF(__pyx_t_4);
          }
          __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_4);
          __pyx_t_4 = 0;
          __pyx_t_4 = __Pyx_GetItemInt(__pyx_v_i, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1027, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_4);
          if (unlikely(__Pyx_ListComp_Append(__pyx_t_9, (PyObject*)__pyx_t_4))) __PYX_ERR(0, 1027, __pyx_L1_error)
          __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
        }
        __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
        __pyx_t_11 = PyTuple_New(1); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1027, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_11);
        __Pyx_GIVEREF(__pyx_t_9);
        PyTuple_SET_ITEM(__pyx_t_11, 0, __pyx_t_9);
        __pyx_t_9 = 0;
        __pyx_t_9 = __Pyx_PyObject_Call(__pyx_builtin_max, __pyx_t_11, NULL); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1027, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_9);
        __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
        __pyx_t_11 = PyList_New(2); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1027, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_11);
        __Pyx_GIVEREF(__pyx_t_7);
        PyList_SET_ITEM(__pyx_t_11, 0, __pyx_t_7);
        __Pyx_GIVEREF(__pyx_t_9);
        PyList_SET_ITEM(__pyx_t_11, 1, __pyx_t_9);
        __pyx_t_7 = 0;
        __pyx_t_9 = 0;
        __pyx_t_9 = PyTuple_New(2); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1027, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_9);
        __Pyx_GIVEREF(__pyx_t_3);
        PyTuple_SET_ITEM(__pyx_t_9, 0, __pyx_t_3);
        __Pyx_GIVEREF(__pyx_t_11);
        PyTuple_SET_ITEM(__pyx_t_9, 1, __pyx_t_11);
        __pyx_t_3 = 0;
        __pyx_t_11 = 0;
        __pyx_t_11 = PyDict_New(); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1027, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_11);
        if (PyDict_SetItem(__pyx_t_11, __pyx_n_s_type, __pyx_n_s_n) < 0) __PYX_ERR(0, 1027, __pyx_L1_error)
        if (PyDict_SetItem(__pyx_t_11, __pyx_n_s_ylab, __pyx_kp_s_PacBio_read) < 0) __PYX_ERR(0, 1027, __pyx_L1_error)
        if (PyDict_SetItem(__pyx_t_11, __pyx_n_s_xlab, __pyx_n_s_oroginal_reference) < 0) __PYX_ERR(0, 1027, __pyx_L1_error)
        __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_8, __pyx_t_9, __pyx_t_11); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1027, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_3);
        __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
        __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
        __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;

        /* "vapor_vali/Simple_function.pyx":1028
 *                 #penal 3
 *                 graphics.plot([min([i[0] for i in dotdata_record[2]]),max([i[0] for i in dotdata_record[2]])],[min([i[1] for i in dotdata_record[2]]),max([i[1] for i in dotdata_record[2]])],type='n',ylab='PacBio read',xlab='oroginal_reference')
 *                 graphics.points([i[0] for i in dotdata_record[2]],[i[1] for i in dotdata_record[2]],col='red',pch='+')             # <<<<<<<<<<<<<<
 *                 #penal 4
 *                 graphics.plot([min([i[0] for i in dotdata_record[3]]),max([i[0] for i in dotdata_record[3]])],[min([i[1] for i in dotdata_record[3]]),max([i[1] for i in dotdata_record[3]])],type='n',ylab='PacBio read',xlab='altered_reference')
 */
        __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_graphics, __pyx_n_s_points); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1028, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_3);
        __pyx_t_11 = PyList_New(0); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1028, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_11);
        __pyx_t_9 = __Pyx_GetItemInt_List(__pyx_v_dotdata_record, 2, long, 1, __Pyx_PyInt_From_long, 1, 0, 1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1028, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_9);
        if (likely(PyList_CheckExact(__pyx_t_9)) || PyTuple_CheckExact(__pyx_t_9)) {
          __pyx_t_8 = __pyx_t_9; __Pyx_INCREF(__pyx_t_8); __pyx_t_6 = 0;
          __pyx_t_13 = NULL;
        } else {
          __pyx_t_6 = -1; __pyx_t_8 = PyObject_GetIter(__pyx_t_9); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1028, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_8);
          __pyx_t_13 = Py_TYPE(__pyx_t_8)->tp_iternext; if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1028, __pyx_L1_error)
        }
        __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
        for (;;) {
          if (likely(!__pyx_t_13)) {
            if (likely(PyList_CheckExact(__pyx_t_8))) {
              if (__pyx_t_6 >= PyList_GET_SIZE(__pyx_t_8)) break;
              #if CYTHON_COMPILING_IN_CPYTHON
              __pyx_t_9 = PyList_GET_ITEM(__pyx_t_8, __pyx_t_6); __Pyx_INCREF(__pyx_t_9); __pyx_t_6++; if (unlikely(0 < 0)) __PYX_ERR(0, 1028, __pyx_L1_error)
              #else
              __pyx_t_9 = PySequence_ITEM(__pyx_t_8, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1028, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_9);
              #endif
            } else {
              if (__pyx_t_6 >= PyTuple_GET_SIZE(__pyx_t_8)) break;
              #if CYTHON_COMPILING_IN_CPYTHON
              __pyx_t_9 = PyTuple_GET_ITEM(__pyx_t_8, __pyx_t_6); __Pyx_INCREF(__pyx_t_9); __pyx_t_6++; if (unlikely(0 < 0)) __PYX_ERR(0, 1028, __pyx_L1_error)
              #else
              __pyx_t_9 = PySequence_ITEM(__pyx_t_8, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1028, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_9);
              #endif
            }
          } else {
            __pyx_t_9 = __pyx_t_13(__pyx_t_8);
            if (unlikely(!__pyx_t_9)) {
              PyObject* exc_type = PyErr_Occurred();
              if (exc_type) {
                if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
                else __PYX_ERR(0, 1028, __pyx_L1_error)
              }
              break;
            }
            __Pyx_GOTREF(__pyx_t_9);
          }
          __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_9);
          __pyx_t_9 = 0;
          __pyx_t_9 = __Pyx_GetItemInt(__pyx_v_i, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1028, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_9);
          if (unlikely(__Pyx_ListComp_Append(__pyx_t_11, (PyObject*)__pyx_t_9))) __PYX_ERR(0, 1028, __pyx_L1_error)
          __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
        }
        __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
        __pyx_t_8 = PyList_New(0); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1028, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_8);
        __pyx_t_9 = __Pyx_GetItemInt_List(__pyx_v_dotdata_record, 2, long, 1, __Pyx_PyInt_From_long, 1, 0, 1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1028, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_9);
        if (likely(PyList_CheckExact(__pyx_t_9)) || PyTuple_CheckExact(__pyx_t_9)) {
          __pyx_t_7 = __pyx_t_9; __Pyx_INCREF(__pyx_t_7); __pyx_t_6 = 0;
          __pyx_t_13 = NULL;
        } else {
          __pyx_t_6 = -1; __pyx_t_7 = PyObject_GetIter(__pyx_t_9); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1028, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_7);
          __pyx_t_13 = Py_TYPE(__pyx_t_7)->tp_iternext; if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1028, __pyx_L1_error)
        }
        __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
        for (;;) {
          if (likely(!__pyx_t_13)) {
            if (likely(PyList_CheckExact(__pyx_t_7))) {
              if (__pyx_t_6 >= PyList_GET_SIZE(__pyx_t_7)) break;
              #if CYTHON_COMPILING_IN_CPYTHON
              __pyx_t_9 = PyList_GET_ITEM(__pyx_t_7, __pyx_t_6); __Pyx_INCREF(__pyx_t_9); __pyx_t_6++; if (unlikely(0 < 0)) __PYX_ERR(0, 1028, __pyx_L1_error)
              #else
              __pyx_t_9 = PySequence_ITEM(__pyx_t_7, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1028, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_9);
              #endif
            } else {
              if (__pyx_t_6 >= PyTuple_GET_SIZE(__pyx_t_7)) break;
              #if CYTHON_COMPILING_IN_CPYTHON
              __pyx_t_9 = PyTuple_GET_ITEM(__pyx_t_7, __pyx_t_6); __Pyx_INCREF(__pyx_t_9); __pyx_t_6++; if (unlikely(0 < 0)) __PYX_ERR(0, 1028, __pyx_L1_error)
              #else
              __pyx_t_9 = PySequence_ITEM(__pyx_t_7, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1028, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_9);
              #endif
            }
          } else {
            __pyx_t_9 = __pyx_t_13(__pyx_t_7);
            if (unlikely(!__pyx_t_9)) {
              PyObject* exc_type = PyErr_Occurred();
              if (exc_type) {
                if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
                else __PYX_ERR(0, 1028, __pyx_L1_error)
              }
              break;
            }
            __Pyx_GOTREF(__pyx_t_9);
          }
          __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_9);
          __pyx_t_9 = 0;
          __pyx_t_9 = __Pyx_GetItemInt(__pyx_v_i, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1028, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_9);
          if (unlikely(__Pyx_ListComp_Append(__pyx_t_8, (PyObject*)__pyx_t_9))) __PYX_ERR(0, 1028, __pyx_L1_error)
          __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
        }
        __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
        __pyx_t_7 = PyTuple_New(2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1028, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_7);
        __Pyx_GIVEREF(__pyx_t_11);
        PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_11);
        __Pyx_GIVEREF(__pyx_t_8);
        PyTuple_SET_ITEM(__pyx_t_7, 1, __pyx_t_8);
        __pyx_t_11 = 0;
        __pyx_t_8 = 0;
        __pyx_t_8 = PyDict_New(); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1028, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_8);
        if (PyDict_SetItem(__pyx_t_8, __pyx_n_s_col, __pyx_n_s_red) < 0) __PYX_ERR(0, 1028, __pyx_L1_error)
        if (PyDict_SetItem(__pyx_t_8, __pyx_n_s_pch, __pyx_kp_s__2) < 0) __PYX_ERR(0, 1028, __pyx_L1_error)
        __pyx_t_11 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_7, __pyx_t_8); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1028, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_11);
        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
        __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
        __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
        __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;

        /* "vapor_vali/Simple_function.pyx":1030
 *                 graphics.points([i[0] for i in dotdata_record[2]],[i[1] for i in dotdata_record[2]],col='red',pch='+')
 *                 #penal 4
 *                 graphics.plot([min([i[0] for i in dotdata_record[3]]),max([i[0] for i in dotdata_record[3]])],[min([i[1] for i in dotdata_record[3]]),max([i[1] for i in dotdata_record[3]])],type='n',ylab='PacBio read',xlab='altered_reference')             # <<<<<<<<<<<<<<
 *                 graphics.points([i[0] for i in dotdata_record[3]],[i[1] for i in dotdata_record[3]],col='red',pch='+')
 *                 grdevices.dev_off()
 */
        __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_v_graphics, __pyx_n_s_plot); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1030, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_11);
        __pyx_t_8 = PyList_New(0); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1030, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_8);
        __pyx_t_7 = __Pyx_GetItemInt_List(__pyx_v_dotdata_record, 3, long, 1, __Pyx_PyInt_From_long, 1, 0, 1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1030, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_7);
        if (likely(PyList_CheckExact(__pyx_t_7)) || PyTuple_CheckExact(__pyx_t_7)) {
          __pyx_t_3 = __pyx_t_7; __Pyx_INCREF(__pyx_t_3); __pyx_t_6 = 0;
          __pyx_t_13 = NULL;
        } else {
          __pyx_t_6 = -1; __pyx_t_3 = PyObject_GetIter(__pyx_t_7); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1030, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_3);
          __pyx_t_13 = Py_TYPE(__pyx_t_3)->tp_iternext; if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1030, __pyx_L1_error)
        }
        __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
        for (;;) {
          if (likely(!__pyx_t_13)) {
            if (likely(PyList_CheckExact(__pyx_t_3))) {
              if (__pyx_t_6 >= PyList_GET_SIZE(__pyx_t_3)) break;
              #if CYTHON_COMPILING_IN_CPYTHON
              __pyx_t_7 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_6); __Pyx_INCREF(__pyx_t_7); __pyx_t_6++; if (unlikely(0 < 0)) __PYX_ERR(0, 1030, __pyx_L1_error)
              #else
              __pyx_t_7 = PySequence_ITEM(__pyx_t_3, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1030, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_7);
              #endif
            } else {
              if (__pyx_t_6 >= PyTuple_GET_SIZE(__pyx_t_3)) break;
              #if CYTHON_COMPILING_IN_CPYTHON
              __pyx_t_7 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_6); __Pyx_INCREF(__pyx_t_7); __pyx_t_6++; if (unlikely(0 < 0)) __PYX_ERR(0, 1030, __pyx_L1_error)
              #else
              __pyx_t_7 = PySequence_ITEM(__pyx_t_3, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1030, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_7);
              #endif
            }
          } else {
            __pyx_t_7 = __pyx_t_13(__pyx_t_3);
            if (unlikely(!__pyx_t_7)) {
              PyObject* exc_type = PyErr_Occurred();
              if (exc_type) {
                if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
                else __PYX_ERR(0, 1030, __pyx_L1_error)
              }
              break;
            }
            __Pyx_GOTREF(__pyx_t_7);
          }
          __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_7);
          __pyx_t_7 = 0;
          __pyx_t_7 = __Pyx_GetItemInt(__pyx_v_i, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1030, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_7);
          if (unlikely(__Pyx_ListComp_Append(__pyx_t_8, (PyObject*)__pyx_t_7))) __PYX_ERR(0, 1030, __pyx_L1_error)
          __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
        }
        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
        __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1030, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_3);
        __Pyx_GIVEREF(__pyx_t_8);
        PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_8);
        __pyx_t_8 = 0;
        __pyx_t_8 = __Pyx_PyObject_Call(__pyx_builtin_min, __pyx_t_3, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1030, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_8);
        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
        __pyx_t_3 = PyList_New(0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1030, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_3);
        __pyx_t_7 = __Pyx_GetItemInt_List(__pyx_v_dotdata_record, 3, long, 1, __Pyx_PyInt_From_long, 1, 0, 1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1030, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_7);
        if (likely(PyList_CheckExact(__pyx_t_7)) || PyTuple_CheckExact(__pyx_t_7)) {
          __pyx_t_9 = __pyx_t_7; __Pyx_INCREF(__pyx_t_9); __pyx_t_6 = 0;
          __pyx_t_13 = NULL;
        } else {
          __pyx_t_6 = -1; __pyx_t_9 = PyObject_GetIter(__pyx_t_7); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1030, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_9);
          __pyx_t_13 = Py_TYPE(__pyx_t_9)->tp_iternext; if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1030, __pyx_L1_error)
        }
        __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
        for (;;) {
          if (likely(!__pyx_t_13)) {
            if (likely(PyList_CheckExact(__pyx_t_9))) {
              if (__pyx_t_6 >= PyList_GET_SIZE(__pyx_t_9)) break;
              #if CYTHON_COMPILING_IN_CPYTHON
              __pyx_t_7 = PyList_GET_ITEM(__pyx_t_9, __pyx_t_6); __Pyx_INCREF(__pyx_t_7); __pyx_t_6++; if (unlikely(0 < 0)) __PYX_ERR(0, 1030, __pyx_L1_error)
              #else
              __pyx_t_7 = PySequence_ITEM(__pyx_t_9, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1030, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_7);
              #endif
            } else {
              if (__pyx_t_6 >= PyTuple_GET_SIZE(__pyx_t_9)) break;
              #if CYTHON_COMPILING_IN_CPYTHON
              __pyx_t_7 = PyTuple_GET_ITEM(__pyx_t_9, __pyx_t_6); __Pyx_INCREF(__pyx_t_7); __pyx_t_6++; if (unlikely(0 < 0)) __PYX_ERR(0, 1030, __pyx_L1_error)
              #else
              __pyx_t_7 = PySequence_ITEM(__pyx_t_9, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1030, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_7);
              #endif
            }
          } else {
            __pyx_t_7 = __pyx_t_13(__pyx_t_9);
            if (unlikely(!__pyx_t_7)) {
              PyObject* exc_type = PyErr_Occurred();
              if (exc_type) {
                if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
                else __PYX_ERR(0, 1030, __pyx_L1_error)
              }
              break;
            }
            __Pyx_GOTREF(__pyx_t_7);
          }
          __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_7);
          __pyx_t_7 = 0;
          __pyx_t_7 = __Pyx_GetItemInt(__pyx_v_i, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1030, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_7);
          if (unlikely(__Pyx_ListComp_Append(__pyx_t_3, (PyObject*)__pyx_t_7))) __PYX_ERR(0, 1030, __pyx_L1_error)
          __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
        }
        __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
        __pyx_t_9 = PyTuple_New(1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1030, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_9);
        __Pyx_GIVEREF(__pyx_t_3);
        PyTuple_SET_ITEM(__pyx_t_9, 0, __pyx_t_3);
        __pyx_t_3 = 0;
        __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_max, __pyx_t_9, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1030, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_3);
        __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
        __pyx_t_9 = PyList_New(2); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1030, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_9);
        __Pyx_GIVEREF(__pyx_t_8);
        PyList_SET_ITEM(__pyx_t_9, 0, __pyx_t_8);
        __Pyx_GIVEREF(__pyx_t_3);
        PyList_SET_ITEM(__pyx_t_9, 1, __pyx_t_3);
        __pyx_t_8 = 0;
        __pyx_t_3 = 0;
        __pyx_t_3 = PyList_New(0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1030, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_3);
        __pyx_t_8 = __Pyx_GetItemInt_List(__pyx_v_dotdata_record, 3, long, 1, __Pyx_PyInt_From_long, 1, 0, 1); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1030, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_8);
        if (likely(PyList_CheckExact(__pyx_t_8)) || PyTuple_CheckExact(__pyx_t_8)) {
          __pyx_t_7 = __pyx_t_8; __Pyx_INCREF(__pyx_t_7); __pyx_t_6 = 0;
          __pyx_t_13 = NULL;
        } else {
          __pyx_t_6 = -1; __pyx_t_7 = PyObject_GetIter(__pyx_t_8); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1030, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_7);
          __pyx_t_13 = Py_TYPE(__pyx_t_7)->tp_iternext; if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1030, __pyx_L1_error)
        }
        __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
        for (;;) {
          if (likely(!__pyx_t_13)) {
            if (likely(PyList_CheckExact(__pyx_t_7))) {
              if (__pyx_t_6 >= PyList_GET_SIZE(__pyx_t_7)) break;
              #if CYTHON_COMPILING_IN_CPYTHON
              __pyx_t_8 = PyList_GET_ITEM(__pyx_t_7, __pyx_t_6); __Pyx_INCREF(__pyx_t_8); __pyx_t_6++; if (unlikely(0 < 0)) __PYX_ERR(0, 1030, __pyx_L1_error)
              #else
              __pyx_t_8 = PySequence_ITEM(__pyx_t_7, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1030, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_8);
              #endif
            } else {
              if (__pyx_t_6 >= PyTuple_GET_SIZE(__pyx_t_7)) break;
              #if CYTHON_COMPILING_IN_CPYTHON
              __pyx_t_8 = PyTuple_GET_ITEM(__pyx_t_7, __pyx_t_6); __Pyx_INCREF(__pyx_t_8); __pyx_t_6++; if (unlikely(0 < 0)) __PYX_ERR(0, 1030, __pyx_L1_error)
              #else
              __pyx_t_8 = PySequence_ITEM(__pyx_t_7, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1030, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_8);
              #endif
            }
          } else {
            __pyx_t_8 = __pyx_t_13(__pyx_t_7);
            if (unlikely(!__pyx_t_8)) {
              PyObject* exc_type = PyErr_Occurred();
              if (exc_type) {
                if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
                else __PYX_ERR(0, 1030, __pyx_L1_error)
              }
              break;
            }
            __Pyx_GOTREF(__pyx_t_8);
          }
          __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_8);
          __pyx_t_8 = 0;
          __pyx_t_8 = __Pyx_GetItemInt(__pyx_v_i, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1030, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_8);
          if (unlikely(__Pyx_ListComp_Append(__pyx_t_3, (PyObject*)__pyx_t_8))) __PYX_ERR(0, 1030, __pyx_L1_error)
          __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
        }
        __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
        __pyx_t_7 = PyTuple_New(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1030, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_7);
        __Pyx_GIVEREF(__pyx_t_3);
        PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_3);
        __pyx_t_3 = 0;
        __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_min, __pyx_t_7, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1030, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_3);
        __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
        __pyx_t_7 = PyList_New(0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1030, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_7);
        __pyx_t_8 = __Pyx_GetItemInt_List(__pyx_v_dotdata_record, 3, long, 1, __Pyx_PyInt_From_long, 1, 0, 1); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1030, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_8);
        if (likely(PyList_CheckExact(__pyx_t_8)) || PyTuple_CheckExact(__pyx_t_8)) {
          __pyx_t_4 = __pyx_t_8; __Pyx_INCREF(__pyx_t_4); __pyx_t_6 = 0;
          __pyx_t_13 = NULL;
        } else {
          __pyx_t_6 = -1; __pyx_t_4 = PyObject_GetIter(__pyx_t_8); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1030, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_4);
          __pyx_t_13 = Py_TYPE(__pyx_t_4)->tp_iternext; if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1030, __pyx_L1_error)
        }
        __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
        for (;;) {
          if (likely(!__pyx_t_13)) {
            if (likely(PyList_CheckExact(__pyx_t_4))) {
              if (__pyx_t_6 >= PyList_GET_SIZE(__pyx_t_4)) break;
              #if CYTHON_COMPILING_IN_CPYTHON
              __pyx_t_8 = PyList_GET_ITEM(__pyx_t_4, __pyx_t_6); __Pyx_INCREF(__pyx_t_8); __pyx_t_6++; if (unlikely(0 < 0)) __PYX_ERR(0, 1030, __pyx_L1_error)
              #else
              __pyx_t_8 = PySequence_ITEM(__pyx_t_4, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1030, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_8);
              #endif
            } else {
              if (__pyx_t_6 >= PyTuple_GET_SIZE(__pyx_t_4)) break;
              #if CYTHON_COMPILING_IN_CPYTHON
              __pyx_t_8 = PyTuple_GET_ITEM(__pyx_t_4, __pyx_t_6); __Pyx_INCREF(__pyx_t_8); __pyx_t_6++; if (unlikely(0 < 0)) __PYX_ERR(0, 1030, __pyx_L1_error)
              #else
              __pyx_t_8 = PySequence_ITEM(__pyx_t_4, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1030, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_8);
              #endif
            }
          } else {
            __pyx_t_8 = __pyx_t_13(__pyx_t_4);
            if (unlikely(!__pyx_t_8)) {
              PyObject* exc_type = PyErr_Occurred();
              if (exc_type) {
                if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
                else __PYX_ERR(0, 1030, __pyx_L1_error)
              }
              break;
            }
            __Pyx_GOTREF(__pyx_t_8);
          }
          __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_8);
          __pyx_t_8 = 0;
          __pyx_t_8 = __Pyx_GetItemInt(__pyx_v_i, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1030, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_8);
          if (unlikely(__Pyx_ListComp_Append(__pyx_t_7, (PyObject*)__pyx_t_8))) __PYX_ERR(0, 1030, __pyx_L1_error)
          __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
        }
        __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
        __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1030, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_4);
        __Pyx_GIVEREF(__pyx_t_7);
        PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_7);
        __pyx_t_7 = 0;
        __pyx_t_7 = __Pyx_PyObject_Call(__pyx_builtin_max, __pyx_t_4, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1030, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_7);
        __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
        __pyx_t_4 = PyList_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1030, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_4);
        __Pyx_GIVEREF(__pyx_t_3);
        PyList_SET_ITEM(__pyx_t_4, 0, __pyx_t_3);
        __Pyx_GIVEREF(__pyx_t_7);
        PyList_SET_ITEM(__pyx_t_4, 1, __pyx_t_7);
        __pyx_t_3 = 0;
        __pyx_t_7 = 0;
        __pyx_t_7 = PyTuple_New(2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1030, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_7);
        __Pyx_GIVEREF(__pyx_t_9);
        PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_9);
        __Pyx_GIVEREF(__pyx_t_4);
        PyTuple_SET_ITEM(__pyx_t_7, 1, __pyx_t_4);
        __pyx_t_9 = 0;
        __pyx_t_4 = 0;
        __pyx_t_4 = PyDict_New(); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1030, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_4);
        if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_type, __pyx_n_s_n) < 0) __PYX_ERR(0, 1030, __pyx_L1_error)
        if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_ylab, __pyx_kp_s_PacBio_read) < 0) __PYX_ERR(0, 1030, __pyx_L1_error)
        if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_xlab, __pyx_n_s_altered_reference) < 0) __PYX_ERR(0, 1030, __pyx_L1_error)
        __pyx_t_9 = __Pyx_PyObject_Call(__pyx_t_11, __pyx_t_7, __pyx_t_4); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1030, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_9);
        __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
        __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
        __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
        __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;

        /* "vapor_vali/Simple_function.pyx":1031
 *                 #penal 4
 *                 graphics.plot([min([i[0] for i in dotdata_record[3]]),max([i[0] for i in dotdata_record[3]])],[min([i[1] for i in dotdata_record[3]]),max([i[1] for i in dotdata_record[3]])],type='n',ylab='PacBio read',xlab='altered_reference')
 *                 graphics.points([i[0] for i in dotdata_record[3]],[i[1] for i in dotdata_record[3]],col='red',pch='+')             # <<<<<<<<<<<<<<
 *                 grdevices.dev_off()
 * 
 */
        __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_v_graphics, __pyx_n_s_points); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1031, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_9);
        __pyx_t_4 = PyList_New(0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1031, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_4);
        __pyx_t_7 = __Pyx_GetItemInt_List(__pyx_v_dotdata_record, 3, long, 1, __Pyx_PyInt_From_long, 1, 0, 1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1031, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_7);
        if (likely(PyList_CheckExact(__pyx_t_7)) || PyTuple_CheckExact(__pyx_t_7)) {
          __pyx_t_11 = __pyx_t_7; __Pyx_INCREF(__pyx_t_11); __pyx_t_6 = 0;
          __pyx_t_13 = NULL;
        } else {
          __pyx_t_6 = -1; __pyx_t_11 = PyObject_GetIter(__pyx_t_7); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1031, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_11);
          __pyx_t_13 = Py_TYPE(__pyx_t_11)->tp_iternext; if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1031, __pyx_L1_error)
        }
        __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
        for (;;) {
          if (likely(!__pyx_t_13)) {
            if (likely(PyList_CheckExact(__pyx_t_11))) {
              if (__pyx_t_6 >= PyList_GET_SIZE(__pyx_t_11)) break;
              #if CYTHON_COMPILING_IN_CPYTHON
              __pyx_t_7 = PyList_GET_ITEM(__pyx_t_11, __pyx_t_6); __Pyx_INCREF(__pyx_t_7); __pyx_t_6++; if (unlikely(0 < 0)) __PYX_ERR(0, 1031, __pyx_L1_error)
              #else
              __pyx_t_7 = PySequence_ITEM(__pyx_t_11, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1031, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_7);
              #endif
            } else {
              if (__pyx_t_6 >= PyTuple_GET_SIZE(__pyx_t_11)) break;
              #if CYTHON_COMPILING_IN_CPYTHON
              __pyx_t_7 = PyTuple_GET_ITEM(__pyx_t_11, __pyx_t_6); __Pyx_INCREF(__pyx_t_7); __pyx_t_6++; if (unlikely(0 < 0)) __PYX_ERR(0, 1031, __pyx_L1_error)
              #else
              __pyx_t_7 = PySequence_ITEM(__pyx_t_11, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1031, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_7);
              #endif
            }
          } else {
            __pyx_t_7 = __pyx_t_13(__pyx_t_11);
            if (unlikely(!__pyx_t_7)) {
              PyObject* exc_type = PyErr_Occurred();
              if (exc_type) {
                if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
                else __PYX_ERR(0, 1031, __pyx_L1_error)
              }
              break;
            }
            __Pyx_GOTREF(__pyx_t_7);
          }
          __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_7);
          __pyx_t_7 = 0;
          __pyx_t_7 = __Pyx_GetItemInt(__pyx_v_i, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1031, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_7);
          if (unlikely(__Pyx_ListComp_Append(__pyx_t_4, (PyObject*)__pyx_t_7))) __PYX_ERR(0, 1031, __pyx_L1_error)
          __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
        }
        __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
        __pyx_t_11 = PyList_New(0); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1031, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_11);
        __pyx_t_7 = __Pyx_GetItemInt_List(__pyx_v_dotdata_record, 3, long, 1, __Pyx_PyInt_From_long, 1, 0, 1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1031, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_7);
        if (likely(PyList_CheckExact(__pyx_t_7)) || PyTuple_CheckExact(__pyx_t_7)) {
          __pyx_t_3 = __pyx_t_7; __Pyx_INCREF(__pyx_t_3); __pyx_t_6 = 0;
          __pyx_t_13 = NULL;
        } else {
          __pyx_t_6 = -1; __pyx_t_3 = PyObject_GetIter(__pyx_t_7); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1031, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_3);
          __pyx_t_13 = Py_TYPE(__pyx_t_3)->tp_iternext; if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1031, __pyx_L1_error)
        }
        __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
        for (;;) {
          if (likely(!__pyx_t_13)) {
            if (likely(PyList_CheckExact(__pyx_t_3))) {
              if (__pyx_t_6 >= PyList_GET_SIZE(__pyx_t_3)) break;
              #if CYTHON_COMPILING_IN_CPYTHON
              __pyx_t_7 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_6); __Pyx_INCREF(__pyx_t_7); __pyx_t_6++; if (unlikely(0 < 0)) __PYX_ERR(0, 1031, __pyx_L1_error)
              #else
              __pyx_t_7 = PySequence_ITEM(__pyx_t_3, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1031, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_7);
              #endif
            } else {
              if (__pyx_t_6 >= PyTuple_GET_SIZE(__pyx_t_3)) break;
              #if CYTHON_COMPILING_IN_CPYTHON
              __pyx_t_7 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_6); __Pyx_INCREF(__pyx_t_7); __pyx_t_6++; if (unlikely(0 < 0)) __PYX_ERR(0, 1031, __pyx_L1_error)
              #else
              __pyx_t_7 = PySequence_ITEM(__pyx_t_3, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1031, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_7);
              #endif
            }
          } else {
            __pyx_t_7 = __pyx_t_13(__pyx_t_3);
            if (unlikely(!__pyx_t_7)) {
              PyObject* exc_type = PyErr_Occurred();
              if (exc_type) {
                if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
                else __PYX_ERR(0, 1031, __pyx_L1_error)
              }
              break;
            }
            __Pyx_GOTREF(__pyx_t_7);
          }
          __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_7);
          __pyx_t_7 = 0;
          __pyx_t_7 = __Pyx_GetItemInt(__pyx_v_i, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1031, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_7);
          if (unlikely(__Pyx_ListComp_Append(__pyx_t_11, (PyObject*)__pyx_t_7))) __PYX_ERR(0, 1031, __pyx_L1_error)
          __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
        }
        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
        __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1031, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_3);
        __Pyx_GIVEREF(__pyx_t_4);
        PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_4);
        __Pyx_GIVEREF(__pyx_t_11);
        PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_t_11);
        __pyx_t_4 = 0;
        __pyx_t_11 = 0;
        __pyx_t_11 = PyDict_New(); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1031, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_11);
        if (PyDict_SetItem(__pyx_t_11, __pyx_n_s_col, __pyx_n_s_red) < 0) __PYX_ERR(0, 1031, __pyx_L1_error)
        if (PyDict_SetItem(__pyx_t_11, __pyx_n_s_pch, __pyx_kp_s__2) < 0) __PYX_ERR(0, 1031, __pyx_L1_error)
        __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_9, __pyx_t_3, __pyx_t_11); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1031, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_4);
        __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
        __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
        __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;

        /* "vapor_vali/Simple_function.pyx":1032
 *                 graphics.plot([min([i[0] for i in dotdata_record[3]]),max([i[0] for i in dotdata_record[3]])],[min([i[1] for i in dotdata_record[3]]),max([i[1] for i in dotdata_record[3]])],type='n',ylab='PacBio read',xlab='altered_reference')
 *                 graphics.points([i[0] for i in dotdata_record[3]],[i[1] for i in dotdata_record[3]],col='red',pch='+')
 *                 grdevices.dev_off()             # <<<<<<<<<<<<<<
 * 
 * def minimize_pacbio_read_list(x,ideal_list_length=20):
 */
        __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_v_grdevices, __pyx_n_s_dev_off); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1032, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_11);
        __pyx_t_3 = NULL;
        if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_11))) {
          __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_11);
          if (likely(__pyx_t_3)) {
            PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_11);
            __Pyx_INCREF(__pyx_t_3);
            __Pyx_INCREF(function);
            __Pyx_DECREF_SET(__pyx_t_11, function);
          }
        }
        if (__pyx_t_3) {
          __pyx_t_4 = __Pyx_PyObject_CallOneArg(__pyx_t_11, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1032, __pyx_L1_error)
          __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
        } else {
          __pyx_t_4 = __Pyx_PyObject_CallNoArg(__pyx_t_11); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1032, __pyx_L1_error)
        }
        __Pyx_GOTREF(__pyx_t_4);
        __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
        __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;

        /* "vapor_vali/Simple_function.pyx":1013
 *         if not best_read_rec==[]:
 *             dotdata_record=[dotdata(window_size,ref_seq,ref_seq),    dotdata(window_size,alt_seq,alt_seq),    dotdata(window_size,best_read_rec[0],ref_seq[best_read_rec[1]:]),    dotdata(window_size,best_read_rec[0],alt_seq[best_read_rec[1]:])]
 *             if not [] in dotdata_record:             # <<<<<<<<<<<<<<
 *                 grdevices = importr('grDevices')
 *                 graphics = importr("graphics")
 */
      }

      /* "vapor_vali/Simple_function.pyx":1011
 * def make_event_figure_1(vapor_score_list,best_read_rec,window_size,ref_seq,alt_seq,out_figure_name):
 *     if not best_read_rec=='':
 *         if not best_read_rec==[]:             # <<<<<<<<<<<<<<
 *             dotdata_record=[dotdata(window_size,ref_seq,ref_seq),    dotdata(window_size,alt_seq,alt_seq),    dotdata(window_size,best_read_rec[0],ref_seq[best_read_rec[1]:]),    dotdata(window_size,best_read_rec[0],alt_seq[best_read_rec[1]:])]
 *             if not [] in dotdata_record:
 */
    }

    /* "vapor_vali/Simple_function.pyx":1010
 * 
 * def make_event_figure_1(vapor_score_list,best_read_rec,window_size,ref_seq,alt_seq,out_figure_name):
 *     if not best_read_rec=='':             # <<<<<<<<<<<<<<
 *         if not best_read_rec==[]:
 *             dotdata_record=[dotdata(window_size,ref_seq,ref_seq),    dotdata(window_size,alt_seq,alt_seq),    dotdata(window_size,best_read_rec[0],ref_seq[best_read_rec[1]:]),    dotdata(window_size,best_read_rec[0],alt_seq[best_read_rec[1]:])]
 */
  }

  /* "vapor_vali/Simple_function.pyx":1009
 *     return out
 * 
 * def make_event_figure_1(vapor_score_list,best_read_rec,window_size,ref_seq,alt_seq,out_figure_name):             # <<<<<<<<<<<<<<
 *     if not best_read_rec=='':
 *         if not best_read_rec==[]:
 */

  /* function exit code */
  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_7);
  __Pyx_XDECREF(__pyx_t_8);
  __Pyx_XDECREF(__pyx_t_9);
  __Pyx_XDECREF(__pyx_t_10);
  __Pyx_XDECREF(__pyx_t_11);
  __Pyx_XDECREF(__pyx_t_12);
  __Pyx_AddTraceback("vapor_vali.Simple_function.make_event_figure_1", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_dotdata_record);
  __Pyx_XDECREF(__pyx_v_grdevices);
  __Pyx_XDECREF(__pyx_v_graphics);
  __Pyx_XDECREF(__pyx_v_i);
  __Pyx_XDECREF(__pyx_v_out_figure_name);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "vapor_vali/Simple_function.pyx":1034
 *                 grdevices.dev_off()
 * 
 * def minimize_pacbio_read_list(x,ideal_list_length=20):             # <<<<<<<<<<<<<<
 *     #eg of x=chop_pacbio_read_by_pos(bam_in_new,chrom,start,end,flank_length)
 *     if len(x)>ideal_list_length:
 */

/* Python wrapper */
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_139minimize_pacbio_read_list(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_10vapor_vali_15Simple_function_139minimize_pacbio_read_list = {"minimize_pacbio_read_list", (PyCFunction)__pyx_pw_10vapor_vali_15Simple_function_139minimize_pacbio_read_list, METH_VARARGS|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_139minimize_pacbio_read_list(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_x = 0;
  PyObject *__pyx_v_ideal_list_length = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("minimize_pacbio_read_list (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_x,&__pyx_n_s_ideal_list_length,0};
    PyObject* values[2] = {0,0};
    values[1] = ((PyObject *)__pyx_int_20);
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_x)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (kw_args > 0) {
          PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_ideal_list_length);
          if (value) { values[1] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "minimize_pacbio_read_list") < 0)) __PYX_ERR(0, 1034, __pyx_L3_error)
      }
    } else {
      switch (PyTuple_GET_SIZE(__pyx_args)) {
        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_x = values[0];
    __pyx_v_ideal_list_length = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("minimize_pacbio_read_list", 0, 1, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1034, __pyx_L3_error)
  __pyx_L3_error:;
  __Pyx_AddTraceback("vapor_vali.Simple_function.minimize_pacbio_read_list", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_10vapor_vali_15Simple_function_138minimize_pacbio_read_list(__pyx_self, __pyx_v_x, __pyx_v_ideal_list_length);

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10vapor_vali_15Simple_function_138minimize_pacbio_read_list(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_x, PyObject *__pyx_v_ideal_list_length) {
  PyObject *__pyx_v_out = NULL;
  PyObject *__pyx_v_temp_hash = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  Py_ssize_t __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  int __pyx_t_4;
  PyObject *(*__pyx_t_5)(PyObject *);
  PyObject *__pyx_t_6 = NULL;
  PyObject *__pyx_t_7 = NULL;
  int __pyx_t_8;
  PyObject *__pyx_t_9 = NULL;
  int __pyx_t_10;
  Py_ssize_t __pyx_t_11;
  __Pyx_RefNannySetupContext("minimize_pacbio_read_list", 0);
  __Pyx_INCREF(__pyx_v_x);

  /* "vapor_vali/Simple_function.pyx":1036
 * def minimize_pacbio_read_list(x,ideal_list_length=20):
 *     #eg of x=chop_pacbio_read_by_pos(bam_in_new,chrom,start,end,flank_length)
 *     if len(x)>ideal_list_length:             # <<<<<<<<<<<<<<
 *         out=[]
 *         temp_hash={}
 */
  __pyx_t_1 = PyObject_Length(__pyx_v_x); if (unlikely(__pyx_t_1 == -1)) __PYX_ERR(0, 1036, __pyx_L1_error)
  __pyx_t_2 = PyInt_FromSsize_t(__pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1036, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = PyObject_RichCompare(__pyx_t_2, __pyx_v_ideal_list_length, Py_GT); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1036, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 1036, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  if (__pyx_t_4) {

    /* "vapor_vali/Simple_function.pyx":1037
 *     #eg of x=chop_pacbio_read_by_pos(bam_in_new,chrom,start,end,flank_length)
 *     if len(x)>ideal_list_length:
 *         out=[]             # <<<<<<<<<<<<<<
 *         temp_hash={}
 *         for x in x:
 */
    __pyx_t_3 = PyList_New(0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1037, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_v_out = __pyx_t_3;
    __pyx_t_3 = 0;

    /* "vapor_vali/Simple_function.pyx":1038
 *     if len(x)>ideal_list_length:
 *         out=[]
 *         temp_hash={}             # <<<<<<<<<<<<<<
 *         for x in x:
 *             if not x[1] in list(temp_hash.keys()):    temp_hash[x[1]]=[x]
 */
    __pyx_t_3 = PyDict_New(); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1038, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_v_temp_hash = ((PyObject*)__pyx_t_3);
    __pyx_t_3 = 0;

    /* "vapor_vali/Simple_function.pyx":1039
 *         out=[]
 *         temp_hash={}
 *         for x in x:             # <<<<<<<<<<<<<<
 *             if not x[1] in list(temp_hash.keys()):    temp_hash[x[1]]=[x]
 *             else:    temp_hash[x[1]]+=[x]
 */
    if (likely(PyList_CheckExact(__pyx_v_x)) || PyTuple_CheckExact(__pyx_v_x)) {
      __pyx_t_3 = __pyx_v_x; __Pyx_INCREF(__pyx_t_3); __pyx_t_1 = 0;
      __pyx_t_5 = NULL;
    } else {
      __pyx_t_1 = -1; __pyx_t_3 = PyObject_GetIter(__pyx_v_x); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1039, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __pyx_t_5 = Py_TYPE(__pyx_t_3)->tp_iternext; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1039, __pyx_L1_error)
    }
    for (;;) {
      if (likely(!__pyx_t_5)) {
        if (likely(PyList_CheckExact(__pyx_t_3))) {
          if (__pyx_t_1 >= PyList_GET_SIZE(__pyx_t_3)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_2 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_1); __Pyx_INCREF(__pyx_t_2); __pyx_t_1++; if (unlikely(0 < 0)) __PYX_ERR(0, 1039, __pyx_L1_error)
          #else
          __pyx_t_2 = PySequence_ITEM(__pyx_t_3, __pyx_t_1); __pyx_t_1++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1039, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_2);
          #endif
        } else {
          if (__pyx_t_1 >= PyTuple_GET_SIZE(__pyx_t_3)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_2 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_1); __Pyx_INCREF(__pyx_t_2); __pyx_t_1++; if (unlikely(0 < 0)) __PYX_ERR(0, 1039, __pyx_L1_error)
          #else
          __pyx_t_2 = PySequence_ITEM(__pyx_t_3, __pyx_t_1); __pyx_t_1++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1039, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_2);
          #endif
        }
      } else {
        __pyx_t_2 = __pyx_t_5(__pyx_t_3);
        if (unlikely(!__pyx_t_2)) {
          PyObject* exc_type = PyErr_Occurred();
          if (exc_type) {
            if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
            else __PYX_ERR(0, 1039, __pyx_L1_error)
          }
          break;
        }
        __Pyx_GOTREF(__pyx_t_2);
      }
      __Pyx_DECREF_SET(__pyx_v_x, __pyx_t_2);
      __pyx_t_2 = 0;

      /* "vapor_vali/Simple_function.pyx":1040
 *         temp_hash={}
 *         for x in x:
 *             if not x[1] in list(temp_hash.keys()):    temp_hash[x[1]]=[x]             # <<<<<<<<<<<<<<
 *             else:    temp_hash[x[1]]+=[x]
 *         for x in sorted(temp_hash.keys()):
 */
      __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_x, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1040, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __pyx_t_6 = __Pyx_PyDict_Keys(__pyx_v_temp_hash); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1040, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_6);
      __pyx_t_7 = PySequence_List(__pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1040, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_7);
      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
      __pyx_t_4 = (__Pyx_PySequence_ContainsTF(__pyx_t_2, __pyx_t_7, Py_NE)); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 1040, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
      __pyx_t_8 = (__pyx_t_4 != 0);
      if (__pyx_t_8) {
        __pyx_t_7 = PyList_New(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1040, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_7);
        __Pyx_INCREF(__pyx_v_x);
        __Pyx_GIVEREF(__pyx_v_x);
        PyList_SET_ITEM(__pyx_t_7, 0, __pyx_v_x);
        __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_x, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1040, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
        if (unlikely(PyDict_SetItem(__pyx_v_temp_hash, __pyx_t_2, __pyx_t_7) < 0)) __PYX_ERR(0, 1040, __pyx_L1_error)
        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
        __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
        goto __pyx_L6;
      }

      /* "vapor_vali/Simple_function.pyx":1041
 *         for x in x:
 *             if not x[1] in list(temp_hash.keys()):    temp_hash[x[1]]=[x]
 *             else:    temp_hash[x[1]]+=[x]             # <<<<<<<<<<<<<<
 *         for x in sorted(temp_hash.keys()):
 *             if len(out)<ideal_list_length:    out+=temp_hash[x]
 */
      /*else*/ {
        __pyx_t_7 = __Pyx_GetItemInt(__pyx_v_x, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1041, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_7);
        __pyx_t_2 = __Pyx_PyDict_GetItem(__pyx_v_temp_hash, __pyx_t_7); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1041, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
        __pyx_t_6 = PyList_New(1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1041, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_6);
        __Pyx_INCREF(__pyx_v_x);
        __Pyx_GIVEREF(__pyx_v_x);
        PyList_SET_ITEM(__pyx_t_6, 0, __pyx_v_x);
        __pyx_t_9 = PyNumber_InPlaceAdd(__pyx_t_2, __pyx_t_6); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1041, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_9);
        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
        __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
        if (unlikely(PyDict_SetItem(__pyx_v_temp_hash, __pyx_t_7, __pyx_t_9) < 0)) __PYX_ERR(0, 1041, __pyx_L1_error)
        __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
        __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
      }
      __pyx_L6:;

      /* "vapor_vali/Simple_function.pyx":1039
 *         out=[]
 *         temp_hash={}
 *         for x in x:             # <<<<<<<<<<<<<<
 *             if not x[1] in list(temp_hash.keys()):    temp_hash[x[1]]=[x]
 *             else:    temp_hash[x[1]]+=[x]
 */
    }
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;

    /* "vapor_vali/Simple_function.pyx":1042
 *             if not x[1] in list(temp_hash.keys()):    temp_hash[x[1]]=[x]
 *             else:    temp_hash[x[1]]+=[x]
 *         for x in sorted(temp_hash.keys()):             # <<<<<<<<<<<<<<
 *             if len(out)<ideal_list_length:    out+=temp_hash[x]
 *             return out[:ideal_list_length]
 */
    __pyx_t_7 = __Pyx_PyDict_Keys(__pyx_v_temp_hash); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1042, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    __pyx_t_9 = PySequence_List(__pyx_t_7); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1042, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_9);
    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_t_3 = ((PyObject*)__pyx_t_9);
    __pyx_t_9 = 0;
    __pyx_t_10 = PyList_Sort(__pyx_t_3); if (unlikely(__pyx_t_10 == -1)) __PYX_ERR(0, 1042, __pyx_L1_error)
    if (unlikely(__pyx_t_3 == Py_None)) {
      PyErr_SetString(PyExc_TypeError, "'NoneType' object is not iterable");
      __PYX_ERR(0, 1042, __pyx_L1_error)
    }
    __pyx_t_9 = __pyx_t_3; __Pyx_INCREF(__pyx_t_9); __pyx_t_1 = 0;
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    for (;;) {
      if (__pyx_t_1 >= PyList_GET_SIZE(__pyx_t_9)) break;
      #if CYTHON_COMPILING_IN_CPYTHON
      __pyx_t_3 = PyList_GET_ITEM(__pyx_t_9, __pyx_t_1); __Pyx_INCREF(__pyx_t_3); __pyx_t_1++; if (unlikely(0 < 0)) __PYX_ERR(0, 1042, __pyx_L1_error)
      #else
      __pyx_t_3 = PySequence_ITEM(__pyx_t_9, __pyx_t_1); __pyx_t_1++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1042, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      #endif
      __Pyx_DECREF_SET(__pyx_v_x, __pyx_t_3);
      __pyx_t_3 = 0;

      /* "vapor_vali/Simple_function.pyx":1043
 *             else:    temp_hash[x[1]]+=[x]
 *         for x in sorted(temp_hash.keys()):
 *             if len(out)<ideal_list_length:    out+=temp_hash[x]             # <<<<<<<<<<<<<<
 *             return out[:ideal_list_length]
 *     else: return x
 */
      __pyx_t_11 = PyObject_Length(__pyx_v_out); if (unlikely(__pyx_t_11 == -1)) __PYX_ERR(0, 1043, __pyx_L1_error)
      __pyx_t_3 = PyInt_FromSsize_t(__pyx_t_11); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1043, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __pyx_t_7 = PyObject_RichCompare(__pyx_t_3, __pyx_v_ideal_list_length, Py_LT); __Pyx_XGOTREF(__pyx_t_7); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1043, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_8 = __Pyx_PyObject_IsTrue(__pyx_t_7); if (unlikely(__pyx_t_8 < 0)) __PYX_ERR(0, 1043, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
      if (__pyx_t_8) {
        __pyx_t_7 = __Pyx_PyDict_GetItem(__pyx_v_temp_hash, __pyx_v_x); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1043, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_7);
        __pyx_t_3 = PyNumber_InPlaceAdd(__pyx_v_out, __pyx_t_7); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1043, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_3);
        __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
        __Pyx_DECREF_SET(__pyx_v_out, __pyx_t_3);
        __pyx_t_3 = 0;
      }

      /* "vapor_vali/Simple_function.pyx":1044
 *         for x in sorted(temp_hash.keys()):
 *             if len(out)<ideal_list_length:    out+=temp_hash[x]
 *             return out[:ideal_list_length]             # <<<<<<<<<<<<<<
 *     else: return x
 * 
 */
      __Pyx_XDECREF(__pyx_r);
      __pyx_t_3 = __Pyx_PyObject_GetSlice(__pyx_v_out, 0, 0, NULL, &__pyx_v_ideal_list_length, NULL, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1044, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __pyx_r = __pyx_t_3;
      __pyx_t_3 = 0;
      __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
      goto __pyx_L0;

      /* "vapor_vali/Simple_function.pyx":1042
 *             if not x[1] in list(temp_hash.keys()):    temp_hash[x[1]]=[x]
 *             else:    temp_hash[x[1]]+=[x]
 *         for x in sorted(temp_hash.keys()):             # <<<<<<<<<<<<<<
 *             if len(out)<ideal_list_length:    out+=temp_hash[x]
 *             return out[:ideal_list_length]
 */
    }
    __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;

    /* "vapor_vali/Simple_function.pyx":1036
 * def minimize_pacbio_read_list(x,ideal_list_length=20):
 *     #eg of x=chop_pacbio_read_by_pos(bam_in_new,chrom,start,end,flank_length)
 *     if len(x)>ideal_list_length:             # <<<<<<<<<<<<<<
 *         out=[]
 *         temp_hash={}
 */
    goto __pyx_L3;
  }

  /* "vapor_vali/Simple_function.pyx":1045
 *             if len(out)<ideal_list_length:    out+=temp_hash[x]
 *             return out[:ideal_list_length]
 *     else: return x             # <<<<<<<<<<<<<<
 * 
 * def number_cluster(dis_to_diagnal_list,dis_range):
 */
  /*else*/ {
    __Pyx_XDECREF(__pyx_r);
    __Pyx_INCREF(__pyx_v_x);
    __pyx_r = __pyx_v_x;
    goto __pyx_L0;
  }
  __pyx_L3:;

  /* "vapor_vali/Simple_function.pyx":1034
 *                 grdevices.dev_off()
 * 
 * def minimize_pacbio_read_list(x,ideal_list_length=20):             # <<<<<<<<<<<<<<
 *     #eg of x=chop_pacbio_read_by_pos(bam_in_new,chrom,start,end,flank_length)
 *     if len(x)>ideal_list_length:
 */

  /* function exit code */
  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_XDECREF(__pyx_t_7);
  __Pyx_XDECREF(__pyx_t_9);
  __Pyx_AddTraceback("vapor_vali.Simple_function.minimize_pacbio_read_list", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_out);
  __Pyx_XDECREF(__pyx_v_temp_hash);
  __Pyx_XDECREF(__pyx_v_x);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "vapor_vali/Simple_function.pyx":1047
 *     else: return x
 * 
 * def number_cluster(dis_to_diagnal_list,dis_range):             # <<<<<<<<<<<<<<
 *     dis_clu=[[] for i in dis_range]
 *     reca=0
 */

/* Python wrapper */
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_141number_cluster(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_10vapor_vali_15Simple_function_141number_cluster = {"number_cluster", (PyCFunction)__pyx_pw_10vapor_vali_15Simple_function_141number_cluster, METH_VARARGS|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_141number_cluster(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_dis_to_diagnal_list = 0;
  PyObject *__pyx_v_dis_range = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("number_cluster (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_dis_to_diagnal_list,&__pyx_n_s_dis_range,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_dis_to_diagnal_list)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_dis_range)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("number_cluster", 1, 2, 2, 1); __PYX_ERR(0, 1047, __pyx_L3_error)
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "number_cluster") < 0)) __PYX_ERR(0, 1047, __pyx_L3_error)
      }
    } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
    }
    __pyx_v_dis_to_diagnal_list = values[0];
    __pyx_v_dis_range = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("number_cluster", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1047, __pyx_L3_error)
  __pyx_L3_error:;
  __Pyx_AddTraceback("vapor_vali.Simple_function.number_cluster", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_10vapor_vali_15Simple_function_140number_cluster(__pyx_self, __pyx_v_dis_to_diagnal_list, __pyx_v_dis_range);

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10vapor_vali_15Simple_function_140number_cluster(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_dis_to_diagnal_list, PyObject *__pyx_v_dis_range) {
  PyObject *__pyx_v_dis_clu = NULL;
  PyObject *__pyx_v_reca = NULL;
  PyObject *__pyx_v_recb = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  Py_ssize_t __pyx_t_3;
  PyObject *(*__pyx_t_4)(PyObject *);
  PyObject *__pyx_t_5 = NULL;
  int __pyx_t_6;
  int __pyx_t_7;
  int __pyx_t_8;
  __Pyx_RefNannySetupContext("number_cluster", 0);

  /* "vapor_vali/Simple_function.pyx":1048
 * 
 * def number_cluster(dis_to_diagnal_list,dis_range):
 *     dis_clu=[[] for i in dis_range]             # <<<<<<<<<<<<<<
 *     reca=0
 *     recb=1
 */
  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1048, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  if (likely(PyList_CheckExact(__pyx_v_dis_range)) || PyTuple_CheckExact(__pyx_v_dis_range)) {
    __pyx_t_2 = __pyx_v_dis_range; __Pyx_INCREF(__pyx_t_2); __pyx_t_3 = 0;
    __pyx_t_4 = NULL;
  } else {
    __pyx_t_3 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_v_dis_range); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1048, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_4 = Py_TYPE(__pyx_t_2)->tp_iternext; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1048, __pyx_L1_error)
  }
  for (;;) {
    if (likely(!__pyx_t_4)) {
      if (likely(PyList_CheckExact(__pyx_t_2))) {
        if (__pyx_t_3 >= PyList_GET_SIZE(__pyx_t_2)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_5 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_3); __Pyx_INCREF(__pyx_t_5); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 1048, __pyx_L1_error)
        #else
        __pyx_t_5 = PySequence_ITEM(__pyx_t_2, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1048, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_5);
        #endif
      } else {
        if (__pyx_t_3 >= PyTuple_GET_SIZE(__pyx_t_2)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_5 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_3); __Pyx_INCREF(__pyx_t_5); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 1048, __pyx_L1_error)
        #else
        __pyx_t_5 = PySequence_ITEM(__pyx_t_2, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1048, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_5);
        #endif
      }
    } else {
      __pyx_t_5 = __pyx_t_4(__pyx_t_2);
      if (unlikely(!__pyx_t_5)) {
        PyObject* exc_type = PyErr_Occurred();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
          else __PYX_ERR(0, 1048, __pyx_L1_error)
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_5);
    }
    __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_5);
    __pyx_t_5 = 0;
    __pyx_t_5 = PyList_New(0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1048, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    if (unlikely(__Pyx_ListComp_Append(__pyx_t_1, (PyObject*)__pyx_t_5))) __PYX_ERR(0, 1048, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  }
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_dis_clu = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":1049
 * def number_cluster(dis_to_diagnal_list,dis_range):
 *     dis_clu=[[] for i in dis_range]
 *     reca=0             # <<<<<<<<<<<<<<
 *     recb=1
 *     dis_to_diagnal_list.sort()
 */
  __Pyx_INCREF(__pyx_int_0);
  __pyx_v_reca = __pyx_int_0;

  /* "vapor_vali/Simple_function.pyx":1050
 *     dis_clu=[[] for i in dis_range]
 *     reca=0
 *     recb=1             # <<<<<<<<<<<<<<
 *     dis_to_diagnal_list.sort()
 *     while True:
 */
  __Pyx_INCREF(__pyx_int_1);
  __pyx_v_recb = __pyx_int_1;

  /* "vapor_vali/Simple_function.pyx":1051
 *     reca=0
 *     recb=1
 *     dis_to_diagnal_list.sort()             # <<<<<<<<<<<<<<
 *     while True:
 *         if reca==len(dis_to_diagnal_list) or recb==len(dis_range): break
 */
  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_dis_to_diagnal_list, __pyx_n_s_sort); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1051, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_5 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_2);
    if (likely(__pyx_t_5)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_5);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_2, function);
    }
  }
  if (__pyx_t_5) {
    __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1051, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  } else {
    __pyx_t_1 = __Pyx_PyObject_CallNoArg(__pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1051, __pyx_L1_error)
  }
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":1052
 *     recb=1
 *     dis_to_diagnal_list.sort()
 *     while True:             # <<<<<<<<<<<<<<
 *         if reca==len(dis_to_diagnal_list) or recb==len(dis_range): break
 *         if dis_to_diagnal_list[reca]<dis_range[recb]:
 */
  while (1) {

    /* "vapor_vali/Simple_function.pyx":1053
 *     dis_to_diagnal_list.sort()
 *     while True:
 *         if reca==len(dis_to_diagnal_list) or recb==len(dis_range): break             # <<<<<<<<<<<<<<
 *         if dis_to_diagnal_list[reca]<dis_range[recb]:
 *             dis_clu[recb-1].append(dis_to_diagnal_list[reca])
 */
    __pyx_t_3 = PyObject_Length(__pyx_v_dis_to_diagnal_list); if (unlikely(__pyx_t_3 == -1)) __PYX_ERR(0, 1053, __pyx_L1_error)
    __pyx_t_1 = PyInt_FromSsize_t(__pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1053, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_2 = PyObject_RichCompare(__pyx_v_reca, __pyx_t_1, Py_EQ); __Pyx_XGOTREF(__pyx_t_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1053, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_7 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_7 < 0)) __PYX_ERR(0, 1053, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    if (!__pyx_t_7) {
    } else {
      __pyx_t_6 = __pyx_t_7;
      goto __pyx_L8_bool_binop_done;
    }
    __pyx_t_3 = PyObject_Length(__pyx_v_dis_range); if (unlikely(__pyx_t_3 == -1)) __PYX_ERR(0, 1053, __pyx_L1_error)
    __pyx_t_2 = PyInt_FromSsize_t(__pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1053, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_1 = PyObject_RichCompare(__pyx_v_recb, __pyx_t_2, Py_EQ); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1053, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_7 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_7 < 0)) __PYX_ERR(0, 1053, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_6 = __pyx_t_7;
    __pyx_L8_bool_binop_done:;
    if (__pyx_t_6) {
      goto __pyx_L6_break;
    }

    /* "vapor_vali/Simple_function.pyx":1054
 *     while True:
 *         if reca==len(dis_to_diagnal_list) or recb==len(dis_range): break
 *         if dis_to_diagnal_list[reca]<dis_range[recb]:             # <<<<<<<<<<<<<<
 *             dis_clu[recb-1].append(dis_to_diagnal_list[reca])
 *             reca+=1
 */
    __pyx_t_1 = PyObject_GetItem(__pyx_v_dis_to_diagnal_list, __pyx_v_reca); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1054, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_2 = PyObject_GetItem(__pyx_v_dis_range, __pyx_v_recb); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1054, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_5 = PyObject_RichCompare(__pyx_t_1, __pyx_t_2, Py_LT); __Pyx_XGOTREF(__pyx_t_5); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1054, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 1054, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    if (__pyx_t_6) {

      /* "vapor_vali/Simple_function.pyx":1055
 *         if reca==len(dis_to_diagnal_list) or recb==len(dis_range): break
 *         if dis_to_diagnal_list[reca]<dis_range[recb]:
 *             dis_clu[recb-1].append(dis_to_diagnal_list[reca])             # <<<<<<<<<<<<<<
 *             reca+=1
 *         else:
 */
      __pyx_t_5 = __Pyx_PyInt_SubtractObjC(__pyx_v_recb, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1055, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_5);
      __pyx_t_2 = PyObject_GetItem(__pyx_v_dis_clu, __pyx_t_5); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1055, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
      __pyx_t_5 = PyObject_GetItem(__pyx_v_dis_to_diagnal_list, __pyx_v_reca); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1055, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_5);
      __pyx_t_8 = __Pyx_PyObject_Append(__pyx_t_2, __pyx_t_5); if (unlikely(__pyx_t_8 == -1)) __PYX_ERR(0, 1055, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;

      /* "vapor_vali/Simple_function.pyx":1056
 *         if dis_to_diagnal_list[reca]<dis_range[recb]:
 *             dis_clu[recb-1].append(dis_to_diagnal_list[reca])
 *             reca+=1             # <<<<<<<<<<<<<<
 *         else:
 *             recb+=1
 */
      __pyx_t_5 = __Pyx_PyInt_AddObjC(__pyx_v_reca, __pyx_int_1, 1, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1056, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_5);
      __Pyx_DECREF_SET(__pyx_v_reca, __pyx_t_5);
      __pyx_t_5 = 0;

      /* "vapor_vali/Simple_function.pyx":1054
 *     while True:
 *         if reca==len(dis_to_diagnal_list) or recb==len(dis_range): break
 *         if dis_to_diagnal_list[reca]<dis_range[recb]:             # <<<<<<<<<<<<<<
 *             dis_clu[recb-1].append(dis_to_diagnal_list[reca])
 *             reca+=1
 */
      goto __pyx_L10;
    }

    /* "vapor_vali/Simple_function.pyx":1058
 *             reca+=1
 *         else:
 *             recb+=1             # <<<<<<<<<<<<<<
 *     if reca<len(dis_to_diagnal_list):
 *         dis_clu[-1]+=dis_to_diagnal_list[reca:]
 */
    /*else*/ {
      __pyx_t_5 = __Pyx_PyInt_AddObjC(__pyx_v_recb, __pyx_int_1, 1, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1058, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_5);
      __Pyx_DECREF_SET(__pyx_v_recb, __pyx_t_5);
      __pyx_t_5 = 0;
    }
    __pyx_L10:;
  }
  __pyx_L6_break:;

  /* "vapor_vali/Simple_function.pyx":1059
 *         else:
 *             recb+=1
 *     if reca<len(dis_to_diagnal_list):             # <<<<<<<<<<<<<<
 *         dis_clu[-1]+=dis_to_diagnal_list[reca:]
 *     return dis_clu
 */
  __pyx_t_3 = PyObject_Length(__pyx_v_dis_to_diagnal_list); if (unlikely(__pyx_t_3 == -1)) __PYX_ERR(0, 1059, __pyx_L1_error)
  __pyx_t_5 = PyInt_FromSsize_t(__pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1059, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_2 = PyObject_RichCompare(__pyx_v_reca, __pyx_t_5, Py_LT); __Pyx_XGOTREF(__pyx_t_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1059, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 1059, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  if (__pyx_t_6) {

    /* "vapor_vali/Simple_function.pyx":1060
 *             recb+=1
 *     if reca<len(dis_to_diagnal_list):
 *         dis_clu[-1]+=dis_to_diagnal_list[reca:]             # <<<<<<<<<<<<<<
 *     return dis_clu
 * 
 */
    __pyx_t_3 = -1L;
    __pyx_t_2 = __Pyx_GetItemInt_List(__pyx_v_dis_clu, __pyx_t_3, Py_ssize_t, 1, PyInt_FromSsize_t, 1, 1, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1060, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_5 = __Pyx_PyObject_GetSlice(__pyx_v_dis_to_diagnal_list, 0, 0, &__pyx_v_reca, NULL, NULL, 0, 0, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1060, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __pyx_t_1 = PyNumber_InPlaceAdd(__pyx_t_2, __pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1060, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    if (unlikely(__Pyx_SetItemInt(__pyx_v_dis_clu, __pyx_t_3, __pyx_t_1, Py_ssize_t, 1, PyInt_FromSsize_t, 1, 1, 1) < 0)) __PYX_ERR(0, 1060, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "vapor_vali/Simple_function.pyx":1059
 *         else:
 *             recb+=1
 *     if reca<len(dis_to_diagnal_list):             # <<<<<<<<<<<<<<
 *         dis_clu[-1]+=dis_to_diagnal_list[reca:]
 *     return dis_clu
 */
  }

  /* "vapor_vali/Simple_function.pyx":1061
 *     if reca<len(dis_to_diagnal_list):
 *         dis_clu[-1]+=dis_to_diagnal_list[reca:]
 *     return dis_clu             # <<<<<<<<<<<<<<
 * 
 * def one_dimention_cluster_by_gap(dim1,gap,length):
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_dis_clu);
  __pyx_r = __pyx_v_dis_clu;
  goto __pyx_L0;

  /* "vapor_vali/Simple_function.pyx":1047
 *     else: return x
 * 
 * def number_cluster(dis_to_diagnal_list,dis_range):             # <<<<<<<<<<<<<<
 *     dis_clu=[[] for i in dis_range]
 *     reca=0
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_AddTraceback("vapor_vali.Simple_function.number_cluster", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_dis_clu);
  __Pyx_XDECREF(__pyx_v_reca);
  __Pyx_XDECREF(__pyx_v_recb);
  __Pyx_XDECREF(__pyx_v_i);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "vapor_vali/Simple_function.pyx":1063
 *     return dis_clu
 * 
 * def one_dimention_cluster_by_gap(dim1,gap,length):             # <<<<<<<<<<<<<<
 *     out_hash={}
 *     for k1 in range(len(dim1)):
 */

/* Python wrapper */
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_143one_dimention_cluster_by_gap(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_10vapor_vali_15Simple_function_143one_dimention_cluster_by_gap = {"one_dimention_cluster_by_gap", (PyCFunction)__pyx_pw_10vapor_vali_15Simple_function_143one_dimention_cluster_by_gap, METH_VARARGS|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_143one_dimention_cluster_by_gap(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_dim1 = 0;
  PyObject *__pyx_v_gap = 0;
  PyObject *__pyx_v_length = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("one_dimention_cluster_by_gap (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_dim1,&__pyx_n_s_gap,&__pyx_n_s_length,0};
    PyObject* values[3] = {0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
      switch (pos_args) {
        case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_dim1)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_gap)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("one_dimention_cluster_by_gap", 1, 3, 3, 1); __PYX_ERR(0, 1063, __pyx_L3_error)
        }
        case  2:
        if (likely((values[2] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_length)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("one_dimention_cluster_by_gap", 1, 3, 3, 2); __PYX_ERR(0, 1063, __pyx_L3_error)
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "one_dimention_cluster_by_gap") < 0)) __PYX_ERR(0, 1063, __pyx_L3_error)
      }
    } else if (PyTuple_GET_SIZE(__pyx_args) != 3) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
    }
    __pyx_v_dim1 = values[0];
    __pyx_v_gap = values[1];
    __pyx_v_length = values[2];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("one_dimention_cluster_by_gap", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1063, __pyx_L3_error)
  __pyx_L3_error:;
  __Pyx_AddTraceback("vapor_vali.Simple_function.one_dimention_cluster_by_gap", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_10vapor_vali_15Simple_function_142one_dimention_cluster_by_gap(__pyx_self, __pyx_v_dim1, __pyx_v_gap, __pyx_v_length);

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10vapor_vali_15Simple_function_142one_dimention_cluster_by_gap(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_dim1, PyObject *__pyx_v_gap, PyObject *__pyx_v_length) {
  PyObject *__pyx_v_out_hash = NULL;
  PyObject *__pyx_v_k1 = NULL;
  PyObject *__pyx_v_sorted_keys = NULL;
  PyObject *__pyx_v_out = NULL;
  PyObject *__pyx_v_out2 = NULL;
  PyObject *__pyx_v_k2 = NULL;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  Py_ssize_t __pyx_t_2;
  PyObject *__pyx_t_3 = NULL;
  PyObject *(*__pyx_t_4)(PyObject *);
  PyObject *__pyx_t_5 = NULL;
  PyObject *__pyx_t_6 = NULL;
  int __pyx_t_7;
  int __pyx_t_8;
  int __pyx_t_9;
  Py_ssize_t __pyx_t_10;
  Py_ssize_t __pyx_t_11;
  PyObject *__pyx_t_12 = NULL;
  __Pyx_RefNannySetupContext("one_dimention_cluster_by_gap", 0);

  /* "vapor_vali/Simple_function.pyx":1064
 * 
 * def one_dimention_cluster_by_gap(dim1,gap,length):
 *     out_hash={}             # <<<<<<<<<<<<<<
 *     for k1 in range(len(dim1)):
 *         if not dim1[k1] in list(out_hash.keys()): out_hash[dim1[k1]]=[]
 */
  __pyx_t_1 = PyDict_New(); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1064, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_out_hash = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":1065
 * def one_dimention_cluster_by_gap(dim1,gap,length):
 *     out_hash={}
 *     for k1 in range(len(dim1)):             # <<<<<<<<<<<<<<
 *         if not dim1[k1] in list(out_hash.keys()): out_hash[dim1[k1]]=[]
 *         out_hash[dim1[k1]].append(k1)
 */
  __pyx_t_2 = PyObject_Length(__pyx_v_dim1); if (unlikely(__pyx_t_2 == -1)) __PYX_ERR(0, 1065, __pyx_L1_error)
  __pyx_t_1 = PyInt_FromSsize_t(__pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1065, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1065, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_GIVEREF(__pyx_t_1);
  PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_t_3, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1065, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  if (likely(PyList_CheckExact(__pyx_t_1)) || PyTuple_CheckExact(__pyx_t_1)) {
    __pyx_t_3 = __pyx_t_1; __Pyx_INCREF(__pyx_t_3); __pyx_t_2 = 0;
    __pyx_t_4 = NULL;
  } else {
    __pyx_t_2 = -1; __pyx_t_3 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1065, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_4 = Py_TYPE(__pyx_t_3)->tp_iternext; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1065, __pyx_L1_error)
  }
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  for (;;) {
    if (likely(!__pyx_t_4)) {
      if (likely(PyList_CheckExact(__pyx_t_3))) {
        if (__pyx_t_2 >= PyList_GET_SIZE(__pyx_t_3)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_1 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_2); __Pyx_INCREF(__pyx_t_1); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 1065, __pyx_L1_error)
        #else
        __pyx_t_1 = PySequence_ITEM(__pyx_t_3, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1065, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        #endif
      } else {
        if (__pyx_t_2 >= PyTuple_GET_SIZE(__pyx_t_3)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_2); __Pyx_INCREF(__pyx_t_1); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 1065, __pyx_L1_error)
        #else
        __pyx_t_1 = PySequence_ITEM(__pyx_t_3, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1065, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        #endif
      }
    } else {
      __pyx_t_1 = __pyx_t_4(__pyx_t_3);
      if (unlikely(!__pyx_t_1)) {
        PyObject* exc_type = PyErr_Occurred();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
          else __PYX_ERR(0, 1065, __pyx_L1_error)
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_1);
    }
    __Pyx_XDECREF_SET(__pyx_v_k1, __pyx_t_1);
    __pyx_t_1 = 0;

    /* "vapor_vali/Simple_function.pyx":1066
 *     out_hash={}
 *     for k1 in range(len(dim1)):
 *         if not dim1[k1] in list(out_hash.keys()): out_hash[dim1[k1]]=[]             # <<<<<<<<<<<<<<
 *         out_hash[dim1[k1]].append(k1)
 *     sorted_keys=sorted(out_hash.keys())
 */
    __pyx_t_1 = PyObject_GetItem(__pyx_v_dim1, __pyx_v_k1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1066, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_5 = __Pyx_PyDict_Keys(__pyx_v_out_hash); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1066, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __pyx_t_6 = PySequence_List(__pyx_t_5); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1066, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_7 = (__Pyx_PySequence_ContainsTF(__pyx_t_1, __pyx_t_6, Py_NE)); if (unlikely(__pyx_t_7 < 0)) __PYX_ERR(0, 1066, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_8 = (__pyx_t_7 != 0);
    if (__pyx_t_8) {
      __pyx_t_6 = PyList_New(0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1066, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_6);
      __pyx_t_1 = PyObject_GetItem(__pyx_v_dim1, __pyx_v_k1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1066, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      if (unlikely(PyDict_SetItem(__pyx_v_out_hash, __pyx_t_1, __pyx_t_6) < 0)) __PYX_ERR(0, 1066, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    }

    /* "vapor_vali/Simple_function.pyx":1067
 *     for k1 in range(len(dim1)):
 *         if not dim1[k1] in list(out_hash.keys()): out_hash[dim1[k1]]=[]
 *         out_hash[dim1[k1]].append(k1)             # <<<<<<<<<<<<<<
 *     sorted_keys=sorted(out_hash.keys())
 *     out=[[sorted_keys[0]]]
 */
    __pyx_t_6 = PyObject_GetItem(__pyx_v_dim1, __pyx_v_k1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1067, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __pyx_t_1 = __Pyx_PyDict_GetItem(__pyx_v_out_hash, __pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1067, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_9 = __Pyx_PyObject_Append(__pyx_t_1, __pyx_v_k1); if (unlikely(__pyx_t_9 == -1)) __PYX_ERR(0, 1067, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "vapor_vali/Simple_function.pyx":1065
 * def one_dimention_cluster_by_gap(dim1,gap,length):
 *     out_hash={}
 *     for k1 in range(len(dim1)):             # <<<<<<<<<<<<<<
 *         if not dim1[k1] in list(out_hash.keys()): out_hash[dim1[k1]]=[]
 *         out_hash[dim1[k1]].append(k1)
 */
  }
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;

  /* "vapor_vali/Simple_function.pyx":1068
 *         if not dim1[k1] in list(out_hash.keys()): out_hash[dim1[k1]]=[]
 *         out_hash[dim1[k1]].append(k1)
 *     sorted_keys=sorted(out_hash.keys())             # <<<<<<<<<<<<<<
 *     out=[[sorted_keys[0]]]
 *     for k1 in sorted_keys[1:]:
 */
  __pyx_t_1 = __Pyx_PyDict_Keys(__pyx_v_out_hash); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1068, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_6 = PySequence_List(__pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1068, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_3 = ((PyObject*)__pyx_t_6);
  __pyx_t_6 = 0;
  __pyx_t_9 = PyList_Sort(__pyx_t_3); if (unlikely(__pyx_t_9 == -1)) __PYX_ERR(0, 1068, __pyx_L1_error)
  __pyx_v_sorted_keys = ((PyObject*)__pyx_t_3);
  __pyx_t_3 = 0;

  /* "vapor_vali/Simple_function.pyx":1069
 *         out_hash[dim1[k1]].append(k1)
 *     sorted_keys=sorted(out_hash.keys())
 *     out=[[sorted_keys[0]]]             # <<<<<<<<<<<<<<
 *     for k1 in sorted_keys[1:]:
 *         if k1-out[-1][-1]>gap:  out.append([k1])
 */
  if (unlikely(__pyx_v_sorted_keys == Py_None)) {
    PyErr_SetString(PyExc_TypeError, "'NoneType' object is not subscriptable");
    __PYX_ERR(0, 1069, __pyx_L1_error)
  }
  __pyx_t_3 = __Pyx_GetItemInt_List(__pyx_v_sorted_keys, 0, long, 1, __Pyx_PyInt_From_long, 1, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1069, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_6 = PyList_New(1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1069, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_GIVEREF(__pyx_t_3);
  PyList_SET_ITEM(__pyx_t_6, 0, __pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = PyList_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1069, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_GIVEREF(__pyx_t_6);
  PyList_SET_ITEM(__pyx_t_3, 0, __pyx_t_6);
  __pyx_t_6 = 0;
  __pyx_v_out = ((PyObject*)__pyx_t_3);
  __pyx_t_3 = 0;

  /* "vapor_vali/Simple_function.pyx":1070
 *     sorted_keys=sorted(out_hash.keys())
 *     out=[[sorted_keys[0]]]
 *     for k1 in sorted_keys[1:]:             # <<<<<<<<<<<<<<
 *         if k1-out[-1][-1]>gap:  out.append([k1])
 *         else:   out[-1].append(k1)
 */
  if (unlikely(__pyx_v_sorted_keys == Py_None)) {
    PyErr_SetString(PyExc_TypeError, "'NoneType' object is not subscriptable");
    __PYX_ERR(0, 1070, __pyx_L1_error)
  }
  __pyx_t_3 = __Pyx_PyList_GetSlice(__pyx_v_sorted_keys, 1, PY_SSIZE_T_MAX); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1070, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_6 = __pyx_t_3; __Pyx_INCREF(__pyx_t_6); __pyx_t_2 = 0;
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  for (;;) {
    if (__pyx_t_2 >= PyList_GET_SIZE(__pyx_t_6)) break;
    #if CYTHON_COMPILING_IN_CPYTHON
    __pyx_t_3 = PyList_GET_ITEM(__pyx_t_6, __pyx_t_2); __Pyx_INCREF(__pyx_t_3); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 1070, __pyx_L1_error)
    #else
    __pyx_t_3 = PySequence_ITEM(__pyx_t_6, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1070, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    #endif
    __Pyx_XDECREF_SET(__pyx_v_k1, __pyx_t_3);
    __pyx_t_3 = 0;

    /* "vapor_vali/Simple_function.pyx":1071
 *     out=[[sorted_keys[0]]]
 *     for k1 in sorted_keys[1:]:
 *         if k1-out[-1][-1]>gap:  out.append([k1])             # <<<<<<<<<<<<<<
 *         else:   out[-1].append(k1)
 *     out2=[]
 */
    __pyx_t_3 = __Pyx_GetItemInt_List(__pyx_v_out, -1L, long, 1, __Pyx_PyInt_From_long, 1, 1, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1071, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_1 = __Pyx_GetItemInt(__pyx_t_3, -1L, long, 1, __Pyx_PyInt_From_long, 0, 1, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1071, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = PyNumber_Subtract(__pyx_v_k1, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1071, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = PyObject_RichCompare(__pyx_t_3, __pyx_v_gap, Py_GT); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1071, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_8 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_8 < 0)) __PYX_ERR(0, 1071, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    if (__pyx_t_8) {
      __pyx_t_1 = PyList_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1071, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_INCREF(__pyx_v_k1);
      __Pyx_GIVEREF(__pyx_v_k1);
      PyList_SET_ITEM(__pyx_t_1, 0, __pyx_v_k1);
      __pyx_t_9 = __Pyx_PyList_Append(__pyx_v_out, __pyx_t_1); if (unlikely(__pyx_t_9 == -1)) __PYX_ERR(0, 1071, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      goto __pyx_L8;
    }

    /* "vapor_vali/Simple_function.pyx":1072
 *     for k1 in sorted_keys[1:]:
 *         if k1-out[-1][-1]>gap:  out.append([k1])
 *         else:   out[-1].append(k1)             # <<<<<<<<<<<<<<
 *     out2=[]
 *     for k1 in out:
 */
    /*else*/ {
      __pyx_t_1 = __Pyx_GetItemInt_List(__pyx_v_out, -1L, long, 1, __Pyx_PyInt_From_long, 1, 1, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1072, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __pyx_t_9 = __Pyx_PyObject_Append(__pyx_t_1, __pyx_v_k1); if (unlikely(__pyx_t_9 == -1)) __PYX_ERR(0, 1072, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    }
    __pyx_L8:;

    /* "vapor_vali/Simple_function.pyx":1070
 *     sorted_keys=sorted(out_hash.keys())
 *     out=[[sorted_keys[0]]]
 *     for k1 in sorted_keys[1:]:             # <<<<<<<<<<<<<<
 *         if k1-out[-1][-1]>gap:  out.append([k1])
 *         else:   out[-1].append(k1)
 */
  }
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

  /* "vapor_vali/Simple_function.pyx":1073
 *         if k1-out[-1][-1]>gap:  out.append([k1])
 *         else:   out[-1].append(k1)
 *     out2=[]             # <<<<<<<<<<<<<<
 *     for k1 in out:
 *         out2.append([])
 */
  __pyx_t_6 = PyList_New(0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1073, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_v_out2 = ((PyObject*)__pyx_t_6);
  __pyx_t_6 = 0;

  /* "vapor_vali/Simple_function.pyx":1074
 *         else:   out[-1].append(k1)
 *     out2=[]
 *     for k1 in out:             # <<<<<<<<<<<<<<
 *         out2.append([])
 *         for k2 in k1:
 */
  __pyx_t_6 = __pyx_v_out; __Pyx_INCREF(__pyx_t_6); __pyx_t_2 = 0;
  for (;;) {
    if (__pyx_t_2 >= PyList_GET_SIZE(__pyx_t_6)) break;
    #if CYTHON_COMPILING_IN_CPYTHON
    __pyx_t_1 = PyList_GET_ITEM(__pyx_t_6, __pyx_t_2); __Pyx_INCREF(__pyx_t_1); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 1074, __pyx_L1_error)
    #else
    __pyx_t_1 = PySequence_ITEM(__pyx_t_6, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1074, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    #endif
    __Pyx_XDECREF_SET(__pyx_v_k1, __pyx_t_1);
    __pyx_t_1 = 0;

    /* "vapor_vali/Simple_function.pyx":1075
 *     out2=[]
 *     for k1 in out:
 *         out2.append([])             # <<<<<<<<<<<<<<
 *         for k2 in k1:
 *             out2[-1]+=out_hash[k2]
 */
    __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1075, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_9 = __Pyx_PyList_Append(__pyx_v_out2, __pyx_t_1); if (unlikely(__pyx_t_9 == -1)) __PYX_ERR(0, 1075, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "vapor_vali/Simple_function.pyx":1076
 *     for k1 in out:
 *         out2.append([])
 *         for k2 in k1:             # <<<<<<<<<<<<<<
 *             out2[-1]+=out_hash[k2]
 *     out2=[i for i in out2 if len(i)>length]
 */
    if (likely(PyList_CheckExact(__pyx_v_k1)) || PyTuple_CheckExact(__pyx_v_k1)) {
      __pyx_t_1 = __pyx_v_k1; __Pyx_INCREF(__pyx_t_1); __pyx_t_10 = 0;
      __pyx_t_4 = NULL;
    } else {
      __pyx_t_10 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_v_k1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1076, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __pyx_t_4 = Py_TYPE(__pyx_t_1)->tp_iternext; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1076, __pyx_L1_error)
    }
    for (;;) {
      if (likely(!__pyx_t_4)) {
        if (likely(PyList_CheckExact(__pyx_t_1))) {
          if (__pyx_t_10 >= PyList_GET_SIZE(__pyx_t_1)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_3 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_10); __Pyx_INCREF(__pyx_t_3); __pyx_t_10++; if (unlikely(0 < 0)) __PYX_ERR(0, 1076, __pyx_L1_error)
          #else
          __pyx_t_3 = PySequence_ITEM(__pyx_t_1, __pyx_t_10); __pyx_t_10++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1076, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_3);
          #endif
        } else {
          if (__pyx_t_10 >= PyTuple_GET_SIZE(__pyx_t_1)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_3 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_10); __Pyx_INCREF(__pyx_t_3); __pyx_t_10++; if (unlikely(0 < 0)) __PYX_ERR(0, 1076, __pyx_L1_error)
          #else
          __pyx_t_3 = PySequence_ITEM(__pyx_t_1, __pyx_t_10); __pyx_t_10++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1076, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_3);
          #endif
        }
      } else {
        __pyx_t_3 = __pyx_t_4(__pyx_t_1);
        if (unlikely(!__pyx_t_3)) {
          PyObject* exc_type = PyErr_Occurred();
          if (exc_type) {
            if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
            else __PYX_ERR(0, 1076, __pyx_L1_error)
          }
          break;
        }
        __Pyx_GOTREF(__pyx_t_3);
      }
      __Pyx_XDECREF_SET(__pyx_v_k2, __pyx_t_3);
      __pyx_t_3 = 0;

      /* "vapor_vali/Simple_function.pyx":1077
 *         out2.append([])
 *         for k2 in k1:
 *             out2[-1]+=out_hash[k2]             # <<<<<<<<<<<<<<
 *     out2=[i for i in out2 if len(i)>length]
 *     return out2
 */
      __pyx_t_11 = -1L;
      __pyx_t_3 = __Pyx_GetItemInt_List(__pyx_v_out2, __pyx_t_11, Py_ssize_t, 1, PyInt_FromSsize_t, 1, 1, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1077, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __pyx_t_5 = __Pyx_PyDict_GetItem(__pyx_v_out_hash, __pyx_v_k2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1077, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_5);
      __pyx_t_12 = PyNumber_InPlaceAdd(__pyx_t_3, __pyx_t_5); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1077, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_12);
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
      if (unlikely(__Pyx_SetItemInt(__pyx_v_out2, __pyx_t_11, __pyx_t_12, Py_ssize_t, 1, PyInt_FromSsize_t, 1, 1, 1) < 0)) __PYX_ERR(0, 1077, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;

      /* "vapor_vali/Simple_function.pyx":1076
 *     for k1 in out:
 *         out2.append([])
 *         for k2 in k1:             # <<<<<<<<<<<<<<
 *             out2[-1]+=out_hash[k2]
 *     out2=[i for i in out2 if len(i)>length]
 */
    }
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "vapor_vali/Simple_function.pyx":1074
 *         else:   out[-1].append(k1)
 *     out2=[]
 *     for k1 in out:             # <<<<<<<<<<<<<<
 *         out2.append([])
 *         for k2 in k1:
 */
  }
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

  /* "vapor_vali/Simple_function.pyx":1078
 *         for k2 in k1:
 *             out2[-1]+=out_hash[k2]
 *     out2=[i for i in out2 if len(i)>length]             # <<<<<<<<<<<<<<
 *     return out2
 * 
 */
  __pyx_t_6 = PyList_New(0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1078, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_1 = __pyx_v_out2; __Pyx_INCREF(__pyx_t_1); __pyx_t_2 = 0;
  for (;;) {
    if (__pyx_t_2 >= PyList_GET_SIZE(__pyx_t_1)) break;
    #if CYTHON_COMPILING_IN_CPYTHON
    __pyx_t_12 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_12); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 1078, __pyx_L1_error)
    #else
    __pyx_t_12 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1078, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_12);
    #endif
    __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_12);
    __pyx_t_12 = 0;
    __pyx_t_10 = PyObject_Length(__pyx_v_i); if (unlikely(__pyx_t_10 == -1)) __PYX_ERR(0, 1078, __pyx_L1_error)
    __pyx_t_12 = PyInt_FromSsize_t(__pyx_t_10); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1078, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_12);
    __pyx_t_5 = PyObject_RichCompare(__pyx_t_12, __pyx_v_length, Py_GT); __Pyx_XGOTREF(__pyx_t_5); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1078, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
    __pyx_t_8 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_8 < 0)) __PYX_ERR(0, 1078, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    if (__pyx_t_8) {
      if (unlikely(__Pyx_ListComp_Append(__pyx_t_6, (PyObject*)__pyx_v_i))) __PYX_ERR(0, 1078, __pyx_L1_error)
    }
  }
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF_SET(__pyx_v_out2, ((PyObject*)__pyx_t_6));
  __pyx_t_6 = 0;

  /* "vapor_vali/Simple_function.pyx":1079
 *             out2[-1]+=out_hash[k2]
 *     out2=[i for i in out2 if len(i)>length]
 *     return out2             # <<<<<<<<<<<<<<
 * 
 * def path_mkdir(path):
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_out2);
  __pyx_r = __pyx_v_out2;
  goto __pyx_L0;

  /* "vapor_vali/Simple_function.pyx":1063
 *     return dis_clu
 * 
 * def one_dimention_cluster_by_gap(dim1,gap,length):             # <<<<<<<<<<<<<<
 *     out_hash={}
 *     for k1 in range(len(dim1)):
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_XDECREF(__pyx_t_12);
  __Pyx_AddTraceback("vapor_vali.Simple_function.one_dimention_cluster_by_gap", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_out_hash);
  __Pyx_XDECREF(__pyx_v_k1);
  __Pyx_XDECREF(__pyx_v_sorted_keys);
  __Pyx_XDECREF(__pyx_v_out);
  __Pyx_XDECREF(__pyx_v_out2);
  __Pyx_XDECREF(__pyx_v_k2);
  __Pyx_XDECREF(__pyx_v_i);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "vapor_vali/Simple_function.pyx":1081
 *     return out2
 * 
 * def path_mkdir(path):             # <<<<<<<<<<<<<<
 *     if not os.path.isdir(path):
 *         os.system(r'''mkdir %s'''%(path))
 */

/* Python wrapper */
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_145path_mkdir(PyObject *__pyx_self, PyObject *__pyx_v_path); /*proto*/
static PyMethodDef __pyx_mdef_10vapor_vali_15Simple_function_145path_mkdir = {"path_mkdir", (PyCFunction)__pyx_pw_10vapor_vali_15Simple_function_145path_mkdir, METH_O, 0};
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_145path_mkdir(PyObject *__pyx_self, PyObject *__pyx_v_path) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("path_mkdir (wrapper)", 0);
  __pyx_r = __pyx_pf_10vapor_vali_15Simple_function_144path_mkdir(__pyx_self, ((PyObject *)__pyx_v_path));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10vapor_vali_15Simple_function_144path_mkdir(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_path) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  int __pyx_t_5;
  int __pyx_t_6;
  PyObject *__pyx_t_7 = NULL;
  __Pyx_RefNannySetupContext("path_mkdir", 0);

  /* "vapor_vali/Simple_function.pyx":1082
 * 
 * def path_mkdir(path):
 *     if not os.path.isdir(path):             # <<<<<<<<<<<<<<
 *         os.system(r'''mkdir %s'''%(path))
 * 
 */
  __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_os); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1082, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_path); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1082, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_isdir); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1082, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_3);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_2, function);
    }
  }
  if (!__pyx_t_3) {
    __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_v_path); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1082, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
  } else {
    __pyx_t_4 = PyTuple_New(1+1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1082, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_GIVEREF(__pyx_t_3); PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3); __pyx_t_3 = NULL;
    __Pyx_INCREF(__pyx_v_path);
    __Pyx_GIVEREF(__pyx_v_path);
    PyTuple_SET_ITEM(__pyx_t_4, 0+1, __pyx_v_path);
    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_4, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1082, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  }
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 1082, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_6 = ((!__pyx_t_5) != 0);
  if (__pyx_t_6) {

    /* "vapor_vali/Simple_function.pyx":1083
 * def path_mkdir(path):
 *     if not os.path.isdir(path):
 *         os.system(r'''mkdir %s'''%(path))             # <<<<<<<<<<<<<<
 * 
 * def path_modify(path):
 */
    __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_os); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1083, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_system); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1083, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = __Pyx_PyString_Format(__pyx_kp_s_mkdir_s, __pyx_v_path); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1083, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_3 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_4))) {
      __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_4);
      if (likely(__pyx_t_3)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
        __Pyx_INCREF(__pyx_t_3);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_4, function);
      }
    }
    if (!__pyx_t_3) {
      __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1083, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      __Pyx_GOTREF(__pyx_t_1);
    } else {
      __pyx_t_7 = PyTuple_New(1+1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1083, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_7);
      __Pyx_GIVEREF(__pyx_t_3); PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_3); __pyx_t_3 = NULL;
      __Pyx_GIVEREF(__pyx_t_2);
      PyTuple_SET_ITEM(__pyx_t_7, 0+1, __pyx_t_2);
      __pyx_t_2 = 0;
      __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_7, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1083, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
    }
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "vapor_vali/Simple_function.pyx":1082
 * 
 * def path_mkdir(path):
 *     if not os.path.isdir(path):             # <<<<<<<<<<<<<<
 *         os.system(r'''mkdir %s'''%(path))
 * 
 */
  }

  /* "vapor_vali/Simple_function.pyx":1081
 *     return out2
 * 
 * def path_mkdir(path):             # <<<<<<<<<<<<<<
 *     if not os.path.isdir(path):
 *         os.system(r'''mkdir %s'''%(path))
 */

  /* function exit code */
  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_7);
  __Pyx_AddTraceback("vapor_vali.Simple_function.path_mkdir", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "vapor_vali/Simple_function.pyx":1085
 *         os.system(r'''mkdir %s'''%(path))
 * 
 * def path_modify(path):             # <<<<<<<<<<<<<<
 *     if not path[-1]=='/':
 *         path+='/'
 */

/* Python wrapper */
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_147path_modify(PyObject *__pyx_self, PyObject *__pyx_v_path); /*proto*/
static PyMethodDef __pyx_mdef_10vapor_vali_15Simple_function_147path_modify = {"path_modify", (PyCFunction)__pyx_pw_10vapor_vali_15Simple_function_147path_modify, METH_O, 0};
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_147path_modify(PyObject *__pyx_self, PyObject *__pyx_v_path) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("path_modify (wrapper)", 0);
  __pyx_r = __pyx_pf_10vapor_vali_15Simple_function_146path_modify(__pyx_self, ((PyObject *)__pyx_v_path));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10vapor_vali_15Simple_function_146path_modify(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_path) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_t_2;
  int __pyx_t_3;
  __Pyx_RefNannySetupContext("path_modify", 0);
  __Pyx_INCREF(__pyx_v_path);

  /* "vapor_vali/Simple_function.pyx":1086
 * 
 * def path_modify(path):
 *     if not path[-1]=='/':             # <<<<<<<<<<<<<<
 *         path+='/'
 *     return path
 */
  __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_path, -1L, long, 1, __Pyx_PyInt_From_long, 0, 1, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1086, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = (__Pyx_PyString_Equals(__pyx_t_1, __pyx_kp_s__3, Py_EQ)); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 1086, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_3 = ((!__pyx_t_2) != 0);
  if (__pyx_t_3) {

    /* "vapor_vali/Simple_function.pyx":1087
 * def path_modify(path):
 *     if not path[-1]=='/':
 *         path+='/'             # <<<<<<<<<<<<<<
 *     return path
 * 
 */
    __pyx_t_1 = PyNumber_InPlaceAdd(__pyx_v_path, __pyx_kp_s__3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1087, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF_SET(__pyx_v_path, __pyx_t_1);
    __pyx_t_1 = 0;

    /* "vapor_vali/Simple_function.pyx":1086
 * 
 * def path_modify(path):
 *     if not path[-1]=='/':             # <<<<<<<<<<<<<<
 *         path+='/'
 *     return path
 */
  }

  /* "vapor_vali/Simple_function.pyx":1088
 *     if not path[-1]=='/':
 *         path+='/'
 *     return path             # <<<<<<<<<<<<<<
 * 
 * def polarity_detect(pin):
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_path);
  __pyx_r = __pyx_v_path;
  goto __pyx_L0;

  /* "vapor_vali/Simple_function.pyx":1085
 *         os.system(r'''mkdir %s'''%(path))
 * 
 * def path_modify(path):             # <<<<<<<<<<<<<<
 *     if not path[-1]=='/':
 *         path+='/'
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("vapor_vali.Simple_function.path_modify", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_path);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "vapor_vali/Simple_function.pyx":1090
 *     return path
 * 
 * def polarity_detect(pin):             # <<<<<<<<<<<<<<
 *     out='+'
 *     for x in pin[7].split(';'):
 */

/* Python wrapper */
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_149polarity_detect(PyObject *__pyx_self, PyObject *__pyx_v_pin); /*proto*/
static PyMethodDef __pyx_mdef_10vapor_vali_15Simple_function_149polarity_detect = {"polarity_detect", (PyCFunction)__pyx_pw_10vapor_vali_15Simple_function_149polarity_detect, METH_O, 0};
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_149polarity_detect(PyObject *__pyx_self, PyObject *__pyx_v_pin) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("polarity_detect (wrapper)", 0);
  __pyx_r = __pyx_pf_10vapor_vali_15Simple_function_148polarity_detect(__pyx_self, ((PyObject *)__pyx_v_pin));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10vapor_vali_15Simple_function_148polarity_detect(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_pin) {
  PyObject *__pyx_v_out = NULL;
  PyObject *__pyx_v_x = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  Py_ssize_t __pyx_t_3;
  PyObject *(*__pyx_t_4)(PyObject *);
  int __pyx_t_5;
  int __pyx_t_6;
  PyObject *__pyx_t_7 = NULL;
  __Pyx_RefNannySetupContext("polarity_detect", 0);

  /* "vapor_vali/Simple_function.pyx":1091
 * 
 * def polarity_detect(pin):
 *     out='+'             # <<<<<<<<<<<<<<
 *     for x in pin[7].split(';'):
 *         if 'MEIINFO=' in x:
 */
  __Pyx_INCREF(__pyx_kp_s__2);
  __pyx_v_out = __pyx_kp_s__2;

  /* "vapor_vali/Simple_function.pyx":1092
 * def polarity_detect(pin):
 *     out='+'
 *     for x in pin[7].split(';'):             # <<<<<<<<<<<<<<
 *         if 'MEIINFO=' in x:
 *             out=x.split(',')[-1]
 */
  __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_pin, 7, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1092, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_split); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1092, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_tuple__82, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1092, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  if (likely(PyList_CheckExact(__pyx_t_1)) || PyTuple_CheckExact(__pyx_t_1)) {
    __pyx_t_2 = __pyx_t_1; __Pyx_INCREF(__pyx_t_2); __pyx_t_3 = 0;
    __pyx_t_4 = NULL;
  } else {
    __pyx_t_3 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1092, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_4 = Py_TYPE(__pyx_t_2)->tp_iternext; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1092, __pyx_L1_error)
  }
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  for (;;) {
    if (likely(!__pyx_t_4)) {
      if (likely(PyList_CheckExact(__pyx_t_2))) {
        if (__pyx_t_3 >= PyList_GET_SIZE(__pyx_t_2)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_1 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_3); __Pyx_INCREF(__pyx_t_1); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 1092, __pyx_L1_error)
        #else
        __pyx_t_1 = PySequence_ITEM(__pyx_t_2, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1092, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        #endif
      } else {
        if (__pyx_t_3 >= PyTuple_GET_SIZE(__pyx_t_2)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_3); __Pyx_INCREF(__pyx_t_1); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 1092, __pyx_L1_error)
        #else
        __pyx_t_1 = PySequence_ITEM(__pyx_t_2, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1092, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        #endif
      }
    } else {
      __pyx_t_1 = __pyx_t_4(__pyx_t_2);
      if (unlikely(!__pyx_t_1)) {
        PyObject* exc_type = PyErr_Occurred();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
          else __PYX_ERR(0, 1092, __pyx_L1_error)
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_1);
    }
    __Pyx_XDECREF_SET(__pyx_v_x, __pyx_t_1);
    __pyx_t_1 = 0;

    /* "vapor_vali/Simple_function.pyx":1093
 *     out='+'
 *     for x in pin[7].split(';'):
 *         if 'MEIINFO=' in x:             # <<<<<<<<<<<<<<
 *             out=x.split(',')[-1]
 *     return out
 */
    __pyx_t_5 = (__Pyx_PySequence_ContainsTF(__pyx_kp_s_MEIINFO, __pyx_v_x, Py_EQ)); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 1093, __pyx_L1_error)
    __pyx_t_6 = (__pyx_t_5 != 0);
    if (__pyx_t_6) {

      /* "vapor_vali/Simple_function.pyx":1094
 *     for x in pin[7].split(';'):
 *         if 'MEIINFO=' in x:
 *             out=x.split(',')[-1]             # <<<<<<<<<<<<<<
 *     return out
 * 
 */
      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_x, __pyx_n_s_split); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1094, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_tuple__84, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1094, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_7);
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_1 = __Pyx_GetItemInt(__pyx_t_7, -1L, long, 1, __Pyx_PyInt_From_long, 0, 1, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1094, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
      __Pyx_DECREF_SET(__pyx_v_out, __pyx_t_1);
      __pyx_t_1 = 0;

      /* "vapor_vali/Simple_function.pyx":1093
 *     out='+'
 *     for x in pin[7].split(';'):
 *         if 'MEIINFO=' in x:             # <<<<<<<<<<<<<<
 *             out=x.split(',')[-1]
 *     return out
 */
    }

    /* "vapor_vali/Simple_function.pyx":1092
 * def polarity_detect(pin):
 *     out='+'
 *     for x in pin[7].split(';'):             # <<<<<<<<<<<<<<
 *         if 'MEIINFO=' in x:
 *             out=x.split(',')[-1]
 */
  }
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":1095
 *         if 'MEIINFO=' in x:
 *             out=x.split(',')[-1]
 *     return out             # <<<<<<<<<<<<<<
 * 
 * def qual_check_repetitive_region(dotdata_qual_check):
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_out);
  __pyx_r = __pyx_v_out;
  goto __pyx_L0;

  /* "vapor_vali/Simple_function.pyx":1090
 *     return path
 * 
 * def polarity_detect(pin):             # <<<<<<<<<<<<<<
 *     out='+'
 *     for x in pin[7].split(';'):
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_7);
  __Pyx_AddTraceback("vapor_vali.Simple_function.polarity_detect", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_out);
  __Pyx_XDECREF(__pyx_v_x);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "vapor_vali/Simple_function.pyx":1097
 *     return out
 * 
 * def qual_check_repetitive_region(dotdata_qual_check):             # <<<<<<<<<<<<<<
 *     #qual_check_R_2(dotdata_qual_check,txt_file)  #not necessary for validator
 *     diagnal=0
 */

/* Python wrapper */
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_151qual_check_repetitive_region(PyObject *__pyx_self, PyObject *__pyx_v_dotdata_qual_check); /*proto*/
static PyMethodDef __pyx_mdef_10vapor_vali_15Simple_function_151qual_check_repetitive_region = {"qual_check_repetitive_region", (PyCFunction)__pyx_pw_10vapor_vali_15Simple_function_151qual_check_repetitive_region, METH_O, 0};
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_151qual_check_repetitive_region(PyObject *__pyx_self, PyObject *__pyx_v_dotdata_qual_check) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("qual_check_repetitive_region (wrapper)", 0);
  __pyx_r = __pyx_pf_10vapor_vali_15Simple_function_150qual_check_repetitive_region(__pyx_self, ((PyObject *)__pyx_v_dotdata_qual_check));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10vapor_vali_15Simple_function_150qual_check_repetitive_region(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_dotdata_qual_check) {
  PyObject *__pyx_v_diagnal = NULL;
  PyObject *__pyx_v_other = NULL;
  PyObject *__pyx_v_x = NULL;
  PyObject *__pyx_v_other_cluster = NULL;
  PyObject *__pyx_v_range_cluster = NULL;
  PyObject *__pyx_v_size_cluster = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  Py_ssize_t __pyx_t_4;
  PyObject *(*__pyx_t_5)(PyObject *);
  PyObject *__pyx_t_6 = NULL;
  int __pyx_t_7;
  int __pyx_t_8;
  int __pyx_t_9;
  Py_ssize_t __pyx_t_10;
  double __pyx_t_11;
  __Pyx_RefNannySetupContext("qual_check_repetitive_region", 0);

  /* "vapor_vali/Simple_function.pyx":1099
 * def qual_check_repetitive_region(dotdata_qual_check):
 *     #qual_check_R_2(dotdata_qual_check,txt_file)  #not necessary for validator
 *     diagnal=0             # <<<<<<<<<<<<<<
 *     other=[[],[]]
 *     for x in dotdata_qual_check:
 */
  __Pyx_INCREF(__pyx_int_0);
  __pyx_v_diagnal = __pyx_int_0;

  /* "vapor_vali/Simple_function.pyx":1100
 *     #qual_check_R_2(dotdata_qual_check,txt_file)  #not necessary for validator
 *     diagnal=0
 *     other=[[],[]]             # <<<<<<<<<<<<<<
 *     for x in dotdata_qual_check:
 *         if x[0]==x[1]:
 */
  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1100, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = PyList_New(0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1100, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = PyList_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1100, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_GIVEREF(__pyx_t_1);
  PyList_SET_ITEM(__pyx_t_3, 0, __pyx_t_1);
  __Pyx_GIVEREF(__pyx_t_2);
  PyList_SET_ITEM(__pyx_t_3, 1, __pyx_t_2);
  __pyx_t_1 = 0;
  __pyx_t_2 = 0;
  __pyx_v_other = ((PyObject*)__pyx_t_3);
  __pyx_t_3 = 0;

  /* "vapor_vali/Simple_function.pyx":1101
 *     diagnal=0
 *     other=[[],[]]
 *     for x in dotdata_qual_check:             # <<<<<<<<<<<<<<
 *         if x[0]==x[1]:
 *             diagnal+=1
 */
  if (likely(PyList_CheckExact(__pyx_v_dotdata_qual_check)) || PyTuple_CheckExact(__pyx_v_dotdata_qual_check)) {
    __pyx_t_3 = __pyx_v_dotdata_qual_check; __Pyx_INCREF(__pyx_t_3); __pyx_t_4 = 0;
    __pyx_t_5 = NULL;
  } else {
    __pyx_t_4 = -1; __pyx_t_3 = PyObject_GetIter(__pyx_v_dotdata_qual_check); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1101, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_5 = Py_TYPE(__pyx_t_3)->tp_iternext; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1101, __pyx_L1_error)
  }
  for (;;) {
    if (likely(!__pyx_t_5)) {
      if (likely(PyList_CheckExact(__pyx_t_3))) {
        if (__pyx_t_4 >= PyList_GET_SIZE(__pyx_t_3)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_2 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_4); __Pyx_INCREF(__pyx_t_2); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 1101, __pyx_L1_error)
        #else
        __pyx_t_2 = PySequence_ITEM(__pyx_t_3, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1101, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
        #endif
      } else {
        if (__pyx_t_4 >= PyTuple_GET_SIZE(__pyx_t_3)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_2 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_4); __Pyx_INCREF(__pyx_t_2); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 1101, __pyx_L1_error)
        #else
        __pyx_t_2 = PySequence_ITEM(__pyx_t_3, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1101, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
        #endif
      }
    } else {
      __pyx_t_2 = __pyx_t_5(__pyx_t_3);
      if (unlikely(!__pyx_t_2)) {
        PyObject* exc_type = PyErr_Occurred();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
          else __PYX_ERR(0, 1101, __pyx_L1_error)
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_2);
    }
    __Pyx_XDECREF_SET(__pyx_v_x, __pyx_t_2);
    __pyx_t_2 = 0;

    /* "vapor_vali/Simple_function.pyx":1102
 *     other=[[],[]]
 *     for x in dotdata_qual_check:
 *         if x[0]==x[1]:             # <<<<<<<<<<<<<<
 *             diagnal+=1
 *         else:
 */
    __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_x, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1102, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_x, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1102, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_6 = PyObject_RichCompare(__pyx_t_2, __pyx_t_1, Py_EQ); __Pyx_XGOTREF(__pyx_t_6); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1102, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_7 = __Pyx_PyObject_IsTrue(__pyx_t_6); if (unlikely(__pyx_t_7 < 0)) __PYX_ERR(0, 1102, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    if (__pyx_t_7) {

      /* "vapor_vali/Simple_function.pyx":1103
 *     for x in dotdata_qual_check:
 *         if x[0]==x[1]:
 *             diagnal+=1             # <<<<<<<<<<<<<<
 *         else:
 *             if x[0]>x[1]:
 */
      __pyx_t_6 = __Pyx_PyInt_AddObjC(__pyx_v_diagnal, __pyx_int_1, 1, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1103, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_6);
      __Pyx_DECREF_SET(__pyx_v_diagnal, __pyx_t_6);
      __pyx_t_6 = 0;

      /* "vapor_vali/Simple_function.pyx":1102
 *     other=[[],[]]
 *     for x in dotdata_qual_check:
 *         if x[0]==x[1]:             # <<<<<<<<<<<<<<
 *             diagnal+=1
 *         else:
 */
      goto __pyx_L5;
    }

    /* "vapor_vali/Simple_function.pyx":1105
 *             diagnal+=1
 *         else:
 *             if x[0]>x[1]:             # <<<<<<<<<<<<<<
 *                 other[0].append(x[0])
 *                 other[1].append(x[1])
 */
    /*else*/ {
      __pyx_t_6 = __Pyx_GetItemInt(__pyx_v_x, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1105, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_6);
      __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_x, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1105, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __pyx_t_2 = PyObject_RichCompare(__pyx_t_6, __pyx_t_1, Py_GT); __Pyx_XGOTREF(__pyx_t_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1105, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_7 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_7 < 0)) __PYX_ERR(0, 1105, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      if (__pyx_t_7) {

        /* "vapor_vali/Simple_function.pyx":1106
 *         else:
 *             if x[0]>x[1]:
 *                 other[0].append(x[0])             # <<<<<<<<<<<<<<
 *                 other[1].append(x[1])
 *     if len(dotdata_qual_check)>0 and float(len(other[0]))/float(len(dotdata_qual_check))>0.1 and float(len(other[0]))/float(len(dotdata_qual_check))<0.5:
 */
        __pyx_t_2 = __Pyx_GetItemInt_List(__pyx_v_other, 0, long, 1, __Pyx_PyInt_From_long, 1, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1106, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
        __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_x, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1106, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        __pyx_t_8 = __Pyx_PyObject_Append(__pyx_t_2, __pyx_t_1); if (unlikely(__pyx_t_8 == -1)) __PYX_ERR(0, 1106, __pyx_L1_error)
        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

        /* "vapor_vali/Simple_function.pyx":1107
 *             if x[0]>x[1]:
 *                 other[0].append(x[0])
 *                 other[1].append(x[1])             # <<<<<<<<<<<<<<
 *     if len(dotdata_qual_check)>0 and float(len(other[0]))/float(len(dotdata_qual_check))>0.1 and float(len(other[0]))/float(len(dotdata_qual_check))<0.5:
 *         other_cluster=X_means_cluster_reformat(other)
 */
        __pyx_t_1 = __Pyx_GetItemInt_List(__pyx_v_other, 1, long, 1, __Pyx_PyInt_From_long, 1, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1107, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_x, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1107, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
        __pyx_t_8 = __Pyx_PyObject_Append(__pyx_t_1, __pyx_t_2); if (unlikely(__pyx_t_8 == -1)) __PYX_ERR(0, 1107, __pyx_L1_error)
        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

        /* "vapor_vali/Simple_function.pyx":1105
 *             diagnal+=1
 *         else:
 *             if x[0]>x[1]:             # <<<<<<<<<<<<<<
 *                 other[0].append(x[0])
 *                 other[1].append(x[1])
 */
      }
    }
    __pyx_L5:;

    /* "vapor_vali/Simple_function.pyx":1101
 *     diagnal=0
 *     other=[[],[]]
 *     for x in dotdata_qual_check:             # <<<<<<<<<<<<<<
 *         if x[0]==x[1]:
 *             diagnal+=1
 */
  }
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;

  /* "vapor_vali/Simple_function.pyx":1108
 *                 other[0].append(x[0])
 *                 other[1].append(x[1])
 *     if len(dotdata_qual_check)>0 and float(len(other[0]))/float(len(dotdata_qual_check))>0.1 and float(len(other[0]))/float(len(dotdata_qual_check))<0.5:             # <<<<<<<<<<<<<<
 *         other_cluster=X_means_cluster_reformat(other)
 *         range_cluster=cluster_range_decide(other_cluster)
 */
  __pyx_t_4 = PyObject_Length(__pyx_v_dotdata_qual_check); if (unlikely(__pyx_t_4 == -1)) __PYX_ERR(0, 1108, __pyx_L1_error)
  __pyx_t_9 = ((__pyx_t_4 > 0) != 0);
  if (__pyx_t_9) {
  } else {
    __pyx_t_7 = __pyx_t_9;
    goto __pyx_L8_bool_binop_done;
  }
  __pyx_t_3 = __Pyx_GetItemInt_List(__pyx_v_other, 0, long, 1, __Pyx_PyInt_From_long, 1, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1108, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_4 = PyObject_Length(__pyx_t_3); if (unlikely(__pyx_t_4 == -1)) __PYX_ERR(0, 1108, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_10 = PyObject_Length(__pyx_v_dotdata_qual_check); if (unlikely(__pyx_t_10 == -1)) __PYX_ERR(0, 1108, __pyx_L1_error)
  if (unlikely(((double)__pyx_t_10) == 0)) {
    PyErr_SetString(PyExc_ZeroDivisionError, "float division");
    __PYX_ERR(0, 1108, __pyx_L1_error)
  }
  __pyx_t_9 = (((((double)__pyx_t_4) / ((double)__pyx_t_10)) > 0.1) != 0);
  if (__pyx_t_9) {
  } else {
    __pyx_t_7 = __pyx_t_9;
    goto __pyx_L8_bool_binop_done;
  }
  __pyx_t_3 = __Pyx_GetItemInt_List(__pyx_v_other, 0, long, 1, __Pyx_PyInt_From_long, 1, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1108, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_10 = PyObject_Length(__pyx_t_3); if (unlikely(__pyx_t_10 == -1)) __PYX_ERR(0, 1108, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_4 = PyObject_Length(__pyx_v_dotdata_qual_check); if (unlikely(__pyx_t_4 == -1)) __PYX_ERR(0, 1108, __pyx_L1_error)
  if (unlikely(((double)__pyx_t_4) == 0)) {
    PyErr_SetString(PyExc_ZeroDivisionError, "float division");
    __PYX_ERR(0, 1108, __pyx_L1_error)
  }
  __pyx_t_9 = (((((double)__pyx_t_10) / ((double)__pyx_t_4)) < 0.5) != 0);
  __pyx_t_7 = __pyx_t_9;
  __pyx_L8_bool_binop_done:;
  if (__pyx_t_7) {

    /* "vapor_vali/Simple_function.pyx":1109
 *                 other[1].append(x[1])
 *     if len(dotdata_qual_check)>0 and float(len(other[0]))/float(len(dotdata_qual_check))>0.1 and float(len(other[0]))/float(len(dotdata_qual_check))<0.5:
 *         other_cluster=X_means_cluster_reformat(other)             # <<<<<<<<<<<<<<
 *         range_cluster=cluster_range_decide(other_cluster)
 *         size_cluster=cluster_size_decide(range_cluster)
 */
    __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_X_means_cluster_reformat); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1109, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_1 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_2))) {
      __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_2);
      if (likely(__pyx_t_1)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
        __Pyx_INCREF(__pyx_t_1);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_2, function);
      }
    }
    if (!__pyx_t_1) {
      __pyx_t_3 = __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_v_other); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1109, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
    } else {
      __pyx_t_6 = PyTuple_New(1+1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1109, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_6);
      __Pyx_GIVEREF(__pyx_t_1); PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_1); __pyx_t_1 = NULL;
      __Pyx_INCREF(__pyx_v_other);
      __Pyx_GIVEREF(__pyx_v_other);
      PyTuple_SET_ITEM(__pyx_t_6, 0+1, __pyx_v_other);
      __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_6, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1109, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    }
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_v_other_cluster = __pyx_t_3;
    __pyx_t_3 = 0;

    /* "vapor_vali/Simple_function.pyx":1110
 *     if len(dotdata_qual_check)>0 and float(len(other[0]))/float(len(dotdata_qual_check))>0.1 and float(len(other[0]))/float(len(dotdata_qual_check))<0.5:
 *         other_cluster=X_means_cluster_reformat(other)
 *         range_cluster=cluster_range_decide(other_cluster)             # <<<<<<<<<<<<<<
 *         size_cluster=cluster_size_decide(range_cluster)
 *     else:
 */
    __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_cluster_range_decide); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1110, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_6 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_2))) {
      __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_2);
      if (likely(__pyx_t_6)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
        __Pyx_INCREF(__pyx_t_6);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_2, function);
      }
    }
    if (!__pyx_t_6) {
      __pyx_t_3 = __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_v_other_cluster); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1110, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
    } else {
      __pyx_t_1 = PyTuple_New(1+1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1110, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_GIVEREF(__pyx_t_6); PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_6); __pyx_t_6 = NULL;
      __Pyx_INCREF(__pyx_v_other_cluster);
      __Pyx_GIVEREF(__pyx_v_other_cluster);
      PyTuple_SET_ITEM(__pyx_t_1, 0+1, __pyx_v_other_cluster);
      __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_1, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1110, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    }
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_v_range_cluster = __pyx_t_3;
    __pyx_t_3 = 0;

    /* "vapor_vali/Simple_function.pyx":1111
 *         other_cluster=X_means_cluster_reformat(other)
 *         range_cluster=cluster_range_decide(other_cluster)
 *         size_cluster=cluster_size_decide(range_cluster)             # <<<<<<<<<<<<<<
 *     else:
 *         size_cluster=[0]
 */
    __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_cluster_size_decide); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1111, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_1 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_2))) {
      __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_2);
      if (likely(__pyx_t_1)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
        __Pyx_INCREF(__pyx_t_1);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_2, function);
      }
    }
    if (!__pyx_t_1) {
      __pyx_t_3 = __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_v_range_cluster); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1111, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
    } else {
      __pyx_t_6 = PyTuple_New(1+1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1111, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_6);
      __Pyx_GIVEREF(__pyx_t_1); PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_1); __pyx_t_1 = NULL;
      __Pyx_INCREF(__pyx_v_range_cluster);
      __Pyx_GIVEREF(__pyx_v_range_cluster);
      PyTuple_SET_ITEM(__pyx_t_6, 0+1, __pyx_v_range_cluster);
      __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_6, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1111, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    }
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_v_size_cluster = __pyx_t_3;
    __pyx_t_3 = 0;

    /* "vapor_vali/Simple_function.pyx":1108
 *                 other[0].append(x[0])
 *                 other[1].append(x[1])
 *     if len(dotdata_qual_check)>0 and float(len(other[0]))/float(len(dotdata_qual_check))>0.1 and float(len(other[0]))/float(len(dotdata_qual_check))<0.5:             # <<<<<<<<<<<<<<
 *         other_cluster=X_means_cluster_reformat(other)
 *         range_cluster=cluster_range_decide(other_cluster)
 */
    goto __pyx_L7;
  }

  /* "vapor_vali/Simple_function.pyx":1113
 *         size_cluster=cluster_size_decide(range_cluster)
 *     else:
 *         size_cluster=[0]             # <<<<<<<<<<<<<<
 *     return [float(diagnal)/float(len(dotdata_qual_check)),size_cluster]
 * 
 */
  /*else*/ {
    __pyx_t_3 = PyList_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1113, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_INCREF(__pyx_int_0);
    __Pyx_GIVEREF(__pyx_int_0);
    PyList_SET_ITEM(__pyx_t_3, 0, __pyx_int_0);
    __pyx_v_size_cluster = __pyx_t_3;
    __pyx_t_3 = 0;
  }
  __pyx_L7:;

  /* "vapor_vali/Simple_function.pyx":1114
 *     else:
 *         size_cluster=[0]
 *     return [float(diagnal)/float(len(dotdata_qual_check)),size_cluster]             # <<<<<<<<<<<<<<
 * 
 * def reverse(seq):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_11 = __Pyx_PyObject_AsDouble(__pyx_v_diagnal); if (unlikely(__pyx_t_11 == ((double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1114, __pyx_L1_error)
  __pyx_t_4 = PyObject_Length(__pyx_v_dotdata_qual_check); if (unlikely(__pyx_t_4 == -1)) __PYX_ERR(0, 1114, __pyx_L1_error)
  if (unlikely(((double)__pyx_t_4) == 0)) {
    PyErr_SetString(PyExc_ZeroDivisionError, "float division");
    __PYX_ERR(0, 1114, __pyx_L1_error)
  }
  __pyx_t_3 = PyFloat_FromDouble((__pyx_t_11 / ((double)__pyx_t_4))); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1114, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_2 = PyList_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1114, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_GIVEREF(__pyx_t_3);
  PyList_SET_ITEM(__pyx_t_2, 0, __pyx_t_3);
  __Pyx_INCREF(__pyx_v_size_cluster);
  __Pyx_GIVEREF(__pyx_v_size_cluster);
  PyList_SET_ITEM(__pyx_t_2, 1, __pyx_v_size_cluster);
  __pyx_t_3 = 0;
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  /* "vapor_vali/Simple_function.pyx":1097
 *     return out
 * 
 * def qual_check_repetitive_region(dotdata_qual_check):             # <<<<<<<<<<<<<<
 *     #qual_check_R_2(dotdata_qual_check,txt_file)  #not necessary for validator
 *     diagnal=0
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_AddTraceback("vapor_vali.Simple_function.qual_check_repetitive_region", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_diagnal);
  __Pyx_XDECREF(__pyx_v_other);
  __Pyx_XDECREF(__pyx_v_x);
  __Pyx_XDECREF(__pyx_v_other_cluster);
  __Pyx_XDECREF(__pyx_v_range_cluster);
  __Pyx_XDECREF(__pyx_v_size_cluster);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "vapor_vali/Simple_function.pyx":1116
 *     return [float(diagnal)/float(len(dotdata_qual_check)),size_cluster]
 * 
 * def reverse(seq):             # <<<<<<<<<<<<<<
 *     return seq[::-1]
 * 
 */

/* Python wrapper */
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_153reverse(PyObject *__pyx_self, PyObject *__pyx_v_seq); /*proto*/
static PyMethodDef __pyx_mdef_10vapor_vali_15Simple_function_153reverse = {"reverse", (PyCFunction)__pyx_pw_10vapor_vali_15Simple_function_153reverse, METH_O, 0};
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_153reverse(PyObject *__pyx_self, PyObject *__pyx_v_seq) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("reverse (wrapper)", 0);
  __pyx_r = __pyx_pf_10vapor_vali_15Simple_function_152reverse(__pyx_self, ((PyObject *)__pyx_v_seq));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10vapor_vali_15Simple_function_152reverse(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_seq) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  __Pyx_RefNannySetupContext("reverse", 0);

  /* "vapor_vali/Simple_function.pyx":1117
 * 
 * def reverse(seq):
 *     return seq[::-1]             # <<<<<<<<<<<<<<
 * 
 * def ref_ref_deviate_lines_calcu(list_dotdata):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = PyObject_GetItem(__pyx_v_seq, __pyx_slice__85); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1117, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* "vapor_vali/Simple_function.pyx":1116
 *     return [float(diagnal)/float(len(dotdata_qual_check)),size_cluster]
 * 
 * def reverse(seq):             # <<<<<<<<<<<<<<
 *     return seq[::-1]
 * 
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("vapor_vali.Simple_function.reverse", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "vapor_vali/Simple_function.pyx":1119
 *     return seq[::-1]
 * 
 * def ref_ref_deviate_lines_calcu(list_dotdata):             # <<<<<<<<<<<<<<
 *     ref_kept_deviate=[i for i in list_dotdata if eu_dis_single_dot(i) > 0 and i[1]>i[0]]
 *     ref_left_wings=dot_to_line(ref_kept_deviate)
 */

/* Python wrapper */
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_155ref_ref_deviate_lines_calcu(PyObject *__pyx_self, PyObject *__pyx_v_list_dotdata); /*proto*/
static PyMethodDef __pyx_mdef_10vapor_vali_15Simple_function_155ref_ref_deviate_lines_calcu = {"ref_ref_deviate_lines_calcu", (PyCFunction)__pyx_pw_10vapor_vali_15Simple_function_155ref_ref_deviate_lines_calcu, METH_O, 0};
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_155ref_ref_deviate_lines_calcu(PyObject *__pyx_self, PyObject *__pyx_v_list_dotdata) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("ref_ref_deviate_lines_calcu (wrapper)", 0);
  __pyx_r = __pyx_pf_10vapor_vali_15Simple_function_154ref_ref_deviate_lines_calcu(__pyx_self, ((PyObject *)__pyx_v_list_dotdata));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10vapor_vali_15Simple_function_154ref_ref_deviate_lines_calcu(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_list_dotdata) {
  PyObject *__pyx_v_ref_kept_deviate = NULL;
  PyObject *__pyx_v_ref_left_wings = NULL;
  PyObject *__pyx_v_ref_left_new = NULL;
  PyObject *__pyx_v_x = NULL;
  PyObject *__pyx_v_out = NULL;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  Py_ssize_t __pyx_t_3;
  PyObject *(*__pyx_t_4)(PyObject *);
  PyObject *__pyx_t_5 = NULL;
  int __pyx_t_6;
  PyObject *__pyx_t_7 = NULL;
  PyObject *__pyx_t_8 = NULL;
  PyObject *__pyx_t_9 = NULL;
  int __pyx_t_10;
  int __pyx_t_11;
  Py_ssize_t __pyx_t_12;
  PyObject *(*__pyx_t_13)(PyObject *);
  __Pyx_RefNannySetupContext("ref_ref_deviate_lines_calcu", 0);

  /* "vapor_vali/Simple_function.pyx":1120
 * 
 * def ref_ref_deviate_lines_calcu(list_dotdata):
 *     ref_kept_deviate=[i for i in list_dotdata if eu_dis_single_dot(i) > 0 and i[1]>i[0]]             # <<<<<<<<<<<<<<
 *     ref_left_wings=dot_to_line(ref_kept_deviate)
 *     ref_left_new=[]
 */
  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1120, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  if (likely(PyList_CheckExact(__pyx_v_list_dotdata)) || PyTuple_CheckExact(__pyx_v_list_dotdata)) {
    __pyx_t_2 = __pyx_v_list_dotdata; __Pyx_INCREF(__pyx_t_2); __pyx_t_3 = 0;
    __pyx_t_4 = NULL;
  } else {
    __pyx_t_3 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_v_list_dotdata); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1120, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_4 = Py_TYPE(__pyx_t_2)->tp_iternext; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1120, __pyx_L1_error)
  }
  for (;;) {
    if (likely(!__pyx_t_4)) {
      if (likely(PyList_CheckExact(__pyx_t_2))) {
        if (__pyx_t_3 >= PyList_GET_SIZE(__pyx_t_2)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_5 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_3); __Pyx_INCREF(__pyx_t_5); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 1120, __pyx_L1_error)
        #else
        __pyx_t_5 = PySequence_ITEM(__pyx_t_2, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1120, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_5);
        #endif
      } else {
        if (__pyx_t_3 >= PyTuple_GET_SIZE(__pyx_t_2)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_5 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_3); __Pyx_INCREF(__pyx_t_5); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 1120, __pyx_L1_error)
        #else
        __pyx_t_5 = PySequence_ITEM(__pyx_t_2, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1120, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_5);
        #endif
      }
    } else {
      __pyx_t_5 = __pyx_t_4(__pyx_t_2);
      if (unlikely(!__pyx_t_5)) {
        PyObject* exc_type = PyErr_Occurred();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
          else __PYX_ERR(0, 1120, __pyx_L1_error)
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_5);
    }
    __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_5);
    __pyx_t_5 = 0;
    __pyx_t_7 = __Pyx_GetModuleGlobalName(__pyx_n_s_eu_dis_single_dot); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1120, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    __pyx_t_8 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_7))) {
      __pyx_t_8 = PyMethod_GET_SELF(__pyx_t_7);
      if (likely(__pyx_t_8)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_7);
        __Pyx_INCREF(__pyx_t_8);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_7, function);
      }
    }
    if (!__pyx_t_8) {
      __pyx_t_5 = __Pyx_PyObject_CallOneArg(__pyx_t_7, __pyx_v_i); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1120, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_5);
    } else {
      __pyx_t_9 = PyTuple_New(1+1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1120, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_9);
      __Pyx_GIVEREF(__pyx_t_8); PyTuple_SET_ITEM(__pyx_t_9, 0, __pyx_t_8); __pyx_t_8 = NULL;
      __Pyx_INCREF(__pyx_v_i);
      __Pyx_GIVEREF(__pyx_v_i);
      PyTuple_SET_ITEM(__pyx_t_9, 0+1, __pyx_v_i);
      __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_7, __pyx_t_9, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1120, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_5);
      __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
    }
    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_t_7 = PyObject_RichCompare(__pyx_t_5, __pyx_int_0, Py_GT); __Pyx_XGOTREF(__pyx_t_7); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1120, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_10 = __Pyx_PyObject_IsTrue(__pyx_t_7); if (unlikely(__pyx_t_10 < 0)) __PYX_ERR(0, 1120, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
    if (__pyx_t_10) {
    } else {
      __pyx_t_6 = __pyx_t_10;
      goto __pyx_L6_bool_binop_done;
    }
    __pyx_t_7 = __Pyx_GetItemInt(__pyx_v_i, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1120, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    __pyx_t_5 = __Pyx_GetItemInt(__pyx_v_i, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1120, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __pyx_t_9 = PyObject_RichCompare(__pyx_t_7, __pyx_t_5, Py_GT); __Pyx_XGOTREF(__pyx_t_9); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1120, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_10 = __Pyx_PyObject_IsTrue(__pyx_t_9); if (unlikely(__pyx_t_10 < 0)) __PYX_ERR(0, 1120, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_t_6 = __pyx_t_10;
    __pyx_L6_bool_binop_done:;
    if (__pyx_t_6) {
      if (unlikely(__Pyx_ListComp_Append(__pyx_t_1, (PyObject*)__pyx_v_i))) __PYX_ERR(0, 1120, __pyx_L1_error)
    }
  }
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_ref_kept_deviate = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":1121
 * def ref_ref_deviate_lines_calcu(list_dotdata):
 *     ref_kept_deviate=[i for i in list_dotdata if eu_dis_single_dot(i) > 0 and i[1]>i[0]]
 *     ref_left_wings=dot_to_line(ref_kept_deviate)             # <<<<<<<<<<<<<<
 *     ref_left_new=[]
 *     for x in ref_left_wings:
 */
  __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_dot_to_line); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1121, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_9 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_9 = PyMethod_GET_SELF(__pyx_t_2);
    if (likely(__pyx_t_9)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_9);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_2, function);
    }
  }
  if (!__pyx_t_9) {
    __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_v_ref_kept_deviate); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1121, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
  } else {
    __pyx_t_5 = PyTuple_New(1+1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1121, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_GIVEREF(__pyx_t_9); PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_9); __pyx_t_9 = NULL;
    __Pyx_INCREF(__pyx_v_ref_kept_deviate);
    __Pyx_GIVEREF(__pyx_v_ref_kept_deviate);
    PyTuple_SET_ITEM(__pyx_t_5, 0+1, __pyx_v_ref_kept_deviate);
    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_5, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1121, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  }
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_ref_left_wings = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":1122
 *     ref_kept_deviate=[i for i in list_dotdata if eu_dis_single_dot(i) > 0 and i[1]>i[0]]
 *     ref_left_wings=dot_to_line(ref_kept_deviate)
 *     ref_left_new=[]             # <<<<<<<<<<<<<<
 *     for x in ref_left_wings:
 *         ref_left_new.append(x)
 */
  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1122, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_ref_left_new = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":1123
 *     ref_left_wings=dot_to_line(ref_kept_deviate)
 *     ref_left_new=[]
 *     for x in ref_left_wings:             # <<<<<<<<<<<<<<
 *         ref_left_new.append(x)
 *         ref_left_new.append([[i[1],i[0]] for i in x])
 */
  if (likely(PyList_CheckExact(__pyx_v_ref_left_wings)) || PyTuple_CheckExact(__pyx_v_ref_left_wings)) {
    __pyx_t_1 = __pyx_v_ref_left_wings; __Pyx_INCREF(__pyx_t_1); __pyx_t_3 = 0;
    __pyx_t_4 = NULL;
  } else {
    __pyx_t_3 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_v_ref_left_wings); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1123, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_4 = Py_TYPE(__pyx_t_1)->tp_iternext; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1123, __pyx_L1_error)
  }
  for (;;) {
    if (likely(!__pyx_t_4)) {
      if (likely(PyList_CheckExact(__pyx_t_1))) {
        if (__pyx_t_3 >= PyList_GET_SIZE(__pyx_t_1)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_2 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_3); __Pyx_INCREF(__pyx_t_2); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 1123, __pyx_L1_error)
        #else
        __pyx_t_2 = PySequence_ITEM(__pyx_t_1, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1123, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
        #endif
      } else {
        if (__pyx_t_3 >= PyTuple_GET_SIZE(__pyx_t_1)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_2 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_3); __Pyx_INCREF(__pyx_t_2); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 1123, __pyx_L1_error)
        #else
        __pyx_t_2 = PySequence_ITEM(__pyx_t_1, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1123, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
        #endif
      }
    } else {
      __pyx_t_2 = __pyx_t_4(__pyx_t_1);
      if (unlikely(!__pyx_t_2)) {
        PyObject* exc_type = PyErr_Occurred();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
          else __PYX_ERR(0, 1123, __pyx_L1_error)
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_2);
    }
    __Pyx_XDECREF_SET(__pyx_v_x, __pyx_t_2);
    __pyx_t_2 = 0;

    /* "vapor_vali/Simple_function.pyx":1124
 *     ref_left_new=[]
 *     for x in ref_left_wings:
 *         ref_left_new.append(x)             # <<<<<<<<<<<<<<
 *         ref_left_new.append([[i[1],i[0]] for i in x])
 *     out=[]
 */
    __pyx_t_11 = __Pyx_PyList_Append(__pyx_v_ref_left_new, __pyx_v_x); if (unlikely(__pyx_t_11 == -1)) __PYX_ERR(0, 1124, __pyx_L1_error)

    /* "vapor_vali/Simple_function.pyx":1125
 *     for x in ref_left_wings:
 *         ref_left_new.append(x)
 *         ref_left_new.append([[i[1],i[0]] for i in x])             # <<<<<<<<<<<<<<
 *     out=[]
 *     for x in ref_left_new:
 */
    __pyx_t_2 = PyList_New(0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1125, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    if (likely(PyList_CheckExact(__pyx_v_x)) || PyTuple_CheckExact(__pyx_v_x)) {
      __pyx_t_5 = __pyx_v_x; __Pyx_INCREF(__pyx_t_5); __pyx_t_12 = 0;
      __pyx_t_13 = NULL;
    } else {
      __pyx_t_12 = -1; __pyx_t_5 = PyObject_GetIter(__pyx_v_x); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1125, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_5);
      __pyx_t_13 = Py_TYPE(__pyx_t_5)->tp_iternext; if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1125, __pyx_L1_error)
    }
    for (;;) {
      if (likely(!__pyx_t_13)) {
        if (likely(PyList_CheckExact(__pyx_t_5))) {
          if (__pyx_t_12 >= PyList_GET_SIZE(__pyx_t_5)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_9 = PyList_GET_ITEM(__pyx_t_5, __pyx_t_12); __Pyx_INCREF(__pyx_t_9); __pyx_t_12++; if (unlikely(0 < 0)) __PYX_ERR(0, 1125, __pyx_L1_error)
          #else
          __pyx_t_9 = PySequence_ITEM(__pyx_t_5, __pyx_t_12); __pyx_t_12++; if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1125, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_9);
          #endif
        } else {
          if (__pyx_t_12 >= PyTuple_GET_SIZE(__pyx_t_5)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_9 = PyTuple_GET_ITEM(__pyx_t_5, __pyx_t_12); __Pyx_INCREF(__pyx_t_9); __pyx_t_12++; if (unlikely(0 < 0)) __PYX_ERR(0, 1125, __pyx_L1_error)
          #else
          __pyx_t_9 = PySequence_ITEM(__pyx_t_5, __pyx_t_12); __pyx_t_12++; if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1125, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_9);
          #endif
        }
      } else {
        __pyx_t_9 = __pyx_t_13(__pyx_t_5);
        if (unlikely(!__pyx_t_9)) {
          PyObject* exc_type = PyErr_Occurred();
          if (exc_type) {
            if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
            else __PYX_ERR(0, 1125, __pyx_L1_error)
          }
          break;
        }
        __Pyx_GOTREF(__pyx_t_9);
      }
      __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_9);
      __pyx_t_9 = 0;
      __pyx_t_9 = __Pyx_GetItemInt(__pyx_v_i, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1125, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_9);
      __pyx_t_7 = __Pyx_GetItemInt(__pyx_v_i, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1125, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_7);
      __pyx_t_8 = PyList_New(2); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1125, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_8);
      __Pyx_GIVEREF(__pyx_t_9);
      PyList_SET_ITEM(__pyx_t_8, 0, __pyx_t_9);
      __Pyx_GIVEREF(__pyx_t_7);
      PyList_SET_ITEM(__pyx_t_8, 1, __pyx_t_7);
      __pyx_t_9 = 0;
      __pyx_t_7 = 0;
      if (unlikely(__Pyx_ListComp_Append(__pyx_t_2, (PyObject*)__pyx_t_8))) __PYX_ERR(0, 1125, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
    }
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_11 = __Pyx_PyList_Append(__pyx_v_ref_left_new, __pyx_t_2); if (unlikely(__pyx_t_11 == -1)) __PYX_ERR(0, 1125, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

    /* "vapor_vali/Simple_function.pyx":1123
 *     ref_left_wings=dot_to_line(ref_kept_deviate)
 *     ref_left_new=[]
 *     for x in ref_left_wings:             # <<<<<<<<<<<<<<
 *         ref_left_new.append(x)
 *         ref_left_new.append([[i[1],i[0]] for i in x])
 */
  }
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":1126
 *         ref_left_new.append(x)
 *         ref_left_new.append([[i[1],i[0]] for i in x])
 *     out=[]             # <<<<<<<<<<<<<<
 *     for x in ref_left_new:
 *         if x[0][0]<x[1][0]: out.append(x)
 */
  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1126, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_out = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":1127
 *         ref_left_new.append([[i[1],i[0]] for i in x])
 *     out=[]
 *     for x in ref_left_new:             # <<<<<<<<<<<<<<
 *         if x[0][0]<x[1][0]: out.append(x)
 *         else:               out.append([x[1],x[0]])
 */
  __pyx_t_1 = __pyx_v_ref_left_new; __Pyx_INCREF(__pyx_t_1); __pyx_t_3 = 0;
  for (;;) {
    if (__pyx_t_3 >= PyList_GET_SIZE(__pyx_t_1)) break;
    #if CYTHON_COMPILING_IN_CPYTHON
    __pyx_t_2 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_3); __Pyx_INCREF(__pyx_t_2); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 1127, __pyx_L1_error)
    #else
    __pyx_t_2 = PySequence_ITEM(__pyx_t_1, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1127, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    #endif
    __Pyx_XDECREF_SET(__pyx_v_x, __pyx_t_2);
    __pyx_t_2 = 0;

    /* "vapor_vali/Simple_function.pyx":1128
 *     out=[]
 *     for x in ref_left_new:
 *         if x[0][0]<x[1][0]: out.append(x)             # <<<<<<<<<<<<<<
 *         else:               out.append([x[1],x[0]])
 *     return [i for i in out if kept_lines_size_filter(i)=='TRUE']
 */
    __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_x, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1128, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_5 = __Pyx_GetItemInt(__pyx_t_2, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1128, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_x, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1128, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_8 = __Pyx_GetItemInt(__pyx_t_2, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1128, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_8);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = PyObject_RichCompare(__pyx_t_5, __pyx_t_8, Py_LT); __Pyx_XGOTREF(__pyx_t_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1128, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
    __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 1128, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    if (__pyx_t_6) {
      __pyx_t_11 = __Pyx_PyList_Append(__pyx_v_out, __pyx_v_x); if (unlikely(__pyx_t_11 == -1)) __PYX_ERR(0, 1128, __pyx_L1_error)
      goto __pyx_L14;
    }

    /* "vapor_vali/Simple_function.pyx":1129
 *     for x in ref_left_new:
 *         if x[0][0]<x[1][0]: out.append(x)
 *         else:               out.append([x[1],x[0]])             # <<<<<<<<<<<<<<
 *     return [i for i in out if kept_lines_size_filter(i)=='TRUE']
 * 
 */
    /*else*/ {
      __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_x, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1129, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __pyx_t_8 = __Pyx_GetItemInt(__pyx_v_x, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1129, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_8);
      __pyx_t_5 = PyList_New(2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1129, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_5);
      __Pyx_GIVEREF(__pyx_t_2);
      PyList_SET_ITEM(__pyx_t_5, 0, __pyx_t_2);
      __Pyx_GIVEREF(__pyx_t_8);
      PyList_SET_ITEM(__pyx_t_5, 1, __pyx_t_8);
      __pyx_t_2 = 0;
      __pyx_t_8 = 0;
      __pyx_t_11 = __Pyx_PyList_Append(__pyx_v_out, __pyx_t_5); if (unlikely(__pyx_t_11 == -1)) __PYX_ERR(0, 1129, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    }
    __pyx_L14:;

    /* "vapor_vali/Simple_function.pyx":1127
 *         ref_left_new.append([[i[1],i[0]] for i in x])
 *     out=[]
 *     for x in ref_left_new:             # <<<<<<<<<<<<<<
 *         if x[0][0]<x[1][0]: out.append(x)
 *         else:               out.append([x[1],x[0]])
 */
  }
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":1130
 *         if x[0][0]<x[1][0]: out.append(x)
 *         else:               out.append([x[1],x[0]])
 *     return [i for i in out if kept_lines_size_filter(i)=='TRUE']             # <<<<<<<<<<<<<<
 * 
 * def ref_ref_deviate_lines_describe(list_dotdata):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1130, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_5 = __pyx_v_out; __Pyx_INCREF(__pyx_t_5); __pyx_t_3 = 0;
  for (;;) {
    if (__pyx_t_3 >= PyList_GET_SIZE(__pyx_t_5)) break;
    #if CYTHON_COMPILING_IN_CPYTHON
    __pyx_t_8 = PyList_GET_ITEM(__pyx_t_5, __pyx_t_3); __Pyx_INCREF(__pyx_t_8); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 1130, __pyx_L1_error)
    #else
    __pyx_t_8 = PySequence_ITEM(__pyx_t_5, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1130, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_8);
    #endif
    __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_8);
    __pyx_t_8 = 0;
    __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_kept_lines_size_filter); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1130, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_7 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_2))) {
      __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_2);
      if (likely(__pyx_t_7)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
        __Pyx_INCREF(__pyx_t_7);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_2, function);
      }
    }
    if (!__pyx_t_7) {
      __pyx_t_8 = __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_v_i); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1130, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_8);
    } else {
      __pyx_t_9 = PyTuple_New(1+1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1130, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_9);
      __Pyx_GIVEREF(__pyx_t_7); PyTuple_SET_ITEM(__pyx_t_9, 0, __pyx_t_7); __pyx_t_7 = NULL;
      __Pyx_INCREF(__pyx_v_i);
      __Pyx_GIVEREF(__pyx_v_i);
      PyTuple_SET_ITEM(__pyx_t_9, 0+1, __pyx_v_i);
      __pyx_t_8 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_9, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1130, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_8);
      __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
    }
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_6 = (__Pyx_PyString_Equals(__pyx_t_8, __pyx_n_s_TRUE, Py_EQ)); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 1130, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
    if (__pyx_t_6) {
      if (unlikely(__Pyx_ListComp_Append(__pyx_t_1, (PyObject*)__pyx_v_i))) __PYX_ERR(0, 1130, __pyx_L1_error)
    }
  }
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* "vapor_vali/Simple_function.pyx":1119
 *     return seq[::-1]
 * 
 * def ref_ref_deviate_lines_calcu(list_dotdata):             # <<<<<<<<<<<<<<
 *     ref_kept_deviate=[i for i in list_dotdata if eu_dis_single_dot(i) > 0 and i[1]>i[0]]
 *     ref_left_wings=dot_to_line(ref_kept_deviate)
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_7);
  __Pyx_XDECREF(__pyx_t_8);
  __Pyx_XDECREF(__pyx_t_9);
  __Pyx_AddTraceback("vapor_vali.Simple_function.ref_ref_deviate_lines_calcu", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_ref_kept_deviate);
  __Pyx_XDECREF(__pyx_v_ref_left_wings);
  __Pyx_XDECREF(__pyx_v_ref_left_new);
  __Pyx_XDECREF(__pyx_v_x);
  __Pyx_XDECREF(__pyx_v_out);
  __Pyx_XDECREF(__pyx_v_i);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "vapor_vali/Simple_function.pyx":1132
 *     return [i for i in out if kept_lines_size_filter(i)=='TRUE']
 * 
 * def ref_ref_deviate_lines_describe(list_dotdata):             # <<<<<<<<<<<<<<
 *     ref_ref_lines=ref_ref_deviate_lines_calcu(list_dotdata)
 *     out=[]
 */

/* Python wrapper */
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_157ref_ref_deviate_lines_describe(PyObject *__pyx_self, PyObject *__pyx_v_list_dotdata); /*proto*/
static PyMethodDef __pyx_mdef_10vapor_vali_15Simple_function_157ref_ref_deviate_lines_describe = {"ref_ref_deviate_lines_describe", (PyCFunction)__pyx_pw_10vapor_vali_15Simple_function_157ref_ref_deviate_lines_describe, METH_O, 0};
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_157ref_ref_deviate_lines_describe(PyObject *__pyx_self, PyObject *__pyx_v_list_dotdata) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("ref_ref_deviate_lines_describe (wrapper)", 0);
  __pyx_r = __pyx_pf_10vapor_vali_15Simple_function_156ref_ref_deviate_lines_describe(__pyx_self, ((PyObject *)__pyx_v_list_dotdata));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10vapor_vali_15Simple_function_156ref_ref_deviate_lines_describe(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_list_dotdata) {
  PyObject *__pyx_v_ref_ref_lines = NULL;
  PyObject *__pyx_v_out = NULL;
  PyObject *__pyx_v_line = NULL;
  PyObject *__pyx_v_ratio = NULL;
  PyObject *__pyx_v_intercept = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  Py_ssize_t __pyx_t_5;
  PyObject *(*__pyx_t_6)(PyObject *);
  double __pyx_t_7;
  double __pyx_t_8;
  PyObject *__pyx_t_9 = NULL;
  PyObject *__pyx_t_10 = NULL;
  PyObject *__pyx_t_11 = NULL;
  int __pyx_t_12;
  __Pyx_RefNannySetupContext("ref_ref_deviate_lines_describe", 0);

  /* "vapor_vali/Simple_function.pyx":1133
 * 
 * def ref_ref_deviate_lines_describe(list_dotdata):
 *     ref_ref_lines=ref_ref_deviate_lines_calcu(list_dotdata)             # <<<<<<<<<<<<<<
 *     out=[]
 *     for line in ref_ref_lines:
 */
  __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_ref_ref_deviate_lines_calcu); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1133, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_3);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_2, function);
    }
  }
  if (!__pyx_t_3) {
    __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_v_list_dotdata); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1133, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
  } else {
    __pyx_t_4 = PyTuple_New(1+1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1133, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_GIVEREF(__pyx_t_3); PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3); __pyx_t_3 = NULL;
    __Pyx_INCREF(__pyx_v_list_dotdata);
    __Pyx_GIVEREF(__pyx_v_list_dotdata);
    PyTuple_SET_ITEM(__pyx_t_4, 0+1, __pyx_v_list_dotdata);
    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_4, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1133, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  }
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_ref_ref_lines = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":1134
 * def ref_ref_deviate_lines_describe(list_dotdata):
 *     ref_ref_lines=ref_ref_deviate_lines_calcu(list_dotdata)
 *     out=[]             # <<<<<<<<<<<<<<
 *     for line in ref_ref_lines:
 *         ratio=round(float(line[1][1]-line[0][1])/float(line[1][0]-line[0][0]),0)
 */
  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1134, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_out = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":1135
 *     ref_ref_lines=ref_ref_deviate_lines_calcu(list_dotdata)
 *     out=[]
 *     for line in ref_ref_lines:             # <<<<<<<<<<<<<<
 *         ratio=round(float(line[1][1]-line[0][1])/float(line[1][0]-line[0][0]),0)
 *         intercept=round(np.mean([line[1][1]-line[1][0],line[0][1]-line[0][0]]),0)
 */
  if (likely(PyList_CheckExact(__pyx_v_ref_ref_lines)) || PyTuple_CheckExact(__pyx_v_ref_ref_lines)) {
    __pyx_t_1 = __pyx_v_ref_ref_lines; __Pyx_INCREF(__pyx_t_1); __pyx_t_5 = 0;
    __pyx_t_6 = NULL;
  } else {
    __pyx_t_5 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_v_ref_ref_lines); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1135, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_6 = Py_TYPE(__pyx_t_1)->tp_iternext; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1135, __pyx_L1_error)
  }
  for (;;) {
    if (likely(!__pyx_t_6)) {
      if (likely(PyList_CheckExact(__pyx_t_1))) {
        if (__pyx_t_5 >= PyList_GET_SIZE(__pyx_t_1)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_2 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_5); __Pyx_INCREF(__pyx_t_2); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 1135, __pyx_L1_error)
        #else
        __pyx_t_2 = PySequence_ITEM(__pyx_t_1, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1135, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
        #endif
      } else {
        if (__pyx_t_5 >= PyTuple_GET_SIZE(__pyx_t_1)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_2 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_5); __Pyx_INCREF(__pyx_t_2); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 1135, __pyx_L1_error)
        #else
        __pyx_t_2 = PySequence_ITEM(__pyx_t_1, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1135, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
        #endif
      }
    } else {
      __pyx_t_2 = __pyx_t_6(__pyx_t_1);
      if (unlikely(!__pyx_t_2)) {
        PyObject* exc_type = PyErr_Occurred();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
          else __PYX_ERR(0, 1135, __pyx_L1_error)
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_2);
    }
    __Pyx_XDECREF_SET(__pyx_v_line, __pyx_t_2);
    __pyx_t_2 = 0;

    /* "vapor_vali/Simple_function.pyx":1136
 *     out=[]
 *     for line in ref_ref_lines:
 *         ratio=round(float(line[1][1]-line[0][1])/float(line[1][0]-line[0][0]),0)             # <<<<<<<<<<<<<<
 *         intercept=round(np.mean([line[1][1]-line[1][0],line[0][1]-line[0][0]]),0)
 *         out.append([ratio,intercept,line[0][0],line[1][0]])
 */
    __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_line, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1136, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_4 = __Pyx_GetItemInt(__pyx_t_2, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1136, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_line, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1136, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_3 = __Pyx_GetItemInt(__pyx_t_2, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1136, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = PyNumber_Subtract(__pyx_t_4, __pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1136, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_7 = __Pyx_PyObject_AsDouble(__pyx_t_2); if (unlikely(__pyx_t_7 == ((double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1136, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_line, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1136, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_3 = __Pyx_GetItemInt(__pyx_t_2, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1136, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_line, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1136, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_4 = __Pyx_GetItemInt(__pyx_t_2, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1136, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = PyNumber_Subtract(__pyx_t_3, __pyx_t_4); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1136, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_8 = __Pyx_PyObject_AsDouble(__pyx_t_2); if (unlikely(__pyx_t_8 == ((double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1136, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    if (unlikely(__pyx_t_8 == 0)) {
      PyErr_SetString(PyExc_ZeroDivisionError, "float division");
      __PYX_ERR(0, 1136, __pyx_L1_error)
    }
    __pyx_t_2 = PyFloat_FromDouble((__pyx_t_7 / __pyx_t_8)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1136, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1136, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_GIVEREF(__pyx_t_2);
    PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_2);
    __Pyx_INCREF(__pyx_int_0);
    __Pyx_GIVEREF(__pyx_int_0);
    PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_int_0);
    __pyx_t_2 = 0;
    __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_round, __pyx_t_4, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1136, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __Pyx_XDECREF_SET(__pyx_v_ratio, __pyx_t_2);
    __pyx_t_2 = 0;

    /* "vapor_vali/Simple_function.pyx":1137
 *     for line in ref_ref_lines:
 *         ratio=round(float(line[1][1]-line[0][1])/float(line[1][0]-line[0][0]),0)
 *         intercept=round(np.mean([line[1][1]-line[1][0],line[0][1]-line[0][0]]),0)             # <<<<<<<<<<<<<<
 *         out.append([ratio,intercept,line[0][0],line[1][0]])
 *     return out
 */
    __pyx_t_4 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1137, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_mean); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1137, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = __Pyx_GetItemInt(__pyx_v_line, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1137, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_9 = __Pyx_GetItemInt(__pyx_t_4, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1137, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_9);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = __Pyx_GetItemInt(__pyx_v_line, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1137, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_10 = __Pyx_GetItemInt(__pyx_t_4, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1137, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_10);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = PyNumber_Subtract(__pyx_t_9, __pyx_t_10); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1137, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
    __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
    __pyx_t_10 = __Pyx_GetItemInt(__pyx_v_line, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1137, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_10);
    __pyx_t_9 = __Pyx_GetItemInt(__pyx_t_10, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1137, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_9);
    __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
    __pyx_t_10 = __Pyx_GetItemInt(__pyx_v_line, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1137, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_10);
    __pyx_t_11 = __Pyx_GetItemInt(__pyx_t_10, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1137, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_11);
    __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
    __pyx_t_10 = PyNumber_Subtract(__pyx_t_9, __pyx_t_11); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1137, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_10);
    __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
    __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
    __pyx_t_11 = PyList_New(2); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1137, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_11);
    __Pyx_GIVEREF(__pyx_t_4);
    PyList_SET_ITEM(__pyx_t_11, 0, __pyx_t_4);
    __Pyx_GIVEREF(__pyx_t_10);
    PyList_SET_ITEM(__pyx_t_11, 1, __pyx_t_10);
    __pyx_t_4 = 0;
    __pyx_t_10 = 0;
    __pyx_t_10 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_3))) {
      __pyx_t_10 = PyMethod_GET_SELF(__pyx_t_3);
      if (likely(__pyx_t_10)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
        __Pyx_INCREF(__pyx_t_10);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_3, function);
      }
    }
    if (!__pyx_t_10) {
      __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_11); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1137, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
      __Pyx_GOTREF(__pyx_t_2);
    } else {
      __pyx_t_4 = PyTuple_New(1+1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1137, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      __Pyx_GIVEREF(__pyx_t_10); PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_10); __pyx_t_10 = NULL;
      __Pyx_GIVEREF(__pyx_t_11);
      PyTuple_SET_ITEM(__pyx_t_4, 0+1, __pyx_t_11);
      __pyx_t_11 = 0;
      __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_4, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1137, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    }
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1137, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_GIVEREF(__pyx_t_2);
    PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_2);
    __Pyx_INCREF(__pyx_int_0);
    __Pyx_GIVEREF(__pyx_int_0);
    PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_int_0);
    __pyx_t_2 = 0;
    __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_round, __pyx_t_3, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1137, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __Pyx_XDECREF_SET(__pyx_v_intercept, __pyx_t_2);
    __pyx_t_2 = 0;

    /* "vapor_vali/Simple_function.pyx":1138
 *         ratio=round(float(line[1][1]-line[0][1])/float(line[1][0]-line[0][0]),0)
 *         intercept=round(np.mean([line[1][1]-line[1][0],line[0][1]-line[0][0]]),0)
 *         out.append([ratio,intercept,line[0][0],line[1][0]])             # <<<<<<<<<<<<<<
 *     return out
 * 
 */
    __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_line, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1138, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_3 = __Pyx_GetItemInt(__pyx_t_2, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1138, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_line, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1138, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_4 = __Pyx_GetItemInt(__pyx_t_2, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1138, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = PyList_New(4); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1138, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_INCREF(__pyx_v_ratio);
    __Pyx_GIVEREF(__pyx_v_ratio);
    PyList_SET_ITEM(__pyx_t_2, 0, __pyx_v_ratio);
    __Pyx_INCREF(__pyx_v_intercept);
    __Pyx_GIVEREF(__pyx_v_intercept);
    PyList_SET_ITEM(__pyx_t_2, 1, __pyx_v_intercept);
    __Pyx_GIVEREF(__pyx_t_3);
    PyList_SET_ITEM(__pyx_t_2, 2, __pyx_t_3);
    __Pyx_GIVEREF(__pyx_t_4);
    PyList_SET_ITEM(__pyx_t_2, 3, __pyx_t_4);
    __pyx_t_3 = 0;
    __pyx_t_4 = 0;
    __pyx_t_12 = __Pyx_PyList_Append(__pyx_v_out, __pyx_t_2); if (unlikely(__pyx_t_12 == -1)) __PYX_ERR(0, 1138, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

    /* "vapor_vali/Simple_function.pyx":1135
 *     ref_ref_lines=ref_ref_deviate_lines_calcu(list_dotdata)
 *     out=[]
 *     for line in ref_ref_lines:             # <<<<<<<<<<<<<<
 *         ratio=round(float(line[1][1]-line[0][1])/float(line[1][0]-line[0][0]),0)
 *         intercept=round(np.mean([line[1][1]-line[1][0],line[0][1]-line[0][0]]),0)
 */
  }
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":1139
 *         intercept=round(np.mean([line[1][1]-line[1][0],line[0][1]-line[0][0]]),0)
 *         out.append([ratio,intercept,line[0][0],line[1][0]])
 *     return out             # <<<<<<<<<<<<<<
 * 
 * def ref_deviate_lines_calcu(list_dotdata):
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_out);
  __pyx_r = __pyx_v_out;
  goto __pyx_L0;

  /* "vapor_vali/Simple_function.pyx":1132
 *     return [i for i in out if kept_lines_size_filter(i)=='TRUE']
 * 
 * def ref_ref_deviate_lines_describe(list_dotdata):             # <<<<<<<<<<<<<<
 *     ref_ref_lines=ref_ref_deviate_lines_calcu(list_dotdata)
 *     out=[]
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_9);
  __Pyx_XDECREF(__pyx_t_10);
  __Pyx_XDECREF(__pyx_t_11);
  __Pyx_AddTraceback("vapor_vali.Simple_function.ref_ref_deviate_lines_describe", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_ref_ref_lines);
  __Pyx_XDECREF(__pyx_v_out);
  __Pyx_XDECREF(__pyx_v_line);
  __Pyx_XDECREF(__pyx_v_ratio);
  __Pyx_XDECREF(__pyx_v_intercept);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "vapor_vali/Simple_function.pyx":1141
 *     return out
 * 
 * def ref_deviate_lines_calcu(list_dotdata):             # <<<<<<<<<<<<<<
 *     ref_kept_deviate=[i for i in list_dotdata if eu_dis_single_dot(i) > 0.15]
 *     ref_left_wings=dot_to_line(ref_kept_deviate)
 */

/* Python wrapper */
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_159ref_deviate_lines_calcu(PyObject *__pyx_self, PyObject *__pyx_v_list_dotdata); /*proto*/
static PyMethodDef __pyx_mdef_10vapor_vali_15Simple_function_159ref_deviate_lines_calcu = {"ref_deviate_lines_calcu", (PyCFunction)__pyx_pw_10vapor_vali_15Simple_function_159ref_deviate_lines_calcu, METH_O, 0};
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_159ref_deviate_lines_calcu(PyObject *__pyx_self, PyObject *__pyx_v_list_dotdata) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("ref_deviate_lines_calcu (wrapper)", 0);
  __pyx_r = __pyx_pf_10vapor_vali_15Simple_function_158ref_deviate_lines_calcu(__pyx_self, ((PyObject *)__pyx_v_list_dotdata));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10vapor_vali_15Simple_function_158ref_deviate_lines_calcu(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_list_dotdata) {
  PyObject *__pyx_v_ref_kept_deviate = NULL;
  PyObject *__pyx_v_ref_left_wings = NULL;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  Py_ssize_t __pyx_t_3;
  PyObject *(*__pyx_t_4)(PyObject *);
  PyObject *__pyx_t_5 = NULL;
  PyObject *__pyx_t_6 = NULL;
  PyObject *__pyx_t_7 = NULL;
  PyObject *__pyx_t_8 = NULL;
  int __pyx_t_9;
  __Pyx_RefNannySetupContext("ref_deviate_lines_calcu", 0);

  /* "vapor_vali/Simple_function.pyx":1142
 * 
 * def ref_deviate_lines_calcu(list_dotdata):
 *     ref_kept_deviate=[i for i in list_dotdata if eu_dis_single_dot(i) > 0.15]             # <<<<<<<<<<<<<<
 *     ref_left_wings=dot_to_line(ref_kept_deviate)
 *     return    [i for i in ref_left_wings if kept_lines_size_filter(i)=='TRUE']
 */
  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1142, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  if (likely(PyList_CheckExact(__pyx_v_list_dotdata)) || PyTuple_CheckExact(__pyx_v_list_dotdata)) {
    __pyx_t_2 = __pyx_v_list_dotdata; __Pyx_INCREF(__pyx_t_2); __pyx_t_3 = 0;
    __pyx_t_4 = NULL;
  } else {
    __pyx_t_3 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_v_list_dotdata); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1142, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_4 = Py_TYPE(__pyx_t_2)->tp_iternext; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1142, __pyx_L1_error)
  }
  for (;;) {
    if (likely(!__pyx_t_4)) {
      if (likely(PyList_CheckExact(__pyx_t_2))) {
        if (__pyx_t_3 >= PyList_GET_SIZE(__pyx_t_2)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_5 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_3); __Pyx_INCREF(__pyx_t_5); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 1142, __pyx_L1_error)
        #else
        __pyx_t_5 = PySequence_ITEM(__pyx_t_2, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1142, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_5);
        #endif
      } else {
        if (__pyx_t_3 >= PyTuple_GET_SIZE(__pyx_t_2)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_5 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_3); __Pyx_INCREF(__pyx_t_5); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 1142, __pyx_L1_error)
        #else
        __pyx_t_5 = PySequence_ITEM(__pyx_t_2, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1142, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_5);
        #endif
      }
    } else {
      __pyx_t_5 = __pyx_t_4(__pyx_t_2);
      if (unlikely(!__pyx_t_5)) {
        PyObject* exc_type = PyErr_Occurred();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
          else __PYX_ERR(0, 1142, __pyx_L1_error)
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_5);
    }
    __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_5);
    __pyx_t_5 = 0;
    __pyx_t_6 = __Pyx_GetModuleGlobalName(__pyx_n_s_eu_dis_single_dot); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1142, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __pyx_t_7 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_6))) {
      __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_6);
      if (likely(__pyx_t_7)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
        __Pyx_INCREF(__pyx_t_7);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_6, function);
      }
    }
    if (!__pyx_t_7) {
      __pyx_t_5 = __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_v_i); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1142, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_5);
    } else {
      __pyx_t_8 = PyTuple_New(1+1); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1142, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_8);
      __Pyx_GIVEREF(__pyx_t_7); PyTuple_SET_ITEM(__pyx_t_8, 0, __pyx_t_7); __pyx_t_7 = NULL;
      __Pyx_INCREF(__pyx_v_i);
      __Pyx_GIVEREF(__pyx_v_i);
      PyTuple_SET_ITEM(__pyx_t_8, 0+1, __pyx_v_i);
      __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_8, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1142, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_5);
      __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
    }
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = PyObject_RichCompare(__pyx_t_5, __pyx_float_0_15, Py_GT); __Pyx_XGOTREF(__pyx_t_6); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1142, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_9 = __Pyx_PyObject_IsTrue(__pyx_t_6); if (unlikely(__pyx_t_9 < 0)) __PYX_ERR(0, 1142, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    if (__pyx_t_9) {
      if (unlikely(__Pyx_ListComp_Append(__pyx_t_1, (PyObject*)__pyx_v_i))) __PYX_ERR(0, 1142, __pyx_L1_error)
    }
  }
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_ref_kept_deviate = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":1143
 * def ref_deviate_lines_calcu(list_dotdata):
 *     ref_kept_deviate=[i for i in list_dotdata if eu_dis_single_dot(i) > 0.15]
 *     ref_left_wings=dot_to_line(ref_kept_deviate)             # <<<<<<<<<<<<<<
 *     return    [i for i in ref_left_wings if kept_lines_size_filter(i)=='TRUE']
 * 
 */
  __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_dot_to_line); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1143, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_6 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_2);
    if (likely(__pyx_t_6)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_6);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_2, function);
    }
  }
  if (!__pyx_t_6) {
    __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_v_ref_kept_deviate); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1143, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
  } else {
    __pyx_t_5 = PyTuple_New(1+1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1143, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_GIVEREF(__pyx_t_6); PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_6); __pyx_t_6 = NULL;
    __Pyx_INCREF(__pyx_v_ref_kept_deviate);
    __Pyx_GIVEREF(__pyx_v_ref_kept_deviate);
    PyTuple_SET_ITEM(__pyx_t_5, 0+1, __pyx_v_ref_kept_deviate);
    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_5, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1143, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  }
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_ref_left_wings = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":1144
 *     ref_kept_deviate=[i for i in list_dotdata if eu_dis_single_dot(i) > 0.15]
 *     ref_left_wings=dot_to_line(ref_kept_deviate)
 *     return    [i for i in ref_left_wings if kept_lines_size_filter(i)=='TRUE']             # <<<<<<<<<<<<<<
 * 
 * def ref_seq_readin(ref,chrom,start,end,reverse_flag='FALSE'):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1144, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  if (likely(PyList_CheckExact(__pyx_v_ref_left_wings)) || PyTuple_CheckExact(__pyx_v_ref_left_wings)) {
    __pyx_t_2 = __pyx_v_ref_left_wings; __Pyx_INCREF(__pyx_t_2); __pyx_t_3 = 0;
    __pyx_t_4 = NULL;
  } else {
    __pyx_t_3 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_v_ref_left_wings); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1144, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_4 = Py_TYPE(__pyx_t_2)->tp_iternext; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1144, __pyx_L1_error)
  }
  for (;;) {
    if (likely(!__pyx_t_4)) {
      if (likely(PyList_CheckExact(__pyx_t_2))) {
        if (__pyx_t_3 >= PyList_GET_SIZE(__pyx_t_2)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_5 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_3); __Pyx_INCREF(__pyx_t_5); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 1144, __pyx_L1_error)
        #else
        __pyx_t_5 = PySequence_ITEM(__pyx_t_2, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1144, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_5);
        #endif
      } else {
        if (__pyx_t_3 >= PyTuple_GET_SIZE(__pyx_t_2)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_5 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_3); __Pyx_INCREF(__pyx_t_5); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 1144, __pyx_L1_error)
        #else
        __pyx_t_5 = PySequence_ITEM(__pyx_t_2, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1144, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_5);
        #endif
      }
    } else {
      __pyx_t_5 = __pyx_t_4(__pyx_t_2);
      if (unlikely(!__pyx_t_5)) {
        PyObject* exc_type = PyErr_Occurred();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
          else __PYX_ERR(0, 1144, __pyx_L1_error)
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_5);
    }
    __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_5);
    __pyx_t_5 = 0;
    __pyx_t_6 = __Pyx_GetModuleGlobalName(__pyx_n_s_kept_lines_size_filter); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1144, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __pyx_t_8 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_6))) {
      __pyx_t_8 = PyMethod_GET_SELF(__pyx_t_6);
      if (likely(__pyx_t_8)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
        __Pyx_INCREF(__pyx_t_8);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_6, function);
      }
    }
    if (!__pyx_t_8) {
      __pyx_t_5 = __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_v_i); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1144, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_5);
    } else {
      __pyx_t_7 = PyTuple_New(1+1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1144, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_7);
      __Pyx_GIVEREF(__pyx_t_8); PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_8); __pyx_t_8 = NULL;
      __Pyx_INCREF(__pyx_v_i);
      __Pyx_GIVEREF(__pyx_v_i);
      PyTuple_SET_ITEM(__pyx_t_7, 0+1, __pyx_v_i);
      __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_7, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1144, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_5);
      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
    }
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_9 = (__Pyx_PyString_Equals(__pyx_t_5, __pyx_n_s_TRUE, Py_EQ)); if (unlikely(__pyx_t_9 < 0)) __PYX_ERR(0, 1144, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    if (__pyx_t_9) {
      if (unlikely(__Pyx_ListComp_Append(__pyx_t_1, (PyObject*)__pyx_v_i))) __PYX_ERR(0, 1144, __pyx_L1_error)
    }
  }
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* "vapor_vali/Simple_function.pyx":1141
 *     return out
 * 
 * def ref_deviate_lines_calcu(list_dotdata):             # <<<<<<<<<<<<<<
 *     ref_kept_deviate=[i for i in list_dotdata if eu_dis_single_dot(i) > 0.15]
 *     ref_left_wings=dot_to_line(ref_kept_deviate)
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_XDECREF(__pyx_t_7);
  __Pyx_XDECREF(__pyx_t_8);
  __Pyx_AddTraceback("vapor_vali.Simple_function.ref_deviate_lines_calcu", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_ref_kept_deviate);
  __Pyx_XDECREF(__pyx_v_ref_left_wings);
  __Pyx_XDECREF(__pyx_v_i);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "vapor_vali/Simple_function.pyx":1146
 *     return    [i for i in ref_left_wings if kept_lines_size_filter(i)=='TRUE']
 * 
 * def ref_seq_readin(ref,chrom,start,end,reverse_flag='FALSE'):             # <<<<<<<<<<<<<<
 *     #reverse=='TRUE': return rev-comp-seq   ; if not specified, default as 'FALSE'
 *     #else: return original seq
 */

/* Python wrapper */
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_161ref_seq_readin(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_10vapor_vali_15Simple_function_161ref_seq_readin = {"ref_seq_readin", (PyCFunction)__pyx_pw_10vapor_vali_15Simple_function_161ref_seq_readin, METH_VARARGS|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_161ref_seq_readin(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_ref = 0;
  PyObject *__pyx_v_chrom = 0;
  PyObject *__pyx_v_start = 0;
  PyObject *__pyx_v_end = 0;
  PyObject *__pyx_v_reverse_flag = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("ref_seq_readin (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_ref,&__pyx_n_s_chrom,&__pyx_n_s_start,&__pyx_n_s_end,&__pyx_n_s_reverse_flag,0};
    PyObject* values[5] = {0,0,0,0,0};
    values[4] = ((PyObject *)__pyx_n_s_FALSE);
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
      switch (pos_args) {
        case  5: values[4] = PyTuple_GET_ITEM(__pyx_args, 4);
        case  4: values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
        case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_ref)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_chrom)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("ref_seq_readin", 0, 4, 5, 1); __PYX_ERR(0, 1146, __pyx_L3_error)
        }
        case  2:
        if (likely((values[2] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_start)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("ref_seq_readin", 0, 4, 5, 2); __PYX_ERR(0, 1146, __pyx_L3_error)
        }
        case  3:
        if (likely((values[3] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_end)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("ref_seq_readin", 0, 4, 5, 3); __PYX_ERR(0, 1146, __pyx_L3_error)
        }
        case  4:
        if (kw_args > 0) {
          PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_reverse_flag);
          if (value) { values[4] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "ref_seq_readin") < 0)) __PYX_ERR(0, 1146, __pyx_L3_error)
      }
    } else {
      switch (PyTuple_GET_SIZE(__pyx_args)) {
        case  5: values[4] = PyTuple_GET_ITEM(__pyx_args, 4);
        case  4: values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
        values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
        values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_ref = values[0];
    __pyx_v_chrom = values[1];
    __pyx_v_start = values[2];
    __pyx_v_end = values[3];
    __pyx_v_reverse_flag = values[4];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("ref_seq_readin", 0, 4, 5, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1146, __pyx_L3_error)
  __pyx_L3_error:;
  __Pyx_AddTraceback("vapor_vali.Simple_function.ref_seq_readin", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_10vapor_vali_15Simple_function_160ref_seq_readin(__pyx_self, __pyx_v_ref, __pyx_v_chrom, __pyx_v_start, __pyx_v_end, __pyx_v_reverse_flag);

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10vapor_vali_15Simple_function_160ref_seq_readin(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_ref, PyObject *__pyx_v_chrom, PyObject *__pyx_v_start, PyObject *__pyx_v_end, PyObject *__pyx_v_reverse_flag) {
  PyObject *__pyx_v_fref = NULL;
  PyObject *__pyx_v_seq = NULL;
  PyObject *__pyx_v_pref = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  int __pyx_t_6;
  int __pyx_t_7;
  PyObject *__pyx_t_8 = NULL;
  __Pyx_RefNannySetupContext("ref_seq_readin", 0);

  /* "vapor_vali/Simple_function.pyx":1149
 *     #reverse=='TRUE': return rev-comp-seq   ; if not specified, default as 'FALSE'
 *     #else: return original seq
 *     fref=os.popen(r'''samtools faidx %s %s:%d-%d'''%(ref,chrom,int(start),int(end)))             # <<<<<<<<<<<<<<
 *     fref.readline().strip().split()
 *     seq=''
 */
  __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_os); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1149, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_popen); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1149, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = __Pyx_PyNumber_Int(__pyx_v_start); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1149, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_4 = __Pyx_PyNumber_Int(__pyx_v_end); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1149, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_5 = PyTuple_New(4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1149, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_INCREF(__pyx_v_ref);
  __Pyx_GIVEREF(__pyx_v_ref);
  PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_v_ref);
  __Pyx_INCREF(__pyx_v_chrom);
  __Pyx_GIVEREF(__pyx_v_chrom);
  PyTuple_SET_ITEM(__pyx_t_5, 1, __pyx_v_chrom);
  __Pyx_GIVEREF(__pyx_t_2);
  PyTuple_SET_ITEM(__pyx_t_5, 2, __pyx_t_2);
  __Pyx_GIVEREF(__pyx_t_4);
  PyTuple_SET_ITEM(__pyx_t_5, 3, __pyx_t_4);
  __pyx_t_2 = 0;
  __pyx_t_4 = 0;
  __pyx_t_4 = __Pyx_PyString_Format(__pyx_kp_s_samtools_faidx_s_s_d_d, __pyx_t_5); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1149, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_3))) {
    __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_3);
    if (likely(__pyx_t_5)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
      __Pyx_INCREF(__pyx_t_5);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_3, function);
    }
  }
  if (!__pyx_t_5) {
    __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1149, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __Pyx_GOTREF(__pyx_t_1);
  } else {
    __pyx_t_2 = PyTuple_New(1+1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1149, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_GIVEREF(__pyx_t_5); PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_5); __pyx_t_5 = NULL;
    __Pyx_GIVEREF(__pyx_t_4);
    PyTuple_SET_ITEM(__pyx_t_2, 0+1, __pyx_t_4);
    __pyx_t_4 = 0;
    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_2, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1149, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  }
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_fref = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":1150
 *     #else: return original seq
 *     fref=os.popen(r'''samtools faidx %s %s:%d-%d'''%(ref,chrom,int(start),int(end)))
 *     fref.readline().strip().split()             # <<<<<<<<<<<<<<
 *     seq=''
 *     while True:
 */
  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_fref, __pyx_n_s_readline); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1150, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_5 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_4))) {
    __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_4);
    if (likely(__pyx_t_5)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
      __Pyx_INCREF(__pyx_t_5);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_4, function);
    }
  }
  if (__pyx_t_5) {
    __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_5); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1150, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  } else {
    __pyx_t_2 = __Pyx_PyObject_CallNoArg(__pyx_t_4); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1150, __pyx_L1_error)
  }
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_strip); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1150, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_4))) {
    __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_4);
    if (likely(__pyx_t_2)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
      __Pyx_INCREF(__pyx_t_2);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_4, function);
    }
  }
  if (__pyx_t_2) {
    __pyx_t_3 = __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1150, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  } else {
    __pyx_t_3 = __Pyx_PyObject_CallNoArg(__pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1150, __pyx_L1_error)
  }
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_split); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1150, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_4))) {
    __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_4);
    if (likely(__pyx_t_3)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
      __Pyx_INCREF(__pyx_t_3);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_4, function);
    }
  }
  if (__pyx_t_3) {
    __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1150, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  } else {
    __pyx_t_1 = __Pyx_PyObject_CallNoArg(__pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1150, __pyx_L1_error)
  }
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":1151
 *     fref=os.popen(r'''samtools faidx %s %s:%d-%d'''%(ref,chrom,int(start),int(end)))
 *     fref.readline().strip().split()
 *     seq=''             # <<<<<<<<<<<<<<
 *     while True:
 *             pref=fref.readline().strip().split()
 */
  __Pyx_INCREF(__pyx_kp_s__24);
  __pyx_v_seq = __pyx_kp_s__24;

  /* "vapor_vali/Simple_function.pyx":1152
 *     fref.readline().strip().split()
 *     seq=''
 *     while True:             # <<<<<<<<<<<<<<
 *             pref=fref.readline().strip().split()
 *             if not pref: break
 */
  while (1) {

    /* "vapor_vali/Simple_function.pyx":1153
 *     seq=''
 *     while True:
 *             pref=fref.readline().strip().split()             # <<<<<<<<<<<<<<
 *             if not pref: break
 *             seq+=pref[0]
 */
    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_fref, __pyx_n_s_readline); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1153, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_5 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_2))) {
      __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_2);
      if (likely(__pyx_t_5)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
        __Pyx_INCREF(__pyx_t_5);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_2, function);
      }
    }
    if (__pyx_t_5) {
      __pyx_t_3 = __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_5); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1153, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    } else {
      __pyx_t_3 = __Pyx_PyObject_CallNoArg(__pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1153, __pyx_L1_error)
    }
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_strip); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1153, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_2))) {
      __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
      if (likely(__pyx_t_3)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
        __Pyx_INCREF(__pyx_t_3);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_2, function);
      }
    }
    if (__pyx_t_3) {
      __pyx_t_4 = __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1153, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    } else {
      __pyx_t_4 = __Pyx_PyObject_CallNoArg(__pyx_t_2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1153, __pyx_L1_error)
    }
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_split); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1153, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_2))) {
      __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_2);
      if (likely(__pyx_t_4)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
        __Pyx_INCREF(__pyx_t_4);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_2, function);
      }
    }
    if (__pyx_t_4) {
      __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1153, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    } else {
      __pyx_t_1 = __Pyx_PyObject_CallNoArg(__pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1153, __pyx_L1_error)
    }
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __Pyx_XDECREF_SET(__pyx_v_pref, __pyx_t_1);
    __pyx_t_1 = 0;

    /* "vapor_vali/Simple_function.pyx":1154
 *     while True:
 *             pref=fref.readline().strip().split()
 *             if not pref: break             # <<<<<<<<<<<<<<
 *             seq+=pref[0]
 *     fref.close()
 */
    __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_v_pref); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 1154, __pyx_L1_error)
    __pyx_t_7 = ((!__pyx_t_6) != 0);
    if (__pyx_t_7) {
      goto __pyx_L4_break;
    }

    /* "vapor_vali/Simple_function.pyx":1155
 *             pref=fref.readline().strip().split()
 *             if not pref: break
 *             seq+=pref[0]             # <<<<<<<<<<<<<<
 *     fref.close()
 *     if reverse_flag=='FALSE':
 */
    __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_pref, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1155, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_2 = PyNumber_InPlaceAdd(__pyx_v_seq, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1155, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __Pyx_DECREF_SET(__pyx_v_seq, __pyx_t_2);
    __pyx_t_2 = 0;
  }
  __pyx_L4_break:;

  /* "vapor_vali/Simple_function.pyx":1156
 *             if not pref: break
 *             seq+=pref[0]
 *     fref.close()             # <<<<<<<<<<<<<<
 *     if reverse_flag=='FALSE':
 *         return seq
 */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_fref, __pyx_n_s_close); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1156, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_4 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_1))) {
    __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_1);
    if (likely(__pyx_t_4)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
      __Pyx_INCREF(__pyx_t_4);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_1, function);
    }
  }
  if (__pyx_t_4) {
    __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_t_4); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1156, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  } else {
    __pyx_t_2 = __Pyx_PyObject_CallNoArg(__pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1156, __pyx_L1_error)
  }
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":1157
 *             seq+=pref[0]
 *     fref.close()
 *     if reverse_flag=='FALSE':             # <<<<<<<<<<<<<<
 *         return seq
 *     else:
 */
  __pyx_t_7 = (__Pyx_PyString_Equals(__pyx_v_reverse_flag, __pyx_n_s_FALSE, Py_EQ)); if (unlikely(__pyx_t_7 < 0)) __PYX_ERR(0, 1157, __pyx_L1_error)
  if (__pyx_t_7) {

    /* "vapor_vali/Simple_function.pyx":1158
 *     fref.close()
 *     if reverse_flag=='FALSE':
 *         return seq             # <<<<<<<<<<<<<<
 *     else:
 *         return reverse(complementary(seq))
 */
    __Pyx_XDECREF(__pyx_r);
    __Pyx_INCREF(__pyx_v_seq);
    __pyx_r = __pyx_v_seq;
    goto __pyx_L0;

    /* "vapor_vali/Simple_function.pyx":1157
 *             seq+=pref[0]
 *     fref.close()
 *     if reverse_flag=='FALSE':             # <<<<<<<<<<<<<<
 *         return seq
 *     else:
 */
  }

  /* "vapor_vali/Simple_function.pyx":1160
 *         return seq
 *     else:
 *         return reverse(complementary(seq))             # <<<<<<<<<<<<<<
 * 
 * def result_organize_ins(info_list):
 */
  /*else*/ {
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_reverse); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1160, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_complementary); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1160, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_5 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_3))) {
      __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_3);
      if (likely(__pyx_t_5)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
        __Pyx_INCREF(__pyx_t_5);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_3, function);
      }
    }
    if (!__pyx_t_5) {
      __pyx_t_4 = __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_v_seq); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1160, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
    } else {
      __pyx_t_8 = PyTuple_New(1+1); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1160, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_8);
      __Pyx_GIVEREF(__pyx_t_5); PyTuple_SET_ITEM(__pyx_t_8, 0, __pyx_t_5); __pyx_t_5 = NULL;
      __Pyx_INCREF(__pyx_v_seq);
      __Pyx_GIVEREF(__pyx_v_seq);
      PyTuple_SET_ITEM(__pyx_t_8, 0+1, __pyx_v_seq);
      __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_8, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1160, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
    }
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_1))) {
      __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_1);
      if (likely(__pyx_t_3)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
        __Pyx_INCREF(__pyx_t_3);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_1, function);
      }
    }
    if (!__pyx_t_3) {
      __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_t_4); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1160, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      __Pyx_GOTREF(__pyx_t_2);
    } else {
      __pyx_t_8 = PyTuple_New(1+1); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1160, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_8);
      __Pyx_GIVEREF(__pyx_t_3); PyTuple_SET_ITEM(__pyx_t_8, 0, __pyx_t_3); __pyx_t_3 = NULL;
      __Pyx_GIVEREF(__pyx_t_4);
      PyTuple_SET_ITEM(__pyx_t_8, 0+1, __pyx_t_4);
      __pyx_t_4 = 0;
      __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_8, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1160, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
    }
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;
  }

  /* "vapor_vali/Simple_function.pyx":1146
 *     return    [i for i in ref_left_wings if kept_lines_size_filter(i)=='TRUE']
 * 
 * def ref_seq_readin(ref,chrom,start,end,reverse_flag='FALSE'):             # <<<<<<<<<<<<<<
 *     #reverse=='TRUE': return rev-comp-seq   ; if not specified, default as 'FALSE'
 *     #else: return original seq
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_8);
  __Pyx_AddTraceback("vapor_vali.Simple_function.ref_seq_readin", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_fref);
  __Pyx_XDECREF(__pyx_v_seq);
  __Pyx_XDECREF(__pyx_v_pref);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "vapor_vali/Simple_function.pyx":1162
 *         return reverse(complementary(seq))
 * 
 * def result_organize_ins(info_list):             # <<<<<<<<<<<<<<
 *     #eg of info_list=[key_event,vapor_score_event]=['chr2_82961201', [-9.228366096827557, -106.46718851834126, -667.0858781654538, -38.56838396416415, -64.87185751169045, -147.77261544769615, -28.29536680099185, -25.378519434143666, -17.23542013374081, -113.00564782332029, -64.53043553409316]]
 *     if len(info_list[1])>0:
 */

/* Python wrapper */
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_163result_organize_ins(PyObject *__pyx_self, PyObject *__pyx_v_info_list); /*proto*/
static PyMethodDef __pyx_mdef_10vapor_vali_15Simple_function_163result_organize_ins = {"result_organize_ins", (PyCFunction)__pyx_pw_10vapor_vali_15Simple_function_163result_organize_ins, METH_O, 0};
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_163result_organize_ins(PyObject *__pyx_self, PyObject *__pyx_v_info_list) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("result_organize_ins (wrapper)", 0);
  __pyx_r = __pyx_pf_10vapor_vali_15Simple_function_162result_organize_ins(__pyx_self, ((PyObject *)__pyx_v_info_list));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10vapor_vali_15Simple_function_162result_organize_ins(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_info_list) {
  PyObject *__pyx_v_pos_values = NULL;
  PyObject *__pyx_v_neg_values = NULL;
  double __pyx_v_geno_value;
  PyObject *__pyx_v_qual_value = NULL;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  Py_ssize_t __pyx_t_2;
  int __pyx_t_3;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  PyObject *(*__pyx_t_6)(PyObject *);
  double __pyx_t_7;
  Py_ssize_t __pyx_t_8;
  Py_ssize_t __pyx_t_9;
  int __pyx_t_10;
  PyObject *__pyx_t_11 = NULL;
  PyObject *__pyx_t_12 = NULL;
  PyObject *__pyx_t_13 = NULL;
  __Pyx_RefNannySetupContext("result_organize_ins", 0);

  /* "vapor_vali/Simple_function.pyx":1164
 * def result_organize_ins(info_list):
 *     #eg of info_list=[key_event,vapor_score_event]=['chr2_82961201', [-9.228366096827557, -106.46718851834126, -667.0858781654538, -38.56838396416415, -64.87185751169045, -147.77261544769615, -28.29536680099185, -25.378519434143666, -17.23542013374081, -113.00564782332029, -64.53043553409316]]
 *     if len(info_list[1])>0:             # <<<<<<<<<<<<<<
 *         pos_values=[i for i in info_list[1] if float(i)>0.1]
 *         neg_values=[i for i in info_list[1] if not float(i)>0.1]
 */
  __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_info_list, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1164, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = PyObject_Length(__pyx_t_1); if (unlikely(__pyx_t_2 == -1)) __PYX_ERR(0, 1164, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_3 = ((__pyx_t_2 > 0) != 0);
  if (__pyx_t_3) {

    /* "vapor_vali/Simple_function.pyx":1165
 *     #eg of info_list=[key_event,vapor_score_event]=['chr2_82961201', [-9.228366096827557, -106.46718851834126, -667.0858781654538, -38.56838396416415, -64.87185751169045, -147.77261544769615, -28.29536680099185, -25.378519434143666, -17.23542013374081, -113.00564782332029, -64.53043553409316]]
 *     if len(info_list[1])>0:
 *         pos_values=[i for i in info_list[1] if float(i)>0.1]             # <<<<<<<<<<<<<<
 *         neg_values=[i for i in info_list[1] if not float(i)>0.1]
 *         geno_value=float(len(pos_values))/float(len(pos_values)+len(neg_values))
 */
    __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1165, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_4 = __Pyx_GetItemInt(__pyx_v_info_list, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1165, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    if (likely(PyList_CheckExact(__pyx_t_4)) || PyTuple_CheckExact(__pyx_t_4)) {
      __pyx_t_5 = __pyx_t_4; __Pyx_INCREF(__pyx_t_5); __pyx_t_2 = 0;
      __pyx_t_6 = NULL;
    } else {
      __pyx_t_2 = -1; __pyx_t_5 = PyObject_GetIter(__pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1165, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_5);
      __pyx_t_6 = Py_TYPE(__pyx_t_5)->tp_iternext; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1165, __pyx_L1_error)
    }
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    for (;;) {
      if (likely(!__pyx_t_6)) {
        if (likely(PyList_CheckExact(__pyx_t_5))) {
          if (__pyx_t_2 >= PyList_GET_SIZE(__pyx_t_5)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_4 = PyList_GET_ITEM(__pyx_t_5, __pyx_t_2); __Pyx_INCREF(__pyx_t_4); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 1165, __pyx_L1_error)
          #else
          __pyx_t_4 = PySequence_ITEM(__pyx_t_5, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1165, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_4);
          #endif
        } else {
          if (__pyx_t_2 >= PyTuple_GET_SIZE(__pyx_t_5)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_4 = PyTuple_GET_ITEM(__pyx_t_5, __pyx_t_2); __Pyx_INCREF(__pyx_t_4); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 1165, __pyx_L1_error)
          #else
          __pyx_t_4 = PySequence_ITEM(__pyx_t_5, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1165, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_4);
          #endif
        }
      } else {
        __pyx_t_4 = __pyx_t_6(__pyx_t_5);
        if (unlikely(!__pyx_t_4)) {
          PyObject* exc_type = PyErr_Occurred();
          if (exc_type) {
            if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
            else __PYX_ERR(0, 1165, __pyx_L1_error)
          }
          break;
        }
        __Pyx_GOTREF(__pyx_t_4);
      }
      __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_4);
      __pyx_t_4 = 0;
      __pyx_t_7 = __Pyx_PyObject_AsDouble(__pyx_v_i); if (unlikely(__pyx_t_7 == ((double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1165, __pyx_L1_error)
      __pyx_t_3 = ((__pyx_t_7 > 0.1) != 0);
      if (__pyx_t_3) {
        if (unlikely(__Pyx_ListComp_Append(__pyx_t_1, (PyObject*)__pyx_v_i))) __PYX_ERR(0, 1165, __pyx_L1_error)
      }
    }
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_v_pos_values = ((PyObject*)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "vapor_vali/Simple_function.pyx":1166
 *     if len(info_list[1])>0:
 *         pos_values=[i for i in info_list[1] if float(i)>0.1]
 *         neg_values=[i for i in info_list[1] if not float(i)>0.1]             # <<<<<<<<<<<<<<
 *         geno_value=float(len(pos_values))/float(len(pos_values)+len(neg_values))
 *         if not pos_values==[]:
 */
    __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1166, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_5 = __Pyx_GetItemInt(__pyx_v_info_list, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1166, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    if (likely(PyList_CheckExact(__pyx_t_5)) || PyTuple_CheckExact(__pyx_t_5)) {
      __pyx_t_4 = __pyx_t_5; __Pyx_INCREF(__pyx_t_4); __pyx_t_2 = 0;
      __pyx_t_6 = NULL;
    } else {
      __pyx_t_2 = -1; __pyx_t_4 = PyObject_GetIter(__pyx_t_5); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1166, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_t_6 = Py_TYPE(__pyx_t_4)->tp_iternext; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1166, __pyx_L1_error)
    }
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    for (;;) {
      if (likely(!__pyx_t_6)) {
        if (likely(PyList_CheckExact(__pyx_t_4))) {
          if (__pyx_t_2 >= PyList_GET_SIZE(__pyx_t_4)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_5 = PyList_GET_ITEM(__pyx_t_4, __pyx_t_2); __Pyx_INCREF(__pyx_t_5); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 1166, __pyx_L1_error)
          #else
          __pyx_t_5 = PySequence_ITEM(__pyx_t_4, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1166, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_5);
          #endif
        } else {
          if (__pyx_t_2 >= PyTuple_GET_SIZE(__pyx_t_4)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_5 = PyTuple_GET_ITEM(__pyx_t_4, __pyx_t_2); __Pyx_INCREF(__pyx_t_5); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 1166, __pyx_L1_error)
          #else
          __pyx_t_5 = PySequence_ITEM(__pyx_t_4, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1166, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_5);
          #endif
        }
      } else {
        __pyx_t_5 = __pyx_t_6(__pyx_t_4);
        if (unlikely(!__pyx_t_5)) {
          PyObject* exc_type = PyErr_Occurred();
          if (exc_type) {
            if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
            else __PYX_ERR(0, 1166, __pyx_L1_error)
          }
          break;
        }
        __Pyx_GOTREF(__pyx_t_5);
      }
      __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_5);
      __pyx_t_5 = 0;
      __pyx_t_7 = __Pyx_PyObject_AsDouble(__pyx_v_i); if (unlikely(__pyx_t_7 == ((double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1166, __pyx_L1_error)
      __pyx_t_3 = ((!((__pyx_t_7 > 0.1) != 0)) != 0);
      if (__pyx_t_3) {
        if (unlikely(__Pyx_ListComp_Append(__pyx_t_1, (PyObject*)__pyx_v_i))) __PYX_ERR(0, 1166, __pyx_L1_error)
      }
    }
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_v_neg_values = ((PyObject*)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "vapor_vali/Simple_function.pyx":1167
 *         pos_values=[i for i in info_list[1] if float(i)>0.1]
 *         neg_values=[i for i in info_list[1] if not float(i)>0.1]
 *         geno_value=float(len(pos_values))/float(len(pos_values)+len(neg_values))             # <<<<<<<<<<<<<<
 *         if not pos_values==[]:
 *             qual_value=np.mean(pos_values)
 */
    __pyx_t_2 = PyList_GET_SIZE(__pyx_v_pos_values); if (unlikely(__pyx_t_2 == -1)) __PYX_ERR(0, 1167, __pyx_L1_error)
    __pyx_t_8 = PyList_GET_SIZE(__pyx_v_pos_values); if (unlikely(__pyx_t_8 == -1)) __PYX_ERR(0, 1167, __pyx_L1_error)
    __pyx_t_9 = PyList_GET_SIZE(__pyx_v_neg_values); if (unlikely(__pyx_t_9 == -1)) __PYX_ERR(0, 1167, __pyx_L1_error)
    if (unlikely(((double)(__pyx_t_8 + __pyx_t_9)) == 0)) {
      PyErr_SetString(PyExc_ZeroDivisionError, "float division");
      __PYX_ERR(0, 1167, __pyx_L1_error)
    }
    __pyx_v_geno_value = (((double)__pyx_t_2) / ((double)(__pyx_t_8 + __pyx_t_9)));

    /* "vapor_vali/Simple_function.pyx":1168
 *         neg_values=[i for i in info_list[1] if not float(i)>0.1]
 *         geno_value=float(len(pos_values))/float(len(pos_values)+len(neg_values))
 *         if not pos_values==[]:             # <<<<<<<<<<<<<<
 *             qual_value=np.mean(pos_values)
 *         else:
 */
    __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1168, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_4 = PyObject_RichCompare(__pyx_v_pos_values, __pyx_t_1, Py_EQ); __Pyx_XGOTREF(__pyx_t_4); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1168, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_3 = __Pyx_PyObject_IsTrue(__pyx_t_4); if (unlikely(__pyx_t_3 < 0)) __PYX_ERR(0, 1168, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_10 = ((!__pyx_t_3) != 0);
    if (__pyx_t_10) {

      /* "vapor_vali/Simple_function.pyx":1169
 *         geno_value=float(len(pos_values))/float(len(pos_values)+len(neg_values))
 *         if not pos_values==[]:
 *             qual_value=np.mean(pos_values)             # <<<<<<<<<<<<<<
 *         else:
 *             qual_value=0
 */
      __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1169, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_mean); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1169, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_5);
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_1 = NULL;
      if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_5))) {
        __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_5);
        if (likely(__pyx_t_1)) {
          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
          __Pyx_INCREF(__pyx_t_1);
          __Pyx_INCREF(function);
          __Pyx_DECREF_SET(__pyx_t_5, function);
        }
      }
      if (!__pyx_t_1) {
        __pyx_t_4 = __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_v_pos_values); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1169, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_4);
      } else {
        __pyx_t_11 = PyTuple_New(1+1); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1169, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_11);
        __Pyx_GIVEREF(__pyx_t_1); PyTuple_SET_ITEM(__pyx_t_11, 0, __pyx_t_1); __pyx_t_1 = NULL;
        __Pyx_INCREF(__pyx_v_pos_values);
        __Pyx_GIVEREF(__pyx_v_pos_values);
        PyTuple_SET_ITEM(__pyx_t_11, 0+1, __pyx_v_pos_values);
        __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_11, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1169, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_4);
        __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
      }
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
      __pyx_v_qual_value = __pyx_t_4;
      __pyx_t_4 = 0;

      /* "vapor_vali/Simple_function.pyx":1168
 *         neg_values=[i for i in info_list[1] if not float(i)>0.1]
 *         geno_value=float(len(pos_values))/float(len(pos_values)+len(neg_values))
 *         if not pos_values==[]:             # <<<<<<<<<<<<<<
 *             qual_value=np.mean(pos_values)
 *         else:
 */
      goto __pyx_L10;
    }

    /* "vapor_vali/Simple_function.pyx":1171
 *             qual_value=np.mean(pos_values)
 *         else:
 *             qual_value=0             # <<<<<<<<<<<<<<
 *         return [info_list[0]]+[qual_value,geno_value,','.join([str(round(float(i),2)) for i in info_list[1]])]
 *     else:
 */
    /*else*/ {
      __Pyx_INCREF(__pyx_int_0);
      __pyx_v_qual_value = __pyx_int_0;
    }
    __pyx_L10:;

    /* "vapor_vali/Simple_function.pyx":1172
 *         else:
 *             qual_value=0
 *         return [info_list[0]]+[qual_value,geno_value,','.join([str(round(float(i),2)) for i in info_list[1]])]             # <<<<<<<<<<<<<<
 *     else:
 *         return [info_list[0]]+['NA' for i in range(3)]
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_4 = __Pyx_GetItemInt(__pyx_v_info_list, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1172, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_5 = PyList_New(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1172, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_GIVEREF(__pyx_t_4);
    PyList_SET_ITEM(__pyx_t_5, 0, __pyx_t_4);
    __pyx_t_4 = 0;
    __pyx_t_4 = PyFloat_FromDouble(__pyx_v_geno_value); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1172, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_11 = PyList_New(0); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1172, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_11);
    __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_info_list, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1172, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    if (likely(PyList_CheckExact(__pyx_t_1)) || PyTuple_CheckExact(__pyx_t_1)) {
      __pyx_t_12 = __pyx_t_1; __Pyx_INCREF(__pyx_t_12); __pyx_t_9 = 0;
      __pyx_t_6 = NULL;
    } else {
      __pyx_t_9 = -1; __pyx_t_12 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1172, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_12);
      __pyx_t_6 = Py_TYPE(__pyx_t_12)->tp_iternext; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1172, __pyx_L1_error)
    }
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    for (;;) {
      if (likely(!__pyx_t_6)) {
        if (likely(PyList_CheckExact(__pyx_t_12))) {
          if (__pyx_t_9 >= PyList_GET_SIZE(__pyx_t_12)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_1 = PyList_GET_ITEM(__pyx_t_12, __pyx_t_9); __Pyx_INCREF(__pyx_t_1); __pyx_t_9++; if (unlikely(0 < 0)) __PYX_ERR(0, 1172, __pyx_L1_error)
          #else
          __pyx_t_1 = PySequence_ITEM(__pyx_t_12, __pyx_t_9); __pyx_t_9++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1172, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_1);
          #endif
        } else {
          if (__pyx_t_9 >= PyTuple_GET_SIZE(__pyx_t_12)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_12, __pyx_t_9); __Pyx_INCREF(__pyx_t_1); __pyx_t_9++; if (unlikely(0 < 0)) __PYX_ERR(0, 1172, __pyx_L1_error)
          #else
          __pyx_t_1 = PySequence_ITEM(__pyx_t_12, __pyx_t_9); __pyx_t_9++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1172, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_1);
          #endif
        }
      } else {
        __pyx_t_1 = __pyx_t_6(__pyx_t_12);
        if (unlikely(!__pyx_t_1)) {
          PyObject* exc_type = PyErr_Occurred();
          if (exc_type) {
            if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
            else __PYX_ERR(0, 1172, __pyx_L1_error)
          }
          break;
        }
        __Pyx_GOTREF(__pyx_t_1);
      }
      __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_1);
      __pyx_t_1 = 0;
      __pyx_t_1 = __Pyx_PyNumber_Float(__pyx_v_i); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1172, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __pyx_t_13 = PyTuple_New(2); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1172, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_13);
      __Pyx_GIVEREF(__pyx_t_1);
      PyTuple_SET_ITEM(__pyx_t_13, 0, __pyx_t_1);
      __Pyx_INCREF(__pyx_int_2);
      __Pyx_GIVEREF(__pyx_int_2);
      PyTuple_SET_ITEM(__pyx_t_13, 1, __pyx_int_2);
      __pyx_t_1 = 0;
      __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_round, __pyx_t_13, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1172, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
      __pyx_t_13 = PyTuple_New(1); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1172, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_13);
      __Pyx_GIVEREF(__pyx_t_1);
      PyTuple_SET_ITEM(__pyx_t_13, 0, __pyx_t_1);
      __pyx_t_1 = 0;
      __pyx_t_1 = __Pyx_PyObject_Call(((PyObject *)(&PyString_Type)), __pyx_t_13, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1172, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
      if (unlikely(__Pyx_ListComp_Append(__pyx_t_11, (PyObject*)__pyx_t_1))) __PYX_ERR(0, 1172, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    }
    __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
    __pyx_t_12 = __Pyx_PyString_Join(__pyx_kp_s__83, __pyx_t_11); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1172, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_12);
    __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
    __pyx_t_11 = PyList_New(3); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1172, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_11);
    __Pyx_INCREF(__pyx_v_qual_value);
    __Pyx_GIVEREF(__pyx_v_qual_value);
    PyList_SET_ITEM(__pyx_t_11, 0, __pyx_v_qual_value);
    __Pyx_GIVEREF(__pyx_t_4);
    PyList_SET_ITEM(__pyx_t_11, 1, __pyx_t_4);
    __Pyx_GIVEREF(__pyx_t_12);
    PyList_SET_ITEM(__pyx_t_11, 2, __pyx_t_12);
    __pyx_t_4 = 0;
    __pyx_t_12 = 0;
    __pyx_t_12 = PyNumber_Add(__pyx_t_5, __pyx_t_11); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1172, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_12);
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
    __pyx_r = __pyx_t_12;
    __pyx_t_12 = 0;
    goto __pyx_L0;

    /* "vapor_vali/Simple_function.pyx":1164
 * def result_organize_ins(info_list):
 *     #eg of info_list=[key_event,vapor_score_event]=['chr2_82961201', [-9.228366096827557, -106.46718851834126, -667.0858781654538, -38.56838396416415, -64.87185751169045, -147.77261544769615, -28.29536680099185, -25.378519434143666, -17.23542013374081, -113.00564782332029, -64.53043553409316]]
 *     if len(info_list[1])>0:             # <<<<<<<<<<<<<<
 *         pos_values=[i for i in info_list[1] if float(i)>0.1]
 *         neg_values=[i for i in info_list[1] if not float(i)>0.1]
 */
  }

  /* "vapor_vali/Simple_function.pyx":1174
 *         return [info_list[0]]+[qual_value,geno_value,','.join([str(round(float(i),2)) for i in info_list[1]])]
 *     else:
 *         return [info_list[0]]+['NA' for i in range(3)]             # <<<<<<<<<<<<<<
 * 
 * def simple_del_diploid_decide(k1,k2):
 */
  /*else*/ {
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_12 = __Pyx_GetItemInt(__pyx_v_info_list, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1174, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_12);
    __pyx_t_11 = PyList_New(1); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1174, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_11);
    __Pyx_GIVEREF(__pyx_t_12);
    PyList_SET_ITEM(__pyx_t_11, 0, __pyx_t_12);
    __pyx_t_12 = 0;
    __pyx_t_12 = PyList_New(0); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1174, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_12);
    __pyx_t_5 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_tuple__86, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1174, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    if (likely(PyList_CheckExact(__pyx_t_5)) || PyTuple_CheckExact(__pyx_t_5)) {
      __pyx_t_4 = __pyx_t_5; __Pyx_INCREF(__pyx_t_4); __pyx_t_9 = 0;
      __pyx_t_6 = NULL;
    } else {
      __pyx_t_9 = -1; __pyx_t_4 = PyObject_GetIter(__pyx_t_5); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1174, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_t_6 = Py_TYPE(__pyx_t_4)->tp_iternext; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1174, __pyx_L1_error)
    }
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    for (;;) {
      if (likely(!__pyx_t_6)) {
        if (likely(PyList_CheckExact(__pyx_t_4))) {
          if (__pyx_t_9 >= PyList_GET_SIZE(__pyx_t_4)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_5 = PyList_GET_ITEM(__pyx_t_4, __pyx_t_9); __Pyx_INCREF(__pyx_t_5); __pyx_t_9++; if (unlikely(0 < 0)) __PYX_ERR(0, 1174, __pyx_L1_error)
          #else
          __pyx_t_5 = PySequence_ITEM(__pyx_t_4, __pyx_t_9); __pyx_t_9++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1174, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_5);
          #endif
        } else {
          if (__pyx_t_9 >= PyTuple_GET_SIZE(__pyx_t_4)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_5 = PyTuple_GET_ITEM(__pyx_t_4, __pyx_t_9); __Pyx_INCREF(__pyx_t_5); __pyx_t_9++; if (unlikely(0 < 0)) __PYX_ERR(0, 1174, __pyx_L1_error)
          #else
          __pyx_t_5 = PySequence_ITEM(__pyx_t_4, __pyx_t_9); __pyx_t_9++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1174, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_5);
          #endif
        }
      } else {
        __pyx_t_5 = __pyx_t_6(__pyx_t_4);
        if (unlikely(!__pyx_t_5)) {
          PyObject* exc_type = PyErr_Occurred();
          if (exc_type) {
            if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
            else __PYX_ERR(0, 1174, __pyx_L1_error)
          }
          break;
        }
        __Pyx_GOTREF(__pyx_t_5);
      }
      __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_5);
      __pyx_t_5 = 0;
      if (unlikely(__Pyx_ListComp_Append(__pyx_t_12, (PyObject*)__pyx_n_s_NA))) __PYX_ERR(0, 1174, __pyx_L1_error)
    }
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = PyNumber_Add(__pyx_t_11, __pyx_t_12); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1174, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
    __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
    __pyx_r = __pyx_t_4;
    __pyx_t_4 = 0;
    goto __pyx_L0;
  }

  /* "vapor_vali/Simple_function.pyx":1162
 *         return reverse(complementary(seq))
 * 
 * def result_organize_ins(info_list):             # <<<<<<<<<<<<<<
 *     #eg of info_list=[key_event,vapor_score_event]=['chr2_82961201', [-9.228366096827557, -106.46718851834126, -667.0858781654538, -38.56838396416415, -64.87185751169045, -147.77261544769615, -28.29536680099185, -25.378519434143666, -17.23542013374081, -113.00564782332029, -64.53043553409316]]
 *     if len(info_list[1])>0:
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_11);
  __Pyx_XDECREF(__pyx_t_12);
  __Pyx_XDECREF(__pyx_t_13);
  __Pyx_AddTraceback("vapor_vali.Simple_function.result_organize_ins", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_pos_values);
  __Pyx_XDECREF(__pyx_v_neg_values);
  __Pyx_XDECREF(__pyx_v_qual_value);
  __Pyx_XDECREF(__pyx_v_i);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "vapor_vali/Simple_function.pyx":1176
 *         return [info_list[0]]+['NA' for i in range(3)]
 * 
 * def simple_del_diploid_decide(k1,k2):             # <<<<<<<<<<<<<<
 *     #eg of k1='ab/ab'   ; eg of k2='a/a'
 *     k2_haps=k2.split('/')
 */

/* Python wrapper */
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_165simple_del_diploid_decide(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_10vapor_vali_15Simple_function_165simple_del_diploid_decide = {"simple_del_diploid_decide", (PyCFunction)__pyx_pw_10vapor_vali_15Simple_function_165simple_del_diploid_decide, METH_VARARGS|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_165simple_del_diploid_decide(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_k1 = 0;
  PyObject *__pyx_v_k2 = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("simple_del_diploid_decide (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_k1,&__pyx_n_s_k2,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_k1)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_k2)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("simple_del_diploid_decide", 1, 2, 2, 1); __PYX_ERR(0, 1176, __pyx_L3_error)
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "simple_del_diploid_decide") < 0)) __PYX_ERR(0, 1176, __pyx_L3_error)
      }
    } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
    }
    __pyx_v_k1 = values[0];
    __pyx_v_k2 = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("simple_del_diploid_decide", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1176, __pyx_L3_error)
  __pyx_L3_error:;
  __Pyx_AddTraceback("vapor_vali.Simple_function.simple_del_diploid_decide", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_10vapor_vali_15Simple_function_164simple_del_diploid_decide(__pyx_self, __pyx_v_k1, __pyx_v_k2);

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10vapor_vali_15Simple_function_164simple_del_diploid_decide(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_k1, PyObject *__pyx_v_k2) {
  PyObject *__pyx_v_k2_haps = NULL;
  PyObject *__pyx_v_k1_hap = NULL;
  PyObject *__pyx_v_out = NULL;
  PyObject *__pyx_v_x = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  Py_ssize_t __pyx_t_3;
  PyObject *(*__pyx_t_4)(PyObject *);
  int __pyx_t_5;
  int __pyx_t_6;
  PyObject *__pyx_t_7 = NULL;
  PyObject *__pyx_t_8 = NULL;
  Py_ssize_t __pyx_t_9;
  PyObject *__pyx_t_10 = NULL;
  __Pyx_RefNannySetupContext("simple_del_diploid_decide", 0);

  /* "vapor_vali/Simple_function.pyx":1178
 * def simple_del_diploid_decide(k1,k2):
 *     #eg of k1='ab/ab'   ; eg of k2='a/a'
 *     k2_haps=k2.split('/')             # <<<<<<<<<<<<<<
 *     k1_hap=k1.split('/')[0]
 *     out=[]
 */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_k2, __pyx_n_s_split); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1178, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_tuple__87, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1178, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_k2_haps = __pyx_t_2;
  __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":1179
 *     #eg of k1='ab/ab'   ; eg of k2='a/a'
 *     k2_haps=k2.split('/')
 *     k1_hap=k1.split('/')[0]             # <<<<<<<<<<<<<<
 *     out=[]
 *     for x in k2_haps:
 */
  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_k1, __pyx_n_s_split); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1179, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_tuple__88, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1179, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = __Pyx_GetItemInt(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1179, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_k1_hap = __pyx_t_2;
  __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":1180
 *     k2_haps=k2.split('/')
 *     k1_hap=k1.split('/')[0]
 *     out=[]             # <<<<<<<<<<<<<<
 *     for x in k2_haps:
 *         if x==k1_hap: out.append('NA')
 */
  __pyx_t_2 = PyList_New(0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1180, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_v_out = ((PyObject*)__pyx_t_2);
  __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":1181
 *     k1_hap=k1.split('/')[0]
 *     out=[]
 *     for x in k2_haps:             # <<<<<<<<<<<<<<
 *         if x==k1_hap: out.append('NA')
 *         else:
 */
  if (likely(PyList_CheckExact(__pyx_v_k2_haps)) || PyTuple_CheckExact(__pyx_v_k2_haps)) {
    __pyx_t_2 = __pyx_v_k2_haps; __Pyx_INCREF(__pyx_t_2); __pyx_t_3 = 0;
    __pyx_t_4 = NULL;
  } else {
    __pyx_t_3 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_v_k2_haps); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1181, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_4 = Py_TYPE(__pyx_t_2)->tp_iternext; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1181, __pyx_L1_error)
  }
  for (;;) {
    if (likely(!__pyx_t_4)) {
      if (likely(PyList_CheckExact(__pyx_t_2))) {
        if (__pyx_t_3 >= PyList_GET_SIZE(__pyx_t_2)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_1 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_3); __Pyx_INCREF(__pyx_t_1); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 1181, __pyx_L1_error)
        #else
        __pyx_t_1 = PySequence_ITEM(__pyx_t_2, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1181, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        #endif
      } else {
        if (__pyx_t_3 >= PyTuple_GET_SIZE(__pyx_t_2)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_3); __Pyx_INCREF(__pyx_t_1); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 1181, __pyx_L1_error)
        #else
        __pyx_t_1 = PySequence_ITEM(__pyx_t_2, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1181, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        #endif
      }
    } else {
      __pyx_t_1 = __pyx_t_4(__pyx_t_2);
      if (unlikely(!__pyx_t_1)) {
        PyObject* exc_type = PyErr_Occurred();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
          else __PYX_ERR(0, 1181, __pyx_L1_error)
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_1);
    }
    __Pyx_XDECREF_SET(__pyx_v_x, __pyx_t_1);
    __pyx_t_1 = 0;

    /* "vapor_vali/Simple_function.pyx":1182
 *     out=[]
 *     for x in k2_haps:
 *         if x==k1_hap: out.append('NA')             # <<<<<<<<<<<<<<
 *         else:
 *             out.append(simple_del_haploid_decide(k1_hap,x))
 */
    __pyx_t_1 = PyObject_RichCompare(__pyx_v_x, __pyx_v_k1_hap, Py_EQ); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1182, __pyx_L1_error)
    __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 1182, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    if (__pyx_t_5) {
      __pyx_t_6 = __Pyx_PyList_Append(__pyx_v_out, __pyx_n_s_NA); if (unlikely(__pyx_t_6 == -1)) __PYX_ERR(0, 1182, __pyx_L1_error)
      goto __pyx_L5;
    }

    /* "vapor_vali/Simple_function.pyx":1184
 *         if x==k1_hap: out.append('NA')
 *         else:
 *             out.append(simple_del_haploid_decide(k1_hap,x))             # <<<<<<<<<<<<<<
 *     return out
 * 
 */
    /*else*/ {
      __pyx_t_7 = __Pyx_GetModuleGlobalName(__pyx_n_s_simple_del_haploid_decide); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1184, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_7);
      __pyx_t_8 = NULL;
      __pyx_t_9 = 0;
      if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_7))) {
        __pyx_t_8 = PyMethod_GET_SELF(__pyx_t_7);
        if (likely(__pyx_t_8)) {
          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_7);
          __Pyx_INCREF(__pyx_t_8);
          __Pyx_INCREF(function);
          __Pyx_DECREF_SET(__pyx_t_7, function);
          __pyx_t_9 = 1;
        }
      }
      __pyx_t_10 = PyTuple_New(2+__pyx_t_9); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1184, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_10);
      if (__pyx_t_8) {
        __Pyx_GIVEREF(__pyx_t_8); PyTuple_SET_ITEM(__pyx_t_10, 0, __pyx_t_8); __pyx_t_8 = NULL;
      }
      __Pyx_INCREF(__pyx_v_k1_hap);
      __Pyx_GIVEREF(__pyx_v_k1_hap);
      PyTuple_SET_ITEM(__pyx_t_10, 0+__pyx_t_9, __pyx_v_k1_hap);
      __Pyx_INCREF(__pyx_v_x);
      __Pyx_GIVEREF(__pyx_v_x);
      PyTuple_SET_ITEM(__pyx_t_10, 1+__pyx_t_9, __pyx_v_x);
      __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_7, __pyx_t_10, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1184, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
      __pyx_t_6 = __Pyx_PyList_Append(__pyx_v_out, __pyx_t_1); if (unlikely(__pyx_t_6 == -1)) __PYX_ERR(0, 1184, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    }
    __pyx_L5:;

    /* "vapor_vali/Simple_function.pyx":1181
 *     k1_hap=k1.split('/')[0]
 *     out=[]
 *     for x in k2_haps:             # <<<<<<<<<<<<<<
 *         if x==k1_hap: out.append('NA')
 *         else:
 */
  }
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":1185
 *         else:
 *             out.append(simple_del_haploid_decide(k1_hap,x))
 *     return out             # <<<<<<<<<<<<<<
 * 
 * def simple_del_haploid_decide(k1_hap,k2_hap):
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_out);
  __pyx_r = __pyx_v_out;
  goto __pyx_L0;

  /* "vapor_vali/Simple_function.pyx":1176
 *         return [info_list[0]]+['NA' for i in range(3)]
 * 
 * def simple_del_diploid_decide(k1,k2):             # <<<<<<<<<<<<<<
 *     #eg of k1='ab/ab'   ; eg of k2='a/a'
 *     k2_haps=k2.split('/')
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_7);
  __Pyx_XDECREF(__pyx_t_8);
  __Pyx_XDECREF(__pyx_t_10);
  __Pyx_AddTraceback("vapor_vali.Simple_function.simple_del_diploid_decide", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_k2_haps);
  __Pyx_XDECREF(__pyx_v_k1_hap);
  __Pyx_XDECREF(__pyx_v_out);
  __Pyx_XDECREF(__pyx_v_x);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "vapor_vali/Simple_function.pyx":1187
 *     return out
 * 
 * def simple_del_haploid_decide(k1_hap,k2_hap):             # <<<<<<<<<<<<<<
 *     #eg of k1_hap='ab'  ;    eg of k2_hap='b'
 *     if k1_hap==k2_hap: return 'FALSE'   #no alt
 */

/* Python wrapper */
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_167simple_del_haploid_decide(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_10vapor_vali_15Simple_function_167simple_del_haploid_decide = {"simple_del_haploid_decide", (PyCFunction)__pyx_pw_10vapor_vali_15Simple_function_167simple_del_haploid_decide, METH_VARARGS|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_167simple_del_haploid_decide(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_k1_hap = 0;
  PyObject *__pyx_v_k2_hap = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("simple_del_haploid_decide (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_k1_hap,&__pyx_n_s_k2_hap,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_k1_hap)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_k2_hap)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("simple_del_haploid_decide", 1, 2, 2, 1); __PYX_ERR(0, 1187, __pyx_L3_error)
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "simple_del_haploid_decide") < 0)) __PYX_ERR(0, 1187, __pyx_L3_error)
      }
    } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
    }
    __pyx_v_k1_hap = values[0];
    __pyx_v_k2_hap = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("simple_del_haploid_decide", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1187, __pyx_L3_error)
  __pyx_L3_error:;
  __Pyx_AddTraceback("vapor_vali.Simple_function.simple_del_haploid_decide", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_10vapor_vali_15Simple_function_166simple_del_haploid_decide(__pyx_self, __pyx_v_k1_hap, __pyx_v_k2_hap);

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10vapor_vali_15Simple_function_166simple_del_haploid_decide(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_k1_hap, PyObject *__pyx_v_k2_hap) {
  PyObject *__pyx_v_dup_test = NULL;
  PyObject *__pyx_v_pos_compare = NULL;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_v_x = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_t_2;
  PyObject *__pyx_t_3 = NULL;
  Py_ssize_t __pyx_t_4;
  PyObject *(*__pyx_t_5)(PyObject *);
  PyObject *__pyx_t_6 = NULL;
  int __pyx_t_7;
  PyObject *__pyx_t_8 = NULL;
  PyObject *__pyx_t_9 = NULL;
  PyObject *__pyx_t_10 = NULL;
  long __pyx_t_11;
  long __pyx_t_12;
  __Pyx_RefNannySetupContext("simple_del_haploid_decide", 0);

  /* "vapor_vali/Simple_function.pyx":1189
 * def simple_del_haploid_decide(k1_hap,k2_hap):
 *     #eg of k1_hap='ab'  ;    eg of k2_hap='b'
 *     if k1_hap==k2_hap: return 'FALSE'   #no alt             # <<<<<<<<<<<<<<
 *     if k2_hap=='': return [i for i in k1_hap]
 *     if '^' in k2_hap:   return 'FALSE'  #check if inv included
 */
  __pyx_t_1 = PyObject_RichCompare(__pyx_v_k1_hap, __pyx_v_k2_hap, Py_EQ); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1189, __pyx_L1_error)
  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 1189, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  if (__pyx_t_2) {
    __Pyx_XDECREF(__pyx_r);
    __Pyx_INCREF(__pyx_n_s_FALSE);
    __pyx_r = __pyx_n_s_FALSE;
    goto __pyx_L0;
  }

  /* "vapor_vali/Simple_function.pyx":1190
 *     #eg of k1_hap='ab'  ;    eg of k2_hap='b'
 *     if k1_hap==k2_hap: return 'FALSE'   #no alt
 *     if k2_hap=='': return [i for i in k1_hap]             # <<<<<<<<<<<<<<
 *     if '^' in k2_hap:   return 'FALSE'  #check if inv included
 *     dup_test=[k2_hap.count(x) for x in k2_hap]
 */
  __pyx_t_2 = (__Pyx_PyString_Equals(__pyx_v_k2_hap, __pyx_kp_s__24, Py_EQ)); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 1190, __pyx_L1_error)
  if (__pyx_t_2) {
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1190, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    if (likely(PyList_CheckExact(__pyx_v_k1_hap)) || PyTuple_CheckExact(__pyx_v_k1_hap)) {
      __pyx_t_3 = __pyx_v_k1_hap; __Pyx_INCREF(__pyx_t_3); __pyx_t_4 = 0;
      __pyx_t_5 = NULL;
    } else {
      __pyx_t_4 = -1; __pyx_t_3 = PyObject_GetIter(__pyx_v_k1_hap); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1190, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __pyx_t_5 = Py_TYPE(__pyx_t_3)->tp_iternext; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1190, __pyx_L1_error)
    }
    for (;;) {
      if (likely(!__pyx_t_5)) {
        if (likely(PyList_CheckExact(__pyx_t_3))) {
          if (__pyx_t_4 >= PyList_GET_SIZE(__pyx_t_3)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_6 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_4); __Pyx_INCREF(__pyx_t_6); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 1190, __pyx_L1_error)
          #else
          __pyx_t_6 = PySequence_ITEM(__pyx_t_3, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1190, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_6);
          #endif
        } else {
          if (__pyx_t_4 >= PyTuple_GET_SIZE(__pyx_t_3)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_6 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_4); __Pyx_INCREF(__pyx_t_6); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 1190, __pyx_L1_error)
          #else
          __pyx_t_6 = PySequence_ITEM(__pyx_t_3, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1190, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_6);
          #endif
        }
      } else {
        __pyx_t_6 = __pyx_t_5(__pyx_t_3);
        if (unlikely(!__pyx_t_6)) {
          PyObject* exc_type = PyErr_Occurred();
          if (exc_type) {
            if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
            else __PYX_ERR(0, 1190, __pyx_L1_error)
          }
          break;
        }
        __Pyx_GOTREF(__pyx_t_6);
      }
      __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_6);
      __pyx_t_6 = 0;
      if (unlikely(__Pyx_ListComp_Append(__pyx_t_1, (PyObject*)__pyx_v_i))) __PYX_ERR(0, 1190, __pyx_L1_error)
    }
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;
  }

  /* "vapor_vali/Simple_function.pyx":1191
 *     if k1_hap==k2_hap: return 'FALSE'   #no alt
 *     if k2_hap=='': return [i for i in k1_hap]
 *     if '^' in k2_hap:   return 'FALSE'  #check if inv included             # <<<<<<<<<<<<<<
 *     dup_test=[k2_hap.count(x) for x in k2_hap]
 *     if max(dup_test)>1:     return 'FALSE'  #check if dup included
 */
  __pyx_t_2 = (__Pyx_PySequence_ContainsTF(__pyx_kp_s__7, __pyx_v_k2_hap, Py_EQ)); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 1191, __pyx_L1_error)
  __pyx_t_7 = (__pyx_t_2 != 0);
  if (__pyx_t_7) {
    __Pyx_XDECREF(__pyx_r);
    __Pyx_INCREF(__pyx_n_s_FALSE);
    __pyx_r = __pyx_n_s_FALSE;
    goto __pyx_L0;
  }

  /* "vapor_vali/Simple_function.pyx":1192
 *     if k2_hap=='': return [i for i in k1_hap]
 *     if '^' in k2_hap:   return 'FALSE'  #check if inv included
 *     dup_test=[k2_hap.count(x) for x in k2_hap]             # <<<<<<<<<<<<<<
 *     if max(dup_test)>1:     return 'FALSE'  #check if dup included
 *     if len(k2_hap)==1 and len(k1_hap)>1:    return letter_subgroup(''.join([i for i in k1_hap if not i in k2_hap]))   #del
 */
  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1192, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  if (likely(PyList_CheckExact(__pyx_v_k2_hap)) || PyTuple_CheckExact(__pyx_v_k2_hap)) {
    __pyx_t_3 = __pyx_v_k2_hap; __Pyx_INCREF(__pyx_t_3); __pyx_t_4 = 0;
    __pyx_t_5 = NULL;
  } else {
    __pyx_t_4 = -1; __pyx_t_3 = PyObject_GetIter(__pyx_v_k2_hap); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1192, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_5 = Py_TYPE(__pyx_t_3)->tp_iternext; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1192, __pyx_L1_error)
  }
  for (;;) {
    if (likely(!__pyx_t_5)) {
      if (likely(PyList_CheckExact(__pyx_t_3))) {
        if (__pyx_t_4 >= PyList_GET_SIZE(__pyx_t_3)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_6 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_4); __Pyx_INCREF(__pyx_t_6); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 1192, __pyx_L1_error)
        #else
        __pyx_t_6 = PySequence_ITEM(__pyx_t_3, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1192, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_6);
        #endif
      } else {
        if (__pyx_t_4 >= PyTuple_GET_SIZE(__pyx_t_3)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_6 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_4); __Pyx_INCREF(__pyx_t_6); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 1192, __pyx_L1_error)
        #else
        __pyx_t_6 = PySequence_ITEM(__pyx_t_3, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1192, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_6);
        #endif
      }
    } else {
      __pyx_t_6 = __pyx_t_5(__pyx_t_3);
      if (unlikely(!__pyx_t_6)) {
        PyObject* exc_type = PyErr_Occurred();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
          else __PYX_ERR(0, 1192, __pyx_L1_error)
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_6);
    }
    __Pyx_XDECREF_SET(__pyx_v_x, __pyx_t_6);
    __pyx_t_6 = 0;
    __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_v_k2_hap, __pyx_n_s_count); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1192, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_8);
    __pyx_t_9 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_8))) {
      __pyx_t_9 = PyMethod_GET_SELF(__pyx_t_8);
      if (likely(__pyx_t_9)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_8);
        __Pyx_INCREF(__pyx_t_9);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_8, function);
      }
    }
    if (!__pyx_t_9) {
      __pyx_t_6 = __Pyx_PyObject_CallOneArg(__pyx_t_8, __pyx_v_x); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1192, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_6);
    } else {
      __pyx_t_10 = PyTuple_New(1+1); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1192, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_10);
      __Pyx_GIVEREF(__pyx_t_9); PyTuple_SET_ITEM(__pyx_t_10, 0, __pyx_t_9); __pyx_t_9 = NULL;
      __Pyx_INCREF(__pyx_v_x);
      __Pyx_GIVEREF(__pyx_v_x);
      PyTuple_SET_ITEM(__pyx_t_10, 0+1, __pyx_v_x);
      __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_8, __pyx_t_10, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1192, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_6);
      __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
    }
    __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
    if (unlikely(__Pyx_ListComp_Append(__pyx_t_1, (PyObject*)__pyx_t_6))) __PYX_ERR(0, 1192, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  }
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_dup_test = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":1193
 *     if '^' in k2_hap:   return 'FALSE'  #check if inv included
 *     dup_test=[k2_hap.count(x) for x in k2_hap]
 *     if max(dup_test)>1:     return 'FALSE'  #check if dup included             # <<<<<<<<<<<<<<
 *     if len(k2_hap)==1 and len(k1_hap)>1:    return letter_subgroup(''.join([i for i in k1_hap if not i in k2_hap]))   #del
 *     pos_compare=[ord(k2_hap[i+1])-ord(k2_hap[i]) for i in range(len(k2_hap)-1)]
 */
  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1193, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_INCREF(__pyx_v_dup_test);
  __Pyx_GIVEREF(__pyx_v_dup_test);
  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_dup_test);
  __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_max, __pyx_t_1, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1193, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = PyObject_RichCompare(__pyx_t_3, __pyx_int_1, Py_GT); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1193, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_7 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_7 < 0)) __PYX_ERR(0, 1193, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  if (__pyx_t_7) {
    __Pyx_XDECREF(__pyx_r);
    __Pyx_INCREF(__pyx_n_s_FALSE);
    __pyx_r = __pyx_n_s_FALSE;
    goto __pyx_L0;
  }

  /* "vapor_vali/Simple_function.pyx":1194
 *     dup_test=[k2_hap.count(x) for x in k2_hap]
 *     if max(dup_test)>1:     return 'FALSE'  #check if dup included
 *     if len(k2_hap)==1 and len(k1_hap)>1:    return letter_subgroup(''.join([i for i in k1_hap if not i in k2_hap]))   #del             # <<<<<<<<<<<<<<
 *     pos_compare=[ord(k2_hap[i+1])-ord(k2_hap[i]) for i in range(len(k2_hap)-1)]
 *     if min(pos_compare)<1: return 'FALSE'
 */
  __pyx_t_4 = PyObject_Length(__pyx_v_k2_hap); if (unlikely(__pyx_t_4 == -1)) __PYX_ERR(0, 1194, __pyx_L1_error)
  __pyx_t_2 = ((__pyx_t_4 == 1) != 0);
  if (__pyx_t_2) {
  } else {
    __pyx_t_7 = __pyx_t_2;
    goto __pyx_L12_bool_binop_done;
  }
  __pyx_t_4 = PyObject_Length(__pyx_v_k1_hap); if (unlikely(__pyx_t_4 == -1)) __PYX_ERR(0, 1194, __pyx_L1_error)
  __pyx_t_2 = ((__pyx_t_4 > 1) != 0);
  __pyx_t_7 = __pyx_t_2;
  __pyx_L12_bool_binop_done:;
  if (__pyx_t_7) {
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_letter_subgroup); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1194, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_6 = PyList_New(0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1194, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    if (likely(PyList_CheckExact(__pyx_v_k1_hap)) || PyTuple_CheckExact(__pyx_v_k1_hap)) {
      __pyx_t_8 = __pyx_v_k1_hap; __Pyx_INCREF(__pyx_t_8); __pyx_t_4 = 0;
      __pyx_t_5 = NULL;
    } else {
      __pyx_t_4 = -1; __pyx_t_8 = PyObject_GetIter(__pyx_v_k1_hap); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1194, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_8);
      __pyx_t_5 = Py_TYPE(__pyx_t_8)->tp_iternext; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1194, __pyx_L1_error)
    }
    for (;;) {
      if (likely(!__pyx_t_5)) {
        if (likely(PyList_CheckExact(__pyx_t_8))) {
          if (__pyx_t_4 >= PyList_GET_SIZE(__pyx_t_8)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_10 = PyList_GET_ITEM(__pyx_t_8, __pyx_t_4); __Pyx_INCREF(__pyx_t_10); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 1194, __pyx_L1_error)
          #else
          __pyx_t_10 = PySequence_ITEM(__pyx_t_8, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1194, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_10);
          #endif
        } else {
          if (__pyx_t_4 >= PyTuple_GET_SIZE(__pyx_t_8)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_10 = PyTuple_GET_ITEM(__pyx_t_8, __pyx_t_4); __Pyx_INCREF(__pyx_t_10); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 1194, __pyx_L1_error)
          #else
          __pyx_t_10 = PySequence_ITEM(__pyx_t_8, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1194, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_10);
          #endif
        }
      } else {
        __pyx_t_10 = __pyx_t_5(__pyx_t_8);
        if (unlikely(!__pyx_t_10)) {
          PyObject* exc_type = PyErr_Occurred();
          if (exc_type) {
            if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
            else __PYX_ERR(0, 1194, __pyx_L1_error)
          }
          break;
        }
        __Pyx_GOTREF(__pyx_t_10);
      }
      __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_10);
      __pyx_t_10 = 0;
      __pyx_t_7 = (__Pyx_PySequence_ContainsTF(__pyx_v_i, __pyx_v_k2_hap, Py_NE)); if (unlikely(__pyx_t_7 < 0)) __PYX_ERR(0, 1194, __pyx_L1_error)
      __pyx_t_2 = (__pyx_t_7 != 0);
      if (__pyx_t_2) {
        if (unlikely(__Pyx_ListComp_Append(__pyx_t_6, (PyObject*)__pyx_v_i))) __PYX_ERR(0, 1194, __pyx_L1_error)
      }
    }
    __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
    __pyx_t_8 = __Pyx_PyString_Join(__pyx_kp_s__24, __pyx_t_6); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1194, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_8);
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_3))) {
      __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_3);
      if (likely(__pyx_t_6)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
        __Pyx_INCREF(__pyx_t_6);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_3, function);
      }
    }
    if (!__pyx_t_6) {
      __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_8); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1194, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
      __Pyx_GOTREF(__pyx_t_1);
    } else {
      __pyx_t_10 = PyTuple_New(1+1); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1194, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_10);
      __Pyx_GIVEREF(__pyx_t_6); PyTuple_SET_ITEM(__pyx_t_10, 0, __pyx_t_6); __pyx_t_6 = NULL;
      __Pyx_GIVEREF(__pyx_t_8);
      PyTuple_SET_ITEM(__pyx_t_10, 0+1, __pyx_t_8);
      __pyx_t_8 = 0;
      __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_10, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1194, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
    }
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;
  }

  /* "vapor_vali/Simple_function.pyx":1195
 *     if max(dup_test)>1:     return 'FALSE'  #check if dup included
 *     if len(k2_hap)==1 and len(k1_hap)>1:    return letter_subgroup(''.join([i for i in k1_hap if not i in k2_hap]))   #del
 *     pos_compare=[ord(k2_hap[i+1])-ord(k2_hap[i]) for i in range(len(k2_hap)-1)]             # <<<<<<<<<<<<<<
 *     if min(pos_compare)<1: return 'FALSE'
 *     return letter_subgroup(''.join([i for i in k1_hap if not i in k2_hap]))
 */
  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1195, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_4 = PyObject_Length(__pyx_v_k2_hap); if (unlikely(__pyx_t_4 == -1)) __PYX_ERR(0, 1195, __pyx_L1_error)
  __pyx_t_3 = PyInt_FromSsize_t((__pyx_t_4 - 1)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1195, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_10 = PyTuple_New(1); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1195, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_10);
  __Pyx_GIVEREF(__pyx_t_3);
  PyTuple_SET_ITEM(__pyx_t_10, 0, __pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_t_10, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1195, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
  if (likely(PyList_CheckExact(__pyx_t_3)) || PyTuple_CheckExact(__pyx_t_3)) {
    __pyx_t_10 = __pyx_t_3; __Pyx_INCREF(__pyx_t_10); __pyx_t_4 = 0;
    __pyx_t_5 = NULL;
  } else {
    __pyx_t_4 = -1; __pyx_t_10 = PyObject_GetIter(__pyx_t_3); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1195, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_10);
    __pyx_t_5 = Py_TYPE(__pyx_t_10)->tp_iternext; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1195, __pyx_L1_error)
  }
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  for (;;) {
    if (likely(!__pyx_t_5)) {
      if (likely(PyList_CheckExact(__pyx_t_10))) {
        if (__pyx_t_4 >= PyList_GET_SIZE(__pyx_t_10)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_3 = PyList_GET_ITEM(__pyx_t_10, __pyx_t_4); __Pyx_INCREF(__pyx_t_3); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 1195, __pyx_L1_error)
        #else
        __pyx_t_3 = PySequence_ITEM(__pyx_t_10, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1195, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_3);
        #endif
      } else {
        if (__pyx_t_4 >= PyTuple_GET_SIZE(__pyx_t_10)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_3 = PyTuple_GET_ITEM(__pyx_t_10, __pyx_t_4); __Pyx_INCREF(__pyx_t_3); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 1195, __pyx_L1_error)
        #else
        __pyx_t_3 = PySequence_ITEM(__pyx_t_10, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1195, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_3);
        #endif
      }
    } else {
      __pyx_t_3 = __pyx_t_5(__pyx_t_10);
      if (unlikely(!__pyx_t_3)) {
        PyObject* exc_type = PyErr_Occurred();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
          else __PYX_ERR(0, 1195, __pyx_L1_error)
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_3);
    }
    __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_3);
    __pyx_t_3 = 0;
    __pyx_t_3 = __Pyx_PyInt_AddObjC(__pyx_v_i, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1195, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_8 = PyObject_GetItem(__pyx_v_k2_hap, __pyx_t_3); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1195, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_8);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_11 = __Pyx_PyObject_Ord(__pyx_t_8); if (unlikely(__pyx_t_11 == (long)(Py_UCS4)-1)) __PYX_ERR(0, 1195, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
    __pyx_t_8 = PyObject_GetItem(__pyx_v_k2_hap, __pyx_v_i); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1195, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_8);
    __pyx_t_12 = __Pyx_PyObject_Ord(__pyx_t_8); if (unlikely(__pyx_t_12 == (long)(Py_UCS4)-1)) __PYX_ERR(0, 1195, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
    __pyx_t_8 = __Pyx_PyInt_From_long((__pyx_t_11 - __pyx_t_12)); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1195, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_8);
    if (unlikely(__Pyx_ListComp_Append(__pyx_t_1, (PyObject*)__pyx_t_8))) __PYX_ERR(0, 1195, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
  }
  __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
  __pyx_v_pos_compare = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":1196
 *     if len(k2_hap)==1 and len(k1_hap)>1:    return letter_subgroup(''.join([i for i in k1_hap if not i in k2_hap]))   #del
 *     pos_compare=[ord(k2_hap[i+1])-ord(k2_hap[i]) for i in range(len(k2_hap)-1)]
 *     if min(pos_compare)<1: return 'FALSE'             # <<<<<<<<<<<<<<
 *     return letter_subgroup(''.join([i for i in k1_hap if not i in k2_hap]))
 * 
 */
  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1196, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_INCREF(__pyx_v_pos_compare);
  __Pyx_GIVEREF(__pyx_v_pos_compare);
  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_pos_compare);
  __pyx_t_10 = __Pyx_PyObject_Call(__pyx_builtin_min, __pyx_t_1, NULL); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1196, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_10);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = PyObject_RichCompare(__pyx_t_10, __pyx_int_1, Py_LT); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1196, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 1196, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  if (__pyx_t_2) {
    __Pyx_XDECREF(__pyx_r);
    __Pyx_INCREF(__pyx_n_s_FALSE);
    __pyx_r = __pyx_n_s_FALSE;
    goto __pyx_L0;
  }

  /* "vapor_vali/Simple_function.pyx":1197
 *     pos_compare=[ord(k2_hap[i+1])-ord(k2_hap[i]) for i in range(len(k2_hap)-1)]
 *     if min(pos_compare)<1: return 'FALSE'
 *     return letter_subgroup(''.join([i for i in k1_hap if not i in k2_hap]))             # <<<<<<<<<<<<<<
 * 
 * def simple_inv_diploid_decide(k1,k2):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_10 = __Pyx_GetModuleGlobalName(__pyx_n_s_letter_subgroup); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1197, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_10);
  __pyx_t_8 = PyList_New(0); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1197, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_8);
  if (likely(PyList_CheckExact(__pyx_v_k1_hap)) || PyTuple_CheckExact(__pyx_v_k1_hap)) {
    __pyx_t_3 = __pyx_v_k1_hap; __Pyx_INCREF(__pyx_t_3); __pyx_t_4 = 0;
    __pyx_t_5 = NULL;
  } else {
    __pyx_t_4 = -1; __pyx_t_3 = PyObject_GetIter(__pyx_v_k1_hap); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1197, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_5 = Py_TYPE(__pyx_t_3)->tp_iternext; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1197, __pyx_L1_error)
  }
  for (;;) {
    if (likely(!__pyx_t_5)) {
      if (likely(PyList_CheckExact(__pyx_t_3))) {
        if (__pyx_t_4 >= PyList_GET_SIZE(__pyx_t_3)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_6 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_4); __Pyx_INCREF(__pyx_t_6); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 1197, __pyx_L1_error)
        #else
        __pyx_t_6 = PySequence_ITEM(__pyx_t_3, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1197, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_6);
        #endif
      } else {
        if (__pyx_t_4 >= PyTuple_GET_SIZE(__pyx_t_3)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_6 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_4); __Pyx_INCREF(__pyx_t_6); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 1197, __pyx_L1_error)
        #else
        __pyx_t_6 = PySequence_ITEM(__pyx_t_3, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1197, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_6);
        #endif
      }
    } else {
      __pyx_t_6 = __pyx_t_5(__pyx_t_3);
      if (unlikely(!__pyx_t_6)) {
        PyObject* exc_type = PyErr_Occurred();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
          else __PYX_ERR(0, 1197, __pyx_L1_error)
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_6);
    }
    __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_6);
    __pyx_t_6 = 0;
    __pyx_t_2 = (__Pyx_PySequence_ContainsTF(__pyx_v_i, __pyx_v_k2_hap, Py_NE)); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 1197, __pyx_L1_error)
    __pyx_t_7 = (__pyx_t_2 != 0);
    if (__pyx_t_7) {
      if (unlikely(__Pyx_ListComp_Append(__pyx_t_8, (PyObject*)__pyx_v_i))) __PYX_ERR(0, 1197, __pyx_L1_error)
    }
  }
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = __Pyx_PyString_Join(__pyx_kp_s__24, __pyx_t_8); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1197, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
  __pyx_t_8 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_10))) {
    __pyx_t_8 = PyMethod_GET_SELF(__pyx_t_10);
    if (likely(__pyx_t_8)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_10);
      __Pyx_INCREF(__pyx_t_8);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_10, function);
    }
  }
  if (!__pyx_t_8) {
    __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_10, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1197, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __Pyx_GOTREF(__pyx_t_1);
  } else {
    __pyx_t_6 = PyTuple_New(1+1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1197, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __Pyx_GIVEREF(__pyx_t_8); PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_8); __pyx_t_8 = NULL;
    __Pyx_GIVEREF(__pyx_t_3);
    PyTuple_SET_ITEM(__pyx_t_6, 0+1, __pyx_t_3);
    __pyx_t_3 = 0;
    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_10, __pyx_t_6, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1197, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  }
  __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* "vapor_vali/Simple_function.pyx":1187
 *     return out
 * 
 * def simple_del_haploid_decide(k1_hap,k2_hap):             # <<<<<<<<<<<<<<
 *     #eg of k1_hap='ab'  ;    eg of k2_hap='b'
 *     if k1_hap==k2_hap: return 'FALSE'   #no alt
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_XDECREF(__pyx_t_8);
  __Pyx_XDECREF(__pyx_t_9);
  __Pyx_XDECREF(__pyx_t_10);
  __Pyx_AddTraceback("vapor_vali.Simple_function.simple_del_haploid_decide", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_dup_test);
  __Pyx_XDECREF(__pyx_v_pos_compare);
  __Pyx_XDECREF(__pyx_v_i);
  __Pyx_XDECREF(__pyx_v_x);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "vapor_vali/Simple_function.pyx":1199
 *     return letter_subgroup(''.join([i for i in k1_hap if not i in k2_hap]))
 * 
 * def simple_inv_diploid_decide(k1,k2):             # <<<<<<<<<<<<<<
 *     #eg of k1='ab/ab'   ; eg of k2='ab^/ab'
 *     k2_haps=k2.split('/')
 */

/* Python wrapper */
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_169simple_inv_diploid_decide(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_10vapor_vali_15Simple_function_169simple_inv_diploid_decide = {"simple_inv_diploid_decide", (PyCFunction)__pyx_pw_10vapor_vali_15Simple_function_169simple_inv_diploid_decide, METH_VARARGS|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_169simple_inv_diploid_decide(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_k1 = 0;
  PyObject *__pyx_v_k2 = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("simple_inv_diploid_decide (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_k1,&__pyx_n_s_k2,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_k1)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_k2)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("simple_inv_diploid_decide", 1, 2, 2, 1); __PYX_ERR(0, 1199, __pyx_L3_error)
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "simple_inv_diploid_decide") < 0)) __PYX_ERR(0, 1199, __pyx_L3_error)
      }
    } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
    }
    __pyx_v_k1 = values[0];
    __pyx_v_k2 = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("simple_inv_diploid_decide", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1199, __pyx_L3_error)
  __pyx_L3_error:;
  __Pyx_AddTraceback("vapor_vali.Simple_function.simple_inv_diploid_decide", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_10vapor_vali_15Simple_function_168simple_inv_diploid_decide(__pyx_self, __pyx_v_k1, __pyx_v_k2);

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10vapor_vali_15Simple_function_168simple_inv_diploid_decide(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_k1, PyObject *__pyx_v_k2) {
  PyObject *__pyx_v_k2_haps = NULL;
  PyObject *__pyx_v_k1_hap = NULL;
  PyObject *__pyx_v_out = NULL;
  PyObject *__pyx_v_x = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  Py_ssize_t __pyx_t_3;
  PyObject *(*__pyx_t_4)(PyObject *);
  int __pyx_t_5;
  int __pyx_t_6;
  PyObject *__pyx_t_7 = NULL;
  PyObject *__pyx_t_8 = NULL;
  Py_ssize_t __pyx_t_9;
  PyObject *__pyx_t_10 = NULL;
  __Pyx_RefNannySetupContext("simple_inv_diploid_decide", 0);

  /* "vapor_vali/Simple_function.pyx":1201
 * def simple_inv_diploid_decide(k1,k2):
 *     #eg of k1='ab/ab'   ; eg of k2='ab^/ab'
 *     k2_haps=k2.split('/')             # <<<<<<<<<<<<<<
 *     k1_hap=k1.split('/')[0]
 *     out=[]
 */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_k2, __pyx_n_s_split); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1201, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_tuple__89, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1201, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_k2_haps = __pyx_t_2;
  __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":1202
 *     #eg of k1='ab/ab'   ; eg of k2='ab^/ab'
 *     k2_haps=k2.split('/')
 *     k1_hap=k1.split('/')[0]             # <<<<<<<<<<<<<<
 *     out=[]
 *     for x in k2_haps:
 */
  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_k1, __pyx_n_s_split); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1202, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_tuple__90, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1202, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = __Pyx_GetItemInt(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1202, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_k1_hap = __pyx_t_2;
  __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":1203
 *     k2_haps=k2.split('/')
 *     k1_hap=k1.split('/')[0]
 *     out=[]             # <<<<<<<<<<<<<<
 *     for x in k2_haps:
 *         if x==k1_hap: out.append('NA')
 */
  __pyx_t_2 = PyList_New(0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1203, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_v_out = ((PyObject*)__pyx_t_2);
  __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":1204
 *     k1_hap=k1.split('/')[0]
 *     out=[]
 *     for x in k2_haps:             # <<<<<<<<<<<<<<
 *         if x==k1_hap: out.append('NA')
 *         else:
 */
  if (likely(PyList_CheckExact(__pyx_v_k2_haps)) || PyTuple_CheckExact(__pyx_v_k2_haps)) {
    __pyx_t_2 = __pyx_v_k2_haps; __Pyx_INCREF(__pyx_t_2); __pyx_t_3 = 0;
    __pyx_t_4 = NULL;
  } else {
    __pyx_t_3 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_v_k2_haps); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1204, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_4 = Py_TYPE(__pyx_t_2)->tp_iternext; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1204, __pyx_L1_error)
  }
  for (;;) {
    if (likely(!__pyx_t_4)) {
      if (likely(PyList_CheckExact(__pyx_t_2))) {
        if (__pyx_t_3 >= PyList_GET_SIZE(__pyx_t_2)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_1 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_3); __Pyx_INCREF(__pyx_t_1); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 1204, __pyx_L1_error)
        #else
        __pyx_t_1 = PySequence_ITEM(__pyx_t_2, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1204, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        #endif
      } else {
        if (__pyx_t_3 >= PyTuple_GET_SIZE(__pyx_t_2)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_3); __Pyx_INCREF(__pyx_t_1); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 1204, __pyx_L1_error)
        #else
        __pyx_t_1 = PySequence_ITEM(__pyx_t_2, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1204, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        #endif
      }
    } else {
      __pyx_t_1 = __pyx_t_4(__pyx_t_2);
      if (unlikely(!__pyx_t_1)) {
        PyObject* exc_type = PyErr_Occurred();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
          else __PYX_ERR(0, 1204, __pyx_L1_error)
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_1);
    }
    __Pyx_XDECREF_SET(__pyx_v_x, __pyx_t_1);
    __pyx_t_1 = 0;

    /* "vapor_vali/Simple_function.pyx":1205
 *     out=[]
 *     for x in k2_haps:
 *         if x==k1_hap: out.append('NA')             # <<<<<<<<<<<<<<
 *         else:
 *             out.append(simple_inv_haploid_decide(k1_hap,x))
 */
    __pyx_t_1 = PyObject_RichCompare(__pyx_v_x, __pyx_v_k1_hap, Py_EQ); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1205, __pyx_L1_error)
    __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 1205, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    if (__pyx_t_5) {
      __pyx_t_6 = __Pyx_PyList_Append(__pyx_v_out, __pyx_n_s_NA); if (unlikely(__pyx_t_6 == -1)) __PYX_ERR(0, 1205, __pyx_L1_error)
      goto __pyx_L5;
    }

    /* "vapor_vali/Simple_function.pyx":1207
 *         if x==k1_hap: out.append('NA')
 *         else:
 *             out.append(simple_inv_haploid_decide(k1_hap,x))             # <<<<<<<<<<<<<<
 *     return out
 * 
 */
    /*else*/ {
      __pyx_t_7 = __Pyx_GetModuleGlobalName(__pyx_n_s_simple_inv_haploid_decide); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1207, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_7);
      __pyx_t_8 = NULL;
      __pyx_t_9 = 0;
      if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_7))) {
        __pyx_t_8 = PyMethod_GET_SELF(__pyx_t_7);
        if (likely(__pyx_t_8)) {
          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_7);
          __Pyx_INCREF(__pyx_t_8);
          __Pyx_INCREF(function);
          __Pyx_DECREF_SET(__pyx_t_7, function);
          __pyx_t_9 = 1;
        }
      }
      __pyx_t_10 = PyTuple_New(2+__pyx_t_9); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1207, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_10);
      if (__pyx_t_8) {
        __Pyx_GIVEREF(__pyx_t_8); PyTuple_SET_ITEM(__pyx_t_10, 0, __pyx_t_8); __pyx_t_8 = NULL;
      }
      __Pyx_INCREF(__pyx_v_k1_hap);
      __Pyx_GIVEREF(__pyx_v_k1_hap);
      PyTuple_SET_ITEM(__pyx_t_10, 0+__pyx_t_9, __pyx_v_k1_hap);
      __Pyx_INCREF(__pyx_v_x);
      __Pyx_GIVEREF(__pyx_v_x);
      PyTuple_SET_ITEM(__pyx_t_10, 1+__pyx_t_9, __pyx_v_x);
      __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_7, __pyx_t_10, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1207, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
      __pyx_t_6 = __Pyx_PyList_Append(__pyx_v_out, __pyx_t_1); if (unlikely(__pyx_t_6 == -1)) __PYX_ERR(0, 1207, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    }
    __pyx_L5:;

    /* "vapor_vali/Simple_function.pyx":1204
 *     k1_hap=k1.split('/')[0]
 *     out=[]
 *     for x in k2_haps:             # <<<<<<<<<<<<<<
 *         if x==k1_hap: out.append('NA')
 *         else:
 */
  }
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":1208
 *         else:
 *             out.append(simple_inv_haploid_decide(k1_hap,x))
 *     return out             # <<<<<<<<<<<<<<
 * 
 * def simple_inv_haploid_decide(k1_hap,k2_hap):
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_out);
  __pyx_r = __pyx_v_out;
  goto __pyx_L0;

  /* "vapor_vali/Simple_function.pyx":1199
 *     return letter_subgroup(''.join([i for i in k1_hap if not i in k2_hap]))
 * 
 * def simple_inv_diploid_decide(k1,k2):             # <<<<<<<<<<<<<<
 *     #eg of k1='ab/ab'   ; eg of k2='ab^/ab'
 *     k2_haps=k2.split('/')
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_7);
  __Pyx_XDECREF(__pyx_t_8);
  __Pyx_XDECREF(__pyx_t_10);
  __Pyx_AddTraceback("vapor_vali.Simple_function.simple_inv_diploid_decide", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_k2_haps);
  __Pyx_XDECREF(__pyx_v_k1_hap);
  __Pyx_XDECREF(__pyx_v_out);
  __Pyx_XDECREF(__pyx_v_x);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "vapor_vali/Simple_function.pyx":1210
 *     return out
 * 
 * def simple_inv_haploid_decide(k1_hap,k2_hap):             # <<<<<<<<<<<<<<
 *     #eg of k1_hap='ab'  ;    eg of k2_hap='b^a^'
 *     if not '^' in k2_hap:   return 'FALSE'      #if not block inverted
 */

/* Python wrapper */
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_171simple_inv_haploid_decide(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_10vapor_vali_15Simple_function_171simple_inv_haploid_decide = {"simple_inv_haploid_decide", (PyCFunction)__pyx_pw_10vapor_vali_15Simple_function_171simple_inv_haploid_decide, METH_VARARGS|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_171simple_inv_haploid_decide(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_k1_hap = 0;
  PyObject *__pyx_v_k2_hap = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("simple_inv_haploid_decide (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_k1_hap,&__pyx_n_s_k2_hap,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_k1_hap)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_k2_hap)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("simple_inv_haploid_decide", 1, 2, 2, 1); __PYX_ERR(0, 1210, __pyx_L3_error)
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "simple_inv_haploid_decide") < 0)) __PYX_ERR(0, 1210, __pyx_L3_error)
      }
    } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
    }
    __pyx_v_k1_hap = values[0];
    __pyx_v_k2_hap = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("simple_inv_haploid_decide", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1210, __pyx_L3_error)
  __pyx_L3_error:;
  __Pyx_AddTraceback("vapor_vali.Simple_function.simple_inv_haploid_decide", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_10vapor_vali_15Simple_function_170simple_inv_haploid_decide(__pyx_self, __pyx_v_k1_hap, __pyx_v_k2_hap);

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10vapor_vali_15Simple_function_170simple_inv_haploid_decide(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_k1_hap, PyObject *__pyx_v_k2_hap) {
  PyObject *__pyx_v_dup_test = NULL;
  PyObject *__pyx_v_inverted_sv_new = NULL;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  int __pyx_t_2;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  Py_ssize_t __pyx_t_5;
  PyObject *(*__pyx_t_6)(PyObject *);
  PyObject *__pyx_t_7 = NULL;
  PyObject *__pyx_t_8 = NULL;
  PyObject *__pyx_t_9 = NULL;
  PyObject *__pyx_t_10 = NULL;
  __Pyx_RefNannySetupContext("simple_inv_haploid_decide", 0);

  /* "vapor_vali/Simple_function.pyx":1212
 * def simple_inv_haploid_decide(k1_hap,k2_hap):
 *     #eg of k1_hap='ab'  ;    eg of k2_hap='b^a^'
 *     if not '^' in k2_hap:   return 'FALSE'      #if not block inverted             # <<<<<<<<<<<<<<
 *     if len(k2_hap.replace('^',''))==1 and len(k1_hap)==1:   return [i for i in k1_hap]
 *     dup_test=[k2_hap.count(i) for i in k2_hap if not i=='^']
 */
  __pyx_t_1 = (__Pyx_PySequence_ContainsTF(__pyx_kp_s__7, __pyx_v_k2_hap, Py_NE)); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(0, 1212, __pyx_L1_error)
  __pyx_t_2 = (__pyx_t_1 != 0);
  if (__pyx_t_2) {
    __Pyx_XDECREF(__pyx_r);
    __Pyx_INCREF(__pyx_n_s_FALSE);
    __pyx_r = __pyx_n_s_FALSE;
    goto __pyx_L0;
  }

  /* "vapor_vali/Simple_function.pyx":1213
 *     #eg of k1_hap='ab'  ;    eg of k2_hap='b^a^'
 *     if not '^' in k2_hap:   return 'FALSE'      #if not block inverted
 *     if len(k2_hap.replace('^',''))==1 and len(k1_hap)==1:   return [i for i in k1_hap]             # <<<<<<<<<<<<<<
 *     dup_test=[k2_hap.count(i) for i in k2_hap if not i=='^']
 *     if max(dup_test)>1: return 'FALSE'
 */
  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_k2_hap, __pyx_n_s_replace); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1213, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_tuple__91, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1213, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_5 = PyObject_Length(__pyx_t_4); if (unlikely(__pyx_t_5 == -1)) __PYX_ERR(0, 1213, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_1 = ((__pyx_t_5 == 1) != 0);
  if (__pyx_t_1) {
  } else {
    __pyx_t_2 = __pyx_t_1;
    goto __pyx_L5_bool_binop_done;
  }
  __pyx_t_5 = PyObject_Length(__pyx_v_k1_hap); if (unlikely(__pyx_t_5 == -1)) __PYX_ERR(0, 1213, __pyx_L1_error)
  __pyx_t_1 = ((__pyx_t_5 == 1) != 0);
  __pyx_t_2 = __pyx_t_1;
  __pyx_L5_bool_binop_done:;
  if (__pyx_t_2) {
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_4 = PyList_New(0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1213, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    if (likely(PyList_CheckExact(__pyx_v_k1_hap)) || PyTuple_CheckExact(__pyx_v_k1_hap)) {
      __pyx_t_3 = __pyx_v_k1_hap; __Pyx_INCREF(__pyx_t_3); __pyx_t_5 = 0;
      __pyx_t_6 = NULL;
    } else {
      __pyx_t_5 = -1; __pyx_t_3 = PyObject_GetIter(__pyx_v_k1_hap); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1213, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __pyx_t_6 = Py_TYPE(__pyx_t_3)->tp_iternext; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1213, __pyx_L1_error)
    }
    for (;;) {
      if (likely(!__pyx_t_6)) {
        if (likely(PyList_CheckExact(__pyx_t_3))) {
          if (__pyx_t_5 >= PyList_GET_SIZE(__pyx_t_3)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_7 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_5); __Pyx_INCREF(__pyx_t_7); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 1213, __pyx_L1_error)
          #else
          __pyx_t_7 = PySequence_ITEM(__pyx_t_3, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1213, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_7);
          #endif
        } else {
          if (__pyx_t_5 >= PyTuple_GET_SIZE(__pyx_t_3)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_7 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_5); __Pyx_INCREF(__pyx_t_7); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 1213, __pyx_L1_error)
          #else
          __pyx_t_7 = PySequence_ITEM(__pyx_t_3, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1213, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_7);
          #endif
        }
      } else {
        __pyx_t_7 = __pyx_t_6(__pyx_t_3);
        if (unlikely(!__pyx_t_7)) {
          PyObject* exc_type = PyErr_Occurred();
          if (exc_type) {
            if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
            else __PYX_ERR(0, 1213, __pyx_L1_error)
          }
          break;
        }
        __Pyx_GOTREF(__pyx_t_7);
      }
      __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_7);
      __pyx_t_7 = 0;
      if (unlikely(__Pyx_ListComp_Append(__pyx_t_4, (PyObject*)__pyx_v_i))) __PYX_ERR(0, 1213, __pyx_L1_error)
    }
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_r = __pyx_t_4;
    __pyx_t_4 = 0;
    goto __pyx_L0;
  }

  /* "vapor_vali/Simple_function.pyx":1214
 *     if not '^' in k2_hap:   return 'FALSE'      #if not block inverted
 *     if len(k2_hap.replace('^',''))==1 and len(k1_hap)==1:   return [i for i in k1_hap]
 *     dup_test=[k2_hap.count(i) for i in k2_hap if not i=='^']             # <<<<<<<<<<<<<<
 *     if max(dup_test)>1: return 'FALSE'
 *     inverted_sv_new=letter_subgroup(k2_hap)
 */
  __pyx_t_4 = PyList_New(0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1214, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  if (likely(PyList_CheckExact(__pyx_v_k2_hap)) || PyTuple_CheckExact(__pyx_v_k2_hap)) {
    __pyx_t_3 = __pyx_v_k2_hap; __Pyx_INCREF(__pyx_t_3); __pyx_t_5 = 0;
    __pyx_t_6 = NULL;
  } else {
    __pyx_t_5 = -1; __pyx_t_3 = PyObject_GetIter(__pyx_v_k2_hap); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1214, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_6 = Py_TYPE(__pyx_t_3)->tp_iternext; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1214, __pyx_L1_error)
  }
  for (;;) {
    if (likely(!__pyx_t_6)) {
      if (likely(PyList_CheckExact(__pyx_t_3))) {
        if (__pyx_t_5 >= PyList_GET_SIZE(__pyx_t_3)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_7 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_5); __Pyx_INCREF(__pyx_t_7); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 1214, __pyx_L1_error)
        #else
        __pyx_t_7 = PySequence_ITEM(__pyx_t_3, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1214, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_7);
        #endif
      } else {
        if (__pyx_t_5 >= PyTuple_GET_SIZE(__pyx_t_3)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_7 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_5); __Pyx_INCREF(__pyx_t_7); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 1214, __pyx_L1_error)
        #else
        __pyx_t_7 = PySequence_ITEM(__pyx_t_3, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1214, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_7);
        #endif
      }
    } else {
      __pyx_t_7 = __pyx_t_6(__pyx_t_3);
      if (unlikely(!__pyx_t_7)) {
        PyObject* exc_type = PyErr_Occurred();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
          else __PYX_ERR(0, 1214, __pyx_L1_error)
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_7);
    }
    __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_7);
    __pyx_t_7 = 0;
    __pyx_t_2 = (__Pyx_PyString_Equals(__pyx_v_i, __pyx_kp_s__7, Py_EQ)); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 1214, __pyx_L1_error)
    __pyx_t_1 = ((!__pyx_t_2) != 0);
    if (__pyx_t_1) {
      __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_v_k2_hap, __pyx_n_s_count); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1214, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_8);
      __pyx_t_9 = NULL;
      if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_8))) {
        __pyx_t_9 = PyMethod_GET_SELF(__pyx_t_8);
        if (likely(__pyx_t_9)) {
          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_8);
          __Pyx_INCREF(__pyx_t_9);
          __Pyx_INCREF(function);
          __Pyx_DECREF_SET(__pyx_t_8, function);
        }
      }
      if (!__pyx_t_9) {
        __pyx_t_7 = __Pyx_PyObject_CallOneArg(__pyx_t_8, __pyx_v_i); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1214, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_7);
      } else {
        __pyx_t_10 = PyTuple_New(1+1); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1214, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_10);
        __Pyx_GIVEREF(__pyx_t_9); PyTuple_SET_ITEM(__pyx_t_10, 0, __pyx_t_9); __pyx_t_9 = NULL;
        __Pyx_INCREF(__pyx_v_i);
        __Pyx_GIVEREF(__pyx_v_i);
        PyTuple_SET_ITEM(__pyx_t_10, 0+1, __pyx_v_i);
        __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_8, __pyx_t_10, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1214, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_7);
        __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
      }
      __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
      if (unlikely(__Pyx_ListComp_Append(__pyx_t_4, (PyObject*)__pyx_t_7))) __PYX_ERR(0, 1214, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
    }
  }
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_dup_test = ((PyObject*)__pyx_t_4);
  __pyx_t_4 = 0;

  /* "vapor_vali/Simple_function.pyx":1215
 *     if len(k2_hap.replace('^',''))==1 and len(k1_hap)==1:   return [i for i in k1_hap]
 *     dup_test=[k2_hap.count(i) for i in k2_hap if not i=='^']
 *     if max(dup_test)>1: return 'FALSE'             # <<<<<<<<<<<<<<
 *     inverted_sv_new=letter_subgroup(k2_hap)
 *     if ''.join([i.replace('^','') for i in inverted_sv_new])==k1_hap: return [i[:-1] for i in inverted_sv_new if '^' in i]
 */
  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1215, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_INCREF(__pyx_v_dup_test);
  __Pyx_GIVEREF(__pyx_v_dup_test);
  PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_v_dup_test);
  __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_max, __pyx_t_4, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1215, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = PyObject_RichCompare(__pyx_t_3, __pyx_int_1, Py_GT); __Pyx_XGOTREF(__pyx_t_4); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1215, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_1 = __Pyx_PyObject_IsTrue(__pyx_t_4); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(0, 1215, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  if (__pyx_t_1) {
    __Pyx_XDECREF(__pyx_r);
    __Pyx_INCREF(__pyx_n_s_FALSE);
    __pyx_r = __pyx_n_s_FALSE;
    goto __pyx_L0;
  }

  /* "vapor_vali/Simple_function.pyx":1216
 *     dup_test=[k2_hap.count(i) for i in k2_hap if not i=='^']
 *     if max(dup_test)>1: return 'FALSE'
 *     inverted_sv_new=letter_subgroup(k2_hap)             # <<<<<<<<<<<<<<
 *     if ''.join([i.replace('^','') for i in inverted_sv_new])==k1_hap: return [i[:-1] for i in inverted_sv_new if '^' in i]
 *     else:   return 'FALSE'
 */
  __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_letter_subgroup); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1216, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_7 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_3))) {
    __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_3);
    if (likely(__pyx_t_7)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
      __Pyx_INCREF(__pyx_t_7);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_3, function);
    }
  }
  if (!__pyx_t_7) {
    __pyx_t_4 = __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_v_k2_hap); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1216, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
  } else {
    __pyx_t_8 = PyTuple_New(1+1); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1216, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_8);
    __Pyx_GIVEREF(__pyx_t_7); PyTuple_SET_ITEM(__pyx_t_8, 0, __pyx_t_7); __pyx_t_7 = NULL;
    __Pyx_INCREF(__pyx_v_k2_hap);
    __Pyx_GIVEREF(__pyx_v_k2_hap);
    PyTuple_SET_ITEM(__pyx_t_8, 0+1, __pyx_v_k2_hap);
    __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_8, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1216, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
  }
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_inverted_sv_new = __pyx_t_4;
  __pyx_t_4 = 0;

  /* "vapor_vali/Simple_function.pyx":1217
 *     if max(dup_test)>1: return 'FALSE'
 *     inverted_sv_new=letter_subgroup(k2_hap)
 *     if ''.join([i.replace('^','') for i in inverted_sv_new])==k1_hap: return [i[:-1] for i in inverted_sv_new if '^' in i]             # <<<<<<<<<<<<<<
 *     else:   return 'FALSE'
 * 
 */
  __pyx_t_4 = PyList_New(0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1217, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  if (likely(PyList_CheckExact(__pyx_v_inverted_sv_new)) || PyTuple_CheckExact(__pyx_v_inverted_sv_new)) {
    __pyx_t_3 = __pyx_v_inverted_sv_new; __Pyx_INCREF(__pyx_t_3); __pyx_t_5 = 0;
    __pyx_t_6 = NULL;
  } else {
    __pyx_t_5 = -1; __pyx_t_3 = PyObject_GetIter(__pyx_v_inverted_sv_new); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1217, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_6 = Py_TYPE(__pyx_t_3)->tp_iternext; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1217, __pyx_L1_error)
  }
  for (;;) {
    if (likely(!__pyx_t_6)) {
      if (likely(PyList_CheckExact(__pyx_t_3))) {
        if (__pyx_t_5 >= PyList_GET_SIZE(__pyx_t_3)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_8 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_5); __Pyx_INCREF(__pyx_t_8); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 1217, __pyx_L1_error)
        #else
        __pyx_t_8 = PySequence_ITEM(__pyx_t_3, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1217, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_8);
        #endif
      } else {
        if (__pyx_t_5 >= PyTuple_GET_SIZE(__pyx_t_3)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_8 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_5); __Pyx_INCREF(__pyx_t_8); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 1217, __pyx_L1_error)
        #else
        __pyx_t_8 = PySequence_ITEM(__pyx_t_3, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1217, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_8);
        #endif
      }
    } else {
      __pyx_t_8 = __pyx_t_6(__pyx_t_3);
      if (unlikely(!__pyx_t_8)) {
        PyObject* exc_type = PyErr_Occurred();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
          else __PYX_ERR(0, 1217, __pyx_L1_error)
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_8);
    }
    __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_8);
    __pyx_t_8 = 0;
    __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_v_i, __pyx_n_s_replace); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1217, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_8);
    __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_8, __pyx_tuple__92, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1217, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
    if (unlikely(__Pyx_ListComp_Append(__pyx_t_4, (PyObject*)__pyx_t_7))) __PYX_ERR(0, 1217, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
  }
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = __Pyx_PyString_Join(__pyx_kp_s__24, __pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1217, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_1 = (__Pyx_PyUnicode_Equals(__pyx_t_3, __pyx_v_k1_hap, Py_EQ)); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(0, 1217, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  if (__pyx_t_1) {
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_3 = PyList_New(0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1217, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    if (likely(PyList_CheckExact(__pyx_v_inverted_sv_new)) || PyTuple_CheckExact(__pyx_v_inverted_sv_new)) {
      __pyx_t_4 = __pyx_v_inverted_sv_new; __Pyx_INCREF(__pyx_t_4); __pyx_t_5 = 0;
      __pyx_t_6 = NULL;
    } else {
      __pyx_t_5 = -1; __pyx_t_4 = PyObject_GetIter(__pyx_v_inverted_sv_new); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1217, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_t_6 = Py_TYPE(__pyx_t_4)->tp_iternext; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1217, __pyx_L1_error)
    }
    for (;;) {
      if (likely(!__pyx_t_6)) {
        if (likely(PyList_CheckExact(__pyx_t_4))) {
          if (__pyx_t_5 >= PyList_GET_SIZE(__pyx_t_4)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_7 = PyList_GET_ITEM(__pyx_t_4, __pyx_t_5); __Pyx_INCREF(__pyx_t_7); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 1217, __pyx_L1_error)
          #else
          __pyx_t_7 = PySequence_ITEM(__pyx_t_4, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1217, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_7);
          #endif
        } else {
          if (__pyx_t_5 >= PyTuple_GET_SIZE(__pyx_t_4)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_7 = PyTuple_GET_ITEM(__pyx_t_4, __pyx_t_5); __Pyx_INCREF(__pyx_t_7); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 1217, __pyx_L1_error)
          #else
          __pyx_t_7 = PySequence_ITEM(__pyx_t_4, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1217, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_7);
          #endif
        }
      } else {
        __pyx_t_7 = __pyx_t_6(__pyx_t_4);
        if (unlikely(!__pyx_t_7)) {
          PyObject* exc_type = PyErr_Occurred();
          if (exc_type) {
            if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
            else __PYX_ERR(0, 1217, __pyx_L1_error)
          }
          break;
        }
        __Pyx_GOTREF(__pyx_t_7);
      }
      __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_7);
      __pyx_t_7 = 0;
      __pyx_t_1 = (__Pyx_PySequence_ContainsTF(__pyx_kp_s__7, __pyx_v_i, Py_EQ)); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(0, 1217, __pyx_L1_error)
      __pyx_t_2 = (__pyx_t_1 != 0);
      if (__pyx_t_2) {
        __pyx_t_7 = __Pyx_PyObject_GetSlice(__pyx_v_i, 0, -1L, NULL, NULL, &__pyx_slice__93, 0, 1, 1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1217, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_7);
        if (unlikely(__Pyx_ListComp_Append(__pyx_t_3, (PyObject*)__pyx_t_7))) __PYX_ERR(0, 1217, __pyx_L1_error)
        __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
      }
    }
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_r = __pyx_t_3;
    __pyx_t_3 = 0;
    goto __pyx_L0;
  }

  /* "vapor_vali/Simple_function.pyx":1218
 *     inverted_sv_new=letter_subgroup(k2_hap)
 *     if ''.join([i.replace('^','') for i in inverted_sv_new])==k1_hap: return [i[:-1] for i in inverted_sv_new if '^' in i]
 *     else:   return 'FALSE'             # <<<<<<<<<<<<<<
 * 
 * def simple_tandup_diploid_decide(k1,k2):
 */
  /*else*/ {
    __Pyx_XDECREF(__pyx_r);
    __Pyx_INCREF(__pyx_n_s_FALSE);
    __pyx_r = __pyx_n_s_FALSE;
    goto __pyx_L0;
  }

  /* "vapor_vali/Simple_function.pyx":1210
 *     return out
 * 
 * def simple_inv_haploid_decide(k1_hap,k2_hap):             # <<<<<<<<<<<<<<
 *     #eg of k1_hap='ab'  ;    eg of k2_hap='b^a^'
 *     if not '^' in k2_hap:   return 'FALSE'      #if not block inverted
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_7);
  __Pyx_XDECREF(__pyx_t_8);
  __Pyx_XDECREF(__pyx_t_9);
  __Pyx_XDECREF(__pyx_t_10);
  __Pyx_AddTraceback("vapor_vali.Simple_function.simple_inv_haploid_decide", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_dup_test);
  __Pyx_XDECREF(__pyx_v_inverted_sv_new);
  __Pyx_XDECREF(__pyx_v_i);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "vapor_vali/Simple_function.pyx":1220
 *     else:   return 'FALSE'
 * 
 * def simple_tandup_diploid_decide(k1,k2):             # <<<<<<<<<<<<<<
 *     #eg of k1='ab/ab'   ; eg of k2='abb/ab'
 *     k2_haps=k2.split('/')
 */

/* Python wrapper */
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_173simple_tandup_diploid_decide(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_10vapor_vali_15Simple_function_173simple_tandup_diploid_decide = {"simple_tandup_diploid_decide", (PyCFunction)__pyx_pw_10vapor_vali_15Simple_function_173simple_tandup_diploid_decide, METH_VARARGS|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_173simple_tandup_diploid_decide(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_k1 = 0;
  PyObject *__pyx_v_k2 = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("simple_tandup_diploid_decide (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_k1,&__pyx_n_s_k2,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_k1)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_k2)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("simple_tandup_diploid_decide", 1, 2, 2, 1); __PYX_ERR(0, 1220, __pyx_L3_error)
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "simple_tandup_diploid_decide") < 0)) __PYX_ERR(0, 1220, __pyx_L3_error)
      }
    } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
    }
    __pyx_v_k1 = values[0];
    __pyx_v_k2 = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("simple_tandup_diploid_decide", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1220, __pyx_L3_error)
  __pyx_L3_error:;
  __Pyx_AddTraceback("vapor_vali.Simple_function.simple_tandup_diploid_decide", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_10vapor_vali_15Simple_function_172simple_tandup_diploid_decide(__pyx_self, __pyx_v_k1, __pyx_v_k2);

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10vapor_vali_15Simple_function_172simple_tandup_diploid_decide(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_k1, PyObject *__pyx_v_k2) {
  PyObject *__pyx_v_k2_haps = NULL;
  PyObject *__pyx_v_k1_hap = NULL;
  PyObject *__pyx_v_out = NULL;
  PyObject *__pyx_v_x = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  Py_ssize_t __pyx_t_3;
  PyObject *(*__pyx_t_4)(PyObject *);
  int __pyx_t_5;
  int __pyx_t_6;
  PyObject *__pyx_t_7 = NULL;
  PyObject *__pyx_t_8 = NULL;
  Py_ssize_t __pyx_t_9;
  PyObject *__pyx_t_10 = NULL;
  __Pyx_RefNannySetupContext("simple_tandup_diploid_decide", 0);

  /* "vapor_vali/Simple_function.pyx":1222
 * def simple_tandup_diploid_decide(k1,k2):
 *     #eg of k1='ab/ab'   ; eg of k2='abb/ab'
 *     k2_haps=k2.split('/')             # <<<<<<<<<<<<<<
 *     k1_hap=k1.split('/')[0]
 *     out=[]
 */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_k2, __pyx_n_s_split); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1222, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_tuple__94, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1222, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_k2_haps = __pyx_t_2;
  __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":1223
 *     #eg of k1='ab/ab'   ; eg of k2='abb/ab'
 *     k2_haps=k2.split('/')
 *     k1_hap=k1.split('/')[0]             # <<<<<<<<<<<<<<
 *     out=[]
 *     for x in k2_haps:
 */
  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_k1, __pyx_n_s_split); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1223, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_tuple__95, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1223, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = __Pyx_GetItemInt(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1223, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_k1_hap = __pyx_t_2;
  __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":1224
 *     k2_haps=k2.split('/')
 *     k1_hap=k1.split('/')[0]
 *     out=[]             # <<<<<<<<<<<<<<
 *     for x in k2_haps:
 *         if x==k1_hap: out.append('NA')
 */
  __pyx_t_2 = PyList_New(0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1224, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_v_out = ((PyObject*)__pyx_t_2);
  __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":1225
 *     k1_hap=k1.split('/')[0]
 *     out=[]
 *     for x in k2_haps:             # <<<<<<<<<<<<<<
 *         if x==k1_hap: out.append('NA')
 *         else:
 */
  if (likely(PyList_CheckExact(__pyx_v_k2_haps)) || PyTuple_CheckExact(__pyx_v_k2_haps)) {
    __pyx_t_2 = __pyx_v_k2_haps; __Pyx_INCREF(__pyx_t_2); __pyx_t_3 = 0;
    __pyx_t_4 = NULL;
  } else {
    __pyx_t_3 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_v_k2_haps); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1225, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_4 = Py_TYPE(__pyx_t_2)->tp_iternext; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1225, __pyx_L1_error)
  }
  for (;;) {
    if (likely(!__pyx_t_4)) {
      if (likely(PyList_CheckExact(__pyx_t_2))) {
        if (__pyx_t_3 >= PyList_GET_SIZE(__pyx_t_2)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_1 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_3); __Pyx_INCREF(__pyx_t_1); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 1225, __pyx_L1_error)
        #else
        __pyx_t_1 = PySequence_ITEM(__pyx_t_2, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1225, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        #endif
      } else {
        if (__pyx_t_3 >= PyTuple_GET_SIZE(__pyx_t_2)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_3); __Pyx_INCREF(__pyx_t_1); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 1225, __pyx_L1_error)
        #else
        __pyx_t_1 = PySequence_ITEM(__pyx_t_2, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1225, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        #endif
      }
    } else {
      __pyx_t_1 = __pyx_t_4(__pyx_t_2);
      if (unlikely(!__pyx_t_1)) {
        PyObject* exc_type = PyErr_Occurred();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
          else __PYX_ERR(0, 1225, __pyx_L1_error)
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_1);
    }
    __Pyx_XDECREF_SET(__pyx_v_x, __pyx_t_1);
    __pyx_t_1 = 0;

    /* "vapor_vali/Simple_function.pyx":1226
 *     out=[]
 *     for x in k2_haps:
 *         if x==k1_hap: out.append('NA')             # <<<<<<<<<<<<<<
 *         else:
 *             out.append(simple_tandup_haploid_decide(k1_hap,x))
 */
    __pyx_t_1 = PyObject_RichCompare(__pyx_v_x, __pyx_v_k1_hap, Py_EQ); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1226, __pyx_L1_error)
    __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 1226, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    if (__pyx_t_5) {
      __pyx_t_6 = __Pyx_PyList_Append(__pyx_v_out, __pyx_n_s_NA); if (unlikely(__pyx_t_6 == -1)) __PYX_ERR(0, 1226, __pyx_L1_error)
      goto __pyx_L5;
    }

    /* "vapor_vali/Simple_function.pyx":1228
 *         if x==k1_hap: out.append('NA')
 *         else:
 *             out.append(simple_tandup_haploid_decide(k1_hap,x))             # <<<<<<<<<<<<<<
 *     return out
 * 
 */
    /*else*/ {
      __pyx_t_7 = __Pyx_GetModuleGlobalName(__pyx_n_s_simple_tandup_haploid_decide); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1228, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_7);
      __pyx_t_8 = NULL;
      __pyx_t_9 = 0;
      if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_7))) {
        __pyx_t_8 = PyMethod_GET_SELF(__pyx_t_7);
        if (likely(__pyx_t_8)) {
          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_7);
          __Pyx_INCREF(__pyx_t_8);
          __Pyx_INCREF(function);
          __Pyx_DECREF_SET(__pyx_t_7, function);
          __pyx_t_9 = 1;
        }
      }
      __pyx_t_10 = PyTuple_New(2+__pyx_t_9); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1228, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_10);
      if (__pyx_t_8) {
        __Pyx_GIVEREF(__pyx_t_8); PyTuple_SET_ITEM(__pyx_t_10, 0, __pyx_t_8); __pyx_t_8 = NULL;
      }
      __Pyx_INCREF(__pyx_v_k1_hap);
      __Pyx_GIVEREF(__pyx_v_k1_hap);
      PyTuple_SET_ITEM(__pyx_t_10, 0+__pyx_t_9, __pyx_v_k1_hap);
      __Pyx_INCREF(__pyx_v_x);
      __Pyx_GIVEREF(__pyx_v_x);
      PyTuple_SET_ITEM(__pyx_t_10, 1+__pyx_t_9, __pyx_v_x);
      __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_7, __pyx_t_10, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1228, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
      __pyx_t_6 = __Pyx_PyList_Append(__pyx_v_out, __pyx_t_1); if (unlikely(__pyx_t_6 == -1)) __PYX_ERR(0, 1228, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    }
    __pyx_L5:;

    /* "vapor_vali/Simple_function.pyx":1225
 *     k1_hap=k1.split('/')[0]
 *     out=[]
 *     for x in k2_haps:             # <<<<<<<<<<<<<<
 *         if x==k1_hap: out.append('NA')
 *         else:
 */
  }
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":1229
 *         else:
 *             out.append(simple_tandup_haploid_decide(k1_hap,x))
 *     return out             # <<<<<<<<<<<<<<
 * 
 * def simple_tandup_haploid_decide(k1_hap,k2_hap):
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_out);
  __pyx_r = __pyx_v_out;
  goto __pyx_L0;

  /* "vapor_vali/Simple_function.pyx":1220
 *     else:   return 'FALSE'
 * 
 * def simple_tandup_diploid_decide(k1,k2):             # <<<<<<<<<<<<<<
 *     #eg of k1='ab/ab'   ; eg of k2='abb/ab'
 *     k2_haps=k2.split('/')
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_7);
  __Pyx_XDECREF(__pyx_t_8);
  __Pyx_XDECREF(__pyx_t_10);
  __Pyx_AddTraceback("vapor_vali.Simple_function.simple_tandup_diploid_decide", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_k2_haps);
  __Pyx_XDECREF(__pyx_v_k1_hap);
  __Pyx_XDECREF(__pyx_v_out);
  __Pyx_XDECREF(__pyx_v_x);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "vapor_vali/Simple_function.pyx":1231
 *     return out
 * 
 * def simple_tandup_haploid_decide(k1_hap,k2_hap):             # <<<<<<<<<<<<<<
 *     if '^' in k2_hap:   return 'FALSE'
 *     dup_count=[k2_hap.count(i) for i in k1_hap]
 */

/* Python wrapper */
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_175simple_tandup_haploid_decide(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_10vapor_vali_15Simple_function_175simple_tandup_haploid_decide = {"simple_tandup_haploid_decide", (PyCFunction)__pyx_pw_10vapor_vali_15Simple_function_175simple_tandup_haploid_decide, METH_VARARGS|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_175simple_tandup_haploid_decide(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_k1_hap = 0;
  PyObject *__pyx_v_k2_hap = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("simple_tandup_haploid_decide (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_k1_hap,&__pyx_n_s_k2_hap,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_k1_hap)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_k2_hap)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("simple_tandup_haploid_decide", 1, 2, 2, 1); __PYX_ERR(0, 1231, __pyx_L3_error)
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "simple_tandup_haploid_decide") < 0)) __PYX_ERR(0, 1231, __pyx_L3_error)
      }
    } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
    }
    __pyx_v_k1_hap = values[0];
    __pyx_v_k2_hap = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("simple_tandup_haploid_decide", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1231, __pyx_L3_error)
  __pyx_L3_error:;
  __Pyx_AddTraceback("vapor_vali.Simple_function.simple_tandup_haploid_decide", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_10vapor_vali_15Simple_function_174simple_tandup_haploid_decide(__pyx_self, __pyx_v_k1_hap, __pyx_v_k2_hap);

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10vapor_vali_15Simple_function_174simple_tandup_haploid_decide(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_k1_hap, PyObject *__pyx_v_k2_hap) {
  PyObject *__pyx_v_dup_count = NULL;
  PyObject *__pyx_v_out = NULL;
  PyObject *__pyx_v_temp1 = NULL;
  PyObject *__pyx_v_x = NULL;
  PyObject *__pyx_v_overlap_portion = NULL;
  PyObject *__pyx_v_overlap_count = NULL;
  PyObject *__pyx_v_overlap = NULL;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  int __pyx_t_2;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  Py_ssize_t __pyx_t_5;
  PyObject *(*__pyx_t_6)(PyObject *);
  PyObject *__pyx_t_7 = NULL;
  PyObject *__pyx_t_8 = NULL;
  PyObject *__pyx_t_9 = NULL;
  PyObject *__pyx_t_10 = NULL;
  int __pyx_t_11;
  long __pyx_t_12;
  long __pyx_t_13;
  Py_ssize_t __pyx_t_14;
  Py_ssize_t __pyx_t_15;
  __Pyx_RefNannySetupContext("simple_tandup_haploid_decide", 0);

  /* "vapor_vali/Simple_function.pyx":1232
 * 
 * def simple_tandup_haploid_decide(k1_hap,k2_hap):
 *     if '^' in k2_hap:   return 'FALSE'             # <<<<<<<<<<<<<<
 *     dup_count=[k2_hap.count(i) for i in k1_hap]
 *     if min(dup_count)<1 or max(dup_count)<2:    return 'FALSE'  #deletion structure inside
 */
  __pyx_t_1 = (__Pyx_PySequence_ContainsTF(__pyx_kp_s__7, __pyx_v_k2_hap, Py_EQ)); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(0, 1232, __pyx_L1_error)
  __pyx_t_2 = (__pyx_t_1 != 0);
  if (__pyx_t_2) {
    __Pyx_XDECREF(__pyx_r);
    __Pyx_INCREF(__pyx_n_s_FALSE);
    __pyx_r = __pyx_n_s_FALSE;
    goto __pyx_L0;
  }

  /* "vapor_vali/Simple_function.pyx":1233
 * def simple_tandup_haploid_decide(k1_hap,k2_hap):
 *     if '^' in k2_hap:   return 'FALSE'
 *     dup_count=[k2_hap.count(i) for i in k1_hap]             # <<<<<<<<<<<<<<
 *     if min(dup_count)<1 or max(dup_count)<2:    return 'FALSE'  #deletion structure inside
 *     out=[]
 */
  __pyx_t_3 = PyList_New(0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1233, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  if (likely(PyList_CheckExact(__pyx_v_k1_hap)) || PyTuple_CheckExact(__pyx_v_k1_hap)) {
    __pyx_t_4 = __pyx_v_k1_hap; __Pyx_INCREF(__pyx_t_4); __pyx_t_5 = 0;
    __pyx_t_6 = NULL;
  } else {
    __pyx_t_5 = -1; __pyx_t_4 = PyObject_GetIter(__pyx_v_k1_hap); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1233, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_6 = Py_TYPE(__pyx_t_4)->tp_iternext; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1233, __pyx_L1_error)
  }
  for (;;) {
    if (likely(!__pyx_t_6)) {
      if (likely(PyList_CheckExact(__pyx_t_4))) {
        if (__pyx_t_5 >= PyList_GET_SIZE(__pyx_t_4)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_7 = PyList_GET_ITEM(__pyx_t_4, __pyx_t_5); __Pyx_INCREF(__pyx_t_7); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 1233, __pyx_L1_error)
        #else
        __pyx_t_7 = PySequence_ITEM(__pyx_t_4, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1233, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_7);
        #endif
      } else {
        if (__pyx_t_5 >= PyTuple_GET_SIZE(__pyx_t_4)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_7 = PyTuple_GET_ITEM(__pyx_t_4, __pyx_t_5); __Pyx_INCREF(__pyx_t_7); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 1233, __pyx_L1_error)
        #else
        __pyx_t_7 = PySequence_ITEM(__pyx_t_4, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1233, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_7);
        #endif
      }
    } else {
      __pyx_t_7 = __pyx_t_6(__pyx_t_4);
      if (unlikely(!__pyx_t_7)) {
        PyObject* exc_type = PyErr_Occurred();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
          else __PYX_ERR(0, 1233, __pyx_L1_error)
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_7);
    }
    __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_7);
    __pyx_t_7 = 0;
    __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_v_k2_hap, __pyx_n_s_count); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1233, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_8);
    __pyx_t_9 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_8))) {
      __pyx_t_9 = PyMethod_GET_SELF(__pyx_t_8);
      if (likely(__pyx_t_9)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_8);
        __Pyx_INCREF(__pyx_t_9);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_8, function);
      }
    }
    if (!__pyx_t_9) {
      __pyx_t_7 = __Pyx_PyObject_CallOneArg(__pyx_t_8, __pyx_v_i); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1233, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_7);
    } else {
      __pyx_t_10 = PyTuple_New(1+1); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1233, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_10);
      __Pyx_GIVEREF(__pyx_t_9); PyTuple_SET_ITEM(__pyx_t_10, 0, __pyx_t_9); __pyx_t_9 = NULL;
      __Pyx_INCREF(__pyx_v_i);
      __Pyx_GIVEREF(__pyx_v_i);
      PyTuple_SET_ITEM(__pyx_t_10, 0+1, __pyx_v_i);
      __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_8, __pyx_t_10, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1233, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_7);
      __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
    }
    __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
    if (unlikely(__Pyx_ListComp_Append(__pyx_t_3, (PyObject*)__pyx_t_7))) __PYX_ERR(0, 1233, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
  }
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_dup_count = ((PyObject*)__pyx_t_3);
  __pyx_t_3 = 0;

  /* "vapor_vali/Simple_function.pyx":1234
 *     if '^' in k2_hap:   return 'FALSE'
 *     dup_count=[k2_hap.count(i) for i in k1_hap]
 *     if min(dup_count)<1 or max(dup_count)<2:    return 'FALSE'  #deletion structure inside             # <<<<<<<<<<<<<<
 *     out=[]
 *     temp1=[]
 */
  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1234, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_INCREF(__pyx_v_dup_count);
  __Pyx_GIVEREF(__pyx_v_dup_count);
  PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_v_dup_count);
  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_builtin_min, __pyx_t_3, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1234, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = PyObject_RichCompare(__pyx_t_4, __pyx_int_1, Py_LT); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1234, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_1 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(0, 1234, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  if (!__pyx_t_1) {
  } else {
    __pyx_t_2 = __pyx_t_1;
    goto __pyx_L7_bool_binop_done;
  }
  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1234, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_INCREF(__pyx_v_dup_count);
  __Pyx_GIVEREF(__pyx_v_dup_count);
  PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_v_dup_count);
  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_builtin_max, __pyx_t_3, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1234, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = PyObject_RichCompare(__pyx_t_4, __pyx_int_2, Py_LT); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1234, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_1 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(0, 1234, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_2 = __pyx_t_1;
  __pyx_L7_bool_binop_done:;
  if (__pyx_t_2) {
    __Pyx_XDECREF(__pyx_r);
    __Pyx_INCREF(__pyx_n_s_FALSE);
    __pyx_r = __pyx_n_s_FALSE;
    goto __pyx_L0;
  }

  /* "vapor_vali/Simple_function.pyx":1235
 *     dup_count=[k2_hap.count(i) for i in k1_hap]
 *     if min(dup_count)<1 or max(dup_count)<2:    return 'FALSE'  #deletion structure inside
 *     out=[]             # <<<<<<<<<<<<<<
 *     temp1=[]
 *     for x in k2_hap:
 */
  __pyx_t_3 = PyList_New(0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1235, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_v_out = ((PyObject*)__pyx_t_3);
  __pyx_t_3 = 0;

  /* "vapor_vali/Simple_function.pyx":1236
 *     if min(dup_count)<1 or max(dup_count)<2:    return 'FALSE'  #deletion structure inside
 *     out=[]
 *     temp1=[]             # <<<<<<<<<<<<<<
 *     for x in k2_hap:
 *         if temp1==[]:   temp1.append(x)
 */
  __pyx_t_3 = PyList_New(0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1236, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_v_temp1 = ((PyObject*)__pyx_t_3);
  __pyx_t_3 = 0;

  /* "vapor_vali/Simple_function.pyx":1237
 *     out=[]
 *     temp1=[]
 *     for x in k2_hap:             # <<<<<<<<<<<<<<
 *         if temp1==[]:   temp1.append(x)
 *         elif ord(x)-ord(temp1[-1][-1])==1:  temp1[-1]+=x
 */
  if (likely(PyList_CheckExact(__pyx_v_k2_hap)) || PyTuple_CheckExact(__pyx_v_k2_hap)) {
    __pyx_t_3 = __pyx_v_k2_hap; __Pyx_INCREF(__pyx_t_3); __pyx_t_5 = 0;
    __pyx_t_6 = NULL;
  } else {
    __pyx_t_5 = -1; __pyx_t_3 = PyObject_GetIter(__pyx_v_k2_hap); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1237, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_6 = Py_TYPE(__pyx_t_3)->tp_iternext; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1237, __pyx_L1_error)
  }
  for (;;) {
    if (likely(!__pyx_t_6)) {
      if (likely(PyList_CheckExact(__pyx_t_3))) {
        if (__pyx_t_5 >= PyList_GET_SIZE(__pyx_t_3)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_4 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_5); __Pyx_INCREF(__pyx_t_4); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 1237, __pyx_L1_error)
        #else
        __pyx_t_4 = PySequence_ITEM(__pyx_t_3, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1237, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_4);
        #endif
      } else {
        if (__pyx_t_5 >= PyTuple_GET_SIZE(__pyx_t_3)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_4 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_5); __Pyx_INCREF(__pyx_t_4); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 1237, __pyx_L1_error)
        #else
        __pyx_t_4 = PySequence_ITEM(__pyx_t_3, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1237, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_4);
        #endif
      }
    } else {
      __pyx_t_4 = __pyx_t_6(__pyx_t_3);
      if (unlikely(!__pyx_t_4)) {
        PyObject* exc_type = PyErr_Occurred();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
          else __PYX_ERR(0, 1237, __pyx_L1_error)
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_4);
    }
    __Pyx_XDECREF_SET(__pyx_v_x, __pyx_t_4);
    __pyx_t_4 = 0;

    /* "vapor_vali/Simple_function.pyx":1238
 *     temp1=[]
 *     for x in k2_hap:
 *         if temp1==[]:   temp1.append(x)             # <<<<<<<<<<<<<<
 *         elif ord(x)-ord(temp1[-1][-1])==1:  temp1[-1]+=x
 *         else:   temp1.append(x)
 */
    __pyx_t_4 = PyList_New(0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1238, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_7 = PyObject_RichCompare(__pyx_v_temp1, __pyx_t_4, Py_EQ); __Pyx_XGOTREF(__pyx_t_7); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1238, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_7); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 1238, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
    if (__pyx_t_2) {
      __pyx_t_11 = __Pyx_PyList_Append(__pyx_v_temp1, __pyx_v_x); if (unlikely(__pyx_t_11 == -1)) __PYX_ERR(0, 1238, __pyx_L1_error)
      goto __pyx_L11;
    }

    /* "vapor_vali/Simple_function.pyx":1239
 *     for x in k2_hap:
 *         if temp1==[]:   temp1.append(x)
 *         elif ord(x)-ord(temp1[-1][-1])==1:  temp1[-1]+=x             # <<<<<<<<<<<<<<
 *         else:   temp1.append(x)
 *     overlap_portion=[]
 */
    __pyx_t_12 = __Pyx_PyObject_Ord(__pyx_v_x); if (unlikely(__pyx_t_12 == (long)(Py_UCS4)-1)) __PYX_ERR(0, 1239, __pyx_L1_error)
    __pyx_t_7 = __Pyx_GetItemInt_List(__pyx_v_temp1, -1L, long, 1, __Pyx_PyInt_From_long, 1, 1, 1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1239, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    __pyx_t_4 = __Pyx_GetItemInt(__pyx_t_7, -1L, long, 1, __Pyx_PyInt_From_long, 0, 1, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1239, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_t_13 = __Pyx_PyObject_Ord(__pyx_t_4); if (unlikely(__pyx_t_13 == (long)(Py_UCS4)-1)) __PYX_ERR(0, 1239, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_2 = (((__pyx_t_12 - __pyx_t_13) == 1) != 0);
    if (__pyx_t_2) {
      __pyx_t_14 = -1L;
      __pyx_t_4 = __Pyx_GetItemInt_List(__pyx_v_temp1, __pyx_t_14, Py_ssize_t, 1, PyInt_FromSsize_t, 1, 1, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1239, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_t_7 = PyNumber_InPlaceAdd(__pyx_t_4, __pyx_v_x); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1239, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_7);
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      if (unlikely(__Pyx_SetItemInt(__pyx_v_temp1, __pyx_t_14, __pyx_t_7, Py_ssize_t, 1, PyInt_FromSsize_t, 1, 1, 1) < 0)) __PYX_ERR(0, 1239, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
      goto __pyx_L11;
    }

    /* "vapor_vali/Simple_function.pyx":1240
 *         if temp1==[]:   temp1.append(x)
 *         elif ord(x)-ord(temp1[-1][-1])==1:  temp1[-1]+=x
 *         else:   temp1.append(x)             # <<<<<<<<<<<<<<
 *     overlap_portion=[]
 *     overlap_count=[]
 */
    /*else*/ {
      __pyx_t_11 = __Pyx_PyList_Append(__pyx_v_temp1, __pyx_v_x); if (unlikely(__pyx_t_11 == -1)) __PYX_ERR(0, 1240, __pyx_L1_error)
    }
    __pyx_L11:;

    /* "vapor_vali/Simple_function.pyx":1237
 *     out=[]
 *     temp1=[]
 *     for x in k2_hap:             # <<<<<<<<<<<<<<
 *         if temp1==[]:   temp1.append(x)
 *         elif ord(x)-ord(temp1[-1][-1])==1:  temp1[-1]+=x
 */
  }
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;

  /* "vapor_vali/Simple_function.pyx":1241
 *         elif ord(x)-ord(temp1[-1][-1])==1:  temp1[-1]+=x
 *         else:   temp1.append(x)
 *     overlap_portion=[]             # <<<<<<<<<<<<<<
 *     overlap_count=[]
 *     for x in temp1:
 */
  __pyx_t_3 = PyList_New(0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1241, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_v_overlap_portion = ((PyObject*)__pyx_t_3);
  __pyx_t_3 = 0;

  /* "vapor_vali/Simple_function.pyx":1242
 *         else:   temp1.append(x)
 *     overlap_portion=[]
 *     overlap_count=[]             # <<<<<<<<<<<<<<
 *     for x in temp1:
 *         if out==[]:
 */
  __pyx_t_3 = PyList_New(0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1242, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_v_overlap_count = ((PyObject*)__pyx_t_3);
  __pyx_t_3 = 0;

  /* "vapor_vali/Simple_function.pyx":1243
 *     overlap_portion=[]
 *     overlap_count=[]
 *     for x in temp1:             # <<<<<<<<<<<<<<
 *         if out==[]:
 *             out.append(x)
 */
  __pyx_t_3 = __pyx_v_temp1; __Pyx_INCREF(__pyx_t_3); __pyx_t_5 = 0;
  for (;;) {
    if (__pyx_t_5 >= PyList_GET_SIZE(__pyx_t_3)) break;
    #if CYTHON_COMPILING_IN_CPYTHON
    __pyx_t_7 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_5); __Pyx_INCREF(__pyx_t_7); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 1243, __pyx_L1_error)
    #else
    __pyx_t_7 = PySequence_ITEM(__pyx_t_3, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1243, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    #endif
    __Pyx_XDECREF_SET(__pyx_v_x, __pyx_t_7);
    __pyx_t_7 = 0;

    /* "vapor_vali/Simple_function.pyx":1244
 *     overlap_count=[]
 *     for x in temp1:
 *         if out==[]:             # <<<<<<<<<<<<<<
 *             out.append(x)
 *         else:
 */
    __pyx_t_7 = PyList_New(0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1244, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    __pyx_t_4 = PyObject_RichCompare(__pyx_v_out, __pyx_t_7, Py_EQ); __Pyx_XGOTREF(__pyx_t_4); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1244, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_4); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 1244, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    if (__pyx_t_2) {

      /* "vapor_vali/Simple_function.pyx":1245
 *     for x in temp1:
 *         if out==[]:
 *             out.append(x)             # <<<<<<<<<<<<<<
 *         else:
 *             overlap=intersect(out[-1],x)
 */
      __pyx_t_11 = __Pyx_PyList_Append(__pyx_v_out, __pyx_v_x); if (unlikely(__pyx_t_11 == -1)) __PYX_ERR(0, 1245, __pyx_L1_error)

      /* "vapor_vali/Simple_function.pyx":1244
 *     overlap_count=[]
 *     for x in temp1:
 *         if out==[]:             # <<<<<<<<<<<<<<
 *             out.append(x)
 *         else:
 */
      goto __pyx_L14;
    }

    /* "vapor_vali/Simple_function.pyx":1247
 *             out.append(x)
 *         else:
 *             overlap=intersect(out[-1],x)             # <<<<<<<<<<<<<<
 *             if not len(overlap) >len(out[-1]) and not len(overlap)>len(x):
 *                 if out[-1][-len(overlap):]==x[:len(overlap)]:
 */
    /*else*/ {
      __pyx_t_7 = __Pyx_GetModuleGlobalName(__pyx_n_s_intersect); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1247, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_7);
      __pyx_t_8 = __Pyx_GetItemInt_List(__pyx_v_out, -1L, long, 1, __Pyx_PyInt_From_long, 1, 1, 1); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1247, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_8);
      __pyx_t_10 = NULL;
      __pyx_t_14 = 0;
      if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_7))) {
        __pyx_t_10 = PyMethod_GET_SELF(__pyx_t_7);
        if (likely(__pyx_t_10)) {
          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_7);
          __Pyx_INCREF(__pyx_t_10);
          __Pyx_INCREF(function);
          __Pyx_DECREF_SET(__pyx_t_7, function);
          __pyx_t_14 = 1;
        }
      }
      __pyx_t_9 = PyTuple_New(2+__pyx_t_14); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1247, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_9);
      if (__pyx_t_10) {
        __Pyx_GIVEREF(__pyx_t_10); PyTuple_SET_ITEM(__pyx_t_9, 0, __pyx_t_10); __pyx_t_10 = NULL;
      }
      __Pyx_GIVEREF(__pyx_t_8);
      PyTuple_SET_ITEM(__pyx_t_9, 0+__pyx_t_14, __pyx_t_8);
      __Pyx_INCREF(__pyx_v_x);
      __Pyx_GIVEREF(__pyx_v_x);
      PyTuple_SET_ITEM(__pyx_t_9, 1+__pyx_t_14, __pyx_v_x);
      __pyx_t_8 = 0;
      __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_7, __pyx_t_9, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1247, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
      __Pyx_XDECREF_SET(__pyx_v_overlap, __pyx_t_4);
      __pyx_t_4 = 0;

      /* "vapor_vali/Simple_function.pyx":1248
 *         else:
 *             overlap=intersect(out[-1],x)
 *             if not len(overlap) >len(out[-1]) and not len(overlap)>len(x):             # <<<<<<<<<<<<<<
 *                 if out[-1][-len(overlap):]==x[:len(overlap)]:
 *                     out[-1]+=x[len(overlap):]
 */
      __pyx_t_14 = PyObject_Length(__pyx_v_overlap); if (unlikely(__pyx_t_14 == -1)) __PYX_ERR(0, 1248, __pyx_L1_error)
      __pyx_t_4 = __Pyx_GetItemInt_List(__pyx_v_out, -1L, long, 1, __Pyx_PyInt_From_long, 1, 1, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1248, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_t_15 = PyObject_Length(__pyx_t_4); if (unlikely(__pyx_t_15 == -1)) __PYX_ERR(0, 1248, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_1 = ((!((__pyx_t_14 > __pyx_t_15) != 0)) != 0);
      if (__pyx_t_1) {
      } else {
        __pyx_t_2 = __pyx_t_1;
        goto __pyx_L16_bool_binop_done;
      }
      __pyx_t_15 = PyObject_Length(__pyx_v_overlap); if (unlikely(__pyx_t_15 == -1)) __PYX_ERR(0, 1248, __pyx_L1_error)
      __pyx_t_14 = PyObject_Length(__pyx_v_x); if (unlikely(__pyx_t_14 == -1)) __PYX_ERR(0, 1248, __pyx_L1_error)
      __pyx_t_1 = ((!((__pyx_t_15 > __pyx_t_14) != 0)) != 0);
      __pyx_t_2 = __pyx_t_1;
      __pyx_L16_bool_binop_done:;
      if (__pyx_t_2) {

        /* "vapor_vali/Simple_function.pyx":1249
 *             overlap=intersect(out[-1],x)
 *             if not len(overlap) >len(out[-1]) and not len(overlap)>len(x):
 *                 if out[-1][-len(overlap):]==x[:len(overlap)]:             # <<<<<<<<<<<<<<
 *                     out[-1]+=x[len(overlap):]
 *                     if not overlap in overlap_portion:
 */
        __pyx_t_4 = __Pyx_GetItemInt_List(__pyx_v_out, -1L, long, 1, __Pyx_PyInt_From_long, 1, 1, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1249, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_4);
        __pyx_t_14 = PyObject_Length(__pyx_v_overlap); if (unlikely(__pyx_t_14 == -1)) __PYX_ERR(0, 1249, __pyx_L1_error)
        __pyx_t_7 = __Pyx_PyObject_GetSlice(__pyx_t_4, (-__pyx_t_14), 0, NULL, NULL, NULL, 1, 0, 1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1249, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_7);
        __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
        __pyx_t_14 = PyObject_Length(__pyx_v_overlap); if (unlikely(__pyx_t_14 == -1)) __PYX_ERR(0, 1249, __pyx_L1_error)
        __pyx_t_4 = __Pyx_PyObject_GetSlice(__pyx_v_x, 0, __pyx_t_14, NULL, NULL, NULL, 0, 1, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1249, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_4);
        __pyx_t_9 = PyObject_RichCompare(__pyx_t_7, __pyx_t_4, Py_EQ); __Pyx_XGOTREF(__pyx_t_9); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1249, __pyx_L1_error)
        __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
        __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
        __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_9); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 1249, __pyx_L1_error)
        __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
        if (__pyx_t_2) {

          /* "vapor_vali/Simple_function.pyx":1250
 *             if not len(overlap) >len(out[-1]) and not len(overlap)>len(x):
 *                 if out[-1][-len(overlap):]==x[:len(overlap)]:
 *                     out[-1]+=x[len(overlap):]             # <<<<<<<<<<<<<<
 *                     if not overlap in overlap_portion:
 *                         overlap_portion.append(overlap)
 */
          __pyx_t_14 = -1L;
          __pyx_t_9 = __Pyx_GetItemInt_List(__pyx_v_out, __pyx_t_14, Py_ssize_t, 1, PyInt_FromSsize_t, 1, 1, 1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1250, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_9);
          __pyx_t_15 = PyObject_Length(__pyx_v_overlap); if (unlikely(__pyx_t_15 == -1)) __PYX_ERR(0, 1250, __pyx_L1_error)
          __pyx_t_4 = __Pyx_PyObject_GetSlice(__pyx_v_x, __pyx_t_15, 0, NULL, NULL, NULL, 1, 0, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1250, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_4);
          __pyx_t_7 = PyNumber_InPlaceAdd(__pyx_t_9, __pyx_t_4); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1250, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_7);
          __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
          __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
          if (unlikely(__Pyx_SetItemInt(__pyx_v_out, __pyx_t_14, __pyx_t_7, Py_ssize_t, 1, PyInt_FromSsize_t, 1, 1, 1) < 0)) __PYX_ERR(0, 1250, __pyx_L1_error)
          __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;

          /* "vapor_vali/Simple_function.pyx":1251
 *                 if out[-1][-len(overlap):]==x[:len(overlap)]:
 *                     out[-1]+=x[len(overlap):]
 *                     if not overlap in overlap_portion:             # <<<<<<<<<<<<<<
 *                         overlap_portion.append(overlap)
 *                         overlap_count.append(2)
 */
          __pyx_t_2 = (__Pyx_PySequence_ContainsTF(__pyx_v_overlap, __pyx_v_overlap_portion, Py_NE)); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 1251, __pyx_L1_error)
          __pyx_t_1 = (__pyx_t_2 != 0);
          if (__pyx_t_1) {

            /* "vapor_vali/Simple_function.pyx":1252
 *                     out[-1]+=x[len(overlap):]
 *                     if not overlap in overlap_portion:
 *                         overlap_portion.append(overlap)             # <<<<<<<<<<<<<<
 *                         overlap_count.append(2)
 *                     else:
 */
            __pyx_t_11 = __Pyx_PyList_Append(__pyx_v_overlap_portion, __pyx_v_overlap); if (unlikely(__pyx_t_11 == -1)) __PYX_ERR(0, 1252, __pyx_L1_error)

            /* "vapor_vali/Simple_function.pyx":1253
 *                     if not overlap in overlap_portion:
 *                         overlap_portion.append(overlap)
 *                         overlap_count.append(2)             # <<<<<<<<<<<<<<
 *                     else:
 *                         overlap_count[overlap_portion.index(overlap)]+=1
 */
            __pyx_t_11 = __Pyx_PyList_Append(__pyx_v_overlap_count, __pyx_int_2); if (unlikely(__pyx_t_11 == -1)) __PYX_ERR(0, 1253, __pyx_L1_error)

            /* "vapor_vali/Simple_function.pyx":1251
 *                 if out[-1][-len(overlap):]==x[:len(overlap)]:
 *                     out[-1]+=x[len(overlap):]
 *                     if not overlap in overlap_portion:             # <<<<<<<<<<<<<<
 *                         overlap_portion.append(overlap)
 *                         overlap_count.append(2)
 */
            goto __pyx_L19;
          }

          /* "vapor_vali/Simple_function.pyx":1255
 *                         overlap_count.append(2)
 *                     else:
 *                         overlap_count[overlap_portion.index(overlap)]+=1             # <<<<<<<<<<<<<<
 *                 else:
 *                     out.append(x)
 */
          /*else*/ {
            __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_overlap_portion, __pyx_n_s_index); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1255, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_4);
            __pyx_t_9 = NULL;
            if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_4))) {
              __pyx_t_9 = PyMethod_GET_SELF(__pyx_t_4);
              if (likely(__pyx_t_9)) {
                PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
                __Pyx_INCREF(__pyx_t_9);
                __Pyx_INCREF(function);
                __Pyx_DECREF_SET(__pyx_t_4, function);
              }
            }
            if (!__pyx_t_9) {
              __pyx_t_7 = __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_v_overlap); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1255, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_7);
            } else {
              __pyx_t_8 = PyTuple_New(1+1); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1255, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_8);
              __Pyx_GIVEREF(__pyx_t_9); PyTuple_SET_ITEM(__pyx_t_8, 0, __pyx_t_9); __pyx_t_9 = NULL;
              __Pyx_INCREF(__pyx_v_overlap);
              __Pyx_GIVEREF(__pyx_v_overlap);
              PyTuple_SET_ITEM(__pyx_t_8, 0+1, __pyx_v_overlap);
              __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_8, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1255, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_7);
              __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
            }
            __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
            __pyx_t_4 = PyObject_GetItem(__pyx_v_overlap_count, __pyx_t_7); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1255, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_4);
            __pyx_t_8 = __Pyx_PyInt_AddObjC(__pyx_t_4, __pyx_int_1, 1, 1); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1255, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_8);
            __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
            if (unlikely(PyObject_SetItem(__pyx_v_overlap_count, __pyx_t_7, __pyx_t_8) < 0)) __PYX_ERR(0, 1255, __pyx_L1_error)
            __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
            __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
          }
          __pyx_L19:;

          /* "vapor_vali/Simple_function.pyx":1249
 *             overlap=intersect(out[-1],x)
 *             if not len(overlap) >len(out[-1]) and not len(overlap)>len(x):
 *                 if out[-1][-len(overlap):]==x[:len(overlap)]:             # <<<<<<<<<<<<<<
 *                     out[-1]+=x[len(overlap):]
 *                     if not overlap in overlap_portion:
 */
          goto __pyx_L18;
        }

        /* "vapor_vali/Simple_function.pyx":1257
 *                         overlap_count[overlap_portion.index(overlap)]+=1
 *                 else:
 *                     out.append(x)             # <<<<<<<<<<<<<<
 *             else:
 *                 out.append(x)
 */
        /*else*/ {
          __pyx_t_11 = __Pyx_PyList_Append(__pyx_v_out, __pyx_v_x); if (unlikely(__pyx_t_11 == -1)) __PYX_ERR(0, 1257, __pyx_L1_error)
        }
        __pyx_L18:;

        /* "vapor_vali/Simple_function.pyx":1248
 *         else:
 *             overlap=intersect(out[-1],x)
 *             if not len(overlap) >len(out[-1]) and not len(overlap)>len(x):             # <<<<<<<<<<<<<<
 *                 if out[-1][-len(overlap):]==x[:len(overlap)]:
 *                     out[-1]+=x[len(overlap):]
 */
        goto __pyx_L15;
      }

      /* "vapor_vali/Simple_function.pyx":1259
 *                     out.append(x)
 *             else:
 *                 out.append(x)             # <<<<<<<<<<<<<<
 *     if ''.join(out)==k1_hap:
 *         return [overlap_portion,overlap_count]
 */
      /*else*/ {
        __pyx_t_11 = __Pyx_PyList_Append(__pyx_v_out, __pyx_v_x); if (unlikely(__pyx_t_11 == -1)) __PYX_ERR(0, 1259, __pyx_L1_error)
      }
      __pyx_L15:;
    }
    __pyx_L14:;

    /* "vapor_vali/Simple_function.pyx":1243
 *     overlap_portion=[]
 *     overlap_count=[]
 *     for x in temp1:             # <<<<<<<<<<<<<<
 *         if out==[]:
 *             out.append(x)
 */
  }
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;

  /* "vapor_vali/Simple_function.pyx":1260
 *             else:
 *                 out.append(x)
 *     if ''.join(out)==k1_hap:             # <<<<<<<<<<<<<<
 *         return [overlap_portion,overlap_count]
 *     return 'FALSE'
 */
  __pyx_t_3 = __Pyx_PyString_Join(__pyx_kp_s__24, __pyx_v_out); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1260, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_1 = (__Pyx_PyUnicode_Equals(__pyx_t_3, __pyx_v_k1_hap, Py_EQ)); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(0, 1260, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  if (__pyx_t_1) {

    /* "vapor_vali/Simple_function.pyx":1261
 *                 out.append(x)
 *     if ''.join(out)==k1_hap:
 *         return [overlap_portion,overlap_count]             # <<<<<<<<<<<<<<
 *     return 'FALSE'
 * 
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_3 = PyList_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1261, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_INCREF(__pyx_v_overlap_portion);
    __Pyx_GIVEREF(__pyx_v_overlap_portion);
    PyList_SET_ITEM(__pyx_t_3, 0, __pyx_v_overlap_portion);
    __Pyx_INCREF(__pyx_v_overlap_count);
    __Pyx_GIVEREF(__pyx_v_overlap_count);
    PyList_SET_ITEM(__pyx_t_3, 1, __pyx_v_overlap_count);
    __pyx_r = __pyx_t_3;
    __pyx_t_3 = 0;
    goto __pyx_L0;

    /* "vapor_vali/Simple_function.pyx":1260
 *             else:
 *                 out.append(x)
 *     if ''.join(out)==k1_hap:             # <<<<<<<<<<<<<<
 *         return [overlap_portion,overlap_count]
 *     return 'FALSE'
 */
  }

  /* "vapor_vali/Simple_function.pyx":1262
 *     if ''.join(out)==k1_hap:
 *         return [overlap_portion,overlap_count]
 *     return 'FALSE'             # <<<<<<<<<<<<<<
 * 
 * def simple_disdup_diploid_decide(k1,k2):
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_n_s_FALSE);
  __pyx_r = __pyx_n_s_FALSE;
  goto __pyx_L0;

  /* "vapor_vali/Simple_function.pyx":1231
 *     return out
 * 
 * def simple_tandup_haploid_decide(k1_hap,k2_hap):             # <<<<<<<<<<<<<<
 *     if '^' in k2_hap:   return 'FALSE'
 *     dup_count=[k2_hap.count(i) for i in k1_hap]
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_7);
  __Pyx_XDECREF(__pyx_t_8);
  __Pyx_XDECREF(__pyx_t_9);
  __Pyx_XDECREF(__pyx_t_10);
  __Pyx_AddTraceback("vapor_vali.Simple_function.simple_tandup_haploid_decide", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_dup_count);
  __Pyx_XDECREF(__pyx_v_out);
  __Pyx_XDECREF(__pyx_v_temp1);
  __Pyx_XDECREF(__pyx_v_x);
  __Pyx_XDECREF(__pyx_v_overlap_portion);
  __Pyx_XDECREF(__pyx_v_overlap_count);
  __Pyx_XDECREF(__pyx_v_overlap);
  __Pyx_XDECREF(__pyx_v_i);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "vapor_vali/Simple_function.pyx":1264
 *     return 'FALSE'
 * 
 * def simple_disdup_diploid_decide(k1,k2):             # <<<<<<<<<<<<<<
 *     #eg of k1='ab/ab'   ; eg of k2='bab/ab'
 *     k2_haps=k2.split('/')
 */

/* Python wrapper */
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_177simple_disdup_diploid_decide(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_10vapor_vali_15Simple_function_177simple_disdup_diploid_decide = {"simple_disdup_diploid_decide", (PyCFunction)__pyx_pw_10vapor_vali_15Simple_function_177simple_disdup_diploid_decide, METH_VARARGS|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_177simple_disdup_diploid_decide(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_k1 = 0;
  PyObject *__pyx_v_k2 = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("simple_disdup_diploid_decide (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_k1,&__pyx_n_s_k2,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_k1)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_k2)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("simple_disdup_diploid_decide", 1, 2, 2, 1); __PYX_ERR(0, 1264, __pyx_L3_error)
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "simple_disdup_diploid_decide") < 0)) __PYX_ERR(0, 1264, __pyx_L3_error)
      }
    } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
    }
    __pyx_v_k1 = values[0];
    __pyx_v_k2 = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("simple_disdup_diploid_decide", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1264, __pyx_L3_error)
  __pyx_L3_error:;
  __Pyx_AddTraceback("vapor_vali.Simple_function.simple_disdup_diploid_decide", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_10vapor_vali_15Simple_function_176simple_disdup_diploid_decide(__pyx_self, __pyx_v_k1, __pyx_v_k2);

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10vapor_vali_15Simple_function_176simple_disdup_diploid_decide(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_k1, PyObject *__pyx_v_k2) {
  PyObject *__pyx_v_k2_haps = NULL;
  PyObject *__pyx_v_k1_hap = NULL;
  PyObject *__pyx_v_out = NULL;
  PyObject *__pyx_v_x = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  Py_ssize_t __pyx_t_3;
  PyObject *(*__pyx_t_4)(PyObject *);
  int __pyx_t_5;
  int __pyx_t_6;
  PyObject *__pyx_t_7 = NULL;
  PyObject *__pyx_t_8 = NULL;
  Py_ssize_t __pyx_t_9;
  PyObject *__pyx_t_10 = NULL;
  __Pyx_RefNannySetupContext("simple_disdup_diploid_decide", 0);

  /* "vapor_vali/Simple_function.pyx":1266
 * def simple_disdup_diploid_decide(k1,k2):
 *     #eg of k1='ab/ab'   ; eg of k2='bab/ab'
 *     k2_haps=k2.split('/')             # <<<<<<<<<<<<<<
 *     k1_hap=k1.split('/')[0]
 *     out=[]
 */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_k2, __pyx_n_s_split); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1266, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_tuple__96, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1266, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_k2_haps = __pyx_t_2;
  __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":1267
 *     #eg of k1='ab/ab'   ; eg of k2='bab/ab'
 *     k2_haps=k2.split('/')
 *     k1_hap=k1.split('/')[0]             # <<<<<<<<<<<<<<
 *     out=[]
 *     for x in k2_haps:
 */
  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_k1, __pyx_n_s_split); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1267, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_tuple__97, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1267, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = __Pyx_GetItemInt(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1267, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_k1_hap = __pyx_t_2;
  __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":1268
 *     k2_haps=k2.split('/')
 *     k1_hap=k1.split('/')[0]
 *     out=[]             # <<<<<<<<<<<<<<
 *     for x in k2_haps:
 *         if x==k1_hap: out.append('NA')
 */
  __pyx_t_2 = PyList_New(0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1268, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_v_out = ((PyObject*)__pyx_t_2);
  __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":1269
 *     k1_hap=k1.split('/')[0]
 *     out=[]
 *     for x in k2_haps:             # <<<<<<<<<<<<<<
 *         if x==k1_hap: out.append('NA')
 *         else:
 */
  if (likely(PyList_CheckExact(__pyx_v_k2_haps)) || PyTuple_CheckExact(__pyx_v_k2_haps)) {
    __pyx_t_2 = __pyx_v_k2_haps; __Pyx_INCREF(__pyx_t_2); __pyx_t_3 = 0;
    __pyx_t_4 = NULL;
  } else {
    __pyx_t_3 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_v_k2_haps); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1269, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_4 = Py_TYPE(__pyx_t_2)->tp_iternext; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1269, __pyx_L1_error)
  }
  for (;;) {
    if (likely(!__pyx_t_4)) {
      if (likely(PyList_CheckExact(__pyx_t_2))) {
        if (__pyx_t_3 >= PyList_GET_SIZE(__pyx_t_2)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_1 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_3); __Pyx_INCREF(__pyx_t_1); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 1269, __pyx_L1_error)
        #else
        __pyx_t_1 = PySequence_ITEM(__pyx_t_2, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1269, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        #endif
      } else {
        if (__pyx_t_3 >= PyTuple_GET_SIZE(__pyx_t_2)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_3); __Pyx_INCREF(__pyx_t_1); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 1269, __pyx_L1_error)
        #else
        __pyx_t_1 = PySequence_ITEM(__pyx_t_2, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1269, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        #endif
      }
    } else {
      __pyx_t_1 = __pyx_t_4(__pyx_t_2);
      if (unlikely(!__pyx_t_1)) {
        PyObject* exc_type = PyErr_Occurred();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
          else __PYX_ERR(0, 1269, __pyx_L1_error)
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_1);
    }
    __Pyx_XDECREF_SET(__pyx_v_x, __pyx_t_1);
    __pyx_t_1 = 0;

    /* "vapor_vali/Simple_function.pyx":1270
 *     out=[]
 *     for x in k2_haps:
 *         if x==k1_hap: out.append('NA')             # <<<<<<<<<<<<<<
 *         else:
 *             out.append(simple_disdup_haploid_decide(k1_hap,x))
 */
    __pyx_t_1 = PyObject_RichCompare(__pyx_v_x, __pyx_v_k1_hap, Py_EQ); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1270, __pyx_L1_error)
    __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 1270, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    if (__pyx_t_5) {
      __pyx_t_6 = __Pyx_PyList_Append(__pyx_v_out, __pyx_n_s_NA); if (unlikely(__pyx_t_6 == -1)) __PYX_ERR(0, 1270, __pyx_L1_error)
      goto __pyx_L5;
    }

    /* "vapor_vali/Simple_function.pyx":1272
 *         if x==k1_hap: out.append('NA')
 *         else:
 *             out.append(simple_disdup_haploid_decide(k1_hap,x))             # <<<<<<<<<<<<<<
 *     return out
 * 
 */
    /*else*/ {
      __pyx_t_7 = __Pyx_GetModuleGlobalName(__pyx_n_s_simple_disdup_haploid_decide); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1272, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_7);
      __pyx_t_8 = NULL;
      __pyx_t_9 = 0;
      if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_7))) {
        __pyx_t_8 = PyMethod_GET_SELF(__pyx_t_7);
        if (likely(__pyx_t_8)) {
          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_7);
          __Pyx_INCREF(__pyx_t_8);
          __Pyx_INCREF(function);
          __Pyx_DECREF_SET(__pyx_t_7, function);
          __pyx_t_9 = 1;
        }
      }
      __pyx_t_10 = PyTuple_New(2+__pyx_t_9); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1272, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_10);
      if (__pyx_t_8) {
        __Pyx_GIVEREF(__pyx_t_8); PyTuple_SET_ITEM(__pyx_t_10, 0, __pyx_t_8); __pyx_t_8 = NULL;
      }
      __Pyx_INCREF(__pyx_v_k1_hap);
      __Pyx_GIVEREF(__pyx_v_k1_hap);
      PyTuple_SET_ITEM(__pyx_t_10, 0+__pyx_t_9, __pyx_v_k1_hap);
      __Pyx_INCREF(__pyx_v_x);
      __Pyx_GIVEREF(__pyx_v_x);
      PyTuple_SET_ITEM(__pyx_t_10, 1+__pyx_t_9, __pyx_v_x);
      __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_7, __pyx_t_10, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1272, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
      __pyx_t_6 = __Pyx_PyList_Append(__pyx_v_out, __pyx_t_1); if (unlikely(__pyx_t_6 == -1)) __PYX_ERR(0, 1272, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    }
    __pyx_L5:;

    /* "vapor_vali/Simple_function.pyx":1269
 *     k1_hap=k1.split('/')[0]
 *     out=[]
 *     for x in k2_haps:             # <<<<<<<<<<<<<<
 *         if x==k1_hap: out.append('NA')
 *         else:
 */
  }
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":1273
 *         else:
 *             out.append(simple_disdup_haploid_decide(k1_hap,x))
 *     return out             # <<<<<<<<<<<<<<
 * 
 * def simple_disdup_haploid_decide(k1_hap,k2_hap):
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_out);
  __pyx_r = __pyx_v_out;
  goto __pyx_L0;

  /* "vapor_vali/Simple_function.pyx":1264
 *     return 'FALSE'
 * 
 * def simple_disdup_diploid_decide(k1,k2):             # <<<<<<<<<<<<<<
 *     #eg of k1='ab/ab'   ; eg of k2='bab/ab'
 *     k2_haps=k2.split('/')
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_7);
  __Pyx_XDECREF(__pyx_t_8);
  __Pyx_XDECREF(__pyx_t_10);
  __Pyx_AddTraceback("vapor_vali.Simple_function.simple_disdup_diploid_decide", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_k2_haps);
  __Pyx_XDECREF(__pyx_v_k1_hap);
  __Pyx_XDECREF(__pyx_v_out);
  __Pyx_XDECREF(__pyx_v_x);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "vapor_vali/Simple_function.pyx":1275
 *     return out
 * 
 * def simple_disdup_haploid_decide(k1_hap,k2_hap):             # <<<<<<<<<<<<<<
 *     #eg of k1_hap='abcd'    ;   eg of k2_hap='babdcd'
 *     if not '^' in k2_hap:
 */

/* Python wrapper */
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_179simple_disdup_haploid_decide(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_10vapor_vali_15Simple_function_179simple_disdup_haploid_decide = {"simple_disdup_haploid_decide", (PyCFunction)__pyx_pw_10vapor_vali_15Simple_function_179simple_disdup_haploid_decide, METH_VARARGS|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_179simple_disdup_haploid_decide(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_k1_hap = 0;
  PyObject *__pyx_v_k2_hap = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("simple_disdup_haploid_decide (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_k1_hap,&__pyx_n_s_k2_hap,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_k1_hap)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_k2_hap)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("simple_disdup_haploid_decide", 1, 2, 2, 1); __PYX_ERR(0, 1275, __pyx_L3_error)
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "simple_disdup_haploid_decide") < 0)) __PYX_ERR(0, 1275, __pyx_L3_error)
      }
    } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
    }
    __pyx_v_k1_hap = values[0];
    __pyx_v_k2_hap = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("simple_disdup_haploid_decide", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1275, __pyx_L3_error)
  __pyx_L3_error:;
  __Pyx_AddTraceback("vapor_vali.Simple_function.simple_disdup_haploid_decide", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_10vapor_vali_15Simple_function_178simple_disdup_haploid_decide(__pyx_self, __pyx_v_k1_hap, __pyx_v_k2_hap);

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10vapor_vali_15Simple_function_178simple_disdup_haploid_decide(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_k1_hap, PyObject *__pyx_v_k2_hap) {
  PyObject *__pyx_v_dup_dis = NULL;
  PyObject *__pyx_v_overlap = NULL;
  PyObject *__pyx_v_dup_count = NULL;
  PyObject *__pyx_v_dup_block = NULL;
  PyObject *__pyx_v_dup_block_combined = NULL;
  PyObject *__pyx_v_dis_dup_check = NULL;
  PyObject *__pyx_v_no_dup_block = NULL;
  PyObject *__pyx_v_x = NULL;
  PyObject *__pyx_v_y = NULL;
  PyObject *__pyx_v_original_pos = NULL;
  PyObject *__pyx_v_x_modify_new = NULL;
  PyObject *__pyx_v_temp_structure = NULL;
  PyObject *__pyx_v_insert_pos = NULL;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_v_j = NULL;
  PyObject *__pyx_v_k2_hap_new = NULL;
  PyObject *__pyx_v_insert_block = NULL;
  PyObject *__pyx_v_pos_rec = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  int __pyx_t_2;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  Py_ssize_t __pyx_t_6;
  PyObject *__pyx_t_7 = NULL;
  PyObject *(*__pyx_t_8)(PyObject *);
  PyObject *__pyx_t_9 = NULL;
  PyObject *__pyx_t_10 = NULL;
  PyObject *__pyx_t_11 = NULL;
  Py_ssize_t __pyx_t_12;
  PyObject *__pyx_t_13 = NULL;
  int __pyx_t_14;
  int __pyx_t_15;
  Py_ssize_t __pyx_t_16;
  PyObject *(*__pyx_t_17)(PyObject *);
  __Pyx_RefNannySetupContext("simple_disdup_haploid_decide", 0);

  /* "vapor_vali/Simple_function.pyx":1277
 * def simple_disdup_haploid_decide(k1_hap,k2_hap):
 *     #eg of k1_hap='abcd'    ;   eg of k2_hap='babdcd'
 *     if not '^' in k2_hap:             # <<<<<<<<<<<<<<
 *         if simple_tandup_haploid_decide(k1_hap,k2_hap)=='FALSE':
 *             dup_dis=letter_subgroup(k2_hap)
 */
  __pyx_t_1 = (__Pyx_PySequence_ContainsTF(__pyx_kp_s__7, __pyx_v_k2_hap, Py_NE)); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(0, 1277, __pyx_L1_error)
  __pyx_t_2 = (__pyx_t_1 != 0);
  if (__pyx_t_2) {

    /* "vapor_vali/Simple_function.pyx":1278
 *     #eg of k1_hap='abcd'    ;   eg of k2_hap='babdcd'
 *     if not '^' in k2_hap:
 *         if simple_tandup_haploid_decide(k1_hap,k2_hap)=='FALSE':             # <<<<<<<<<<<<<<
 *             dup_dis=letter_subgroup(k2_hap)
 *             overlap=[intersect(dup_dis[i],dup_dis[i+1]) for i in range(len(dup_dis)-1)]
 */
    __pyx_t_4 = __Pyx_GetModuleGlobalName(__pyx_n_s_simple_tandup_haploid_decide); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1278, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_5 = NULL;
    __pyx_t_6 = 0;
    if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_4))) {
      __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_4);
      if (likely(__pyx_t_5)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
        __Pyx_INCREF(__pyx_t_5);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_4, function);
        __pyx_t_6 = 1;
      }
    }
    __pyx_t_7 = PyTuple_New(2+__pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1278, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    if (__pyx_t_5) {
      __Pyx_GIVEREF(__pyx_t_5); PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_5); __pyx_t_5 = NULL;
    }
    __Pyx_INCREF(__pyx_v_k1_hap);
    __Pyx_GIVEREF(__pyx_v_k1_hap);
    PyTuple_SET_ITEM(__pyx_t_7, 0+__pyx_t_6, __pyx_v_k1_hap);
    __Pyx_INCREF(__pyx_v_k2_hap);
    __Pyx_GIVEREF(__pyx_v_k2_hap);
    PyTuple_SET_ITEM(__pyx_t_7, 1+__pyx_t_6, __pyx_v_k2_hap);
    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_7, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1278, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_2 = (__Pyx_PyString_Equals(__pyx_t_3, __pyx_n_s_FALSE, Py_EQ)); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 1278, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    if (__pyx_t_2) {

      /* "vapor_vali/Simple_function.pyx":1279
 *     if not '^' in k2_hap:
 *         if simple_tandup_haploid_decide(k1_hap,k2_hap)=='FALSE':
 *             dup_dis=letter_subgroup(k2_hap)             # <<<<<<<<<<<<<<
 *             overlap=[intersect(dup_dis[i],dup_dis[i+1]) for i in range(len(dup_dis)-1)]
 *             if len(list_unify(overlap))==len(overlap):
 */
      __pyx_t_4 = __Pyx_GetModuleGlobalName(__pyx_n_s_letter_subgroup); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1279, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_t_7 = NULL;
      if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_4))) {
        __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_4);
        if (likely(__pyx_t_7)) {
          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
          __Pyx_INCREF(__pyx_t_7);
          __Pyx_INCREF(function);
          __Pyx_DECREF_SET(__pyx_t_4, function);
        }
      }
      if (!__pyx_t_7) {
        __pyx_t_3 = __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_v_k2_hap); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1279, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_3);
      } else {
        __pyx_t_5 = PyTuple_New(1+1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1279, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_5);
        __Pyx_GIVEREF(__pyx_t_7); PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_7); __pyx_t_7 = NULL;
        __Pyx_INCREF(__pyx_v_k2_hap);
        __Pyx_GIVEREF(__pyx_v_k2_hap);
        PyTuple_SET_ITEM(__pyx_t_5, 0+1, __pyx_v_k2_hap);
        __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_5, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1279, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_3);
        __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
      }
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_v_dup_dis = __pyx_t_3;
      __pyx_t_3 = 0;

      /* "vapor_vali/Simple_function.pyx":1280
 *         if simple_tandup_haploid_decide(k1_hap,k2_hap)=='FALSE':
 *             dup_dis=letter_subgroup(k2_hap)
 *             overlap=[intersect(dup_dis[i],dup_dis[i+1]) for i in range(len(dup_dis)-1)]             # <<<<<<<<<<<<<<
 *             if len(list_unify(overlap))==len(overlap):
 *                 dup_count=[k2_hap.count(i) for i in k1_hap]
 */
      __pyx_t_3 = PyList_New(0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1280, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __pyx_t_6 = PyObject_Length(__pyx_v_dup_dis); if (unlikely(__pyx_t_6 == -1)) __PYX_ERR(0, 1280, __pyx_L1_error)
      __pyx_t_4 = PyInt_FromSsize_t((__pyx_t_6 - 1)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1280, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1280, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_5);
      __Pyx_GIVEREF(__pyx_t_4);
      PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_4);
      __pyx_t_4 = 0;
      __pyx_t_4 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_t_5, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1280, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
      if (likely(PyList_CheckExact(__pyx_t_4)) || PyTuple_CheckExact(__pyx_t_4)) {
        __pyx_t_5 = __pyx_t_4; __Pyx_INCREF(__pyx_t_5); __pyx_t_6 = 0;
        __pyx_t_8 = NULL;
      } else {
        __pyx_t_6 = -1; __pyx_t_5 = PyObject_GetIter(__pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1280, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_5);
        __pyx_t_8 = Py_TYPE(__pyx_t_5)->tp_iternext; if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1280, __pyx_L1_error)
      }
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      for (;;) {
        if (likely(!__pyx_t_8)) {
          if (likely(PyList_CheckExact(__pyx_t_5))) {
            if (__pyx_t_6 >= PyList_GET_SIZE(__pyx_t_5)) break;
            #if CYTHON_COMPILING_IN_CPYTHON
            __pyx_t_4 = PyList_GET_ITEM(__pyx_t_5, __pyx_t_6); __Pyx_INCREF(__pyx_t_4); __pyx_t_6++; if (unlikely(0 < 0)) __PYX_ERR(0, 1280, __pyx_L1_error)
            #else
            __pyx_t_4 = PySequence_ITEM(__pyx_t_5, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1280, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_4);
            #endif
          } else {
            if (__pyx_t_6 >= PyTuple_GET_SIZE(__pyx_t_5)) break;
            #if CYTHON_COMPILING_IN_CPYTHON
            __pyx_t_4 = PyTuple_GET_ITEM(__pyx_t_5, __pyx_t_6); __Pyx_INCREF(__pyx_t_4); __pyx_t_6++; if (unlikely(0 < 0)) __PYX_ERR(0, 1280, __pyx_L1_error)
            #else
            __pyx_t_4 = PySequence_ITEM(__pyx_t_5, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1280, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_4);
            #endif
          }
        } else {
          __pyx_t_4 = __pyx_t_8(__pyx_t_5);
          if (unlikely(!__pyx_t_4)) {
            PyObject* exc_type = PyErr_Occurred();
            if (exc_type) {
              if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
              else __PYX_ERR(0, 1280, __pyx_L1_error)
            }
            break;
          }
          __Pyx_GOTREF(__pyx_t_4);
        }
        __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_4);
        __pyx_t_4 = 0;
        __pyx_t_7 = __Pyx_GetModuleGlobalName(__pyx_n_s_intersect); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1280, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_7);
        __pyx_t_9 = PyObject_GetItem(__pyx_v_dup_dis, __pyx_v_i); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1280, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_9);
        __pyx_t_10 = __Pyx_PyInt_AddObjC(__pyx_v_i, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1280, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_10);
        __pyx_t_11 = PyObject_GetItem(__pyx_v_dup_dis, __pyx_t_10); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1280, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_11);
        __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
        __pyx_t_10 = NULL;
        __pyx_t_12 = 0;
        if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_7))) {
          __pyx_t_10 = PyMethod_GET_SELF(__pyx_t_7);
          if (likely(__pyx_t_10)) {
            PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_7);
            __Pyx_INCREF(__pyx_t_10);
            __Pyx_INCREF(function);
            __Pyx_DECREF_SET(__pyx_t_7, function);
            __pyx_t_12 = 1;
          }
        }
        __pyx_t_13 = PyTuple_New(2+__pyx_t_12); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1280, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_13);
        if (__pyx_t_10) {
          __Pyx_GIVEREF(__pyx_t_10); PyTuple_SET_ITEM(__pyx_t_13, 0, __pyx_t_10); __pyx_t_10 = NULL;
        }
        __Pyx_GIVEREF(__pyx_t_9);
        PyTuple_SET_ITEM(__pyx_t_13, 0+__pyx_t_12, __pyx_t_9);
        __Pyx_GIVEREF(__pyx_t_11);
        PyTuple_SET_ITEM(__pyx_t_13, 1+__pyx_t_12, __pyx_t_11);
        __pyx_t_9 = 0;
        __pyx_t_11 = 0;
        __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_7, __pyx_t_13, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1280, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_4);
        __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
        __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
        if (unlikely(__Pyx_ListComp_Append(__pyx_t_3, (PyObject*)__pyx_t_4))) __PYX_ERR(0, 1280, __pyx_L1_error)
        __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      }
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
      __pyx_v_overlap = ((PyObject*)__pyx_t_3);
      __pyx_t_3 = 0;

      /* "vapor_vali/Simple_function.pyx":1281
 *             dup_dis=letter_subgroup(k2_hap)
 *             overlap=[intersect(dup_dis[i],dup_dis[i+1]) for i in range(len(dup_dis)-1)]
 *             if len(list_unify(overlap))==len(overlap):             # <<<<<<<<<<<<<<
 *                 dup_count=[k2_hap.count(i) for i in k1_hap]
 *                 if not min(dup_count)<1 and not max(dup_count)<2:    #deletion structure inside
 */
      __pyx_t_5 = __Pyx_GetModuleGlobalName(__pyx_n_s_list_unify); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1281, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_5);
      __pyx_t_4 = NULL;
      if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_5))) {
        __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_5);
        if (likely(__pyx_t_4)) {
          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
          __Pyx_INCREF(__pyx_t_4);
          __Pyx_INCREF(function);
          __Pyx_DECREF_SET(__pyx_t_5, function);
        }
      }
      if (!__pyx_t_4) {
        __pyx_t_3 = __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_v_overlap); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1281, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_3);
      } else {
        __pyx_t_7 = PyTuple_New(1+1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1281, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_7);
        __Pyx_GIVEREF(__pyx_t_4); PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_4); __pyx_t_4 = NULL;
        __Pyx_INCREF(__pyx_v_overlap);
        __Pyx_GIVEREF(__pyx_v_overlap);
        PyTuple_SET_ITEM(__pyx_t_7, 0+1, __pyx_v_overlap);
        __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_7, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1281, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_3);
        __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
      }
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
      __pyx_t_6 = PyObject_Length(__pyx_t_3); if (unlikely(__pyx_t_6 == -1)) __PYX_ERR(0, 1281, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_12 = PyList_GET_SIZE(__pyx_v_overlap); if (unlikely(__pyx_t_12 == -1)) __PYX_ERR(0, 1281, __pyx_L1_error)
      __pyx_t_2 = ((__pyx_t_6 == __pyx_t_12) != 0);
      if (__pyx_t_2) {

        /* "vapor_vali/Simple_function.pyx":1282
 *             overlap=[intersect(dup_dis[i],dup_dis[i+1]) for i in range(len(dup_dis)-1)]
 *             if len(list_unify(overlap))==len(overlap):
 *                 dup_count=[k2_hap.count(i) for i in k1_hap]             # <<<<<<<<<<<<<<
 *                 if not min(dup_count)<1 and not max(dup_count)<2:    #deletion structure inside
 *                     dup_block=[k1_hap[i] for i in range(len(dup_count)) if dup_count[i]>1]
 */
        __pyx_t_3 = PyList_New(0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1282, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_3);
        if (likely(PyList_CheckExact(__pyx_v_k1_hap)) || PyTuple_CheckExact(__pyx_v_k1_hap)) {
          __pyx_t_5 = __pyx_v_k1_hap; __Pyx_INCREF(__pyx_t_5); __pyx_t_12 = 0;
          __pyx_t_8 = NULL;
        } else {
          __pyx_t_12 = -1; __pyx_t_5 = PyObject_GetIter(__pyx_v_k1_hap); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1282, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_5);
          __pyx_t_8 = Py_TYPE(__pyx_t_5)->tp_iternext; if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1282, __pyx_L1_error)
        }
        for (;;) {
          if (likely(!__pyx_t_8)) {
            if (likely(PyList_CheckExact(__pyx_t_5))) {
              if (__pyx_t_12 >= PyList_GET_SIZE(__pyx_t_5)) break;
              #if CYTHON_COMPILING_IN_CPYTHON
              __pyx_t_7 = PyList_GET_ITEM(__pyx_t_5, __pyx_t_12); __Pyx_INCREF(__pyx_t_7); __pyx_t_12++; if (unlikely(0 < 0)) __PYX_ERR(0, 1282, __pyx_L1_error)
              #else
              __pyx_t_7 = PySequence_ITEM(__pyx_t_5, __pyx_t_12); __pyx_t_12++; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1282, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_7);
              #endif
            } else {
              if (__pyx_t_12 >= PyTuple_GET_SIZE(__pyx_t_5)) break;
              #if CYTHON_COMPILING_IN_CPYTHON
              __pyx_t_7 = PyTuple_GET_ITEM(__pyx_t_5, __pyx_t_12); __Pyx_INCREF(__pyx_t_7); __pyx_t_12++; if (unlikely(0 < 0)) __PYX_ERR(0, 1282, __pyx_L1_error)
              #else
              __pyx_t_7 = PySequence_ITEM(__pyx_t_5, __pyx_t_12); __pyx_t_12++; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1282, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_7);
              #endif
            }
          } else {
            __pyx_t_7 = __pyx_t_8(__pyx_t_5);
            if (unlikely(!__pyx_t_7)) {
              PyObject* exc_type = PyErr_Occurred();
              if (exc_type) {
                if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
                else __PYX_ERR(0, 1282, __pyx_L1_error)
              }
              break;
            }
            __Pyx_GOTREF(__pyx_t_7);
          }
          __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_7);
          __pyx_t_7 = 0;
          __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_k2_hap, __pyx_n_s_count); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1282, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_4);
          __pyx_t_13 = NULL;
          if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_4))) {
            __pyx_t_13 = PyMethod_GET_SELF(__pyx_t_4);
            if (likely(__pyx_t_13)) {
              PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
              __Pyx_INCREF(__pyx_t_13);
              __Pyx_INCREF(function);
              __Pyx_DECREF_SET(__pyx_t_4, function);
            }
          }
          if (!__pyx_t_13) {
            __pyx_t_7 = __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_v_i); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1282, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_7);
          } else {
            __pyx_t_11 = PyTuple_New(1+1); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1282, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_11);
            __Pyx_GIVEREF(__pyx_t_13); PyTuple_SET_ITEM(__pyx_t_11, 0, __pyx_t_13); __pyx_t_13 = NULL;
            __Pyx_INCREF(__pyx_v_i);
            __Pyx_GIVEREF(__pyx_v_i);
            PyTuple_SET_ITEM(__pyx_t_11, 0+1, __pyx_v_i);
            __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_11, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1282, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_7);
            __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
          }
          __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
          if (unlikely(__Pyx_ListComp_Append(__pyx_t_3, (PyObject*)__pyx_t_7))) __PYX_ERR(0, 1282, __pyx_L1_error)
          __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
        }
        __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
        __pyx_v_dup_count = ((PyObject*)__pyx_t_3);
        __pyx_t_3 = 0;

        /* "vapor_vali/Simple_function.pyx":1283
 *             if len(list_unify(overlap))==len(overlap):
 *                 dup_count=[k2_hap.count(i) for i in k1_hap]
 *                 if not min(dup_count)<1 and not max(dup_count)<2:    #deletion structure inside             # <<<<<<<<<<<<<<
 *                     dup_block=[k1_hap[i] for i in range(len(dup_count)) if dup_count[i]>1]
 *                     dup_block_combined=dup_block_combine(dup_block,k1_hap,k2_hap)
 */
        __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1283, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_3);
        __Pyx_INCREF(__pyx_v_dup_count);
        __Pyx_GIVEREF(__pyx_v_dup_count);
        PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_v_dup_count);
        __pyx_t_5 = __Pyx_PyObject_Call(__pyx_builtin_min, __pyx_t_3, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1283, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_5);
        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
        __pyx_t_3 = PyObject_RichCompare(__pyx_t_5, __pyx_int_1, Py_LT); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1283, __pyx_L1_error)
        __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
        __pyx_t_1 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(0, 1283, __pyx_L1_error)
        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
        __pyx_t_14 = ((!__pyx_t_1) != 0);
        if (__pyx_t_14) {
        } else {
          __pyx_t_2 = __pyx_t_14;
          goto __pyx_L11_bool_binop_done;
        }
        __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1283, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_3);
        __Pyx_INCREF(__pyx_v_dup_count);
        __Pyx_GIVEREF(__pyx_v_dup_count);
        PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_v_dup_count);
        __pyx_t_5 = __Pyx_PyObject_Call(__pyx_builtin_max, __pyx_t_3, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1283, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_5);
        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
        __pyx_t_3 = PyObject_RichCompare(__pyx_t_5, __pyx_int_2, Py_LT); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1283, __pyx_L1_error)
        __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
        __pyx_t_14 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_14 < 0)) __PYX_ERR(0, 1283, __pyx_L1_error)
        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
        __pyx_t_1 = ((!__pyx_t_14) != 0);
        __pyx_t_2 = __pyx_t_1;
        __pyx_L11_bool_binop_done:;
        if (__pyx_t_2) {

          /* "vapor_vali/Simple_function.pyx":1284
 *                 dup_count=[k2_hap.count(i) for i in k1_hap]
 *                 if not min(dup_count)<1 and not max(dup_count)<2:    #deletion structure inside
 *                     dup_block=[k1_hap[i] for i in range(len(dup_count)) if dup_count[i]>1]             # <<<<<<<<<<<<<<
 *                     dup_block_combined=dup_block_combine(dup_block,k1_hap,k2_hap)
 *                     dis_dup_check=[]
 */
          __pyx_t_3 = PyList_New(0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1284, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_3);
          __pyx_t_12 = PyList_GET_SIZE(__pyx_v_dup_count); if (unlikely(__pyx_t_12 == -1)) __PYX_ERR(0, 1284, __pyx_L1_error)
          __pyx_t_5 = PyInt_FromSsize_t(__pyx_t_12); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1284, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_5);
          __pyx_t_7 = PyTuple_New(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1284, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_7);
          __Pyx_GIVEREF(__pyx_t_5);
          PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_5);
          __pyx_t_5 = 0;
          __pyx_t_5 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_t_7, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1284, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_5);
          __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
          if (likely(PyList_CheckExact(__pyx_t_5)) || PyTuple_CheckExact(__pyx_t_5)) {
            __pyx_t_7 = __pyx_t_5; __Pyx_INCREF(__pyx_t_7); __pyx_t_12 = 0;
            __pyx_t_8 = NULL;
          } else {
            __pyx_t_12 = -1; __pyx_t_7 = PyObject_GetIter(__pyx_t_5); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1284, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_7);
            __pyx_t_8 = Py_TYPE(__pyx_t_7)->tp_iternext; if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1284, __pyx_L1_error)
          }
          __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
          for (;;) {
            if (likely(!__pyx_t_8)) {
              if (likely(PyList_CheckExact(__pyx_t_7))) {
                if (__pyx_t_12 >= PyList_GET_SIZE(__pyx_t_7)) break;
                #if CYTHON_COMPILING_IN_CPYTHON
                __pyx_t_5 = PyList_GET_ITEM(__pyx_t_7, __pyx_t_12); __Pyx_INCREF(__pyx_t_5); __pyx_t_12++; if (unlikely(0 < 0)) __PYX_ERR(0, 1284, __pyx_L1_error)
                #else
                __pyx_t_5 = PySequence_ITEM(__pyx_t_7, __pyx_t_12); __pyx_t_12++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1284, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_5);
                #endif
              } else {
                if (__pyx_t_12 >= PyTuple_GET_SIZE(__pyx_t_7)) break;
                #if CYTHON_COMPILING_IN_CPYTHON
                __pyx_t_5 = PyTuple_GET_ITEM(__pyx_t_7, __pyx_t_12); __Pyx_INCREF(__pyx_t_5); __pyx_t_12++; if (unlikely(0 < 0)) __PYX_ERR(0, 1284, __pyx_L1_error)
                #else
                __pyx_t_5 = PySequence_ITEM(__pyx_t_7, __pyx_t_12); __pyx_t_12++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1284, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_5);
                #endif
              }
            } else {
              __pyx_t_5 = __pyx_t_8(__pyx_t_7);
              if (unlikely(!__pyx_t_5)) {
                PyObject* exc_type = PyErr_Occurred();
                if (exc_type) {
                  if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
                  else __PYX_ERR(0, 1284, __pyx_L1_error)
                }
                break;
              }
              __Pyx_GOTREF(__pyx_t_5);
            }
            __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_5);
            __pyx_t_5 = 0;
            __pyx_t_5 = PyObject_GetItem(__pyx_v_dup_count, __pyx_v_i); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1284, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_5);
            __pyx_t_4 = PyObject_RichCompare(__pyx_t_5, __pyx_int_1, Py_GT); __Pyx_XGOTREF(__pyx_t_4); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1284, __pyx_L1_error)
            __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
            __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_4); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 1284, __pyx_L1_error)
            __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
            if (__pyx_t_2) {
              __pyx_t_4 = PyObject_GetItem(__pyx_v_k1_hap, __pyx_v_i); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1284, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_4);
              if (unlikely(__Pyx_ListComp_Append(__pyx_t_3, (PyObject*)__pyx_t_4))) __PYX_ERR(0, 1284, __pyx_L1_error)
              __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
            }
          }
          __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
          __pyx_v_dup_block = ((PyObject*)__pyx_t_3);
          __pyx_t_3 = 0;

          /* "vapor_vali/Simple_function.pyx":1285
 *                 if not min(dup_count)<1 and not max(dup_count)<2:    #deletion structure inside
 *                     dup_block=[k1_hap[i] for i in range(len(dup_count)) if dup_count[i]>1]
 *                     dup_block_combined=dup_block_combine(dup_block,k1_hap,k2_hap)             # <<<<<<<<<<<<<<
 *                     dis_dup_check=[]
 *                     no_dup_block=[]
 */
          __pyx_t_7 = __Pyx_GetModuleGlobalName(__pyx_n_s_dup_block_combine); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1285, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_7);
          __pyx_t_4 = NULL;
          __pyx_t_12 = 0;
          if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_7))) {
            __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_7);
            if (likely(__pyx_t_4)) {
              PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_7);
              __Pyx_INCREF(__pyx_t_4);
              __Pyx_INCREF(function);
              __Pyx_DECREF_SET(__pyx_t_7, function);
              __pyx_t_12 = 1;
            }
          }
          __pyx_t_5 = PyTuple_New(3+__pyx_t_12); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1285, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_5);
          if (__pyx_t_4) {
            __Pyx_GIVEREF(__pyx_t_4); PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_4); __pyx_t_4 = NULL;
          }
          __Pyx_INCREF(__pyx_v_dup_block);
          __Pyx_GIVEREF(__pyx_v_dup_block);
          PyTuple_SET_ITEM(__pyx_t_5, 0+__pyx_t_12, __pyx_v_dup_block);
          __Pyx_INCREF(__pyx_v_k1_hap);
          __Pyx_GIVEREF(__pyx_v_k1_hap);
          PyTuple_SET_ITEM(__pyx_t_5, 1+__pyx_t_12, __pyx_v_k1_hap);
          __Pyx_INCREF(__pyx_v_k2_hap);
          __Pyx_GIVEREF(__pyx_v_k2_hap);
          PyTuple_SET_ITEM(__pyx_t_5, 2+__pyx_t_12, __pyx_v_k2_hap);
          __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_7, __pyx_t_5, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1285, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_3);
          __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
          __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
          __pyx_v_dup_block_combined = __pyx_t_3;
          __pyx_t_3 = 0;

          /* "vapor_vali/Simple_function.pyx":1286
 *                     dup_block=[k1_hap[i] for i in range(len(dup_count)) if dup_count[i]>1]
 *                     dup_block_combined=dup_block_combine(dup_block,k1_hap,k2_hap)
 *                     dis_dup_check=[]             # <<<<<<<<<<<<<<
 *                     no_dup_block=[]
 *                     for x in k2_hap:
 */
          __pyx_t_3 = PyList_New(0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1286, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_3);
          __pyx_v_dis_dup_check = ((PyObject*)__pyx_t_3);
          __pyx_t_3 = 0;

          /* "vapor_vali/Simple_function.pyx":1287
 *                     dup_block_combined=dup_block_combine(dup_block,k1_hap,k2_hap)
 *                     dis_dup_check=[]
 *                     no_dup_block=[]             # <<<<<<<<<<<<<<
 *                     for x in k2_hap:
 *                         if not x in dup_block:
 */
          __pyx_t_3 = PyList_New(0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1287, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_3);
          __pyx_v_no_dup_block = ((PyObject*)__pyx_t_3);
          __pyx_t_3 = 0;

          /* "vapor_vali/Simple_function.pyx":1288
 *                     dis_dup_check=[]
 *                     no_dup_block=[]
 *                     for x in k2_hap:             # <<<<<<<<<<<<<<
 *                         if not x in dup_block:
 *                             no_dup_block.append(k2_hap.index(x))
 */
          if (likely(PyList_CheckExact(__pyx_v_k2_hap)) || PyTuple_CheckExact(__pyx_v_k2_hap)) {
            __pyx_t_3 = __pyx_v_k2_hap; __Pyx_INCREF(__pyx_t_3); __pyx_t_12 = 0;
            __pyx_t_8 = NULL;
          } else {
            __pyx_t_12 = -1; __pyx_t_3 = PyObject_GetIter(__pyx_v_k2_hap); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1288, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_3);
            __pyx_t_8 = Py_TYPE(__pyx_t_3)->tp_iternext; if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1288, __pyx_L1_error)
          }
          for (;;) {
            if (likely(!__pyx_t_8)) {
              if (likely(PyList_CheckExact(__pyx_t_3))) {
                if (__pyx_t_12 >= PyList_GET_SIZE(__pyx_t_3)) break;
                #if CYTHON_COMPILING_IN_CPYTHON
                __pyx_t_7 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_12); __Pyx_INCREF(__pyx_t_7); __pyx_t_12++; if (unlikely(0 < 0)) __PYX_ERR(0, 1288, __pyx_L1_error)
                #else
                __pyx_t_7 = PySequence_ITEM(__pyx_t_3, __pyx_t_12); __pyx_t_12++; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1288, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_7);
                #endif
              } else {
                if (__pyx_t_12 >= PyTuple_GET_SIZE(__pyx_t_3)) break;
                #if CYTHON_COMPILING_IN_CPYTHON
                __pyx_t_7 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_12); __Pyx_INCREF(__pyx_t_7); __pyx_t_12++; if (unlikely(0 < 0)) __PYX_ERR(0, 1288, __pyx_L1_error)
                #else
                __pyx_t_7 = PySequence_ITEM(__pyx_t_3, __pyx_t_12); __pyx_t_12++; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1288, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_7);
                #endif
              }
            } else {
              __pyx_t_7 = __pyx_t_8(__pyx_t_3);
              if (unlikely(!__pyx_t_7)) {
                PyObject* exc_type = PyErr_Occurred();
                if (exc_type) {
                  if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
                  else __PYX_ERR(0, 1288, __pyx_L1_error)
                }
                break;
              }
              __Pyx_GOTREF(__pyx_t_7);
            }
            __Pyx_XDECREF_SET(__pyx_v_x, __pyx_t_7);
            __pyx_t_7 = 0;

            /* "vapor_vali/Simple_function.pyx":1289
 *                     no_dup_block=[]
 *                     for x in k2_hap:
 *                         if not x in dup_block:             # <<<<<<<<<<<<<<
 *                             no_dup_block.append(k2_hap.index(x))
 *                     for x in dup_block_combined:
 */
            __pyx_t_2 = (__Pyx_PySequence_ContainsTF(__pyx_v_x, __pyx_v_dup_block, Py_NE)); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 1289, __pyx_L1_error)
            __pyx_t_1 = (__pyx_t_2 != 0);
            if (__pyx_t_1) {

              /* "vapor_vali/Simple_function.pyx":1290
 *                     for x in k2_hap:
 *                         if not x in dup_block:
 *                             no_dup_block.append(k2_hap.index(x))             # <<<<<<<<<<<<<<
 *                     for x in dup_block_combined:
 *                         dis_dup_check.append([])
 */
              __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_k2_hap, __pyx_n_s_index); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1290, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_5);
              __pyx_t_4 = NULL;
              if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_5))) {
                __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_5);
                if (likely(__pyx_t_4)) {
                  PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
                  __Pyx_INCREF(__pyx_t_4);
                  __Pyx_INCREF(function);
                  __Pyx_DECREF_SET(__pyx_t_5, function);
                }
              }
              if (!__pyx_t_4) {
                __pyx_t_7 = __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_v_x); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1290, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_7);
              } else {
                __pyx_t_11 = PyTuple_New(1+1); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1290, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_11);
                __Pyx_GIVEREF(__pyx_t_4); PyTuple_SET_ITEM(__pyx_t_11, 0, __pyx_t_4); __pyx_t_4 = NULL;
                __Pyx_INCREF(__pyx_v_x);
                __Pyx_GIVEREF(__pyx_v_x);
                PyTuple_SET_ITEM(__pyx_t_11, 0+1, __pyx_v_x);
                __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_11, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1290, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_7);
                __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
              }
              __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
              __pyx_t_15 = __Pyx_PyList_Append(__pyx_v_no_dup_block, __pyx_t_7); if (unlikely(__pyx_t_15 == -1)) __PYX_ERR(0, 1290, __pyx_L1_error)
              __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;

              /* "vapor_vali/Simple_function.pyx":1289
 *                     no_dup_block=[]
 *                     for x in k2_hap:
 *                         if not x in dup_block:             # <<<<<<<<<<<<<<
 *                             no_dup_block.append(k2_hap.index(x))
 *                     for x in dup_block_combined:
 */
            }

            /* "vapor_vali/Simple_function.pyx":1288
 *                     dis_dup_check=[]
 *                     no_dup_block=[]
 *                     for x in k2_hap:             # <<<<<<<<<<<<<<
 *                         if not x in dup_block:
 *                             no_dup_block.append(k2_hap.index(x))
 */
          }
          __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;

          /* "vapor_vali/Simple_function.pyx":1291
 *                         if not x in dup_block:
 *                             no_dup_block.append(k2_hap.index(x))
 *                     for x in dup_block_combined:             # <<<<<<<<<<<<<<
 *                         dis_dup_check.append([])
 *                         for y in range(len(k2_hap)-len(x)+1):
 */
          if (likely(PyList_CheckExact(__pyx_v_dup_block_combined)) || PyTuple_CheckExact(__pyx_v_dup_block_combined)) {
            __pyx_t_3 = __pyx_v_dup_block_combined; __Pyx_INCREF(__pyx_t_3); __pyx_t_12 = 0;
            __pyx_t_8 = NULL;
          } else {
            __pyx_t_12 = -1; __pyx_t_3 = PyObject_GetIter(__pyx_v_dup_block_combined); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1291, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_3);
            __pyx_t_8 = Py_TYPE(__pyx_t_3)->tp_iternext; if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1291, __pyx_L1_error)
          }
          for (;;) {
            if (likely(!__pyx_t_8)) {
              if (likely(PyList_CheckExact(__pyx_t_3))) {
                if (__pyx_t_12 >= PyList_GET_SIZE(__pyx_t_3)) break;
                #if CYTHON_COMPILING_IN_CPYTHON
                __pyx_t_7 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_12); __Pyx_INCREF(__pyx_t_7); __pyx_t_12++; if (unlikely(0 < 0)) __PYX_ERR(0, 1291, __pyx_L1_error)
                #else
                __pyx_t_7 = PySequence_ITEM(__pyx_t_3, __pyx_t_12); __pyx_t_12++; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1291, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_7);
                #endif
              } else {
                if (__pyx_t_12 >= PyTuple_GET_SIZE(__pyx_t_3)) break;
                #if CYTHON_COMPILING_IN_CPYTHON
                __pyx_t_7 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_12); __Pyx_INCREF(__pyx_t_7); __pyx_t_12++; if (unlikely(0 < 0)) __PYX_ERR(0, 1291, __pyx_L1_error)
                #else
                __pyx_t_7 = PySequence_ITEM(__pyx_t_3, __pyx_t_12); __pyx_t_12++; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1291, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_7);
                #endif
              }
            } else {
              __pyx_t_7 = __pyx_t_8(__pyx_t_3);
              if (unlikely(!__pyx_t_7)) {
                PyObject* exc_type = PyErr_Occurred();
                if (exc_type) {
                  if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
                  else __PYX_ERR(0, 1291, __pyx_L1_error)
                }
                break;
              }
              __Pyx_GOTREF(__pyx_t_7);
            }
            __Pyx_XDECREF_SET(__pyx_v_x, __pyx_t_7);
            __pyx_t_7 = 0;

            /* "vapor_vali/Simple_function.pyx":1292
 *                             no_dup_block.append(k2_hap.index(x))
 *                     for x in dup_block_combined:
 *                         dis_dup_check.append([])             # <<<<<<<<<<<<<<
 *                         for y in range(len(k2_hap)-len(x)+1):
 *                             if k2_hap[y:(y+len(x))]==x:
 */
            __pyx_t_7 = PyList_New(0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1292, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_7);
            __pyx_t_15 = __Pyx_PyList_Append(__pyx_v_dis_dup_check, __pyx_t_7); if (unlikely(__pyx_t_15 == -1)) __PYX_ERR(0, 1292, __pyx_L1_error)
            __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;

            /* "vapor_vali/Simple_function.pyx":1293
 *                     for x in dup_block_combined:
 *                         dis_dup_check.append([])
 *                         for y in range(len(k2_hap)-len(x)+1):             # <<<<<<<<<<<<<<
 *                             if k2_hap[y:(y+len(x))]==x:
 *                                 dis_dup_check[-1].append(y)
 */
            __pyx_t_6 = PyObject_Length(__pyx_v_k2_hap); if (unlikely(__pyx_t_6 == -1)) __PYX_ERR(0, 1293, __pyx_L1_error)
            __pyx_t_16 = PyObject_Length(__pyx_v_x); if (unlikely(__pyx_t_16 == -1)) __PYX_ERR(0, 1293, __pyx_L1_error)
            __pyx_t_7 = PyInt_FromSsize_t(((__pyx_t_6 - __pyx_t_16) + 1)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1293, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_7);
            __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1293, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_5);
            __Pyx_GIVEREF(__pyx_t_7);
            PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_7);
            __pyx_t_7 = 0;
            __pyx_t_7 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_t_5, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1293, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_7);
            __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
            if (likely(PyList_CheckExact(__pyx_t_7)) || PyTuple_CheckExact(__pyx_t_7)) {
              __pyx_t_5 = __pyx_t_7; __Pyx_INCREF(__pyx_t_5); __pyx_t_16 = 0;
              __pyx_t_17 = NULL;
            } else {
              __pyx_t_16 = -1; __pyx_t_5 = PyObject_GetIter(__pyx_t_7); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1293, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_5);
              __pyx_t_17 = Py_TYPE(__pyx_t_5)->tp_iternext; if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 1293, __pyx_L1_error)
            }
            __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
            for (;;) {
              if (likely(!__pyx_t_17)) {
                if (likely(PyList_CheckExact(__pyx_t_5))) {
                  if (__pyx_t_16 >= PyList_GET_SIZE(__pyx_t_5)) break;
                  #if CYTHON_COMPILING_IN_CPYTHON
                  __pyx_t_7 = PyList_GET_ITEM(__pyx_t_5, __pyx_t_16); __Pyx_INCREF(__pyx_t_7); __pyx_t_16++; if (unlikely(0 < 0)) __PYX_ERR(0, 1293, __pyx_L1_error)
                  #else
                  __pyx_t_7 = PySequence_ITEM(__pyx_t_5, __pyx_t_16); __pyx_t_16++; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1293, __pyx_L1_error)
                  __Pyx_GOTREF(__pyx_t_7);
                  #endif
                } else {
                  if (__pyx_t_16 >= PyTuple_GET_SIZE(__pyx_t_5)) break;
                  #if CYTHON_COMPILING_IN_CPYTHON
                  __pyx_t_7 = PyTuple_GET_ITEM(__pyx_t_5, __pyx_t_16); __Pyx_INCREF(__pyx_t_7); __pyx_t_16++; if (unlikely(0 < 0)) __PYX_ERR(0, 1293, __pyx_L1_error)
                  #else
                  __pyx_t_7 = PySequence_ITEM(__pyx_t_5, __pyx_t_16); __pyx_t_16++; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1293, __pyx_L1_error)
                  __Pyx_GOTREF(__pyx_t_7);
                  #endif
                }
              } else {
                __pyx_t_7 = __pyx_t_17(__pyx_t_5);
                if (unlikely(!__pyx_t_7)) {
                  PyObject* exc_type = PyErr_Occurred();
                  if (exc_type) {
                    if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
                    else __PYX_ERR(0, 1293, __pyx_L1_error)
                  }
                  break;
                }
                __Pyx_GOTREF(__pyx_t_7);
              }
              __Pyx_XDECREF_SET(__pyx_v_y, __pyx_t_7);
              __pyx_t_7 = 0;

              /* "vapor_vali/Simple_function.pyx":1294
 *                         dis_dup_check.append([])
 *                         for y in range(len(k2_hap)-len(x)+1):
 *                             if k2_hap[y:(y+len(x))]==x:             # <<<<<<<<<<<<<<
 *                                 dis_dup_check[-1].append(y)
 *                     original_pos=[]
 */
              __pyx_t_6 = PyObject_Length(__pyx_v_x); if (unlikely(__pyx_t_6 == -1)) __PYX_ERR(0, 1294, __pyx_L1_error)
              __pyx_t_7 = PyInt_FromSsize_t(__pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1294, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_7);
              __pyx_t_11 = PyNumber_Add(__pyx_v_y, __pyx_t_7); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1294, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_11);
              __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
              __pyx_t_7 = __Pyx_PyObject_GetSlice(__pyx_v_k2_hap, 0, 0, &__pyx_v_y, &__pyx_t_11, NULL, 0, 0, 1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1294, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_7);
              __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
              __pyx_t_11 = PyObject_RichCompare(__pyx_t_7, __pyx_v_x, Py_EQ); __Pyx_XGOTREF(__pyx_t_11); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1294, __pyx_L1_error)
              __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
              __pyx_t_1 = __Pyx_PyObject_IsTrue(__pyx_t_11); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(0, 1294, __pyx_L1_error)
              __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
              if (__pyx_t_1) {

                /* "vapor_vali/Simple_function.pyx":1295
 *                         for y in range(len(k2_hap)-len(x)+1):
 *                             if k2_hap[y:(y+len(x))]==x:
 *                                 dis_dup_check[-1].append(y)             # <<<<<<<<<<<<<<
 *                     original_pos=[]
 *                     for x in itertools.product(*dis_dup_check):
 */
                __pyx_t_11 = __Pyx_GetItemInt_List(__pyx_v_dis_dup_check, -1L, long, 1, __Pyx_PyInt_From_long, 1, 1, 1); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1295, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_11);
                __pyx_t_15 = __Pyx_PyObject_Append(__pyx_t_11, __pyx_v_y); if (unlikely(__pyx_t_15 == -1)) __PYX_ERR(0, 1295, __pyx_L1_error)
                __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;

                /* "vapor_vali/Simple_function.pyx":1294
 *                         dis_dup_check.append([])
 *                         for y in range(len(k2_hap)-len(x)+1):
 *                             if k2_hap[y:(y+len(x))]==x:             # <<<<<<<<<<<<<<
 *                                 dis_dup_check[-1].append(y)
 *                     original_pos=[]
 */
              }

              /* "vapor_vali/Simple_function.pyx":1293
 *                     for x in dup_block_combined:
 *                         dis_dup_check.append([])
 *                         for y in range(len(k2_hap)-len(x)+1):             # <<<<<<<<<<<<<<
 *                             if k2_hap[y:(y+len(x))]==x:
 *                                 dis_dup_check[-1].append(y)
 */
            }
            __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;

            /* "vapor_vali/Simple_function.pyx":1291
 *                         if not x in dup_block:
 *                             no_dup_block.append(k2_hap.index(x))
 *                     for x in dup_block_combined:             # <<<<<<<<<<<<<<
 *                         dis_dup_check.append([])
 *                         for y in range(len(k2_hap)-len(x)+1):
 */
          }
          __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;

          /* "vapor_vali/Simple_function.pyx":1296
 *                             if k2_hap[y:(y+len(x))]==x:
 *                                 dis_dup_check[-1].append(y)
 *                     original_pos=[]             # <<<<<<<<<<<<<<
 *                     for x in itertools.product(*dis_dup_check):
 *                         x_modify_new=x_to_x_modify_new(x,dup_block_combined)
 */
          __pyx_t_3 = PyList_New(0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1296, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_3);
          __pyx_v_original_pos = ((PyObject*)__pyx_t_3);
          __pyx_t_3 = 0;

          /* "vapor_vali/Simple_function.pyx":1297
 *                                 dis_dup_check[-1].append(y)
 *                     original_pos=[]
 *                     for x in itertools.product(*dis_dup_check):             # <<<<<<<<<<<<<<
 *                         x_modify_new=x_to_x_modify_new(x,dup_block_combined)
 *                         temp_structure=[k2_hap[i] for i in sorted(x_modify_new+no_dup_block)]
 */
          __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_itertools); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1297, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_3);
          __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_product); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1297, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_5);
          __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
          __pyx_t_3 = PySequence_Tuple(__pyx_v_dis_dup_check); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1297, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_3);
          __pyx_t_11 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_3, NULL); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1297, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_11);
          __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
          __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
          if (likely(PyList_CheckExact(__pyx_t_11)) || PyTuple_CheckExact(__pyx_t_11)) {
            __pyx_t_3 = __pyx_t_11; __Pyx_INCREF(__pyx_t_3); __pyx_t_12 = 0;
            __pyx_t_8 = NULL;
          } else {
            __pyx_t_12 = -1; __pyx_t_3 = PyObject_GetIter(__pyx_t_11); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1297, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_3);
            __pyx_t_8 = Py_TYPE(__pyx_t_3)->tp_iternext; if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1297, __pyx_L1_error)
          }
          __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
          for (;;) {
            if (likely(!__pyx_t_8)) {
              if (likely(PyList_CheckExact(__pyx_t_3))) {
                if (__pyx_t_12 >= PyList_GET_SIZE(__pyx_t_3)) break;
                #if CYTHON_COMPILING_IN_CPYTHON
                __pyx_t_11 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_12); __Pyx_INCREF(__pyx_t_11); __pyx_t_12++; if (unlikely(0 < 0)) __PYX_ERR(0, 1297, __pyx_L1_error)
                #else
                __pyx_t_11 = PySequence_ITEM(__pyx_t_3, __pyx_t_12); __pyx_t_12++; if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1297, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_11);
                #endif
              } else {
                if (__pyx_t_12 >= PyTuple_GET_SIZE(__pyx_t_3)) break;
                #if CYTHON_COMPILING_IN_CPYTHON
                __pyx_t_11 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_12); __Pyx_INCREF(__pyx_t_11); __pyx_t_12++; if (unlikely(0 < 0)) __PYX_ERR(0, 1297, __pyx_L1_error)
                #else
                __pyx_t_11 = PySequence_ITEM(__pyx_t_3, __pyx_t_12); __pyx_t_12++; if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1297, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_11);
                #endif
              }
            } else {
              __pyx_t_11 = __pyx_t_8(__pyx_t_3);
              if (unlikely(!__pyx_t_11)) {
                PyObject* exc_type = PyErr_Occurred();
                if (exc_type) {
                  if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
                  else __PYX_ERR(0, 1297, __pyx_L1_error)
                }
                break;
              }
              __Pyx_GOTREF(__pyx_t_11);
            }
            __Pyx_XDECREF_SET(__pyx_v_x, __pyx_t_11);
            __pyx_t_11 = 0;

            /* "vapor_vali/Simple_function.pyx":1298
 *                     original_pos=[]
 *                     for x in itertools.product(*dis_dup_check):
 *                         x_modify_new=x_to_x_modify_new(x,dup_block_combined)             # <<<<<<<<<<<<<<
 *                         temp_structure=[k2_hap[i] for i in sorted(x_modify_new+no_dup_block)]
 *                         if ''.join(temp_structure)==k1_hap:
 */
            __pyx_t_5 = __Pyx_GetModuleGlobalName(__pyx_n_s_x_to_x_modify_new); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1298, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_5);
            __pyx_t_7 = NULL;
            __pyx_t_16 = 0;
            if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_5))) {
              __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_5);
              if (likely(__pyx_t_7)) {
                PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
                __Pyx_INCREF(__pyx_t_7);
                __Pyx_INCREF(function);
                __Pyx_DECREF_SET(__pyx_t_5, function);
                __pyx_t_16 = 1;
              }
            }
            __pyx_t_4 = PyTuple_New(2+__pyx_t_16); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1298, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_4);
            if (__pyx_t_7) {
              __Pyx_GIVEREF(__pyx_t_7); PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_7); __pyx_t_7 = NULL;
            }
            __Pyx_INCREF(__pyx_v_x);
            __Pyx_GIVEREF(__pyx_v_x);
            PyTuple_SET_ITEM(__pyx_t_4, 0+__pyx_t_16, __pyx_v_x);
            __Pyx_INCREF(__pyx_v_dup_block_combined);
            __Pyx_GIVEREF(__pyx_v_dup_block_combined);
            PyTuple_SET_ITEM(__pyx_t_4, 1+__pyx_t_16, __pyx_v_dup_block_combined);
            __pyx_t_11 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_4, NULL); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1298, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_11);
            __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
            __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
            __Pyx_XDECREF_SET(__pyx_v_x_modify_new, __pyx_t_11);
            __pyx_t_11 = 0;

            /* "vapor_vali/Simple_function.pyx":1299
 *                     for x in itertools.product(*dis_dup_check):
 *                         x_modify_new=x_to_x_modify_new(x,dup_block_combined)
 *                         temp_structure=[k2_hap[i] for i in sorted(x_modify_new+no_dup_block)]             # <<<<<<<<<<<<<<
 *                         if ''.join(temp_structure)==k1_hap:
 *                             original_pos+=list(x)
 */
            __pyx_t_11 = PyList_New(0); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1299, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_11);
            __pyx_t_4 = PyNumber_Add(__pyx_v_x_modify_new, __pyx_v_no_dup_block); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1299, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_4);
            __pyx_t_7 = PySequence_List(__pyx_t_4); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1299, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_7);
            __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
            __pyx_t_5 = ((PyObject*)__pyx_t_7);
            __pyx_t_7 = 0;
            __pyx_t_15 = PyList_Sort(__pyx_t_5); if (unlikely(__pyx_t_15 == -1)) __PYX_ERR(0, 1299, __pyx_L1_error)
            if (unlikely(__pyx_t_5 == Py_None)) {
              PyErr_SetString(PyExc_TypeError, "'NoneType' object is not iterable");
              __PYX_ERR(0, 1299, __pyx_L1_error)
            }
            __pyx_t_7 = __pyx_t_5; __Pyx_INCREF(__pyx_t_7); __pyx_t_16 = 0;
            __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
            for (;;) {
              if (__pyx_t_16 >= PyList_GET_SIZE(__pyx_t_7)) break;
              #if CYTHON_COMPILING_IN_CPYTHON
              __pyx_t_5 = PyList_GET_ITEM(__pyx_t_7, __pyx_t_16); __Pyx_INCREF(__pyx_t_5); __pyx_t_16++; if (unlikely(0 < 0)) __PYX_ERR(0, 1299, __pyx_L1_error)
              #else
              __pyx_t_5 = PySequence_ITEM(__pyx_t_7, __pyx_t_16); __pyx_t_16++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1299, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_5);
              #endif
              __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_5);
              __pyx_t_5 = 0;
              __pyx_t_5 = PyObject_GetItem(__pyx_v_k2_hap, __pyx_v_i); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1299, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_5);
              if (unlikely(__Pyx_ListComp_Append(__pyx_t_11, (PyObject*)__pyx_t_5))) __PYX_ERR(0, 1299, __pyx_L1_error)
              __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
            }
            __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
            __Pyx_XDECREF_SET(__pyx_v_temp_structure, ((PyObject*)__pyx_t_11));
            __pyx_t_11 = 0;

            /* "vapor_vali/Simple_function.pyx":1300
 *                         x_modify_new=x_to_x_modify_new(x,dup_block_combined)
 *                         temp_structure=[k2_hap[i] for i in sorted(x_modify_new+no_dup_block)]
 *                         if ''.join(temp_structure)==k1_hap:             # <<<<<<<<<<<<<<
 *                             original_pos+=list(x)
 *                     if len(original_pos)>0:
 */
            __pyx_t_11 = __Pyx_PyString_Join(__pyx_kp_s__24, __pyx_v_temp_structure); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1300, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_11);
            __pyx_t_1 = (__Pyx_PyUnicode_Equals(__pyx_t_11, __pyx_v_k1_hap, Py_EQ)); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(0, 1300, __pyx_L1_error)
            __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
            if (__pyx_t_1) {

              /* "vapor_vali/Simple_function.pyx":1301
 *                         temp_structure=[k2_hap[i] for i in sorted(x_modify_new+no_dup_block)]
 *                         if ''.join(temp_structure)==k1_hap:
 *                             original_pos+=list(x)             # <<<<<<<<<<<<<<
 *                     if len(original_pos)>0:
 *                         insert_pos=[]
 */
              __pyx_t_11 = PySequence_List(__pyx_v_x); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1301, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_11);
              __pyx_t_7 = PyNumber_InPlaceAdd(__pyx_v_original_pos, __pyx_t_11); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1301, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_7);
              __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
              __Pyx_DECREF_SET(__pyx_v_original_pos, ((PyObject*)__pyx_t_7));
              __pyx_t_7 = 0;

              /* "vapor_vali/Simple_function.pyx":1300
 *                         x_modify_new=x_to_x_modify_new(x,dup_block_combined)
 *                         temp_structure=[k2_hap[i] for i in sorted(x_modify_new+no_dup_block)]
 *                         if ''.join(temp_structure)==k1_hap:             # <<<<<<<<<<<<<<
 *                             original_pos+=list(x)
 *                     if len(original_pos)>0:
 */
            }

            /* "vapor_vali/Simple_function.pyx":1297
 *                                 dis_dup_check[-1].append(y)
 *                     original_pos=[]
 *                     for x in itertools.product(*dis_dup_check):             # <<<<<<<<<<<<<<
 *                         x_modify_new=x_to_x_modify_new(x,dup_block_combined)
 *                         temp_structure=[k2_hap[i] for i in sorted(x_modify_new+no_dup_block)]
 */
          }
          __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;

          /* "vapor_vali/Simple_function.pyx":1302
 *                         if ''.join(temp_structure)==k1_hap:
 *                             original_pos+=list(x)
 *                     if len(original_pos)>0:             # <<<<<<<<<<<<<<
 *                         insert_pos=[]
 *                         for i in dis_dup_check:
 */
          __pyx_t_12 = PyList_GET_SIZE(__pyx_v_original_pos); if (unlikely(__pyx_t_12 == -1)) __PYX_ERR(0, 1302, __pyx_L1_error)
          __pyx_t_1 = ((__pyx_t_12 > 0) != 0);
          if (__pyx_t_1) {

            /* "vapor_vali/Simple_function.pyx":1303
 *                             original_pos+=list(x)
 *                     if len(original_pos)>0:
 *                         insert_pos=[]             # <<<<<<<<<<<<<<
 *                         for i in dis_dup_check:
 *                             for j in i:
 */
            __pyx_t_3 = PyList_New(0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1303, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_3);
            __pyx_v_insert_pos = ((PyObject*)__pyx_t_3);
            __pyx_t_3 = 0;

            /* "vapor_vali/Simple_function.pyx":1304
 *                     if len(original_pos)>0:
 *                         insert_pos=[]
 *                         for i in dis_dup_check:             # <<<<<<<<<<<<<<
 *                             for j in i:
 *                                 if not j in original_pos:
 */
            __pyx_t_3 = __pyx_v_dis_dup_check; __Pyx_INCREF(__pyx_t_3); __pyx_t_12 = 0;
            for (;;) {
              if (__pyx_t_12 >= PyList_GET_SIZE(__pyx_t_3)) break;
              #if CYTHON_COMPILING_IN_CPYTHON
              __pyx_t_7 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_12); __Pyx_INCREF(__pyx_t_7); __pyx_t_12++; if (unlikely(0 < 0)) __PYX_ERR(0, 1304, __pyx_L1_error)
              #else
              __pyx_t_7 = PySequence_ITEM(__pyx_t_3, __pyx_t_12); __pyx_t_12++; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1304, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_7);
              #endif
              __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_7);
              __pyx_t_7 = 0;

              /* "vapor_vali/Simple_function.pyx":1305
 *                         insert_pos=[]
 *                         for i in dis_dup_check:
 *                             for j in i:             # <<<<<<<<<<<<<<
 *                                 if not j in original_pos:
 *                                     insert_pos.append(j)
 */
              if (likely(PyList_CheckExact(__pyx_v_i)) || PyTuple_CheckExact(__pyx_v_i)) {
                __pyx_t_7 = __pyx_v_i; __Pyx_INCREF(__pyx_t_7); __pyx_t_16 = 0;
                __pyx_t_8 = NULL;
              } else {
                __pyx_t_16 = -1; __pyx_t_7 = PyObject_GetIter(__pyx_v_i); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1305, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_7);
                __pyx_t_8 = Py_TYPE(__pyx_t_7)->tp_iternext; if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1305, __pyx_L1_error)
              }
              for (;;) {
                if (likely(!__pyx_t_8)) {
                  if (likely(PyList_CheckExact(__pyx_t_7))) {
                    if (__pyx_t_16 >= PyList_GET_SIZE(__pyx_t_7)) break;
                    #if CYTHON_COMPILING_IN_CPYTHON
                    __pyx_t_11 = PyList_GET_ITEM(__pyx_t_7, __pyx_t_16); __Pyx_INCREF(__pyx_t_11); __pyx_t_16++; if (unlikely(0 < 0)) __PYX_ERR(0, 1305, __pyx_L1_error)
                    #else
                    __pyx_t_11 = PySequence_ITEM(__pyx_t_7, __pyx_t_16); __pyx_t_16++; if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1305, __pyx_L1_error)
                    __Pyx_GOTREF(__pyx_t_11);
                    #endif
                  } else {
                    if (__pyx_t_16 >= PyTuple_GET_SIZE(__pyx_t_7)) break;
                    #if CYTHON_COMPILING_IN_CPYTHON
                    __pyx_t_11 = PyTuple_GET_ITEM(__pyx_t_7, __pyx_t_16); __Pyx_INCREF(__pyx_t_11); __pyx_t_16++; if (unlikely(0 < 0)) __PYX_ERR(0, 1305, __pyx_L1_error)
                    #else
                    __pyx_t_11 = PySequence_ITEM(__pyx_t_7, __pyx_t_16); __pyx_t_16++; if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1305, __pyx_L1_error)
                    __Pyx_GOTREF(__pyx_t_11);
                    #endif
                  }
                } else {
                  __pyx_t_11 = __pyx_t_8(__pyx_t_7);
                  if (unlikely(!__pyx_t_11)) {
                    PyObject* exc_type = PyErr_Occurred();
                    if (exc_type) {
                      if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
                      else __PYX_ERR(0, 1305, __pyx_L1_error)
                    }
                    break;
                  }
                  __Pyx_GOTREF(__pyx_t_11);
                }
                __Pyx_XDECREF_SET(__pyx_v_j, __pyx_t_11);
                __pyx_t_11 = 0;

                /* "vapor_vali/Simple_function.pyx":1306
 *                         for i in dis_dup_check:
 *                             for j in i:
 *                                 if not j in original_pos:             # <<<<<<<<<<<<<<
 *                                     insert_pos.append(j)
 *                         k2_hap_new=['-']+[i for i in k2_hap]+['+']
 */
                __pyx_t_1 = (__Pyx_PySequence_ContainsTF(__pyx_v_j, __pyx_v_original_pos, Py_NE)); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(0, 1306, __pyx_L1_error)
                __pyx_t_2 = (__pyx_t_1 != 0);
                if (__pyx_t_2) {

                  /* "vapor_vali/Simple_function.pyx":1307
 *                             for j in i:
 *                                 if not j in original_pos:
 *                                     insert_pos.append(j)             # <<<<<<<<<<<<<<
 *                         k2_hap_new=['-']+[i for i in k2_hap]+['+']
 *                         insert_block=[]
 */
                  __pyx_t_15 = __Pyx_PyList_Append(__pyx_v_insert_pos, __pyx_v_j); if (unlikely(__pyx_t_15 == -1)) __PYX_ERR(0, 1307, __pyx_L1_error)

                  /* "vapor_vali/Simple_function.pyx":1306
 *                         for i in dis_dup_check:
 *                             for j in i:
 *                                 if not j in original_pos:             # <<<<<<<<<<<<<<
 *                                     insert_pos.append(j)
 *                         k2_hap_new=['-']+[i for i in k2_hap]+['+']
 */
                }

                /* "vapor_vali/Simple_function.pyx":1305
 *                         insert_pos=[]
 *                         for i in dis_dup_check:
 *                             for j in i:             # <<<<<<<<<<<<<<
 *                                 if not j in original_pos:
 *                                     insert_pos.append(j)
 */
              }
              __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;

              /* "vapor_vali/Simple_function.pyx":1304
 *                     if len(original_pos)>0:
 *                         insert_pos=[]
 *                         for i in dis_dup_check:             # <<<<<<<<<<<<<<
 *                             for j in i:
 *                                 if not j in original_pos:
 */
            }
            __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;

            /* "vapor_vali/Simple_function.pyx":1308
 *                                 if not j in original_pos:
 *                                     insert_pos.append(j)
 *                         k2_hap_new=['-']+[i for i in k2_hap]+['+']             # <<<<<<<<<<<<<<
 *                         insert_block=[]
 *                         pos_rec=-1
 */
            __pyx_t_3 = PyList_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1308, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_3);
            __Pyx_INCREF(__pyx_kp_s_);
            __Pyx_GIVEREF(__pyx_kp_s_);
            PyList_SET_ITEM(__pyx_t_3, 0, __pyx_kp_s_);
            __pyx_t_7 = PyList_New(0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1308, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_7);
            if (likely(PyList_CheckExact(__pyx_v_k2_hap)) || PyTuple_CheckExact(__pyx_v_k2_hap)) {
              __pyx_t_11 = __pyx_v_k2_hap; __Pyx_INCREF(__pyx_t_11); __pyx_t_12 = 0;
              __pyx_t_8 = NULL;
            } else {
              __pyx_t_12 = -1; __pyx_t_11 = PyObject_GetIter(__pyx_v_k2_hap); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1308, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_11);
              __pyx_t_8 = Py_TYPE(__pyx_t_11)->tp_iternext; if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1308, __pyx_L1_error)
            }
            for (;;) {
              if (likely(!__pyx_t_8)) {
                if (likely(PyList_CheckExact(__pyx_t_11))) {
                  if (__pyx_t_12 >= PyList_GET_SIZE(__pyx_t_11)) break;
                  #if CYTHON_COMPILING_IN_CPYTHON
                  __pyx_t_5 = PyList_GET_ITEM(__pyx_t_11, __pyx_t_12); __Pyx_INCREF(__pyx_t_5); __pyx_t_12++; if (unlikely(0 < 0)) __PYX_ERR(0, 1308, __pyx_L1_error)
                  #else
                  __pyx_t_5 = PySequence_ITEM(__pyx_t_11, __pyx_t_12); __pyx_t_12++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1308, __pyx_L1_error)
                  __Pyx_GOTREF(__pyx_t_5);
                  #endif
                } else {
                  if (__pyx_t_12 >= PyTuple_GET_SIZE(__pyx_t_11)) break;
                  #if CYTHON_COMPILING_IN_CPYTHON
                  __pyx_t_5 = PyTuple_GET_ITEM(__pyx_t_11, __pyx_t_12); __Pyx_INCREF(__pyx_t_5); __pyx_t_12++; if (unlikely(0 < 0)) __PYX_ERR(0, 1308, __pyx_L1_error)
                  #else
                  __pyx_t_5 = PySequence_ITEM(__pyx_t_11, __pyx_t_12); __pyx_t_12++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1308, __pyx_L1_error)
                  __Pyx_GOTREF(__pyx_t_5);
                  #endif
                }
              } else {
                __pyx_t_5 = __pyx_t_8(__pyx_t_11);
                if (unlikely(!__pyx_t_5)) {
                  PyObject* exc_type = PyErr_Occurred();
                  if (exc_type) {
                    if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
                    else __PYX_ERR(0, 1308, __pyx_L1_error)
                  }
                  break;
                }
                __Pyx_GOTREF(__pyx_t_5);
              }
              __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_5);
              __pyx_t_5 = 0;
              if (unlikely(__Pyx_ListComp_Append(__pyx_t_7, (PyObject*)__pyx_v_i))) __PYX_ERR(0, 1308, __pyx_L1_error)
            }
            __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
            __pyx_t_11 = PyNumber_Add(__pyx_t_3, __pyx_t_7); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1308, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_11);
            __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
            __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
            __pyx_t_7 = PyList_New(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1308, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_7);
            __Pyx_INCREF(__pyx_kp_s__2);
            __Pyx_GIVEREF(__pyx_kp_s__2);
            PyList_SET_ITEM(__pyx_t_7, 0, __pyx_kp_s__2);
            __pyx_t_3 = PyNumber_Add(__pyx_t_11, __pyx_t_7); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1308, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_3);
            __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
            __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
            __pyx_v_k2_hap_new = ((PyObject*)__pyx_t_3);
            __pyx_t_3 = 0;

            /* "vapor_vali/Simple_function.pyx":1309
 *                                     insert_pos.append(j)
 *                         k2_hap_new=['-']+[i for i in k2_hap]+['+']
 *                         insert_block=[]             # <<<<<<<<<<<<<<
 *                         pos_rec=-1
 *                         for i in insert_pos:
 */
            __pyx_t_3 = PyList_New(0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1309, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_3);
            __pyx_v_insert_block = ((PyObject*)__pyx_t_3);
            __pyx_t_3 = 0;

            /* "vapor_vali/Simple_function.pyx":1310
 *                         k2_hap_new=['-']+[i for i in k2_hap]+['+']
 *                         insert_block=[]
 *                         pos_rec=-1             # <<<<<<<<<<<<<<
 *                         for i in insert_pos:
 *                             pos_rec+=1
 */
            __Pyx_INCREF(__pyx_int_neg_1);
            __pyx_v_pos_rec = __pyx_int_neg_1;

            /* "vapor_vali/Simple_function.pyx":1311
 *                         insert_block=[]
 *                         pos_rec=-1
 *                         for i in insert_pos:             # <<<<<<<<<<<<<<
 *                             pos_rec+=1
 *                             if len(dup_block_combined[pos_rec])==1:
 */
            __pyx_t_3 = __pyx_v_insert_pos; __Pyx_INCREF(__pyx_t_3); __pyx_t_12 = 0;
            for (;;) {
              if (__pyx_t_12 >= PyList_GET_SIZE(__pyx_t_3)) break;
              #if CYTHON_COMPILING_IN_CPYTHON
              __pyx_t_7 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_12); __Pyx_INCREF(__pyx_t_7); __pyx_t_12++; if (unlikely(0 < 0)) __PYX_ERR(0, 1311, __pyx_L1_error)
              #else
              __pyx_t_7 = PySequence_ITEM(__pyx_t_3, __pyx_t_12); __pyx_t_12++; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1311, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_7);
              #endif
              __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_7);
              __pyx_t_7 = 0;

              /* "vapor_vali/Simple_function.pyx":1312
 *                         pos_rec=-1
 *                         for i in insert_pos:
 *                             pos_rec+=1             # <<<<<<<<<<<<<<
 *                             if len(dup_block_combined[pos_rec])==1:
 *                                 insert_block.append([k2_hap_new[i],k2_hap_new[i+1],k2_hap_new[i+2]])
 */
              __pyx_t_7 = __Pyx_PyInt_AddObjC(__pyx_v_pos_rec, __pyx_int_1, 1, 1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1312, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_7);
              __Pyx_DECREF_SET(__pyx_v_pos_rec, __pyx_t_7);
              __pyx_t_7 = 0;

              /* "vapor_vali/Simple_function.pyx":1313
 *                         for i in insert_pos:
 *                             pos_rec+=1
 *                             if len(dup_block_combined[pos_rec])==1:             # <<<<<<<<<<<<<<
 *                                 insert_block.append([k2_hap_new[i],k2_hap_new[i+1],k2_hap_new[i+2]])
 *                             else:
 */
              __pyx_t_7 = PyObject_GetItem(__pyx_v_dup_block_combined, __pyx_v_pos_rec); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1313, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_7);
              __pyx_t_16 = PyObject_Length(__pyx_t_7); if (unlikely(__pyx_t_16 == -1)) __PYX_ERR(0, 1313, __pyx_L1_error)
              __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
              __pyx_t_2 = ((__pyx_t_16 == 1) != 0);
              if (__pyx_t_2) {

                /* "vapor_vali/Simple_function.pyx":1314
 *                             pos_rec+=1
 *                             if len(dup_block_combined[pos_rec])==1:
 *                                 insert_block.append([k2_hap_new[i],k2_hap_new[i+1],k2_hap_new[i+2]])             # <<<<<<<<<<<<<<
 *                             else:
 *                                 insert_block.append([k2_hap_new[i]]+k2_hap_new[(i+1):(i+len(dup_block_combined[pos_rec])+2)])
 */
                __pyx_t_7 = PyObject_GetItem(__pyx_v_k2_hap_new, __pyx_v_i); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1314, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_7);
                __pyx_t_11 = __Pyx_PyInt_AddObjC(__pyx_v_i, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1314, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_11);
                __pyx_t_5 = PyObject_GetItem(__pyx_v_k2_hap_new, __pyx_t_11); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1314, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_5);
                __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
                __pyx_t_11 = __Pyx_PyInt_AddObjC(__pyx_v_i, __pyx_int_2, 2, 0); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1314, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_11);
                __pyx_t_4 = PyObject_GetItem(__pyx_v_k2_hap_new, __pyx_t_11); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1314, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_4);
                __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
                __pyx_t_11 = PyList_New(3); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1314, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_11);
                __Pyx_GIVEREF(__pyx_t_7);
                PyList_SET_ITEM(__pyx_t_11, 0, __pyx_t_7);
                __Pyx_GIVEREF(__pyx_t_5);
                PyList_SET_ITEM(__pyx_t_11, 1, __pyx_t_5);
                __Pyx_GIVEREF(__pyx_t_4);
                PyList_SET_ITEM(__pyx_t_11, 2, __pyx_t_4);
                __pyx_t_7 = 0;
                __pyx_t_5 = 0;
                __pyx_t_4 = 0;
                __pyx_t_15 = __Pyx_PyList_Append(__pyx_v_insert_block, __pyx_t_11); if (unlikely(__pyx_t_15 == -1)) __PYX_ERR(0, 1314, __pyx_L1_error)
                __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;

                /* "vapor_vali/Simple_function.pyx":1313
 *                         for i in insert_pos:
 *                             pos_rec+=1
 *                             if len(dup_block_combined[pos_rec])==1:             # <<<<<<<<<<<<<<
 *                                 insert_block.append([k2_hap_new[i],k2_hap_new[i+1],k2_hap_new[i+2]])
 *                             else:
 */
                goto __pyx_L39;
              }

              /* "vapor_vali/Simple_function.pyx":1316
 *                                 insert_block.append([k2_hap_new[i],k2_hap_new[i+1],k2_hap_new[i+2]])
 *                             else:
 *                                 insert_block.append([k2_hap_new[i]]+k2_hap_new[(i+1):(i+len(dup_block_combined[pos_rec])+2)])             # <<<<<<<<<<<<<<
 *                         #insert_block=[[k2_hap_new[i],k2_hap_new[i+1],k2_hap_new[i+2]] for i in insert_pos]
 *                         return [dup_block_combined,insert_block]
 */
              /*else*/ {
                __pyx_t_11 = PyObject_GetItem(__pyx_v_k2_hap_new, __pyx_v_i); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1316, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_11);
                __pyx_t_4 = PyList_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1316, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_4);
                __Pyx_GIVEREF(__pyx_t_11);
                PyList_SET_ITEM(__pyx_t_4, 0, __pyx_t_11);
                __pyx_t_11 = 0;
                __pyx_t_11 = __Pyx_PyInt_AddObjC(__pyx_v_i, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1316, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_11);
                __pyx_t_16 = __Pyx_PyIndex_AsSsize_t(__pyx_t_11); if (unlikely((__pyx_t_16 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 1316, __pyx_L1_error)
                __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
                __pyx_t_11 = PyObject_GetItem(__pyx_v_dup_block_combined, __pyx_v_pos_rec); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1316, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_11);
                __pyx_t_6 = PyObject_Length(__pyx_t_11); if (unlikely(__pyx_t_6 == -1)) __PYX_ERR(0, 1316, __pyx_L1_error)
                __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
                __pyx_t_11 = PyInt_FromSsize_t(__pyx_t_6); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1316, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_11);
                __pyx_t_5 = PyNumber_Add(__pyx_v_i, __pyx_t_11); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1316, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_5);
                __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
                __pyx_t_11 = __Pyx_PyInt_AddObjC(__pyx_t_5, __pyx_int_2, 2, 0); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1316, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_11);
                __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
                __pyx_t_6 = __Pyx_PyIndex_AsSsize_t(__pyx_t_11); if (unlikely((__pyx_t_6 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 1316, __pyx_L1_error)
                __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
                __pyx_t_11 = __Pyx_PyList_GetSlice(__pyx_v_k2_hap_new, __pyx_t_16, __pyx_t_6); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1316, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_11);
                __pyx_t_5 = PyNumber_Add(__pyx_t_4, __pyx_t_11); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1316, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_5);
                __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
                __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
                __pyx_t_15 = __Pyx_PyList_Append(__pyx_v_insert_block, __pyx_t_5); if (unlikely(__pyx_t_15 == -1)) __PYX_ERR(0, 1316, __pyx_L1_error)
                __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
              }
              __pyx_L39:;

              /* "vapor_vali/Simple_function.pyx":1311
 *                         insert_block=[]
 *                         pos_rec=-1
 *                         for i in insert_pos:             # <<<<<<<<<<<<<<
 *                             pos_rec+=1
 *                             if len(dup_block_combined[pos_rec])==1:
 */
            }
            __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;

            /* "vapor_vali/Simple_function.pyx":1318
 *                                 insert_block.append([k2_hap_new[i]]+k2_hap_new[(i+1):(i+len(dup_block_combined[pos_rec])+2)])
 *                         #insert_block=[[k2_hap_new[i],k2_hap_new[i+1],k2_hap_new[i+2]] for i in insert_pos]
 *                         return [dup_block_combined,insert_block]             # <<<<<<<<<<<<<<
 *     return 'FALSE'
 * 
 */
            __Pyx_XDECREF(__pyx_r);
            __pyx_t_3 = PyList_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1318, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_3);
            __Pyx_INCREF(__pyx_v_dup_block_combined);
            __Pyx_GIVEREF(__pyx_v_dup_block_combined);
            PyList_SET_ITEM(__pyx_t_3, 0, __pyx_v_dup_block_combined);
            __Pyx_INCREF(__pyx_v_insert_block);
            __Pyx_GIVEREF(__pyx_v_insert_block);
            PyList_SET_ITEM(__pyx_t_3, 1, __pyx_v_insert_block);
            __pyx_r = __pyx_t_3;
            __pyx_t_3 = 0;
            goto __pyx_L0;

            /* "vapor_vali/Simple_function.pyx":1302
 *                         if ''.join(temp_structure)==k1_hap:
 *                             original_pos+=list(x)
 *                     if len(original_pos)>0:             # <<<<<<<<<<<<<<
 *                         insert_pos=[]
 *                         for i in dis_dup_check:
 */
          }

          /* "vapor_vali/Simple_function.pyx":1283
 *             if len(list_unify(overlap))==len(overlap):
 *                 dup_count=[k2_hap.count(i) for i in k1_hap]
 *                 if not min(dup_count)<1 and not max(dup_count)<2:    #deletion structure inside             # <<<<<<<<<<<<<<
 *                     dup_block=[k1_hap[i] for i in range(len(dup_count)) if dup_count[i]>1]
 *                     dup_block_combined=dup_block_combine(dup_block,k1_hap,k2_hap)
 */
        }

        /* "vapor_vali/Simple_function.pyx":1281
 *             dup_dis=letter_subgroup(k2_hap)
 *             overlap=[intersect(dup_dis[i],dup_dis[i+1]) for i in range(len(dup_dis)-1)]
 *             if len(list_unify(overlap))==len(overlap):             # <<<<<<<<<<<<<<
 *                 dup_count=[k2_hap.count(i) for i in k1_hap]
 *                 if not min(dup_count)<1 and not max(dup_count)<2:    #deletion structure inside
 */
      }

      /* "vapor_vali/Simple_function.pyx":1278
 *     #eg of k1_hap='abcd'    ;   eg of k2_hap='babdcd'
 *     if not '^' in k2_hap:
 *         if simple_tandup_haploid_decide(k1_hap,k2_hap)=='FALSE':             # <<<<<<<<<<<<<<
 *             dup_dis=letter_subgroup(k2_hap)
 *             overlap=[intersect(dup_dis[i],dup_dis[i+1]) for i in range(len(dup_dis)-1)]
 */
    }

    /* "vapor_vali/Simple_function.pyx":1277
 * def simple_disdup_haploid_decide(k1_hap,k2_hap):
 *     #eg of k1_hap='abcd'    ;   eg of k2_hap='babdcd'
 *     if not '^' in k2_hap:             # <<<<<<<<<<<<<<
 *         if simple_tandup_haploid_decide(k1_hap,k2_hap)=='FALSE':
 *             dup_dis=letter_subgroup(k2_hap)
 */
  }

  /* "vapor_vali/Simple_function.pyx":1319
 *                         #insert_block=[[k2_hap_new[i],k2_hap_new[i+1],k2_hap_new[i+2]] for i in insert_pos]
 *                         return [dup_block_combined,insert_block]
 *     return 'FALSE'             # <<<<<<<<<<<<<<
 * 
 * def simple_del_chop_pacbio_read_simple_short(bam_in,sv_info,flank_length):
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_n_s_FALSE);
  __pyx_r = __pyx_n_s_FALSE;
  goto __pyx_L0;

  /* "vapor_vali/Simple_function.pyx":1275
 *     return out
 * 
 * def simple_disdup_haploid_decide(k1_hap,k2_hap):             # <<<<<<<<<<<<<<
 *     #eg of k1_hap='abcd'    ;   eg of k2_hap='babdcd'
 *     if not '^' in k2_hap:
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_7);
  __Pyx_XDECREF(__pyx_t_9);
  __Pyx_XDECREF(__pyx_t_10);
  __Pyx_XDECREF(__pyx_t_11);
  __Pyx_XDECREF(__pyx_t_13);
  __Pyx_AddTraceback("vapor_vali.Simple_function.simple_disdup_haploid_decide", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_dup_dis);
  __Pyx_XDECREF(__pyx_v_overlap);
  __Pyx_XDECREF(__pyx_v_dup_count);
  __Pyx_XDECREF(__pyx_v_dup_block);
  __Pyx_XDECREF(__pyx_v_dup_block_combined);
  __Pyx_XDECREF(__pyx_v_dis_dup_check);
  __Pyx_XDECREF(__pyx_v_no_dup_block);
  __Pyx_XDECREF(__pyx_v_x);
  __Pyx_XDECREF(__pyx_v_y);
  __Pyx_XDECREF(__pyx_v_original_pos);
  __Pyx_XDECREF(__pyx_v_x_modify_new);
  __Pyx_XDECREF(__pyx_v_temp_structure);
  __Pyx_XDECREF(__pyx_v_insert_pos);
  __Pyx_XDECREF(__pyx_v_i);
  __Pyx_XDECREF(__pyx_v_j);
  __Pyx_XDECREF(__pyx_v_k2_hap_new);
  __Pyx_XDECREF(__pyx_v_insert_block);
  __Pyx_XDECREF(__pyx_v_pos_rec);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "vapor_vali/Simple_function.pyx":1321
 *     return 'FALSE'
 * 
 * def simple_del_chop_pacbio_read_simple_short(bam_in,sv_info,flank_length):             # <<<<<<<<<<<<<<
 *     #eg of info = ['a/a','/','chr1', 101553562, 101553905]
 *     #pick read around left breakpoints
 */

/* Python wrapper */
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_181simple_del_chop_pacbio_read_simple_short(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_10vapor_vali_15Simple_function_181simple_del_chop_pacbio_read_simple_short = {"simple_del_chop_pacbio_read_simple_short", (PyCFunction)__pyx_pw_10vapor_vali_15Simple_function_181simple_del_chop_pacbio_read_simple_short, METH_VARARGS|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_181simple_del_chop_pacbio_read_simple_short(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_bam_in = 0;
  PyObject *__pyx_v_sv_info = 0;
  PyObject *__pyx_v_flank_length = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("simple_del_chop_pacbio_read_simple_short (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_bam_in,&__pyx_n_s_sv_info,&__pyx_n_s_flank_length,0};
    PyObject* values[3] = {0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
      switch (pos_args) {
        case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_bam_in)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_sv_info)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("simple_del_chop_pacbio_read_simple_short", 1, 3, 3, 1); __PYX_ERR(0, 1321, __pyx_L3_error)
        }
        case  2:
        if (likely((values[2] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_flank_length)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("simple_del_chop_pacbio_read_simple_short", 1, 3, 3, 2); __PYX_ERR(0, 1321, __pyx_L3_error)
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "simple_del_chop_pacbio_read_simple_short") < 0)) __PYX_ERR(0, 1321, __pyx_L3_error)
      }
    } else if (PyTuple_GET_SIZE(__pyx_args) != 3) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
    }
    __pyx_v_bam_in = values[0];
    __pyx_v_sv_info = values[1];
    __pyx_v_flank_length = values[2];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("simple_del_chop_pacbio_read_simple_short", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1321, __pyx_L3_error)
  __pyx_L3_error:;
  __Pyx_AddTraceback("vapor_vali.Simple_function.simple_del_chop_pacbio_read_simple_short", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_10vapor_vali_15Simple_function_180simple_del_chop_pacbio_read_simple_short(__pyx_self, __pyx_v_bam_in, __pyx_v_sv_info, __pyx_v_flank_length);

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10vapor_vali_15Simple_function_180simple_del_chop_pacbio_read_simple_short(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_bam_in, PyObject *__pyx_v_sv_info, PyObject *__pyx_v_flank_length) {
  PyObject *__pyx_v_bam_in_new_list = NULL;
  PyObject *__pyx_v_x = NULL;
  PyObject *__pyx_v_bam_in_new = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  Py_ssize_t __pyx_t_4;
  PyObject *__pyx_t_5 = NULL;
  int __pyx_t_6;
  PyObject *(*__pyx_t_7)(PyObject *);
  PyObject *__pyx_t_8 = NULL;
  PyObject *__pyx_t_9 = NULL;
  PyObject *__pyx_t_10 = NULL;
  Py_ssize_t __pyx_t_11;
  PyObject *__pyx_t_12 = NULL;
  __Pyx_RefNannySetupContext("simple_del_chop_pacbio_read_simple_short", 0);

  /* "vapor_vali/Simple_function.pyx":1327
 *     #for x in range(len(info)-4):
 *     #    block_length[chr(97+x)]=int(info[x+4])-int(info[x+3])
 *     bam_in_new_list=bam_in_decide(bam_in,sv_info)             # <<<<<<<<<<<<<<
 *     if bam_in_new_list=='': return [[],[],[]]
 *     x=[]
 */
  __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_bam_in_decide); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1327, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = NULL;
  __pyx_t_4 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_3);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_2, function);
      __pyx_t_4 = 1;
    }
  }
  __pyx_t_5 = PyTuple_New(2+__pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1327, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  if (__pyx_t_3) {
    __Pyx_GIVEREF(__pyx_t_3); PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_3); __pyx_t_3 = NULL;
  }
  __Pyx_INCREF(__pyx_v_bam_in);
  __Pyx_GIVEREF(__pyx_v_bam_in);
  PyTuple_SET_ITEM(__pyx_t_5, 0+__pyx_t_4, __pyx_v_bam_in);
  __Pyx_INCREF(__pyx_v_sv_info);
  __Pyx_GIVEREF(__pyx_v_sv_info);
  PyTuple_SET_ITEM(__pyx_t_5, 1+__pyx_t_4, __pyx_v_sv_info);
  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_5, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1327, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_bam_in_new_list = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":1328
 *     #    block_length[chr(97+x)]=int(info[x+4])-int(info[x+3])
 *     bam_in_new_list=bam_in_decide(bam_in,sv_info)
 *     if bam_in_new_list=='': return [[],[],[]]             # <<<<<<<<<<<<<<
 *     x=[]
 *     for bam_in_new in bam_in_new_list:
 */
  __pyx_t_6 = (__Pyx_PyString_Equals(__pyx_v_bam_in_new_list, __pyx_kp_s__24, Py_EQ)); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 1328, __pyx_L1_error)
  if (__pyx_t_6) {
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1328, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_2 = PyList_New(0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1328, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_5 = PyList_New(0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1328, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __pyx_t_3 = PyList_New(3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1328, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_GIVEREF(__pyx_t_1);
    PyList_SET_ITEM(__pyx_t_3, 0, __pyx_t_1);
    __Pyx_GIVEREF(__pyx_t_2);
    PyList_SET_ITEM(__pyx_t_3, 1, __pyx_t_2);
    __Pyx_GIVEREF(__pyx_t_5);
    PyList_SET_ITEM(__pyx_t_3, 2, __pyx_t_5);
    __pyx_t_1 = 0;
    __pyx_t_2 = 0;
    __pyx_t_5 = 0;
    __pyx_r = __pyx_t_3;
    __pyx_t_3 = 0;
    goto __pyx_L0;
  }

  /* "vapor_vali/Simple_function.pyx":1329
 *     bam_in_new_list=bam_in_decide(bam_in,sv_info)
 *     if bam_in_new_list=='': return [[],[],[]]
 *     x=[]             # <<<<<<<<<<<<<<
 *     for bam_in_new in bam_in_new_list:
 *         x+=chop_pacbio_read_by_pos(bam_in_new, sv_info[0],int(sv_info[1])-flank_length,int(sv_info[1])+flank_length,flank_length)
 */
  __pyx_t_3 = PyList_New(0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1329, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_v_x = __pyx_t_3;
  __pyx_t_3 = 0;

  /* "vapor_vali/Simple_function.pyx":1330
 *     if bam_in_new_list=='': return [[],[],[]]
 *     x=[]
 *     for bam_in_new in bam_in_new_list:             # <<<<<<<<<<<<<<
 *         x+=chop_pacbio_read_by_pos(bam_in_new, sv_info[0],int(sv_info[1])-flank_length,int(sv_info[1])+flank_length,flank_length)
 *     x=minimize_pacbio_read_list(x)
 */
  if (likely(PyList_CheckExact(__pyx_v_bam_in_new_list)) || PyTuple_CheckExact(__pyx_v_bam_in_new_list)) {
    __pyx_t_3 = __pyx_v_bam_in_new_list; __Pyx_INCREF(__pyx_t_3); __pyx_t_4 = 0;
    __pyx_t_7 = NULL;
  } else {
    __pyx_t_4 = -1; __pyx_t_3 = PyObject_GetIter(__pyx_v_bam_in_new_list); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1330, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_7 = Py_TYPE(__pyx_t_3)->tp_iternext; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1330, __pyx_L1_error)
  }
  for (;;) {
    if (likely(!__pyx_t_7)) {
      if (likely(PyList_CheckExact(__pyx_t_3))) {
        if (__pyx_t_4 >= PyList_GET_SIZE(__pyx_t_3)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_5 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_4); __Pyx_INCREF(__pyx_t_5); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 1330, __pyx_L1_error)
        #else
        __pyx_t_5 = PySequence_ITEM(__pyx_t_3, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1330, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_5);
        #endif
      } else {
        if (__pyx_t_4 >= PyTuple_GET_SIZE(__pyx_t_3)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_5 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_4); __Pyx_INCREF(__pyx_t_5); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 1330, __pyx_L1_error)
        #else
        __pyx_t_5 = PySequence_ITEM(__pyx_t_3, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1330, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_5);
        #endif
      }
    } else {
      __pyx_t_5 = __pyx_t_7(__pyx_t_3);
      if (unlikely(!__pyx_t_5)) {
        PyObject* exc_type = PyErr_Occurred();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
          else __PYX_ERR(0, 1330, __pyx_L1_error)
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_5);
    }
    __Pyx_XDECREF_SET(__pyx_v_bam_in_new, __pyx_t_5);
    __pyx_t_5 = 0;

    /* "vapor_vali/Simple_function.pyx":1331
 *     x=[]
 *     for bam_in_new in bam_in_new_list:
 *         x+=chop_pacbio_read_by_pos(bam_in_new, sv_info[0],int(sv_info[1])-flank_length,int(sv_info[1])+flank_length,flank_length)             # <<<<<<<<<<<<<<
 *     x=minimize_pacbio_read_list(x)
 *     return x
 */
    __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_chop_pacbio_read_by_pos); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1331, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_sv_info, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1331, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_8 = __Pyx_GetItemInt(__pyx_v_sv_info, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1331, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_8);
    __pyx_t_9 = __Pyx_PyNumber_Int(__pyx_t_8); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1331, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_9);
    __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
    __pyx_t_8 = PyNumber_Subtract(__pyx_t_9, __pyx_v_flank_length); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1331, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_8);
    __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_t_9 = __Pyx_GetItemInt(__pyx_v_sv_info, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1331, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_9);
    __pyx_t_10 = __Pyx_PyNumber_Int(__pyx_t_9); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1331, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_10);
    __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_t_9 = PyNumber_Add(__pyx_t_10, __pyx_v_flank_length); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1331, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_9);
    __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
    __pyx_t_10 = NULL;
    __pyx_t_11 = 0;
    if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_2))) {
      __pyx_t_10 = PyMethod_GET_SELF(__pyx_t_2);
      if (likely(__pyx_t_10)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
        __Pyx_INCREF(__pyx_t_10);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_2, function);
        __pyx_t_11 = 1;
      }
    }
    __pyx_t_12 = PyTuple_New(5+__pyx_t_11); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1331, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_12);
    if (__pyx_t_10) {
      __Pyx_GIVEREF(__pyx_t_10); PyTuple_SET_ITEM(__pyx_t_12, 0, __pyx_t_10); __pyx_t_10 = NULL;
    }
    __Pyx_INCREF(__pyx_v_bam_in_new);
    __Pyx_GIVEREF(__pyx_v_bam_in_new);
    PyTuple_SET_ITEM(__pyx_t_12, 0+__pyx_t_11, __pyx_v_bam_in_new);
    __Pyx_GIVEREF(__pyx_t_1);
    PyTuple_SET_ITEM(__pyx_t_12, 1+__pyx_t_11, __pyx_t_1);
    __Pyx_GIVEREF(__pyx_t_8);
    PyTuple_SET_ITEM(__pyx_t_12, 2+__pyx_t_11, __pyx_t_8);
    __Pyx_GIVEREF(__pyx_t_9);
    PyTuple_SET_ITEM(__pyx_t_12, 3+__pyx_t_11, __pyx_t_9);
    __Pyx_INCREF(__pyx_v_flank_length);
    __Pyx_GIVEREF(__pyx_v_flank_length);
    PyTuple_SET_ITEM(__pyx_t_12, 4+__pyx_t_11, __pyx_v_flank_length);
    __pyx_t_1 = 0;
    __pyx_t_8 = 0;
    __pyx_t_9 = 0;
    __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_12, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1331, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = PyNumber_InPlaceAdd(__pyx_v_x, __pyx_t_5); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1331, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    __Pyx_DECREF_SET(__pyx_v_x, __pyx_t_2);
    __pyx_t_2 = 0;

    /* "vapor_vali/Simple_function.pyx":1330
 *     if bam_in_new_list=='': return [[],[],[]]
 *     x=[]
 *     for bam_in_new in bam_in_new_list:             # <<<<<<<<<<<<<<
 *         x+=chop_pacbio_read_by_pos(bam_in_new, sv_info[0],int(sv_info[1])-flank_length,int(sv_info[1])+flank_length,flank_length)
 *     x=minimize_pacbio_read_list(x)
 */
  }
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;

  /* "vapor_vali/Simple_function.pyx":1332
 *     for bam_in_new in bam_in_new_list:
 *         x+=chop_pacbio_read_by_pos(bam_in_new, sv_info[0],int(sv_info[1])-flank_length,int(sv_info[1])+flank_length,flank_length)
 *     x=minimize_pacbio_read_list(x)             # <<<<<<<<<<<<<<
 *     return x
 * 
 */
  __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_minimize_pacbio_read_list); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1332, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_5 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_2);
    if (likely(__pyx_t_5)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_5);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_2, function);
    }
  }
  if (!__pyx_t_5) {
    __pyx_t_3 = __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_v_x); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1332, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
  } else {
    __pyx_t_12 = PyTuple_New(1+1); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1332, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_12);
    __Pyx_GIVEREF(__pyx_t_5); PyTuple_SET_ITEM(__pyx_t_12, 0, __pyx_t_5); __pyx_t_5 = NULL;
    __Pyx_INCREF(__pyx_v_x);
    __Pyx_GIVEREF(__pyx_v_x);
    PyTuple_SET_ITEM(__pyx_t_12, 0+1, __pyx_v_x);
    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_12, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1332, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
  }
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __Pyx_DECREF_SET(__pyx_v_x, __pyx_t_3);
  __pyx_t_3 = 0;

  /* "vapor_vali/Simple_function.pyx":1333
 *         x+=chop_pacbio_read_by_pos(bam_in_new, sv_info[0],int(sv_info[1])-flank_length,int(sv_info[1])+flank_length,flank_length)
 *     x=minimize_pacbio_read_list(x)
 *     return x             # <<<<<<<<<<<<<<
 * 
 * def simple_chop_pacbio_read_simple_short(bam_in,sv_info,flank_length):
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_x);
  __pyx_r = __pyx_v_x;
  goto __pyx_L0;

  /* "vapor_vali/Simple_function.pyx":1321
 *     return 'FALSE'
 * 
 * def simple_del_chop_pacbio_read_simple_short(bam_in,sv_info,flank_length):             # <<<<<<<<<<<<<<
 *     #eg of info = ['a/a','/','chr1', 101553562, 101553905]
 *     #pick read around left breakpoints
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_8);
  __Pyx_XDECREF(__pyx_t_9);
  __Pyx_XDECREF(__pyx_t_10);
  __Pyx_XDECREF(__pyx_t_12);
  __Pyx_AddTraceback("vapor_vali.Simple_function.simple_del_chop_pacbio_read_simple_short", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_bam_in_new_list);
  __Pyx_XDECREF(__pyx_v_x);
  __Pyx_XDECREF(__pyx_v_bam_in_new);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "vapor_vali/Simple_function.pyx":1335
 *     return x
 * 
 * def simple_chop_pacbio_read_simple_short(bam_in,sv_info,flank_length):             # <<<<<<<<<<<<<<
 *     #eg of info = ['a/a','/','chr1', 101553562, 101553905]
 *     #eg of sv_info=['chr1', 101553562, 101553905]
 */

/* Python wrapper */
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_183simple_chop_pacbio_read_simple_short(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_10vapor_vali_15Simple_function_183simple_chop_pacbio_read_simple_short = {"simple_chop_pacbio_read_simple_short", (PyCFunction)__pyx_pw_10vapor_vali_15Simple_function_183simple_chop_pacbio_read_simple_short, METH_VARARGS|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_183simple_chop_pacbio_read_simple_short(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_bam_in = 0;
  PyObject *__pyx_v_sv_info = 0;
  PyObject *__pyx_v_flank_length = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("simple_chop_pacbio_read_simple_short (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_bam_in,&__pyx_n_s_sv_info,&__pyx_n_s_flank_length,0};
    PyObject* values[3] = {0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
      switch (pos_args) {
        case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_bam_in)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_sv_info)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("simple_chop_pacbio_read_simple_short", 1, 3, 3, 1); __PYX_ERR(0, 1335, __pyx_L3_error)
        }
        case  2:
        if (likely((values[2] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_flank_length)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("simple_chop_pacbio_read_simple_short", 1, 3, 3, 2); __PYX_ERR(0, 1335, __pyx_L3_error)
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "simple_chop_pacbio_read_simple_short") < 0)) __PYX_ERR(0, 1335, __pyx_L3_error)
      }
    } else if (PyTuple_GET_SIZE(__pyx_args) != 3) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
    }
    __pyx_v_bam_in = values[0];
    __pyx_v_sv_info = values[1];
    __pyx_v_flank_length = values[2];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("simple_chop_pacbio_read_simple_short", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1335, __pyx_L3_error)
  __pyx_L3_error:;
  __Pyx_AddTraceback("vapor_vali.Simple_function.simple_chop_pacbio_read_simple_short", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_10vapor_vali_15Simple_function_182simple_chop_pacbio_read_simple_short(__pyx_self, __pyx_v_bam_in, __pyx_v_sv_info, __pyx_v_flank_length);

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10vapor_vali_15Simple_function_182simple_chop_pacbio_read_simple_short(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_bam_in, PyObject *__pyx_v_sv_info, PyObject *__pyx_v_flank_length) {
  PyObject *__pyx_v_bam_in_new_list = NULL;
  PyObject *__pyx_v_x = NULL;
  PyObject *__pyx_v_bam_in_new = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  Py_ssize_t __pyx_t_4;
  PyObject *__pyx_t_5 = NULL;
  int __pyx_t_6;
  PyObject *(*__pyx_t_7)(PyObject *);
  PyObject *__pyx_t_8 = NULL;
  PyObject *__pyx_t_9 = NULL;
  PyObject *__pyx_t_10 = NULL;
  Py_ssize_t __pyx_t_11;
  PyObject *__pyx_t_12 = NULL;
  __Pyx_RefNannySetupContext("simple_chop_pacbio_read_simple_short", 0);

  /* "vapor_vali/Simple_function.pyx":1338
 *     #eg of info = ['a/a','/','chr1', 101553562, 101553905]
 *     #eg of sv_info=['chr1', 101553562, 101553905]
 *     bam_in_new_list=bam_in_decide(bam_in,sv_info)             # <<<<<<<<<<<<<<
 *     if bam_in_new_list=='': return [[],[],[]]
 *     x=[]
 */
  __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_bam_in_decide); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1338, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = NULL;
  __pyx_t_4 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_3);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_2, function);
      __pyx_t_4 = 1;
    }
  }
  __pyx_t_5 = PyTuple_New(2+__pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1338, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  if (__pyx_t_3) {
    __Pyx_GIVEREF(__pyx_t_3); PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_3); __pyx_t_3 = NULL;
  }
  __Pyx_INCREF(__pyx_v_bam_in);
  __Pyx_GIVEREF(__pyx_v_bam_in);
  PyTuple_SET_ITEM(__pyx_t_5, 0+__pyx_t_4, __pyx_v_bam_in);
  __Pyx_INCREF(__pyx_v_sv_info);
  __Pyx_GIVEREF(__pyx_v_sv_info);
  PyTuple_SET_ITEM(__pyx_t_5, 1+__pyx_t_4, __pyx_v_sv_info);
  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_5, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1338, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_bam_in_new_list = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":1339
 *     #eg of sv_info=['chr1', 101553562, 101553905]
 *     bam_in_new_list=bam_in_decide(bam_in,sv_info)
 *     if bam_in_new_list=='': return [[],[],[]]             # <<<<<<<<<<<<<<
 *     x=[]
 *     for bam_in_new in bam_in_new_list:
 */
  __pyx_t_6 = (__Pyx_PyString_Equals(__pyx_v_bam_in_new_list, __pyx_kp_s__24, Py_EQ)); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 1339, __pyx_L1_error)
  if (__pyx_t_6) {
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1339, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_2 = PyList_New(0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1339, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_5 = PyList_New(0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1339, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __pyx_t_3 = PyList_New(3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1339, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_GIVEREF(__pyx_t_1);
    PyList_SET_ITEM(__pyx_t_3, 0, __pyx_t_1);
    __Pyx_GIVEREF(__pyx_t_2);
    PyList_SET_ITEM(__pyx_t_3, 1, __pyx_t_2);
    __Pyx_GIVEREF(__pyx_t_5);
    PyList_SET_ITEM(__pyx_t_3, 2, __pyx_t_5);
    __pyx_t_1 = 0;
    __pyx_t_2 = 0;
    __pyx_t_5 = 0;
    __pyx_r = __pyx_t_3;
    __pyx_t_3 = 0;
    goto __pyx_L0;
  }

  /* "vapor_vali/Simple_function.pyx":1340
 *     bam_in_new_list=bam_in_decide(bam_in,sv_info)
 *     if bam_in_new_list=='': return [[],[],[]]
 *     x=[]             # <<<<<<<<<<<<<<
 *     for bam_in_new in bam_in_new_list:
 *         x+=chop_pacbio_read_by_pos(bam_in_new, sv_info[0],int(sv_info[1])-flank_length,int(sv_info[-1])+flank_length,flank_length)
 */
  __pyx_t_3 = PyList_New(0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1340, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_v_x = __pyx_t_3;
  __pyx_t_3 = 0;

  /* "vapor_vali/Simple_function.pyx":1341
 *     if bam_in_new_list=='': return [[],[],[]]
 *     x=[]
 *     for bam_in_new in bam_in_new_list:             # <<<<<<<<<<<<<<
 *         x+=chop_pacbio_read_by_pos(bam_in_new, sv_info[0],int(sv_info[1])-flank_length,int(sv_info[-1])+flank_length,flank_length)
 *     x=minimize_pacbio_read_list(x)
 */
  if (likely(PyList_CheckExact(__pyx_v_bam_in_new_list)) || PyTuple_CheckExact(__pyx_v_bam_in_new_list)) {
    __pyx_t_3 = __pyx_v_bam_in_new_list; __Pyx_INCREF(__pyx_t_3); __pyx_t_4 = 0;
    __pyx_t_7 = NULL;
  } else {
    __pyx_t_4 = -1; __pyx_t_3 = PyObject_GetIter(__pyx_v_bam_in_new_list); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1341, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_7 = Py_TYPE(__pyx_t_3)->tp_iternext; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1341, __pyx_L1_error)
  }
  for (;;) {
    if (likely(!__pyx_t_7)) {
      if (likely(PyList_CheckExact(__pyx_t_3))) {
        if (__pyx_t_4 >= PyList_GET_SIZE(__pyx_t_3)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_5 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_4); __Pyx_INCREF(__pyx_t_5); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 1341, __pyx_L1_error)
        #else
        __pyx_t_5 = PySequence_ITEM(__pyx_t_3, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1341, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_5);
        #endif
      } else {
        if (__pyx_t_4 >= PyTuple_GET_SIZE(__pyx_t_3)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_5 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_4); __Pyx_INCREF(__pyx_t_5); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 1341, __pyx_L1_error)
        #else
        __pyx_t_5 = PySequence_ITEM(__pyx_t_3, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1341, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_5);
        #endif
      }
    } else {
      __pyx_t_5 = __pyx_t_7(__pyx_t_3);
      if (unlikely(!__pyx_t_5)) {
        PyObject* exc_type = PyErr_Occurred();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
          else __PYX_ERR(0, 1341, __pyx_L1_error)
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_5);
    }
    __Pyx_XDECREF_SET(__pyx_v_bam_in_new, __pyx_t_5);
    __pyx_t_5 = 0;

    /* "vapor_vali/Simple_function.pyx":1342
 *     x=[]
 *     for bam_in_new in bam_in_new_list:
 *         x+=chop_pacbio_read_by_pos(bam_in_new, sv_info[0],int(sv_info[1])-flank_length,int(sv_info[-1])+flank_length,flank_length)             # <<<<<<<<<<<<<<
 *     x=minimize_pacbio_read_list(x)
 *     return x
 */
    __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_chop_pacbio_read_by_pos); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1342, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_sv_info, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1342, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_8 = __Pyx_GetItemInt(__pyx_v_sv_info, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1342, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_8);
    __pyx_t_9 = __Pyx_PyNumber_Int(__pyx_t_8); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1342, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_9);
    __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
    __pyx_t_8 = PyNumber_Subtract(__pyx_t_9, __pyx_v_flank_length); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1342, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_8);
    __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_t_9 = __Pyx_GetItemInt(__pyx_v_sv_info, -1L, long, 1, __Pyx_PyInt_From_long, 0, 1, 1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1342, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_9);
    __pyx_t_10 = __Pyx_PyNumber_Int(__pyx_t_9); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1342, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_10);
    __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_t_9 = PyNumber_Add(__pyx_t_10, __pyx_v_flank_length); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1342, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_9);
    __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
    __pyx_t_10 = NULL;
    __pyx_t_11 = 0;
    if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_2))) {
      __pyx_t_10 = PyMethod_GET_SELF(__pyx_t_2);
      if (likely(__pyx_t_10)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
        __Pyx_INCREF(__pyx_t_10);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_2, function);
        __pyx_t_11 = 1;
      }
    }
    __pyx_t_12 = PyTuple_New(5+__pyx_t_11); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1342, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_12);
    if (__pyx_t_10) {
      __Pyx_GIVEREF(__pyx_t_10); PyTuple_SET_ITEM(__pyx_t_12, 0, __pyx_t_10); __pyx_t_10 = NULL;
    }
    __Pyx_INCREF(__pyx_v_bam_in_new);
    __Pyx_GIVEREF(__pyx_v_bam_in_new);
    PyTuple_SET_ITEM(__pyx_t_12, 0+__pyx_t_11, __pyx_v_bam_in_new);
    __Pyx_GIVEREF(__pyx_t_1);
    PyTuple_SET_ITEM(__pyx_t_12, 1+__pyx_t_11, __pyx_t_1);
    __Pyx_GIVEREF(__pyx_t_8);
    PyTuple_SET_ITEM(__pyx_t_12, 2+__pyx_t_11, __pyx_t_8);
    __Pyx_GIVEREF(__pyx_t_9);
    PyTuple_SET_ITEM(__pyx_t_12, 3+__pyx_t_11, __pyx_t_9);
    __Pyx_INCREF(__pyx_v_flank_length);
    __Pyx_GIVEREF(__pyx_v_flank_length);
    PyTuple_SET_ITEM(__pyx_t_12, 4+__pyx_t_11, __pyx_v_flank_length);
    __pyx_t_1 = 0;
    __pyx_t_8 = 0;
    __pyx_t_9 = 0;
    __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_12, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1342, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = PyNumber_InPlaceAdd(__pyx_v_x, __pyx_t_5); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1342, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    __Pyx_DECREF_SET(__pyx_v_x, __pyx_t_2);
    __pyx_t_2 = 0;

    /* "vapor_vali/Simple_function.pyx":1341
 *     if bam_in_new_list=='': return [[],[],[]]
 *     x=[]
 *     for bam_in_new in bam_in_new_list:             # <<<<<<<<<<<<<<
 *         x+=chop_pacbio_read_by_pos(bam_in_new, sv_info[0],int(sv_info[1])-flank_length,int(sv_info[-1])+flank_length,flank_length)
 *     x=minimize_pacbio_read_list(x)
 */
  }
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;

  /* "vapor_vali/Simple_function.pyx":1343
 *     for bam_in_new in bam_in_new_list:
 *         x+=chop_pacbio_read_by_pos(bam_in_new, sv_info[0],int(sv_info[1])-flank_length,int(sv_info[-1])+flank_length,flank_length)
 *     x=minimize_pacbio_read_list(x)             # <<<<<<<<<<<<<<
 *     return x
 * 
 */
  __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_minimize_pacbio_read_list); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1343, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_5 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_2);
    if (likely(__pyx_t_5)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_5);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_2, function);
    }
  }
  if (!__pyx_t_5) {
    __pyx_t_3 = __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_v_x); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1343, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
  } else {
    __pyx_t_12 = PyTuple_New(1+1); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1343, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_12);
    __Pyx_GIVEREF(__pyx_t_5); PyTuple_SET_ITEM(__pyx_t_12, 0, __pyx_t_5); __pyx_t_5 = NULL;
    __Pyx_INCREF(__pyx_v_x);
    __Pyx_GIVEREF(__pyx_v_x);
    PyTuple_SET_ITEM(__pyx_t_12, 0+1, __pyx_v_x);
    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_12, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1343, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
  }
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __Pyx_DECREF_SET(__pyx_v_x, __pyx_t_3);
  __pyx_t_3 = 0;

  /* "vapor_vali/Simple_function.pyx":1344
 *         x+=chop_pacbio_read_by_pos(bam_in_new, sv_info[0],int(sv_info[1])-flank_length,int(sv_info[-1])+flank_length,flank_length)
 *     x=minimize_pacbio_read_list(x)
 *     return x             # <<<<<<<<<<<<<<
 * 
 * def subkeys(key, nth_base, inversions):
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_x);
  __pyx_r = __pyx_v_x;
  goto __pyx_L0;

  /* "vapor_vali/Simple_function.pyx":1335
 *     return x
 * 
 * def simple_chop_pacbio_read_simple_short(bam_in,sv_info,flank_length):             # <<<<<<<<<<<<<<
 *     #eg of info = ['a/a','/','chr1', 101553562, 101553905]
 *     #eg of sv_info=['chr1', 101553562, 101553905]
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_8);
  __Pyx_XDECREF(__pyx_t_9);
  __Pyx_XDECREF(__pyx_t_10);
  __Pyx_XDECREF(__pyx_t_12);
  __Pyx_AddTraceback("vapor_vali.Simple_function.simple_chop_pacbio_read_simple_short", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_bam_in_new_list);
  __Pyx_XDECREF(__pyx_v_x);
  __Pyx_XDECREF(__pyx_v_bam_in_new);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "vapor_vali/Simple_function.pyx":1346
 *     return x
 * 
 * def subkeys(key, nth_base, inversions):             # <<<<<<<<<<<<<<
 *     subkeys_info = []
 *     key=key_modify(key)
 */

/* Python wrapper */
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_185subkeys(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_10vapor_vali_15Simple_function_185subkeys = {"subkeys", (PyCFunction)__pyx_pw_10vapor_vali_15Simple_function_185subkeys, METH_VARARGS|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_185subkeys(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_key = 0;
  PyObject *__pyx_v_nth_base = 0;
  PyObject *__pyx_v_inversions = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("subkeys (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_key,&__pyx_n_s_nth_base,&__pyx_n_s_inversions,0};
    PyObject* values[3] = {0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
      switch (pos_args) {
        case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_key)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_nth_base)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("subkeys", 1, 3, 3, 1); __PYX_ERR(0, 1346, __pyx_L3_error)
        }
        case  2:
        if (likely((values[2] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_inversions)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("subkeys", 1, 3, 3, 2); __PYX_ERR(0, 1346, __pyx_L3_error)
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "subkeys") < 0)) __PYX_ERR(0, 1346, __pyx_L3_error)
      }
    } else if (PyTuple_GET_SIZE(__pyx_args) != 3) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
    }
    __pyx_v_key = values[0];
    __pyx_v_nth_base = values[1];
    __pyx_v_inversions = values[2];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("subkeys", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1346, __pyx_L3_error)
  __pyx_L3_error:;
  __Pyx_AddTraceback("vapor_vali.Simple_function.subkeys", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_10vapor_vali_15Simple_function_184subkeys(__pyx_self, __pyx_v_key, __pyx_v_nth_base, __pyx_v_inversions);

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10vapor_vali_15Simple_function_184subkeys(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_key, PyObject *__pyx_v_nth_base, PyObject *__pyx_v_inversions) {
  PyObject *__pyx_v_subkeys_info = NULL;
  Py_ssize_t __pyx_v_keylen;
  PyObject *__pyx_v_k = NULL;
  PyObject *__pyx_v_substr_list = NULL;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_v_j = NULL;
  PyObject *__pyx_v_c = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  Py_ssize_t __pyx_t_5;
  int __pyx_t_6;
  PyObject *(*__pyx_t_7)(PyObject *);
  Py_ssize_t __pyx_t_8;
  PyObject *(*__pyx_t_9)(PyObject *);
  PyObject *__pyx_t_10 = NULL;
  int __pyx_t_11;
  __Pyx_RefNannySetupContext("subkeys", 0);
  __Pyx_INCREF(__pyx_v_key);

  /* "vapor_vali/Simple_function.pyx":1347
 * 
 * def subkeys(key, nth_base, inversions):
 *     subkeys_info = []             # <<<<<<<<<<<<<<
 *     key=key_modify(key)
 *     keylen = len(key)
 */
  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1347, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_subkeys_info = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":1348
 * def subkeys(key, nth_base, inversions):
 *     subkeys_info = []
 *     key=key_modify(key)             # <<<<<<<<<<<<<<
 *     keylen = len(key)
 *     # speed tip from:
 */
  __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_key_modify); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1348, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_3);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_2, function);
    }
  }
  if (!__pyx_t_3) {
    __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_v_key); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1348, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
  } else {
    __pyx_t_4 = PyTuple_New(1+1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1348, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_GIVEREF(__pyx_t_3); PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3); __pyx_t_3 = NULL;
    __Pyx_INCREF(__pyx_v_key);
    __Pyx_GIVEREF(__pyx_v_key);
    PyTuple_SET_ITEM(__pyx_t_4, 0+1, __pyx_v_key);
    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_4, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1348, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  }
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __Pyx_DECREF_SET(__pyx_v_key, __pyx_t_1);
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":1349
 *     subkeys_info = []
 *     key=key_modify(key)
 *     keylen = len(key)             # <<<<<<<<<<<<<<
 *     # speed tip from:
 *     # http://wiki.python.org/moin/PythonSpeed/PerformanceTips#String_Concatenation
 */
  __pyx_t_5 = PyObject_Length(__pyx_v_key); if (unlikely(__pyx_t_5 == -1)) __PYX_ERR(0, 1349, __pyx_L1_error)
  __pyx_v_keylen = __pyx_t_5;

  /* "vapor_vali/Simple_function.pyx":1352
 *     # speed tip from:
 *     # http://wiki.python.org/moin/PythonSpeed/PerformanceTips#String_Concatenation
 *     if nth_base == 1:             # <<<<<<<<<<<<<<
 *         subkeys_info = [key]
 *     elif nth_base != 0:
 */
  __pyx_t_1 = __Pyx_PyInt_EqObjC(__pyx_v_nth_base, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1352, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 1352, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  if (__pyx_t_6) {

    /* "vapor_vali/Simple_function.pyx":1353
 *     # http://wiki.python.org/moin/PythonSpeed/PerformanceTips#String_Concatenation
 *     if nth_base == 1:
 *         subkeys_info = [key]             # <<<<<<<<<<<<<<
 *     elif nth_base != 0:
 *         for k in range(nth_base):
 */
    __pyx_t_1 = PyList_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1353, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_INCREF(__pyx_v_key);
    __Pyx_GIVEREF(__pyx_v_key);
    PyList_SET_ITEM(__pyx_t_1, 0, __pyx_v_key);
    __Pyx_DECREF_SET(__pyx_v_subkeys_info, ((PyObject*)__pyx_t_1));
    __pyx_t_1 = 0;

    /* "vapor_vali/Simple_function.pyx":1352
 *     # speed tip from:
 *     # http://wiki.python.org/moin/PythonSpeed/PerformanceTips#String_Concatenation
 *     if nth_base == 1:             # <<<<<<<<<<<<<<
 *         subkeys_info = [key]
 *     elif nth_base != 0:
 */
    goto __pyx_L3;
  }

  /* "vapor_vali/Simple_function.pyx":1354
 *     if nth_base == 1:
 *         subkeys_info = [key]
 *     elif nth_base != 0:             # <<<<<<<<<<<<<<
 *         for k in range(nth_base):
 *             substr_list = [key[j] for j in range(keylen) if (j % nth_base == k)]
 */
  __pyx_t_1 = PyObject_RichCompare(__pyx_v_nth_base, __pyx_int_0, Py_NE); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1354, __pyx_L1_error)
  __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 1354, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  if (__pyx_t_6) {

    /* "vapor_vali/Simple_function.pyx":1355
 *         subkeys_info = [key]
 *     elif nth_base != 0:
 *         for k in range(nth_base):             # <<<<<<<<<<<<<<
 *             substr_list = [key[j] for j in range(keylen) if (j % nth_base == k)]
 *             subkeys_info.append("".join(substr_list))
 */
    __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1355, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_INCREF(__pyx_v_nth_base);
    __Pyx_GIVEREF(__pyx_v_nth_base);
    PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_nth_base);
    __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_t_1, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1355, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    if (likely(PyList_CheckExact(__pyx_t_2)) || PyTuple_CheckExact(__pyx_t_2)) {
      __pyx_t_1 = __pyx_t_2; __Pyx_INCREF(__pyx_t_1); __pyx_t_5 = 0;
      __pyx_t_7 = NULL;
    } else {
      __pyx_t_5 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1355, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __pyx_t_7 = Py_TYPE(__pyx_t_1)->tp_iternext; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1355, __pyx_L1_error)
    }
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    for (;;) {
      if (likely(!__pyx_t_7)) {
        if (likely(PyList_CheckExact(__pyx_t_1))) {
          if (__pyx_t_5 >= PyList_GET_SIZE(__pyx_t_1)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_2 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_5); __Pyx_INCREF(__pyx_t_2); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 1355, __pyx_L1_error)
          #else
          __pyx_t_2 = PySequence_ITEM(__pyx_t_1, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1355, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_2);
          #endif
        } else {
          if (__pyx_t_5 >= PyTuple_GET_SIZE(__pyx_t_1)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_2 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_5); __Pyx_INCREF(__pyx_t_2); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 1355, __pyx_L1_error)
          #else
          __pyx_t_2 = PySequence_ITEM(__pyx_t_1, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1355, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_2);
          #endif
        }
      } else {
        __pyx_t_2 = __pyx_t_7(__pyx_t_1);
        if (unlikely(!__pyx_t_2)) {
          PyObject* exc_type = PyErr_Occurred();
          if (exc_type) {
            if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
            else __PYX_ERR(0, 1355, __pyx_L1_error)
          }
          break;
        }
        __Pyx_GOTREF(__pyx_t_2);
      }
      __Pyx_XDECREF_SET(__pyx_v_k, __pyx_t_2);
      __pyx_t_2 = 0;

      /* "vapor_vali/Simple_function.pyx":1356
 *     elif nth_base != 0:
 *         for k in range(nth_base):
 *             substr_list = [key[j] for j in range(keylen) if (j % nth_base == k)]             # <<<<<<<<<<<<<<
 *             subkeys_info.append("".join(substr_list))
 *     else:
 */
      __pyx_t_2 = PyList_New(0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1356, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __pyx_t_4 = PyInt_FromSsize_t(__pyx_v_keylen); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1356, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1356, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __Pyx_GIVEREF(__pyx_t_4);
      PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_4);
      __pyx_t_4 = 0;
      __pyx_t_4 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_t_3, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1356, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      if (likely(PyList_CheckExact(__pyx_t_4)) || PyTuple_CheckExact(__pyx_t_4)) {
        __pyx_t_3 = __pyx_t_4; __Pyx_INCREF(__pyx_t_3); __pyx_t_8 = 0;
        __pyx_t_9 = NULL;
      } else {
        __pyx_t_8 = -1; __pyx_t_3 = PyObject_GetIter(__pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1356, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_3);
        __pyx_t_9 = Py_TYPE(__pyx_t_3)->tp_iternext; if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1356, __pyx_L1_error)
      }
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      for (;;) {
        if (likely(!__pyx_t_9)) {
          if (likely(PyList_CheckExact(__pyx_t_3))) {
            if (__pyx_t_8 >= PyList_GET_SIZE(__pyx_t_3)) break;
            #if CYTHON_COMPILING_IN_CPYTHON
            __pyx_t_4 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_8); __Pyx_INCREF(__pyx_t_4); __pyx_t_8++; if (unlikely(0 < 0)) __PYX_ERR(0, 1356, __pyx_L1_error)
            #else
            __pyx_t_4 = PySequence_ITEM(__pyx_t_3, __pyx_t_8); __pyx_t_8++; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1356, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_4);
            #endif
          } else {
            if (__pyx_t_8 >= PyTuple_GET_SIZE(__pyx_t_3)) break;
            #if CYTHON_COMPILING_IN_CPYTHON
            __pyx_t_4 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_8); __Pyx_INCREF(__pyx_t_4); __pyx_t_8++; if (unlikely(0 < 0)) __PYX_ERR(0, 1356, __pyx_L1_error)
            #else
            __pyx_t_4 = PySequence_ITEM(__pyx_t_3, __pyx_t_8); __pyx_t_8++; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1356, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_4);
            #endif
          }
        } else {
          __pyx_t_4 = __pyx_t_9(__pyx_t_3);
          if (unlikely(!__pyx_t_4)) {
            PyObject* exc_type = PyErr_Occurred();
            if (exc_type) {
              if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
              else __PYX_ERR(0, 1356, __pyx_L1_error)
            }
            break;
          }
          __Pyx_GOTREF(__pyx_t_4);
        }
        __Pyx_XDECREF_SET(__pyx_v_j, __pyx_t_4);
        __pyx_t_4 = 0;
        __pyx_t_4 = PyNumber_Remainder(__pyx_v_j, __pyx_v_nth_base); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1356, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_4);
        __pyx_t_10 = PyObject_RichCompare(__pyx_t_4, __pyx_v_k, Py_EQ); __Pyx_XGOTREF(__pyx_t_10); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1356, __pyx_L1_error)
        __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
        __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_10); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 1356, __pyx_L1_error)
        __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
        if (__pyx_t_6) {
          __pyx_t_10 = PyObject_GetItem(__pyx_v_key, __pyx_v_j); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1356, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_10);
          if (unlikely(__Pyx_ListComp_Append(__pyx_t_2, (PyObject*)__pyx_t_10))) __PYX_ERR(0, 1356, __pyx_L1_error)
          __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
        }
      }
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      __Pyx_XDECREF_SET(__pyx_v_substr_list, ((PyObject*)__pyx_t_2));
      __pyx_t_2 = 0;

      /* "vapor_vali/Simple_function.pyx":1357
 *         for k in range(nth_base):
 *             substr_list = [key[j] for j in range(keylen) if (j % nth_base == k)]
 *             subkeys_info.append("".join(substr_list))             # <<<<<<<<<<<<<<
 *     else:
 *         # nth_base = 0 is a special case for third base mismatches
 */
      __pyx_t_2 = __Pyx_PyString_Join(__pyx_kp_s__24, __pyx_v_substr_list); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1357, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __pyx_t_11 = __Pyx_PyList_Append(__pyx_v_subkeys_info, __pyx_t_2); if (unlikely(__pyx_t_11 == -1)) __PYX_ERR(0, 1357, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

      /* "vapor_vali/Simple_function.pyx":1355
 *         subkeys_info = [key]
 *     elif nth_base != 0:
 *         for k in range(nth_base):             # <<<<<<<<<<<<<<
 *             substr_list = [key[j] for j in range(keylen) if (j % nth_base == k)]
 *             subkeys_info.append("".join(substr_list))
 */
    }
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "vapor_vali/Simple_function.pyx":1354
 *     if nth_base == 1:
 *         subkeys_info = [key]
 *     elif nth_base != 0:             # <<<<<<<<<<<<<<
 *         for k in range(nth_base):
 *             substr_list = [key[j] for j in range(keylen) if (j % nth_base == k)]
 */
    goto __pyx_L3;
  }

  /* "vapor_vali/Simple_function.pyx":1361
 *         # nth_base = 0 is a special case for third base mismatches
 *         # for every codon, only include the first 2 bases in the hash
 *         subkeys_info = ["".join([key[i] for i in range(len(key)) if i % 3 != 2])]             # <<<<<<<<<<<<<<
 *     if inversions:
 *         for i in range(len(subkeys_info)):
 */
  /*else*/ {
    __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1361, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_5 = PyObject_Length(__pyx_v_key); if (unlikely(__pyx_t_5 == -1)) __PYX_ERR(0, 1361, __pyx_L1_error)
    __pyx_t_2 = PyInt_FromSsize_t(__pyx_t_5); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1361, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1361, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_GIVEREF(__pyx_t_2);
    PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_2);
    __pyx_t_2 = 0;
    __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_t_3, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1361, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    if (likely(PyList_CheckExact(__pyx_t_2)) || PyTuple_CheckExact(__pyx_t_2)) {
      __pyx_t_3 = __pyx_t_2; __Pyx_INCREF(__pyx_t_3); __pyx_t_5 = 0;
      __pyx_t_7 = NULL;
    } else {
      __pyx_t_5 = -1; __pyx_t_3 = PyObject_GetIter(__pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1361, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __pyx_t_7 = Py_TYPE(__pyx_t_3)->tp_iternext; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1361, __pyx_L1_error)
    }
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    for (;;) {
      if (likely(!__pyx_t_7)) {
        if (likely(PyList_CheckExact(__pyx_t_3))) {
          if (__pyx_t_5 >= PyList_GET_SIZE(__pyx_t_3)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_2 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_5); __Pyx_INCREF(__pyx_t_2); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 1361, __pyx_L1_error)
          #else
          __pyx_t_2 = PySequence_ITEM(__pyx_t_3, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1361, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_2);
          #endif
        } else {
          if (__pyx_t_5 >= PyTuple_GET_SIZE(__pyx_t_3)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_2 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_5); __Pyx_INCREF(__pyx_t_2); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 1361, __pyx_L1_error)
          #else
          __pyx_t_2 = PySequence_ITEM(__pyx_t_3, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1361, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_2);
          #endif
        }
      } else {
        __pyx_t_2 = __pyx_t_7(__pyx_t_3);
        if (unlikely(!__pyx_t_2)) {
          PyObject* exc_type = PyErr_Occurred();
          if (exc_type) {
            if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
            else __PYX_ERR(0, 1361, __pyx_L1_error)
          }
          break;
        }
        __Pyx_GOTREF(__pyx_t_2);
      }
      __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_2);
      __pyx_t_2 = 0;
      __pyx_t_2 = __Pyx_PyInt_RemainderObjC(__pyx_v_i, __pyx_int_3, 3, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1361, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __pyx_t_10 = PyObject_RichCompare(__pyx_t_2, __pyx_int_2, Py_NE); __Pyx_XGOTREF(__pyx_t_10); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1361, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_10); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 1361, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
      if (__pyx_t_6) {
        __pyx_t_10 = PyObject_GetItem(__pyx_v_key, __pyx_v_i); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1361, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_10);
        if (unlikely(__Pyx_ListComp_Append(__pyx_t_1, (PyObject*)__pyx_t_10))) __PYX_ERR(0, 1361, __pyx_L1_error)
        __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
      }
    }
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = __Pyx_PyString_Join(__pyx_kp_s__24, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1361, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = PyList_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1361, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_GIVEREF(__pyx_t_3);
    PyList_SET_ITEM(__pyx_t_1, 0, __pyx_t_3);
    __pyx_t_3 = 0;
    __Pyx_DECREF_SET(__pyx_v_subkeys_info, ((PyObject*)__pyx_t_1));
    __pyx_t_1 = 0;
  }
  __pyx_L3:;

  /* "vapor_vali/Simple_function.pyx":1362
 *         # for every codon, only include the first 2 bases in the hash
 *         subkeys_info = ["".join([key[i] for i in range(len(key)) if i % 3 != 2])]
 *     if inversions:             # <<<<<<<<<<<<<<
 *         for i in range(len(subkeys_info)):
 *             subkeys_info.append("".join([invert_base[c] for c in reversed(subkeys_info[i])]))
 */
  __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_v_inversions); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 1362, __pyx_L1_error)
  if (__pyx_t_6) {

    /* "vapor_vali/Simple_function.pyx":1363
 *         subkeys_info = ["".join([key[i] for i in range(len(key)) if i % 3 != 2])]
 *     if inversions:
 *         for i in range(len(subkeys_info)):             # <<<<<<<<<<<<<<
 *             subkeys_info.append("".join([invert_base[c] for c in reversed(subkeys_info[i])]))
 *     return subkeys_info
 */
    __pyx_t_5 = PyList_GET_SIZE(__pyx_v_subkeys_info); if (unlikely(__pyx_t_5 == -1)) __PYX_ERR(0, 1363, __pyx_L1_error)
    __pyx_t_1 = PyInt_FromSsize_t(__pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1363, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1363, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_GIVEREF(__pyx_t_1);
    PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_1);
    __pyx_t_1 = 0;
    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_t_3, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1363, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    if (likely(PyList_CheckExact(__pyx_t_1)) || PyTuple_CheckExact(__pyx_t_1)) {
      __pyx_t_3 = __pyx_t_1; __Pyx_INCREF(__pyx_t_3); __pyx_t_5 = 0;
      __pyx_t_7 = NULL;
    } else {
      __pyx_t_5 = -1; __pyx_t_3 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1363, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __pyx_t_7 = Py_TYPE(__pyx_t_3)->tp_iternext; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1363, __pyx_L1_error)
    }
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    for (;;) {
      if (likely(!__pyx_t_7)) {
        if (likely(PyList_CheckExact(__pyx_t_3))) {
          if (__pyx_t_5 >= PyList_GET_SIZE(__pyx_t_3)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_1 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_5); __Pyx_INCREF(__pyx_t_1); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 1363, __pyx_L1_error)
          #else
          __pyx_t_1 = PySequence_ITEM(__pyx_t_3, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1363, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_1);
          #endif
        } else {
          if (__pyx_t_5 >= PyTuple_GET_SIZE(__pyx_t_3)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_5); __Pyx_INCREF(__pyx_t_1); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 1363, __pyx_L1_error)
          #else
          __pyx_t_1 = PySequence_ITEM(__pyx_t_3, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1363, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_1);
          #endif
        }
      } else {
        __pyx_t_1 = __pyx_t_7(__pyx_t_3);
        if (unlikely(!__pyx_t_1)) {
          PyObject* exc_type = PyErr_Occurred();
          if (exc_type) {
            if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
            else __PYX_ERR(0, 1363, __pyx_L1_error)
          }
          break;
        }
        __Pyx_GOTREF(__pyx_t_1);
      }
      __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_1);
      __pyx_t_1 = 0;

      /* "vapor_vali/Simple_function.pyx":1364
 *     if inversions:
 *         for i in range(len(subkeys_info)):
 *             subkeys_info.append("".join([invert_base[c] for c in reversed(subkeys_info[i])]))             # <<<<<<<<<<<<<<
 *     return subkeys_info
 * 
 */
      __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1364, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __pyx_t_10 = PyObject_GetItem(__pyx_v_subkeys_info, __pyx_v_i); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1364, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_10);
      __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1364, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __Pyx_GIVEREF(__pyx_t_10);
      PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_10);
      __pyx_t_10 = 0;
      __pyx_t_10 = __Pyx_PyObject_Call(__pyx_builtin_reversed, __pyx_t_2, NULL); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1364, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_10);
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      if (likely(PyList_CheckExact(__pyx_t_10)) || PyTuple_CheckExact(__pyx_t_10)) {
        __pyx_t_2 = __pyx_t_10; __Pyx_INCREF(__pyx_t_2); __pyx_t_8 = 0;
        __pyx_t_9 = NULL;
      } else {
        __pyx_t_8 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_t_10); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1364, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
        __pyx_t_9 = Py_TYPE(__pyx_t_2)->tp_iternext; if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1364, __pyx_L1_error)
      }
      __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
      for (;;) {
        if (likely(!__pyx_t_9)) {
          if (likely(PyList_CheckExact(__pyx_t_2))) {
            if (__pyx_t_8 >= PyList_GET_SIZE(__pyx_t_2)) break;
            #if CYTHON_COMPILING_IN_CPYTHON
            __pyx_t_10 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_8); __Pyx_INCREF(__pyx_t_10); __pyx_t_8++; if (unlikely(0 < 0)) __PYX_ERR(0, 1364, __pyx_L1_error)
            #else
            __pyx_t_10 = PySequence_ITEM(__pyx_t_2, __pyx_t_8); __pyx_t_8++; if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1364, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_10);
            #endif
          } else {
            if (__pyx_t_8 >= PyTuple_GET_SIZE(__pyx_t_2)) break;
            #if CYTHON_COMPILING_IN_CPYTHON
            __pyx_t_10 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_8); __Pyx_INCREF(__pyx_t_10); __pyx_t_8++; if (unlikely(0 < 0)) __PYX_ERR(0, 1364, __pyx_L1_error)
            #else
            __pyx_t_10 = PySequence_ITEM(__pyx_t_2, __pyx_t_8); __pyx_t_8++; if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1364, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_10);
            #endif
          }
        } else {
          __pyx_t_10 = __pyx_t_9(__pyx_t_2);
          if (unlikely(!__pyx_t_10)) {
            PyObject* exc_type = PyErr_Occurred();
            if (exc_type) {
              if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
              else __PYX_ERR(0, 1364, __pyx_L1_error)
            }
            break;
          }
          __Pyx_GOTREF(__pyx_t_10);
        }
        __Pyx_XDECREF_SET(__pyx_v_c, __pyx_t_10);
        __pyx_t_10 = 0;
        __pyx_t_10 = __Pyx_GetModuleGlobalName(__pyx_n_s_invert_base); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1364, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_10);
        __pyx_t_4 = PyObject_GetItem(__pyx_t_10, __pyx_v_c); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1364, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_4);
        __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
        if (unlikely(__Pyx_ListComp_Append(__pyx_t_1, (PyObject*)__pyx_t_4))) __PYX_ERR(0, 1364, __pyx_L1_error)
        __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      }
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_2 = __Pyx_PyString_Join(__pyx_kp_s__24, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1364, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_11 = __Pyx_PyList_Append(__pyx_v_subkeys_info, __pyx_t_2); if (unlikely(__pyx_t_11 == -1)) __PYX_ERR(0, 1364, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

      /* "vapor_vali/Simple_function.pyx":1363
 *         subkeys_info = ["".join([key[i] for i in range(len(key)) if i % 3 != 2])]
 *     if inversions:
 *         for i in range(len(subkeys_info)):             # <<<<<<<<<<<<<<
 *             subkeys_info.append("".join([invert_base[c] for c in reversed(subkeys_info[i])]))
 *     return subkeys_info
 */
    }
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;

    /* "vapor_vali/Simple_function.pyx":1362
 *         # for every codon, only include the first 2 bases in the hash
 *         subkeys_info = ["".join([key[i] for i in range(len(key)) if i % 3 != 2])]
 *     if inversions:             # <<<<<<<<<<<<<<
 *         for i in range(len(subkeys_info)):
 *             subkeys_info.append("".join([invert_base[c] for c in reversed(subkeys_info[i])]))
 */
  }

  /* "vapor_vali/Simple_function.pyx":1365
 *         for i in range(len(subkeys_info)):
 *             subkeys_info.append("".join([invert_base[c] for c in reversed(subkeys_info[i])]))
 *     return subkeys_info             # <<<<<<<<<<<<<<
 * 
 * def svtype_extract(pin):
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_subkeys_info);
  __pyx_r = __pyx_v_subkeys_info;
  goto __pyx_L0;

  /* "vapor_vali/Simple_function.pyx":1346
 *     return x
 * 
 * def subkeys(key, nth_base, inversions):             # <<<<<<<<<<<<<<
 *     subkeys_info = []
 *     key=key_modify(key)
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_10);
  __Pyx_AddTraceback("vapor_vali.Simple_function.subkeys", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_subkeys_info);
  __Pyx_XDECREF(__pyx_v_k);
  __Pyx_XDECREF(__pyx_v_substr_list);
  __Pyx_XDECREF(__pyx_v_i);
  __Pyx_XDECREF(__pyx_v_j);
  __Pyx_XDECREF(__pyx_v_c);
  __Pyx_XDECREF(__pyx_v_key);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "vapor_vali/Simple_function.pyx":1367
 *     return subkeys_info
 * 
 * def svtype_extract(pin):             # <<<<<<<<<<<<<<
 *     svtype=''
 *     for x in pin[7].split(';'):
 */

/* Python wrapper */
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_187svtype_extract(PyObject *__pyx_self, PyObject *__pyx_v_pin); /*proto*/
static PyMethodDef __pyx_mdef_10vapor_vali_15Simple_function_187svtype_extract = {"svtype_extract", (PyCFunction)__pyx_pw_10vapor_vali_15Simple_function_187svtype_extract, METH_O, 0};
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_187svtype_extract(PyObject *__pyx_self, PyObject *__pyx_v_pin) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("svtype_extract (wrapper)", 0);
  __pyx_r = __pyx_pf_10vapor_vali_15Simple_function_186svtype_extract(__pyx_self, ((PyObject *)__pyx_v_pin));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10vapor_vali_15Simple_function_186svtype_extract(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_pin) {
  PyObject *__pyx_v_svtype = NULL;
  PyObject *__pyx_v_x = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  Py_ssize_t __pyx_t_3;
  PyObject *(*__pyx_t_4)(PyObject *);
  int __pyx_t_5;
  int __pyx_t_6;
  PyObject *__pyx_t_7 = NULL;
  __Pyx_RefNannySetupContext("svtype_extract", 0);

  /* "vapor_vali/Simple_function.pyx":1368
 * 
 * def svtype_extract(pin):
 *     svtype=''             # <<<<<<<<<<<<<<
 *     for x in pin[7].split(';'):
 *         if 'SVTYPE' in x:
 */
  __Pyx_INCREF(__pyx_kp_s__24);
  __pyx_v_svtype = __pyx_kp_s__24;

  /* "vapor_vali/Simple_function.pyx":1369
 * def svtype_extract(pin):
 *     svtype=''
 *     for x in pin[7].split(';'):             # <<<<<<<<<<<<<<
 *         if 'SVTYPE' in x:
 *             svtype=x.split('=')[1]
 */
  __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_pin, 7, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1369, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_split); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1369, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_tuple__98, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1369, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  if (likely(PyList_CheckExact(__pyx_t_1)) || PyTuple_CheckExact(__pyx_t_1)) {
    __pyx_t_2 = __pyx_t_1; __Pyx_INCREF(__pyx_t_2); __pyx_t_3 = 0;
    __pyx_t_4 = NULL;
  } else {
    __pyx_t_3 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1369, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_4 = Py_TYPE(__pyx_t_2)->tp_iternext; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1369, __pyx_L1_error)
  }
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  for (;;) {
    if (likely(!__pyx_t_4)) {
      if (likely(PyList_CheckExact(__pyx_t_2))) {
        if (__pyx_t_3 >= PyList_GET_SIZE(__pyx_t_2)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_1 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_3); __Pyx_INCREF(__pyx_t_1); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 1369, __pyx_L1_error)
        #else
        __pyx_t_1 = PySequence_ITEM(__pyx_t_2, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1369, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        #endif
      } else {
        if (__pyx_t_3 >= PyTuple_GET_SIZE(__pyx_t_2)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_3); __Pyx_INCREF(__pyx_t_1); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 1369, __pyx_L1_error)
        #else
        __pyx_t_1 = PySequence_ITEM(__pyx_t_2, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1369, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        #endif
      }
    } else {
      __pyx_t_1 = __pyx_t_4(__pyx_t_2);
      if (unlikely(!__pyx_t_1)) {
        PyObject* exc_type = PyErr_Occurred();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
          else __PYX_ERR(0, 1369, __pyx_L1_error)
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_1);
    }
    __Pyx_XDECREF_SET(__pyx_v_x, __pyx_t_1);
    __pyx_t_1 = 0;

    /* "vapor_vali/Simple_function.pyx":1370
 *     svtype=''
 *     for x in pin[7].split(';'):
 *         if 'SVTYPE' in x:             # <<<<<<<<<<<<<<
 *             svtype=x.split('=')[1]
 *     if svtype=='':
 */
    __pyx_t_5 = (__Pyx_PySequence_ContainsTF(__pyx_n_s_SVTYPE, __pyx_v_x, Py_EQ)); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 1370, __pyx_L1_error)
    __pyx_t_6 = (__pyx_t_5 != 0);
    if (__pyx_t_6) {

      /* "vapor_vali/Simple_function.pyx":1371
 *     for x in pin[7].split(';'):
 *         if 'SVTYPE' in x:
 *             svtype=x.split('=')[1]             # <<<<<<<<<<<<<<
 *     if svtype=='':
 *         svtype=pin[4].replace('<','').replace('>','')
 */
      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_x, __pyx_n_s_split); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1371, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_tuple__99, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1371, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_7);
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_1 = __Pyx_GetItemInt(__pyx_t_7, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1371, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
      __Pyx_DECREF_SET(__pyx_v_svtype, __pyx_t_1);
      __pyx_t_1 = 0;

      /* "vapor_vali/Simple_function.pyx":1370
 *     svtype=''
 *     for x in pin[7].split(';'):
 *         if 'SVTYPE' in x:             # <<<<<<<<<<<<<<
 *             svtype=x.split('=')[1]
 *     if svtype=='':
 */
    }

    /* "vapor_vali/Simple_function.pyx":1369
 * def svtype_extract(pin):
 *     svtype=''
 *     for x in pin[7].split(';'):             # <<<<<<<<<<<<<<
 *         if 'SVTYPE' in x:
 *             svtype=x.split('=')[1]
 */
  }
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":1372
 *         if 'SVTYPE' in x:
 *             svtype=x.split('=')[1]
 *     if svtype=='':             # <<<<<<<<<<<<<<
 *         svtype=pin[4].replace('<','').replace('>','')
 *     return svtype
 */
  __pyx_t_6 = (__Pyx_PyString_Equals(__pyx_v_svtype, __pyx_kp_s__24, Py_EQ)); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 1372, __pyx_L1_error)
  if (__pyx_t_6) {

    /* "vapor_vali/Simple_function.pyx":1373
 *             svtype=x.split('=')[1]
 *     if svtype=='':
 *         svtype=pin[4].replace('<','').replace('>','')             # <<<<<<<<<<<<<<
 *     return svtype
 * 
 */
    __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_pin, 4, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1373, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_replace); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1373, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_tuple__101, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1373, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_replace); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1373, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_tuple__103, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1373, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __Pyx_DECREF_SET(__pyx_v_svtype, __pyx_t_2);
    __pyx_t_2 = 0;

    /* "vapor_vali/Simple_function.pyx":1372
 *         if 'SVTYPE' in x:
 *             svtype=x.split('=')[1]
 *     if svtype=='':             # <<<<<<<<<<<<<<
 *         svtype=pin[4].replace('<','').replace('>','')
 *     return svtype
 */
  }

  /* "vapor_vali/Simple_function.pyx":1374
 *     if svtype=='':
 *         svtype=pin[4].replace('<','').replace('>','')
 *     return svtype             # <<<<<<<<<<<<<<
 * 
 * def sv_len_extract(pin):
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_svtype);
  __pyx_r = __pyx_v_svtype;
  goto __pyx_L0;

  /* "vapor_vali/Simple_function.pyx":1367
 *     return subkeys_info
 * 
 * def svtype_extract(pin):             # <<<<<<<<<<<<<<
 *     svtype=''
 *     for x in pin[7].split(';'):
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_7);
  __Pyx_AddTraceback("vapor_vali.Simple_function.svtype_extract", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_svtype);
  __Pyx_XDECREF(__pyx_v_x);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "vapor_vali/Simple_function.pyx":1376
 *     return svtype
 * 
 * def sv_len_extract(pin):             # <<<<<<<<<<<<<<
 *     svtype=''
 *     for x in pin[7].split(';'):
 */

/* Python wrapper */
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_189sv_len_extract(PyObject *__pyx_self, PyObject *__pyx_v_pin); /*proto*/
static PyMethodDef __pyx_mdef_10vapor_vali_15Simple_function_189sv_len_extract = {"sv_len_extract", (PyCFunction)__pyx_pw_10vapor_vali_15Simple_function_189sv_len_extract, METH_O, 0};
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_189sv_len_extract(PyObject *__pyx_self, PyObject *__pyx_v_pin) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("sv_len_extract (wrapper)", 0);
  __pyx_r = __pyx_pf_10vapor_vali_15Simple_function_188sv_len_extract(__pyx_self, ((PyObject *)__pyx_v_pin));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10vapor_vali_15Simple_function_188sv_len_extract(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_pin) {
  PyObject *__pyx_v_svtype = NULL;
  PyObject *__pyx_v_x = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  Py_ssize_t __pyx_t_3;
  PyObject *(*__pyx_t_4)(PyObject *);
  int __pyx_t_5;
  int __pyx_t_6;
  PyObject *__pyx_t_7 = NULL;
  __Pyx_RefNannySetupContext("sv_len_extract", 0);

  /* "vapor_vali/Simple_function.pyx":1377
 * 
 * def sv_len_extract(pin):
 *     svtype=''             # <<<<<<<<<<<<<<
 *     for x in pin[7].split(';'):
 *         if 'SVLEN' in x:
 */
  __Pyx_INCREF(__pyx_kp_s__24);
  __pyx_v_svtype = __pyx_kp_s__24;

  /* "vapor_vali/Simple_function.pyx":1378
 * def sv_len_extract(pin):
 *     svtype=''
 *     for x in pin[7].split(';'):             # <<<<<<<<<<<<<<
 *         if 'SVLEN' in x:
 *             svtype=x.split('=')[1]
 */
  __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_pin, 7, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1378, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_split); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1378, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_tuple__104, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1378, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  if (likely(PyList_CheckExact(__pyx_t_1)) || PyTuple_CheckExact(__pyx_t_1)) {
    __pyx_t_2 = __pyx_t_1; __Pyx_INCREF(__pyx_t_2); __pyx_t_3 = 0;
    __pyx_t_4 = NULL;
  } else {
    __pyx_t_3 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1378, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_4 = Py_TYPE(__pyx_t_2)->tp_iternext; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1378, __pyx_L1_error)
  }
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  for (;;) {
    if (likely(!__pyx_t_4)) {
      if (likely(PyList_CheckExact(__pyx_t_2))) {
        if (__pyx_t_3 >= PyList_GET_SIZE(__pyx_t_2)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_1 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_3); __Pyx_INCREF(__pyx_t_1); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 1378, __pyx_L1_error)
        #else
        __pyx_t_1 = PySequence_ITEM(__pyx_t_2, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1378, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        #endif
      } else {
        if (__pyx_t_3 >= PyTuple_GET_SIZE(__pyx_t_2)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_3); __Pyx_INCREF(__pyx_t_1); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 1378, __pyx_L1_error)
        #else
        __pyx_t_1 = PySequence_ITEM(__pyx_t_2, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1378, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        #endif
      }
    } else {
      __pyx_t_1 = __pyx_t_4(__pyx_t_2);
      if (unlikely(!__pyx_t_1)) {
        PyObject* exc_type = PyErr_Occurred();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
          else __PYX_ERR(0, 1378, __pyx_L1_error)
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_1);
    }
    __Pyx_XDECREF_SET(__pyx_v_x, __pyx_t_1);
    __pyx_t_1 = 0;

    /* "vapor_vali/Simple_function.pyx":1379
 *     svtype=''
 *     for x in pin[7].split(';'):
 *         if 'SVLEN' in x:             # <<<<<<<<<<<<<<
 *             svtype=x.split('=')[1]
 *     if svtype=='':
 */
    __pyx_t_5 = (__Pyx_PySequence_ContainsTF(__pyx_n_s_SVLEN_2, __pyx_v_x, Py_EQ)); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 1379, __pyx_L1_error)
    __pyx_t_6 = (__pyx_t_5 != 0);
    if (__pyx_t_6) {

      /* "vapor_vali/Simple_function.pyx":1380
 *     for x in pin[7].split(';'):
 *         if 'SVLEN' in x:
 *             svtype=x.split('=')[1]             # <<<<<<<<<<<<<<
 *     if svtype=='':
 *         svtype=0
 */
      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_x, __pyx_n_s_split); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1380, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_tuple__105, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1380, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_7);
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_1 = __Pyx_GetItemInt(__pyx_t_7, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1380, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
      __Pyx_DECREF_SET(__pyx_v_svtype, __pyx_t_1);
      __pyx_t_1 = 0;

      /* "vapor_vali/Simple_function.pyx":1379
 *     svtype=''
 *     for x in pin[7].split(';'):
 *         if 'SVLEN' in x:             # <<<<<<<<<<<<<<
 *             svtype=x.split('=')[1]
 *     if svtype=='':
 */
    }

    /* "vapor_vali/Simple_function.pyx":1378
 * def sv_len_extract(pin):
 *     svtype=''
 *     for x in pin[7].split(';'):             # <<<<<<<<<<<<<<
 *         if 'SVLEN' in x:
 *             svtype=x.split('=')[1]
 */
  }
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":1381
 *         if 'SVLEN' in x:
 *             svtype=x.split('=')[1]
 *     if svtype=='':             # <<<<<<<<<<<<<<
 *         svtype=0
 *     return svtype
 */
  __pyx_t_6 = (__Pyx_PyString_Equals(__pyx_v_svtype, __pyx_kp_s__24, Py_EQ)); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 1381, __pyx_L1_error)
  if (__pyx_t_6) {

    /* "vapor_vali/Simple_function.pyx":1382
 *             svtype=x.split('=')[1]
 *     if svtype=='':
 *         svtype=0             # <<<<<<<<<<<<<<
 *     return svtype
 * 
 */
    __Pyx_INCREF(__pyx_int_0);
    __Pyx_DECREF_SET(__pyx_v_svtype, __pyx_int_0);

    /* "vapor_vali/Simple_function.pyx":1381
 *         if 'SVLEN' in x:
 *             svtype=x.split('=')[1]
 *     if svtype=='':             # <<<<<<<<<<<<<<
 *         svtype=0
 *     return svtype
 */
  }

  /* "vapor_vali/Simple_function.pyx":1383
 *     if svtype=='':
 *         svtype=0
 *     return svtype             # <<<<<<<<<<<<<<
 * 
 * def sv_seq_extract(pin):
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_svtype);
  __pyx_r = __pyx_v_svtype;
  goto __pyx_L0;

  /* "vapor_vali/Simple_function.pyx":1376
 *     return svtype
 * 
 * def sv_len_extract(pin):             # <<<<<<<<<<<<<<
 *     svtype=''
 *     for x in pin[7].split(';'):
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_7);
  __Pyx_AddTraceback("vapor_vali.Simple_function.sv_len_extract", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_svtype);
  __Pyx_XDECREF(__pyx_v_x);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "vapor_vali/Simple_function.pyx":1385
 *     return svtype
 * 
 * def sv_seq_extract(pin):             # <<<<<<<<<<<<<<
 *     seq=''
 *     for x in pin[7].split(';'):
 */

/* Python wrapper */
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_191sv_seq_extract(PyObject *__pyx_self, PyObject *__pyx_v_pin); /*proto*/
static PyMethodDef __pyx_mdef_10vapor_vali_15Simple_function_191sv_seq_extract = {"sv_seq_extract", (PyCFunction)__pyx_pw_10vapor_vali_15Simple_function_191sv_seq_extract, METH_O, 0};
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_191sv_seq_extract(PyObject *__pyx_self, PyObject *__pyx_v_pin) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("sv_seq_extract (wrapper)", 0);
  __pyx_r = __pyx_pf_10vapor_vali_15Simple_function_190sv_seq_extract(__pyx_self, ((PyObject *)__pyx_v_pin));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10vapor_vali_15Simple_function_190sv_seq_extract(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_pin) {
  PyObject *__pyx_v_seq = NULL;
  PyObject *__pyx_v_x = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  Py_ssize_t __pyx_t_3;
  PyObject *(*__pyx_t_4)(PyObject *);
  int __pyx_t_5;
  PyObject *__pyx_t_6 = NULL;
  __Pyx_RefNannySetupContext("sv_seq_extract", 0);

  /* "vapor_vali/Simple_function.pyx":1386
 * 
 * def sv_seq_extract(pin):
 *     seq=''             # <<<<<<<<<<<<<<
 *     for x in pin[7].split(';'):
 *         if x[:4]=='SEQ=':
 */
  __Pyx_INCREF(__pyx_kp_s__24);
  __pyx_v_seq = __pyx_kp_s__24;

  /* "vapor_vali/Simple_function.pyx":1387
 * def sv_seq_extract(pin):
 *     seq=''
 *     for x in pin[7].split(';'):             # <<<<<<<<<<<<<<
 *         if x[:4]=='SEQ=':
 *             seq=x.split('=')[1]
 */
  __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_pin, 7, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1387, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_split); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1387, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_tuple__106, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1387, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  if (likely(PyList_CheckExact(__pyx_t_1)) || PyTuple_CheckExact(__pyx_t_1)) {
    __pyx_t_2 = __pyx_t_1; __Pyx_INCREF(__pyx_t_2); __pyx_t_3 = 0;
    __pyx_t_4 = NULL;
  } else {
    __pyx_t_3 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1387, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_4 = Py_TYPE(__pyx_t_2)->tp_iternext; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1387, __pyx_L1_error)
  }
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  for (;;) {
    if (likely(!__pyx_t_4)) {
      if (likely(PyList_CheckExact(__pyx_t_2))) {
        if (__pyx_t_3 >= PyList_GET_SIZE(__pyx_t_2)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_1 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_3); __Pyx_INCREF(__pyx_t_1); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 1387, __pyx_L1_error)
        #else
        __pyx_t_1 = PySequence_ITEM(__pyx_t_2, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1387, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        #endif
      } else {
        if (__pyx_t_3 >= PyTuple_GET_SIZE(__pyx_t_2)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_3); __Pyx_INCREF(__pyx_t_1); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 1387, __pyx_L1_error)
        #else
        __pyx_t_1 = PySequence_ITEM(__pyx_t_2, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1387, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        #endif
      }
    } else {
      __pyx_t_1 = __pyx_t_4(__pyx_t_2);
      if (unlikely(!__pyx_t_1)) {
        PyObject* exc_type = PyErr_Occurred();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
          else __PYX_ERR(0, 1387, __pyx_L1_error)
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_1);
    }
    __Pyx_XDECREF_SET(__pyx_v_x, __pyx_t_1);
    __pyx_t_1 = 0;

    /* "vapor_vali/Simple_function.pyx":1388
 *     seq=''
 *     for x in pin[7].split(';'):
 *         if x[:4]=='SEQ=':             # <<<<<<<<<<<<<<
 *             seq=x.split('=')[1]
 *     return seq
 */
    __pyx_t_1 = __Pyx_PyObject_GetSlice(__pyx_v_x, 0, 4, NULL, NULL, &__pyx_slice__107, 0, 1, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1388, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_5 = (__Pyx_PyString_Equals(__pyx_t_1, __pyx_kp_s_SEQ, Py_EQ)); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 1388, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    if (__pyx_t_5) {

      /* "vapor_vali/Simple_function.pyx":1389
 *     for x in pin[7].split(';'):
 *         if x[:4]=='SEQ=':
 *             seq=x.split('=')[1]             # <<<<<<<<<<<<<<
 *     return seq
 * 
 */
      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_x, __pyx_n_s_split); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1389, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_tuple__108, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1389, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_6);
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_1 = __Pyx_GetItemInt(__pyx_t_6, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1389, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
      __Pyx_DECREF_SET(__pyx_v_seq, __pyx_t_1);
      __pyx_t_1 = 0;

      /* "vapor_vali/Simple_function.pyx":1388
 *     seq=''
 *     for x in pin[7].split(';'):
 *         if x[:4]=='SEQ=':             # <<<<<<<<<<<<<<
 *             seq=x.split('=')[1]
 *     return seq
 */
    }

    /* "vapor_vali/Simple_function.pyx":1387
 * def sv_seq_extract(pin):
 *     seq=''
 *     for x in pin[7].split(';'):             # <<<<<<<<<<<<<<
 *         if x[:4]=='SEQ=':
 *             seq=x.split('=')[1]
 */
  }
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":1390
 *         if x[:4]=='SEQ=':
 *             seq=x.split('=')[1]
 *     return seq             # <<<<<<<<<<<<<<
 * 
 * def sv_insert_point_define(pin):
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_seq);
  __pyx_r = __pyx_v_seq;
  goto __pyx_L0;

  /* "vapor_vali/Simple_function.pyx":1385
 *     return svtype
 * 
 * def sv_seq_extract(pin):             # <<<<<<<<<<<<<<
 *     seq=''
 *     for x in pin[7].split(';'):
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_AddTraceback("vapor_vali.Simple_function.sv_seq_extract", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_seq);
  __Pyx_XDECREF(__pyx_v_x);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "vapor_vali/Simple_function.pyx":1392
 *     return seq
 * 
 * def sv_insert_point_define(pin):             # <<<<<<<<<<<<<<
 *     svtype=[0,0]
 *     for x in pin[7].split(';'):
 */

/* Python wrapper */
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_193sv_insert_point_define(PyObject *__pyx_self, PyObject *__pyx_v_pin); /*proto*/
static PyMethodDef __pyx_mdef_10vapor_vali_15Simple_function_193sv_insert_point_define = {"sv_insert_point_define", (PyCFunction)__pyx_pw_10vapor_vali_15Simple_function_193sv_insert_point_define, METH_O, 0};
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_193sv_insert_point_define(PyObject *__pyx_self, PyObject *__pyx_v_pin) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("sv_insert_point_define (wrapper)", 0);
  __pyx_r = __pyx_pf_10vapor_vali_15Simple_function_192sv_insert_point_define(__pyx_self, ((PyObject *)__pyx_v_pin));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10vapor_vali_15Simple_function_192sv_insert_point_define(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_pin) {
  PyObject *__pyx_v_svtype = NULL;
  PyObject *__pyx_v_x = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_sv_info = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  Py_ssize_t __pyx_t_3;
  PyObject *(*__pyx_t_4)(PyObject *);
  int __pyx_t_5;
  int __pyx_t_6;
  PyObject *__pyx_t_7 = NULL;
  __Pyx_RefNannySetupContext("sv_insert_point_define", 0);

  /* "vapor_vali/Simple_function.pyx":1393
 * 
 * def sv_insert_point_define(pin):
 *     svtype=[0,0]             # <<<<<<<<<<<<<<
 *     for x in pin[7].split(';'):
 *         if 'insert_point=' in x:
 */
  __pyx_t_1 = PyList_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1393, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_INCREF(__pyx_int_0);
  __Pyx_GIVEREF(__pyx_int_0);
  PyList_SET_ITEM(__pyx_t_1, 0, __pyx_int_0);
  __Pyx_INCREF(__pyx_int_0);
  __Pyx_GIVEREF(__pyx_int_0);
  PyList_SET_ITEM(__pyx_t_1, 1, __pyx_int_0);
  __pyx_v_svtype = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":1394
 * def sv_insert_point_define(pin):
 *     svtype=[0,0]
 *     for x in pin[7].split(';'):             # <<<<<<<<<<<<<<
 *         if 'insert_point=' in x:
 *             svtype=x.split('=')[1].split(':')
 */
  __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_pin, 7, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1394, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_split); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1394, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_tuple__109, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1394, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  if (likely(PyList_CheckExact(__pyx_t_1)) || PyTuple_CheckExact(__pyx_t_1)) {
    __pyx_t_2 = __pyx_t_1; __Pyx_INCREF(__pyx_t_2); __pyx_t_3 = 0;
    __pyx_t_4 = NULL;
  } else {
    __pyx_t_3 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1394, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_4 = Py_TYPE(__pyx_t_2)->tp_iternext; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1394, __pyx_L1_error)
  }
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  for (;;) {
    if (likely(!__pyx_t_4)) {
      if (likely(PyList_CheckExact(__pyx_t_2))) {
        if (__pyx_t_3 >= PyList_GET_SIZE(__pyx_t_2)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_1 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_3); __Pyx_INCREF(__pyx_t_1); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 1394, __pyx_L1_error)
        #else
        __pyx_t_1 = PySequence_ITEM(__pyx_t_2, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1394, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        #endif
      } else {
        if (__pyx_t_3 >= PyTuple_GET_SIZE(__pyx_t_2)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_3); __Pyx_INCREF(__pyx_t_1); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 1394, __pyx_L1_error)
        #else
        __pyx_t_1 = PySequence_ITEM(__pyx_t_2, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1394, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        #endif
      }
    } else {
      __pyx_t_1 = __pyx_t_4(__pyx_t_2);
      if (unlikely(!__pyx_t_1)) {
        PyObject* exc_type = PyErr_Occurred();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
          else __PYX_ERR(0, 1394, __pyx_L1_error)
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_1);
    }
    __Pyx_XDECREF_SET(__pyx_v_x, __pyx_t_1);
    __pyx_t_1 = 0;

    /* "vapor_vali/Simple_function.pyx":1395
 *     svtype=[0,0]
 *     for x in pin[7].split(';'):
 *         if 'insert_point=' in x:             # <<<<<<<<<<<<<<
 *             svtype=x.split('=')[1].split(':')
 *     if svtype==[0,0]:
 */
    __pyx_t_5 = (__Pyx_PySequence_ContainsTF(__pyx_kp_s_insert_point, __pyx_v_x, Py_EQ)); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 1395, __pyx_L1_error)
    __pyx_t_6 = (__pyx_t_5 != 0);
    if (__pyx_t_6) {

      /* "vapor_vali/Simple_function.pyx":1396
 *     for x in pin[7].split(';'):
 *         if 'insert_point=' in x:
 *             svtype=x.split('=')[1].split(':')             # <<<<<<<<<<<<<<
 *     if svtype==[0,0]:
 *         sv_info=pin[:2]
 */
      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_x, __pyx_n_s_split); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1396, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_tuple__110, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1396, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_7);
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_1 = __Pyx_GetItemInt(__pyx_t_7, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1396, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
      __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_split); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1396, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_7);
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_7, __pyx_tuple__111, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1396, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
      __Pyx_DECREF_SET(__pyx_v_svtype, __pyx_t_1);
      __pyx_t_1 = 0;

      /* "vapor_vali/Simple_function.pyx":1395
 *     svtype=[0,0]
 *     for x in pin[7].split(';'):
 *         if 'insert_point=' in x:             # <<<<<<<<<<<<<<
 *             svtype=x.split('=')[1].split(':')
 *     if svtype==[0,0]:
 */
    }

    /* "vapor_vali/Simple_function.pyx":1394
 * def sv_insert_point_define(pin):
 *     svtype=[0,0]
 *     for x in pin[7].split(';'):             # <<<<<<<<<<<<<<
 *         if 'insert_point=' in x:
 *             svtype=x.split('=')[1].split(':')
 */
  }
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":1397
 *         if 'insert_point=' in x:
 *             svtype=x.split('=')[1].split(':')
 *     if svtype==[0,0]:             # <<<<<<<<<<<<<<
 *         sv_info=pin[:2]
 *     return svtype
 */
  __pyx_t_2 = PyList_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1397, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_INCREF(__pyx_int_0);
  __Pyx_GIVEREF(__pyx_int_0);
  PyList_SET_ITEM(__pyx_t_2, 0, __pyx_int_0);
  __Pyx_INCREF(__pyx_int_0);
  __Pyx_GIVEREF(__pyx_int_0);
  PyList_SET_ITEM(__pyx_t_2, 1, __pyx_int_0);
  __pyx_t_1 = PyObject_RichCompare(__pyx_v_svtype, __pyx_t_2, Py_EQ); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1397, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 1397, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  if (__pyx_t_6) {

    /* "vapor_vali/Simple_function.pyx":1398
 *             svtype=x.split('=')[1].split(':')
 *     if svtype==[0,0]:
 *         sv_info=pin[:2]             # <<<<<<<<<<<<<<
 *     return svtype
 * 
 */
    __pyx_t_1 = __Pyx_PyObject_GetSlice(__pyx_v_pin, 0, 2, NULL, NULL, &__pyx_slice__112, 0, 1, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1398, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_sv_info = __pyx_t_1;
    __pyx_t_1 = 0;

    /* "vapor_vali/Simple_function.pyx":1397
 *         if 'insert_point=' in x:
 *             svtype=x.split('=')[1].split(':')
 *     if svtype==[0,0]:             # <<<<<<<<<<<<<<
 *         sv_info=pin[:2]
 *     return svtype
 */
  }

  /* "vapor_vali/Simple_function.pyx":1399
 *     if svtype==[0,0]:
 *         sv_info=pin[:2]
 *     return svtype             # <<<<<<<<<<<<<<
 * 
 * def take_off_symmetric_dots(list_dotdata):
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_svtype);
  __pyx_r = __pyx_v_svtype;
  goto __pyx_L0;

  /* "vapor_vali/Simple_function.pyx":1392
 *     return seq
 * 
 * def sv_insert_point_define(pin):             # <<<<<<<<<<<<<<
 *     svtype=[0,0]
 *     for x in pin[7].split(';'):
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_7);
  __Pyx_AddTraceback("vapor_vali.Simple_function.sv_insert_point_define", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_svtype);
  __Pyx_XDECREF(__pyx_v_x);
  __Pyx_XDECREF(__pyx_v_sv_info);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "vapor_vali/Simple_function.pyx":1401
 *     return svtype
 * 
 * def take_off_symmetric_dots(list_dotdata):             # <<<<<<<<<<<<<<
 *     left_part=[list_dotdata[i] for i in range(len(list_dotdata)/2)]
 *     right_part=[list_dotdata[i][::-1] for i in [len(list_dotdata)-1-i for i in range(len(list_dotdata)/2)]]
 */

/* Python wrapper */
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_195take_off_symmetric_dots(PyObject *__pyx_self, PyObject *__pyx_v_list_dotdata); /*proto*/
static PyMethodDef __pyx_mdef_10vapor_vali_15Simple_function_195take_off_symmetric_dots = {"take_off_symmetric_dots", (PyCFunction)__pyx_pw_10vapor_vali_15Simple_function_195take_off_symmetric_dots, METH_O, 0};
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_195take_off_symmetric_dots(PyObject *__pyx_self, PyObject *__pyx_v_list_dotdata) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("take_off_symmetric_dots (wrapper)", 0);
  __pyx_r = __pyx_pf_10vapor_vali_15Simple_function_194take_off_symmetric_dots(__pyx_self, ((PyObject *)__pyx_v_list_dotdata));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10vapor_vali_15Simple_function_194take_off_symmetric_dots(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_list_dotdata) {
  PyObject *__pyx_v_left_part = NULL;
  PyObject *__pyx_v_right_part = NULL;
  PyObject *__pyx_v_left_new = NULL;
  PyObject *__pyx_v_right_new = NULL;
  PyObject *__pyx_v_sym_dots = NULL;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_v_j = NULL;
  PyObject *__pyx_v_out_dots = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  Py_ssize_t __pyx_t_2;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  PyObject *(*__pyx_t_5)(PyObject *);
  PyObject *__pyx_t_6 = NULL;
  Py_ssize_t __pyx_t_7;
  PyObject *__pyx_t_8 = NULL;
  PyObject *__pyx_t_9 = NULL;
  int __pyx_t_10;
  int __pyx_t_11;
  int __pyx_t_12;
  __Pyx_RefNannySetupContext("take_off_symmetric_dots", 0);

  /* "vapor_vali/Simple_function.pyx":1402
 * 
 * def take_off_symmetric_dots(list_dotdata):
 *     left_part=[list_dotdata[i] for i in range(len(list_dotdata)/2)]             # <<<<<<<<<<<<<<
 *     right_part=[list_dotdata[i][::-1] for i in [len(list_dotdata)-1-i for i in range(len(list_dotdata)/2)]]
 *     left_new=[i for i in left_part if eu_dis_single_dot(i)>0.15]
 */
  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1402, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = PyObject_Length(__pyx_v_list_dotdata); if (unlikely(__pyx_t_2 == -1)) __PYX_ERR(0, 1402, __pyx_L1_error)
  __pyx_t_3 = PyInt_FromSsize_t(__Pyx_div_Py_ssize_t(__pyx_t_2, 2)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1402, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1402, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_GIVEREF(__pyx_t_3);
  PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_t_4, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1402, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  if (likely(PyList_CheckExact(__pyx_t_3)) || PyTuple_CheckExact(__pyx_t_3)) {
    __pyx_t_4 = __pyx_t_3; __Pyx_INCREF(__pyx_t_4); __pyx_t_2 = 0;
    __pyx_t_5 = NULL;
  } else {
    __pyx_t_2 = -1; __pyx_t_4 = PyObject_GetIter(__pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1402, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_5 = Py_TYPE(__pyx_t_4)->tp_iternext; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1402, __pyx_L1_error)
  }
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  for (;;) {
    if (likely(!__pyx_t_5)) {
      if (likely(PyList_CheckExact(__pyx_t_4))) {
        if (__pyx_t_2 >= PyList_GET_SIZE(__pyx_t_4)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_3 = PyList_GET_ITEM(__pyx_t_4, __pyx_t_2); __Pyx_INCREF(__pyx_t_3); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 1402, __pyx_L1_error)
        #else
        __pyx_t_3 = PySequence_ITEM(__pyx_t_4, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1402, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_3);
        #endif
      } else {
        if (__pyx_t_2 >= PyTuple_GET_SIZE(__pyx_t_4)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_3 = PyTuple_GET_ITEM(__pyx_t_4, __pyx_t_2); __Pyx_INCREF(__pyx_t_3); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 1402, __pyx_L1_error)
        #else
        __pyx_t_3 = PySequence_ITEM(__pyx_t_4, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1402, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_3);
        #endif
      }
    } else {
      __pyx_t_3 = __pyx_t_5(__pyx_t_4);
      if (unlikely(!__pyx_t_3)) {
        PyObject* exc_type = PyErr_Occurred();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
          else __PYX_ERR(0, 1402, __pyx_L1_error)
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_3);
    }
    __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_3);
    __pyx_t_3 = 0;
    __pyx_t_3 = PyObject_GetItem(__pyx_v_list_dotdata, __pyx_v_i); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1402, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    if (unlikely(__Pyx_ListComp_Append(__pyx_t_1, (PyObject*)__pyx_t_3))) __PYX_ERR(0, 1402, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  }
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_left_part = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":1403
 * def take_off_symmetric_dots(list_dotdata):
 *     left_part=[list_dotdata[i] for i in range(len(list_dotdata)/2)]
 *     right_part=[list_dotdata[i][::-1] for i in [len(list_dotdata)-1-i for i in range(len(list_dotdata)/2)]]             # <<<<<<<<<<<<<<
 *     left_new=[i for i in left_part if eu_dis_single_dot(i)>0.15]
 *     right_new=[i for i in right_part if eu_dis_single_dot(i)>0.15]
 */
  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1403, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_4 = PyList_New(0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1403, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_2 = PyObject_Length(__pyx_v_list_dotdata); if (unlikely(__pyx_t_2 == -1)) __PYX_ERR(0, 1403, __pyx_L1_error)
  __pyx_t_3 = PyInt_FromSsize_t(__Pyx_div_Py_ssize_t(__pyx_t_2, 2)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1403, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_6 = PyTuple_New(1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1403, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_GIVEREF(__pyx_t_3);
  PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_t_6, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1403, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  if (likely(PyList_CheckExact(__pyx_t_3)) || PyTuple_CheckExact(__pyx_t_3)) {
    __pyx_t_6 = __pyx_t_3; __Pyx_INCREF(__pyx_t_6); __pyx_t_2 = 0;
    __pyx_t_5 = NULL;
  } else {
    __pyx_t_2 = -1; __pyx_t_6 = PyObject_GetIter(__pyx_t_3); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1403, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __pyx_t_5 = Py_TYPE(__pyx_t_6)->tp_iternext; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1403, __pyx_L1_error)
  }
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  for (;;) {
    if (likely(!__pyx_t_5)) {
      if (likely(PyList_CheckExact(__pyx_t_6))) {
        if (__pyx_t_2 >= PyList_GET_SIZE(__pyx_t_6)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_3 = PyList_GET_ITEM(__pyx_t_6, __pyx_t_2); __Pyx_INCREF(__pyx_t_3); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 1403, __pyx_L1_error)
        #else
        __pyx_t_3 = PySequence_ITEM(__pyx_t_6, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1403, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_3);
        #endif
      } else {
        if (__pyx_t_2 >= PyTuple_GET_SIZE(__pyx_t_6)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_3 = PyTuple_GET_ITEM(__pyx_t_6, __pyx_t_2); __Pyx_INCREF(__pyx_t_3); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 1403, __pyx_L1_error)
        #else
        __pyx_t_3 = PySequence_ITEM(__pyx_t_6, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1403, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_3);
        #endif
      }
    } else {
      __pyx_t_3 = __pyx_t_5(__pyx_t_6);
      if (unlikely(!__pyx_t_3)) {
        PyObject* exc_type = PyErr_Occurred();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
          else __PYX_ERR(0, 1403, __pyx_L1_error)
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_3);
    }
    __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_3);
    __pyx_t_3 = 0;
    __pyx_t_7 = PyObject_Length(__pyx_v_list_dotdata); if (unlikely(__pyx_t_7 == -1)) __PYX_ERR(0, 1403, __pyx_L1_error)
    __pyx_t_3 = PyInt_FromSsize_t((__pyx_t_7 - 1)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1403, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_8 = PyNumber_Subtract(__pyx_t_3, __pyx_v_i); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1403, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_8);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(__Pyx_ListComp_Append(__pyx_t_4, (PyObject*)__pyx_t_8))) __PYX_ERR(0, 1403, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
  }
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = __pyx_t_4; __Pyx_INCREF(__pyx_t_6); __pyx_t_2 = 0;
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  for (;;) {
    if (__pyx_t_2 >= PyList_GET_SIZE(__pyx_t_6)) break;
    #if CYTHON_COMPILING_IN_CPYTHON
    __pyx_t_4 = PyList_GET_ITEM(__pyx_t_6, __pyx_t_2); __Pyx_INCREF(__pyx_t_4); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 1403, __pyx_L1_error)
    #else
    __pyx_t_4 = PySequence_ITEM(__pyx_t_6, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1403, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    #endif
    __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_4);
    __pyx_t_4 = 0;
    __pyx_t_4 = PyObject_GetItem(__pyx_v_list_dotdata, __pyx_v_i); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1403, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_8 = PyObject_GetItem(__pyx_t_4, __pyx_slice__113); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1403, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_8);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    if (unlikely(__Pyx_ListComp_Append(__pyx_t_1, (PyObject*)__pyx_t_8))) __PYX_ERR(0, 1403, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
  }
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_v_right_part = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":1404
 *     left_part=[list_dotdata[i] for i in range(len(list_dotdata)/2)]
 *     right_part=[list_dotdata[i][::-1] for i in [len(list_dotdata)-1-i for i in range(len(list_dotdata)/2)]]
 *     left_new=[i for i in left_part if eu_dis_single_dot(i)>0.15]             # <<<<<<<<<<<<<<
 *     right_new=[i for i in right_part if eu_dis_single_dot(i)>0.15]
 *     sym_dots=[]
 */
  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1404, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_6 = __pyx_v_left_part; __Pyx_INCREF(__pyx_t_6); __pyx_t_2 = 0;
  for (;;) {
    if (__pyx_t_2 >= PyList_GET_SIZE(__pyx_t_6)) break;
    #if CYTHON_COMPILING_IN_CPYTHON
    __pyx_t_8 = PyList_GET_ITEM(__pyx_t_6, __pyx_t_2); __Pyx_INCREF(__pyx_t_8); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 1404, __pyx_L1_error)
    #else
    __pyx_t_8 = PySequence_ITEM(__pyx_t_6, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1404, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_8);
    #endif
    __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_8);
    __pyx_t_8 = 0;
    __pyx_t_4 = __Pyx_GetModuleGlobalName(__pyx_n_s_eu_dis_single_dot); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1404, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_3 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_4))) {
      __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_4);
      if (likely(__pyx_t_3)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
        __Pyx_INCREF(__pyx_t_3);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_4, function);
      }
    }
    if (!__pyx_t_3) {
      __pyx_t_8 = __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_v_i); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1404, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_8);
    } else {
      __pyx_t_9 = PyTuple_New(1+1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1404, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_9);
      __Pyx_GIVEREF(__pyx_t_3); PyTuple_SET_ITEM(__pyx_t_9, 0, __pyx_t_3); __pyx_t_3 = NULL;
      __Pyx_INCREF(__pyx_v_i);
      __Pyx_GIVEREF(__pyx_v_i);
      PyTuple_SET_ITEM(__pyx_t_9, 0+1, __pyx_v_i);
      __pyx_t_8 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_9, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1404, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_8);
      __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
    }
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = PyObject_RichCompare(__pyx_t_8, __pyx_float_0_15, Py_GT); __Pyx_XGOTREF(__pyx_t_4); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1404, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
    __pyx_t_10 = __Pyx_PyObject_IsTrue(__pyx_t_4); if (unlikely(__pyx_t_10 < 0)) __PYX_ERR(0, 1404, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    if (__pyx_t_10) {
      if (unlikely(__Pyx_ListComp_Append(__pyx_t_1, (PyObject*)__pyx_v_i))) __PYX_ERR(0, 1404, __pyx_L1_error)
    }
  }
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_v_left_new = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":1405
 *     right_part=[list_dotdata[i][::-1] for i in [len(list_dotdata)-1-i for i in range(len(list_dotdata)/2)]]
 *     left_new=[i for i in left_part if eu_dis_single_dot(i)>0.15]
 *     right_new=[i for i in right_part if eu_dis_single_dot(i)>0.15]             # <<<<<<<<<<<<<<
 *     sym_dots=[]
 *     for i in left_new:
 */
  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1405, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_6 = __pyx_v_right_part; __Pyx_INCREF(__pyx_t_6); __pyx_t_2 = 0;
  for (;;) {
    if (__pyx_t_2 >= PyList_GET_SIZE(__pyx_t_6)) break;
    #if CYTHON_COMPILING_IN_CPYTHON
    __pyx_t_4 = PyList_GET_ITEM(__pyx_t_6, __pyx_t_2); __Pyx_INCREF(__pyx_t_4); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 1405, __pyx_L1_error)
    #else
    __pyx_t_4 = PySequence_ITEM(__pyx_t_6, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1405, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    #endif
    __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_4);
    __pyx_t_4 = 0;
    __pyx_t_8 = __Pyx_GetModuleGlobalName(__pyx_n_s_eu_dis_single_dot); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1405, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_8);
    __pyx_t_9 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_8))) {
      __pyx_t_9 = PyMethod_GET_SELF(__pyx_t_8);
      if (likely(__pyx_t_9)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_8);
        __Pyx_INCREF(__pyx_t_9);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_8, function);
      }
    }
    if (!__pyx_t_9) {
      __pyx_t_4 = __Pyx_PyObject_CallOneArg(__pyx_t_8, __pyx_v_i); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1405, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
    } else {
      __pyx_t_3 = PyTuple_New(1+1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1405, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __Pyx_GIVEREF(__pyx_t_9); PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_9); __pyx_t_9 = NULL;
      __Pyx_INCREF(__pyx_v_i);
      __Pyx_GIVEREF(__pyx_v_i);
      PyTuple_SET_ITEM(__pyx_t_3, 0+1, __pyx_v_i);
      __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_8, __pyx_t_3, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1405, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    }
    __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
    __pyx_t_8 = PyObject_RichCompare(__pyx_t_4, __pyx_float_0_15, Py_GT); __Pyx_XGOTREF(__pyx_t_8); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1405, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_10 = __Pyx_PyObject_IsTrue(__pyx_t_8); if (unlikely(__pyx_t_10 < 0)) __PYX_ERR(0, 1405, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
    if (__pyx_t_10) {
      if (unlikely(__Pyx_ListComp_Append(__pyx_t_1, (PyObject*)__pyx_v_i))) __PYX_ERR(0, 1405, __pyx_L1_error)
    }
  }
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_v_right_new = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":1406
 *     left_new=[i for i in left_part if eu_dis_single_dot(i)>0.15]
 *     right_new=[i for i in right_part if eu_dis_single_dot(i)>0.15]
 *     sym_dots=[]             # <<<<<<<<<<<<<<
 *     for i in left_new:
 *         for j in right_new:
 */
  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1406, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_sym_dots = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":1407
 *     right_new=[i for i in right_part if eu_dis_single_dot(i)>0.15]
 *     sym_dots=[]
 *     for i in left_new:             # <<<<<<<<<<<<<<
 *         for j in right_new:
 *             if abs(i[0]-j[0])<6 and abs(i[1]-j[1])<6:
 */
  __pyx_t_1 = __pyx_v_left_new; __Pyx_INCREF(__pyx_t_1); __pyx_t_2 = 0;
  for (;;) {
    if (__pyx_t_2 >= PyList_GET_SIZE(__pyx_t_1)) break;
    #if CYTHON_COMPILING_IN_CPYTHON
    __pyx_t_6 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_6); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 1407, __pyx_L1_error)
    #else
    __pyx_t_6 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1407, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    #endif
    __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_6);
    __pyx_t_6 = 0;

    /* "vapor_vali/Simple_function.pyx":1408
 *     sym_dots=[]
 *     for i in left_new:
 *         for j in right_new:             # <<<<<<<<<<<<<<
 *             if abs(i[0]-j[0])<6 and abs(i[1]-j[1])<6:
 *                 sym_dots.append(i)
 */
    __pyx_t_6 = __pyx_v_right_new; __Pyx_INCREF(__pyx_t_6); __pyx_t_7 = 0;
    for (;;) {
      if (__pyx_t_7 >= PyList_GET_SIZE(__pyx_t_6)) break;
      #if CYTHON_COMPILING_IN_CPYTHON
      __pyx_t_8 = PyList_GET_ITEM(__pyx_t_6, __pyx_t_7); __Pyx_INCREF(__pyx_t_8); __pyx_t_7++; if (unlikely(0 < 0)) __PYX_ERR(0, 1408, __pyx_L1_error)
      #else
      __pyx_t_8 = PySequence_ITEM(__pyx_t_6, __pyx_t_7); __pyx_t_7++; if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1408, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_8);
      #endif
      __Pyx_XDECREF_SET(__pyx_v_j, __pyx_t_8);
      __pyx_t_8 = 0;

      /* "vapor_vali/Simple_function.pyx":1409
 *     for i in left_new:
 *         for j in right_new:
 *             if abs(i[0]-j[0])<6 and abs(i[1]-j[1])<6:             # <<<<<<<<<<<<<<
 *                 sym_dots.append(i)
 *                 sym_dots.append(j[::-1])
 */
      __pyx_t_8 = __Pyx_GetItemInt(__pyx_v_i, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1409, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_8);
      __pyx_t_4 = __Pyx_GetItemInt(__pyx_v_j, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1409, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_t_3 = PyNumber_Subtract(__pyx_t_8, __pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1409, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_4 = PyNumber_Absolute(__pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1409, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_3 = PyObject_RichCompare(__pyx_t_4, __pyx_int_6, Py_LT); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1409, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_11 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_11 < 0)) __PYX_ERR(0, 1409, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      if (__pyx_t_11) {
      } else {
        __pyx_t_10 = __pyx_t_11;
        goto __pyx_L20_bool_binop_done;
      }
      __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_i, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1409, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __pyx_t_4 = __Pyx_GetItemInt(__pyx_v_j, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1409, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_t_8 = PyNumber_Subtract(__pyx_t_3, __pyx_t_4); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1409, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_8);
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_4 = PyNumber_Absolute(__pyx_t_8); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1409, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
      __pyx_t_8 = PyObject_RichCompare(__pyx_t_4, __pyx_int_6, Py_LT); __Pyx_XGOTREF(__pyx_t_8); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1409, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_11 = __Pyx_PyObject_IsTrue(__pyx_t_8); if (unlikely(__pyx_t_11 < 0)) __PYX_ERR(0, 1409, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
      __pyx_t_10 = __pyx_t_11;
      __pyx_L20_bool_binop_done:;
      if (__pyx_t_10) {

        /* "vapor_vali/Simple_function.pyx":1410
 *         for j in right_new:
 *             if abs(i[0]-j[0])<6 and abs(i[1]-j[1])<6:
 *                 sym_dots.append(i)             # <<<<<<<<<<<<<<
 *                 sym_dots.append(j[::-1])
 *     out_dots=[i for i in list_dotdata if not i in sym_dots]
 */
        __pyx_t_12 = __Pyx_PyList_Append(__pyx_v_sym_dots, __pyx_v_i); if (unlikely(__pyx_t_12 == -1)) __PYX_ERR(0, 1410, __pyx_L1_error)

        /* "vapor_vali/Simple_function.pyx":1411
 *             if abs(i[0]-j[0])<6 and abs(i[1]-j[1])<6:
 *                 sym_dots.append(i)
 *                 sym_dots.append(j[::-1])             # <<<<<<<<<<<<<<
 *     out_dots=[i for i in list_dotdata if not i in sym_dots]
 *     return out_dots
 */
        __pyx_t_8 = PyObject_GetItem(__pyx_v_j, __pyx_slice__114); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1411, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_8);
        __pyx_t_12 = __Pyx_PyList_Append(__pyx_v_sym_dots, __pyx_t_8); if (unlikely(__pyx_t_12 == -1)) __PYX_ERR(0, 1411, __pyx_L1_error)
        __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;

        /* "vapor_vali/Simple_function.pyx":1409
 *     for i in left_new:
 *         for j in right_new:
 *             if abs(i[0]-j[0])<6 and abs(i[1]-j[1])<6:             # <<<<<<<<<<<<<<
 *                 sym_dots.append(i)
 *                 sym_dots.append(j[::-1])
 */
      }

      /* "vapor_vali/Simple_function.pyx":1408
 *     sym_dots=[]
 *     for i in left_new:
 *         for j in right_new:             # <<<<<<<<<<<<<<
 *             if abs(i[0]-j[0])<6 and abs(i[1]-j[1])<6:
 *                 sym_dots.append(i)
 */
    }
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

    /* "vapor_vali/Simple_function.pyx":1407
 *     right_new=[i for i in right_part if eu_dis_single_dot(i)>0.15]
 *     sym_dots=[]
 *     for i in left_new:             # <<<<<<<<<<<<<<
 *         for j in right_new:
 *             if abs(i[0]-j[0])<6 and abs(i[1]-j[1])<6:
 */
  }
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":1412
 *                 sym_dots.append(i)
 *                 sym_dots.append(j[::-1])
 *     out_dots=[i for i in list_dotdata if not i in sym_dots]             # <<<<<<<<<<<<<<
 *     return out_dots
 * 
 */
  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1412, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  if (likely(PyList_CheckExact(__pyx_v_list_dotdata)) || PyTuple_CheckExact(__pyx_v_list_dotdata)) {
    __pyx_t_6 = __pyx_v_list_dotdata; __Pyx_INCREF(__pyx_t_6); __pyx_t_2 = 0;
    __pyx_t_5 = NULL;
  } else {
    __pyx_t_2 = -1; __pyx_t_6 = PyObject_GetIter(__pyx_v_list_dotdata); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1412, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __pyx_t_5 = Py_TYPE(__pyx_t_6)->tp_iternext; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1412, __pyx_L1_error)
  }
  for (;;) {
    if (likely(!__pyx_t_5)) {
      if (likely(PyList_CheckExact(__pyx_t_6))) {
        if (__pyx_t_2 >= PyList_GET_SIZE(__pyx_t_6)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_8 = PyList_GET_ITEM(__pyx_t_6, __pyx_t_2); __Pyx_INCREF(__pyx_t_8); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 1412, __pyx_L1_error)
        #else
        __pyx_t_8 = PySequence_ITEM(__pyx_t_6, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1412, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_8);
        #endif
      } else {
        if (__pyx_t_2 >= PyTuple_GET_SIZE(__pyx_t_6)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_8 = PyTuple_GET_ITEM(__pyx_t_6, __pyx_t_2); __Pyx_INCREF(__pyx_t_8); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 1412, __pyx_L1_error)
        #else
        __pyx_t_8 = PySequence_ITEM(__pyx_t_6, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1412, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_8);
        #endif
      }
    } else {
      __pyx_t_8 = __pyx_t_5(__pyx_t_6);
      if (unlikely(!__pyx_t_8)) {
        PyObject* exc_type = PyErr_Occurred();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
          else __PYX_ERR(0, 1412, __pyx_L1_error)
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_8);
    }
    __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_8);
    __pyx_t_8 = 0;
    __pyx_t_10 = (__Pyx_PySequence_ContainsTF(__pyx_v_i, __pyx_v_sym_dots, Py_NE)); if (unlikely(__pyx_t_10 < 0)) __PYX_ERR(0, 1412, __pyx_L1_error)
    __pyx_t_11 = (__pyx_t_10 != 0);
    if (__pyx_t_11) {
      if (unlikely(__Pyx_ListComp_Append(__pyx_t_1, (PyObject*)__pyx_v_i))) __PYX_ERR(0, 1412, __pyx_L1_error)
    }
  }
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_v_out_dots = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":1413
 *                 sym_dots.append(j[::-1])
 *     out_dots=[i for i in list_dotdata if not i in sym_dots]
 *     return out_dots             # <<<<<<<<<<<<<<
 * 
 * def two_dimention_cluster_by_gap(dim1,dim2,gap,length):
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_out_dots);
  __pyx_r = __pyx_v_out_dots;
  goto __pyx_L0;

  /* "vapor_vali/Simple_function.pyx":1401
 *     return svtype
 * 
 * def take_off_symmetric_dots(list_dotdata):             # <<<<<<<<<<<<<<
 *     left_part=[list_dotdata[i] for i in range(len(list_dotdata)/2)]
 *     right_part=[list_dotdata[i][::-1] for i in [len(list_dotdata)-1-i for i in range(len(list_dotdata)/2)]]
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_XDECREF(__pyx_t_8);
  __Pyx_XDECREF(__pyx_t_9);
  __Pyx_AddTraceback("vapor_vali.Simple_function.take_off_symmetric_dots", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_left_part);
  __Pyx_XDECREF(__pyx_v_right_part);
  __Pyx_XDECREF(__pyx_v_left_new);
  __Pyx_XDECREF(__pyx_v_right_new);
  __Pyx_XDECREF(__pyx_v_sym_dots);
  __Pyx_XDECREF(__pyx_v_i);
  __Pyx_XDECREF(__pyx_v_j);
  __Pyx_XDECREF(__pyx_v_out_dots);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "vapor_vali/Simple_function.pyx":1415
 *     return out_dots
 * 
 * def two_dimention_cluster_by_gap(dim1,dim2,gap,length):             # <<<<<<<<<<<<<<
 *     ####dim1 and dim2 are both one-dimention data list,of the same length;
 *     ####dots with distance >gap on any dimention would be clustered into different group
 */

/* Python wrapper */
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_197two_dimention_cluster_by_gap(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_10vapor_vali_15Simple_function_197two_dimention_cluster_by_gap = {"two_dimention_cluster_by_gap", (PyCFunction)__pyx_pw_10vapor_vali_15Simple_function_197two_dimention_cluster_by_gap, METH_VARARGS|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_197two_dimention_cluster_by_gap(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_dim1 = 0;
  PyObject *__pyx_v_dim2 = 0;
  PyObject *__pyx_v_gap = 0;
  PyObject *__pyx_v_length = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("two_dimention_cluster_by_gap (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_dim1,&__pyx_n_s_dim2,&__pyx_n_s_gap,&__pyx_n_s_length,0};
    PyObject* values[4] = {0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
      switch (pos_args) {
        case  4: values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
        case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_dim1)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_dim2)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("two_dimention_cluster_by_gap", 1, 4, 4, 1); __PYX_ERR(0, 1415, __pyx_L3_error)
        }
        case  2:
        if (likely((values[2] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_gap)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("two_dimention_cluster_by_gap", 1, 4, 4, 2); __PYX_ERR(0, 1415, __pyx_L3_error)
        }
        case  3:
        if (likely((values[3] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_length)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("two_dimention_cluster_by_gap", 1, 4, 4, 3); __PYX_ERR(0, 1415, __pyx_L3_error)
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "two_dimention_cluster_by_gap") < 0)) __PYX_ERR(0, 1415, __pyx_L3_error)
      }
    } else if (PyTuple_GET_SIZE(__pyx_args) != 4) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
      values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
    }
    __pyx_v_dim1 = values[0];
    __pyx_v_dim2 = values[1];
    __pyx_v_gap = values[2];
    __pyx_v_length = values[3];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("two_dimention_cluster_by_gap", 1, 4, 4, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1415, __pyx_L3_error)
  __pyx_L3_error:;
  __Pyx_AddTraceback("vapor_vali.Simple_function.two_dimention_cluster_by_gap", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_10vapor_vali_15Simple_function_196two_dimention_cluster_by_gap(__pyx_self, __pyx_v_dim1, __pyx_v_dim2, __pyx_v_gap, __pyx_v_length);

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10vapor_vali_15Simple_function_196two_dimention_cluster_by_gap(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_dim1, PyObject *__pyx_v_dim2, PyObject *__pyx_v_gap, PyObject *__pyx_v_length) {
  PyObject *__pyx_v_clu_1 = NULL;
  PyObject *__pyx_v_clu_2_sub = NULL;
  PyObject *__pyx_v_out = NULL;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_v_j = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  Py_ssize_t __pyx_t_4;
  PyObject *__pyx_t_5 = NULL;
  PyObject *(*__pyx_t_6)(PyObject *);
  Py_ssize_t __pyx_t_7;
  PyObject *(*__pyx_t_8)(PyObject *);
  PyObject *__pyx_t_9 = NULL;
  __Pyx_RefNannySetupContext("two_dimention_cluster_by_gap", 0);

  /* "vapor_vali/Simple_function.pyx":1419
 *     ####dots with distance >gap on any dimention would be clustered into different group
 *     ####return position of each dots in each subcluster
 *     clu_1=one_dimention_cluster_by_gap(dim1,gap,length)             # <<<<<<<<<<<<<<
 *     clu_2_sub=[[dim2[i] for i in j] for j in clu_1]
 *     out=[]
 */
  __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_one_dimention_cluster_by_gap); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1419, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = NULL;
  __pyx_t_4 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_3);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_2, function);
      __pyx_t_4 = 1;
    }
  }
  __pyx_t_5 = PyTuple_New(3+__pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1419, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  if (__pyx_t_3) {
    __Pyx_GIVEREF(__pyx_t_3); PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_3); __pyx_t_3 = NULL;
  }
  __Pyx_INCREF(__pyx_v_dim1);
  __Pyx_GIVEREF(__pyx_v_dim1);
  PyTuple_SET_ITEM(__pyx_t_5, 0+__pyx_t_4, __pyx_v_dim1);
  __Pyx_INCREF(__pyx_v_gap);
  __Pyx_GIVEREF(__pyx_v_gap);
  PyTuple_SET_ITEM(__pyx_t_5, 1+__pyx_t_4, __pyx_v_gap);
  __Pyx_INCREF(__pyx_v_length);
  __Pyx_GIVEREF(__pyx_v_length);
  PyTuple_SET_ITEM(__pyx_t_5, 2+__pyx_t_4, __pyx_v_length);
  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_5, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1419, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_clu_1 = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":1420
 *     ####return position of each dots in each subcluster
 *     clu_1=one_dimention_cluster_by_gap(dim1,gap,length)
 *     clu_2_sub=[[dim2[i] for i in j] for j in clu_1]             # <<<<<<<<<<<<<<
 *     out=[]
 *     for i in clu_2_sub:
 */
  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1420, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  if (likely(PyList_CheckExact(__pyx_v_clu_1)) || PyTuple_CheckExact(__pyx_v_clu_1)) {
    __pyx_t_2 = __pyx_v_clu_1; __Pyx_INCREF(__pyx_t_2); __pyx_t_4 = 0;
    __pyx_t_6 = NULL;
  } else {
    __pyx_t_4 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_v_clu_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1420, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_6 = Py_TYPE(__pyx_t_2)->tp_iternext; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1420, __pyx_L1_error)
  }
  for (;;) {
    if (likely(!__pyx_t_6)) {
      if (likely(PyList_CheckExact(__pyx_t_2))) {
        if (__pyx_t_4 >= PyList_GET_SIZE(__pyx_t_2)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_5 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_4); __Pyx_INCREF(__pyx_t_5); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 1420, __pyx_L1_error)
        #else
        __pyx_t_5 = PySequence_ITEM(__pyx_t_2, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1420, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_5);
        #endif
      } else {
        if (__pyx_t_4 >= PyTuple_GET_SIZE(__pyx_t_2)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_5 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_4); __Pyx_INCREF(__pyx_t_5); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 1420, __pyx_L1_error)
        #else
        __pyx_t_5 = PySequence_ITEM(__pyx_t_2, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1420, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_5);
        #endif
      }
    } else {
      __pyx_t_5 = __pyx_t_6(__pyx_t_2);
      if (unlikely(!__pyx_t_5)) {
        PyObject* exc_type = PyErr_Occurred();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
          else __PYX_ERR(0, 1420, __pyx_L1_error)
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_5);
    }
    __Pyx_XDECREF_SET(__pyx_v_j, __pyx_t_5);
    __pyx_t_5 = 0;
    __pyx_t_5 = PyList_New(0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1420, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    if (likely(PyList_CheckExact(__pyx_v_j)) || PyTuple_CheckExact(__pyx_v_j)) {
      __pyx_t_3 = __pyx_v_j; __Pyx_INCREF(__pyx_t_3); __pyx_t_7 = 0;
      __pyx_t_8 = NULL;
    } else {
      __pyx_t_7 = -1; __pyx_t_3 = PyObject_GetIter(__pyx_v_j); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1420, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __pyx_t_8 = Py_TYPE(__pyx_t_3)->tp_iternext; if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1420, __pyx_L1_error)
    }
    for (;;) {
      if (likely(!__pyx_t_8)) {
        if (likely(PyList_CheckExact(__pyx_t_3))) {
          if (__pyx_t_7 >= PyList_GET_SIZE(__pyx_t_3)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_9 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_7); __Pyx_INCREF(__pyx_t_9); __pyx_t_7++; if (unlikely(0 < 0)) __PYX_ERR(0, 1420, __pyx_L1_error)
          #else
          __pyx_t_9 = PySequence_ITEM(__pyx_t_3, __pyx_t_7); __pyx_t_7++; if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1420, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_9);
          #endif
        } else {
          if (__pyx_t_7 >= PyTuple_GET_SIZE(__pyx_t_3)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_9 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_7); __Pyx_INCREF(__pyx_t_9); __pyx_t_7++; if (unlikely(0 < 0)) __PYX_ERR(0, 1420, __pyx_L1_error)
          #else
          __pyx_t_9 = PySequence_ITEM(__pyx_t_3, __pyx_t_7); __pyx_t_7++; if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1420, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_9);
          #endif
        }
      } else {
        __pyx_t_9 = __pyx_t_8(__pyx_t_3);
        if (unlikely(!__pyx_t_9)) {
          PyObject* exc_type = PyErr_Occurred();
          if (exc_type) {
            if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
            else __PYX_ERR(0, 1420, __pyx_L1_error)
          }
          break;
        }
        __Pyx_GOTREF(__pyx_t_9);
      }
      __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_9);
      __pyx_t_9 = 0;
      __pyx_t_9 = PyObject_GetItem(__pyx_v_dim2, __pyx_v_i); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1420, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_9);
      if (unlikely(__Pyx_ListComp_Append(__pyx_t_5, (PyObject*)__pyx_t_9))) __PYX_ERR(0, 1420, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
    }
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(__Pyx_ListComp_Append(__pyx_t_1, (PyObject*)__pyx_t_5))) __PYX_ERR(0, 1420, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  }
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_clu_2_sub = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":1421
 *     clu_1=one_dimention_cluster_by_gap(dim1,gap,length)
 *     clu_2_sub=[[dim2[i] for i in j] for j in clu_1]
 *     out=[]             # <<<<<<<<<<<<<<
 *     for i in clu_2_sub:
 *         out+=one_dimention_cluster_by_gap(i,gap,length)
 */
  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1421, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_out = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":1422
 *     clu_2_sub=[[dim2[i] for i in j] for j in clu_1]
 *     out=[]
 *     for i in clu_2_sub:             # <<<<<<<<<<<<<<
 *         out+=one_dimention_cluster_by_gap(i,gap,length)
 *     return out
 */
  __pyx_t_1 = __pyx_v_clu_2_sub; __Pyx_INCREF(__pyx_t_1); __pyx_t_4 = 0;
  for (;;) {
    if (__pyx_t_4 >= PyList_GET_SIZE(__pyx_t_1)) break;
    #if CYTHON_COMPILING_IN_CPYTHON
    __pyx_t_2 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_4); __Pyx_INCREF(__pyx_t_2); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 1422, __pyx_L1_error)
    #else
    __pyx_t_2 = PySequence_ITEM(__pyx_t_1, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1422, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    #endif
    __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_2);
    __pyx_t_2 = 0;

    /* "vapor_vali/Simple_function.pyx":1423
 *     out=[]
 *     for i in clu_2_sub:
 *         out+=one_dimention_cluster_by_gap(i,gap,length)             # <<<<<<<<<<<<<<
 *     return out
 * 
 */
    __pyx_t_5 = __Pyx_GetModuleGlobalName(__pyx_n_s_one_dimention_cluster_by_gap); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1423, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __pyx_t_3 = NULL;
    __pyx_t_7 = 0;
    if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_5))) {
      __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_5);
      if (likely(__pyx_t_3)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
        __Pyx_INCREF(__pyx_t_3);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_5, function);
        __pyx_t_7 = 1;
      }
    }
    __pyx_t_9 = PyTuple_New(3+__pyx_t_7); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1423, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_9);
    if (__pyx_t_3) {
      __Pyx_GIVEREF(__pyx_t_3); PyTuple_SET_ITEM(__pyx_t_9, 0, __pyx_t_3); __pyx_t_3 = NULL;
    }
    __Pyx_INCREF(__pyx_v_i);
    __Pyx_GIVEREF(__pyx_v_i);
    PyTuple_SET_ITEM(__pyx_t_9, 0+__pyx_t_7, __pyx_v_i);
    __Pyx_INCREF(__pyx_v_gap);
    __Pyx_GIVEREF(__pyx_v_gap);
    PyTuple_SET_ITEM(__pyx_t_9, 1+__pyx_t_7, __pyx_v_gap);
    __Pyx_INCREF(__pyx_v_length);
    __Pyx_GIVEREF(__pyx_v_length);
    PyTuple_SET_ITEM(__pyx_t_9, 2+__pyx_t_7, __pyx_v_length);
    __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_9, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1423, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = PyNumber_InPlaceAdd(__pyx_v_out, __pyx_t_2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1423, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __Pyx_DECREF_SET(__pyx_v_out, __pyx_t_5);
    __pyx_t_5 = 0;

    /* "vapor_vali/Simple_function.pyx":1422
 *     clu_2_sub=[[dim2[i] for i in j] for j in clu_1]
 *     out=[]
 *     for i in clu_2_sub:             # <<<<<<<<<<<<<<
 *         out+=one_dimention_cluster_by_gap(i,gap,length)
 *     return out
 */
  }
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":1424
 *     for i in clu_2_sub:
 *         out+=one_dimention_cluster_by_gap(i,gap,length)
 *     return out             # <<<<<<<<<<<<<<
 * 
 * def unify_list(list):
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_out);
  __pyx_r = __pyx_v_out;
  goto __pyx_L0;

  /* "vapor_vali/Simple_function.pyx":1415
 *     return out_dots
 * 
 * def two_dimention_cluster_by_gap(dim1,dim2,gap,length):             # <<<<<<<<<<<<<<
 *     ####dim1 and dim2 are both one-dimention data list,of the same length;
 *     ####dots with distance >gap on any dimention would be clustered into different group
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_9);
  __Pyx_AddTraceback("vapor_vali.Simple_function.two_dimention_cluster_by_gap", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_clu_1);
  __Pyx_XDECREF(__pyx_v_clu_2_sub);
  __Pyx_XDECREF(__pyx_v_out);
  __Pyx_XDECREF(__pyx_v_i);
  __Pyx_XDECREF(__pyx_v_j);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "vapor_vali/Simple_function.pyx":1426
 *     return out
 * 
 * def unify_list(list):             # <<<<<<<<<<<<<<
 *     out=[]
 *     for x in list:
 */

/* Python wrapper */
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_199unify_list(PyObject *__pyx_self, PyObject *__pyx_v_list); /*proto*/
static PyMethodDef __pyx_mdef_10vapor_vali_15Simple_function_199unify_list = {"unify_list", (PyCFunction)__pyx_pw_10vapor_vali_15Simple_function_199unify_list, METH_O, 0};
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_199unify_list(PyObject *__pyx_self, PyObject *__pyx_v_list) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("unify_list (wrapper)", 0);
  __pyx_r = __pyx_pf_10vapor_vali_15Simple_function_198unify_list(__pyx_self, ((PyObject *)__pyx_v_list));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10vapor_vali_15Simple_function_198unify_list(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_list) {
  PyObject *__pyx_v_out = NULL;
  PyObject *__pyx_v_x = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  Py_ssize_t __pyx_t_2;
  PyObject *(*__pyx_t_3)(PyObject *);
  PyObject *__pyx_t_4 = NULL;
  int __pyx_t_5;
  int __pyx_t_6;
  int __pyx_t_7;
  __Pyx_RefNannySetupContext("unify_list", 0);

  /* "vapor_vali/Simple_function.pyx":1427
 * 
 * def unify_list(list):
 *     out=[]             # <<<<<<<<<<<<<<
 *     for x in list:
 *         if not x in out:
 */
  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1427, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_out = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":1428
 * def unify_list(list):
 *     out=[]
 *     for x in list:             # <<<<<<<<<<<<<<
 *         if not x in out:
 *             out.append(x)
 */
  if (likely(PyList_CheckExact(__pyx_v_list)) || PyTuple_CheckExact(__pyx_v_list)) {
    __pyx_t_1 = __pyx_v_list; __Pyx_INCREF(__pyx_t_1); __pyx_t_2 = 0;
    __pyx_t_3 = NULL;
  } else {
    __pyx_t_2 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_v_list); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1428, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_3 = Py_TYPE(__pyx_t_1)->tp_iternext; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1428, __pyx_L1_error)
  }
  for (;;) {
    if (likely(!__pyx_t_3)) {
      if (likely(PyList_CheckExact(__pyx_t_1))) {
        if (__pyx_t_2 >= PyList_GET_SIZE(__pyx_t_1)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_4 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_4); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 1428, __pyx_L1_error)
        #else
        __pyx_t_4 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1428, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_4);
        #endif
      } else {
        if (__pyx_t_2 >= PyTuple_GET_SIZE(__pyx_t_1)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_4 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_4); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 1428, __pyx_L1_error)
        #else
        __pyx_t_4 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1428, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_4);
        #endif
      }
    } else {
      __pyx_t_4 = __pyx_t_3(__pyx_t_1);
      if (unlikely(!__pyx_t_4)) {
        PyObject* exc_type = PyErr_Occurred();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
          else __PYX_ERR(0, 1428, __pyx_L1_error)
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_4);
    }
    __Pyx_XDECREF_SET(__pyx_v_x, __pyx_t_4);
    __pyx_t_4 = 0;

    /* "vapor_vali/Simple_function.pyx":1429
 *     out=[]
 *     for x in list:
 *         if not x in out:             # <<<<<<<<<<<<<<
 *             out.append(x)
 *     return out
 */
    __pyx_t_5 = (__Pyx_PySequence_ContainsTF(__pyx_v_x, __pyx_v_out, Py_NE)); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 1429, __pyx_L1_error)
    __pyx_t_6 = (__pyx_t_5 != 0);
    if (__pyx_t_6) {

      /* "vapor_vali/Simple_function.pyx":1430
 *     for x in list:
 *         if not x in out:
 *             out.append(x)             # <<<<<<<<<<<<<<
 *     return out
 * 
 */
      __pyx_t_7 = __Pyx_PyList_Append(__pyx_v_out, __pyx_v_x); if (unlikely(__pyx_t_7 == -1)) __PYX_ERR(0, 1430, __pyx_L1_error)

      /* "vapor_vali/Simple_function.pyx":1429
 *     out=[]
 *     for x in list:
 *         if not x in out:             # <<<<<<<<<<<<<<
 *             out.append(x)
 *     return out
 */
    }

    /* "vapor_vali/Simple_function.pyx":1428
 * def unify_list(list):
 *     out=[]
 *     for x in list:             # <<<<<<<<<<<<<<
 *         if not x in out:
 *             out.append(x)
 */
  }
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":1431
 *         if not x in out:
 *             out.append(x)
 *     return out             # <<<<<<<<<<<<<<
 * 
 * def vapor_CANNOT_CLASSIFY_VapoR(bam_in,ref,sv_info,out_figure_name):
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_out);
  __pyx_r = __pyx_v_out;
  goto __pyx_L0;

  /* "vapor_vali/Simple_function.pyx":1426
 *     return out
 * 
 * def unify_list(list):             # <<<<<<<<<<<<<<
 *     out=[]
 *     for x in list:
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_AddTraceback("vapor_vali.Simple_function.unify_list", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_out);
  __Pyx_XDECREF(__pyx_v_x);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "vapor_vali/Simple_function.pyx":1433
 *     return out
 * 
 * def vapor_CANNOT_CLASSIFY_VapoR(bam_in,ref,sv_info,out_figure_name):             # <<<<<<<<<<<<<<
 *     #eg of sv_info=['ab_ab', 'b_b^', 'chr7', '70955990', '70961199', '70973901']
 *     ref_sv=sv_info[0].split('_')
 */

/* Python wrapper */
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_201vapor_CANNOT_CLASSIFY_VapoR(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_10vapor_vali_15Simple_function_201vapor_CANNOT_CLASSIFY_VapoR = {"vapor_CANNOT_CLASSIFY_VapoR", (PyCFunction)__pyx_pw_10vapor_vali_15Simple_function_201vapor_CANNOT_CLASSIFY_VapoR, METH_VARARGS|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_201vapor_CANNOT_CLASSIFY_VapoR(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_bam_in = 0;
  PyObject *__pyx_v_ref = 0;
  PyObject *__pyx_v_sv_info = 0;
  PyObject *__pyx_v_out_figure_name = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("vapor_CANNOT_CLASSIFY_VapoR (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_bam_in,&__pyx_n_s_ref,&__pyx_n_s_sv_info,&__pyx_n_s_out_figure_name,0};
    PyObject* values[4] = {0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
      switch (pos_args) {
        case  4: values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
        case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_bam_in)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_ref)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("vapor_CANNOT_CLASSIFY_VapoR", 1, 4, 4, 1); __PYX_ERR(0, 1433, __pyx_L3_error)
        }
        case  2:
        if (likely((values[2] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_sv_info)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("vapor_CANNOT_CLASSIFY_VapoR", 1, 4, 4, 2); __PYX_ERR(0, 1433, __pyx_L3_error)
        }
        case  3:
        if (likely((values[3] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_out_figure_name)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("vapor_CANNOT_CLASSIFY_VapoR", 1, 4, 4, 3); __PYX_ERR(0, 1433, __pyx_L3_error)
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "vapor_CANNOT_CLASSIFY_VapoR") < 0)) __PYX_ERR(0, 1433, __pyx_L3_error)
      }
    } else if (PyTuple_GET_SIZE(__pyx_args) != 4) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
      values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
    }
    __pyx_v_bam_in = values[0];
    __pyx_v_ref = values[1];
    __pyx_v_sv_info = values[2];
    __pyx_v_out_figure_name = values[3];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("vapor_CANNOT_CLASSIFY_VapoR", 1, 4, 4, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1433, __pyx_L3_error)
  __pyx_L3_error:;
  __Pyx_AddTraceback("vapor_vali.Simple_function.vapor_CANNOT_CLASSIFY_VapoR", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_10vapor_vali_15Simple_function_200vapor_CANNOT_CLASSIFY_VapoR(__pyx_self, __pyx_v_bam_in, __pyx_v_ref, __pyx_v_sv_info, __pyx_v_out_figure_name);

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10vapor_vali_15Simple_function_200vapor_CANNOT_CLASSIFY_VapoR(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_bam_in, PyObject *__pyx_v_ref, PyObject *__pyx_v_sv_info, PyObject *__pyx_v_out_figure_name) {
  PyObject *__pyx_v_ref_sv = NULL;
  PyObject *__pyx_v_alt_sv = NULL;
  PyObject *__pyx_v_chromos = NULL;
  PyObject *__pyx_v_bp_info = NULL;
  PyObject *__pyx_v_flank_length = NULL;
  PyObject *__pyx_v_vapor_score_list = NULL;
  PyObject *__pyx_v_run_flag = NULL;
  PyObject *__pyx_v_ref_seq = NULL;
  PyObject *__pyx_v_window_size = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_window_size_qc = NULL;
  PyObject *__pyx_v_all_reads = NULL;
  PyObject *__pyx_v_bp_let_hash = NULL;
  PyObject *__pyx_v_bp_let_seq = NULL;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_v_alt_allele = NULL;
  PyObject *__pyx_v_alt_seq = NULL;
  PyObject *__pyx_v_best_read_rec = NULL;
  PyObject *__pyx_v_x = NULL;
  PyObject *__pyx_v_vapor_single_read_score = NULL;
  PyObject *__pyx_v_alt_juncs = NULL;
  PyObject *__pyx_v_alt_jun = NULL;
  PyObject *__pyx_v_ref_seq_a = NULL;
  PyObject *__pyx_v_ref_seq_b = NULL;
  PyObject *__pyx_v_all_reads_a = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  Py_ssize_t __pyx_t_6;
  PyObject *(*__pyx_t_7)(PyObject *);
  int __pyx_t_8;
  int __pyx_t_9;
  PyObject *__pyx_t_10 = NULL;
  PyObject *__pyx_t_11 = NULL;
  PyObject *(*__pyx_t_12)(PyObject *);
  Py_ssize_t __pyx_t_13;
  PyObject *__pyx_t_14 = NULL;
  PyObject *(*__pyx_t_15)(PyObject *);
  PyObject *__pyx_t_16 = NULL;
  Py_ssize_t __pyx_t_17;
  PyObject *(*__pyx_t_18)(PyObject *);
  double __pyx_t_19;
  double __pyx_t_20;
  int __pyx_t_21;
  PyObject *__pyx_t_22 = NULL;
  PyObject *__pyx_t_23 = NULL;
  PyObject *__pyx_t_24 = NULL;
  PyObject *__pyx_t_25 = NULL;
  Py_ssize_t __pyx_t_26;
  __Pyx_RefNannySetupContext("vapor_CANNOT_CLASSIFY_VapoR", 0);

  /* "vapor_vali/Simple_function.pyx":1435
 * def vapor_CANNOT_CLASSIFY_VapoR(bam_in,ref,sv_info,out_figure_name):
 *     #eg of sv_info=['ab_ab', 'b_b^', 'chr7', '70955990', '70961199', '70973901']
 *     ref_sv=sv_info[0].split('_')             # <<<<<<<<<<<<<<
 *     alt_sv=list_unify([i for i in sv_info[1].split('_') if not i in ref_sv])
 *     chromos=chromos_readin(ref)
 */
  __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_sv_info, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1435, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_split); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1435, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_tuple__116, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1435, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_ref_sv = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":1436
 *     #eg of sv_info=['ab_ab', 'b_b^', 'chr7', '70955990', '70961199', '70973901']
 *     ref_sv=sv_info[0].split('_')
 *     alt_sv=list_unify([i for i in sv_info[1].split('_') if not i in ref_sv])             # <<<<<<<<<<<<<<
 *     chromos=chromos_readin(ref)
 *     bp_info=block_subsplot(sv_info[2:],chromos)
 */
  __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_list_unify); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1436, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = PyList_New(0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1436, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_4 = __Pyx_GetItemInt(__pyx_v_sv_info, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1436, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_split); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1436, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_tuple__117, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1436, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  if (likely(PyList_CheckExact(__pyx_t_4)) || PyTuple_CheckExact(__pyx_t_4)) {
    __pyx_t_5 = __pyx_t_4; __Pyx_INCREF(__pyx_t_5); __pyx_t_6 = 0;
    __pyx_t_7 = NULL;
  } else {
    __pyx_t_6 = -1; __pyx_t_5 = PyObject_GetIter(__pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1436, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __pyx_t_7 = Py_TYPE(__pyx_t_5)->tp_iternext; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1436, __pyx_L1_error)
  }
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  for (;;) {
    if (likely(!__pyx_t_7)) {
      if (likely(PyList_CheckExact(__pyx_t_5))) {
        if (__pyx_t_6 >= PyList_GET_SIZE(__pyx_t_5)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_4 = PyList_GET_ITEM(__pyx_t_5, __pyx_t_6); __Pyx_INCREF(__pyx_t_4); __pyx_t_6++; if (unlikely(0 < 0)) __PYX_ERR(0, 1436, __pyx_L1_error)
        #else
        __pyx_t_4 = PySequence_ITEM(__pyx_t_5, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1436, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_4);
        #endif
      } else {
        if (__pyx_t_6 >= PyTuple_GET_SIZE(__pyx_t_5)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_4 = PyTuple_GET_ITEM(__pyx_t_5, __pyx_t_6); __Pyx_INCREF(__pyx_t_4); __pyx_t_6++; if (unlikely(0 < 0)) __PYX_ERR(0, 1436, __pyx_L1_error)
        #else
        __pyx_t_4 = PySequence_ITEM(__pyx_t_5, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1436, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_4);
        #endif
      }
    } else {
      __pyx_t_4 = __pyx_t_7(__pyx_t_5);
      if (unlikely(!__pyx_t_4)) {
        PyObject* exc_type = PyErr_Occurred();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
          else __PYX_ERR(0, 1436, __pyx_L1_error)
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_4);
    }
    __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_4);
    __pyx_t_4 = 0;
    __pyx_t_8 = (__Pyx_PySequence_ContainsTF(__pyx_v_i, __pyx_v_ref_sv, Py_NE)); if (unlikely(__pyx_t_8 < 0)) __PYX_ERR(0, 1436, __pyx_L1_error)
    __pyx_t_9 = (__pyx_t_8 != 0);
    if (__pyx_t_9) {
      if (unlikely(__Pyx_ListComp_Append(__pyx_t_3, (PyObject*)__pyx_v_i))) __PYX_ERR(0, 1436, __pyx_L1_error)
    }
  }
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_2);
    if (likely(__pyx_t_5)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_5);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_2, function);
    }
  }
  if (!__pyx_t_5) {
    __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1436, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __Pyx_GOTREF(__pyx_t_1);
  } else {
    __pyx_t_4 = PyTuple_New(1+1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1436, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_GIVEREF(__pyx_t_5); PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_5); __pyx_t_5 = NULL;
    __Pyx_GIVEREF(__pyx_t_3);
    PyTuple_SET_ITEM(__pyx_t_4, 0+1, __pyx_t_3);
    __pyx_t_3 = 0;
    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_4, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1436, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  }
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_alt_sv = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":1437
 *     ref_sv=sv_info[0].split('_')
 *     alt_sv=list_unify([i for i in sv_info[1].split('_') if not i in ref_sv])
 *     chromos=chromos_readin(ref)             # <<<<<<<<<<<<<<
 *     bp_info=block_subsplot(sv_info[2:],chromos)
 *     flank_length=max([flank_length_calculate(i) for i in bp_info])
 */
  __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_chromos_readin); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1437, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_4 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_2);
    if (likely(__pyx_t_4)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_4);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_2, function);
    }
  }
  if (!__pyx_t_4) {
    __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_v_ref); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1437, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
  } else {
    __pyx_t_3 = PyTuple_New(1+1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1437, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_GIVEREF(__pyx_t_4); PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_4); __pyx_t_4 = NULL;
    __Pyx_INCREF(__pyx_v_ref);
    __Pyx_GIVEREF(__pyx_v_ref);
    PyTuple_SET_ITEM(__pyx_t_3, 0+1, __pyx_v_ref);
    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_3, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1437, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  }
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_chromos = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":1438
 *     alt_sv=list_unify([i for i in sv_info[1].split('_') if not i in ref_sv])
 *     chromos=chromos_readin(ref)
 *     bp_info=block_subsplot(sv_info[2:],chromos)             # <<<<<<<<<<<<<<
 *     flank_length=max([flank_length_calculate(i) for i in bp_info])
 *     vapor_score_list=[]
 */
  __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_block_subsplot); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1438, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = __Pyx_PyObject_GetSlice(__pyx_v_sv_info, 2, 0, NULL, NULL, &__pyx_slice__118, 1, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1438, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_4 = NULL;
  __pyx_t_6 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_2);
    if (likely(__pyx_t_4)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_4);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_2, function);
      __pyx_t_6 = 1;
    }
  }
  __pyx_t_5 = PyTuple_New(2+__pyx_t_6); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1438, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  if (__pyx_t_4) {
    __Pyx_GIVEREF(__pyx_t_4); PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_4); __pyx_t_4 = NULL;
  }
  __Pyx_GIVEREF(__pyx_t_3);
  PyTuple_SET_ITEM(__pyx_t_5, 0+__pyx_t_6, __pyx_t_3);
  __Pyx_INCREF(__pyx_v_chromos);
  __Pyx_GIVEREF(__pyx_v_chromos);
  PyTuple_SET_ITEM(__pyx_t_5, 1+__pyx_t_6, __pyx_v_chromos);
  __pyx_t_3 = 0;
  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_5, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1438, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_bp_info = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":1439
 *     chromos=chromos_readin(ref)
 *     bp_info=block_subsplot(sv_info[2:],chromos)
 *     flank_length=max([flank_length_calculate(i) for i in bp_info])             # <<<<<<<<<<<<<<
 *     vapor_score_list=[]
 *     run_flag=0
 */
  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1439, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  if (likely(PyList_CheckExact(__pyx_v_bp_info)) || PyTuple_CheckExact(__pyx_v_bp_info)) {
    __pyx_t_2 = __pyx_v_bp_info; __Pyx_INCREF(__pyx_t_2); __pyx_t_6 = 0;
    __pyx_t_7 = NULL;
  } else {
    __pyx_t_6 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_v_bp_info); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1439, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_7 = Py_TYPE(__pyx_t_2)->tp_iternext; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1439, __pyx_L1_error)
  }
  for (;;) {
    if (likely(!__pyx_t_7)) {
      if (likely(PyList_CheckExact(__pyx_t_2))) {
        if (__pyx_t_6 >= PyList_GET_SIZE(__pyx_t_2)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_5 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_6); __Pyx_INCREF(__pyx_t_5); __pyx_t_6++; if (unlikely(0 < 0)) __PYX_ERR(0, 1439, __pyx_L1_error)
        #else
        __pyx_t_5 = PySequence_ITEM(__pyx_t_2, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1439, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_5);
        #endif
      } else {
        if (__pyx_t_6 >= PyTuple_GET_SIZE(__pyx_t_2)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_5 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_6); __Pyx_INCREF(__pyx_t_5); __pyx_t_6++; if (unlikely(0 < 0)) __PYX_ERR(0, 1439, __pyx_L1_error)
        #else
        __pyx_t_5 = PySequence_ITEM(__pyx_t_2, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1439, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_5);
        #endif
      }
    } else {
      __pyx_t_5 = __pyx_t_7(__pyx_t_2);
      if (unlikely(!__pyx_t_5)) {
        PyObject* exc_type = PyErr_Occurred();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
          else __PYX_ERR(0, 1439, __pyx_L1_error)
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_5);
    }
    __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_5);
    __pyx_t_5 = 0;
    __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_flank_length_calculate); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1439, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_4 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_3))) {
      __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
      if (likely(__pyx_t_4)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
        __Pyx_INCREF(__pyx_t_4);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_3, function);
      }
    }
    if (!__pyx_t_4) {
      __pyx_t_5 = __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_v_i); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1439, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_5);
    } else {
      __pyx_t_10 = PyTuple_New(1+1); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1439, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_10);
      __Pyx_GIVEREF(__pyx_t_4); PyTuple_SET_ITEM(__pyx_t_10, 0, __pyx_t_4); __pyx_t_4 = NULL;
      __Pyx_INCREF(__pyx_v_i);
      __Pyx_GIVEREF(__pyx_v_i);
      PyTuple_SET_ITEM(__pyx_t_10, 0+1, __pyx_v_i);
      __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_10, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1439, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_5);
      __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
    }
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(__Pyx_ListComp_Append(__pyx_t_1, (PyObject*)__pyx_t_5))) __PYX_ERR(0, 1439, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  }
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1439, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_GIVEREF(__pyx_t_1);
  PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_max, __pyx_t_2, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1439, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_flank_length = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":1440
 *     bp_info=block_subsplot(sv_info[2:],chromos)
 *     flank_length=max([flank_length_calculate(i) for i in bp_info])
 *     vapor_score_list=[]             # <<<<<<<<<<<<<<
 *     run_flag=0
 *     if len(bp_info)==1: #inter-chromosome event not considered here
 */
  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1440, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_vapor_score_list = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":1441
 *     flank_length=max([flank_length_calculate(i) for i in bp_info])
 *     vapor_score_list=[]
 *     run_flag=0             # <<<<<<<<<<<<<<
 *     if len(bp_info)==1: #inter-chromosome event not considered here
 *         if bp_info[0][-1]-bp_info[0][1]<default_max_sv_test:
 */
  __Pyx_INCREF(__pyx_int_0);
  __pyx_v_run_flag = __pyx_int_0;

  /* "vapor_vali/Simple_function.pyx":1442
 *     vapor_score_list=[]
 *     run_flag=0
 *     if len(bp_info)==1: #inter-chromosome event not considered here             # <<<<<<<<<<<<<<
 *         if bp_info[0][-1]-bp_info[0][1]<default_max_sv_test:
 *             ref_seq=ref_seq_readin(ref,bp_info[0][0],bp_info[0][1]-flank_length,bp_info[0][-1]+flank_length)
 */
  __pyx_t_6 = PyObject_Length(__pyx_v_bp_info); if (unlikely(__pyx_t_6 == -1)) __PYX_ERR(0, 1442, __pyx_L1_error)
  __pyx_t_9 = ((__pyx_t_6 == 1) != 0);
  if (__pyx_t_9) {

    /* "vapor_vali/Simple_function.pyx":1443
 *     run_flag=0
 *     if len(bp_info)==1: #inter-chromosome event not considered here
 *         if bp_info[0][-1]-bp_info[0][1]<default_max_sv_test:             # <<<<<<<<<<<<<<
 *             ref_seq=ref_seq_readin(ref,bp_info[0][0],bp_info[0][1]-flank_length,bp_info[0][-1]+flank_length)
 *             [window_size,window_size_qc]=window_size_refine(ref_seq)
 */
    __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_bp_info, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1443, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_2 = __Pyx_GetItemInt(__pyx_t_1, -1L, long, 1, __Pyx_PyInt_From_long, 0, 1, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1443, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_bp_info, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1443, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_5 = __Pyx_GetItemInt(__pyx_t_1, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1443, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = PyNumber_Subtract(__pyx_t_2, __pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1443, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = __Pyx_GetModuleGlobalName(__pyx_n_s_default_max_sv_test); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1443, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __pyx_t_2 = PyObject_RichCompare(__pyx_t_1, __pyx_t_5, Py_LT); __Pyx_XGOTREF(__pyx_t_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1443, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_9 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_9 < 0)) __PYX_ERR(0, 1443, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    if (__pyx_t_9) {

      /* "vapor_vali/Simple_function.pyx":1444
 *     if len(bp_info)==1: #inter-chromosome event not considered here
 *         if bp_info[0][-1]-bp_info[0][1]<default_max_sv_test:
 *             ref_seq=ref_seq_readin(ref,bp_info[0][0],bp_info[0][1]-flank_length,bp_info[0][-1]+flank_length)             # <<<<<<<<<<<<<<
 *             [window_size,window_size_qc]=window_size_refine(ref_seq)
 *             if not window_size=='Error':
 */
      __pyx_t_5 = __Pyx_GetModuleGlobalName(__pyx_n_s_ref_seq_readin); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1444, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_5);
      __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_bp_info, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1444, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __pyx_t_3 = __Pyx_GetItemInt(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1444, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_bp_info, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1444, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __pyx_t_10 = __Pyx_GetItemInt(__pyx_t_1, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1444, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_10);
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_1 = PyNumber_Subtract(__pyx_t_10, __pyx_v_flank_length); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1444, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
      __pyx_t_10 = __Pyx_GetItemInt(__pyx_v_bp_info, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1444, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_10);
      __pyx_t_4 = __Pyx_GetItemInt(__pyx_t_10, -1L, long, 1, __Pyx_PyInt_From_long, 0, 1, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1444, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
      __pyx_t_10 = PyNumber_Add(__pyx_t_4, __pyx_v_flank_length); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1444, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_10);
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_4 = NULL;
      __pyx_t_6 = 0;
      if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_5))) {
        __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_5);
        if (likely(__pyx_t_4)) {
          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
          __Pyx_INCREF(__pyx_t_4);
          __Pyx_INCREF(function);
          __Pyx_DECREF_SET(__pyx_t_5, function);
          __pyx_t_6 = 1;
        }
      }
      __pyx_t_11 = PyTuple_New(4+__pyx_t_6); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1444, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_11);
      if (__pyx_t_4) {
        __Pyx_GIVEREF(__pyx_t_4); PyTuple_SET_ITEM(__pyx_t_11, 0, __pyx_t_4); __pyx_t_4 = NULL;
      }
      __Pyx_INCREF(__pyx_v_ref);
      __Pyx_GIVEREF(__pyx_v_ref);
      PyTuple_SET_ITEM(__pyx_t_11, 0+__pyx_t_6, __pyx_v_ref);
      __Pyx_GIVEREF(__pyx_t_3);
      PyTuple_SET_ITEM(__pyx_t_11, 1+__pyx_t_6, __pyx_t_3);
      __Pyx_GIVEREF(__pyx_t_1);
      PyTuple_SET_ITEM(__pyx_t_11, 2+__pyx_t_6, __pyx_t_1);
      __Pyx_GIVEREF(__pyx_t_10);
      PyTuple_SET_ITEM(__pyx_t_11, 3+__pyx_t_6, __pyx_t_10);
      __pyx_t_3 = 0;
      __pyx_t_1 = 0;
      __pyx_t_10 = 0;
      __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_11, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1444, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
      __pyx_v_ref_seq = __pyx_t_2;
      __pyx_t_2 = 0;

      /* "vapor_vali/Simple_function.pyx":1445
 *         if bp_info[0][-1]-bp_info[0][1]<default_max_sv_test:
 *             ref_seq=ref_seq_readin(ref,bp_info[0][0],bp_info[0][1]-flank_length,bp_info[0][-1]+flank_length)
 *             [window_size,window_size_qc]=window_size_refine(ref_seq)             # <<<<<<<<<<<<<<
 *             if not window_size=='Error':
 *                 all_reads=simple_chop_pacbio_read_simple_short(bam_in,bp_info[0],flank_length)
 */
      __pyx_t_5 = __Pyx_GetModuleGlobalName(__pyx_n_s_window_size_refine); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1445, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_5);
      __pyx_t_11 = NULL;
      if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_5))) {
        __pyx_t_11 = PyMethod_GET_SELF(__pyx_t_5);
        if (likely(__pyx_t_11)) {
          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
          __Pyx_INCREF(__pyx_t_11);
          __Pyx_INCREF(function);
          __Pyx_DECREF_SET(__pyx_t_5, function);
        }
      }
      if (!__pyx_t_11) {
        __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_v_ref_seq); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1445, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
      } else {
        __pyx_t_10 = PyTuple_New(1+1); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1445, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_10);
        __Pyx_GIVEREF(__pyx_t_11); PyTuple_SET_ITEM(__pyx_t_10, 0, __pyx_t_11); __pyx_t_11 = NULL;
        __Pyx_INCREF(__pyx_v_ref_seq);
        __Pyx_GIVEREF(__pyx_v_ref_seq);
        PyTuple_SET_ITEM(__pyx_t_10, 0+1, __pyx_v_ref_seq);
        __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_10, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1445, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
        __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
      }
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
      if ((likely(PyTuple_CheckExact(__pyx_t_2))) || (PyList_CheckExact(__pyx_t_2))) {
        PyObject* sequence = __pyx_t_2;
        #if CYTHON_COMPILING_IN_CPYTHON
        Py_ssize_t size = Py_SIZE(sequence);
        #else
        Py_ssize_t size = PySequence_Size(sequence);
        #endif
        if (unlikely(size != 2)) {
          if (size > 2) __Pyx_RaiseTooManyValuesError(2);
          else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
          __PYX_ERR(0, 1445, __pyx_L1_error)
        }
        #if CYTHON_COMPILING_IN_CPYTHON
        if (likely(PyTuple_CheckExact(sequence))) {
          __pyx_t_5 = PyTuple_GET_ITEM(sequence, 0); 
          __pyx_t_10 = PyTuple_GET_ITEM(sequence, 1); 
        } else {
          __pyx_t_5 = PyList_GET_ITEM(sequence, 0); 
          __pyx_t_10 = PyList_GET_ITEM(sequence, 1); 
        }
        __Pyx_INCREF(__pyx_t_5);
        __Pyx_INCREF(__pyx_t_10);
        #else
        __pyx_t_5 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1445, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_5);
        __pyx_t_10 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1445, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_10);
        #endif
        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      } else {
        Py_ssize_t index = -1;
        __pyx_t_11 = PyObject_GetIter(__pyx_t_2); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1445, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_11);
        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
        __pyx_t_12 = Py_TYPE(__pyx_t_11)->tp_iternext;
        index = 0; __pyx_t_5 = __pyx_t_12(__pyx_t_11); if (unlikely(!__pyx_t_5)) goto __pyx_L10_unpacking_failed;
        __Pyx_GOTREF(__pyx_t_5);
        index = 1; __pyx_t_10 = __pyx_t_12(__pyx_t_11); if (unlikely(!__pyx_t_10)) goto __pyx_L10_unpacking_failed;
        __Pyx_GOTREF(__pyx_t_10);
        if (__Pyx_IternextUnpackEndCheck(__pyx_t_12(__pyx_t_11), 2) < 0) __PYX_ERR(0, 1445, __pyx_L1_error)
        __pyx_t_12 = NULL;
        __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
        goto __pyx_L11_unpacking_done;
        __pyx_L10_unpacking_failed:;
        __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
        __pyx_t_12 = NULL;
        if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
        __PYX_ERR(0, 1445, __pyx_L1_error)
        __pyx_L11_unpacking_done:;
      }
      __pyx_v_window_size = __pyx_t_5;
      __pyx_t_5 = 0;
      __pyx_v_window_size_qc = __pyx_t_10;
      __pyx_t_10 = 0;

      /* "vapor_vali/Simple_function.pyx":1446
 *             ref_seq=ref_seq_readin(ref,bp_info[0][0],bp_info[0][1]-flank_length,bp_info[0][-1]+flank_length)
 *             [window_size,window_size_qc]=window_size_refine(ref_seq)
 *             if not window_size=='Error':             # <<<<<<<<<<<<<<
 *                 all_reads=simple_chop_pacbio_read_simple_short(bam_in,bp_info[0],flank_length)
 *                 bp_let_hash=bp_to_chr_hash(bp_info[0],chromos,flank_length)
 */
      __pyx_t_9 = (__Pyx_PyString_Equals(__pyx_v_window_size, __pyx_n_s_Error, Py_EQ)); if (unlikely(__pyx_t_9 < 0)) __PYX_ERR(0, 1446, __pyx_L1_error)
      __pyx_t_8 = ((!__pyx_t_9) != 0);
      if (__pyx_t_8) {

        /* "vapor_vali/Simple_function.pyx":1447
 *             [window_size,window_size_qc]=window_size_refine(ref_seq)
 *             if not window_size=='Error':
 *                 all_reads=simple_chop_pacbio_read_simple_short(bam_in,bp_info[0],flank_length)             # <<<<<<<<<<<<<<
 *                 bp_let_hash=bp_to_chr_hash(bp_info[0],chromos,flank_length)
 *                 if len(all_reads)>5:
 */
        __pyx_t_10 = __Pyx_GetModuleGlobalName(__pyx_n_s_simple_chop_pacbio_read_simple_s); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1447, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_10);
        __pyx_t_5 = __Pyx_GetItemInt(__pyx_v_bp_info, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1447, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_5);
        __pyx_t_11 = NULL;
        __pyx_t_6 = 0;
        if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_10))) {
          __pyx_t_11 = PyMethod_GET_SELF(__pyx_t_10);
          if (likely(__pyx_t_11)) {
            PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_10);
            __Pyx_INCREF(__pyx_t_11);
            __Pyx_INCREF(function);
            __Pyx_DECREF_SET(__pyx_t_10, function);
            __pyx_t_6 = 1;
          }
        }
        __pyx_t_1 = PyTuple_New(3+__pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1447, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        if (__pyx_t_11) {
          __Pyx_GIVEREF(__pyx_t_11); PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_11); __pyx_t_11 = NULL;
        }
        __Pyx_INCREF(__pyx_v_bam_in);
        __Pyx_GIVEREF(__pyx_v_bam_in);
        PyTuple_SET_ITEM(__pyx_t_1, 0+__pyx_t_6, __pyx_v_bam_in);
        __Pyx_GIVEREF(__pyx_t_5);
        PyTuple_SET_ITEM(__pyx_t_1, 1+__pyx_t_6, __pyx_t_5);
        __Pyx_INCREF(__pyx_v_flank_length);
        __Pyx_GIVEREF(__pyx_v_flank_length);
        PyTuple_SET_ITEM(__pyx_t_1, 2+__pyx_t_6, __pyx_v_flank_length);
        __pyx_t_5 = 0;
        __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_10, __pyx_t_1, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1447, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
        __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
        __pyx_v_all_reads = __pyx_t_2;
        __pyx_t_2 = 0;

        /* "vapor_vali/Simple_function.pyx":1448
 *             if not window_size=='Error':
 *                 all_reads=simple_chop_pacbio_read_simple_short(bam_in,bp_info[0],flank_length)
 *                 bp_let_hash=bp_to_chr_hash(bp_info[0],chromos,flank_length)             # <<<<<<<<<<<<<<
 *                 if len(all_reads)>5:
 *                     run_flag+=1
 */
        __pyx_t_10 = __Pyx_GetModuleGlobalName(__pyx_n_s_bp_to_chr_hash); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1448, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_10);
        __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_bp_info, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1448, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        __pyx_t_5 = NULL;
        __pyx_t_6 = 0;
        if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_10))) {
          __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_10);
          if (likely(__pyx_t_5)) {
            PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_10);
            __Pyx_INCREF(__pyx_t_5);
            __Pyx_INCREF(function);
            __Pyx_DECREF_SET(__pyx_t_10, function);
            __pyx_t_6 = 1;
          }
        }
        __pyx_t_11 = PyTuple_New(3+__pyx_t_6); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1448, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_11);
        if (__pyx_t_5) {
          __Pyx_GIVEREF(__pyx_t_5); PyTuple_SET_ITEM(__pyx_t_11, 0, __pyx_t_5); __pyx_t_5 = NULL;
        }
        __Pyx_GIVEREF(__pyx_t_1);
        PyTuple_SET_ITEM(__pyx_t_11, 0+__pyx_t_6, __pyx_t_1);
        __Pyx_INCREF(__pyx_v_chromos);
        __Pyx_GIVEREF(__pyx_v_chromos);
        PyTuple_SET_ITEM(__pyx_t_11, 1+__pyx_t_6, __pyx_v_chromos);
        __Pyx_INCREF(__pyx_v_flank_length);
        __Pyx_GIVEREF(__pyx_v_flank_length);
        PyTuple_SET_ITEM(__pyx_t_11, 2+__pyx_t_6, __pyx_v_flank_length);
        __pyx_t_1 = 0;
        __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_10, __pyx_t_11, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1448, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
        __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
        __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
        __pyx_v_bp_let_hash = __pyx_t_2;
        __pyx_t_2 = 0;

        /* "vapor_vali/Simple_function.pyx":1449
 *                 all_reads=simple_chop_pacbio_read_simple_short(bam_in,bp_info[0],flank_length)
 *                 bp_let_hash=bp_to_chr_hash(bp_info[0],chromos,flank_length)
 *                 if len(all_reads)>5:             # <<<<<<<<<<<<<<
 *                     run_flag+=1
 *                     bp_let_seq={}
 */
        __pyx_t_6 = PyObject_Length(__pyx_v_all_reads); if (unlikely(__pyx_t_6 == -1)) __PYX_ERR(0, 1449, __pyx_L1_error)
        __pyx_t_8 = ((__pyx_t_6 > 5) != 0);
        if (__pyx_t_8) {

          /* "vapor_vali/Simple_function.pyx":1450
 *                 bp_let_hash=bp_to_chr_hash(bp_info[0],chromos,flank_length)
 *                 if len(all_reads)>5:
 *                     run_flag+=1             # <<<<<<<<<<<<<<
 *                     bp_let_seq={}
 *                     for i in list(bp_let_hash.keys()):
 */
          __pyx_t_2 = __Pyx_PyInt_AddObjC(__pyx_v_run_flag, __pyx_int_1, 1, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1450, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_2);
          __Pyx_DECREF_SET(__pyx_v_run_flag, __pyx_t_2);
          __pyx_t_2 = 0;

          /* "vapor_vali/Simple_function.pyx":1451
 *                 if len(all_reads)>5:
 *                     run_flag+=1
 *                     bp_let_seq={}             # <<<<<<<<<<<<<<
 *                     for i in list(bp_let_hash.keys()):
 *                         bp_let_seq[i]=ref_seq_readin(ref,bp_let_hash[i][0],int(bp_let_hash[i][1]),int(bp_let_hash[i][-1]))
 */
          __pyx_t_2 = PyDict_New(); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1451, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_2);
          __pyx_v_bp_let_seq = ((PyObject*)__pyx_t_2);
          __pyx_t_2 = 0;

          /* "vapor_vali/Simple_function.pyx":1452
 *                     run_flag+=1
 *                     bp_let_seq={}
 *                     for i in list(bp_let_hash.keys()):             # <<<<<<<<<<<<<<
 *                         bp_let_seq[i]=ref_seq_readin(ref,bp_let_hash[i][0],int(bp_let_hash[i][1]),int(bp_let_hash[i][-1]))
 *                     for alt_allele in alt_sv:
 */
          __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_v_bp_let_hash, __pyx_n_s_keys); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1452, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_10);
          __pyx_t_11 = NULL;
          if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_10))) {
            __pyx_t_11 = PyMethod_GET_SELF(__pyx_t_10);
            if (likely(__pyx_t_11)) {
              PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_10);
              __Pyx_INCREF(__pyx_t_11);
              __Pyx_INCREF(function);
              __Pyx_DECREF_SET(__pyx_t_10, function);
            }
          }
          if (__pyx_t_11) {
            __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_t_10, __pyx_t_11); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1452, __pyx_L1_error)
            __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
          } else {
            __pyx_t_2 = __Pyx_PyObject_CallNoArg(__pyx_t_10); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1452, __pyx_L1_error)
          }
          __Pyx_GOTREF(__pyx_t_2);
          __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
          __pyx_t_10 = PySequence_List(__pyx_t_2); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1452, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_10);
          __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
          __pyx_t_2 = __pyx_t_10; __Pyx_INCREF(__pyx_t_2); __pyx_t_6 = 0;
          __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
          for (;;) {
            if (__pyx_t_6 >= PyList_GET_SIZE(__pyx_t_2)) break;
            #if CYTHON_COMPILING_IN_CPYTHON
            __pyx_t_10 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_6); __Pyx_INCREF(__pyx_t_10); __pyx_t_6++; if (unlikely(0 < 0)) __PYX_ERR(0, 1452, __pyx_L1_error)
            #else
            __pyx_t_10 = PySequence_ITEM(__pyx_t_2, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1452, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_10);
            #endif
            __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_10);
            __pyx_t_10 = 0;

            /* "vapor_vali/Simple_function.pyx":1453
 *                     bp_let_seq={}
 *                     for i in list(bp_let_hash.keys()):
 *                         bp_let_seq[i]=ref_seq_readin(ref,bp_let_hash[i][0],int(bp_let_hash[i][1]),int(bp_let_hash[i][-1]))             # <<<<<<<<<<<<<<
 *                     for alt_allele in alt_sv:
 *                         alt_seq=ref_seq[:flank_length]
 */
            __pyx_t_11 = __Pyx_GetModuleGlobalName(__pyx_n_s_ref_seq_readin); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1453, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_11);
            __pyx_t_1 = PyObject_GetItem(__pyx_v_bp_let_hash, __pyx_v_i); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1453, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_1);
            __pyx_t_5 = __Pyx_GetItemInt(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1453, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_5);
            __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
            __pyx_t_1 = PyObject_GetItem(__pyx_v_bp_let_hash, __pyx_v_i); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1453, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_1);
            __pyx_t_3 = __Pyx_GetItemInt(__pyx_t_1, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1453, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_3);
            __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
            __pyx_t_1 = __Pyx_PyNumber_Int(__pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1453, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_1);
            __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
            __pyx_t_3 = PyObject_GetItem(__pyx_v_bp_let_hash, __pyx_v_i); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1453, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_3);
            __pyx_t_4 = __Pyx_GetItemInt(__pyx_t_3, -1L, long, 1, __Pyx_PyInt_From_long, 0, 1, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1453, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_4);
            __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
            __pyx_t_3 = __Pyx_PyNumber_Int(__pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1453, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_3);
            __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
            __pyx_t_4 = NULL;
            __pyx_t_13 = 0;
            if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_11))) {
              __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_11);
              if (likely(__pyx_t_4)) {
                PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_11);
                __Pyx_INCREF(__pyx_t_4);
                __Pyx_INCREF(function);
                __Pyx_DECREF_SET(__pyx_t_11, function);
                __pyx_t_13 = 1;
              }
            }
            __pyx_t_14 = PyTuple_New(4+__pyx_t_13); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1453, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_14);
            if (__pyx_t_4) {
              __Pyx_GIVEREF(__pyx_t_4); PyTuple_SET_ITEM(__pyx_t_14, 0, __pyx_t_4); __pyx_t_4 = NULL;
            }
            __Pyx_INCREF(__pyx_v_ref);
            __Pyx_GIVEREF(__pyx_v_ref);
            PyTuple_SET_ITEM(__pyx_t_14, 0+__pyx_t_13, __pyx_v_ref);
            __Pyx_GIVEREF(__pyx_t_5);
            PyTuple_SET_ITEM(__pyx_t_14, 1+__pyx_t_13, __pyx_t_5);
            __Pyx_GIVEREF(__pyx_t_1);
            PyTuple_SET_ITEM(__pyx_t_14, 2+__pyx_t_13, __pyx_t_1);
            __Pyx_GIVEREF(__pyx_t_3);
            PyTuple_SET_ITEM(__pyx_t_14, 3+__pyx_t_13, __pyx_t_3);
            __pyx_t_5 = 0;
            __pyx_t_1 = 0;
            __pyx_t_3 = 0;
            __pyx_t_10 = __Pyx_PyObject_Call(__pyx_t_11, __pyx_t_14, NULL); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1453, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_10);
            __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
            __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
            if (unlikely(PyDict_SetItem(__pyx_v_bp_let_seq, __pyx_v_i, __pyx_t_10) < 0)) __PYX_ERR(0, 1453, __pyx_L1_error)
            __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;

            /* "vapor_vali/Simple_function.pyx":1452
 *                     run_flag+=1
 *                     bp_let_seq={}
 *                     for i in list(bp_let_hash.keys()):             # <<<<<<<<<<<<<<
 *                         bp_let_seq[i]=ref_seq_readin(ref,bp_let_hash[i][0],int(bp_let_hash[i][1]),int(bp_let_hash[i][-1]))
 *                     for alt_allele in alt_sv:
 */
          }
          __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

          /* "vapor_vali/Simple_function.pyx":1454
 *                     for i in list(bp_let_hash.keys()):
 *                         bp_let_seq[i]=ref_seq_readin(ref,bp_let_hash[i][0],int(bp_let_hash[i][1]),int(bp_let_hash[i][-1]))
 *                     for alt_allele in alt_sv:             # <<<<<<<<<<<<<<
 *                         alt_seq=ref_seq[:flank_length]
 *                         for i in letter_split(alt_allele):
 */
          if (likely(PyList_CheckExact(__pyx_v_alt_sv)) || PyTuple_CheckExact(__pyx_v_alt_sv)) {
            __pyx_t_2 = __pyx_v_alt_sv; __Pyx_INCREF(__pyx_t_2); __pyx_t_6 = 0;
            __pyx_t_7 = NULL;
          } else {
            __pyx_t_6 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_v_alt_sv); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1454, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_2);
            __pyx_t_7 = Py_TYPE(__pyx_t_2)->tp_iternext; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1454, __pyx_L1_error)
          }
          for (;;) {
            if (likely(!__pyx_t_7)) {
              if (likely(PyList_CheckExact(__pyx_t_2))) {
                if (__pyx_t_6 >= PyList_GET_SIZE(__pyx_t_2)) break;
                #if CYTHON_COMPILING_IN_CPYTHON
                __pyx_t_10 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_6); __Pyx_INCREF(__pyx_t_10); __pyx_t_6++; if (unlikely(0 < 0)) __PYX_ERR(0, 1454, __pyx_L1_error)
                #else
                __pyx_t_10 = PySequence_ITEM(__pyx_t_2, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1454, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_10);
                #endif
              } else {
                if (__pyx_t_6 >= PyTuple_GET_SIZE(__pyx_t_2)) break;
                #if CYTHON_COMPILING_IN_CPYTHON
                __pyx_t_10 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_6); __Pyx_INCREF(__pyx_t_10); __pyx_t_6++; if (unlikely(0 < 0)) __PYX_ERR(0, 1454, __pyx_L1_error)
                #else
                __pyx_t_10 = PySequence_ITEM(__pyx_t_2, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1454, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_10);
                #endif
              }
            } else {
              __pyx_t_10 = __pyx_t_7(__pyx_t_2);
              if (unlikely(!__pyx_t_10)) {
                PyObject* exc_type = PyErr_Occurred();
                if (exc_type) {
                  if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
                  else __PYX_ERR(0, 1454, __pyx_L1_error)
                }
                break;
              }
              __Pyx_GOTREF(__pyx_t_10);
            }
            __Pyx_XDECREF_SET(__pyx_v_alt_allele, __pyx_t_10);
            __pyx_t_10 = 0;

            /* "vapor_vali/Simple_function.pyx":1455
 *                         bp_let_seq[i]=ref_seq_readin(ref,bp_let_hash[i][0],int(bp_let_hash[i][1]),int(bp_let_hash[i][-1]))
 *                     for alt_allele in alt_sv:
 *                         alt_seq=ref_seq[:flank_length]             # <<<<<<<<<<<<<<
 *                         for i in letter_split(alt_allele):
 *                             if not '^' in i:    alt_seq+=bp_let_seq[i]
 */
            __pyx_t_10 = __Pyx_PyObject_GetSlice(__pyx_v_ref_seq, 0, 0, NULL, &__pyx_v_flank_length, NULL, 0, 0, 1); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1455, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_10);
            __Pyx_XDECREF_SET(__pyx_v_alt_seq, __pyx_t_10);
            __pyx_t_10 = 0;

            /* "vapor_vali/Simple_function.pyx":1456
 *                     for alt_allele in alt_sv:
 *                         alt_seq=ref_seq[:flank_length]
 *                         for i in letter_split(alt_allele):             # <<<<<<<<<<<<<<
 *                             if not '^' in i:    alt_seq+=bp_let_seq[i]
 *                             else:               alt_seq+=reverse(complementary(bp_let_seq[i[0]]))
 */
            __pyx_t_11 = __Pyx_GetModuleGlobalName(__pyx_n_s_letter_split); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1456, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_11);
            __pyx_t_14 = NULL;
            if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_11))) {
              __pyx_t_14 = PyMethod_GET_SELF(__pyx_t_11);
              if (likely(__pyx_t_14)) {
                PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_11);
                __Pyx_INCREF(__pyx_t_14);
                __Pyx_INCREF(function);
                __Pyx_DECREF_SET(__pyx_t_11, function);
              }
            }
            if (!__pyx_t_14) {
              __pyx_t_10 = __Pyx_PyObject_CallOneArg(__pyx_t_11, __pyx_v_alt_allele); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1456, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_10);
            } else {
              __pyx_t_3 = PyTuple_New(1+1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1456, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_3);
              __Pyx_GIVEREF(__pyx_t_14); PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_14); __pyx_t_14 = NULL;
              __Pyx_INCREF(__pyx_v_alt_allele);
              __Pyx_GIVEREF(__pyx_v_alt_allele);
              PyTuple_SET_ITEM(__pyx_t_3, 0+1, __pyx_v_alt_allele);
              __pyx_t_10 = __Pyx_PyObject_Call(__pyx_t_11, __pyx_t_3, NULL); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1456, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_10);
              __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
            }
            __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
            if (likely(PyList_CheckExact(__pyx_t_10)) || PyTuple_CheckExact(__pyx_t_10)) {
              __pyx_t_11 = __pyx_t_10; __Pyx_INCREF(__pyx_t_11); __pyx_t_13 = 0;
              __pyx_t_15 = NULL;
            } else {
              __pyx_t_13 = -1; __pyx_t_11 = PyObject_GetIter(__pyx_t_10); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1456, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_11);
              __pyx_t_15 = Py_TYPE(__pyx_t_11)->tp_iternext; if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1456, __pyx_L1_error)
            }
            __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
            for (;;) {
              if (likely(!__pyx_t_15)) {
                if (likely(PyList_CheckExact(__pyx_t_11))) {
                  if (__pyx_t_13 >= PyList_GET_SIZE(__pyx_t_11)) break;
                  #if CYTHON_COMPILING_IN_CPYTHON
                  __pyx_t_10 = PyList_GET_ITEM(__pyx_t_11, __pyx_t_13); __Pyx_INCREF(__pyx_t_10); __pyx_t_13++; if (unlikely(0 < 0)) __PYX_ERR(0, 1456, __pyx_L1_error)
                  #else
                  __pyx_t_10 = PySequence_ITEM(__pyx_t_11, __pyx_t_13); __pyx_t_13++; if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1456, __pyx_L1_error)
                  __Pyx_GOTREF(__pyx_t_10);
                  #endif
                } else {
                  if (__pyx_t_13 >= PyTuple_GET_SIZE(__pyx_t_11)) break;
                  #if CYTHON_COMPILING_IN_CPYTHON
                  __pyx_t_10 = PyTuple_GET_ITEM(__pyx_t_11, __pyx_t_13); __Pyx_INCREF(__pyx_t_10); __pyx_t_13++; if (unlikely(0 < 0)) __PYX_ERR(0, 1456, __pyx_L1_error)
                  #else
                  __pyx_t_10 = PySequence_ITEM(__pyx_t_11, __pyx_t_13); __pyx_t_13++; if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1456, __pyx_L1_error)
                  __Pyx_GOTREF(__pyx_t_10);
                  #endif
                }
              } else {
                __pyx_t_10 = __pyx_t_15(__pyx_t_11);
                if (unlikely(!__pyx_t_10)) {
                  PyObject* exc_type = PyErr_Occurred();
                  if (exc_type) {
                    if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
                    else __PYX_ERR(0, 1456, __pyx_L1_error)
                  }
                  break;
                }
                __Pyx_GOTREF(__pyx_t_10);
              }
              __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_10);
              __pyx_t_10 = 0;

              /* "vapor_vali/Simple_function.pyx":1457
 *                         alt_seq=ref_seq[:flank_length]
 *                         for i in letter_split(alt_allele):
 *                             if not '^' in i:    alt_seq+=bp_let_seq[i]             # <<<<<<<<<<<<<<
 *                             else:               alt_seq+=reverse(complementary(bp_let_seq[i[0]]))
 *                         alt_seq+=ref_seq[-flank_length:]
 */
              __pyx_t_8 = (__Pyx_PySequence_ContainsTF(__pyx_kp_s__7, __pyx_v_i, Py_NE)); if (unlikely(__pyx_t_8 < 0)) __PYX_ERR(0, 1457, __pyx_L1_error)
              __pyx_t_9 = (__pyx_t_8 != 0);
              if (__pyx_t_9) {
                __pyx_t_10 = __Pyx_PyDict_GetItem(__pyx_v_bp_let_seq, __pyx_v_i); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1457, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_10);
                __pyx_t_3 = PyNumber_InPlaceAdd(__pyx_v_alt_seq, __pyx_t_10); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1457, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_3);
                __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
                __Pyx_DECREF_SET(__pyx_v_alt_seq, __pyx_t_3);
                __pyx_t_3 = 0;
                goto __pyx_L20;
              }

              /* "vapor_vali/Simple_function.pyx":1458
 *                         for i in letter_split(alt_allele):
 *                             if not '^' in i:    alt_seq+=bp_let_seq[i]
 *                             else:               alt_seq+=reverse(complementary(bp_let_seq[i[0]]))             # <<<<<<<<<<<<<<
 *                         alt_seq+=ref_seq[-flank_length:]
 *                         [window_size,window_size_qc]=window_size_refine(alt_seq)
 */
              /*else*/ {
                __pyx_t_10 = __Pyx_GetModuleGlobalName(__pyx_n_s_reverse); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1458, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_10);
                __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_complementary); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1458, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_1);
                __pyx_t_5 = __Pyx_GetItemInt(__pyx_v_i, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1458, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_5);
                __pyx_t_4 = __Pyx_PyDict_GetItem(__pyx_v_bp_let_seq, __pyx_t_5); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1458, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_4);
                __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
                __pyx_t_5 = NULL;
                if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_1))) {
                  __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_1);
                  if (likely(__pyx_t_5)) {
                    PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
                    __Pyx_INCREF(__pyx_t_5);
                    __Pyx_INCREF(function);
                    __Pyx_DECREF_SET(__pyx_t_1, function);
                  }
                }
                if (!__pyx_t_5) {
                  __pyx_t_14 = __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_t_4); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1458, __pyx_L1_error)
                  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
                  __Pyx_GOTREF(__pyx_t_14);
                } else {
                  __pyx_t_16 = PyTuple_New(1+1); if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 1458, __pyx_L1_error)
                  __Pyx_GOTREF(__pyx_t_16);
                  __Pyx_GIVEREF(__pyx_t_5); PyTuple_SET_ITEM(__pyx_t_16, 0, __pyx_t_5); __pyx_t_5 = NULL;
                  __Pyx_GIVEREF(__pyx_t_4);
                  PyTuple_SET_ITEM(__pyx_t_16, 0+1, __pyx_t_4);
                  __pyx_t_4 = 0;
                  __pyx_t_14 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_16, NULL); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1458, __pyx_L1_error)
                  __Pyx_GOTREF(__pyx_t_14);
                  __Pyx_DECREF(__pyx_t_16); __pyx_t_16 = 0;
                }
                __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
                __pyx_t_1 = NULL;
                if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_10))) {
                  __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_10);
                  if (likely(__pyx_t_1)) {
                    PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_10);
                    __Pyx_INCREF(__pyx_t_1);
                    __Pyx_INCREF(function);
                    __Pyx_DECREF_SET(__pyx_t_10, function);
                  }
                }
                if (!__pyx_t_1) {
                  __pyx_t_3 = __Pyx_PyObject_CallOneArg(__pyx_t_10, __pyx_t_14); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1458, __pyx_L1_error)
                  __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
                  __Pyx_GOTREF(__pyx_t_3);
                } else {
                  __pyx_t_16 = PyTuple_New(1+1); if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 1458, __pyx_L1_error)
                  __Pyx_GOTREF(__pyx_t_16);
                  __Pyx_GIVEREF(__pyx_t_1); PyTuple_SET_ITEM(__pyx_t_16, 0, __pyx_t_1); __pyx_t_1 = NULL;
                  __Pyx_GIVEREF(__pyx_t_14);
                  PyTuple_SET_ITEM(__pyx_t_16, 0+1, __pyx_t_14);
                  __pyx_t_14 = 0;
                  __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_10, __pyx_t_16, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1458, __pyx_L1_error)
                  __Pyx_GOTREF(__pyx_t_3);
                  __Pyx_DECREF(__pyx_t_16); __pyx_t_16 = 0;
                }
                __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
                __pyx_t_10 = PyNumber_InPlaceAdd(__pyx_v_alt_seq, __pyx_t_3); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1458, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_10);
                __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
                __Pyx_DECREF_SET(__pyx_v_alt_seq, __pyx_t_10);
                __pyx_t_10 = 0;
              }
              __pyx_L20:;

              /* "vapor_vali/Simple_function.pyx":1456
 *                     for alt_allele in alt_sv:
 *                         alt_seq=ref_seq[:flank_length]
 *                         for i in letter_split(alt_allele):             # <<<<<<<<<<<<<<
 *                             if not '^' in i:    alt_seq+=bp_let_seq[i]
 *                             else:               alt_seq+=reverse(complementary(bp_let_seq[i[0]]))
 */
            }
            __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;

            /* "vapor_vali/Simple_function.pyx":1459
 *                             if not '^' in i:    alt_seq+=bp_let_seq[i]
 *                             else:               alt_seq+=reverse(complementary(bp_let_seq[i[0]]))
 *                         alt_seq+=ref_seq[-flank_length:]             # <<<<<<<<<<<<<<
 *                         [window_size,window_size_qc]=window_size_refine(alt_seq)
 *                         if not window_size=='Error':
 */
            __pyx_t_11 = PyNumber_Negative(__pyx_v_flank_length); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1459, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_11);
            __pyx_t_10 = __Pyx_PyObject_GetSlice(__pyx_v_ref_seq, 0, 0, &__pyx_t_11, NULL, NULL, 0, 0, 1); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1459, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_10);
            __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
            __pyx_t_11 = PyNumber_InPlaceAdd(__pyx_v_alt_seq, __pyx_t_10); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1459, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_11);
            __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
            __Pyx_DECREF_SET(__pyx_v_alt_seq, __pyx_t_11);
            __pyx_t_11 = 0;

            /* "vapor_vali/Simple_function.pyx":1460
 *                             else:               alt_seq+=reverse(complementary(bp_let_seq[i[0]]))
 *                         alt_seq+=ref_seq[-flank_length:]
 *                         [window_size,window_size_qc]=window_size_refine(alt_seq)             # <<<<<<<<<<<<<<
 *                         if not window_size=='Error':
 *                             best_read_rec=''
 */
            __pyx_t_10 = __Pyx_GetModuleGlobalName(__pyx_n_s_window_size_refine); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1460, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_10);
            __pyx_t_3 = NULL;
            if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_10))) {
              __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_10);
              if (likely(__pyx_t_3)) {
                PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_10);
                __Pyx_INCREF(__pyx_t_3);
                __Pyx_INCREF(function);
                __Pyx_DECREF_SET(__pyx_t_10, function);
              }
            }
            if (!__pyx_t_3) {
              __pyx_t_11 = __Pyx_PyObject_CallOneArg(__pyx_t_10, __pyx_v_alt_seq); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1460, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_11);
            } else {
              __pyx_t_16 = PyTuple_New(1+1); if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 1460, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_16);
              __Pyx_GIVEREF(__pyx_t_3); PyTuple_SET_ITEM(__pyx_t_16, 0, __pyx_t_3); __pyx_t_3 = NULL;
              __Pyx_INCREF(__pyx_v_alt_seq);
              __Pyx_GIVEREF(__pyx_v_alt_seq);
              PyTuple_SET_ITEM(__pyx_t_16, 0+1, __pyx_v_alt_seq);
              __pyx_t_11 = __Pyx_PyObject_Call(__pyx_t_10, __pyx_t_16, NULL); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1460, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_11);
              __Pyx_DECREF(__pyx_t_16); __pyx_t_16 = 0;
            }
            __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
            if ((likely(PyTuple_CheckExact(__pyx_t_11))) || (PyList_CheckExact(__pyx_t_11))) {
              PyObject* sequence = __pyx_t_11;
              #if CYTHON_COMPILING_IN_CPYTHON
              Py_ssize_t size = Py_SIZE(sequence);
              #else
              Py_ssize_t size = PySequence_Size(sequence);
              #endif
              if (unlikely(size != 2)) {
                if (size > 2) __Pyx_RaiseTooManyValuesError(2);
                else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
                __PYX_ERR(0, 1460, __pyx_L1_error)
              }
              #if CYTHON_COMPILING_IN_CPYTHON
              if (likely(PyTuple_CheckExact(sequence))) {
                __pyx_t_10 = PyTuple_GET_ITEM(sequence, 0); 
                __pyx_t_16 = PyTuple_GET_ITEM(sequence, 1); 
              } else {
                __pyx_t_10 = PyList_GET_ITEM(sequence, 0); 
                __pyx_t_16 = PyList_GET_ITEM(sequence, 1); 
              }
              __Pyx_INCREF(__pyx_t_10);
              __Pyx_INCREF(__pyx_t_16);
              #else
              __pyx_t_10 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1460, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_10);
              __pyx_t_16 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 1460, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_16);
              #endif
              __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
            } else {
              Py_ssize_t index = -1;
              __pyx_t_3 = PyObject_GetIter(__pyx_t_11); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1460, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_3);
              __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
              __pyx_t_12 = Py_TYPE(__pyx_t_3)->tp_iternext;
              index = 0; __pyx_t_10 = __pyx_t_12(__pyx_t_3); if (unlikely(!__pyx_t_10)) goto __pyx_L21_unpacking_failed;
              __Pyx_GOTREF(__pyx_t_10);
              index = 1; __pyx_t_16 = __pyx_t_12(__pyx_t_3); if (unlikely(!__pyx_t_16)) goto __pyx_L21_unpacking_failed;
              __Pyx_GOTREF(__pyx_t_16);
              if (__Pyx_IternextUnpackEndCheck(__pyx_t_12(__pyx_t_3), 2) < 0) __PYX_ERR(0, 1460, __pyx_L1_error)
              __pyx_t_12 = NULL;
              __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
              goto __pyx_L22_unpacking_done;
              __pyx_L21_unpacking_failed:;
              __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
              __pyx_t_12 = NULL;
              if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
              __PYX_ERR(0, 1460, __pyx_L1_error)
              __pyx_L22_unpacking_done:;
            }
            __Pyx_DECREF_SET(__pyx_v_window_size, __pyx_t_10);
            __pyx_t_10 = 0;
            __Pyx_DECREF_SET(__pyx_v_window_size_qc, __pyx_t_16);
            __pyx_t_16 = 0;

            /* "vapor_vali/Simple_function.pyx":1461
 *                         alt_seq+=ref_seq[-flank_length:]
 *                         [window_size,window_size_qc]=window_size_refine(alt_seq)
 *                         if not window_size=='Error':             # <<<<<<<<<<<<<<
 *                             best_read_rec=''
 *                             for x in all_reads:
 */
            __pyx_t_9 = (__Pyx_PyString_Equals(__pyx_v_window_size, __pyx_n_s_Error, Py_EQ)); if (unlikely(__pyx_t_9 < 0)) __PYX_ERR(0, 1461, __pyx_L1_error)
            __pyx_t_8 = ((!__pyx_t_9) != 0);
            if (__pyx_t_8) {

              /* "vapor_vali/Simple_function.pyx":1462
 *                         [window_size,window_size_qc]=window_size_refine(alt_seq)
 *                         if not window_size=='Error':
 *                             best_read_rec=''             # <<<<<<<<<<<<<<
 *                             for x in all_reads:
 *                                 if not max([alt_allele.count(i) for i in alt_allele]+[0])>1:    vapor_single_read_score=calcu_vapor_single_read_score_abs_dis_m1b(ref_seq,alt_seq,x,window_size)
 */
              __Pyx_INCREF(__pyx_kp_s__24);
              __Pyx_XDECREF_SET(__pyx_v_best_read_rec, __pyx_kp_s__24);

              /* "vapor_vali/Simple_function.pyx":1463
 *                         if not window_size=='Error':
 *                             best_read_rec=''
 *                             for x in all_reads:             # <<<<<<<<<<<<<<
 *                                 if not max([alt_allele.count(i) for i in alt_allele]+[0])>1:    vapor_single_read_score=calcu_vapor_single_read_score_abs_dis_m1b(ref_seq,alt_seq,x,window_size)
 *                                 else:                                                           vapor_single_read_score=calcu_vapor_single_read_score_directed_dis_m1b_redefine_diagnal(ref_seq,alt_seq,x,window_size)
 */
              if (likely(PyList_CheckExact(__pyx_v_all_reads)) || PyTuple_CheckExact(__pyx_v_all_reads)) {
                __pyx_t_11 = __pyx_v_all_reads; __Pyx_INCREF(__pyx_t_11); __pyx_t_13 = 0;
                __pyx_t_15 = NULL;
              } else {
                __pyx_t_13 = -1; __pyx_t_11 = PyObject_GetIter(__pyx_v_all_reads); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1463, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_11);
                __pyx_t_15 = Py_TYPE(__pyx_t_11)->tp_iternext; if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1463, __pyx_L1_error)
              }
              for (;;) {
                if (likely(!__pyx_t_15)) {
                  if (likely(PyList_CheckExact(__pyx_t_11))) {
                    if (__pyx_t_13 >= PyList_GET_SIZE(__pyx_t_11)) break;
                    #if CYTHON_COMPILING_IN_CPYTHON
                    __pyx_t_16 = PyList_GET_ITEM(__pyx_t_11, __pyx_t_13); __Pyx_INCREF(__pyx_t_16); __pyx_t_13++; if (unlikely(0 < 0)) __PYX_ERR(0, 1463, __pyx_L1_error)
                    #else
                    __pyx_t_16 = PySequence_ITEM(__pyx_t_11, __pyx_t_13); __pyx_t_13++; if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 1463, __pyx_L1_error)
                    __Pyx_GOTREF(__pyx_t_16);
                    #endif
                  } else {
                    if (__pyx_t_13 >= PyTuple_GET_SIZE(__pyx_t_11)) break;
                    #if CYTHON_COMPILING_IN_CPYTHON
                    __pyx_t_16 = PyTuple_GET_ITEM(__pyx_t_11, __pyx_t_13); __Pyx_INCREF(__pyx_t_16); __pyx_t_13++; if (unlikely(0 < 0)) __PYX_ERR(0, 1463, __pyx_L1_error)
                    #else
                    __pyx_t_16 = PySequence_ITEM(__pyx_t_11, __pyx_t_13); __pyx_t_13++; if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 1463, __pyx_L1_error)
                    __Pyx_GOTREF(__pyx_t_16);
                    #endif
                  }
                } else {
                  __pyx_t_16 = __pyx_t_15(__pyx_t_11);
                  if (unlikely(!__pyx_t_16)) {
                    PyObject* exc_type = PyErr_Occurred();
                    if (exc_type) {
                      if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
                      else __PYX_ERR(0, 1463, __pyx_L1_error)
                    }
                    break;
                  }
                  __Pyx_GOTREF(__pyx_t_16);
                }
                __Pyx_XDECREF_SET(__pyx_v_x, __pyx_t_16);
                __pyx_t_16 = 0;

                /* "vapor_vali/Simple_function.pyx":1464
 *                             best_read_rec=''
 *                             for x in all_reads:
 *                                 if not max([alt_allele.count(i) for i in alt_allele]+[0])>1:    vapor_single_read_score=calcu_vapor_single_read_score_abs_dis_m1b(ref_seq,alt_seq,x,window_size)             # <<<<<<<<<<<<<<
 *                                 else:                                                           vapor_single_read_score=calcu_vapor_single_read_score_directed_dis_m1b_redefine_diagnal(ref_seq,alt_seq,x,window_size)
 *                                 if not 0 in vapor_single_read_score:
 */
                __pyx_t_16 = PyList_New(0); if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 1464, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_16);
                if (likely(PyList_CheckExact(__pyx_v_alt_allele)) || PyTuple_CheckExact(__pyx_v_alt_allele)) {
                  __pyx_t_10 = __pyx_v_alt_allele; __Pyx_INCREF(__pyx_t_10); __pyx_t_17 = 0;
                  __pyx_t_18 = NULL;
                } else {
                  __pyx_t_17 = -1; __pyx_t_10 = PyObject_GetIter(__pyx_v_alt_allele); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1464, __pyx_L1_error)
                  __Pyx_GOTREF(__pyx_t_10);
                  __pyx_t_18 = Py_TYPE(__pyx_t_10)->tp_iternext; if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 1464, __pyx_L1_error)
                }
                for (;;) {
                  if (likely(!__pyx_t_18)) {
                    if (likely(PyList_CheckExact(__pyx_t_10))) {
                      if (__pyx_t_17 >= PyList_GET_SIZE(__pyx_t_10)) break;
                      #if CYTHON_COMPILING_IN_CPYTHON
                      __pyx_t_3 = PyList_GET_ITEM(__pyx_t_10, __pyx_t_17); __Pyx_INCREF(__pyx_t_3); __pyx_t_17++; if (unlikely(0 < 0)) __PYX_ERR(0, 1464, __pyx_L1_error)
                      #else
                      __pyx_t_3 = PySequence_ITEM(__pyx_t_10, __pyx_t_17); __pyx_t_17++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1464, __pyx_L1_error)
                      __Pyx_GOTREF(__pyx_t_3);
                      #endif
                    } else {
                      if (__pyx_t_17 >= PyTuple_GET_SIZE(__pyx_t_10)) break;
                      #if CYTHON_COMPILING_IN_CPYTHON
                      __pyx_t_3 = PyTuple_GET_ITEM(__pyx_t_10, __pyx_t_17); __Pyx_INCREF(__pyx_t_3); __pyx_t_17++; if (unlikely(0 < 0)) __PYX_ERR(0, 1464, __pyx_L1_error)
                      #else
                      __pyx_t_3 = PySequence_ITEM(__pyx_t_10, __pyx_t_17); __pyx_t_17++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1464, __pyx_L1_error)
                      __Pyx_GOTREF(__pyx_t_3);
                      #endif
                    }
                  } else {
                    __pyx_t_3 = __pyx_t_18(__pyx_t_10);
                    if (unlikely(!__pyx_t_3)) {
                      PyObject* exc_type = PyErr_Occurred();
                      if (exc_type) {
                        if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
                        else __PYX_ERR(0, 1464, __pyx_L1_error)
                      }
                      break;
                    }
                    __Pyx_GOTREF(__pyx_t_3);
                  }
                  __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_3);
                  __pyx_t_3 = 0;
                  __pyx_t_14 = __Pyx_PyObject_GetAttrStr(__pyx_v_alt_allele, __pyx_n_s_count); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1464, __pyx_L1_error)
                  __Pyx_GOTREF(__pyx_t_14);
                  __pyx_t_1 = NULL;
                  if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_14))) {
                    __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_14);
                    if (likely(__pyx_t_1)) {
                      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_14);
                      __Pyx_INCREF(__pyx_t_1);
                      __Pyx_INCREF(function);
                      __Pyx_DECREF_SET(__pyx_t_14, function);
                    }
                  }
                  if (!__pyx_t_1) {
                    __pyx_t_3 = __Pyx_PyObject_CallOneArg(__pyx_t_14, __pyx_v_i); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1464, __pyx_L1_error)
                    __Pyx_GOTREF(__pyx_t_3);
                  } else {
                    __pyx_t_4 = PyTuple_New(1+1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1464, __pyx_L1_error)
                    __Pyx_GOTREF(__pyx_t_4);
                    __Pyx_GIVEREF(__pyx_t_1); PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_1); __pyx_t_1 = NULL;
                    __Pyx_INCREF(__pyx_v_i);
                    __Pyx_GIVEREF(__pyx_v_i);
                    PyTuple_SET_ITEM(__pyx_t_4, 0+1, __pyx_v_i);
                    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_14, __pyx_t_4, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1464, __pyx_L1_error)
                    __Pyx_GOTREF(__pyx_t_3);
                    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
                  }
                  __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
                  if (unlikely(__Pyx_ListComp_Append(__pyx_t_16, (PyObject*)__pyx_t_3))) __PYX_ERR(0, 1464, __pyx_L1_error)
                  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
                }
                __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
                __pyx_t_10 = PyList_New(1); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1464, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_10);
                __Pyx_INCREF(__pyx_int_0);
                __Pyx_GIVEREF(__pyx_int_0);
                PyList_SET_ITEM(__pyx_t_10, 0, __pyx_int_0);
                __pyx_t_3 = PyNumber_Add(__pyx_t_16, __pyx_t_10); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1464, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_3);
                __Pyx_DECREF(__pyx_t_16); __pyx_t_16 = 0;
                __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
                __pyx_t_10 = PyTuple_New(1); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1464, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_10);
                __Pyx_GIVEREF(__pyx_t_3);
                PyTuple_SET_ITEM(__pyx_t_10, 0, __pyx_t_3);
                __pyx_t_3 = 0;
                __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_max, __pyx_t_10, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1464, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_3);
                __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
                __pyx_t_10 = PyObject_RichCompare(__pyx_t_3, __pyx_int_1, Py_GT); __Pyx_XGOTREF(__pyx_t_10); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1464, __pyx_L1_error)
                __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
                __pyx_t_8 = __Pyx_PyObject_IsTrue(__pyx_t_10); if (unlikely(__pyx_t_8 < 0)) __PYX_ERR(0, 1464, __pyx_L1_error)
                __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
                __pyx_t_9 = ((!__pyx_t_8) != 0);
                if (__pyx_t_9) {
                  __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_calcu_vapor_single_read_score_ab); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1464, __pyx_L1_error)
                  __Pyx_GOTREF(__pyx_t_3);
                  __pyx_t_16 = NULL;
                  __pyx_t_17 = 0;
                  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_3))) {
                    __pyx_t_16 = PyMethod_GET_SELF(__pyx_t_3);
                    if (likely(__pyx_t_16)) {
                      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
                      __Pyx_INCREF(__pyx_t_16);
                      __Pyx_INCREF(function);
                      __Pyx_DECREF_SET(__pyx_t_3, function);
                      __pyx_t_17 = 1;
                    }
                  }
                  __pyx_t_14 = PyTuple_New(4+__pyx_t_17); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1464, __pyx_L1_error)
                  __Pyx_GOTREF(__pyx_t_14);
                  if (__pyx_t_16) {
                    __Pyx_GIVEREF(__pyx_t_16); PyTuple_SET_ITEM(__pyx_t_14, 0, __pyx_t_16); __pyx_t_16 = NULL;
                  }
                  __Pyx_INCREF(__pyx_v_ref_seq);
                  __Pyx_GIVEREF(__pyx_v_ref_seq);
                  PyTuple_SET_ITEM(__pyx_t_14, 0+__pyx_t_17, __pyx_v_ref_seq);
                  __Pyx_INCREF(__pyx_v_alt_seq);
                  __Pyx_GIVEREF(__pyx_v_alt_seq);
                  PyTuple_SET_ITEM(__pyx_t_14, 1+__pyx_t_17, __pyx_v_alt_seq);
                  __Pyx_INCREF(__pyx_v_x);
                  __Pyx_GIVEREF(__pyx_v_x);
                  PyTuple_SET_ITEM(__pyx_t_14, 2+__pyx_t_17, __pyx_v_x);
                  __Pyx_INCREF(__pyx_v_window_size);
                  __Pyx_GIVEREF(__pyx_v_window_size);
                  PyTuple_SET_ITEM(__pyx_t_14, 3+__pyx_t_17, __pyx_v_window_size);
                  __pyx_t_10 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_14, NULL); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1464, __pyx_L1_error)
                  __Pyx_GOTREF(__pyx_t_10);
                  __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
                  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
                  __Pyx_XDECREF_SET(__pyx_v_vapor_single_read_score, __pyx_t_10);
                  __pyx_t_10 = 0;
                  goto __pyx_L26;
                }

                /* "vapor_vali/Simple_function.pyx":1465
 *                             for x in all_reads:
 *                                 if not max([alt_allele.count(i) for i in alt_allele]+[0])>1:    vapor_single_read_score=calcu_vapor_single_read_score_abs_dis_m1b(ref_seq,alt_seq,x,window_size)
 *                                 else:                                                           vapor_single_read_score=calcu_vapor_single_read_score_directed_dis_m1b_redefine_diagnal(ref_seq,alt_seq,x,window_size)             # <<<<<<<<<<<<<<
 *                                 if not 0 in vapor_single_read_score:
 *                                     vapor_score_list.append(1-float(vapor_single_read_score[1])/float(vapor_single_read_score[0]))
 */
                /*else*/ {
                  __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_calcu_vapor_single_read_score_di); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1465, __pyx_L1_error)
                  __Pyx_GOTREF(__pyx_t_3);
                  __pyx_t_14 = NULL;
                  __pyx_t_17 = 0;
                  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_3))) {
                    __pyx_t_14 = PyMethod_GET_SELF(__pyx_t_3);
                    if (likely(__pyx_t_14)) {
                      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
                      __Pyx_INCREF(__pyx_t_14);
                      __Pyx_INCREF(function);
                      __Pyx_DECREF_SET(__pyx_t_3, function);
                      __pyx_t_17 = 1;
                    }
                  }
                  __pyx_t_16 = PyTuple_New(4+__pyx_t_17); if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 1465, __pyx_L1_error)
                  __Pyx_GOTREF(__pyx_t_16);
                  if (__pyx_t_14) {
                    __Pyx_GIVEREF(__pyx_t_14); PyTuple_SET_ITEM(__pyx_t_16, 0, __pyx_t_14); __pyx_t_14 = NULL;
                  }
                  __Pyx_INCREF(__pyx_v_ref_seq);
                  __Pyx_GIVEREF(__pyx_v_ref_seq);
                  PyTuple_SET_ITEM(__pyx_t_16, 0+__pyx_t_17, __pyx_v_ref_seq);
                  __Pyx_INCREF(__pyx_v_alt_seq);
                  __Pyx_GIVEREF(__pyx_v_alt_seq);
                  PyTuple_SET_ITEM(__pyx_t_16, 1+__pyx_t_17, __pyx_v_alt_seq);
                  __Pyx_INCREF(__pyx_v_x);
                  __Pyx_GIVEREF(__pyx_v_x);
                  PyTuple_SET_ITEM(__pyx_t_16, 2+__pyx_t_17, __pyx_v_x);
                  __Pyx_INCREF(__pyx_v_window_size);
                  __Pyx_GIVEREF(__pyx_v_window_size);
                  PyTuple_SET_ITEM(__pyx_t_16, 3+__pyx_t_17, __pyx_v_window_size);
                  __pyx_t_10 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_16, NULL); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1465, __pyx_L1_error)
                  __Pyx_GOTREF(__pyx_t_10);
                  __Pyx_DECREF(__pyx_t_16); __pyx_t_16 = 0;
                  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
                  __Pyx_XDECREF_SET(__pyx_v_vapor_single_read_score, __pyx_t_10);
                  __pyx_t_10 = 0;
                }
                __pyx_L26:;

                /* "vapor_vali/Simple_function.pyx":1466
 *                                 if not max([alt_allele.count(i) for i in alt_allele]+[0])>1:    vapor_single_read_score=calcu_vapor_single_read_score_abs_dis_m1b(ref_seq,alt_seq,x,window_size)
 *                                 else:                                                           vapor_single_read_score=calcu_vapor_single_read_score_directed_dis_m1b_redefine_diagnal(ref_seq,alt_seq,x,window_size)
 *                                 if not 0 in vapor_single_read_score:             # <<<<<<<<<<<<<<
 *                                     vapor_score_list.append(1-float(vapor_single_read_score[1])/float(vapor_single_read_score[0]))
 *                                     if vapor_score_list[-1]==max(vapor_score_list):best_read_rec=x
 */
                __pyx_t_9 = (__Pyx_PySequence_ContainsTF(__pyx_int_0, __pyx_v_vapor_single_read_score, Py_NE)); if (unlikely(__pyx_t_9 < 0)) __PYX_ERR(0, 1466, __pyx_L1_error)
                __pyx_t_8 = (__pyx_t_9 != 0);
                if (__pyx_t_8) {

                  /* "vapor_vali/Simple_function.pyx":1467
 *                                 else:                                                           vapor_single_read_score=calcu_vapor_single_read_score_directed_dis_m1b_redefine_diagnal(ref_seq,alt_seq,x,window_size)
 *                                 if not 0 in vapor_single_read_score:
 *                                     vapor_score_list.append(1-float(vapor_single_read_score[1])/float(vapor_single_read_score[0]))             # <<<<<<<<<<<<<<
 *                                     if vapor_score_list[-1]==max(vapor_score_list):best_read_rec=x
 *                             make_event_figure_1(vapor_score_list,best_read_rec,window_size,ref_seq,alt_seq,'.'.join(out_figure_name.split('.')[:-1]+[ref_sv[0]+'.vs.'+alt_allele,out_figure_name.split('.')[-1]]))
 */
                  __pyx_t_10 = __Pyx_GetItemInt(__pyx_v_vapor_single_read_score, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1467, __pyx_L1_error)
                  __Pyx_GOTREF(__pyx_t_10);
                  __pyx_t_19 = __Pyx_PyObject_AsDouble(__pyx_t_10); if (unlikely(__pyx_t_19 == ((double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1467, __pyx_L1_error)
                  __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
                  __pyx_t_10 = __Pyx_GetItemInt(__pyx_v_vapor_single_read_score, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1467, __pyx_L1_error)
                  __Pyx_GOTREF(__pyx_t_10);
                  __pyx_t_20 = __Pyx_PyObject_AsDouble(__pyx_t_10); if (unlikely(__pyx_t_20 == ((double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1467, __pyx_L1_error)
                  __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
                  if (unlikely(__pyx_t_20 == 0)) {
                    PyErr_SetString(PyExc_ZeroDivisionError, "float division");
                    __PYX_ERR(0, 1467, __pyx_L1_error)
                  }
                  __pyx_t_10 = PyFloat_FromDouble((1.0 - (__pyx_t_19 / __pyx_t_20))); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1467, __pyx_L1_error)
                  __Pyx_GOTREF(__pyx_t_10);
                  __pyx_t_21 = __Pyx_PyList_Append(__pyx_v_vapor_score_list, __pyx_t_10); if (unlikely(__pyx_t_21 == -1)) __PYX_ERR(0, 1467, __pyx_L1_error)
                  __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;

                  /* "vapor_vali/Simple_function.pyx":1468
 *                                 if not 0 in vapor_single_read_score:
 *                                     vapor_score_list.append(1-float(vapor_single_read_score[1])/float(vapor_single_read_score[0]))
 *                                     if vapor_score_list[-1]==max(vapor_score_list):best_read_rec=x             # <<<<<<<<<<<<<<
 *                             make_event_figure_1(vapor_score_list,best_read_rec,window_size,ref_seq,alt_seq,'.'.join(out_figure_name.split('.')[:-1]+[ref_sv[0]+'.vs.'+alt_allele,out_figure_name.split('.')[-1]]))
 *         if run_flag==0:
 */
                  __pyx_t_10 = __Pyx_GetItemInt_List(__pyx_v_vapor_score_list, -1L, long, 1, __Pyx_PyInt_From_long, 1, 1, 1); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1468, __pyx_L1_error)
                  __Pyx_GOTREF(__pyx_t_10);
                  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1468, __pyx_L1_error)
                  __Pyx_GOTREF(__pyx_t_3);
                  __Pyx_INCREF(__pyx_v_vapor_score_list);
                  __Pyx_GIVEREF(__pyx_v_vapor_score_list);
                  PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_v_vapor_score_list);
                  __pyx_t_16 = __Pyx_PyObject_Call(__pyx_builtin_max, __pyx_t_3, NULL); if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 1468, __pyx_L1_error)
                  __Pyx_GOTREF(__pyx_t_16);
                  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
                  __pyx_t_3 = PyObject_RichCompare(__pyx_t_10, __pyx_t_16, Py_EQ); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1468, __pyx_L1_error)
                  __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
                  __Pyx_DECREF(__pyx_t_16); __pyx_t_16 = 0;
                  __pyx_t_8 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_8 < 0)) __PYX_ERR(0, 1468, __pyx_L1_error)
                  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
                  if (__pyx_t_8) {
                    __Pyx_INCREF(__pyx_v_x);
                    __Pyx_DECREF_SET(__pyx_v_best_read_rec, __pyx_v_x);
                  }

                  /* "vapor_vali/Simple_function.pyx":1466
 *                                 if not max([alt_allele.count(i) for i in alt_allele]+[0])>1:    vapor_single_read_score=calcu_vapor_single_read_score_abs_dis_m1b(ref_seq,alt_seq,x,window_size)
 *                                 else:                                                           vapor_single_read_score=calcu_vapor_single_read_score_directed_dis_m1b_redefine_diagnal(ref_seq,alt_seq,x,window_size)
 *                                 if not 0 in vapor_single_read_score:             # <<<<<<<<<<<<<<
 *                                     vapor_score_list.append(1-float(vapor_single_read_score[1])/float(vapor_single_read_score[0]))
 *                                     if vapor_score_list[-1]==max(vapor_score_list):best_read_rec=x
 */
                }

                /* "vapor_vali/Simple_function.pyx":1463
 *                         if not window_size=='Error':
 *                             best_read_rec=''
 *                             for x in all_reads:             # <<<<<<<<<<<<<<
 *                                 if not max([alt_allele.count(i) for i in alt_allele]+[0])>1:    vapor_single_read_score=calcu_vapor_single_read_score_abs_dis_m1b(ref_seq,alt_seq,x,window_size)
 *                                 else:                                                           vapor_single_read_score=calcu_vapor_single_read_score_directed_dis_m1b_redefine_diagnal(ref_seq,alt_seq,x,window_size)
 */
              }
              __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;

              /* "vapor_vali/Simple_function.pyx":1469
 *                                     vapor_score_list.append(1-float(vapor_single_read_score[1])/float(vapor_single_read_score[0]))
 *                                     if vapor_score_list[-1]==max(vapor_score_list):best_read_rec=x
 *                             make_event_figure_1(vapor_score_list,best_read_rec,window_size,ref_seq,alt_seq,'.'.join(out_figure_name.split('.')[:-1]+[ref_sv[0]+'.vs.'+alt_allele,out_figure_name.split('.')[-1]]))             # <<<<<<<<<<<<<<
 *         if run_flag==0:
 *             for alt_allele in alt_sv:
 */
              __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_make_event_figure_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1469, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_3);
              __pyx_t_16 = __Pyx_PyObject_GetAttrStr(__pyx_v_out_figure_name, __pyx_n_s_split); if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 1469, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_16);
              __pyx_t_10 = __Pyx_PyObject_Call(__pyx_t_16, __pyx_tuple__119, NULL); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1469, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_10);
              __Pyx_DECREF(__pyx_t_16); __pyx_t_16 = 0;
              __pyx_t_16 = __Pyx_PyObject_GetSlice(__pyx_t_10, 0, -1L, NULL, NULL, &__pyx_slice__120, 0, 1, 1); if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 1469, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_16);
              __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
              __pyx_t_10 = __Pyx_GetItemInt(__pyx_v_ref_sv, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1469, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_10);
              __pyx_t_14 = PyNumber_Add(__pyx_t_10, __pyx_kp_s_vs); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1469, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_14);
              __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
              __pyx_t_10 = PyNumber_Add(__pyx_t_14, __pyx_v_alt_allele); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1469, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_10);
              __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
              __pyx_t_14 = __Pyx_PyObject_GetAttrStr(__pyx_v_out_figure_name, __pyx_n_s_split); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1469, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_14);
              __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_14, __pyx_tuple__121, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1469, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_4);
              __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
              __pyx_t_14 = __Pyx_GetItemInt(__pyx_t_4, -1L, long, 1, __Pyx_PyInt_From_long, 0, 1, 1); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1469, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_14);
              __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
              __pyx_t_4 = PyList_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1469, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_4);
              __Pyx_GIVEREF(__pyx_t_10);
              PyList_SET_ITEM(__pyx_t_4, 0, __pyx_t_10);
              __Pyx_GIVEREF(__pyx_t_14);
              PyList_SET_ITEM(__pyx_t_4, 1, __pyx_t_14);
              __pyx_t_10 = 0;
              __pyx_t_14 = 0;
              __pyx_t_14 = PyNumber_Add(__pyx_t_16, __pyx_t_4); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1469, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_14);
              __Pyx_DECREF(__pyx_t_16); __pyx_t_16 = 0;
              __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
              __pyx_t_4 = __Pyx_PyString_Join(__pyx_kp_s__19, __pyx_t_14); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1469, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_4);
              __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
              __pyx_t_14 = NULL;
              __pyx_t_13 = 0;
              if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_3))) {
                __pyx_t_14 = PyMethod_GET_SELF(__pyx_t_3);
                if (likely(__pyx_t_14)) {
                  PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
                  __Pyx_INCREF(__pyx_t_14);
                  __Pyx_INCREF(function);
                  __Pyx_DECREF_SET(__pyx_t_3, function);
                  __pyx_t_13 = 1;
                }
              }
              __pyx_t_16 = PyTuple_New(6+__pyx_t_13); if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 1469, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_16);
              if (__pyx_t_14) {
                __Pyx_GIVEREF(__pyx_t_14); PyTuple_SET_ITEM(__pyx_t_16, 0, __pyx_t_14); __pyx_t_14 = NULL;
              }
              __Pyx_INCREF(__pyx_v_vapor_score_list);
              __Pyx_GIVEREF(__pyx_v_vapor_score_list);
              PyTuple_SET_ITEM(__pyx_t_16, 0+__pyx_t_13, __pyx_v_vapor_score_list);
              __Pyx_INCREF(__pyx_v_best_read_rec);
              __Pyx_GIVEREF(__pyx_v_best_read_rec);
              PyTuple_SET_ITEM(__pyx_t_16, 1+__pyx_t_13, __pyx_v_best_read_rec);
              __Pyx_INCREF(__pyx_v_window_size);
              __Pyx_GIVEREF(__pyx_v_window_size);
              PyTuple_SET_ITEM(__pyx_t_16, 2+__pyx_t_13, __pyx_v_window_size);
              __Pyx_INCREF(__pyx_v_ref_seq);
              __Pyx_GIVEREF(__pyx_v_ref_seq);
              PyTuple_SET_ITEM(__pyx_t_16, 3+__pyx_t_13, __pyx_v_ref_seq);
              __Pyx_INCREF(__pyx_v_alt_seq);
              __Pyx_GIVEREF(__pyx_v_alt_seq);
              PyTuple_SET_ITEM(__pyx_t_16, 4+__pyx_t_13, __pyx_v_alt_seq);
              __Pyx_GIVEREF(__pyx_t_4);
              PyTuple_SET_ITEM(__pyx_t_16, 5+__pyx_t_13, __pyx_t_4);
              __pyx_t_4 = 0;
              __pyx_t_11 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_16, NULL); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1469, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_11);
              __Pyx_DECREF(__pyx_t_16); __pyx_t_16 = 0;
              __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
              __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;

              /* "vapor_vali/Simple_function.pyx":1461
 *                         alt_seq+=ref_seq[-flank_length:]
 *                         [window_size,window_size_qc]=window_size_refine(alt_seq)
 *                         if not window_size=='Error':             # <<<<<<<<<<<<<<
 *                             best_read_rec=''
 *                             for x in all_reads:
 */
            }

            /* "vapor_vali/Simple_function.pyx":1454
 *                     for i in list(bp_let_hash.keys()):
 *                         bp_let_seq[i]=ref_seq_readin(ref,bp_let_hash[i][0],int(bp_let_hash[i][1]),int(bp_let_hash[i][-1]))
 *                     for alt_allele in alt_sv:             # <<<<<<<<<<<<<<
 *                         alt_seq=ref_seq[:flank_length]
 *                         for i in letter_split(alt_allele):
 */
          }
          __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

          /* "vapor_vali/Simple_function.pyx":1449
 *                 all_reads=simple_chop_pacbio_read_simple_short(bam_in,bp_info[0],flank_length)
 *                 bp_let_hash=bp_to_chr_hash(bp_info[0],chromos,flank_length)
 *                 if len(all_reads)>5:             # <<<<<<<<<<<<<<
 *                     run_flag+=1
 *                     bp_let_seq={}
 */
        }

        /* "vapor_vali/Simple_function.pyx":1446
 *             ref_seq=ref_seq_readin(ref,bp_info[0][0],bp_info[0][1]-flank_length,bp_info[0][-1]+flank_length)
 *             [window_size,window_size_qc]=window_size_refine(ref_seq)
 *             if not window_size=='Error':             # <<<<<<<<<<<<<<
 *                 all_reads=simple_chop_pacbio_read_simple_short(bam_in,bp_info[0],flank_length)
 *                 bp_let_hash=bp_to_chr_hash(bp_info[0],chromos,flank_length)
 */
      }

      /* "vapor_vali/Simple_function.pyx":1443
 *     run_flag=0
 *     if len(bp_info)==1: #inter-chromosome event not considered here
 *         if bp_info[0][-1]-bp_info[0][1]<default_max_sv_test:             # <<<<<<<<<<<<<<
 *             ref_seq=ref_seq_readin(ref,bp_info[0][0],bp_info[0][1]-flank_length,bp_info[0][-1]+flank_length)
 *             [window_size,window_size_qc]=window_size_refine(ref_seq)
 */
    }

    /* "vapor_vali/Simple_function.pyx":1470
 *                                     if vapor_score_list[-1]==max(vapor_score_list):best_read_rec=x
 *                             make_event_figure_1(vapor_score_list,best_read_rec,window_size,ref_seq,alt_seq,'.'.join(out_figure_name.split('.')[:-1]+[ref_sv[0]+'.vs.'+alt_allele,out_figure_name.split('.')[-1]]))
 *         if run_flag==0:             # <<<<<<<<<<<<<<
 *             for alt_allele in alt_sv:
 *                 alt_juncs=block_around_check(alt_allele,ref_sv[0])
 */
    __pyx_t_2 = __Pyx_PyInt_EqObjC(__pyx_v_run_flag, __pyx_int_0, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1470, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_8 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_8 < 0)) __PYX_ERR(0, 1470, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    if (__pyx_t_8) {

      /* "vapor_vali/Simple_function.pyx":1471
 *                             make_event_figure_1(vapor_score_list,best_read_rec,window_size,ref_seq,alt_seq,'.'.join(out_figure_name.split('.')[:-1]+[ref_sv[0]+'.vs.'+alt_allele,out_figure_name.split('.')[-1]]))
 *         if run_flag==0:
 *             for alt_allele in alt_sv:             # <<<<<<<<<<<<<<
 *                 alt_juncs=block_around_check(alt_allele,ref_sv[0])
 *                 bp_let_hash=bp_to_chr_hash(bp_info[0],chromos,flank_length)
 */
      if (likely(PyList_CheckExact(__pyx_v_alt_sv)) || PyTuple_CheckExact(__pyx_v_alt_sv)) {
        __pyx_t_2 = __pyx_v_alt_sv; __Pyx_INCREF(__pyx_t_2); __pyx_t_6 = 0;
        __pyx_t_7 = NULL;
      } else {
        __pyx_t_6 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_v_alt_sv); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1471, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
        __pyx_t_7 = Py_TYPE(__pyx_t_2)->tp_iternext; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1471, __pyx_L1_error)
      }
      for (;;) {
        if (likely(!__pyx_t_7)) {
          if (likely(PyList_CheckExact(__pyx_t_2))) {
            if (__pyx_t_6 >= PyList_GET_SIZE(__pyx_t_2)) break;
            #if CYTHON_COMPILING_IN_CPYTHON
            __pyx_t_11 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_6); __Pyx_INCREF(__pyx_t_11); __pyx_t_6++; if (unlikely(0 < 0)) __PYX_ERR(0, 1471, __pyx_L1_error)
            #else
            __pyx_t_11 = PySequence_ITEM(__pyx_t_2, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1471, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_11);
            #endif
          } else {
            if (__pyx_t_6 >= PyTuple_GET_SIZE(__pyx_t_2)) break;
            #if CYTHON_COMPILING_IN_CPYTHON
            __pyx_t_11 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_6); __Pyx_INCREF(__pyx_t_11); __pyx_t_6++; if (unlikely(0 < 0)) __PYX_ERR(0, 1471, __pyx_L1_error)
            #else
            __pyx_t_11 = PySequence_ITEM(__pyx_t_2, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1471, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_11);
            #endif
          }
        } else {
          __pyx_t_11 = __pyx_t_7(__pyx_t_2);
          if (unlikely(!__pyx_t_11)) {
            PyObject* exc_type = PyErr_Occurred();
            if (exc_type) {
              if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
              else __PYX_ERR(0, 1471, __pyx_L1_error)
            }
            break;
          }
          __Pyx_GOTREF(__pyx_t_11);
        }
        __Pyx_XDECREF_SET(__pyx_v_alt_allele, __pyx_t_11);
        __pyx_t_11 = 0;

        /* "vapor_vali/Simple_function.pyx":1472
 *         if run_flag==0:
 *             for alt_allele in alt_sv:
 *                 alt_juncs=block_around_check(alt_allele,ref_sv[0])             # <<<<<<<<<<<<<<
 *                 bp_let_hash=bp_to_chr_hash(bp_info[0],chromos,flank_length)
 *                 for alt_jun in alt_juncs:
 */
        __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_block_around_check); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1472, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_3);
        __pyx_t_16 = __Pyx_GetItemInt(__pyx_v_ref_sv, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 1472, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_16);
        __pyx_t_4 = NULL;
        __pyx_t_13 = 0;
        if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_3))) {
          __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
          if (likely(__pyx_t_4)) {
            PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
            __Pyx_INCREF(__pyx_t_4);
            __Pyx_INCREF(function);
            __Pyx_DECREF_SET(__pyx_t_3, function);
            __pyx_t_13 = 1;
          }
        }
        __pyx_t_14 = PyTuple_New(2+__pyx_t_13); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1472, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_14);
        if (__pyx_t_4) {
          __Pyx_GIVEREF(__pyx_t_4); PyTuple_SET_ITEM(__pyx_t_14, 0, __pyx_t_4); __pyx_t_4 = NULL;
        }
        __Pyx_INCREF(__pyx_v_alt_allele);
        __Pyx_GIVEREF(__pyx_v_alt_allele);
        PyTuple_SET_ITEM(__pyx_t_14, 0+__pyx_t_13, __pyx_v_alt_allele);
        __Pyx_GIVEREF(__pyx_t_16);
        PyTuple_SET_ITEM(__pyx_t_14, 1+__pyx_t_13, __pyx_t_16);
        __pyx_t_16 = 0;
        __pyx_t_11 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_14, NULL); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1472, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_11);
        __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
        __Pyx_XDECREF_SET(__pyx_v_alt_juncs, __pyx_t_11);
        __pyx_t_11 = 0;

        /* "vapor_vali/Simple_function.pyx":1473
 *             for alt_allele in alt_sv:
 *                 alt_juncs=block_around_check(alt_allele,ref_sv[0])
 *                 bp_let_hash=bp_to_chr_hash(bp_info[0],chromos,flank_length)             # <<<<<<<<<<<<<<
 *                 for alt_jun in alt_juncs:
 *                     if not '^' in alt_jun[0]:                        ref_seq_a=ref_seq_readin(ref,bp_let_hash[alt_jun[0][0]][0],bp_let_hash[alt_jun[0][0]][2]-flank_length,bp_let_hash[alt_jun[0][0]][2]+flank_length)
 */
        __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_bp_to_chr_hash); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1473, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_3);
        __pyx_t_14 = __Pyx_GetItemInt(__pyx_v_bp_info, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1473, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_14);
        __pyx_t_16 = NULL;
        __pyx_t_13 = 0;
        if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_3))) {
          __pyx_t_16 = PyMethod_GET_SELF(__pyx_t_3);
          if (likely(__pyx_t_16)) {
            PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
            __Pyx_INCREF(__pyx_t_16);
            __Pyx_INCREF(function);
            __Pyx_DECREF_SET(__pyx_t_3, function);
            __pyx_t_13 = 1;
          }
        }
        __pyx_t_4 = PyTuple_New(3+__pyx_t_13); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1473, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_4);
        if (__pyx_t_16) {
          __Pyx_GIVEREF(__pyx_t_16); PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_16); __pyx_t_16 = NULL;
        }
        __Pyx_GIVEREF(__pyx_t_14);
        PyTuple_SET_ITEM(__pyx_t_4, 0+__pyx_t_13, __pyx_t_14);
        __Pyx_INCREF(__pyx_v_chromos);
        __Pyx_GIVEREF(__pyx_v_chromos);
        PyTuple_SET_ITEM(__pyx_t_4, 1+__pyx_t_13, __pyx_v_chromos);
        __Pyx_INCREF(__pyx_v_flank_length);
        __Pyx_GIVEREF(__pyx_v_flank_length);
        PyTuple_SET_ITEM(__pyx_t_4, 2+__pyx_t_13, __pyx_v_flank_length);
        __pyx_t_14 = 0;
        __pyx_t_11 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_4, NULL); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1473, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_11);
        __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
        __Pyx_XDECREF_SET(__pyx_v_bp_let_hash, __pyx_t_11);
        __pyx_t_11 = 0;

        /* "vapor_vali/Simple_function.pyx":1474
 *                 alt_juncs=block_around_check(alt_allele,ref_sv[0])
 *                 bp_let_hash=bp_to_chr_hash(bp_info[0],chromos,flank_length)
 *                 for alt_jun in alt_juncs:             # <<<<<<<<<<<<<<
 *                     if not '^' in alt_jun[0]:                        ref_seq_a=ref_seq_readin(ref,bp_let_hash[alt_jun[0][0]][0],bp_let_hash[alt_jun[0][0]][2]-flank_length,bp_let_hash[alt_jun[0][0]][2]+flank_length)
 *                     else:                                            ref_seq_a=reverse(complementary(ref_seq_readin(ref,bp_let_hash[alt_jun[0][0]][0],bp_let_hash[alt_jun[0][0]][1]-flank_length,bp_let_hash[alt_jun[0][0]][1]+flank_length)))
 */
        if (likely(PyList_CheckExact(__pyx_v_alt_juncs)) || PyTuple_CheckExact(__pyx_v_alt_juncs)) {
          __pyx_t_11 = __pyx_v_alt_juncs; __Pyx_INCREF(__pyx_t_11); __pyx_t_13 = 0;
          __pyx_t_15 = NULL;
        } else {
          __pyx_t_13 = -1; __pyx_t_11 = PyObject_GetIter(__pyx_v_alt_juncs); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1474, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_11);
          __pyx_t_15 = Py_TYPE(__pyx_t_11)->tp_iternext; if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1474, __pyx_L1_error)
        }
        for (;;) {
          if (likely(!__pyx_t_15)) {
            if (likely(PyList_CheckExact(__pyx_t_11))) {
              if (__pyx_t_13 >= PyList_GET_SIZE(__pyx_t_11)) break;
              #if CYTHON_COMPILING_IN_CPYTHON
              __pyx_t_3 = PyList_GET_ITEM(__pyx_t_11, __pyx_t_13); __Pyx_INCREF(__pyx_t_3); __pyx_t_13++; if (unlikely(0 < 0)) __PYX_ERR(0, 1474, __pyx_L1_error)
              #else
              __pyx_t_3 = PySequence_ITEM(__pyx_t_11, __pyx_t_13); __pyx_t_13++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1474, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_3);
              #endif
            } else {
              if (__pyx_t_13 >= PyTuple_GET_SIZE(__pyx_t_11)) break;
              #if CYTHON_COMPILING_IN_CPYTHON
              __pyx_t_3 = PyTuple_GET_ITEM(__pyx_t_11, __pyx_t_13); __Pyx_INCREF(__pyx_t_3); __pyx_t_13++; if (unlikely(0 < 0)) __PYX_ERR(0, 1474, __pyx_L1_error)
              #else
              __pyx_t_3 = PySequence_ITEM(__pyx_t_11, __pyx_t_13); __pyx_t_13++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1474, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_3);
              #endif
            }
          } else {
            __pyx_t_3 = __pyx_t_15(__pyx_t_11);
            if (unlikely(!__pyx_t_3)) {
              PyObject* exc_type = PyErr_Occurred();
              if (exc_type) {
                if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
                else __PYX_ERR(0, 1474, __pyx_L1_error)
              }
              break;
            }
            __Pyx_GOTREF(__pyx_t_3);
          }
          __Pyx_XDECREF_SET(__pyx_v_alt_jun, __pyx_t_3);
          __pyx_t_3 = 0;

          /* "vapor_vali/Simple_function.pyx":1475
 *                 bp_let_hash=bp_to_chr_hash(bp_info[0],chromos,flank_length)
 *                 for alt_jun in alt_juncs:
 *                     if not '^' in alt_jun[0]:                        ref_seq_a=ref_seq_readin(ref,bp_let_hash[alt_jun[0][0]][0],bp_let_hash[alt_jun[0][0]][2]-flank_length,bp_let_hash[alt_jun[0][0]][2]+flank_length)             # <<<<<<<<<<<<<<
 *                     else:                                            ref_seq_a=reverse(complementary(ref_seq_readin(ref,bp_let_hash[alt_jun[0][0]][0],bp_let_hash[alt_jun[0][0]][1]-flank_length,bp_let_hash[alt_jun[0][0]][1]+flank_length)))
 *                     if not '^' in alt_jun[1]:                        ref_seq_b=ref_seq_readin(ref,bp_let_hash[alt_jun[1][0]][0],bp_let_hash[alt_jun[1][0]][1]-flank_length,bp_let_hash[alt_jun[1][0]][1]+flank_length)
 */
          __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_alt_jun, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1475, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_3);
          __pyx_t_8 = (__Pyx_PySequence_ContainsTF(__pyx_kp_s__7, __pyx_t_3, Py_NE)); if (unlikely(__pyx_t_8 < 0)) __PYX_ERR(0, 1475, __pyx_L1_error)
          __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
          __pyx_t_9 = (__pyx_t_8 != 0);
          if (__pyx_t_9) {
            __pyx_t_4 = __Pyx_GetModuleGlobalName(__pyx_n_s_ref_seq_readin); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1475, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_4);
            __pyx_t_14 = __Pyx_GetItemInt(__pyx_v_alt_jun, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1475, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_14);
            __pyx_t_16 = __Pyx_GetItemInt(__pyx_t_14, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 1475, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_16);
            __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
            __pyx_t_14 = PyObject_GetItem(__pyx_v_bp_let_hash, __pyx_t_16); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1475, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_14);
            __Pyx_DECREF(__pyx_t_16); __pyx_t_16 = 0;
            __pyx_t_16 = __Pyx_GetItemInt(__pyx_t_14, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 1475, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_16);
            __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
            __pyx_t_14 = __Pyx_GetItemInt(__pyx_v_alt_jun, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1475, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_14);
            __pyx_t_10 = __Pyx_GetItemInt(__pyx_t_14, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1475, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_10);
            __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
            __pyx_t_14 = PyObject_GetItem(__pyx_v_bp_let_hash, __pyx_t_10); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1475, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_14);
            __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
            __pyx_t_10 = __Pyx_GetItemInt(__pyx_t_14, 2, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1475, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_10);
            __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
            __pyx_t_14 = PyNumber_Subtract(__pyx_t_10, __pyx_v_flank_length); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1475, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_14);
            __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
            __pyx_t_10 = __Pyx_GetItemInt(__pyx_v_alt_jun, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1475, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_10);
            __pyx_t_1 = __Pyx_GetItemInt(__pyx_t_10, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1475, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_1);
            __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
            __pyx_t_10 = PyObject_GetItem(__pyx_v_bp_let_hash, __pyx_t_1); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1475, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_10);
            __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
            __pyx_t_1 = __Pyx_GetItemInt(__pyx_t_10, 2, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1475, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_1);
            __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
            __pyx_t_10 = PyNumber_Add(__pyx_t_1, __pyx_v_flank_length); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1475, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_10);
            __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
            __pyx_t_1 = NULL;
            __pyx_t_17 = 0;
            if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_4))) {
              __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_4);
              if (likely(__pyx_t_1)) {
                PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
                __Pyx_INCREF(__pyx_t_1);
                __Pyx_INCREF(function);
                __Pyx_DECREF_SET(__pyx_t_4, function);
                __pyx_t_17 = 1;
              }
            }
            __pyx_t_5 = PyTuple_New(4+__pyx_t_17); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1475, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_5);
            if (__pyx_t_1) {
              __Pyx_GIVEREF(__pyx_t_1); PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_1); __pyx_t_1 = NULL;
            }
            __Pyx_INCREF(__pyx_v_ref);
            __Pyx_GIVEREF(__pyx_v_ref);
            PyTuple_SET_ITEM(__pyx_t_5, 0+__pyx_t_17, __pyx_v_ref);
            __Pyx_GIVEREF(__pyx_t_16);
            PyTuple_SET_ITEM(__pyx_t_5, 1+__pyx_t_17, __pyx_t_16);
            __Pyx_GIVEREF(__pyx_t_14);
            PyTuple_SET_ITEM(__pyx_t_5, 2+__pyx_t_17, __pyx_t_14);
            __Pyx_GIVEREF(__pyx_t_10);
            PyTuple_SET_ITEM(__pyx_t_5, 3+__pyx_t_17, __pyx_t_10);
            __pyx_t_16 = 0;
            __pyx_t_14 = 0;
            __pyx_t_10 = 0;
            __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_5, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1475, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_3);
            __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
            __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
            __Pyx_XDECREF_SET(__pyx_v_ref_seq_a, __pyx_t_3);
            __pyx_t_3 = 0;
            goto __pyx_L36;
          }

          /* "vapor_vali/Simple_function.pyx":1476
 *                 for alt_jun in alt_juncs:
 *                     if not '^' in alt_jun[0]:                        ref_seq_a=ref_seq_readin(ref,bp_let_hash[alt_jun[0][0]][0],bp_let_hash[alt_jun[0][0]][2]-flank_length,bp_let_hash[alt_jun[0][0]][2]+flank_length)
 *                     else:                                            ref_seq_a=reverse(complementary(ref_seq_readin(ref,bp_let_hash[alt_jun[0][0]][0],bp_let_hash[alt_jun[0][0]][1]-flank_length,bp_let_hash[alt_jun[0][0]][1]+flank_length)))             # <<<<<<<<<<<<<<
 *                     if not '^' in alt_jun[1]:                        ref_seq_b=ref_seq_readin(ref,bp_let_hash[alt_jun[1][0]][0],bp_let_hash[alt_jun[1][0]][1]-flank_length,bp_let_hash[alt_jun[1][0]][1]+flank_length)
 *                     else:                                            ref_seq_b=reverse(complementary(ref_seq_readin(ref,bp_let_hash[alt_jun[1][0]][0],bp_let_hash[alt_jun[1][0]][2]-flank_length,bp_let_hash[alt_jun[1][0]][2]+flank_length)))
 */
          /*else*/ {
            __pyx_t_4 = __Pyx_GetModuleGlobalName(__pyx_n_s_reverse); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1476, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_4);
            __pyx_t_10 = __Pyx_GetModuleGlobalName(__pyx_n_s_complementary); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1476, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_10);
            __pyx_t_16 = __Pyx_GetModuleGlobalName(__pyx_n_s_ref_seq_readin); if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 1476, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_16);
            __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_alt_jun, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1476, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_1);
            __pyx_t_22 = __Pyx_GetItemInt(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_22)) __PYX_ERR(0, 1476, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_22);
            __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
            __pyx_t_1 = PyObject_GetItem(__pyx_v_bp_let_hash, __pyx_t_22); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1476, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_1);
            __Pyx_DECREF(__pyx_t_22); __pyx_t_22 = 0;
            __pyx_t_22 = __Pyx_GetItemInt(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_22)) __PYX_ERR(0, 1476, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_22);
            __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
            __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_alt_jun, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1476, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_1);
            __pyx_t_23 = __Pyx_GetItemInt(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_23)) __PYX_ERR(0, 1476, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_23);
            __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
            __pyx_t_1 = PyObject_GetItem(__pyx_v_bp_let_hash, __pyx_t_23); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1476, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_1);
            __Pyx_DECREF(__pyx_t_23); __pyx_t_23 = 0;
            __pyx_t_23 = __Pyx_GetItemInt(__pyx_t_1, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_23)) __PYX_ERR(0, 1476, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_23);
            __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
            __pyx_t_1 = PyNumber_Subtract(__pyx_t_23, __pyx_v_flank_length); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1476, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_1);
            __Pyx_DECREF(__pyx_t_23); __pyx_t_23 = 0;
            __pyx_t_23 = __Pyx_GetItemInt(__pyx_v_alt_jun, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_23)) __PYX_ERR(0, 1476, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_23);
            __pyx_t_24 = __Pyx_GetItemInt(__pyx_t_23, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_24)) __PYX_ERR(0, 1476, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_24);
            __Pyx_DECREF(__pyx_t_23); __pyx_t_23 = 0;
            __pyx_t_23 = PyObject_GetItem(__pyx_v_bp_let_hash, __pyx_t_24); if (unlikely(!__pyx_t_23)) __PYX_ERR(0, 1476, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_23);
            __Pyx_DECREF(__pyx_t_24); __pyx_t_24 = 0;
            __pyx_t_24 = __Pyx_GetItemInt(__pyx_t_23, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_24)) __PYX_ERR(0, 1476, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_24);
            __Pyx_DECREF(__pyx_t_23); __pyx_t_23 = 0;
            __pyx_t_23 = PyNumber_Add(__pyx_t_24, __pyx_v_flank_length); if (unlikely(!__pyx_t_23)) __PYX_ERR(0, 1476, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_23);
            __Pyx_DECREF(__pyx_t_24); __pyx_t_24 = 0;
            __pyx_t_24 = NULL;
            __pyx_t_17 = 0;
            if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_16))) {
              __pyx_t_24 = PyMethod_GET_SELF(__pyx_t_16);
              if (likely(__pyx_t_24)) {
                PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_16);
                __Pyx_INCREF(__pyx_t_24);
                __Pyx_INCREF(function);
                __Pyx_DECREF_SET(__pyx_t_16, function);
                __pyx_t_17 = 1;
              }
            }
            __pyx_t_25 = PyTuple_New(4+__pyx_t_17); if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 1476, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_25);
            if (__pyx_t_24) {
              __Pyx_GIVEREF(__pyx_t_24); PyTuple_SET_ITEM(__pyx_t_25, 0, __pyx_t_24); __pyx_t_24 = NULL;
            }
            __Pyx_INCREF(__pyx_v_ref);
            __Pyx_GIVEREF(__pyx_v_ref);
            PyTuple_SET_ITEM(__pyx_t_25, 0+__pyx_t_17, __pyx_v_ref);
            __Pyx_GIVEREF(__pyx_t_22);
            PyTuple_SET_ITEM(__pyx_t_25, 1+__pyx_t_17, __pyx_t_22);
            __Pyx_GIVEREF(__pyx_t_1);
            PyTuple_SET_ITEM(__pyx_t_25, 2+__pyx_t_17, __pyx_t_1);
            __Pyx_GIVEREF(__pyx_t_23);
            PyTuple_SET_ITEM(__pyx_t_25, 3+__pyx_t_17, __pyx_t_23);
            __pyx_t_22 = 0;
            __pyx_t_1 = 0;
            __pyx_t_23 = 0;
            __pyx_t_14 = __Pyx_PyObject_Call(__pyx_t_16, __pyx_t_25, NULL); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1476, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_14);
            __Pyx_DECREF(__pyx_t_25); __pyx_t_25 = 0;
            __Pyx_DECREF(__pyx_t_16); __pyx_t_16 = 0;
            __pyx_t_16 = NULL;
            if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_10))) {
              __pyx_t_16 = PyMethod_GET_SELF(__pyx_t_10);
              if (likely(__pyx_t_16)) {
                PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_10);
                __Pyx_INCREF(__pyx_t_16);
                __Pyx_INCREF(function);
                __Pyx_DECREF_SET(__pyx_t_10, function);
              }
            }
            if (!__pyx_t_16) {
              __pyx_t_5 = __Pyx_PyObject_CallOneArg(__pyx_t_10, __pyx_t_14); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1476, __pyx_L1_error)
              __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
              __Pyx_GOTREF(__pyx_t_5);
            } else {
              __pyx_t_25 = PyTuple_New(1+1); if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 1476, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_25);
              __Pyx_GIVEREF(__pyx_t_16); PyTuple_SET_ITEM(__pyx_t_25, 0, __pyx_t_16); __pyx_t_16 = NULL;
              __Pyx_GIVEREF(__pyx_t_14);
              PyTuple_SET_ITEM(__pyx_t_25, 0+1, __pyx_t_14);
              __pyx_t_14 = 0;
              __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_10, __pyx_t_25, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1476, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_5);
              __Pyx_DECREF(__pyx_t_25); __pyx_t_25 = 0;
            }
            __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
            __pyx_t_10 = NULL;
            if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_4))) {
              __pyx_t_10 = PyMethod_GET_SELF(__pyx_t_4);
              if (likely(__pyx_t_10)) {
                PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
                __Pyx_INCREF(__pyx_t_10);
                __Pyx_INCREF(function);
                __Pyx_DECREF_SET(__pyx_t_4, function);
              }
            }
            if (!__pyx_t_10) {
              __pyx_t_3 = __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_5); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1476, __pyx_L1_error)
              __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
              __Pyx_GOTREF(__pyx_t_3);
            } else {
              __pyx_t_25 = PyTuple_New(1+1); if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 1476, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_25);
              __Pyx_GIVEREF(__pyx_t_10); PyTuple_SET_ITEM(__pyx_t_25, 0, __pyx_t_10); __pyx_t_10 = NULL;
              __Pyx_GIVEREF(__pyx_t_5);
              PyTuple_SET_ITEM(__pyx_t_25, 0+1, __pyx_t_5);
              __pyx_t_5 = 0;
              __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_25, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1476, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_3);
              __Pyx_DECREF(__pyx_t_25); __pyx_t_25 = 0;
            }
            __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
            __Pyx_XDECREF_SET(__pyx_v_ref_seq_a, __pyx_t_3);
            __pyx_t_3 = 0;
          }
          __pyx_L36:;

          /* "vapor_vali/Simple_function.pyx":1477
 *                     if not '^' in alt_jun[0]:                        ref_seq_a=ref_seq_readin(ref,bp_let_hash[alt_jun[0][0]][0],bp_let_hash[alt_jun[0][0]][2]-flank_length,bp_let_hash[alt_jun[0][0]][2]+flank_length)
 *                     else:                                            ref_seq_a=reverse(complementary(ref_seq_readin(ref,bp_let_hash[alt_jun[0][0]][0],bp_let_hash[alt_jun[0][0]][1]-flank_length,bp_let_hash[alt_jun[0][0]][1]+flank_length)))
 *                     if not '^' in alt_jun[1]:                        ref_seq_b=ref_seq_readin(ref,bp_let_hash[alt_jun[1][0]][0],bp_let_hash[alt_jun[1][0]][1]-flank_length,bp_let_hash[alt_jun[1][0]][1]+flank_length)             # <<<<<<<<<<<<<<
 *                     else:                                            ref_seq_b=reverse(complementary(ref_seq_readin(ref,bp_let_hash[alt_jun[1][0]][0],bp_let_hash[alt_jun[1][0]][2]-flank_length,bp_let_hash[alt_jun[1][0]][2]+flank_length)))
 *                     [window_size,window_size_qc]=window_size_refine(ref_seq_a+ref_seq_b)
 */
          __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_alt_jun, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1477, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_3);
          __pyx_t_9 = (__Pyx_PySequence_ContainsTF(__pyx_kp_s__7, __pyx_t_3, Py_NE)); if (unlikely(__pyx_t_9 < 0)) __PYX_ERR(0, 1477, __pyx_L1_error)
          __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
          __pyx_t_8 = (__pyx_t_9 != 0);
          if (__pyx_t_8) {
            __pyx_t_4 = __Pyx_GetModuleGlobalName(__pyx_n_s_ref_seq_readin); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1477, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_4);
            __pyx_t_25 = __Pyx_GetItemInt(__pyx_v_alt_jun, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 1477, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_25);
            __pyx_t_5 = __Pyx_GetItemInt(__pyx_t_25, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1477, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_5);
            __Pyx_DECREF(__pyx_t_25); __pyx_t_25 = 0;
            __pyx_t_25 = PyObject_GetItem(__pyx_v_bp_let_hash, __pyx_t_5); if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 1477, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_25);
            __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
            __pyx_t_5 = __Pyx_GetItemInt(__pyx_t_25, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1477, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_5);
            __Pyx_DECREF(__pyx_t_25); __pyx_t_25 = 0;
            __pyx_t_25 = __Pyx_GetItemInt(__pyx_v_alt_jun, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 1477, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_25);
            __pyx_t_10 = __Pyx_GetItemInt(__pyx_t_25, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1477, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_10);
            __Pyx_DECREF(__pyx_t_25); __pyx_t_25 = 0;
            __pyx_t_25 = PyObject_GetItem(__pyx_v_bp_let_hash, __pyx_t_10); if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 1477, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_25);
            __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
            __pyx_t_10 = __Pyx_GetItemInt(__pyx_t_25, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1477, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_10);
            __Pyx_DECREF(__pyx_t_25); __pyx_t_25 = 0;
            __pyx_t_25 = PyNumber_Subtract(__pyx_t_10, __pyx_v_flank_length); if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 1477, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_25);
            __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
            __pyx_t_10 = __Pyx_GetItemInt(__pyx_v_alt_jun, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1477, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_10);
            __pyx_t_14 = __Pyx_GetItemInt(__pyx_t_10, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1477, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_14);
            __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
            __pyx_t_10 = PyObject_GetItem(__pyx_v_bp_let_hash, __pyx_t_14); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1477, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_10);
            __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
            __pyx_t_14 = __Pyx_GetItemInt(__pyx_t_10, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1477, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_14);
            __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
            __pyx_t_10 = PyNumber_Add(__pyx_t_14, __pyx_v_flank_length); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1477, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_10);
            __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
            __pyx_t_14 = NULL;
            __pyx_t_17 = 0;
            if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_4))) {
              __pyx_t_14 = PyMethod_GET_SELF(__pyx_t_4);
              if (likely(__pyx_t_14)) {
                PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
                __Pyx_INCREF(__pyx_t_14);
                __Pyx_INCREF(function);
                __Pyx_DECREF_SET(__pyx_t_4, function);
                __pyx_t_17 = 1;
              }
            }
            __pyx_t_16 = PyTuple_New(4+__pyx_t_17); if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 1477, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_16);
            if (__pyx_t_14) {
              __Pyx_GIVEREF(__pyx_t_14); PyTuple_SET_ITEM(__pyx_t_16, 0, __pyx_t_14); __pyx_t_14 = NULL;
            }
            __Pyx_INCREF(__pyx_v_ref);
            __Pyx_GIVEREF(__pyx_v_ref);
            PyTuple_SET_ITEM(__pyx_t_16, 0+__pyx_t_17, __pyx_v_ref);
            __Pyx_GIVEREF(__pyx_t_5);
            PyTuple_SET_ITEM(__pyx_t_16, 1+__pyx_t_17, __pyx_t_5);
            __Pyx_GIVEREF(__pyx_t_25);
            PyTuple_SET_ITEM(__pyx_t_16, 2+__pyx_t_17, __pyx_t_25);
            __Pyx_GIVEREF(__pyx_t_10);
            PyTuple_SET_ITEM(__pyx_t_16, 3+__pyx_t_17, __pyx_t_10);
            __pyx_t_5 = 0;
            __pyx_t_25 = 0;
            __pyx_t_10 = 0;
            __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_16, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1477, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_3);
            __Pyx_DECREF(__pyx_t_16); __pyx_t_16 = 0;
            __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
            __Pyx_XDECREF_SET(__pyx_v_ref_seq_b, __pyx_t_3);
            __pyx_t_3 = 0;
            goto __pyx_L37;
          }

          /* "vapor_vali/Simple_function.pyx":1478
 *                     else:                                            ref_seq_a=reverse(complementary(ref_seq_readin(ref,bp_let_hash[alt_jun[0][0]][0],bp_let_hash[alt_jun[0][0]][1]-flank_length,bp_let_hash[alt_jun[0][0]][1]+flank_length)))
 *                     if not '^' in alt_jun[1]:                        ref_seq_b=ref_seq_readin(ref,bp_let_hash[alt_jun[1][0]][0],bp_let_hash[alt_jun[1][0]][1]-flank_length,bp_let_hash[alt_jun[1][0]][1]+flank_length)
 *                     else:                                            ref_seq_b=reverse(complementary(ref_seq_readin(ref,bp_let_hash[alt_jun[1][0]][0],bp_let_hash[alt_jun[1][0]][2]-flank_length,bp_let_hash[alt_jun[1][0]][2]+flank_length)))             # <<<<<<<<<<<<<<
 *                     [window_size,window_size_qc]=window_size_refine(ref_seq_a+ref_seq_b)
 *                     if not window_size=='Error':
 */
          /*else*/ {
            __pyx_t_4 = __Pyx_GetModuleGlobalName(__pyx_n_s_reverse); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1478, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_4);
            __pyx_t_10 = __Pyx_GetModuleGlobalName(__pyx_n_s_complementary); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1478, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_10);
            __pyx_t_5 = __Pyx_GetModuleGlobalName(__pyx_n_s_ref_seq_readin); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1478, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_5);
            __pyx_t_14 = __Pyx_GetItemInt(__pyx_v_alt_jun, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1478, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_14);
            __pyx_t_23 = __Pyx_GetItemInt(__pyx_t_14, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_23)) __PYX_ERR(0, 1478, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_23);
            __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
            __pyx_t_14 = PyObject_GetItem(__pyx_v_bp_let_hash, __pyx_t_23); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1478, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_14);
            __Pyx_DECREF(__pyx_t_23); __pyx_t_23 = 0;
            __pyx_t_23 = __Pyx_GetItemInt(__pyx_t_14, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_23)) __PYX_ERR(0, 1478, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_23);
            __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
            __pyx_t_14 = __Pyx_GetItemInt(__pyx_v_alt_jun, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1478, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_14);
            __pyx_t_1 = __Pyx_GetItemInt(__pyx_t_14, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1478, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_1);
            __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
            __pyx_t_14 = PyObject_GetItem(__pyx_v_bp_let_hash, __pyx_t_1); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1478, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_14);
            __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
            __pyx_t_1 = __Pyx_GetItemInt(__pyx_t_14, 2, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1478, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_1);
            __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
            __pyx_t_14 = PyNumber_Subtract(__pyx_t_1, __pyx_v_flank_length); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1478, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_14);
            __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
            __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_alt_jun, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1478, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_1);
            __pyx_t_22 = __Pyx_GetItemInt(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_22)) __PYX_ERR(0, 1478, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_22);
            __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
            __pyx_t_1 = PyObject_GetItem(__pyx_v_bp_let_hash, __pyx_t_22); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1478, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_1);
            __Pyx_DECREF(__pyx_t_22); __pyx_t_22 = 0;
            __pyx_t_22 = __Pyx_GetItemInt(__pyx_t_1, 2, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_22)) __PYX_ERR(0, 1478, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_22);
            __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
            __pyx_t_1 = PyNumber_Add(__pyx_t_22, __pyx_v_flank_length); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1478, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_1);
            __Pyx_DECREF(__pyx_t_22); __pyx_t_22 = 0;
            __pyx_t_22 = NULL;
            __pyx_t_17 = 0;
            if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_5))) {
              __pyx_t_22 = PyMethod_GET_SELF(__pyx_t_5);
              if (likely(__pyx_t_22)) {
                PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
                __Pyx_INCREF(__pyx_t_22);
                __Pyx_INCREF(function);
                __Pyx_DECREF_SET(__pyx_t_5, function);
                __pyx_t_17 = 1;
              }
            }
            __pyx_t_24 = PyTuple_New(4+__pyx_t_17); if (unlikely(!__pyx_t_24)) __PYX_ERR(0, 1478, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_24);
            if (__pyx_t_22) {
              __Pyx_GIVEREF(__pyx_t_22); PyTuple_SET_ITEM(__pyx_t_24, 0, __pyx_t_22); __pyx_t_22 = NULL;
            }
            __Pyx_INCREF(__pyx_v_ref);
            __Pyx_GIVEREF(__pyx_v_ref);
            PyTuple_SET_ITEM(__pyx_t_24, 0+__pyx_t_17, __pyx_v_ref);
            __Pyx_GIVEREF(__pyx_t_23);
            PyTuple_SET_ITEM(__pyx_t_24, 1+__pyx_t_17, __pyx_t_23);
            __Pyx_GIVEREF(__pyx_t_14);
            PyTuple_SET_ITEM(__pyx_t_24, 2+__pyx_t_17, __pyx_t_14);
            __Pyx_GIVEREF(__pyx_t_1);
            PyTuple_SET_ITEM(__pyx_t_24, 3+__pyx_t_17, __pyx_t_1);
            __pyx_t_23 = 0;
            __pyx_t_14 = 0;
            __pyx_t_1 = 0;
            __pyx_t_25 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_24, NULL); if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 1478, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_25);
            __Pyx_DECREF(__pyx_t_24); __pyx_t_24 = 0;
            __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
            __pyx_t_5 = NULL;
            if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_10))) {
              __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_10);
              if (likely(__pyx_t_5)) {
                PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_10);
                __Pyx_INCREF(__pyx_t_5);
                __Pyx_INCREF(function);
                __Pyx_DECREF_SET(__pyx_t_10, function);
              }
            }
            if (!__pyx_t_5) {
              __pyx_t_16 = __Pyx_PyObject_CallOneArg(__pyx_t_10, __pyx_t_25); if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 1478, __pyx_L1_error)
              __Pyx_DECREF(__pyx_t_25); __pyx_t_25 = 0;
              __Pyx_GOTREF(__pyx_t_16);
            } else {
              __pyx_t_24 = PyTuple_New(1+1); if (unlikely(!__pyx_t_24)) __PYX_ERR(0, 1478, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_24);
              __Pyx_GIVEREF(__pyx_t_5); PyTuple_SET_ITEM(__pyx_t_24, 0, __pyx_t_5); __pyx_t_5 = NULL;
              __Pyx_GIVEREF(__pyx_t_25);
              PyTuple_SET_ITEM(__pyx_t_24, 0+1, __pyx_t_25);
              __pyx_t_25 = 0;
              __pyx_t_16 = __Pyx_PyObject_Call(__pyx_t_10, __pyx_t_24, NULL); if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 1478, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_16);
              __Pyx_DECREF(__pyx_t_24); __pyx_t_24 = 0;
            }
            __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
            __pyx_t_10 = NULL;
            if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_4))) {
              __pyx_t_10 = PyMethod_GET_SELF(__pyx_t_4);
              if (likely(__pyx_t_10)) {
                PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
                __Pyx_INCREF(__pyx_t_10);
                __Pyx_INCREF(function);
                __Pyx_DECREF_SET(__pyx_t_4, function);
              }
            }
            if (!__pyx_t_10) {
              __pyx_t_3 = __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_16); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1478, __pyx_L1_error)
              __Pyx_DECREF(__pyx_t_16); __pyx_t_16 = 0;
              __Pyx_GOTREF(__pyx_t_3);
            } else {
              __pyx_t_24 = PyTuple_New(1+1); if (unlikely(!__pyx_t_24)) __PYX_ERR(0, 1478, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_24);
              __Pyx_GIVEREF(__pyx_t_10); PyTuple_SET_ITEM(__pyx_t_24, 0, __pyx_t_10); __pyx_t_10 = NULL;
              __Pyx_GIVEREF(__pyx_t_16);
              PyTuple_SET_ITEM(__pyx_t_24, 0+1, __pyx_t_16);
              __pyx_t_16 = 0;
              __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_24, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1478, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_3);
              __Pyx_DECREF(__pyx_t_24); __pyx_t_24 = 0;
            }
            __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
            __Pyx_XDECREF_SET(__pyx_v_ref_seq_b, __pyx_t_3);
            __pyx_t_3 = 0;
          }
          __pyx_L37:;

          /* "vapor_vali/Simple_function.pyx":1479
 *                     if not '^' in alt_jun[1]:                        ref_seq_b=ref_seq_readin(ref,bp_let_hash[alt_jun[1][0]][0],bp_let_hash[alt_jun[1][0]][1]-flank_length,bp_let_hash[alt_jun[1][0]][1]+flank_length)
 *                     else:                                            ref_seq_b=reverse(complementary(ref_seq_readin(ref,bp_let_hash[alt_jun[1][0]][0],bp_let_hash[alt_jun[1][0]][2]-flank_length,bp_let_hash[alt_jun[1][0]][2]+flank_length)))
 *                     [window_size,window_size_qc]=window_size_refine(ref_seq_a+ref_seq_b)             # <<<<<<<<<<<<<<
 *                     if not window_size=='Error':
 *                         alt_seq=ref_seq_a[-flank_length:]+ref_seq_b[:flank_length]
 */
          __pyx_t_4 = __Pyx_GetModuleGlobalName(__pyx_n_s_window_size_refine); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1479, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_4);
          __pyx_t_24 = PyNumber_Add(__pyx_v_ref_seq_a, __pyx_v_ref_seq_b); if (unlikely(!__pyx_t_24)) __PYX_ERR(0, 1479, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_24);
          __pyx_t_16 = NULL;
          if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_4))) {
            __pyx_t_16 = PyMethod_GET_SELF(__pyx_t_4);
            if (likely(__pyx_t_16)) {
              PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
              __Pyx_INCREF(__pyx_t_16);
              __Pyx_INCREF(function);
              __Pyx_DECREF_SET(__pyx_t_4, function);
            }
          }
          if (!__pyx_t_16) {
            __pyx_t_3 = __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_24); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1479, __pyx_L1_error)
            __Pyx_DECREF(__pyx_t_24); __pyx_t_24 = 0;
            __Pyx_GOTREF(__pyx_t_3);
          } else {
            __pyx_t_10 = PyTuple_New(1+1); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1479, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_10);
            __Pyx_GIVEREF(__pyx_t_16); PyTuple_SET_ITEM(__pyx_t_10, 0, __pyx_t_16); __pyx_t_16 = NULL;
            __Pyx_GIVEREF(__pyx_t_24);
            PyTuple_SET_ITEM(__pyx_t_10, 0+1, __pyx_t_24);
            __pyx_t_24 = 0;
            __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_10, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1479, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_3);
            __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
          }
          __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
          if ((likely(PyTuple_CheckExact(__pyx_t_3))) || (PyList_CheckExact(__pyx_t_3))) {
            PyObject* sequence = __pyx_t_3;
            #if CYTHON_COMPILING_IN_CPYTHON
            Py_ssize_t size = Py_SIZE(sequence);
            #else
            Py_ssize_t size = PySequence_Size(sequence);
            #endif
            if (unlikely(size != 2)) {
              if (size > 2) __Pyx_RaiseTooManyValuesError(2);
              else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
              __PYX_ERR(0, 1479, __pyx_L1_error)
            }
            #if CYTHON_COMPILING_IN_CPYTHON
            if (likely(PyTuple_CheckExact(sequence))) {
              __pyx_t_4 = PyTuple_GET_ITEM(sequence, 0); 
              __pyx_t_10 = PyTuple_GET_ITEM(sequence, 1); 
            } else {
              __pyx_t_4 = PyList_GET_ITEM(sequence, 0); 
              __pyx_t_10 = PyList_GET_ITEM(sequence, 1); 
            }
            __Pyx_INCREF(__pyx_t_4);
            __Pyx_INCREF(__pyx_t_10);
            #else
            __pyx_t_4 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1479, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_4);
            __pyx_t_10 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1479, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_10);
            #endif
            __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
          } else {
            Py_ssize_t index = -1;
            __pyx_t_24 = PyObject_GetIter(__pyx_t_3); if (unlikely(!__pyx_t_24)) __PYX_ERR(0, 1479, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_24);
            __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
            __pyx_t_12 = Py_TYPE(__pyx_t_24)->tp_iternext;
            index = 0; __pyx_t_4 = __pyx_t_12(__pyx_t_24); if (unlikely(!__pyx_t_4)) goto __pyx_L38_unpacking_failed;
            __Pyx_GOTREF(__pyx_t_4);
            index = 1; __pyx_t_10 = __pyx_t_12(__pyx_t_24); if (unlikely(!__pyx_t_10)) goto __pyx_L38_unpacking_failed;
            __Pyx_GOTREF(__pyx_t_10);
            if (__Pyx_IternextUnpackEndCheck(__pyx_t_12(__pyx_t_24), 2) < 0) __PYX_ERR(0, 1479, __pyx_L1_error)
            __pyx_t_12 = NULL;
            __Pyx_DECREF(__pyx_t_24); __pyx_t_24 = 0;
            goto __pyx_L39_unpacking_done;
            __pyx_L38_unpacking_failed:;
            __Pyx_DECREF(__pyx_t_24); __pyx_t_24 = 0;
            __pyx_t_12 = NULL;
            if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
            __PYX_ERR(0, 1479, __pyx_L1_error)
            __pyx_L39_unpacking_done:;
          }
          __Pyx_XDECREF_SET(__pyx_v_window_size, __pyx_t_4);
          __pyx_t_4 = 0;
          __Pyx_XDECREF_SET(__pyx_v_window_size_qc, __pyx_t_10);
          __pyx_t_10 = 0;

          /* "vapor_vali/Simple_function.pyx":1480
 *                     else:                                            ref_seq_b=reverse(complementary(ref_seq_readin(ref,bp_let_hash[alt_jun[1][0]][0],bp_let_hash[alt_jun[1][0]][2]-flank_length,bp_let_hash[alt_jun[1][0]][2]+flank_length)))
 *                     [window_size,window_size_qc]=window_size_refine(ref_seq_a+ref_seq_b)
 *                     if not window_size=='Error':             # <<<<<<<<<<<<<<
 *                         alt_seq=ref_seq_a[-flank_length:]+ref_seq_b[:flank_length]
 *                         [window_size,window_size_qc]=window_size_refine(alt_seq)
 */
          __pyx_t_8 = (__Pyx_PyString_Equals(__pyx_v_window_size, __pyx_n_s_Error, Py_EQ)); if (unlikely(__pyx_t_8 < 0)) __PYX_ERR(0, 1480, __pyx_L1_error)
          __pyx_t_9 = ((!__pyx_t_8) != 0);
          if (__pyx_t_9) {

            /* "vapor_vali/Simple_function.pyx":1481
 *                     [window_size,window_size_qc]=window_size_refine(ref_seq_a+ref_seq_b)
 *                     if not window_size=='Error':
 *                         alt_seq=ref_seq_a[-flank_length:]+ref_seq_b[:flank_length]             # <<<<<<<<<<<<<<
 *                         [window_size,window_size_qc]=window_size_refine(alt_seq)
 *                         if not window_size=='Error':
 */
            __pyx_t_3 = PyNumber_Negative(__pyx_v_flank_length); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1481, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_3);
            __pyx_t_10 = __Pyx_PyObject_GetSlice(__pyx_v_ref_seq_a, 0, 0, &__pyx_t_3, NULL, NULL, 0, 0, 1); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1481, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_10);
            __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
            __pyx_t_3 = __Pyx_PyObject_GetSlice(__pyx_v_ref_seq_b, 0, 0, NULL, &__pyx_v_flank_length, NULL, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1481, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_3);
            __pyx_t_4 = PyNumber_Add(__pyx_t_10, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1481, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_4);
            __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
            __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
            __Pyx_XDECREF_SET(__pyx_v_alt_seq, __pyx_t_4);
            __pyx_t_4 = 0;

            /* "vapor_vali/Simple_function.pyx":1482
 *                     if not window_size=='Error':
 *                         alt_seq=ref_seq_a[-flank_length:]+ref_seq_b[:flank_length]
 *                         [window_size,window_size_qc]=window_size_refine(alt_seq)             # <<<<<<<<<<<<<<
 *                         if not window_size=='Error':
 *                             if not '^' in alt_jun[0]:                   all_reads_a=simple_del_chop_pacbio_read_simple_short(bam_in,[bp_let_hash[alt_jun[0][0]][0],bp_let_hash[alt_jun[0][0]][2]],flank_length)
 */
            __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_window_size_refine); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1482, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_3);
            __pyx_t_10 = NULL;
            if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_3))) {
              __pyx_t_10 = PyMethod_GET_SELF(__pyx_t_3);
              if (likely(__pyx_t_10)) {
                PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
                __Pyx_INCREF(__pyx_t_10);
                __Pyx_INCREF(function);
                __Pyx_DECREF_SET(__pyx_t_3, function);
              }
            }
            if (!__pyx_t_10) {
              __pyx_t_4 = __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_v_alt_seq); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1482, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_4);
            } else {
              __pyx_t_24 = PyTuple_New(1+1); if (unlikely(!__pyx_t_24)) __PYX_ERR(0, 1482, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_24);
              __Pyx_GIVEREF(__pyx_t_10); PyTuple_SET_ITEM(__pyx_t_24, 0, __pyx_t_10); __pyx_t_10 = NULL;
              __Pyx_INCREF(__pyx_v_alt_seq);
              __Pyx_GIVEREF(__pyx_v_alt_seq);
              PyTuple_SET_ITEM(__pyx_t_24, 0+1, __pyx_v_alt_seq);
              __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_24, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1482, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_4);
              __Pyx_DECREF(__pyx_t_24); __pyx_t_24 = 0;
            }
            __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
            if ((likely(PyTuple_CheckExact(__pyx_t_4))) || (PyList_CheckExact(__pyx_t_4))) {
              PyObject* sequence = __pyx_t_4;
              #if CYTHON_COMPILING_IN_CPYTHON
              Py_ssize_t size = Py_SIZE(sequence);
              #else
              Py_ssize_t size = PySequence_Size(sequence);
              #endif
              if (unlikely(size != 2)) {
                if (size > 2) __Pyx_RaiseTooManyValuesError(2);
                else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
                __PYX_ERR(0, 1482, __pyx_L1_error)
              }
              #if CYTHON_COMPILING_IN_CPYTHON
              if (likely(PyTuple_CheckExact(sequence))) {
                __pyx_t_3 = PyTuple_GET_ITEM(sequence, 0); 
                __pyx_t_24 = PyTuple_GET_ITEM(sequence, 1); 
              } else {
                __pyx_t_3 = PyList_GET_ITEM(sequence, 0); 
                __pyx_t_24 = PyList_GET_ITEM(sequence, 1); 
              }
              __Pyx_INCREF(__pyx_t_3);
              __Pyx_INCREF(__pyx_t_24);
              #else
              __pyx_t_3 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1482, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_3);
              __pyx_t_24 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_24)) __PYX_ERR(0, 1482, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_24);
              #endif
              __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
            } else {
              Py_ssize_t index = -1;
              __pyx_t_10 = PyObject_GetIter(__pyx_t_4); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1482, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_10);
              __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
              __pyx_t_12 = Py_TYPE(__pyx_t_10)->tp_iternext;
              index = 0; __pyx_t_3 = __pyx_t_12(__pyx_t_10); if (unlikely(!__pyx_t_3)) goto __pyx_L41_unpacking_failed;
              __Pyx_GOTREF(__pyx_t_3);
              index = 1; __pyx_t_24 = __pyx_t_12(__pyx_t_10); if (unlikely(!__pyx_t_24)) goto __pyx_L41_unpacking_failed;
              __Pyx_GOTREF(__pyx_t_24);
              if (__Pyx_IternextUnpackEndCheck(__pyx_t_12(__pyx_t_10), 2) < 0) __PYX_ERR(0, 1482, __pyx_L1_error)
              __pyx_t_12 = NULL;
              __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
              goto __pyx_L42_unpacking_done;
              __pyx_L41_unpacking_failed:;
              __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
              __pyx_t_12 = NULL;
              if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
              __PYX_ERR(0, 1482, __pyx_L1_error)
              __pyx_L42_unpacking_done:;
            }
            __Pyx_DECREF_SET(__pyx_v_window_size, __pyx_t_3);
            __pyx_t_3 = 0;
            __Pyx_DECREF_SET(__pyx_v_window_size_qc, __pyx_t_24);
            __pyx_t_24 = 0;

            /* "vapor_vali/Simple_function.pyx":1483
 *                         alt_seq=ref_seq_a[-flank_length:]+ref_seq_b[:flank_length]
 *                         [window_size,window_size_qc]=window_size_refine(alt_seq)
 *                         if not window_size=='Error':             # <<<<<<<<<<<<<<
 *                             if not '^' in alt_jun[0]:                   all_reads_a=simple_del_chop_pacbio_read_simple_short(bam_in,[bp_let_hash[alt_jun[0][0]][0],bp_let_hash[alt_jun[0][0]][2]],flank_length)
 *                             else:                                       all_reads_a=simple_del_chop_pacbio_read_simple_short(bam_in,[bp_let_hash[alt_jun[0][0]][0],bp_let_hash[alt_jun[0][0]][1]],flank_length)
 */
            __pyx_t_9 = (__Pyx_PyString_Equals(__pyx_v_window_size, __pyx_n_s_Error, Py_EQ)); if (unlikely(__pyx_t_9 < 0)) __PYX_ERR(0, 1483, __pyx_L1_error)
            __pyx_t_8 = ((!__pyx_t_9) != 0);
            if (__pyx_t_8) {

              /* "vapor_vali/Simple_function.pyx":1484
 *                         [window_size,window_size_qc]=window_size_refine(alt_seq)
 *                         if not window_size=='Error':
 *                             if not '^' in alt_jun[0]:                   all_reads_a=simple_del_chop_pacbio_read_simple_short(bam_in,[bp_let_hash[alt_jun[0][0]][0],bp_let_hash[alt_jun[0][0]][2]],flank_length)             # <<<<<<<<<<<<<<
 *                             else:                                       all_reads_a=simple_del_chop_pacbio_read_simple_short(bam_in,[bp_let_hash[alt_jun[0][0]][0],bp_let_hash[alt_jun[0][0]][1]],flank_length)
 *                             #if not '^' in alt_jun[1]:                   all_reads_b=simple_del_chop_pacbio_read_simple_short(bam_in,[bp_let_hash[alt_jun[0][0]][0],bp_let_hash[alt_jun[0][0]][1]],flank_length)
 */
              __pyx_t_4 = __Pyx_GetItemInt(__pyx_v_alt_jun, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1484, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_4);
              __pyx_t_8 = (__Pyx_PySequence_ContainsTF(__pyx_kp_s__7, __pyx_t_4, Py_NE)); if (unlikely(__pyx_t_8 < 0)) __PYX_ERR(0, 1484, __pyx_L1_error)
              __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
              __pyx_t_9 = (__pyx_t_8 != 0);
              if (__pyx_t_9) {
                __pyx_t_24 = __Pyx_GetModuleGlobalName(__pyx_n_s_simple_del_chop_pacbio_read_simp); if (unlikely(!__pyx_t_24)) __PYX_ERR(0, 1484, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_24);
                __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_alt_jun, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1484, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_3);
                __pyx_t_10 = __Pyx_GetItemInt(__pyx_t_3, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1484, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_10);
                __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
                __pyx_t_3 = PyObject_GetItem(__pyx_v_bp_let_hash, __pyx_t_10); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1484, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_3);
                __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
                __pyx_t_10 = __Pyx_GetItemInt(__pyx_t_3, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1484, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_10);
                __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
                __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_alt_jun, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1484, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_3);
                __pyx_t_16 = __Pyx_GetItemInt(__pyx_t_3, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 1484, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_16);
                __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
                __pyx_t_3 = PyObject_GetItem(__pyx_v_bp_let_hash, __pyx_t_16); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1484, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_3);
                __Pyx_DECREF(__pyx_t_16); __pyx_t_16 = 0;
                __pyx_t_16 = __Pyx_GetItemInt(__pyx_t_3, 2, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 1484, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_16);
                __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
                __pyx_t_3 = PyList_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1484, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_3);
                __Pyx_GIVEREF(__pyx_t_10);
                PyList_SET_ITEM(__pyx_t_3, 0, __pyx_t_10);
                __Pyx_GIVEREF(__pyx_t_16);
                PyList_SET_ITEM(__pyx_t_3, 1, __pyx_t_16);
                __pyx_t_10 = 0;
                __pyx_t_16 = 0;
                __pyx_t_16 = NULL;
                __pyx_t_17 = 0;
                if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_24))) {
                  __pyx_t_16 = PyMethod_GET_SELF(__pyx_t_24);
                  if (likely(__pyx_t_16)) {
                    PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_24);
                    __Pyx_INCREF(__pyx_t_16);
                    __Pyx_INCREF(function);
                    __Pyx_DECREF_SET(__pyx_t_24, function);
                    __pyx_t_17 = 1;
                  }
                }
                __pyx_t_10 = PyTuple_New(3+__pyx_t_17); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1484, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_10);
                if (__pyx_t_16) {
                  __Pyx_GIVEREF(__pyx_t_16); PyTuple_SET_ITEM(__pyx_t_10, 0, __pyx_t_16); __pyx_t_16 = NULL;
                }
                __Pyx_INCREF(__pyx_v_bam_in);
                __Pyx_GIVEREF(__pyx_v_bam_in);
                PyTuple_SET_ITEM(__pyx_t_10, 0+__pyx_t_17, __pyx_v_bam_in);
                __Pyx_GIVEREF(__pyx_t_3);
                PyTuple_SET_ITEM(__pyx_t_10, 1+__pyx_t_17, __pyx_t_3);
                __Pyx_INCREF(__pyx_v_flank_length);
                __Pyx_GIVEREF(__pyx_v_flank_length);
                PyTuple_SET_ITEM(__pyx_t_10, 2+__pyx_t_17, __pyx_v_flank_length);
                __pyx_t_3 = 0;
                __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_24, __pyx_t_10, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1484, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_4);
                __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
                __Pyx_DECREF(__pyx_t_24); __pyx_t_24 = 0;
                __Pyx_XDECREF_SET(__pyx_v_all_reads_a, __pyx_t_4);
                __pyx_t_4 = 0;
                goto __pyx_L44;
              }

              /* "vapor_vali/Simple_function.pyx":1485
 *                         if not window_size=='Error':
 *                             if not '^' in alt_jun[0]:                   all_reads_a=simple_del_chop_pacbio_read_simple_short(bam_in,[bp_let_hash[alt_jun[0][0]][0],bp_let_hash[alt_jun[0][0]][2]],flank_length)
 *                             else:                                       all_reads_a=simple_del_chop_pacbio_read_simple_short(bam_in,[bp_let_hash[alt_jun[0][0]][0],bp_let_hash[alt_jun[0][0]][1]],flank_length)             # <<<<<<<<<<<<<<
 *                             #if not '^' in alt_jun[1]:                   all_reads_b=simple_del_chop_pacbio_read_simple_short(bam_in,[bp_let_hash[alt_jun[0][0]][0],bp_let_hash[alt_jun[0][0]][1]],flank_length)
 *                             #else:                                       all_reads_b=simple_del_chop_pacbio_read_simple_short(bam_in,[bp_let_hash[alt_jun[0][0]][0],bp_let_hash[alt_jun[0][0]][2]],flank_length)
 */
              /*else*/ {
                __pyx_t_24 = __Pyx_GetModuleGlobalName(__pyx_n_s_simple_del_chop_pacbio_read_simp); if (unlikely(!__pyx_t_24)) __PYX_ERR(0, 1485, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_24);
                __pyx_t_10 = __Pyx_GetItemInt(__pyx_v_alt_jun, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1485, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_10);
                __pyx_t_3 = __Pyx_GetItemInt(__pyx_t_10, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1485, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_3);
                __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
                __pyx_t_10 = PyObject_GetItem(__pyx_v_bp_let_hash, __pyx_t_3); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1485, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_10);
                __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
                __pyx_t_3 = __Pyx_GetItemInt(__pyx_t_10, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1485, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_3);
                __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
                __pyx_t_10 = __Pyx_GetItemInt(__pyx_v_alt_jun, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1485, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_10);
                __pyx_t_16 = __Pyx_GetItemInt(__pyx_t_10, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 1485, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_16);
                __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
                __pyx_t_10 = PyObject_GetItem(__pyx_v_bp_let_hash, __pyx_t_16); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1485, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_10);
                __Pyx_DECREF(__pyx_t_16); __pyx_t_16 = 0;
                __pyx_t_16 = __Pyx_GetItemInt(__pyx_t_10, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 1485, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_16);
                __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
                __pyx_t_10 = PyList_New(2); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1485, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_10);
                __Pyx_GIVEREF(__pyx_t_3);
                PyList_SET_ITEM(__pyx_t_10, 0, __pyx_t_3);
                __Pyx_GIVEREF(__pyx_t_16);
                PyList_SET_ITEM(__pyx_t_10, 1, __pyx_t_16);
                __pyx_t_3 = 0;
                __pyx_t_16 = 0;
                __pyx_t_16 = NULL;
                __pyx_t_17 = 0;
                if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_24))) {
                  __pyx_t_16 = PyMethod_GET_SELF(__pyx_t_24);
                  if (likely(__pyx_t_16)) {
                    PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_24);
                    __Pyx_INCREF(__pyx_t_16);
                    __Pyx_INCREF(function);
                    __Pyx_DECREF_SET(__pyx_t_24, function);
                    __pyx_t_17 = 1;
                  }
                }
                __pyx_t_3 = PyTuple_New(3+__pyx_t_17); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1485, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_3);
                if (__pyx_t_16) {
                  __Pyx_GIVEREF(__pyx_t_16); PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_16); __pyx_t_16 = NULL;
                }
                __Pyx_INCREF(__pyx_v_bam_in);
                __Pyx_GIVEREF(__pyx_v_bam_in);
                PyTuple_SET_ITEM(__pyx_t_3, 0+__pyx_t_17, __pyx_v_bam_in);
                __Pyx_GIVEREF(__pyx_t_10);
                PyTuple_SET_ITEM(__pyx_t_3, 1+__pyx_t_17, __pyx_t_10);
                __Pyx_INCREF(__pyx_v_flank_length);
                __Pyx_GIVEREF(__pyx_v_flank_length);
                PyTuple_SET_ITEM(__pyx_t_3, 2+__pyx_t_17, __pyx_v_flank_length);
                __pyx_t_10 = 0;
                __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_24, __pyx_t_3, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1485, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_4);
                __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
                __Pyx_DECREF(__pyx_t_24); __pyx_t_24 = 0;
                __Pyx_XDECREF_SET(__pyx_v_all_reads_a, __pyx_t_4);
                __pyx_t_4 = 0;
              }
              __pyx_L44:;

              /* "vapor_vali/Simple_function.pyx":1488
 *                             #if not '^' in alt_jun[1]:                   all_reads_b=simple_del_chop_pacbio_read_simple_short(bam_in,[bp_let_hash[alt_jun[0][0]][0],bp_let_hash[alt_jun[0][0]][1]],flank_length)
 *                             #else:                                       all_reads_b=simple_del_chop_pacbio_read_simple_short(bam_in,[bp_let_hash[alt_jun[0][0]][0],bp_let_hash[alt_jun[0][0]][2]],flank_length)
 *                             if len(all_reads_a)>0:             # <<<<<<<<<<<<<<
 *                                 for x in all_reads_a:
 *                                     vapor_single_read_score=calcu_vapor_single_read_score_within_10Perc_m1b(ref_seq_a,alt_seq,x,window_size)
 */
              __pyx_t_17 = PyObject_Length(__pyx_v_all_reads_a); if (unlikely(__pyx_t_17 == -1)) __PYX_ERR(0, 1488, __pyx_L1_error)
              __pyx_t_9 = ((__pyx_t_17 > 0) != 0);
              if (__pyx_t_9) {

                /* "vapor_vali/Simple_function.pyx":1489
 *                             #else:                                       all_reads_b=simple_del_chop_pacbio_read_simple_short(bam_in,[bp_let_hash[alt_jun[0][0]][0],bp_let_hash[alt_jun[0][0]][2]],flank_length)
 *                             if len(all_reads_a)>0:
 *                                 for x in all_reads_a:             # <<<<<<<<<<<<<<
 *                                     vapor_single_read_score=calcu_vapor_single_read_score_within_10Perc_m1b(ref_seq_a,alt_seq,x,window_size)
 *                                     if not 0 in vapor_single_read_score:
 */
                if (likely(PyList_CheckExact(__pyx_v_all_reads_a)) || PyTuple_CheckExact(__pyx_v_all_reads_a)) {
                  __pyx_t_4 = __pyx_v_all_reads_a; __Pyx_INCREF(__pyx_t_4); __pyx_t_17 = 0;
                  __pyx_t_18 = NULL;
                } else {
                  __pyx_t_17 = -1; __pyx_t_4 = PyObject_GetIter(__pyx_v_all_reads_a); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1489, __pyx_L1_error)
                  __Pyx_GOTREF(__pyx_t_4);
                  __pyx_t_18 = Py_TYPE(__pyx_t_4)->tp_iternext; if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 1489, __pyx_L1_error)
                }
                for (;;) {
                  if (likely(!__pyx_t_18)) {
                    if (likely(PyList_CheckExact(__pyx_t_4))) {
                      if (__pyx_t_17 >= PyList_GET_SIZE(__pyx_t_4)) break;
                      #if CYTHON_COMPILING_IN_CPYTHON
                      __pyx_t_24 = PyList_GET_ITEM(__pyx_t_4, __pyx_t_17); __Pyx_INCREF(__pyx_t_24); __pyx_t_17++; if (unlikely(0 < 0)) __PYX_ERR(0, 1489, __pyx_L1_error)
                      #else
                      __pyx_t_24 = PySequence_ITEM(__pyx_t_4, __pyx_t_17); __pyx_t_17++; if (unlikely(!__pyx_t_24)) __PYX_ERR(0, 1489, __pyx_L1_error)
                      __Pyx_GOTREF(__pyx_t_24);
                      #endif
                    } else {
                      if (__pyx_t_17 >= PyTuple_GET_SIZE(__pyx_t_4)) break;
                      #if CYTHON_COMPILING_IN_CPYTHON
                      __pyx_t_24 = PyTuple_GET_ITEM(__pyx_t_4, __pyx_t_17); __Pyx_INCREF(__pyx_t_24); __pyx_t_17++; if (unlikely(0 < 0)) __PYX_ERR(0, 1489, __pyx_L1_error)
                      #else
                      __pyx_t_24 = PySequence_ITEM(__pyx_t_4, __pyx_t_17); __pyx_t_17++; if (unlikely(!__pyx_t_24)) __PYX_ERR(0, 1489, __pyx_L1_error)
                      __Pyx_GOTREF(__pyx_t_24);
                      #endif
                    }
                  } else {
                    __pyx_t_24 = __pyx_t_18(__pyx_t_4);
                    if (unlikely(!__pyx_t_24)) {
                      PyObject* exc_type = PyErr_Occurred();
                      if (exc_type) {
                        if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
                        else __PYX_ERR(0, 1489, __pyx_L1_error)
                      }
                      break;
                    }
                    __Pyx_GOTREF(__pyx_t_24);
                  }
                  __Pyx_XDECREF_SET(__pyx_v_x, __pyx_t_24);
                  __pyx_t_24 = 0;

                  /* "vapor_vali/Simple_function.pyx":1490
 *                             if len(all_reads_a)>0:
 *                                 for x in all_reads_a:
 *                                     vapor_single_read_score=calcu_vapor_single_read_score_within_10Perc_m1b(ref_seq_a,alt_seq,x,window_size)             # <<<<<<<<<<<<<<
 *                                     if not 0 in vapor_single_read_score:
 *                                         vapor_score_list.append(1-float(vapor_single_read_score[1])/float(vapor_single_read_score[0]))
 */
                  __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_calcu_vapor_single_read_score_wi); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1490, __pyx_L1_error)
                  __Pyx_GOTREF(__pyx_t_3);
                  __pyx_t_10 = NULL;
                  __pyx_t_26 = 0;
                  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_3))) {
                    __pyx_t_10 = PyMethod_GET_SELF(__pyx_t_3);
                    if (likely(__pyx_t_10)) {
                      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
                      __Pyx_INCREF(__pyx_t_10);
                      __Pyx_INCREF(function);
                      __Pyx_DECREF_SET(__pyx_t_3, function);
                      __pyx_t_26 = 1;
                    }
                  }
                  __pyx_t_16 = PyTuple_New(4+__pyx_t_26); if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 1490, __pyx_L1_error)
                  __Pyx_GOTREF(__pyx_t_16);
                  if (__pyx_t_10) {
                    __Pyx_GIVEREF(__pyx_t_10); PyTuple_SET_ITEM(__pyx_t_16, 0, __pyx_t_10); __pyx_t_10 = NULL;
                  }
                  __Pyx_INCREF(__pyx_v_ref_seq_a);
                  __Pyx_GIVEREF(__pyx_v_ref_seq_a);
                  PyTuple_SET_ITEM(__pyx_t_16, 0+__pyx_t_26, __pyx_v_ref_seq_a);
                  __Pyx_INCREF(__pyx_v_alt_seq);
                  __Pyx_GIVEREF(__pyx_v_alt_seq);
                  PyTuple_SET_ITEM(__pyx_t_16, 1+__pyx_t_26, __pyx_v_alt_seq);
                  __Pyx_INCREF(__pyx_v_x);
                  __Pyx_GIVEREF(__pyx_v_x);
                  PyTuple_SET_ITEM(__pyx_t_16, 2+__pyx_t_26, __pyx_v_x);
                  __Pyx_INCREF(__pyx_v_window_size);
                  __Pyx_GIVEREF(__pyx_v_window_size);
                  PyTuple_SET_ITEM(__pyx_t_16, 3+__pyx_t_26, __pyx_v_window_size);
                  __pyx_t_24 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_16, NULL); if (unlikely(!__pyx_t_24)) __PYX_ERR(0, 1490, __pyx_L1_error)
                  __Pyx_GOTREF(__pyx_t_24);
                  __Pyx_DECREF(__pyx_t_16); __pyx_t_16 = 0;
                  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
                  __Pyx_XDECREF_SET(__pyx_v_vapor_single_read_score, __pyx_t_24);
                  __pyx_t_24 = 0;

                  /* "vapor_vali/Simple_function.pyx":1491
 *                                 for x in all_reads_a:
 *                                     vapor_single_read_score=calcu_vapor_single_read_score_within_10Perc_m1b(ref_seq_a,alt_seq,x,window_size)
 *                                     if not 0 in vapor_single_read_score:             # <<<<<<<<<<<<<<
 *                                         vapor_score_list.append(1-float(vapor_single_read_score[1])/float(vapor_single_read_score[0]))
 *                             #if len(all_reads_b)>0:
 */
                  __pyx_t_9 = (__Pyx_PySequence_ContainsTF(__pyx_int_0, __pyx_v_vapor_single_read_score, Py_NE)); if (unlikely(__pyx_t_9 < 0)) __PYX_ERR(0, 1491, __pyx_L1_error)
                  __pyx_t_8 = (__pyx_t_9 != 0);
                  if (__pyx_t_8) {

                    /* "vapor_vali/Simple_function.pyx":1492
 *                                     vapor_single_read_score=calcu_vapor_single_read_score_within_10Perc_m1b(ref_seq_a,alt_seq,x,window_size)
 *                                     if not 0 in vapor_single_read_score:
 *                                         vapor_score_list.append(1-float(vapor_single_read_score[1])/float(vapor_single_read_score[0]))             # <<<<<<<<<<<<<<
 *                             #if len(all_reads_b)>0:
 *                             #    for x in all_reads_a:
 */
                    __pyx_t_24 = __Pyx_GetItemInt(__pyx_v_vapor_single_read_score, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_24)) __PYX_ERR(0, 1492, __pyx_L1_error)
                    __Pyx_GOTREF(__pyx_t_24);
                    __pyx_t_20 = __Pyx_PyObject_AsDouble(__pyx_t_24); if (unlikely(__pyx_t_20 == ((double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1492, __pyx_L1_error)
                    __Pyx_DECREF(__pyx_t_24); __pyx_t_24 = 0;
                    __pyx_t_24 = __Pyx_GetItemInt(__pyx_v_vapor_single_read_score, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_24)) __PYX_ERR(0, 1492, __pyx_L1_error)
                    __Pyx_GOTREF(__pyx_t_24);
                    __pyx_t_19 = __Pyx_PyObject_AsDouble(__pyx_t_24); if (unlikely(__pyx_t_19 == ((double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1492, __pyx_L1_error)
                    __Pyx_DECREF(__pyx_t_24); __pyx_t_24 = 0;
                    if (unlikely(__pyx_t_19 == 0)) {
                      PyErr_SetString(PyExc_ZeroDivisionError, "float division");
                      __PYX_ERR(0, 1492, __pyx_L1_error)
                    }
                    __pyx_t_24 = PyFloat_FromDouble((1.0 - (__pyx_t_20 / __pyx_t_19))); if (unlikely(!__pyx_t_24)) __PYX_ERR(0, 1492, __pyx_L1_error)
                    __Pyx_GOTREF(__pyx_t_24);
                    __pyx_t_21 = __Pyx_PyList_Append(__pyx_v_vapor_score_list, __pyx_t_24); if (unlikely(__pyx_t_21 == -1)) __PYX_ERR(0, 1492, __pyx_L1_error)
                    __Pyx_DECREF(__pyx_t_24); __pyx_t_24 = 0;

                    /* "vapor_vali/Simple_function.pyx":1491
 *                                 for x in all_reads_a:
 *                                     vapor_single_read_score=calcu_vapor_single_read_score_within_10Perc_m1b(ref_seq_a,alt_seq,x,window_size)
 *                                     if not 0 in vapor_single_read_score:             # <<<<<<<<<<<<<<
 *                                         vapor_score_list.append(1-float(vapor_single_read_score[1])/float(vapor_single_read_score[0]))
 *                             #if len(all_reads_b)>0:
 */
                  }

                  /* "vapor_vali/Simple_function.pyx":1489
 *                             #else:                                       all_reads_b=simple_del_chop_pacbio_read_simple_short(bam_in,[bp_let_hash[alt_jun[0][0]][0],bp_let_hash[alt_jun[0][0]][2]],flank_length)
 *                             if len(all_reads_a)>0:
 *                                 for x in all_reads_a:             # <<<<<<<<<<<<<<
 *                                     vapor_single_read_score=calcu_vapor_single_read_score_within_10Perc_m1b(ref_seq_a,alt_seq,x,window_size)
 *                                     if not 0 in vapor_single_read_score:
 */
                }
                __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;

                /* "vapor_vali/Simple_function.pyx":1488
 *                             #if not '^' in alt_jun[1]:                   all_reads_b=simple_del_chop_pacbio_read_simple_short(bam_in,[bp_let_hash[alt_jun[0][0]][0],bp_let_hash[alt_jun[0][0]][1]],flank_length)
 *                             #else:                                       all_reads_b=simple_del_chop_pacbio_read_simple_short(bam_in,[bp_let_hash[alt_jun[0][0]][0],bp_let_hash[alt_jun[0][0]][2]],flank_length)
 *                             if len(all_reads_a)>0:             # <<<<<<<<<<<<<<
 *                                 for x in all_reads_a:
 *                                     vapor_single_read_score=calcu_vapor_single_read_score_within_10Perc_m1b(ref_seq_a,alt_seq,x,window_size)
 */
              }

              /* "vapor_vali/Simple_function.pyx":1483
 *                         alt_seq=ref_seq_a[-flank_length:]+ref_seq_b[:flank_length]
 *                         [window_size,window_size_qc]=window_size_refine(alt_seq)
 *                         if not window_size=='Error':             # <<<<<<<<<<<<<<
 *                             if not '^' in alt_jun[0]:                   all_reads_a=simple_del_chop_pacbio_read_simple_short(bam_in,[bp_let_hash[alt_jun[0][0]][0],bp_let_hash[alt_jun[0][0]][2]],flank_length)
 *                             else:                                       all_reads_a=simple_del_chop_pacbio_read_simple_short(bam_in,[bp_let_hash[alt_jun[0][0]][0],bp_let_hash[alt_jun[0][0]][1]],flank_length)
 */
            }

            /* "vapor_vali/Simple_function.pyx":1480
 *                     else:                                            ref_seq_b=reverse(complementary(ref_seq_readin(ref,bp_let_hash[alt_jun[1][0]][0],bp_let_hash[alt_jun[1][0]][2]-flank_length,bp_let_hash[alt_jun[1][0]][2]+flank_length)))
 *                     [window_size,window_size_qc]=window_size_refine(ref_seq_a+ref_seq_b)
 *                     if not window_size=='Error':             # <<<<<<<<<<<<<<
 *                         alt_seq=ref_seq_a[-flank_length:]+ref_seq_b[:flank_length]
 *                         [window_size,window_size_qc]=window_size_refine(alt_seq)
 */
          }

          /* "vapor_vali/Simple_function.pyx":1474
 *                 alt_juncs=block_around_check(alt_allele,ref_sv[0])
 *                 bp_let_hash=bp_to_chr_hash(bp_info[0],chromos,flank_length)
 *                 for alt_jun in alt_juncs:             # <<<<<<<<<<<<<<
 *                     if not '^' in alt_jun[0]:                        ref_seq_a=ref_seq_readin(ref,bp_let_hash[alt_jun[0][0]][0],bp_let_hash[alt_jun[0][0]][2]-flank_length,bp_let_hash[alt_jun[0][0]][2]+flank_length)
 *                     else:                                            ref_seq_a=reverse(complementary(ref_seq_readin(ref,bp_let_hash[alt_jun[0][0]][0],bp_let_hash[alt_jun[0][0]][1]-flank_length,bp_let_hash[alt_jun[0][0]][1]+flank_length)))
 */
        }
        __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;

        /* "vapor_vali/Simple_function.pyx":1471
 *                             make_event_figure_1(vapor_score_list,best_read_rec,window_size,ref_seq,alt_seq,'.'.join(out_figure_name.split('.')[:-1]+[ref_sv[0]+'.vs.'+alt_allele,out_figure_name.split('.')[-1]]))
 *         if run_flag==0:
 *             for alt_allele in alt_sv:             # <<<<<<<<<<<<<<
 *                 alt_juncs=block_around_check(alt_allele,ref_sv[0])
 *                 bp_let_hash=bp_to_chr_hash(bp_info[0],chromos,flank_length)
 */
      }
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

      /* "vapor_vali/Simple_function.pyx":1470
 *                                     if vapor_score_list[-1]==max(vapor_score_list):best_read_rec=x
 *                             make_event_figure_1(vapor_score_list,best_read_rec,window_size,ref_seq,alt_seq,'.'.join(out_figure_name.split('.')[:-1]+[ref_sv[0]+'.vs.'+alt_allele,out_figure_name.split('.')[-1]]))
 *         if run_flag==0:             # <<<<<<<<<<<<<<
 *             for alt_allele in alt_sv:
 *                 alt_juncs=block_around_check(alt_allele,ref_sv[0])
 */
    }

    /* "vapor_vali/Simple_function.pyx":1442
 *     vapor_score_list=[]
 *     run_flag=0
 *     if len(bp_info)==1: #inter-chromosome event not considered here             # <<<<<<<<<<<<<<
 *         if bp_info[0][-1]-bp_info[0][1]<default_max_sv_test:
 *             ref_seq=ref_seq_readin(ref,bp_info[0][0],bp_info[0][1]-flank_length,bp_info[0][-1]+flank_length)
 */
  }

  /* "vapor_vali/Simple_function.pyx":1498
 *                             #        if not vapor_single_read_score==[0,0] and not vapor_single_read_score[0]==0:
 *                             #            vapor_score_list.append(1-float(vapor_single_read_score[1])/float(vapor_single_read_score[0]))
 *     return vapor_score_list             # <<<<<<<<<<<<<<
 * 
 * def vapor_del_inv_Vapor(bam_in,ref,sv_info,out_figure_name):
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_vapor_score_list);
  __pyx_r = __pyx_v_vapor_score_list;
  goto __pyx_L0;

  /* "vapor_vali/Simple_function.pyx":1433
 *     return out
 * 
 * def vapor_CANNOT_CLASSIFY_VapoR(bam_in,ref,sv_info,out_figure_name):             # <<<<<<<<<<<<<<
 *     #eg of sv_info=['ab_ab', 'b_b^', 'chr7', '70955990', '70961199', '70973901']
 *     ref_sv=sv_info[0].split('_')
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_10);
  __Pyx_XDECREF(__pyx_t_11);
  __Pyx_XDECREF(__pyx_t_14);
  __Pyx_XDECREF(__pyx_t_16);
  __Pyx_XDECREF(__pyx_t_22);
  __Pyx_XDECREF(__pyx_t_23);
  __Pyx_XDECREF(__pyx_t_24);
  __Pyx_XDECREF(__pyx_t_25);
  __Pyx_AddTraceback("vapor_vali.Simple_function.vapor_CANNOT_CLASSIFY_VapoR", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_ref_sv);
  __Pyx_XDECREF(__pyx_v_alt_sv);
  __Pyx_XDECREF(__pyx_v_chromos);
  __Pyx_XDECREF(__pyx_v_bp_info);
  __Pyx_XDECREF(__pyx_v_flank_length);
  __Pyx_XDECREF(__pyx_v_vapor_score_list);
  __Pyx_XDECREF(__pyx_v_run_flag);
  __Pyx_XDECREF(__pyx_v_ref_seq);
  __Pyx_XDECREF(__pyx_v_window_size);
  __Pyx_XDECREF(__pyx_v_window_size_qc);
  __Pyx_XDECREF(__pyx_v_all_reads);
  __Pyx_XDECREF(__pyx_v_bp_let_hash);
  __Pyx_XDECREF(__pyx_v_bp_let_seq);
  __Pyx_XDECREF(__pyx_v_i);
  __Pyx_XDECREF(__pyx_v_alt_allele);
  __Pyx_XDECREF(__pyx_v_alt_seq);
  __Pyx_XDECREF(__pyx_v_best_read_rec);
  __Pyx_XDECREF(__pyx_v_x);
  __Pyx_XDECREF(__pyx_v_vapor_single_read_score);
  __Pyx_XDECREF(__pyx_v_alt_juncs);
  __Pyx_XDECREF(__pyx_v_alt_jun);
  __Pyx_XDECREF(__pyx_v_ref_seq_a);
  __Pyx_XDECREF(__pyx_v_ref_seq_b);
  __Pyx_XDECREF(__pyx_v_all_reads_a);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "vapor_vali/Simple_function.pyx":1500
 *     return vapor_score_list
 * 
 * def vapor_del_inv_Vapor(bam_in,ref,sv_info,out_figure_name):             # <<<<<<<<<<<<<<
 *     sv_block=[sv_info[0][0],sv_info[0][1],sv_info[-1][2]]
 *     flank_length=flank_length_calculate(sv_block)
 */

/* Python wrapper */
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_203vapor_del_inv_Vapor(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_10vapor_vali_15Simple_function_203vapor_del_inv_Vapor = {"vapor_del_inv_Vapor", (PyCFunction)__pyx_pw_10vapor_vali_15Simple_function_203vapor_del_inv_Vapor, METH_VARARGS|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_203vapor_del_inv_Vapor(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_bam_in = 0;
  PyObject *__pyx_v_ref = 0;
  PyObject *__pyx_v_sv_info = 0;
  PyObject *__pyx_v_out_figure_name = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("vapor_del_inv_Vapor (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_bam_in,&__pyx_n_s_ref,&__pyx_n_s_sv_info,&__pyx_n_s_out_figure_name,0};
    PyObject* values[4] = {0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
      switch (pos_args) {
        case  4: values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
        case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_bam_in)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_ref)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("vapor_del_inv_Vapor", 1, 4, 4, 1); __PYX_ERR(0, 1500, __pyx_L3_error)
        }
        case  2:
        if (likely((values[2] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_sv_info)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("vapor_del_inv_Vapor", 1, 4, 4, 2); __PYX_ERR(0, 1500, __pyx_L3_error)
        }
        case  3:
        if (likely((values[3] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_out_figure_name)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("vapor_del_inv_Vapor", 1, 4, 4, 3); __PYX_ERR(0, 1500, __pyx_L3_error)
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "vapor_del_inv_Vapor") < 0)) __PYX_ERR(0, 1500, __pyx_L3_error)
      }
    } else if (PyTuple_GET_SIZE(__pyx_args) != 4) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
      values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
    }
    __pyx_v_bam_in = values[0];
    __pyx_v_ref = values[1];
    __pyx_v_sv_info = values[2];
    __pyx_v_out_figure_name = values[3];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("vapor_del_inv_Vapor", 1, 4, 4, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1500, __pyx_L3_error)
  __pyx_L3_error:;
  __Pyx_AddTraceback("vapor_vali.Simple_function.vapor_del_inv_Vapor", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_10vapor_vali_15Simple_function_202vapor_del_inv_Vapor(__pyx_self, __pyx_v_bam_in, __pyx_v_ref, __pyx_v_sv_info, __pyx_v_out_figure_name);

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10vapor_vali_15Simple_function_202vapor_del_inv_Vapor(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_bam_in, PyObject *__pyx_v_ref, PyObject *__pyx_v_sv_info, PyObject *__pyx_v_out_figure_name) {
  PyObject *__pyx_v_sv_block = NULL;
  PyObject *__pyx_v_flank_length = NULL;
  PyObject *__pyx_v_vapor_score_list = NULL;
  PyObject *__pyx_v_best_read_rec = NULL;
  PyObject *__pyx_v_ref_seq = NULL;
  PyObject *__pyx_v_window_size = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_window_size_qc = NULL;
  PyObject *__pyx_v_alt_seq = NULL;
  PyObject *__pyx_v_x = NULL;
  PyObject *__pyx_v_all_reads = NULL;
  PyObject *__pyx_v_vapor_single_read_score = NULL;
  PyObject *__pyx_v_sub_sv_info = NULL;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  int __pyx_t_5;
  PyObject *__pyx_t_6 = NULL;
  PyObject *__pyx_t_7 = NULL;
  Py_ssize_t __pyx_t_8;
  PyObject *__pyx_t_9 = NULL;
  PyObject *(*__pyx_t_10)(PyObject *);
  int __pyx_t_11;
  PyObject *(*__pyx_t_12)(PyObject *);
  PyObject *__pyx_t_13 = NULL;
  PyObject *__pyx_t_14 = NULL;
  PyObject *__pyx_t_15 = NULL;
  PyObject *__pyx_t_16 = NULL;
  Py_ssize_t __pyx_t_17;
  PyObject *__pyx_t_18 = NULL;
  double __pyx_t_19;
  double __pyx_t_20;
  int __pyx_t_21;
  PyObject *(*__pyx_t_22)(PyObject *);
  __Pyx_RefNannySetupContext("vapor_del_inv_Vapor", 0);

  /* "vapor_vali/Simple_function.pyx":1501
 * 
 * def vapor_del_inv_Vapor(bam_in,ref,sv_info,out_figure_name):
 *     sv_block=[sv_info[0][0],sv_info[0][1],sv_info[-1][2]]             # <<<<<<<<<<<<<<
 *     flank_length=flank_length_calculate(sv_block)
 *     vapor_score_list=[]
 */
  __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_sv_info, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1501, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_GetItemInt(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1501, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_sv_info, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1501, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_3 = __Pyx_GetItemInt(__pyx_t_1, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1501, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_sv_info, -1L, long, 1, __Pyx_PyInt_From_long, 0, 1, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1501, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_4 = __Pyx_GetItemInt(__pyx_t_1, 2, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1501, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = PyList_New(3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1501, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_GIVEREF(__pyx_t_2);
  PyList_SET_ITEM(__pyx_t_1, 0, __pyx_t_2);
  __Pyx_GIVEREF(__pyx_t_3);
  PyList_SET_ITEM(__pyx_t_1, 1, __pyx_t_3);
  __Pyx_GIVEREF(__pyx_t_4);
  PyList_SET_ITEM(__pyx_t_1, 2, __pyx_t_4);
  __pyx_t_2 = 0;
  __pyx_t_3 = 0;
  __pyx_t_4 = 0;
  __pyx_v_sv_block = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":1502
 * def vapor_del_inv_Vapor(bam_in,ref,sv_info,out_figure_name):
 *     sv_block=[sv_info[0][0],sv_info[0][1],sv_info[-1][2]]
 *     flank_length=flank_length_calculate(sv_block)             # <<<<<<<<<<<<<<
 *     vapor_score_list=[]
 *     best_read_rec=''
 */
  __pyx_t_4 = __Pyx_GetModuleGlobalName(__pyx_n_s_flank_length_calculate); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1502, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_3 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_4))) {
    __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_4);
    if (likely(__pyx_t_3)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
      __Pyx_INCREF(__pyx_t_3);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_4, function);
    }
  }
  if (!__pyx_t_3) {
    __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_v_sv_block); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1502, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
  } else {
    __pyx_t_2 = PyTuple_New(1+1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1502, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_GIVEREF(__pyx_t_3); PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_3); __pyx_t_3 = NULL;
    __Pyx_INCREF(__pyx_v_sv_block);
    __Pyx_GIVEREF(__pyx_v_sv_block);
    PyTuple_SET_ITEM(__pyx_t_2, 0+1, __pyx_v_sv_block);
    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_2, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1502, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  }
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_flank_length = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":1503
 *     sv_block=[sv_info[0][0],sv_info[0][1],sv_info[-1][2]]
 *     flank_length=flank_length_calculate(sv_block)
 *     vapor_score_list=[]             # <<<<<<<<<<<<<<
 *     best_read_rec=''
 *     if sv_info[1][1]-sv_info[0][2]<100:
 */
  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1503, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_vapor_score_list = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":1504
 *     flank_length=flank_length_calculate(sv_block)
 *     vapor_score_list=[]
 *     best_read_rec=''             # <<<<<<<<<<<<<<
 *     if sv_info[1][1]-sv_info[0][2]<100:
 *         if sv_block[2]-sv_block[1]<default_max_sv_test: #only try to read in all reads with sv <100K; else: try breakpoints ;
 */
  __Pyx_INCREF(__pyx_kp_s__24);
  __pyx_v_best_read_rec = __pyx_kp_s__24;

  /* "vapor_vali/Simple_function.pyx":1505
 *     vapor_score_list=[]
 *     best_read_rec=''
 *     if sv_info[1][1]-sv_info[0][2]<100:             # <<<<<<<<<<<<<<
 *         if sv_block[2]-sv_block[1]<default_max_sv_test: #only try to read in all reads with sv <100K; else: try breakpoints ;
 *             ref_seq=ref_seq_readin(ref,sv_block[0],sv_block[1]-flank_length,sv_block[2]+flank_length)
 */
  __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_sv_info, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1505, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_4 = __Pyx_GetItemInt(__pyx_t_1, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1505, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_sv_info, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1505, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_GetItemInt(__pyx_t_1, 2, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1505, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = PyNumber_Subtract(__pyx_t_4, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1505, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = PyObject_RichCompare(__pyx_t_1, __pyx_int_100, Py_LT); __Pyx_XGOTREF(__pyx_t_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1505, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 1505, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  if (__pyx_t_5) {

    /* "vapor_vali/Simple_function.pyx":1506
 *     best_read_rec=''
 *     if sv_info[1][1]-sv_info[0][2]<100:
 *         if sv_block[2]-sv_block[1]<default_max_sv_test: #only try to read in all reads with sv <100K; else: try breakpoints ;             # <<<<<<<<<<<<<<
 *             ref_seq=ref_seq_readin(ref,sv_block[0],sv_block[1]-flank_length,sv_block[2]+flank_length)
 *             [window_size,window_size_qc]=window_size_refine(ref_seq)
 */
    __pyx_t_2 = __Pyx_GetItemInt_List(__pyx_v_sv_block, 2, long, 1, __Pyx_PyInt_From_long, 1, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1506, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_1 = __Pyx_GetItemInt_List(__pyx_v_sv_block, 1, long, 1, __Pyx_PyInt_From_long, 1, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1506, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_4 = PyNumber_Subtract(__pyx_t_2, __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1506, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_default_max_sv_test); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1506, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_2 = PyObject_RichCompare(__pyx_t_4, __pyx_t_1, Py_LT); __Pyx_XGOTREF(__pyx_t_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1506, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 1506, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    if (__pyx_t_5) {

      /* "vapor_vali/Simple_function.pyx":1507
 *     if sv_info[1][1]-sv_info[0][2]<100:
 *         if sv_block[2]-sv_block[1]<default_max_sv_test: #only try to read in all reads with sv <100K; else: try breakpoints ;
 *             ref_seq=ref_seq_readin(ref,sv_block[0],sv_block[1]-flank_length,sv_block[2]+flank_length)             # <<<<<<<<<<<<<<
 *             [window_size,window_size_qc]=window_size_refine(ref_seq)
 *             if not window_size=='Error':
 */
      __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_ref_seq_readin); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1507, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __pyx_t_4 = __Pyx_GetItemInt_List(__pyx_v_sv_block, 0, long, 1, __Pyx_PyInt_From_long, 1, 0, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1507, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_t_3 = __Pyx_GetItemInt_List(__pyx_v_sv_block, 1, long, 1, __Pyx_PyInt_From_long, 1, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1507, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __pyx_t_6 = PyNumber_Subtract(__pyx_t_3, __pyx_v_flank_length); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1507, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_6);
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_3 = __Pyx_GetItemInt_List(__pyx_v_sv_block, 2, long, 1, __Pyx_PyInt_From_long, 1, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1507, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __pyx_t_7 = PyNumber_Add(__pyx_t_3, __pyx_v_flank_length); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1507, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_7);
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_3 = NULL;
      __pyx_t_8 = 0;
      if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_1))) {
        __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_1);
        if (likely(__pyx_t_3)) {
          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
          __Pyx_INCREF(__pyx_t_3);
          __Pyx_INCREF(function);
          __Pyx_DECREF_SET(__pyx_t_1, function);
          __pyx_t_8 = 1;
        }
      }
      __pyx_t_9 = PyTuple_New(4+__pyx_t_8); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1507, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_9);
      if (__pyx_t_3) {
        __Pyx_GIVEREF(__pyx_t_3); PyTuple_SET_ITEM(__pyx_t_9, 0, __pyx_t_3); __pyx_t_3 = NULL;
      }
      __Pyx_INCREF(__pyx_v_ref);
      __Pyx_GIVEREF(__pyx_v_ref);
      PyTuple_SET_ITEM(__pyx_t_9, 0+__pyx_t_8, __pyx_v_ref);
      __Pyx_GIVEREF(__pyx_t_4);
      PyTuple_SET_ITEM(__pyx_t_9, 1+__pyx_t_8, __pyx_t_4);
      __Pyx_GIVEREF(__pyx_t_6);
      PyTuple_SET_ITEM(__pyx_t_9, 2+__pyx_t_8, __pyx_t_6);
      __Pyx_GIVEREF(__pyx_t_7);
      PyTuple_SET_ITEM(__pyx_t_9, 3+__pyx_t_8, __pyx_t_7);
      __pyx_t_4 = 0;
      __pyx_t_6 = 0;
      __pyx_t_7 = 0;
      __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_9, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1507, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_v_ref_seq = __pyx_t_2;
      __pyx_t_2 = 0;

      /* "vapor_vali/Simple_function.pyx":1508
 *         if sv_block[2]-sv_block[1]<default_max_sv_test: #only try to read in all reads with sv <100K; else: try breakpoints ;
 *             ref_seq=ref_seq_readin(ref,sv_block[0],sv_block[1]-flank_length,sv_block[2]+flank_length)
 *             [window_size,window_size_qc]=window_size_refine(ref_seq)             # <<<<<<<<<<<<<<
 *             if not window_size=='Error':
 *                 alt_seq=ref_seq[:flank_length]
 */
      __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_window_size_refine); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1508, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __pyx_t_9 = NULL;
      if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_1))) {
        __pyx_t_9 = PyMethod_GET_SELF(__pyx_t_1);
        if (likely(__pyx_t_9)) {
          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
          __Pyx_INCREF(__pyx_t_9);
          __Pyx_INCREF(function);
          __Pyx_DECREF_SET(__pyx_t_1, function);
        }
      }
      if (!__pyx_t_9) {
        __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_v_ref_seq); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1508, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
      } else {
        __pyx_t_7 = PyTuple_New(1+1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1508, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_7);
        __Pyx_GIVEREF(__pyx_t_9); PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_9); __pyx_t_9 = NULL;
        __Pyx_INCREF(__pyx_v_ref_seq);
        __Pyx_GIVEREF(__pyx_v_ref_seq);
        PyTuple_SET_ITEM(__pyx_t_7, 0+1, __pyx_v_ref_seq);
        __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_7, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1508, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
        __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
      }
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      if ((likely(PyTuple_CheckExact(__pyx_t_2))) || (PyList_CheckExact(__pyx_t_2))) {
        PyObject* sequence = __pyx_t_2;
        #if CYTHON_COMPILING_IN_CPYTHON
        Py_ssize_t size = Py_SIZE(sequence);
        #else
        Py_ssize_t size = PySequence_Size(sequence);
        #endif
        if (unlikely(size != 2)) {
          if (size > 2) __Pyx_RaiseTooManyValuesError(2);
          else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
          __PYX_ERR(0, 1508, __pyx_L1_error)
        }
        #if CYTHON_COMPILING_IN_CPYTHON
        if (likely(PyTuple_CheckExact(sequence))) {
          __pyx_t_1 = PyTuple_GET_ITEM(sequence, 0); 
          __pyx_t_7 = PyTuple_GET_ITEM(sequence, 1); 
        } else {
          __pyx_t_1 = PyList_GET_ITEM(sequence, 0); 
          __pyx_t_7 = PyList_GET_ITEM(sequence, 1); 
        }
        __Pyx_INCREF(__pyx_t_1);
        __Pyx_INCREF(__pyx_t_7);
        #else
        __pyx_t_1 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1508, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        __pyx_t_7 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1508, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_7);
        #endif
        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      } else {
        Py_ssize_t index = -1;
        __pyx_t_9 = PyObject_GetIter(__pyx_t_2); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1508, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_9);
        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
        __pyx_t_10 = Py_TYPE(__pyx_t_9)->tp_iternext;
        index = 0; __pyx_t_1 = __pyx_t_10(__pyx_t_9); if (unlikely(!__pyx_t_1)) goto __pyx_L5_unpacking_failed;
        __Pyx_GOTREF(__pyx_t_1);
        index = 1; __pyx_t_7 = __pyx_t_10(__pyx_t_9); if (unlikely(!__pyx_t_7)) goto __pyx_L5_unpacking_failed;
        __Pyx_GOTREF(__pyx_t_7);
        if (__Pyx_IternextUnpackEndCheck(__pyx_t_10(__pyx_t_9), 2) < 0) __PYX_ERR(0, 1508, __pyx_L1_error)
        __pyx_t_10 = NULL;
        __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
        goto __pyx_L6_unpacking_done;
        __pyx_L5_unpacking_failed:;
        __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
        __pyx_t_10 = NULL;
        if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
        __PYX_ERR(0, 1508, __pyx_L1_error)
        __pyx_L6_unpacking_done:;
      }
      __pyx_v_window_size = __pyx_t_1;
      __pyx_t_1 = 0;
      __pyx_v_window_size_qc = __pyx_t_7;
      __pyx_t_7 = 0;

      /* "vapor_vali/Simple_function.pyx":1509
 *             ref_seq=ref_seq_readin(ref,sv_block[0],sv_block[1]-flank_length,sv_block[2]+flank_length)
 *             [window_size,window_size_qc]=window_size_refine(ref_seq)
 *             if not window_size=='Error':             # <<<<<<<<<<<<<<
 *                 alt_seq=ref_seq[:flank_length]
 *                 for x in sv_info:
 */
      __pyx_t_5 = (__Pyx_PyString_Equals(__pyx_v_window_size, __pyx_n_s_Error, Py_EQ)); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 1509, __pyx_L1_error)
      __pyx_t_11 = ((!__pyx_t_5) != 0);
      if (__pyx_t_11) {

        /* "vapor_vali/Simple_function.pyx":1510
 *             [window_size,window_size_qc]=window_size_refine(ref_seq)
 *             if not window_size=='Error':
 *                 alt_seq=ref_seq[:flank_length]             # <<<<<<<<<<<<<<
 *                 for x in sv_info:
 *                     if x[-1]=='del':continue
 */
        __pyx_t_2 = __Pyx_PyObject_GetSlice(__pyx_v_ref_seq, 0, 0, NULL, &__pyx_v_flank_length, NULL, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1510, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
        __pyx_v_alt_seq = __pyx_t_2;
        __pyx_t_2 = 0;

        /* "vapor_vali/Simple_function.pyx":1511
 *             if not window_size=='Error':
 *                 alt_seq=ref_seq[:flank_length]
 *                 for x in sv_info:             # <<<<<<<<<<<<<<
 *                     if x[-1]=='del':continue
 *                     elif x[-1]=='inv':  alt_seq+=reverse(complementary(ref_seq_readin(ref,x[0],x[1],x[2])))
 */
        if (likely(PyList_CheckExact(__pyx_v_sv_info)) || PyTuple_CheckExact(__pyx_v_sv_info)) {
          __pyx_t_2 = __pyx_v_sv_info; __Pyx_INCREF(__pyx_t_2); __pyx_t_8 = 0;
          __pyx_t_12 = NULL;
        } else {
          __pyx_t_8 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_v_sv_info); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1511, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_2);
          __pyx_t_12 = Py_TYPE(__pyx_t_2)->tp_iternext; if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1511, __pyx_L1_error)
        }
        for (;;) {
          if (likely(!__pyx_t_12)) {
            if (likely(PyList_CheckExact(__pyx_t_2))) {
              if (__pyx_t_8 >= PyList_GET_SIZE(__pyx_t_2)) break;
              #if CYTHON_COMPILING_IN_CPYTHON
              __pyx_t_7 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_8); __Pyx_INCREF(__pyx_t_7); __pyx_t_8++; if (unlikely(0 < 0)) __PYX_ERR(0, 1511, __pyx_L1_error)
              #else
              __pyx_t_7 = PySequence_ITEM(__pyx_t_2, __pyx_t_8); __pyx_t_8++; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1511, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_7);
              #endif
            } else {
              if (__pyx_t_8 >= PyTuple_GET_SIZE(__pyx_t_2)) break;
              #if CYTHON_COMPILING_IN_CPYTHON
              __pyx_t_7 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_8); __Pyx_INCREF(__pyx_t_7); __pyx_t_8++; if (unlikely(0 < 0)) __PYX_ERR(0, 1511, __pyx_L1_error)
              #else
              __pyx_t_7 = PySequence_ITEM(__pyx_t_2, __pyx_t_8); __pyx_t_8++; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1511, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_7);
              #endif
            }
          } else {
            __pyx_t_7 = __pyx_t_12(__pyx_t_2);
            if (unlikely(!__pyx_t_7)) {
              PyObject* exc_type = PyErr_Occurred();
              if (exc_type) {
                if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
                else __PYX_ERR(0, 1511, __pyx_L1_error)
              }
              break;
            }
            __Pyx_GOTREF(__pyx_t_7);
          }
          __Pyx_XDECREF_SET(__pyx_v_x, __pyx_t_7);
          __pyx_t_7 = 0;

          /* "vapor_vali/Simple_function.pyx":1512
 *                 alt_seq=ref_seq[:flank_length]
 *                 for x in sv_info:
 *                     if x[-1]=='del':continue             # <<<<<<<<<<<<<<
 *                     elif x[-1]=='inv':  alt_seq+=reverse(complementary(ref_seq_readin(ref,x[0],x[1],x[2])))
 *                 alt_seq+=ref_seq[-flank_length:]
 */
          __pyx_t_7 = __Pyx_GetItemInt(__pyx_v_x, -1L, long, 1, __Pyx_PyInt_From_long, 0, 1, 1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1512, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_7);
          __pyx_t_11 = (__Pyx_PyString_Equals(__pyx_t_7, __pyx_n_s_del, Py_EQ)); if (unlikely(__pyx_t_11 < 0)) __PYX_ERR(0, 1512, __pyx_L1_error)
          __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
          if (__pyx_t_11) {
            goto __pyx_L8_continue;
          }

          /* "vapor_vali/Simple_function.pyx":1513
 *                 for x in sv_info:
 *                     if x[-1]=='del':continue
 *                     elif x[-1]=='inv':  alt_seq+=reverse(complementary(ref_seq_readin(ref,x[0],x[1],x[2])))             # <<<<<<<<<<<<<<
 *                 alt_seq+=ref_seq[-flank_length:]
 *                 [window_size,window_size_qc]=window_size_refine(alt_seq)
 */
          __pyx_t_7 = __Pyx_GetItemInt(__pyx_v_x, -1L, long, 1, __Pyx_PyInt_From_long, 0, 1, 1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1513, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_7);
          __pyx_t_11 = (__Pyx_PyString_Equals(__pyx_t_7, __pyx_n_s_inv, Py_EQ)); if (unlikely(__pyx_t_11 < 0)) __PYX_ERR(0, 1513, __pyx_L1_error)
          __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
          if (__pyx_t_11) {
            __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_reverse); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1513, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_1);
            __pyx_t_6 = __Pyx_GetModuleGlobalName(__pyx_n_s_complementary); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1513, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_6);
            __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_ref_seq_readin); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1513, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_3);
            __pyx_t_13 = __Pyx_GetItemInt(__pyx_v_x, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1513, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_13);
            __pyx_t_14 = __Pyx_GetItemInt(__pyx_v_x, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1513, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_14);
            __pyx_t_15 = __Pyx_GetItemInt(__pyx_v_x, 2, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1513, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_15);
            __pyx_t_16 = NULL;
            __pyx_t_17 = 0;
            if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_3))) {
              __pyx_t_16 = PyMethod_GET_SELF(__pyx_t_3);
              if (likely(__pyx_t_16)) {
                PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
                __Pyx_INCREF(__pyx_t_16);
                __Pyx_INCREF(function);
                __Pyx_DECREF_SET(__pyx_t_3, function);
                __pyx_t_17 = 1;
              }
            }
            __pyx_t_18 = PyTuple_New(4+__pyx_t_17); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 1513, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_18);
            if (__pyx_t_16) {
              __Pyx_GIVEREF(__pyx_t_16); PyTuple_SET_ITEM(__pyx_t_18, 0, __pyx_t_16); __pyx_t_16 = NULL;
            }
            __Pyx_INCREF(__pyx_v_ref);
            __Pyx_GIVEREF(__pyx_v_ref);
            PyTuple_SET_ITEM(__pyx_t_18, 0+__pyx_t_17, __pyx_v_ref);
            __Pyx_GIVEREF(__pyx_t_13);
            PyTuple_SET_ITEM(__pyx_t_18, 1+__pyx_t_17, __pyx_t_13);
            __Pyx_GIVEREF(__pyx_t_14);
            PyTuple_SET_ITEM(__pyx_t_18, 2+__pyx_t_17, __pyx_t_14);
            __Pyx_GIVEREF(__pyx_t_15);
            PyTuple_SET_ITEM(__pyx_t_18, 3+__pyx_t_17, __pyx_t_15);
            __pyx_t_13 = 0;
            __pyx_t_14 = 0;
            __pyx_t_15 = 0;
            __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_18, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1513, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_4);
            __Pyx_DECREF(__pyx_t_18); __pyx_t_18 = 0;
            __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
            __pyx_t_3 = NULL;
            if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_6))) {
              __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_6);
              if (likely(__pyx_t_3)) {
                PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
                __Pyx_INCREF(__pyx_t_3);
                __Pyx_INCREF(function);
                __Pyx_DECREF_SET(__pyx_t_6, function);
              }
            }
            if (!__pyx_t_3) {
              __pyx_t_9 = __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_4); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1513, __pyx_L1_error)
              __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
              __Pyx_GOTREF(__pyx_t_9);
            } else {
              __pyx_t_18 = PyTuple_New(1+1); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 1513, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_18);
              __Pyx_GIVEREF(__pyx_t_3); PyTuple_SET_ITEM(__pyx_t_18, 0, __pyx_t_3); __pyx_t_3 = NULL;
              __Pyx_GIVEREF(__pyx_t_4);
              PyTuple_SET_ITEM(__pyx_t_18, 0+1, __pyx_t_4);
              __pyx_t_4 = 0;
              __pyx_t_9 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_18, NULL); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1513, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_9);
              __Pyx_DECREF(__pyx_t_18); __pyx_t_18 = 0;
            }
            __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
            __pyx_t_6 = NULL;
            if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_1))) {
              __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_1);
              if (likely(__pyx_t_6)) {
                PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
                __Pyx_INCREF(__pyx_t_6);
                __Pyx_INCREF(function);
                __Pyx_DECREF_SET(__pyx_t_1, function);
              }
            }
            if (!__pyx_t_6) {
              __pyx_t_7 = __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_t_9); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1513, __pyx_L1_error)
              __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
              __Pyx_GOTREF(__pyx_t_7);
            } else {
              __pyx_t_18 = PyTuple_New(1+1); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 1513, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_18);
              __Pyx_GIVEREF(__pyx_t_6); PyTuple_SET_ITEM(__pyx_t_18, 0, __pyx_t_6); __pyx_t_6 = NULL;
              __Pyx_GIVEREF(__pyx_t_9);
              PyTuple_SET_ITEM(__pyx_t_18, 0+1, __pyx_t_9);
              __pyx_t_9 = 0;
              __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_18, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1513, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_7);
              __Pyx_DECREF(__pyx_t_18); __pyx_t_18 = 0;
            }
            __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
            __pyx_t_1 = PyNumber_InPlaceAdd(__pyx_v_alt_seq, __pyx_t_7); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1513, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_1);
            __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
            __Pyx_DECREF_SET(__pyx_v_alt_seq, __pyx_t_1);
            __pyx_t_1 = 0;
          }

          /* "vapor_vali/Simple_function.pyx":1511
 *             if not window_size=='Error':
 *                 alt_seq=ref_seq[:flank_length]
 *                 for x in sv_info:             # <<<<<<<<<<<<<<
 *                     if x[-1]=='del':continue
 *                     elif x[-1]=='inv':  alt_seq+=reverse(complementary(ref_seq_readin(ref,x[0],x[1],x[2])))
 */
          __pyx_L8_continue:;
        }
        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

        /* "vapor_vali/Simple_function.pyx":1514
 *                     if x[-1]=='del':continue
 *                     elif x[-1]=='inv':  alt_seq+=reverse(complementary(ref_seq_readin(ref,x[0],x[1],x[2])))
 *                 alt_seq+=ref_seq[-flank_length:]             # <<<<<<<<<<<<<<
 *                 [window_size,window_size_qc]=window_size_refine(alt_seq)
 *                 if not window_size=='Error':
 */
        __pyx_t_2 = PyNumber_Negative(__pyx_v_flank_length); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1514, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
        __pyx_t_1 = __Pyx_PyObject_GetSlice(__pyx_v_ref_seq, 0, 0, &__pyx_t_2, NULL, NULL, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1514, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
        __pyx_t_2 = PyNumber_InPlaceAdd(__pyx_v_alt_seq, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1514, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
        __Pyx_DECREF_SET(__pyx_v_alt_seq, __pyx_t_2);
        __pyx_t_2 = 0;

        /* "vapor_vali/Simple_function.pyx":1515
 *                     elif x[-1]=='inv':  alt_seq+=reverse(complementary(ref_seq_readin(ref,x[0],x[1],x[2])))
 *                 alt_seq+=ref_seq[-flank_length:]
 *                 [window_size,window_size_qc]=window_size_refine(alt_seq)             # <<<<<<<<<<<<<<
 *                 if not window_size=='Error':
 *                     all_reads=simple_chop_pacbio_read_simple_short(bam_in,sv_block[:2]+[sv_block[1]+len(alt_seq)-2*flank_length],flank_length)
 */
        __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_window_size_refine); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1515, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        __pyx_t_7 = NULL;
        if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_1))) {
          __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_1);
          if (likely(__pyx_t_7)) {
            PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
            __Pyx_INCREF(__pyx_t_7);
            __Pyx_INCREF(function);
            __Pyx_DECREF_SET(__pyx_t_1, function);
          }
        }
        if (!__pyx_t_7) {
          __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_v_alt_seq); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1515, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_2);
        } else {
          __pyx_t_18 = PyTuple_New(1+1); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 1515, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_18);
          __Pyx_GIVEREF(__pyx_t_7); PyTuple_SET_ITEM(__pyx_t_18, 0, __pyx_t_7); __pyx_t_7 = NULL;
          __Pyx_INCREF(__pyx_v_alt_seq);
          __Pyx_GIVEREF(__pyx_v_alt_seq);
          PyTuple_SET_ITEM(__pyx_t_18, 0+1, __pyx_v_alt_seq);
          __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_18, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1515, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_2);
          __Pyx_DECREF(__pyx_t_18); __pyx_t_18 = 0;
        }
        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
        if ((likely(PyTuple_CheckExact(__pyx_t_2))) || (PyList_CheckExact(__pyx_t_2))) {
          PyObject* sequence = __pyx_t_2;
          #if CYTHON_COMPILING_IN_CPYTHON
          Py_ssize_t size = Py_SIZE(sequence);
          #else
          Py_ssize_t size = PySequence_Size(sequence);
          #endif
          if (unlikely(size != 2)) {
            if (size > 2) __Pyx_RaiseTooManyValuesError(2);
            else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
            __PYX_ERR(0, 1515, __pyx_L1_error)
          }
          #if CYTHON_COMPILING_IN_CPYTHON
          if (likely(PyTuple_CheckExact(sequence))) {
            __pyx_t_1 = PyTuple_GET_ITEM(sequence, 0); 
            __pyx_t_18 = PyTuple_GET_ITEM(sequence, 1); 
          } else {
            __pyx_t_1 = PyList_GET_ITEM(sequence, 0); 
            __pyx_t_18 = PyList_GET_ITEM(sequence, 1); 
          }
          __Pyx_INCREF(__pyx_t_1);
          __Pyx_INCREF(__pyx_t_18);
          #else
          __pyx_t_1 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1515, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_1);
          __pyx_t_18 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 1515, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_18);
          #endif
          __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
        } else {
          Py_ssize_t index = -1;
          __pyx_t_7 = PyObject_GetIter(__pyx_t_2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1515, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_7);
          __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
          __pyx_t_10 = Py_TYPE(__pyx_t_7)->tp_iternext;
          index = 0; __pyx_t_1 = __pyx_t_10(__pyx_t_7); if (unlikely(!__pyx_t_1)) goto __pyx_L11_unpacking_failed;
          __Pyx_GOTREF(__pyx_t_1);
          index = 1; __pyx_t_18 = __pyx_t_10(__pyx_t_7); if (unlikely(!__pyx_t_18)) goto __pyx_L11_unpacking_failed;
          __Pyx_GOTREF(__pyx_t_18);
          if (__Pyx_IternextUnpackEndCheck(__pyx_t_10(__pyx_t_7), 2) < 0) __PYX_ERR(0, 1515, __pyx_L1_error)
          __pyx_t_10 = NULL;
          __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
          goto __pyx_L12_unpacking_done;
          __pyx_L11_unpacking_failed:;
          __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
          __pyx_t_10 = NULL;
          if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
          __PYX_ERR(0, 1515, __pyx_L1_error)
          __pyx_L12_unpacking_done:;
        }
        __Pyx_DECREF_SET(__pyx_v_window_size, __pyx_t_1);
        __pyx_t_1 = 0;
        __Pyx_DECREF_SET(__pyx_v_window_size_qc, __pyx_t_18);
        __pyx_t_18 = 0;

        /* "vapor_vali/Simple_function.pyx":1516
 *                 alt_seq+=ref_seq[-flank_length:]
 *                 [window_size,window_size_qc]=window_size_refine(alt_seq)
 *                 if not window_size=='Error':             # <<<<<<<<<<<<<<
 *                     all_reads=simple_chop_pacbio_read_simple_short(bam_in,sv_block[:2]+[sv_block[1]+len(alt_seq)-2*flank_length],flank_length)
 *                     if len(all_reads)>0:
 */
        __pyx_t_11 = (__Pyx_PyString_Equals(__pyx_v_window_size, __pyx_n_s_Error, Py_EQ)); if (unlikely(__pyx_t_11 < 0)) __PYX_ERR(0, 1516, __pyx_L1_error)
        __pyx_t_5 = ((!__pyx_t_11) != 0);
        if (__pyx_t_5) {

          /* "vapor_vali/Simple_function.pyx":1517
 *                 [window_size,window_size_qc]=window_size_refine(alt_seq)
 *                 if not window_size=='Error':
 *                     all_reads=simple_chop_pacbio_read_simple_short(bam_in,sv_block[:2]+[sv_block[1]+len(alt_seq)-2*flank_length],flank_length)             # <<<<<<<<<<<<<<
 *                     if len(all_reads)>0:
 *                         best_read_rec=''
 */
          __pyx_t_18 = __Pyx_GetModuleGlobalName(__pyx_n_s_simple_chop_pacbio_read_simple_s); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 1517, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_18);
          __pyx_t_1 = __Pyx_PyList_GetSlice(__pyx_v_sv_block, 0, 2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1517, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_1);
          __pyx_t_7 = __Pyx_GetItemInt_List(__pyx_v_sv_block, 1, long, 1, __Pyx_PyInt_From_long, 1, 0, 1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1517, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_7);
          __pyx_t_8 = PyObject_Length(__pyx_v_alt_seq); if (unlikely(__pyx_t_8 == -1)) __PYX_ERR(0, 1517, __pyx_L1_error)
          __pyx_t_9 = PyInt_FromSsize_t(__pyx_t_8); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1517, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_9);
          __pyx_t_6 = PyNumber_Add(__pyx_t_7, __pyx_t_9); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1517, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_6);
          __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
          __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
          __pyx_t_9 = PyNumber_Multiply(__pyx_int_2, __pyx_v_flank_length); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1517, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_9);
          __pyx_t_7 = PyNumber_Subtract(__pyx_t_6, __pyx_t_9); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1517, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_7);
          __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
          __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
          __pyx_t_9 = PyList_New(1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1517, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_9);
          __Pyx_GIVEREF(__pyx_t_7);
          PyList_SET_ITEM(__pyx_t_9, 0, __pyx_t_7);
          __pyx_t_7 = 0;
          __pyx_t_7 = PyNumber_Add(__pyx_t_1, __pyx_t_9); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1517, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_7);
          __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
          __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
          __pyx_t_9 = NULL;
          __pyx_t_8 = 0;
          if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_18))) {
            __pyx_t_9 = PyMethod_GET_SELF(__pyx_t_18);
            if (likely(__pyx_t_9)) {
              PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_18);
              __Pyx_INCREF(__pyx_t_9);
              __Pyx_INCREF(function);
              __Pyx_DECREF_SET(__pyx_t_18, function);
              __pyx_t_8 = 1;
            }
          }
          __pyx_t_1 = PyTuple_New(3+__pyx_t_8); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1517, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_1);
          if (__pyx_t_9) {
            __Pyx_GIVEREF(__pyx_t_9); PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_9); __pyx_t_9 = NULL;
          }
          __Pyx_INCREF(__pyx_v_bam_in);
          __Pyx_GIVEREF(__pyx_v_bam_in);
          PyTuple_SET_ITEM(__pyx_t_1, 0+__pyx_t_8, __pyx_v_bam_in);
          __Pyx_GIVEREF(__pyx_t_7);
          PyTuple_SET_ITEM(__pyx_t_1, 1+__pyx_t_8, __pyx_t_7);
          __Pyx_INCREF(__pyx_v_flank_length);
          __Pyx_GIVEREF(__pyx_v_flank_length);
          PyTuple_SET_ITEM(__pyx_t_1, 2+__pyx_t_8, __pyx_v_flank_length);
          __pyx_t_7 = 0;
          __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_18, __pyx_t_1, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1517, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_2);
          __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
          __Pyx_DECREF(__pyx_t_18); __pyx_t_18 = 0;
          __pyx_v_all_reads = __pyx_t_2;
          __pyx_t_2 = 0;

          /* "vapor_vali/Simple_function.pyx":1518
 *                 if not window_size=='Error':
 *                     all_reads=simple_chop_pacbio_read_simple_short(bam_in,sv_block[:2]+[sv_block[1]+len(alt_seq)-2*flank_length],flank_length)
 *                     if len(all_reads)>0:             # <<<<<<<<<<<<<<
 *                         best_read_rec=''
 *                         for x in all_reads:
 */
          __pyx_t_8 = PyObject_Length(__pyx_v_all_reads); if (unlikely(__pyx_t_8 == -1)) __PYX_ERR(0, 1518, __pyx_L1_error)
          __pyx_t_5 = ((__pyx_t_8 > 0) != 0);
          if (__pyx_t_5) {

            /* "vapor_vali/Simple_function.pyx":1519
 *                     all_reads=simple_chop_pacbio_read_simple_short(bam_in,sv_block[:2]+[sv_block[1]+len(alt_seq)-2*flank_length],flank_length)
 *                     if len(all_reads)>0:
 *                         best_read_rec=''             # <<<<<<<<<<<<<<
 *                         for x in all_reads:
 *                             vapor_single_read_score=calcu_vapor_single_read_score_abs_dis_m1b(ref_seq,alt_seq,x,window_size)
 */
            __Pyx_INCREF(__pyx_kp_s__24);
            __Pyx_DECREF_SET(__pyx_v_best_read_rec, __pyx_kp_s__24);

            /* "vapor_vali/Simple_function.pyx":1520
 *                     if len(all_reads)>0:
 *                         best_read_rec=''
 *                         for x in all_reads:             # <<<<<<<<<<<<<<
 *                             vapor_single_read_score=calcu_vapor_single_read_score_abs_dis_m1b(ref_seq,alt_seq,x,window_size)
 *                             if not 0 in vapor_single_read_score:
 */
            if (likely(PyList_CheckExact(__pyx_v_all_reads)) || PyTuple_CheckExact(__pyx_v_all_reads)) {
              __pyx_t_2 = __pyx_v_all_reads; __Pyx_INCREF(__pyx_t_2); __pyx_t_8 = 0;
              __pyx_t_12 = NULL;
            } else {
              __pyx_t_8 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_v_all_reads); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1520, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_2);
              __pyx_t_12 = Py_TYPE(__pyx_t_2)->tp_iternext; if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1520, __pyx_L1_error)
            }
            for (;;) {
              if (likely(!__pyx_t_12)) {
                if (likely(PyList_CheckExact(__pyx_t_2))) {
                  if (__pyx_t_8 >= PyList_GET_SIZE(__pyx_t_2)) break;
                  #if CYTHON_COMPILING_IN_CPYTHON
                  __pyx_t_18 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_8); __Pyx_INCREF(__pyx_t_18); __pyx_t_8++; if (unlikely(0 < 0)) __PYX_ERR(0, 1520, __pyx_L1_error)
                  #else
                  __pyx_t_18 = PySequence_ITEM(__pyx_t_2, __pyx_t_8); __pyx_t_8++; if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 1520, __pyx_L1_error)
                  __Pyx_GOTREF(__pyx_t_18);
                  #endif
                } else {
                  if (__pyx_t_8 >= PyTuple_GET_SIZE(__pyx_t_2)) break;
                  #if CYTHON_COMPILING_IN_CPYTHON
                  __pyx_t_18 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_8); __Pyx_INCREF(__pyx_t_18); __pyx_t_8++; if (unlikely(0 < 0)) __PYX_ERR(0, 1520, __pyx_L1_error)
                  #else
                  __pyx_t_18 = PySequence_ITEM(__pyx_t_2, __pyx_t_8); __pyx_t_8++; if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 1520, __pyx_L1_error)
                  __Pyx_GOTREF(__pyx_t_18);
                  #endif
                }
              } else {
                __pyx_t_18 = __pyx_t_12(__pyx_t_2);
                if (unlikely(!__pyx_t_18)) {
                  PyObject* exc_type = PyErr_Occurred();
                  if (exc_type) {
                    if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
                    else __PYX_ERR(0, 1520, __pyx_L1_error)
                  }
                  break;
                }
                __Pyx_GOTREF(__pyx_t_18);
              }
              __Pyx_XDECREF_SET(__pyx_v_x, __pyx_t_18);
              __pyx_t_18 = 0;

              /* "vapor_vali/Simple_function.pyx":1521
 *                         best_read_rec=''
 *                         for x in all_reads:
 *                             vapor_single_read_score=calcu_vapor_single_read_score_abs_dis_m1b(ref_seq,alt_seq,x,window_size)             # <<<<<<<<<<<<<<
 *                             if not 0 in vapor_single_read_score:
 *                                 vapor_score_list.append(1-float(vapor_single_read_score[1])/float(vapor_single_read_score[0]))
 */
              __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_calcu_vapor_single_read_score_ab); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1521, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_1);
              __pyx_t_7 = NULL;
              __pyx_t_17 = 0;
              if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_1))) {
                __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_1);
                if (likely(__pyx_t_7)) {
                  PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
                  __Pyx_INCREF(__pyx_t_7);
                  __Pyx_INCREF(function);
                  __Pyx_DECREF_SET(__pyx_t_1, function);
                  __pyx_t_17 = 1;
                }
              }
              __pyx_t_9 = PyTuple_New(4+__pyx_t_17); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1521, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_9);
              if (__pyx_t_7) {
                __Pyx_GIVEREF(__pyx_t_7); PyTuple_SET_ITEM(__pyx_t_9, 0, __pyx_t_7); __pyx_t_7 = NULL;
              }
              __Pyx_INCREF(__pyx_v_ref_seq);
              __Pyx_GIVEREF(__pyx_v_ref_seq);
              PyTuple_SET_ITEM(__pyx_t_9, 0+__pyx_t_17, __pyx_v_ref_seq);
              __Pyx_INCREF(__pyx_v_alt_seq);
              __Pyx_GIVEREF(__pyx_v_alt_seq);
              PyTuple_SET_ITEM(__pyx_t_9, 1+__pyx_t_17, __pyx_v_alt_seq);
              __Pyx_INCREF(__pyx_v_x);
              __Pyx_GIVEREF(__pyx_v_x);
              PyTuple_SET_ITEM(__pyx_t_9, 2+__pyx_t_17, __pyx_v_x);
              __Pyx_INCREF(__pyx_v_window_size);
              __Pyx_GIVEREF(__pyx_v_window_size);
              PyTuple_SET_ITEM(__pyx_t_9, 3+__pyx_t_17, __pyx_v_window_size);
              __pyx_t_18 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_9, NULL); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 1521, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_18);
              __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
              __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
              __Pyx_XDECREF_SET(__pyx_v_vapor_single_read_score, __pyx_t_18);
              __pyx_t_18 = 0;

              /* "vapor_vali/Simple_function.pyx":1522
 *                         for x in all_reads:
 *                             vapor_single_read_score=calcu_vapor_single_read_score_abs_dis_m1b(ref_seq,alt_seq,x,window_size)
 *                             if not 0 in vapor_single_read_score:             # <<<<<<<<<<<<<<
 *                                 vapor_score_list.append(1-float(vapor_single_read_score[1])/float(vapor_single_read_score[0]))
 *                                 if vapor_score_list[-1]==max(vapor_score_list):best_read_rec=x
 */
              __pyx_t_5 = (__Pyx_PySequence_ContainsTF(__pyx_int_0, __pyx_v_vapor_single_read_score, Py_NE)); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 1522, __pyx_L1_error)
              __pyx_t_11 = (__pyx_t_5 != 0);
              if (__pyx_t_11) {

                /* "vapor_vali/Simple_function.pyx":1523
 *                             vapor_single_read_score=calcu_vapor_single_read_score_abs_dis_m1b(ref_seq,alt_seq,x,window_size)
 *                             if not 0 in vapor_single_read_score:
 *                                 vapor_score_list.append(1-float(vapor_single_read_score[1])/float(vapor_single_read_score[0]))             # <<<<<<<<<<<<<<
 *                                 if vapor_score_list[-1]==max(vapor_score_list):best_read_rec=x
 *                         make_event_figure_1(vapor_score_list,best_read_rec,window_size,ref_seq,alt_seq,out_figure_name)
 */
                __pyx_t_18 = __Pyx_GetItemInt(__pyx_v_vapor_single_read_score, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 1523, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_18);
                __pyx_t_19 = __Pyx_PyObject_AsDouble(__pyx_t_18); if (unlikely(__pyx_t_19 == ((double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1523, __pyx_L1_error)
                __Pyx_DECREF(__pyx_t_18); __pyx_t_18 = 0;
                __pyx_t_18 = __Pyx_GetItemInt(__pyx_v_vapor_single_read_score, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 1523, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_18);
                __pyx_t_20 = __Pyx_PyObject_AsDouble(__pyx_t_18); if (unlikely(__pyx_t_20 == ((double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1523, __pyx_L1_error)
                __Pyx_DECREF(__pyx_t_18); __pyx_t_18 = 0;
                if (unlikely(__pyx_t_20 == 0)) {
                  PyErr_SetString(PyExc_ZeroDivisionError, "float division");
                  __PYX_ERR(0, 1523, __pyx_L1_error)
                }
                __pyx_t_18 = PyFloat_FromDouble((1.0 - (__pyx_t_19 / __pyx_t_20))); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 1523, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_18);
                __pyx_t_21 = __Pyx_PyObject_Append(__pyx_v_vapor_score_list, __pyx_t_18); if (unlikely(__pyx_t_21 == -1)) __PYX_ERR(0, 1523, __pyx_L1_error)
                __Pyx_DECREF(__pyx_t_18); __pyx_t_18 = 0;

                /* "vapor_vali/Simple_function.pyx":1524
 *                             if not 0 in vapor_single_read_score:
 *                                 vapor_score_list.append(1-float(vapor_single_read_score[1])/float(vapor_single_read_score[0]))
 *                                 if vapor_score_list[-1]==max(vapor_score_list):best_read_rec=x             # <<<<<<<<<<<<<<
 *                         make_event_figure_1(vapor_score_list,best_read_rec,window_size,ref_seq,alt_seq,out_figure_name)
 *                     else:
 */
                __pyx_t_18 = __Pyx_GetItemInt(__pyx_v_vapor_score_list, -1L, long, 1, __Pyx_PyInt_From_long, 0, 1, 1); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 1524, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_18);
                __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1524, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_1);
                __Pyx_INCREF(__pyx_v_vapor_score_list);
                __Pyx_GIVEREF(__pyx_v_vapor_score_list);
                PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_vapor_score_list);
                __pyx_t_9 = __Pyx_PyObject_Call(__pyx_builtin_max, __pyx_t_1, NULL); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1524, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_9);
                __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
                __pyx_t_1 = PyObject_RichCompare(__pyx_t_18, __pyx_t_9, Py_EQ); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1524, __pyx_L1_error)
                __Pyx_DECREF(__pyx_t_18); __pyx_t_18 = 0;
                __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
                __pyx_t_11 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_11 < 0)) __PYX_ERR(0, 1524, __pyx_L1_error)
                __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
                if (__pyx_t_11) {
                  __Pyx_INCREF(__pyx_v_x);
                  __Pyx_DECREF_SET(__pyx_v_best_read_rec, __pyx_v_x);
                }

                /* "vapor_vali/Simple_function.pyx":1522
 *                         for x in all_reads:
 *                             vapor_single_read_score=calcu_vapor_single_read_score_abs_dis_m1b(ref_seq,alt_seq,x,window_size)
 *                             if not 0 in vapor_single_read_score:             # <<<<<<<<<<<<<<
 *                                 vapor_score_list.append(1-float(vapor_single_read_score[1])/float(vapor_single_read_score[0]))
 *                                 if vapor_score_list[-1]==max(vapor_score_list):best_read_rec=x
 */
              }

              /* "vapor_vali/Simple_function.pyx":1520
 *                     if len(all_reads)>0:
 *                         best_read_rec=''
 *                         for x in all_reads:             # <<<<<<<<<<<<<<
 *                             vapor_single_read_score=calcu_vapor_single_read_score_abs_dis_m1b(ref_seq,alt_seq,x,window_size)
 *                             if not 0 in vapor_single_read_score:
 */
            }
            __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

            /* "vapor_vali/Simple_function.pyx":1525
 *                                 vapor_score_list.append(1-float(vapor_single_read_score[1])/float(vapor_single_read_score[0]))
 *                                 if vapor_score_list[-1]==max(vapor_score_list):best_read_rec=x
 *                         make_event_figure_1(vapor_score_list,best_read_rec,window_size,ref_seq,alt_seq,out_figure_name)             # <<<<<<<<<<<<<<
 *                     else:
 *                         if len(sv_info)==2 and [i[-1] for i in sv_info]==['del','inv']:
 */
            __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_make_event_figure_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1525, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_1);
            __pyx_t_9 = NULL;
            __pyx_t_8 = 0;
            if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_1))) {
              __pyx_t_9 = PyMethod_GET_SELF(__pyx_t_1);
              if (likely(__pyx_t_9)) {
                PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
                __Pyx_INCREF(__pyx_t_9);
                __Pyx_INCREF(function);
                __Pyx_DECREF_SET(__pyx_t_1, function);
                __pyx_t_8 = 1;
              }
            }
            __pyx_t_18 = PyTuple_New(6+__pyx_t_8); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 1525, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_18);
            if (__pyx_t_9) {
              __Pyx_GIVEREF(__pyx_t_9); PyTuple_SET_ITEM(__pyx_t_18, 0, __pyx_t_9); __pyx_t_9 = NULL;
            }
            __Pyx_INCREF(__pyx_v_vapor_score_list);
            __Pyx_GIVEREF(__pyx_v_vapor_score_list);
            PyTuple_SET_ITEM(__pyx_t_18, 0+__pyx_t_8, __pyx_v_vapor_score_list);
            __Pyx_INCREF(__pyx_v_best_read_rec);
            __Pyx_GIVEREF(__pyx_v_best_read_rec);
            PyTuple_SET_ITEM(__pyx_t_18, 1+__pyx_t_8, __pyx_v_best_read_rec);
            __Pyx_INCREF(__pyx_v_window_size);
            __Pyx_GIVEREF(__pyx_v_window_size);
            PyTuple_SET_ITEM(__pyx_t_18, 2+__pyx_t_8, __pyx_v_window_size);
            __Pyx_INCREF(__pyx_v_ref_seq);
            __Pyx_GIVEREF(__pyx_v_ref_seq);
            PyTuple_SET_ITEM(__pyx_t_18, 3+__pyx_t_8, __pyx_v_ref_seq);
            __Pyx_INCREF(__pyx_v_alt_seq);
            __Pyx_GIVEREF(__pyx_v_alt_seq);
            PyTuple_SET_ITEM(__pyx_t_18, 4+__pyx_t_8, __pyx_v_alt_seq);
            __Pyx_INCREF(__pyx_v_out_figure_name);
            __Pyx_GIVEREF(__pyx_v_out_figure_name);
            PyTuple_SET_ITEM(__pyx_t_18, 5+__pyx_t_8, __pyx_v_out_figure_name);
            __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_18, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1525, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_2);
            __Pyx_DECREF(__pyx_t_18); __pyx_t_18 = 0;
            __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
            __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

            /* "vapor_vali/Simple_function.pyx":1518
 *                 if not window_size=='Error':
 *                     all_reads=simple_chop_pacbio_read_simple_short(bam_in,sv_block[:2]+[sv_block[1]+len(alt_seq)-2*flank_length],flank_length)
 *                     if len(all_reads)>0:             # <<<<<<<<<<<<<<
 *                         best_read_rec=''
 *                         for x in all_reads:
 */
            goto __pyx_L14;
          }

          /* "vapor_vali/Simple_function.pyx":1527
 *                         make_event_figure_1(vapor_score_list,best_read_rec,window_size,ref_seq,alt_seq,out_figure_name)
 *                     else:
 *                         if len(sv_info)==2 and [i[-1] for i in sv_info]==['del','inv']:             # <<<<<<<<<<<<<<
 *                             vapor_score_list=vapor_long_del_inv(bam_in,ref,sv_info,out_figure_name)
 *         else:
 */
          /*else*/ {
            __pyx_t_8 = PyObject_Length(__pyx_v_sv_info); if (unlikely(__pyx_t_8 == -1)) __PYX_ERR(0, 1527, __pyx_L1_error)
            __pyx_t_5 = ((__pyx_t_8 == 2) != 0);
            if (__pyx_t_5) {
            } else {
              __pyx_t_11 = __pyx_t_5;
              goto __pyx_L20_bool_binop_done;
            }
            __pyx_t_2 = PyList_New(0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1527, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_2);
            if (likely(PyList_CheckExact(__pyx_v_sv_info)) || PyTuple_CheckExact(__pyx_v_sv_info)) {
              __pyx_t_1 = __pyx_v_sv_info; __Pyx_INCREF(__pyx_t_1); __pyx_t_8 = 0;
              __pyx_t_12 = NULL;
            } else {
              __pyx_t_8 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_v_sv_info); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1527, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_1);
              __pyx_t_12 = Py_TYPE(__pyx_t_1)->tp_iternext; if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1527, __pyx_L1_error)
            }
            for (;;) {
              if (likely(!__pyx_t_12)) {
                if (likely(PyList_CheckExact(__pyx_t_1))) {
                  if (__pyx_t_8 >= PyList_GET_SIZE(__pyx_t_1)) break;
                  #if CYTHON_COMPILING_IN_CPYTHON
                  __pyx_t_18 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_8); __Pyx_INCREF(__pyx_t_18); __pyx_t_8++; if (unlikely(0 < 0)) __PYX_ERR(0, 1527, __pyx_L1_error)
                  #else
                  __pyx_t_18 = PySequence_ITEM(__pyx_t_1, __pyx_t_8); __pyx_t_8++; if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 1527, __pyx_L1_error)
                  __Pyx_GOTREF(__pyx_t_18);
                  #endif
                } else {
                  if (__pyx_t_8 >= PyTuple_GET_SIZE(__pyx_t_1)) break;
                  #if CYTHON_COMPILING_IN_CPYTHON
                  __pyx_t_18 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_8); __Pyx_INCREF(__pyx_t_18); __pyx_t_8++; if (unlikely(0 < 0)) __PYX_ERR(0, 1527, __pyx_L1_error)
                  #else
                  __pyx_t_18 = PySequence_ITEM(__pyx_t_1, __pyx_t_8); __pyx_t_8++; if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 1527, __pyx_L1_error)
                  __Pyx_GOTREF(__pyx_t_18);
                  #endif
                }
              } else {
                __pyx_t_18 = __pyx_t_12(__pyx_t_1);
                if (unlikely(!__pyx_t_18)) {
                  PyObject* exc_type = PyErr_Occurred();
                  if (exc_type) {
                    if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
                    else __PYX_ERR(0, 1527, __pyx_L1_error)
                  }
                  break;
                }
                __Pyx_GOTREF(__pyx_t_18);
              }
              __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_18);
              __pyx_t_18 = 0;
              __pyx_t_18 = __Pyx_GetItemInt(__pyx_v_i, -1L, long, 1, __Pyx_PyInt_From_long, 0, 1, 1); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 1527, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_18);
              if (unlikely(__Pyx_ListComp_Append(__pyx_t_2, (PyObject*)__pyx_t_18))) __PYX_ERR(0, 1527, __pyx_L1_error)
              __Pyx_DECREF(__pyx_t_18); __pyx_t_18 = 0;
            }
            __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
            __pyx_t_1 = PyList_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1527, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_1);
            __Pyx_INCREF(__pyx_n_s_del);
            __Pyx_GIVEREF(__pyx_n_s_del);
            PyList_SET_ITEM(__pyx_t_1, 0, __pyx_n_s_del);
            __Pyx_INCREF(__pyx_n_s_inv);
            __Pyx_GIVEREF(__pyx_n_s_inv);
            PyList_SET_ITEM(__pyx_t_1, 1, __pyx_n_s_inv);
            __pyx_t_18 = PyObject_RichCompare(__pyx_t_2, __pyx_t_1, Py_EQ); __Pyx_XGOTREF(__pyx_t_18); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 1527, __pyx_L1_error)
            __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
            __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
            __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_18); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 1527, __pyx_L1_error)
            __Pyx_DECREF(__pyx_t_18); __pyx_t_18 = 0;
            __pyx_t_11 = __pyx_t_5;
            __pyx_L20_bool_binop_done:;
            if (__pyx_t_11) {

              /* "vapor_vali/Simple_function.pyx":1528
 *                     else:
 *                         if len(sv_info)==2 and [i[-1] for i in sv_info]==['del','inv']:
 *                             vapor_score_list=vapor_long_del_inv(bam_in,ref,sv_info,out_figure_name)             # <<<<<<<<<<<<<<
 *         else:
 *             if len(sv_info)==2 and [i[-1] for i in sv_info]==['del','inv']:
 */
              __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_vapor_long_del_inv); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1528, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_1);
              __pyx_t_2 = NULL;
              __pyx_t_8 = 0;
              if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_1))) {
                __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_1);
                if (likely(__pyx_t_2)) {
                  PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
                  __Pyx_INCREF(__pyx_t_2);
                  __Pyx_INCREF(function);
                  __Pyx_DECREF_SET(__pyx_t_1, function);
                  __pyx_t_8 = 1;
                }
              }
              __pyx_t_9 = PyTuple_New(4+__pyx_t_8); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1528, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_9);
              if (__pyx_t_2) {
                __Pyx_GIVEREF(__pyx_t_2); PyTuple_SET_ITEM(__pyx_t_9, 0, __pyx_t_2); __pyx_t_2 = NULL;
              }
              __Pyx_INCREF(__pyx_v_bam_in);
              __Pyx_GIVEREF(__pyx_v_bam_in);
              PyTuple_SET_ITEM(__pyx_t_9, 0+__pyx_t_8, __pyx_v_bam_in);
              __Pyx_INCREF(__pyx_v_ref);
              __Pyx_GIVEREF(__pyx_v_ref);
              PyTuple_SET_ITEM(__pyx_t_9, 1+__pyx_t_8, __pyx_v_ref);
              __Pyx_INCREF(__pyx_v_sv_info);
              __Pyx_GIVEREF(__pyx_v_sv_info);
              PyTuple_SET_ITEM(__pyx_t_9, 2+__pyx_t_8, __pyx_v_sv_info);
              __Pyx_INCREF(__pyx_v_out_figure_name);
              __Pyx_GIVEREF(__pyx_v_out_figure_name);
              PyTuple_SET_ITEM(__pyx_t_9, 3+__pyx_t_8, __pyx_v_out_figure_name);
              __pyx_t_18 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_9, NULL); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 1528, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_18);
              __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
              __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
              __Pyx_DECREF_SET(__pyx_v_vapor_score_list, __pyx_t_18);
              __pyx_t_18 = 0;

              /* "vapor_vali/Simple_function.pyx":1527
 *                         make_event_figure_1(vapor_score_list,best_read_rec,window_size,ref_seq,alt_seq,out_figure_name)
 *                     else:
 *                         if len(sv_info)==2 and [i[-1] for i in sv_info]==['del','inv']:             # <<<<<<<<<<<<<<
 *                             vapor_score_list=vapor_long_del_inv(bam_in,ref,sv_info,out_figure_name)
 *         else:
 */
            }
          }
          __pyx_L14:;

          /* "vapor_vali/Simple_function.pyx":1516
 *                 alt_seq+=ref_seq[-flank_length:]
 *                 [window_size,window_size_qc]=window_size_refine(alt_seq)
 *                 if not window_size=='Error':             # <<<<<<<<<<<<<<
 *                     all_reads=simple_chop_pacbio_read_simple_short(bam_in,sv_block[:2]+[sv_block[1]+len(alt_seq)-2*flank_length],flank_length)
 *                     if len(all_reads)>0:
 */
        }

        /* "vapor_vali/Simple_function.pyx":1509
 *             ref_seq=ref_seq_readin(ref,sv_block[0],sv_block[1]-flank_length,sv_block[2]+flank_length)
 *             [window_size,window_size_qc]=window_size_refine(ref_seq)
 *             if not window_size=='Error':             # <<<<<<<<<<<<<<
 *                 alt_seq=ref_seq[:flank_length]
 *                 for x in sv_info:
 */
      }

      /* "vapor_vali/Simple_function.pyx":1506
 *     best_read_rec=''
 *     if sv_info[1][1]-sv_info[0][2]<100:
 *         if sv_block[2]-sv_block[1]<default_max_sv_test: #only try to read in all reads with sv <100K; else: try breakpoints ;             # <<<<<<<<<<<<<<
 *             ref_seq=ref_seq_readin(ref,sv_block[0],sv_block[1]-flank_length,sv_block[2]+flank_length)
 *             [window_size,window_size_qc]=window_size_refine(ref_seq)
 */
      goto __pyx_L4;
    }

    /* "vapor_vali/Simple_function.pyx":1530
 *                             vapor_score_list=vapor_long_del_inv(bam_in,ref,sv_info,out_figure_name)
 *         else:
 *             if len(sv_info)==2 and [i[-1] for i in sv_info]==['del','inv']:             # <<<<<<<<<<<<<<
 *                 vapor_score_list=vapor_long_del_inv(bam_in,ref,sv_info,out_figure_name)
 *     else:
 */
    /*else*/ {
      __pyx_t_8 = PyObject_Length(__pyx_v_sv_info); if (unlikely(__pyx_t_8 == -1)) __PYX_ERR(0, 1530, __pyx_L1_error)
      __pyx_t_5 = ((__pyx_t_8 == 2) != 0);
      if (__pyx_t_5) {
      } else {
        __pyx_t_11 = __pyx_t_5;
        goto __pyx_L25_bool_binop_done;
      }
      __pyx_t_18 = PyList_New(0); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 1530, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_18);
      if (likely(PyList_CheckExact(__pyx_v_sv_info)) || PyTuple_CheckExact(__pyx_v_sv_info)) {
        __pyx_t_1 = __pyx_v_sv_info; __Pyx_INCREF(__pyx_t_1); __pyx_t_8 = 0;
        __pyx_t_12 = NULL;
      } else {
        __pyx_t_8 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_v_sv_info); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1530, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        __pyx_t_12 = Py_TYPE(__pyx_t_1)->tp_iternext; if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1530, __pyx_L1_error)
      }
      for (;;) {
        if (likely(!__pyx_t_12)) {
          if (likely(PyList_CheckExact(__pyx_t_1))) {
            if (__pyx_t_8 >= PyList_GET_SIZE(__pyx_t_1)) break;
            #if CYTHON_COMPILING_IN_CPYTHON
            __pyx_t_9 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_8); __Pyx_INCREF(__pyx_t_9); __pyx_t_8++; if (unlikely(0 < 0)) __PYX_ERR(0, 1530, __pyx_L1_error)
            #else
            __pyx_t_9 = PySequence_ITEM(__pyx_t_1, __pyx_t_8); __pyx_t_8++; if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1530, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_9);
            #endif
          } else {
            if (__pyx_t_8 >= PyTuple_GET_SIZE(__pyx_t_1)) break;
            #if CYTHON_COMPILING_IN_CPYTHON
            __pyx_t_9 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_8); __Pyx_INCREF(__pyx_t_9); __pyx_t_8++; if (unlikely(0 < 0)) __PYX_ERR(0, 1530, __pyx_L1_error)
            #else
            __pyx_t_9 = PySequence_ITEM(__pyx_t_1, __pyx_t_8); __pyx_t_8++; if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1530, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_9);
            #endif
          }
        } else {
          __pyx_t_9 = __pyx_t_12(__pyx_t_1);
          if (unlikely(!__pyx_t_9)) {
            PyObject* exc_type = PyErr_Occurred();
            if (exc_type) {
              if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
              else __PYX_ERR(0, 1530, __pyx_L1_error)
            }
            break;
          }
          __Pyx_GOTREF(__pyx_t_9);
        }
        __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_9);
        __pyx_t_9 = 0;
        __pyx_t_9 = __Pyx_GetItemInt(__pyx_v_i, -1L, long, 1, __Pyx_PyInt_From_long, 0, 1, 1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1530, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_9);
        if (unlikely(__Pyx_ListComp_Append(__pyx_t_18, (PyObject*)__pyx_t_9))) __PYX_ERR(0, 1530, __pyx_L1_error)
        __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
      }
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_1 = PyList_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1530, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_INCREF(__pyx_n_s_del);
      __Pyx_GIVEREF(__pyx_n_s_del);
      PyList_SET_ITEM(__pyx_t_1, 0, __pyx_n_s_del);
      __Pyx_INCREF(__pyx_n_s_inv);
      __Pyx_GIVEREF(__pyx_n_s_inv);
      PyList_SET_ITEM(__pyx_t_1, 1, __pyx_n_s_inv);
      __pyx_t_9 = PyObject_RichCompare(__pyx_t_18, __pyx_t_1, Py_EQ); __Pyx_XGOTREF(__pyx_t_9); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1530, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_18); __pyx_t_18 = 0;
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_9); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 1530, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
      __pyx_t_11 = __pyx_t_5;
      __pyx_L25_bool_binop_done:;
      if (__pyx_t_11) {

        /* "vapor_vali/Simple_function.pyx":1531
 *         else:
 *             if len(sv_info)==2 and [i[-1] for i in sv_info]==['del','inv']:
 *                 vapor_score_list=vapor_long_del_inv(bam_in,ref,sv_info,out_figure_name)             # <<<<<<<<<<<<<<
 *     else:
 *         for sub_sv_info in sv_info:
 */
        __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_vapor_long_del_inv); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1531, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        __pyx_t_18 = NULL;
        __pyx_t_8 = 0;
        if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_1))) {
          __pyx_t_18 = PyMethod_GET_SELF(__pyx_t_1);
          if (likely(__pyx_t_18)) {
            PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
            __Pyx_INCREF(__pyx_t_18);
            __Pyx_INCREF(function);
            __Pyx_DECREF_SET(__pyx_t_1, function);
            __pyx_t_8 = 1;
          }
        }
        __pyx_t_2 = PyTuple_New(4+__pyx_t_8); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1531, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
        if (__pyx_t_18) {
          __Pyx_GIVEREF(__pyx_t_18); PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_18); __pyx_t_18 = NULL;
        }
        __Pyx_INCREF(__pyx_v_bam_in);
        __Pyx_GIVEREF(__pyx_v_bam_in);
        PyTuple_SET_ITEM(__pyx_t_2, 0+__pyx_t_8, __pyx_v_bam_in);
        __Pyx_INCREF(__pyx_v_ref);
        __Pyx_GIVEREF(__pyx_v_ref);
        PyTuple_SET_ITEM(__pyx_t_2, 1+__pyx_t_8, __pyx_v_ref);
        __Pyx_INCREF(__pyx_v_sv_info);
        __Pyx_GIVEREF(__pyx_v_sv_info);
        PyTuple_SET_ITEM(__pyx_t_2, 2+__pyx_t_8, __pyx_v_sv_info);
        __Pyx_INCREF(__pyx_v_out_figure_name);
        __Pyx_GIVEREF(__pyx_v_out_figure_name);
        PyTuple_SET_ITEM(__pyx_t_2, 3+__pyx_t_8, __pyx_v_out_figure_name);
        __pyx_t_9 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_2, NULL); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1531, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_9);
        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
        __Pyx_DECREF_SET(__pyx_v_vapor_score_list, __pyx_t_9);
        __pyx_t_9 = 0;

        /* "vapor_vali/Simple_function.pyx":1530
 *                             vapor_score_list=vapor_long_del_inv(bam_in,ref,sv_info,out_figure_name)
 *         else:
 *             if len(sv_info)==2 and [i[-1] for i in sv_info]==['del','inv']:             # <<<<<<<<<<<<<<
 *                 vapor_score_list=vapor_long_del_inv(bam_in,ref,sv_info,out_figure_name)
 *     else:
 */
      }
    }
    __pyx_L4:;

    /* "vapor_vali/Simple_function.pyx":1505
 *     vapor_score_list=[]
 *     best_read_rec=''
 *     if sv_info[1][1]-sv_info[0][2]<100:             # <<<<<<<<<<<<<<
 *         if sv_block[2]-sv_block[1]<default_max_sv_test: #only try to read in all reads with sv <100K; else: try breakpoints ;
 *             ref_seq=ref_seq_readin(ref,sv_block[0],sv_block[1]-flank_length,sv_block[2]+flank_length)
 */
    goto __pyx_L3;
  }

  /* "vapor_vali/Simple_function.pyx":1533
 *                 vapor_score_list=vapor_long_del_inv(bam_in,ref,sv_info,out_figure_name)
 *     else:
 *         for sub_sv_info in sv_info:             # <<<<<<<<<<<<<<
 *             if 'del' in sub_sv_info:    vapor_score_list+=vapor_simple_del_Vapor(bam_in,ref,sub_sv_info[:-1],'.'.join(out_figure_name.split('.')[:-1])+'_'.join([str(i) for i in sub_sv_info])+'.'+out_figure_name.split('.')[-1])
 *             elif 'inv' in sub_sv_info:    vapor_score_list+=vapor_simple_inv_Vapor(bam_in,ref,sub_sv_info[:-1],'.'.join(out_figure_name.split('.')[:-1])+'_'.join([str(i) for i in sub_sv_info])+'.'+out_figure_name.split('.')[-1])
 */
  /*else*/ {
    if (likely(PyList_CheckExact(__pyx_v_sv_info)) || PyTuple_CheckExact(__pyx_v_sv_info)) {
      __pyx_t_9 = __pyx_v_sv_info; __Pyx_INCREF(__pyx_t_9); __pyx_t_8 = 0;
      __pyx_t_12 = NULL;
    } else {
      __pyx_t_8 = -1; __pyx_t_9 = PyObject_GetIter(__pyx_v_sv_info); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1533, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_9);
      __pyx_t_12 = Py_TYPE(__pyx_t_9)->tp_iternext; if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1533, __pyx_L1_error)
    }
    for (;;) {
      if (likely(!__pyx_t_12)) {
        if (likely(PyList_CheckExact(__pyx_t_9))) {
          if (__pyx_t_8 >= PyList_GET_SIZE(__pyx_t_9)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_1 = PyList_GET_ITEM(__pyx_t_9, __pyx_t_8); __Pyx_INCREF(__pyx_t_1); __pyx_t_8++; if (unlikely(0 < 0)) __PYX_ERR(0, 1533, __pyx_L1_error)
          #else
          __pyx_t_1 = PySequence_ITEM(__pyx_t_9, __pyx_t_8); __pyx_t_8++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1533, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_1);
          #endif
        } else {
          if (__pyx_t_8 >= PyTuple_GET_SIZE(__pyx_t_9)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_9, __pyx_t_8); __Pyx_INCREF(__pyx_t_1); __pyx_t_8++; if (unlikely(0 < 0)) __PYX_ERR(0, 1533, __pyx_L1_error)
          #else
          __pyx_t_1 = PySequence_ITEM(__pyx_t_9, __pyx_t_8); __pyx_t_8++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1533, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_1);
          #endif
        }
      } else {
        __pyx_t_1 = __pyx_t_12(__pyx_t_9);
        if (unlikely(!__pyx_t_1)) {
          PyObject* exc_type = PyErr_Occurred();
          if (exc_type) {
            if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
            else __PYX_ERR(0, 1533, __pyx_L1_error)
          }
          break;
        }
        __Pyx_GOTREF(__pyx_t_1);
      }
      __Pyx_XDECREF_SET(__pyx_v_sub_sv_info, __pyx_t_1);
      __pyx_t_1 = 0;

      /* "vapor_vali/Simple_function.pyx":1534
 *     else:
 *         for sub_sv_info in sv_info:
 *             if 'del' in sub_sv_info:    vapor_score_list+=vapor_simple_del_Vapor(bam_in,ref,sub_sv_info[:-1],'.'.join(out_figure_name.split('.')[:-1])+'_'.join([str(i) for i in sub_sv_info])+'.'+out_figure_name.split('.')[-1])             # <<<<<<<<<<<<<<
 *             elif 'inv' in sub_sv_info:    vapor_score_list+=vapor_simple_inv_Vapor(bam_in,ref,sub_sv_info[:-1],'.'.join(out_figure_name.split('.')[:-1])+'_'.join([str(i) for i in sub_sv_info])+'.'+out_figure_name.split('.')[-1])
 *     return vapor_score_list
 */
      __pyx_t_11 = (__Pyx_PySequence_ContainsTF(__pyx_n_s_del, __pyx_v_sub_sv_info, Py_EQ)); if (unlikely(__pyx_t_11 < 0)) __PYX_ERR(0, 1534, __pyx_L1_error)
      __pyx_t_5 = (__pyx_t_11 != 0);
      if (__pyx_t_5) {
        __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_vapor_simple_del_Vapor); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1534, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
        __pyx_t_18 = __Pyx_PyObject_GetSlice(__pyx_v_sub_sv_info, 0, -1L, NULL, NULL, &__pyx_slice__122, 0, 1, 1); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 1534, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_18);
        __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_out_figure_name, __pyx_n_s_split); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1534, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_7);
        __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_7, __pyx_tuple__123, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1534, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_6);
        __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
        __pyx_t_7 = __Pyx_PyObject_GetSlice(__pyx_t_6, 0, -1L, NULL, NULL, &__pyx_slice__124, 0, 1, 1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1534, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_7);
        __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
        __pyx_t_6 = __Pyx_PyString_Join(__pyx_kp_s__19, __pyx_t_7); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1534, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_6);
        __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
        __pyx_t_7 = PyList_New(0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1534, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_7);
        if (likely(PyList_CheckExact(__pyx_v_sub_sv_info)) || PyTuple_CheckExact(__pyx_v_sub_sv_info)) {
          __pyx_t_4 = __pyx_v_sub_sv_info; __Pyx_INCREF(__pyx_t_4); __pyx_t_17 = 0;
          __pyx_t_22 = NULL;
        } else {
          __pyx_t_17 = -1; __pyx_t_4 = PyObject_GetIter(__pyx_v_sub_sv_info); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1534, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_4);
          __pyx_t_22 = Py_TYPE(__pyx_t_4)->tp_iternext; if (unlikely(!__pyx_t_22)) __PYX_ERR(0, 1534, __pyx_L1_error)
        }
        for (;;) {
          if (likely(!__pyx_t_22)) {
            if (likely(PyList_CheckExact(__pyx_t_4))) {
              if (__pyx_t_17 >= PyList_GET_SIZE(__pyx_t_4)) break;
              #if CYTHON_COMPILING_IN_CPYTHON
              __pyx_t_3 = PyList_GET_ITEM(__pyx_t_4, __pyx_t_17); __Pyx_INCREF(__pyx_t_3); __pyx_t_17++; if (unlikely(0 < 0)) __PYX_ERR(0, 1534, __pyx_L1_error)
              #else
              __pyx_t_3 = PySequence_ITEM(__pyx_t_4, __pyx_t_17); __pyx_t_17++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1534, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_3);
              #endif
            } else {
              if (__pyx_t_17 >= PyTuple_GET_SIZE(__pyx_t_4)) break;
              #if CYTHON_COMPILING_IN_CPYTHON
              __pyx_t_3 = PyTuple_GET_ITEM(__pyx_t_4, __pyx_t_17); __Pyx_INCREF(__pyx_t_3); __pyx_t_17++; if (unlikely(0 < 0)) __PYX_ERR(0, 1534, __pyx_L1_error)
              #else
              __pyx_t_3 = PySequence_ITEM(__pyx_t_4, __pyx_t_17); __pyx_t_17++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1534, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_3);
              #endif
            }
          } else {
            __pyx_t_3 = __pyx_t_22(__pyx_t_4);
            if (unlikely(!__pyx_t_3)) {
              PyObject* exc_type = PyErr_Occurred();
              if (exc_type) {
                if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
                else __PYX_ERR(0, 1534, __pyx_L1_error)
              }
              break;
            }
            __Pyx_GOTREF(__pyx_t_3);
          }
          __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_3);
          __pyx_t_3 = 0;
          __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1534, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_3);
          __Pyx_INCREF(__pyx_v_i);
          __Pyx_GIVEREF(__pyx_v_i);
          PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_v_i);
          __pyx_t_15 = __Pyx_PyObject_Call(((PyObject *)(&PyString_Type)), __pyx_t_3, NULL); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1534, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_15);
          __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
          if (unlikely(__Pyx_ListComp_Append(__pyx_t_7, (PyObject*)__pyx_t_15))) __PYX_ERR(0, 1534, __pyx_L1_error)
          __Pyx_DECREF(__pyx_t_15); __pyx_t_15 = 0;
        }
        __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
        __pyx_t_4 = __Pyx_PyString_Join(__pyx_n_s__115, __pyx_t_7); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1534, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_4);
        __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
        __pyx_t_7 = PyNumber_Add(__pyx_t_6, __pyx_t_4); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1534, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_7);
        __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
        __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
        __pyx_t_4 = PyNumber_Add(__pyx_t_7, __pyx_kp_s__19); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1534, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_4);
        __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
        __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_out_figure_name, __pyx_n_s_split); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1534, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_7);
        __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_7, __pyx_tuple__125, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1534, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_6);
        __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
        __pyx_t_7 = __Pyx_GetItemInt(__pyx_t_6, -1L, long, 1, __Pyx_PyInt_From_long, 0, 1, 1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1534, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_7);
        __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
        __pyx_t_6 = PyNumber_Add(__pyx_t_4, __pyx_t_7); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1534, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_6);
        __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
        __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
        __pyx_t_7 = NULL;
        __pyx_t_17 = 0;
        if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_2))) {
          __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_2);
          if (likely(__pyx_t_7)) {
            PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
            __Pyx_INCREF(__pyx_t_7);
            __Pyx_INCREF(function);
            __Pyx_DECREF_SET(__pyx_t_2, function);
            __pyx_t_17 = 1;
          }
        }
        __pyx_t_4 = PyTuple_New(4+__pyx_t_17); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1534, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_4);
        if (__pyx_t_7) {
          __Pyx_GIVEREF(__pyx_t_7); PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_7); __pyx_t_7 = NULL;
        }
        __Pyx_INCREF(__pyx_v_bam_in);
        __Pyx_GIVEREF(__pyx_v_bam_in);
        PyTuple_SET_ITEM(__pyx_t_4, 0+__pyx_t_17, __pyx_v_bam_in);
        __Pyx_INCREF(__pyx_v_ref);
        __Pyx_GIVEREF(__pyx_v_ref);
        PyTuple_SET_ITEM(__pyx_t_4, 1+__pyx_t_17, __pyx_v_ref);
        __Pyx_GIVEREF(__pyx_t_18);
        PyTuple_SET_ITEM(__pyx_t_4, 2+__pyx_t_17, __pyx_t_18);
        __Pyx_GIVEREF(__pyx_t_6);
        PyTuple_SET_ITEM(__pyx_t_4, 3+__pyx_t_17, __pyx_t_6);
        __pyx_t_18 = 0;
        __pyx_t_6 = 0;
        __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_4, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1534, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
        __pyx_t_2 = PyNumber_InPlaceAdd(__pyx_v_vapor_score_list, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1534, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
        __Pyx_DECREF_SET(__pyx_v_vapor_score_list, __pyx_t_2);
        __pyx_t_2 = 0;
        goto __pyx_L31;
      }

      /* "vapor_vali/Simple_function.pyx":1535
 *         for sub_sv_info in sv_info:
 *             if 'del' in sub_sv_info:    vapor_score_list+=vapor_simple_del_Vapor(bam_in,ref,sub_sv_info[:-1],'.'.join(out_figure_name.split('.')[:-1])+'_'.join([str(i) for i in sub_sv_info])+'.'+out_figure_name.split('.')[-1])
 *             elif 'inv' in sub_sv_info:    vapor_score_list+=vapor_simple_inv_Vapor(bam_in,ref,sub_sv_info[:-1],'.'.join(out_figure_name.split('.')[:-1])+'_'.join([str(i) for i in sub_sv_info])+'.'+out_figure_name.split('.')[-1])             # <<<<<<<<<<<<<<
 *     return vapor_score_list
 * 
 */
      __pyx_t_5 = (__Pyx_PySequence_ContainsTF(__pyx_n_s_inv, __pyx_v_sub_sv_info, Py_EQ)); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 1535, __pyx_L1_error)
      __pyx_t_11 = (__pyx_t_5 != 0);
      if (__pyx_t_11) {
        __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_vapor_simple_inv_Vapor); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1535, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        __pyx_t_4 = __Pyx_PyObject_GetSlice(__pyx_v_sub_sv_info, 0, -1L, NULL, NULL, &__pyx_slice__126, 0, 1, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1535, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_4);
        __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_out_figure_name, __pyx_n_s_split); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1535, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_6);
        __pyx_t_18 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_tuple__127, NULL); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 1535, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_18);
        __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
        __pyx_t_6 = __Pyx_PyObject_GetSlice(__pyx_t_18, 0, -1L, NULL, NULL, &__pyx_slice__128, 0, 1, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1535, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_6);
        __Pyx_DECREF(__pyx_t_18); __pyx_t_18 = 0;
        __pyx_t_18 = __Pyx_PyString_Join(__pyx_kp_s__19, __pyx_t_6); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 1535, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_18);
        __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
        __pyx_t_6 = PyList_New(0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1535, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_6);
        if (likely(PyList_CheckExact(__pyx_v_sub_sv_info)) || PyTuple_CheckExact(__pyx_v_sub_sv_info)) {
          __pyx_t_7 = __pyx_v_sub_sv_info; __Pyx_INCREF(__pyx_t_7); __pyx_t_17 = 0;
          __pyx_t_22 = NULL;
        } else {
          __pyx_t_17 = -1; __pyx_t_7 = PyObject_GetIter(__pyx_v_sub_sv_info); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1535, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_7);
          __pyx_t_22 = Py_TYPE(__pyx_t_7)->tp_iternext; if (unlikely(!__pyx_t_22)) __PYX_ERR(0, 1535, __pyx_L1_error)
        }
        for (;;) {
          if (likely(!__pyx_t_22)) {
            if (likely(PyList_CheckExact(__pyx_t_7))) {
              if (__pyx_t_17 >= PyList_GET_SIZE(__pyx_t_7)) break;
              #if CYTHON_COMPILING_IN_CPYTHON
              __pyx_t_15 = PyList_GET_ITEM(__pyx_t_7, __pyx_t_17); __Pyx_INCREF(__pyx_t_15); __pyx_t_17++; if (unlikely(0 < 0)) __PYX_ERR(0, 1535, __pyx_L1_error)
              #else
              __pyx_t_15 = PySequence_ITEM(__pyx_t_7, __pyx_t_17); __pyx_t_17++; if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1535, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_15);
              #endif
            } else {
              if (__pyx_t_17 >= PyTuple_GET_SIZE(__pyx_t_7)) break;
              #if CYTHON_COMPILING_IN_CPYTHON
              __pyx_t_15 = PyTuple_GET_ITEM(__pyx_t_7, __pyx_t_17); __Pyx_INCREF(__pyx_t_15); __pyx_t_17++; if (unlikely(0 < 0)) __PYX_ERR(0, 1535, __pyx_L1_error)
              #else
              __pyx_t_15 = PySequence_ITEM(__pyx_t_7, __pyx_t_17); __pyx_t_17++; if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1535, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_15);
              #endif
            }
          } else {
            __pyx_t_15 = __pyx_t_22(__pyx_t_7);
            if (unlikely(!__pyx_t_15)) {
              PyObject* exc_type = PyErr_Occurred();
              if (exc_type) {
                if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
                else __PYX_ERR(0, 1535, __pyx_L1_error)
              }
              break;
            }
            __Pyx_GOTREF(__pyx_t_15);
          }
          __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_15);
          __pyx_t_15 = 0;
          __pyx_t_15 = PyTuple_New(1); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1535, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_15);
          __Pyx_INCREF(__pyx_v_i);
          __Pyx_GIVEREF(__pyx_v_i);
          PyTuple_SET_ITEM(__pyx_t_15, 0, __pyx_v_i);
          __pyx_t_3 = __Pyx_PyObject_Call(((PyObject *)(&PyString_Type)), __pyx_t_15, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1535, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_3);
          __Pyx_DECREF(__pyx_t_15); __pyx_t_15 = 0;
          if (unlikely(__Pyx_ListComp_Append(__pyx_t_6, (PyObject*)__pyx_t_3))) __PYX_ERR(0, 1535, __pyx_L1_error)
          __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
        }
        __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
        __pyx_t_7 = __Pyx_PyString_Join(__pyx_n_s__115, __pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1535, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_7);
        __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
        __pyx_t_6 = PyNumber_Add(__pyx_t_18, __pyx_t_7); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1535, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_6);
        __Pyx_DECREF(__pyx_t_18); __pyx_t_18 = 0;
        __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
        __pyx_t_7 = PyNumber_Add(__pyx_t_6, __pyx_kp_s__19); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1535, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_7);
        __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
        __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_out_figure_name, __pyx_n_s_split); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1535, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_6);
        __pyx_t_18 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_tuple__129, NULL); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 1535, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_18);
        __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
        __pyx_t_6 = __Pyx_GetItemInt(__pyx_t_18, -1L, long, 1, __Pyx_PyInt_From_long, 0, 1, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1535, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_6);
        __Pyx_DECREF(__pyx_t_18); __pyx_t_18 = 0;
        __pyx_t_18 = PyNumber_Add(__pyx_t_7, __pyx_t_6); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 1535, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_18);
        __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
        __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
        __pyx_t_6 = NULL;
        __pyx_t_17 = 0;
        if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_1))) {
          __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_1);
          if (likely(__pyx_t_6)) {
            PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
            __Pyx_INCREF(__pyx_t_6);
            __Pyx_INCREF(function);
            __Pyx_DECREF_SET(__pyx_t_1, function);
            __pyx_t_17 = 1;
          }
        }
        __pyx_t_7 = PyTuple_New(4+__pyx_t_17); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1535, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_7);
        if (__pyx_t_6) {
          __Pyx_GIVEREF(__pyx_t_6); PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_6); __pyx_t_6 = NULL;
        }
        __Pyx_INCREF(__pyx_v_bam_in);
        __Pyx_GIVEREF(__pyx_v_bam_in);
        PyTuple_SET_ITEM(__pyx_t_7, 0+__pyx_t_17, __pyx_v_bam_in);
        __Pyx_INCREF(__pyx_v_ref);
        __Pyx_GIVEREF(__pyx_v_ref);
        PyTuple_SET_ITEM(__pyx_t_7, 1+__pyx_t_17, __pyx_v_ref);
        __Pyx_GIVEREF(__pyx_t_4);
        PyTuple_SET_ITEM(__pyx_t_7, 2+__pyx_t_17, __pyx_t_4);
        __Pyx_GIVEREF(__pyx_t_18);
        PyTuple_SET_ITEM(__pyx_t_7, 3+__pyx_t_17, __pyx_t_18);
        __pyx_t_4 = 0;
        __pyx_t_18 = 0;
        __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_7, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1535, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
        __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
        __pyx_t_1 = PyNumber_InPlaceAdd(__pyx_v_vapor_score_list, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1535, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
        __Pyx_DECREF_SET(__pyx_v_vapor_score_list, __pyx_t_1);
        __pyx_t_1 = 0;
      }
      __pyx_L31:;

      /* "vapor_vali/Simple_function.pyx":1533
 *                 vapor_score_list=vapor_long_del_inv(bam_in,ref,sv_info,out_figure_name)
 *     else:
 *         for sub_sv_info in sv_info:             # <<<<<<<<<<<<<<
 *             if 'del' in sub_sv_info:    vapor_score_list+=vapor_simple_del_Vapor(bam_in,ref,sub_sv_info[:-1],'.'.join(out_figure_name.split('.')[:-1])+'_'.join([str(i) for i in sub_sv_info])+'.'+out_figure_name.split('.')[-1])
 *             elif 'inv' in sub_sv_info:    vapor_score_list+=vapor_simple_inv_Vapor(bam_in,ref,sub_sv_info[:-1],'.'.join(out_figure_name.split('.')[:-1])+'_'.join([str(i) for i in sub_sv_info])+'.'+out_figure_name.split('.')[-1])
 */
    }
    __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
  }
  __pyx_L3:;

  /* "vapor_vali/Simple_function.pyx":1536
 *             if 'del' in sub_sv_info:    vapor_score_list+=vapor_simple_del_Vapor(bam_in,ref,sub_sv_info[:-1],'.'.join(out_figure_name.split('.')[:-1])+'_'.join([str(i) for i in sub_sv_info])+'.'+out_figure_name.split('.')[-1])
 *             elif 'inv' in sub_sv_info:    vapor_score_list+=vapor_simple_inv_Vapor(bam_in,ref,sub_sv_info[:-1],'.'.join(out_figure_name.split('.')[:-1])+'_'.join([str(i) for i in sub_sv_info])+'.'+out_figure_name.split('.')[-1])
 *     return vapor_score_list             # <<<<<<<<<<<<<<
 * 
 * def vapor_dup_inv_VapoR(bam_in,ref,sv_info,out_figure_name):
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_vapor_score_list);
  __pyx_r = __pyx_v_vapor_score_list;
  goto __pyx_L0;

  /* "vapor_vali/Simple_function.pyx":1500
 *     return vapor_score_list
 * 
 * def vapor_del_inv_Vapor(bam_in,ref,sv_info,out_figure_name):             # <<<<<<<<<<<<<<
 *     sv_block=[sv_info[0][0],sv_info[0][1],sv_info[-1][2]]
 *     flank_length=flank_length_calculate(sv_block)
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_XDECREF(__pyx_t_7);
  __Pyx_XDECREF(__pyx_t_9);
  __Pyx_XDECREF(__pyx_t_13);
  __Pyx_XDECREF(__pyx_t_14);
  __Pyx_XDECREF(__pyx_t_15);
  __Pyx_XDECREF(__pyx_t_16);
  __Pyx_XDECREF(__pyx_t_18);
  __Pyx_AddTraceback("vapor_vali.Simple_function.vapor_del_inv_Vapor", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_sv_block);
  __Pyx_XDECREF(__pyx_v_flank_length);
  __Pyx_XDECREF(__pyx_v_vapor_score_list);
  __Pyx_XDECREF(__pyx_v_best_read_rec);
  __Pyx_XDECREF(__pyx_v_ref_seq);
  __Pyx_XDECREF(__pyx_v_window_size);
  __Pyx_XDECREF(__pyx_v_window_size_qc);
  __Pyx_XDECREF(__pyx_v_alt_seq);
  __Pyx_XDECREF(__pyx_v_x);
  __Pyx_XDECREF(__pyx_v_all_reads);
  __Pyx_XDECREF(__pyx_v_vapor_single_read_score);
  __Pyx_XDECREF(__pyx_v_sub_sv_info);
  __Pyx_XDECREF(__pyx_v_i);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "vapor_vali/Simple_function.pyx":1538
 *     return vapor_score_list
 * 
 * def vapor_dup_inv_VapoR(bam_in,ref,sv_info,out_figure_name):             # <<<<<<<<<<<<<<
 *     #eg of sv_info=['chr1', 114103333, 114103408, 'chr1', 114111746]
 *     sv_info[1:3]=[int(i) for i in sv_info[1:3]]
 */

/* Python wrapper */
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_205vapor_dup_inv_VapoR(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_10vapor_vali_15Simple_function_205vapor_dup_inv_VapoR = {"vapor_dup_inv_VapoR", (PyCFunction)__pyx_pw_10vapor_vali_15Simple_function_205vapor_dup_inv_VapoR, METH_VARARGS|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_205vapor_dup_inv_VapoR(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_bam_in = 0;
  PyObject *__pyx_v_ref = 0;
  PyObject *__pyx_v_sv_info = 0;
  PyObject *__pyx_v_out_figure_name = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("vapor_dup_inv_VapoR (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_bam_in,&__pyx_n_s_ref,&__pyx_n_s_sv_info,&__pyx_n_s_out_figure_name,0};
    PyObject* values[4] = {0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
      switch (pos_args) {
        case  4: values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
        case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_bam_in)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_ref)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("vapor_dup_inv_VapoR", 1, 4, 4, 1); __PYX_ERR(0, 1538, __pyx_L3_error)
        }
        case  2:
        if (likely((values[2] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_sv_info)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("vapor_dup_inv_VapoR", 1, 4, 4, 2); __PYX_ERR(0, 1538, __pyx_L3_error)
        }
        case  3:
        if (likely((values[3] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_out_figure_name)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("vapor_dup_inv_VapoR", 1, 4, 4, 3); __PYX_ERR(0, 1538, __pyx_L3_error)
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "vapor_dup_inv_VapoR") < 0)) __PYX_ERR(0, 1538, __pyx_L3_error)
      }
    } else if (PyTuple_GET_SIZE(__pyx_args) != 4) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
      values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
    }
    __pyx_v_bam_in = values[0];
    __pyx_v_ref = values[1];
    __pyx_v_sv_info = values[2];
    __pyx_v_out_figure_name = values[3];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("vapor_dup_inv_VapoR", 1, 4, 4, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1538, __pyx_L3_error)
  __pyx_L3_error:;
  __Pyx_AddTraceback("vapor_vali.Simple_function.vapor_dup_inv_VapoR", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_10vapor_vali_15Simple_function_204vapor_dup_inv_VapoR(__pyx_self, __pyx_v_bam_in, __pyx_v_ref, __pyx_v_sv_info, __pyx_v_out_figure_name);

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10vapor_vali_15Simple_function_204vapor_dup_inv_VapoR(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_bam_in, PyObject *__pyx_v_ref, PyObject *__pyx_v_sv_info, PyObject *__pyx_v_out_figure_name) {
  PyObject *__pyx_v_dup_block = NULL;
  PyObject *__pyx_v_ins_point = NULL;
  PyObject *__pyx_v_flank_length = NULL;
  PyObject *__pyx_v_vapor_score_list = NULL;
  PyObject *__pyx_v_bp_info = NULL;
  PyObject *__pyx_v_run_flag = NULL;
  PyObject *__pyx_v_ref_seq = NULL;
  PyObject *__pyx_v_window_size = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_window_size_qc = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_ref_structure = NULL;
  PyObject *__pyx_v_alt_structure = NULL;
  PyObject *__pyx_v_all_reads = NULL;
  PyObject *__pyx_v_alt_seq = NULL;
  PyObject *__pyx_v_a_seq = NULL;
  PyObject *__pyx_v_b_seq = NULL;
  PyObject *__pyx_v_x = NULL;
  PyObject *__pyx_v_best_read_rec = NULL;
  PyObject *__pyx_v_vapor_single_read_score = NULL;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  Py_ssize_t __pyx_t_4;
  PyObject *(*__pyx_t_5)(PyObject *);
  PyObject *__pyx_t_6 = NULL;
  int __pyx_t_7;
  int __pyx_t_8;
  int __pyx_t_9;
  PyObject *__pyx_t_10 = NULL;
  PyObject *__pyx_t_11 = NULL;
  PyObject *__pyx_t_12 = NULL;
  PyObject *(*__pyx_t_13)(PyObject *);
  Py_ssize_t __pyx_t_14;
  int __pyx_t_15;
  double __pyx_t_16;
  double __pyx_t_17;
  PyObject *__pyx_t_18 = NULL;
  PyObject *__pyx_t_19 = NULL;
  PyObject *__pyx_t_20 = NULL;
  PyObject *__pyx_t_21 = NULL;
  PyObject *__pyx_t_22 = NULL;
  __Pyx_RefNannySetupContext("vapor_dup_inv_VapoR", 0);

  /* "vapor_vali/Simple_function.pyx":1540
 * def vapor_dup_inv_VapoR(bam_in,ref,sv_info,out_figure_name):
 *     #eg of sv_info=['chr1', 114103333, 114103408, 'chr1', 114111746]
 *     sv_info[1:3]=[int(i) for i in sv_info[1:3]]             # <<<<<<<<<<<<<<
 *     dup_block=sv_info[:3]
 *     ins_point=[sv_info[3],int(sv_info[4])]
 */
  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1540, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyObject_GetSlice(__pyx_v_sv_info, 1, 3, NULL, NULL, &__pyx_slice__130, 1, 1, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1540, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (likely(PyList_CheckExact(__pyx_t_2)) || PyTuple_CheckExact(__pyx_t_2)) {
    __pyx_t_3 = __pyx_t_2; __Pyx_INCREF(__pyx_t_3); __pyx_t_4 = 0;
    __pyx_t_5 = NULL;
  } else {
    __pyx_t_4 = -1; __pyx_t_3 = PyObject_GetIter(__pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1540, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_5 = Py_TYPE(__pyx_t_3)->tp_iternext; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1540, __pyx_L1_error)
  }
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  for (;;) {
    if (likely(!__pyx_t_5)) {
      if (likely(PyList_CheckExact(__pyx_t_3))) {
        if (__pyx_t_4 >= PyList_GET_SIZE(__pyx_t_3)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_2 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_4); __Pyx_INCREF(__pyx_t_2); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 1540, __pyx_L1_error)
        #else
        __pyx_t_2 = PySequence_ITEM(__pyx_t_3, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1540, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
        #endif
      } else {
        if (__pyx_t_4 >= PyTuple_GET_SIZE(__pyx_t_3)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_2 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_4); __Pyx_INCREF(__pyx_t_2); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 1540, __pyx_L1_error)
        #else
        __pyx_t_2 = PySequence_ITEM(__pyx_t_3, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1540, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
        #endif
      }
    } else {
      __pyx_t_2 = __pyx_t_5(__pyx_t_3);
      if (unlikely(!__pyx_t_2)) {
        PyObject* exc_type = PyErr_Occurred();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
          else __PYX_ERR(0, 1540, __pyx_L1_error)
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_2);
    }
    __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_2);
    __pyx_t_2 = 0;
    __pyx_t_2 = __Pyx_PyNumber_Int(__pyx_v_i); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1540, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    if (unlikely(__Pyx_ListComp_Append(__pyx_t_1, (PyObject*)__pyx_t_2))) __PYX_ERR(0, 1540, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  }
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  if (__Pyx_PyObject_SetSlice(__pyx_v_sv_info, __pyx_t_1, 1, 3, NULL, NULL, &__pyx_slice__131, 1, 1, 1) < 0) __PYX_ERR(0, 1540, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":1541
 *     #eg of sv_info=['chr1', 114103333, 114103408, 'chr1', 114111746]
 *     sv_info[1:3]=[int(i) for i in sv_info[1:3]]
 *     dup_block=sv_info[:3]             # <<<<<<<<<<<<<<
 *     ins_point=[sv_info[3],int(sv_info[4])]
 *     flank_length=flank_length_calculate(dup_block)
 */
  __pyx_t_1 = __Pyx_PyObject_GetSlice(__pyx_v_sv_info, 0, 3, NULL, NULL, &__pyx_slice__132, 0, 1, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1541, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_dup_block = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":1542
 *     sv_info[1:3]=[int(i) for i in sv_info[1:3]]
 *     dup_block=sv_info[:3]
 *     ins_point=[sv_info[3],int(sv_info[4])]             # <<<<<<<<<<<<<<
 *     flank_length=flank_length_calculate(dup_block)
 *     vapor_score_list=[]
 */
  __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_sv_info, 3, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1542, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_sv_info, 4, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1542, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_2 = __Pyx_PyNumber_Int(__pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1542, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = PyList_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1542, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_GIVEREF(__pyx_t_1);
  PyList_SET_ITEM(__pyx_t_3, 0, __pyx_t_1);
  __Pyx_GIVEREF(__pyx_t_2);
  PyList_SET_ITEM(__pyx_t_3, 1, __pyx_t_2);
  __pyx_t_1 = 0;
  __pyx_t_2 = 0;
  __pyx_v_ins_point = ((PyObject*)__pyx_t_3);
  __pyx_t_3 = 0;

  /* "vapor_vali/Simple_function.pyx":1543
 *     dup_block=sv_info[:3]
 *     ins_point=[sv_info[3],int(sv_info[4])]
 *     flank_length=flank_length_calculate(dup_block)             # <<<<<<<<<<<<<<
 *     vapor_score_list=[]
 *     if sv_info[0]==sv_info[3]:  #dup inv on the same chromosome
 */
  __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_flank_length_calculate); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1543, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_1 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_2);
    if (likely(__pyx_t_1)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_1);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_2, function);
    }
  }
  if (!__pyx_t_1) {
    __pyx_t_3 = __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_v_dup_block); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1543, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
  } else {
    __pyx_t_6 = PyTuple_New(1+1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1543, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __Pyx_GIVEREF(__pyx_t_1); PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_1); __pyx_t_1 = NULL;
    __Pyx_INCREF(__pyx_v_dup_block);
    __Pyx_GIVEREF(__pyx_v_dup_block);
    PyTuple_SET_ITEM(__pyx_t_6, 0+1, __pyx_v_dup_block);
    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_6, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1543, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  }
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_flank_length = __pyx_t_3;
  __pyx_t_3 = 0;

  /* "vapor_vali/Simple_function.pyx":1544
 *     ins_point=[sv_info[3],int(sv_info[4])]
 *     flank_length=flank_length_calculate(dup_block)
 *     vapor_score_list=[]             # <<<<<<<<<<<<<<
 *     if sv_info[0]==sv_info[3]:  #dup inv on the same chromosome
 *         bp_info=sorted(sv_info[1:3]+[sv_info[4]])
 */
  __pyx_t_3 = PyList_New(0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1544, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_v_vapor_score_list = ((PyObject*)__pyx_t_3);
  __pyx_t_3 = 0;

  /* "vapor_vali/Simple_function.pyx":1545
 *     flank_length=flank_length_calculate(dup_block)
 *     vapor_score_list=[]
 *     if sv_info[0]==sv_info[3]:  #dup inv on the same chromosome             # <<<<<<<<<<<<<<
 *         bp_info=sorted(sv_info[1:3]+[sv_info[4]])
 *         run_flag=0
 */
  __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_sv_info, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1545, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_sv_info, 3, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1545, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_6 = PyObject_RichCompare(__pyx_t_3, __pyx_t_2, Py_EQ); __Pyx_XGOTREF(__pyx_t_6); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1545, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_7 = __Pyx_PyObject_IsTrue(__pyx_t_6); if (unlikely(__pyx_t_7 < 0)) __PYX_ERR(0, 1545, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  if (__pyx_t_7) {

    /* "vapor_vali/Simple_function.pyx":1546
 *     vapor_score_list=[]
 *     if sv_info[0]==sv_info[3]:  #dup inv on the same chromosome
 *         bp_info=sorted(sv_info[1:3]+[sv_info[4]])             # <<<<<<<<<<<<<<
 *         run_flag=0
 *         if sv_info[0]==sv_info[3] and max(bp_info)-min(bp_info)<default_max_sv_test: #try to test on the whole region
 */
    __pyx_t_2 = __Pyx_PyObject_GetSlice(__pyx_v_sv_info, 1, 3, NULL, NULL, &__pyx_slice__133, 1, 1, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1546, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_sv_info, 4, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1546, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_1 = PyList_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1546, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_GIVEREF(__pyx_t_3);
    PyList_SET_ITEM(__pyx_t_1, 0, __pyx_t_3);
    __pyx_t_3 = 0;
    __pyx_t_3 = PyNumber_Add(__pyx_t_2, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1546, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = PySequence_List(__pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1546, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_6 = ((PyObject*)__pyx_t_1);
    __pyx_t_1 = 0;
    __pyx_t_8 = PyList_Sort(__pyx_t_6); if (unlikely(__pyx_t_8 == -1)) __PYX_ERR(0, 1546, __pyx_L1_error)
    __pyx_v_bp_info = ((PyObject*)__pyx_t_6);
    __pyx_t_6 = 0;

    /* "vapor_vali/Simple_function.pyx":1547
 *     if sv_info[0]==sv_info[3]:  #dup inv on the same chromosome
 *         bp_info=sorted(sv_info[1:3]+[sv_info[4]])
 *         run_flag=0             # <<<<<<<<<<<<<<
 *         if sv_info[0]==sv_info[3] and max(bp_info)-min(bp_info)<default_max_sv_test: #try to test on the whole region
 *             ref_seq=ref_seq_readin(ref,sv_info[0],min(bp_info)-flank_length,max(bp_info)+flank_length)
 */
    __Pyx_INCREF(__pyx_int_0);
    __pyx_v_run_flag = __pyx_int_0;

    /* "vapor_vali/Simple_function.pyx":1548
 *         bp_info=sorted(sv_info[1:3]+[sv_info[4]])
 *         run_flag=0
 *         if sv_info[0]==sv_info[3] and max(bp_info)-min(bp_info)<default_max_sv_test: #try to test on the whole region             # <<<<<<<<<<<<<<
 *             ref_seq=ref_seq_readin(ref,sv_info[0],min(bp_info)-flank_length,max(bp_info)+flank_length)
 *             [window_size,window_size_qc]=window_size_refine(ref_seq)
 */
    __pyx_t_6 = __Pyx_GetItemInt(__pyx_v_sv_info, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1548, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_sv_info, 3, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1548, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_3 = PyObject_RichCompare(__pyx_t_6, __pyx_t_1, Py_EQ); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1548, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_9 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_9 < 0)) __PYX_ERR(0, 1548, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    if (__pyx_t_9) {
    } else {
      __pyx_t_7 = __pyx_t_9;
      goto __pyx_L7_bool_binop_done;
    }
    __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1548, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_INCREF(__pyx_v_bp_info);
    __Pyx_GIVEREF(__pyx_v_bp_info);
    PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_v_bp_info);
    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_max, __pyx_t_3, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1548, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1548, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_INCREF(__pyx_v_bp_info);
    __Pyx_GIVEREF(__pyx_v_bp_info);
    PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_v_bp_info);
    __pyx_t_6 = __Pyx_PyObject_Call(__pyx_builtin_min, __pyx_t_3, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1548, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = PyNumber_Subtract(__pyx_t_1, __pyx_t_6); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1548, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = __Pyx_GetModuleGlobalName(__pyx_n_s_default_max_sv_test); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1548, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __pyx_t_1 = PyObject_RichCompare(__pyx_t_3, __pyx_t_6, Py_LT); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1548, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_9 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_9 < 0)) __PYX_ERR(0, 1548, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_7 = __pyx_t_9;
    __pyx_L7_bool_binop_done:;
    if (__pyx_t_7) {

      /* "vapor_vali/Simple_function.pyx":1549
 *         run_flag=0
 *         if sv_info[0]==sv_info[3] and max(bp_info)-min(bp_info)<default_max_sv_test: #try to test on the whole region
 *             ref_seq=ref_seq_readin(ref,sv_info[0],min(bp_info)-flank_length,max(bp_info)+flank_length)             # <<<<<<<<<<<<<<
 *             [window_size,window_size_qc]=window_size_refine(ref_seq)
 *             if not window_size=='Error':
 */
      __pyx_t_6 = __Pyx_GetModuleGlobalName(__pyx_n_s_ref_seq_readin); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1549, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_6);
      __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_sv_info, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1549, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1549, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __Pyx_INCREF(__pyx_v_bp_info);
      __Pyx_GIVEREF(__pyx_v_bp_info);
      PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_v_bp_info);
      __pyx_t_10 = __Pyx_PyObject_Call(__pyx_builtin_min, __pyx_t_2, NULL); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1549, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_10);
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_2 = PyNumber_Subtract(__pyx_t_10, __pyx_v_flank_length); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1549, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
      __pyx_t_10 = PyTuple_New(1); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1549, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_10);
      __Pyx_INCREF(__pyx_v_bp_info);
      __Pyx_GIVEREF(__pyx_v_bp_info);
      PyTuple_SET_ITEM(__pyx_t_10, 0, __pyx_v_bp_info);
      __pyx_t_11 = __Pyx_PyObject_Call(__pyx_builtin_max, __pyx_t_10, NULL); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1549, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_11);
      __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
      __pyx_t_10 = PyNumber_Add(__pyx_t_11, __pyx_v_flank_length); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1549, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_10);
      __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
      __pyx_t_11 = NULL;
      __pyx_t_4 = 0;
      if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_6))) {
        __pyx_t_11 = PyMethod_GET_SELF(__pyx_t_6);
        if (likely(__pyx_t_11)) {
          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
          __Pyx_INCREF(__pyx_t_11);
          __Pyx_INCREF(function);
          __Pyx_DECREF_SET(__pyx_t_6, function);
          __pyx_t_4 = 1;
        }
      }
      __pyx_t_12 = PyTuple_New(4+__pyx_t_4); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1549, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_12);
      if (__pyx_t_11) {
        __Pyx_GIVEREF(__pyx_t_11); PyTuple_SET_ITEM(__pyx_t_12, 0, __pyx_t_11); __pyx_t_11 = NULL;
      }
      __Pyx_INCREF(__pyx_v_ref);
      __Pyx_GIVEREF(__pyx_v_ref);
      PyTuple_SET_ITEM(__pyx_t_12, 0+__pyx_t_4, __pyx_v_ref);
      __Pyx_GIVEREF(__pyx_t_3);
      PyTuple_SET_ITEM(__pyx_t_12, 1+__pyx_t_4, __pyx_t_3);
      __Pyx_GIVEREF(__pyx_t_2);
      PyTuple_SET_ITEM(__pyx_t_12, 2+__pyx_t_4, __pyx_t_2);
      __Pyx_GIVEREF(__pyx_t_10);
      PyTuple_SET_ITEM(__pyx_t_12, 3+__pyx_t_4, __pyx_t_10);
      __pyx_t_3 = 0;
      __pyx_t_2 = 0;
      __pyx_t_10 = 0;
      __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_12, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1549, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
      __pyx_v_ref_seq = __pyx_t_1;
      __pyx_t_1 = 0;

      /* "vapor_vali/Simple_function.pyx":1550
 *         if sv_info[0]==sv_info[3] and max(bp_info)-min(bp_info)<default_max_sv_test: #try to test on the whole region
 *             ref_seq=ref_seq_readin(ref,sv_info[0],min(bp_info)-flank_length,max(bp_info)+flank_length)
 *             [window_size,window_size_qc]=window_size_refine(ref_seq)             # <<<<<<<<<<<<<<
 *             if not window_size=='Error':
 *                 run_flag+=1
 */
      __pyx_t_6 = __Pyx_GetModuleGlobalName(__pyx_n_s_window_size_refine); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1550, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_6);
      __pyx_t_12 = NULL;
      if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_6))) {
        __pyx_t_12 = PyMethod_GET_SELF(__pyx_t_6);
        if (likely(__pyx_t_12)) {
          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
          __Pyx_INCREF(__pyx_t_12);
          __Pyx_INCREF(function);
          __Pyx_DECREF_SET(__pyx_t_6, function);
        }
      }
      if (!__pyx_t_12) {
        __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_v_ref_seq); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1550, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
      } else {
        __pyx_t_10 = PyTuple_New(1+1); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1550, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_10);
        __Pyx_GIVEREF(__pyx_t_12); PyTuple_SET_ITEM(__pyx_t_10, 0, __pyx_t_12); __pyx_t_12 = NULL;
        __Pyx_INCREF(__pyx_v_ref_seq);
        __Pyx_GIVEREF(__pyx_v_ref_seq);
        PyTuple_SET_ITEM(__pyx_t_10, 0+1, __pyx_v_ref_seq);
        __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_10, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1550, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
      }
      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
      if ((likely(PyTuple_CheckExact(__pyx_t_1))) || (PyList_CheckExact(__pyx_t_1))) {
        PyObject* sequence = __pyx_t_1;
        #if CYTHON_COMPILING_IN_CPYTHON
        Py_ssize_t size = Py_SIZE(sequence);
        #else
        Py_ssize_t size = PySequence_Size(sequence);
        #endif
        if (unlikely(size != 2)) {
          if (size > 2) __Pyx_RaiseTooManyValuesError(2);
          else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
          __PYX_ERR(0, 1550, __pyx_L1_error)
        }
        #if CYTHON_COMPILING_IN_CPYTHON
        if (likely(PyTuple_CheckExact(sequence))) {
          __pyx_t_6 = PyTuple_GET_ITEM(sequence, 0); 
          __pyx_t_10 = PyTuple_GET_ITEM(sequence, 1); 
        } else {
          __pyx_t_6 = PyList_GET_ITEM(sequence, 0); 
          __pyx_t_10 = PyList_GET_ITEM(sequence, 1); 
        }
        __Pyx_INCREF(__pyx_t_6);
        __Pyx_INCREF(__pyx_t_10);
        #else
        __pyx_t_6 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1550, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_6);
        __pyx_t_10 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1550, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_10);
        #endif
        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      } else {
        Py_ssize_t index = -1;
        __pyx_t_12 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1550, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_12);
        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
        __pyx_t_13 = Py_TYPE(__pyx_t_12)->tp_iternext;
        index = 0; __pyx_t_6 = __pyx_t_13(__pyx_t_12); if (unlikely(!__pyx_t_6)) goto __pyx_L9_unpacking_failed;
        __Pyx_GOTREF(__pyx_t_6);
        index = 1; __pyx_t_10 = __pyx_t_13(__pyx_t_12); if (unlikely(!__pyx_t_10)) goto __pyx_L9_unpacking_failed;
        __Pyx_GOTREF(__pyx_t_10);
        if (__Pyx_IternextUnpackEndCheck(__pyx_t_13(__pyx_t_12), 2) < 0) __PYX_ERR(0, 1550, __pyx_L1_error)
        __pyx_t_13 = NULL;
        __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
        goto __pyx_L10_unpacking_done;
        __pyx_L9_unpacking_failed:;
        __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
        __pyx_t_13 = NULL;
        if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
        __PYX_ERR(0, 1550, __pyx_L1_error)
        __pyx_L10_unpacking_done:;
      }
      __pyx_v_window_size = __pyx_t_6;
      __pyx_t_6 = 0;
      __pyx_v_window_size_qc = __pyx_t_10;
      __pyx_t_10 = 0;

      /* "vapor_vali/Simple_function.pyx":1551
 *             ref_seq=ref_seq_readin(ref,sv_info[0],min(bp_info)-flank_length,max(bp_info)+flank_length)
 *             [window_size,window_size_qc]=window_size_refine(ref_seq)
 *             if not window_size=='Error':             # <<<<<<<<<<<<<<
 *                 run_flag+=1
 *                 ref_structure=[i for i in 'ab']
 */
      __pyx_t_7 = (__Pyx_PyString_Equals(__pyx_v_window_size, __pyx_n_s_Error, Py_EQ)); if (unlikely(__pyx_t_7 < 0)) __PYX_ERR(0, 1551, __pyx_L1_error)
      __pyx_t_9 = ((!__pyx_t_7) != 0);
      if (__pyx_t_9) {

        /* "vapor_vali/Simple_function.pyx":1552
 *             [window_size,window_size_qc]=window_size_refine(ref_seq)
 *             if not window_size=='Error':
 *                 run_flag+=1             # <<<<<<<<<<<<<<
 *                 ref_structure=[i for i in 'ab']
 *                 if sv_info[4]>sv_info[2]:           alt_structure=['a','b','a^']
 */
        __pyx_t_1 = __Pyx_PyInt_AddObjC(__pyx_v_run_flag, __pyx_int_1, 1, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1552, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        __Pyx_DECREF_SET(__pyx_v_run_flag, __pyx_t_1);
        __pyx_t_1 = 0;

        /* "vapor_vali/Simple_function.pyx":1553
 *             if not window_size=='Error':
 *                 run_flag+=1
 *                 ref_structure=[i for i in 'ab']             # <<<<<<<<<<<<<<
 *                 if sv_info[4]>sv_info[2]:           alt_structure=['a','b','a^']
 *                 elif sv_info[4]<sv_info[1]:         alt_structure=['b^','a','b']
 */
        __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1553, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        __pyx_t_10 = PyObject_GetIter(__pyx_n_s_ab); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1553, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_10);
        __pyx_t_5 = Py_TYPE(__pyx_t_10)->tp_iternext; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1553, __pyx_L1_error)
        for (;;) {
          {
            __pyx_t_6 = __pyx_t_5(__pyx_t_10);
            if (unlikely(!__pyx_t_6)) {
              PyObject* exc_type = PyErr_Occurred();
              if (exc_type) {
                if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
                else __PYX_ERR(0, 1553, __pyx_L1_error)
              }
              break;
            }
            __Pyx_GOTREF(__pyx_t_6);
          }
          __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_6);
          __pyx_t_6 = 0;
          if (unlikely(__Pyx_ListComp_Append(__pyx_t_1, (PyObject*)__pyx_v_i))) __PYX_ERR(0, 1553, __pyx_L1_error)
        }
        __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
        __pyx_v_ref_structure = ((PyObject*)__pyx_t_1);
        __pyx_t_1 = 0;

        /* "vapor_vali/Simple_function.pyx":1554
 *                 run_flag+=1
 *                 ref_structure=[i for i in 'ab']
 *                 if sv_info[4]>sv_info[2]:           alt_structure=['a','b','a^']             # <<<<<<<<<<<<<<
 *                 elif sv_info[4]<sv_info[1]:         alt_structure=['b^','a','b']
 *                 else:                               alt_structure=['a','a^']
 */
        __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_sv_info, 4, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1554, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        __pyx_t_10 = __Pyx_GetItemInt(__pyx_v_sv_info, 2, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1554, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_10);
        __pyx_t_6 = PyObject_RichCompare(__pyx_t_1, __pyx_t_10, Py_GT); __Pyx_XGOTREF(__pyx_t_6); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1554, __pyx_L1_error)
        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
        __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
        __pyx_t_9 = __Pyx_PyObject_IsTrue(__pyx_t_6); if (unlikely(__pyx_t_9 < 0)) __PYX_ERR(0, 1554, __pyx_L1_error)
        __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
        if (__pyx_t_9) {
          __pyx_t_6 = PyList_New(3); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1554, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_6);
          __Pyx_INCREF(__pyx_n_s_a);
          __Pyx_GIVEREF(__pyx_n_s_a);
          PyList_SET_ITEM(__pyx_t_6, 0, __pyx_n_s_a);
          __Pyx_INCREF(__pyx_n_s_b);
          __Pyx_GIVEREF(__pyx_n_s_b);
          PyList_SET_ITEM(__pyx_t_6, 1, __pyx_n_s_b);
          __Pyx_INCREF(__pyx_kp_s_a_2);
          __Pyx_GIVEREF(__pyx_kp_s_a_2);
          PyList_SET_ITEM(__pyx_t_6, 2, __pyx_kp_s_a_2);
          __pyx_v_alt_structure = ((PyObject*)__pyx_t_6);
          __pyx_t_6 = 0;
          goto __pyx_L14;
        }

        /* "vapor_vali/Simple_function.pyx":1555
 *                 ref_structure=[i for i in 'ab']
 *                 if sv_info[4]>sv_info[2]:           alt_structure=['a','b','a^']
 *                 elif sv_info[4]<sv_info[1]:         alt_structure=['b^','a','b']             # <<<<<<<<<<<<<<
 *                 else:                               alt_structure=['a','a^']
 *                 #[ref_bps,alt_bps]=dup_inv_ref_alt_bps_produce(sv_info,flank_length,alt_structure)
 */
        __pyx_t_6 = __Pyx_GetItemInt(__pyx_v_sv_info, 4, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1555, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_6);
        __pyx_t_10 = __Pyx_GetItemInt(__pyx_v_sv_info, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1555, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_10);
        __pyx_t_1 = PyObject_RichCompare(__pyx_t_6, __pyx_t_10, Py_LT); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1555, __pyx_L1_error)
        __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
        __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
        __pyx_t_9 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_9 < 0)) __PYX_ERR(0, 1555, __pyx_L1_error)
        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
        if (__pyx_t_9) {
          __pyx_t_1 = PyList_New(3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1555, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_1);
          __Pyx_INCREF(__pyx_kp_s_b_2);
          __Pyx_GIVEREF(__pyx_kp_s_b_2);
          PyList_SET_ITEM(__pyx_t_1, 0, __pyx_kp_s_b_2);
          __Pyx_INCREF(__pyx_n_s_a);
          __Pyx_GIVEREF(__pyx_n_s_a);
          PyList_SET_ITEM(__pyx_t_1, 1, __pyx_n_s_a);
          __Pyx_INCREF(__pyx_n_s_b);
          __Pyx_GIVEREF(__pyx_n_s_b);
          PyList_SET_ITEM(__pyx_t_1, 2, __pyx_n_s_b);
          __pyx_v_alt_structure = ((PyObject*)__pyx_t_1);
          __pyx_t_1 = 0;
          goto __pyx_L14;
        }

        /* "vapor_vali/Simple_function.pyx":1556
 *                 if sv_info[4]>sv_info[2]:           alt_structure=['a','b','a^']
 *                 elif sv_info[4]<sv_info[1]:         alt_structure=['b^','a','b']
 *                 else:                               alt_structure=['a','a^']             # <<<<<<<<<<<<<<
 *                 #[ref_bps,alt_bps]=dup_inv_ref_alt_bps_produce(sv_info,flank_length,alt_structure)
 *                 #dup_block_bps=dup_inv_dup_bps_produce(sv_info,flank_length,alt_structure)
 */
        /*else*/ {
          __pyx_t_1 = PyList_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1556, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_1);
          __Pyx_INCREF(__pyx_n_s_a);
          __Pyx_GIVEREF(__pyx_n_s_a);
          PyList_SET_ITEM(__pyx_t_1, 0, __pyx_n_s_a);
          __Pyx_INCREF(__pyx_kp_s_a_2);
          __Pyx_GIVEREF(__pyx_kp_s_a_2);
          PyList_SET_ITEM(__pyx_t_1, 1, __pyx_kp_s_a_2);
          __pyx_v_alt_structure = ((PyObject*)__pyx_t_1);
          __pyx_t_1 = 0;
        }
        __pyx_L14:;

        /* "vapor_vali/Simple_function.pyx":1559
 *                 #[ref_bps,alt_bps]=dup_inv_ref_alt_bps_produce(sv_info,flank_length,alt_structure)
 *                 #dup_block_bps=dup_inv_dup_bps_produce(sv_info,flank_length,alt_structure)
 *                 all_reads=simple_chop_pacbio_read_simple_short(bam_in,[sv_info[0]]+bp_info+[bp_info[-1]+sv_info[2]-sv_info[1]],flank_length)             # <<<<<<<<<<<<<<
 *                 if len(all_reads)>0:
 *                     alt_seq=ref_seq_readin(ref,sv_info[0],min(bp_info)-flank_length,min(bp_info))
 */
        __pyx_t_10 = __Pyx_GetModuleGlobalName(__pyx_n_s_simple_chop_pacbio_read_simple_s); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1559, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_10);
        __pyx_t_6 = __Pyx_GetItemInt(__pyx_v_sv_info, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1559, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_6);
        __pyx_t_12 = PyList_New(1); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1559, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_12);
        __Pyx_GIVEREF(__pyx_t_6);
        PyList_SET_ITEM(__pyx_t_12, 0, __pyx_t_6);
        __pyx_t_6 = 0;
        __pyx_t_6 = PyNumber_Add(__pyx_t_12, __pyx_v_bp_info); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1559, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_6);
        __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
        if (unlikely(__pyx_v_bp_info == Py_None)) {
          PyErr_SetString(PyExc_TypeError, "'NoneType' object is not subscriptable");
          __PYX_ERR(0, 1559, __pyx_L1_error)
        }
        __pyx_t_12 = __Pyx_GetItemInt_List(__pyx_v_bp_info, -1L, long, 1, __Pyx_PyInt_From_long, 1, 1, 1); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1559, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_12);
        __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_sv_info, 2, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1559, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
        __pyx_t_3 = PyNumber_Add(__pyx_t_12, __pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1559, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_3);
        __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
        __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_sv_info, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1559, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
        __pyx_t_12 = PyNumber_Subtract(__pyx_t_3, __pyx_t_2); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1559, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_12);
        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
        __pyx_t_2 = PyList_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1559, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
        __Pyx_GIVEREF(__pyx_t_12);
        PyList_SET_ITEM(__pyx_t_2, 0, __pyx_t_12);
        __pyx_t_12 = 0;
        __pyx_t_12 = PyNumber_Add(__pyx_t_6, __pyx_t_2); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1559, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_12);
        __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
        __pyx_t_2 = NULL;
        __pyx_t_4 = 0;
        if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_10))) {
          __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_10);
          if (likely(__pyx_t_2)) {
            PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_10);
            __Pyx_INCREF(__pyx_t_2);
            __Pyx_INCREF(function);
            __Pyx_DECREF_SET(__pyx_t_10, function);
            __pyx_t_4 = 1;
          }
        }
        __pyx_t_6 = PyTuple_New(3+__pyx_t_4); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1559, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_6);
        if (__pyx_t_2) {
          __Pyx_GIVEREF(__pyx_t_2); PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_2); __pyx_t_2 = NULL;
        }
        __Pyx_INCREF(__pyx_v_bam_in);
        __Pyx_GIVEREF(__pyx_v_bam_in);
        PyTuple_SET_ITEM(__pyx_t_6, 0+__pyx_t_4, __pyx_v_bam_in);
        __Pyx_GIVEREF(__pyx_t_12);
        PyTuple_SET_ITEM(__pyx_t_6, 1+__pyx_t_4, __pyx_t_12);
        __Pyx_INCREF(__pyx_v_flank_length);
        __Pyx_GIVEREF(__pyx_v_flank_length);
        PyTuple_SET_ITEM(__pyx_t_6, 2+__pyx_t_4, __pyx_v_flank_length);
        __pyx_t_12 = 0;
        __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_10, __pyx_t_6, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1559, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
        __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
        __pyx_v_all_reads = __pyx_t_1;
        __pyx_t_1 = 0;

        /* "vapor_vali/Simple_function.pyx":1560
 *                 #dup_block_bps=dup_inv_dup_bps_produce(sv_info,flank_length,alt_structure)
 *                 all_reads=simple_chop_pacbio_read_simple_short(bam_in,[sv_info[0]]+bp_info+[bp_info[-1]+sv_info[2]-sv_info[1]],flank_length)
 *                 if len(all_reads)>0:             # <<<<<<<<<<<<<<
 *                     alt_seq=ref_seq_readin(ref,sv_info[0],min(bp_info)-flank_length,min(bp_info))
 *                     a_seq=ref_seq_readin(ref,sv_info[0],bp_info[0],bp_info[1])
 */
        __pyx_t_4 = PyObject_Length(__pyx_v_all_reads); if (unlikely(__pyx_t_4 == -1)) __PYX_ERR(0, 1560, __pyx_L1_error)
        __pyx_t_9 = ((__pyx_t_4 > 0) != 0);
        if (__pyx_t_9) {

          /* "vapor_vali/Simple_function.pyx":1561
 *                 all_reads=simple_chop_pacbio_read_simple_short(bam_in,[sv_info[0]]+bp_info+[bp_info[-1]+sv_info[2]-sv_info[1]],flank_length)
 *                 if len(all_reads)>0:
 *                     alt_seq=ref_seq_readin(ref,sv_info[0],min(bp_info)-flank_length,min(bp_info))             # <<<<<<<<<<<<<<
 *                     a_seq=ref_seq_readin(ref,sv_info[0],bp_info[0],bp_info[1])
 *                     b_seq=ref_seq_readin(ref,sv_info[0],bp_info[1],bp_info[2])
 */
          __pyx_t_10 = __Pyx_GetModuleGlobalName(__pyx_n_s_ref_seq_readin); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1561, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_10);
          __pyx_t_6 = __Pyx_GetItemInt(__pyx_v_sv_info, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1561, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_6);
          __pyx_t_12 = PyTuple_New(1); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1561, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_12);
          __Pyx_INCREF(__pyx_v_bp_info);
          __Pyx_GIVEREF(__pyx_v_bp_info);
          PyTuple_SET_ITEM(__pyx_t_12, 0, __pyx_v_bp_info);
          __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_min, __pyx_t_12, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1561, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_2);
          __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
          __pyx_t_12 = PyNumber_Subtract(__pyx_t_2, __pyx_v_flank_length); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1561, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_12);
          __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
          __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1561, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_2);
          __Pyx_INCREF(__pyx_v_bp_info);
          __Pyx_GIVEREF(__pyx_v_bp_info);
          PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_v_bp_info);
          __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_min, __pyx_t_2, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1561, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_3);
          __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
          __pyx_t_2 = NULL;
          __pyx_t_4 = 0;
          if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_10))) {
            __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_10);
            if (likely(__pyx_t_2)) {
              PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_10);
              __Pyx_INCREF(__pyx_t_2);
              __Pyx_INCREF(function);
              __Pyx_DECREF_SET(__pyx_t_10, function);
              __pyx_t_4 = 1;
            }
          }
          __pyx_t_11 = PyTuple_New(4+__pyx_t_4); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1561, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_11);
          if (__pyx_t_2) {
            __Pyx_GIVEREF(__pyx_t_2); PyTuple_SET_ITEM(__pyx_t_11, 0, __pyx_t_2); __pyx_t_2 = NULL;
          }
          __Pyx_INCREF(__pyx_v_ref);
          __Pyx_GIVEREF(__pyx_v_ref);
          PyTuple_SET_ITEM(__pyx_t_11, 0+__pyx_t_4, __pyx_v_ref);
          __Pyx_GIVEREF(__pyx_t_6);
          PyTuple_SET_ITEM(__pyx_t_11, 1+__pyx_t_4, __pyx_t_6);
          __Pyx_GIVEREF(__pyx_t_12);
          PyTuple_SET_ITEM(__pyx_t_11, 2+__pyx_t_4, __pyx_t_12);
          __Pyx_GIVEREF(__pyx_t_3);
          PyTuple_SET_ITEM(__pyx_t_11, 3+__pyx_t_4, __pyx_t_3);
          __pyx_t_6 = 0;
          __pyx_t_12 = 0;
          __pyx_t_3 = 0;
          __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_10, __pyx_t_11, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1561, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_1);
          __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
          __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
          __pyx_v_alt_seq = __pyx_t_1;
          __pyx_t_1 = 0;

          /* "vapor_vali/Simple_function.pyx":1562
 *                 if len(all_reads)>0:
 *                     alt_seq=ref_seq_readin(ref,sv_info[0],min(bp_info)-flank_length,min(bp_info))
 *                     a_seq=ref_seq_readin(ref,sv_info[0],bp_info[0],bp_info[1])             # <<<<<<<<<<<<<<
 *                     b_seq=ref_seq_readin(ref,sv_info[0],bp_info[1],bp_info[2])
 *                     for x in alt_structure:
 */
          __pyx_t_10 = __Pyx_GetModuleGlobalName(__pyx_n_s_ref_seq_readin); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1562, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_10);
          __pyx_t_11 = __Pyx_GetItemInt(__pyx_v_sv_info, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1562, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_11);
          if (unlikely(__pyx_v_bp_info == Py_None)) {
            PyErr_SetString(PyExc_TypeError, "'NoneType' object is not subscriptable");
            __PYX_ERR(0, 1562, __pyx_L1_error)
          }
          __pyx_t_3 = __Pyx_GetItemInt_List(__pyx_v_bp_info, 0, long, 1, __Pyx_PyInt_From_long, 1, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1562, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_3);
          if (unlikely(__pyx_v_bp_info == Py_None)) {
            PyErr_SetString(PyExc_TypeError, "'NoneType' object is not subscriptable");
            __PYX_ERR(0, 1562, __pyx_L1_error)
          }
          __pyx_t_12 = __Pyx_GetItemInt_List(__pyx_v_bp_info, 1, long, 1, __Pyx_PyInt_From_long, 1, 0, 1); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1562, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_12);
          __pyx_t_6 = NULL;
          __pyx_t_4 = 0;
          if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_10))) {
            __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_10);
            if (likely(__pyx_t_6)) {
              PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_10);
              __Pyx_INCREF(__pyx_t_6);
              __Pyx_INCREF(function);
              __Pyx_DECREF_SET(__pyx_t_10, function);
              __pyx_t_4 = 1;
            }
          }
          __pyx_t_2 = PyTuple_New(4+__pyx_t_4); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1562, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_2);
          if (__pyx_t_6) {
            __Pyx_GIVEREF(__pyx_t_6); PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_6); __pyx_t_6 = NULL;
          }
          __Pyx_INCREF(__pyx_v_ref);
          __Pyx_GIVEREF(__pyx_v_ref);
          PyTuple_SET_ITEM(__pyx_t_2, 0+__pyx_t_4, __pyx_v_ref);
          __Pyx_GIVEREF(__pyx_t_11);
          PyTuple_SET_ITEM(__pyx_t_2, 1+__pyx_t_4, __pyx_t_11);
          __Pyx_GIVEREF(__pyx_t_3);
          PyTuple_SET_ITEM(__pyx_t_2, 2+__pyx_t_4, __pyx_t_3);
          __Pyx_GIVEREF(__pyx_t_12);
          PyTuple_SET_ITEM(__pyx_t_2, 3+__pyx_t_4, __pyx_t_12);
          __pyx_t_11 = 0;
          __pyx_t_3 = 0;
          __pyx_t_12 = 0;
          __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_10, __pyx_t_2, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1562, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_1);
          __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
          __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
          __pyx_v_a_seq = __pyx_t_1;
          __pyx_t_1 = 0;

          /* "vapor_vali/Simple_function.pyx":1563
 *                     alt_seq=ref_seq_readin(ref,sv_info[0],min(bp_info)-flank_length,min(bp_info))
 *                     a_seq=ref_seq_readin(ref,sv_info[0],bp_info[0],bp_info[1])
 *                     b_seq=ref_seq_readin(ref,sv_info[0],bp_info[1],bp_info[2])             # <<<<<<<<<<<<<<
 *                     for x in alt_structure:
 *                         if x=='a':  alt_seq+=a_seq
 */
          __pyx_t_10 = __Pyx_GetModuleGlobalName(__pyx_n_s_ref_seq_readin); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1563, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_10);
          __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_sv_info, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1563, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_2);
          if (unlikely(__pyx_v_bp_info == Py_None)) {
            PyErr_SetString(PyExc_TypeError, "'NoneType' object is not subscriptable");
            __PYX_ERR(0, 1563, __pyx_L1_error)
          }
          __pyx_t_12 = __Pyx_GetItemInt_List(__pyx_v_bp_info, 1, long, 1, __Pyx_PyInt_From_long, 1, 0, 1); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1563, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_12);
          if (unlikely(__pyx_v_bp_info == Py_None)) {
            PyErr_SetString(PyExc_TypeError, "'NoneType' object is not subscriptable");
            __PYX_ERR(0, 1563, __pyx_L1_error)
          }
          __pyx_t_3 = __Pyx_GetItemInt_List(__pyx_v_bp_info, 2, long, 1, __Pyx_PyInt_From_long, 1, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1563, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_3);
          __pyx_t_11 = NULL;
          __pyx_t_4 = 0;
          if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_10))) {
            __pyx_t_11 = PyMethod_GET_SELF(__pyx_t_10);
            if (likely(__pyx_t_11)) {
              PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_10);
              __Pyx_INCREF(__pyx_t_11);
              __Pyx_INCREF(function);
              __Pyx_DECREF_SET(__pyx_t_10, function);
              __pyx_t_4 = 1;
            }
          }
          __pyx_t_6 = PyTuple_New(4+__pyx_t_4); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1563, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_6);
          if (__pyx_t_11) {
            __Pyx_GIVEREF(__pyx_t_11); PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_11); __pyx_t_11 = NULL;
          }
          __Pyx_INCREF(__pyx_v_ref);
          __Pyx_GIVEREF(__pyx_v_ref);
          PyTuple_SET_ITEM(__pyx_t_6, 0+__pyx_t_4, __pyx_v_ref);
          __Pyx_GIVEREF(__pyx_t_2);
          PyTuple_SET_ITEM(__pyx_t_6, 1+__pyx_t_4, __pyx_t_2);
          __Pyx_GIVEREF(__pyx_t_12);
          PyTuple_SET_ITEM(__pyx_t_6, 2+__pyx_t_4, __pyx_t_12);
          __Pyx_GIVEREF(__pyx_t_3);
          PyTuple_SET_ITEM(__pyx_t_6, 3+__pyx_t_4, __pyx_t_3);
          __pyx_t_2 = 0;
          __pyx_t_12 = 0;
          __pyx_t_3 = 0;
          __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_10, __pyx_t_6, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1563, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_1);
          __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
          __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
          __pyx_v_b_seq = __pyx_t_1;
          __pyx_t_1 = 0;

          /* "vapor_vali/Simple_function.pyx":1564
 *                     a_seq=ref_seq_readin(ref,sv_info[0],bp_info[0],bp_info[1])
 *                     b_seq=ref_seq_readin(ref,sv_info[0],bp_info[1],bp_info[2])
 *                     for x in alt_structure:             # <<<<<<<<<<<<<<
 *                         if x=='a':  alt_seq+=a_seq
 *                         elif x=='a^':   alt_seq+=reverse(complementary(a_seq))
 */
          __pyx_t_1 = __pyx_v_alt_structure; __Pyx_INCREF(__pyx_t_1); __pyx_t_4 = 0;
          for (;;) {
            if (__pyx_t_4 >= PyList_GET_SIZE(__pyx_t_1)) break;
            #if CYTHON_COMPILING_IN_CPYTHON
            __pyx_t_10 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_4); __Pyx_INCREF(__pyx_t_10); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 1564, __pyx_L1_error)
            #else
            __pyx_t_10 = PySequence_ITEM(__pyx_t_1, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1564, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_10);
            #endif
            __Pyx_XDECREF_SET(__pyx_v_x, __pyx_t_10);
            __pyx_t_10 = 0;

            /* "vapor_vali/Simple_function.pyx":1565
 *                     b_seq=ref_seq_readin(ref,sv_info[0],bp_info[1],bp_info[2])
 *                     for x in alt_structure:
 *                         if x=='a':  alt_seq+=a_seq             # <<<<<<<<<<<<<<
 *                         elif x=='a^':   alt_seq+=reverse(complementary(a_seq))
 *                         elif x=='b':    alt_seq+=b_seq
 */
            __pyx_t_9 = (__Pyx_PyString_Equals(__pyx_v_x, __pyx_n_s_a, Py_EQ)); if (unlikely(__pyx_t_9 < 0)) __PYX_ERR(0, 1565, __pyx_L1_error)
            if (__pyx_t_9) {
              __pyx_t_10 = PyNumber_InPlaceAdd(__pyx_v_alt_seq, __pyx_v_a_seq); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1565, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_10);
              __Pyx_DECREF_SET(__pyx_v_alt_seq, __pyx_t_10);
              __pyx_t_10 = 0;
              goto __pyx_L18;
            }

            /* "vapor_vali/Simple_function.pyx":1566
 *                     for x in alt_structure:
 *                         if x=='a':  alt_seq+=a_seq
 *                         elif x=='a^':   alt_seq+=reverse(complementary(a_seq))             # <<<<<<<<<<<<<<
 *                         elif x=='b':    alt_seq+=b_seq
 *                         elif x=='b^':   alt_seq+=reverse(complementary(b_seq))
 */
            __pyx_t_9 = (__Pyx_PyString_Equals(__pyx_v_x, __pyx_kp_s_a_2, Py_EQ)); if (unlikely(__pyx_t_9 < 0)) __PYX_ERR(0, 1566, __pyx_L1_error)
            if (__pyx_t_9) {
              __pyx_t_6 = __Pyx_GetModuleGlobalName(__pyx_n_s_reverse); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1566, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_6);
              __pyx_t_12 = __Pyx_GetModuleGlobalName(__pyx_n_s_complementary); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1566, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_12);
              __pyx_t_2 = NULL;
              if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_12))) {
                __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_12);
                if (likely(__pyx_t_2)) {
                  PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_12);
                  __Pyx_INCREF(__pyx_t_2);
                  __Pyx_INCREF(function);
                  __Pyx_DECREF_SET(__pyx_t_12, function);
                }
              }
              if (!__pyx_t_2) {
                __pyx_t_3 = __Pyx_PyObject_CallOneArg(__pyx_t_12, __pyx_v_a_seq); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1566, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_3);
              } else {
                __pyx_t_11 = PyTuple_New(1+1); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1566, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_11);
                __Pyx_GIVEREF(__pyx_t_2); PyTuple_SET_ITEM(__pyx_t_11, 0, __pyx_t_2); __pyx_t_2 = NULL;
                __Pyx_INCREF(__pyx_v_a_seq);
                __Pyx_GIVEREF(__pyx_v_a_seq);
                PyTuple_SET_ITEM(__pyx_t_11, 0+1, __pyx_v_a_seq);
                __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_12, __pyx_t_11, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1566, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_3);
                __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
              }
              __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
              __pyx_t_12 = NULL;
              if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_6))) {
                __pyx_t_12 = PyMethod_GET_SELF(__pyx_t_6);
                if (likely(__pyx_t_12)) {
                  PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
                  __Pyx_INCREF(__pyx_t_12);
                  __Pyx_INCREF(function);
                  __Pyx_DECREF_SET(__pyx_t_6, function);
                }
              }
              if (!__pyx_t_12) {
                __pyx_t_10 = __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_3); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1566, __pyx_L1_error)
                __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
                __Pyx_GOTREF(__pyx_t_10);
              } else {
                __pyx_t_11 = PyTuple_New(1+1); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1566, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_11);
                __Pyx_GIVEREF(__pyx_t_12); PyTuple_SET_ITEM(__pyx_t_11, 0, __pyx_t_12); __pyx_t_12 = NULL;
                __Pyx_GIVEREF(__pyx_t_3);
                PyTuple_SET_ITEM(__pyx_t_11, 0+1, __pyx_t_3);
                __pyx_t_3 = 0;
                __pyx_t_10 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_11, NULL); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1566, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_10);
                __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
              }
              __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
              __pyx_t_6 = PyNumber_InPlaceAdd(__pyx_v_alt_seq, __pyx_t_10); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1566, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_6);
              __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
              __Pyx_DECREF_SET(__pyx_v_alt_seq, __pyx_t_6);
              __pyx_t_6 = 0;
              goto __pyx_L18;
            }

            /* "vapor_vali/Simple_function.pyx":1567
 *                         if x=='a':  alt_seq+=a_seq
 *                         elif x=='a^':   alt_seq+=reverse(complementary(a_seq))
 *                         elif x=='b':    alt_seq+=b_seq             # <<<<<<<<<<<<<<
 *                         elif x=='b^':   alt_seq+=reverse(complementary(b_seq))
 *                     alt_seq+=ref_seq_readin(ref,sv_info[0],max(bp_info),max(bp_info)+flank_length)
 */
            __pyx_t_9 = (__Pyx_PyString_Equals(__pyx_v_x, __pyx_n_s_b, Py_EQ)); if (unlikely(__pyx_t_9 < 0)) __PYX_ERR(0, 1567, __pyx_L1_error)
            if (__pyx_t_9) {
              __pyx_t_6 = PyNumber_InPlaceAdd(__pyx_v_alt_seq, __pyx_v_b_seq); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1567, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_6);
              __Pyx_DECREF_SET(__pyx_v_alt_seq, __pyx_t_6);
              __pyx_t_6 = 0;
              goto __pyx_L18;
            }

            /* "vapor_vali/Simple_function.pyx":1568
 *                         elif x=='a^':   alt_seq+=reverse(complementary(a_seq))
 *                         elif x=='b':    alt_seq+=b_seq
 *                         elif x=='b^':   alt_seq+=reverse(complementary(b_seq))             # <<<<<<<<<<<<<<
 *                     alt_seq+=ref_seq_readin(ref,sv_info[0],max(bp_info),max(bp_info)+flank_length)
 *                     [window_size,window_size_qc]=window_size_refine(alt_seq)
 */
            __pyx_t_9 = (__Pyx_PyString_Equals(__pyx_v_x, __pyx_kp_s_b_2, Py_EQ)); if (unlikely(__pyx_t_9 < 0)) __PYX_ERR(0, 1568, __pyx_L1_error)
            if (__pyx_t_9) {
              __pyx_t_10 = __Pyx_GetModuleGlobalName(__pyx_n_s_reverse); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1568, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_10);
              __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_complementary); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1568, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_3);
              __pyx_t_12 = NULL;
              if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_3))) {
                __pyx_t_12 = PyMethod_GET_SELF(__pyx_t_3);
                if (likely(__pyx_t_12)) {
                  PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
                  __Pyx_INCREF(__pyx_t_12);
                  __Pyx_INCREF(function);
                  __Pyx_DECREF_SET(__pyx_t_3, function);
                }
              }
              if (!__pyx_t_12) {
                __pyx_t_11 = __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_v_b_seq); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1568, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_11);
              } else {
                __pyx_t_2 = PyTuple_New(1+1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1568, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_2);
                __Pyx_GIVEREF(__pyx_t_12); PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_12); __pyx_t_12 = NULL;
                __Pyx_INCREF(__pyx_v_b_seq);
                __Pyx_GIVEREF(__pyx_v_b_seq);
                PyTuple_SET_ITEM(__pyx_t_2, 0+1, __pyx_v_b_seq);
                __pyx_t_11 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_2, NULL); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1568, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_11);
                __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
              }
              __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
              __pyx_t_3 = NULL;
              if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_10))) {
                __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_10);
                if (likely(__pyx_t_3)) {
                  PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_10);
                  __Pyx_INCREF(__pyx_t_3);
                  __Pyx_INCREF(function);
                  __Pyx_DECREF_SET(__pyx_t_10, function);
                }
              }
              if (!__pyx_t_3) {
                __pyx_t_6 = __Pyx_PyObject_CallOneArg(__pyx_t_10, __pyx_t_11); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1568, __pyx_L1_error)
                __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
                __Pyx_GOTREF(__pyx_t_6);
              } else {
                __pyx_t_2 = PyTuple_New(1+1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1568, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_2);
                __Pyx_GIVEREF(__pyx_t_3); PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_3); __pyx_t_3 = NULL;
                __Pyx_GIVEREF(__pyx_t_11);
                PyTuple_SET_ITEM(__pyx_t_2, 0+1, __pyx_t_11);
                __pyx_t_11 = 0;
                __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_10, __pyx_t_2, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1568, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_6);
                __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
              }
              __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
              __pyx_t_10 = PyNumber_InPlaceAdd(__pyx_v_alt_seq, __pyx_t_6); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1568, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_10);
              __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
              __Pyx_DECREF_SET(__pyx_v_alt_seq, __pyx_t_10);
              __pyx_t_10 = 0;
            }
            __pyx_L18:;

            /* "vapor_vali/Simple_function.pyx":1564
 *                     a_seq=ref_seq_readin(ref,sv_info[0],bp_info[0],bp_info[1])
 *                     b_seq=ref_seq_readin(ref,sv_info[0],bp_info[1],bp_info[2])
 *                     for x in alt_structure:             # <<<<<<<<<<<<<<
 *                         if x=='a':  alt_seq+=a_seq
 *                         elif x=='a^':   alt_seq+=reverse(complementary(a_seq))
 */
          }
          __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

          /* "vapor_vali/Simple_function.pyx":1569
 *                         elif x=='b':    alt_seq+=b_seq
 *                         elif x=='b^':   alt_seq+=reverse(complementary(b_seq))
 *                     alt_seq+=ref_seq_readin(ref,sv_info[0],max(bp_info),max(bp_info)+flank_length)             # <<<<<<<<<<<<<<
 *                     [window_size,window_size_qc]=window_size_refine(alt_seq)
 *                     if not window_size=='Error':
 */
          __pyx_t_10 = __Pyx_GetModuleGlobalName(__pyx_n_s_ref_seq_readin); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1569, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_10);
          __pyx_t_6 = __Pyx_GetItemInt(__pyx_v_sv_info, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1569, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_6);
          __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1569, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_2);
          __Pyx_INCREF(__pyx_v_bp_info);
          __Pyx_GIVEREF(__pyx_v_bp_info);
          PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_v_bp_info);
          __pyx_t_11 = __Pyx_PyObject_Call(__pyx_builtin_max, __pyx_t_2, NULL); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1569, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_11);
          __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
          __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1569, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_2);
          __Pyx_INCREF(__pyx_v_bp_info);
          __Pyx_GIVEREF(__pyx_v_bp_info);
          PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_v_bp_info);
          __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_max, __pyx_t_2, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1569, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_3);
          __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
          __pyx_t_2 = PyNumber_Add(__pyx_t_3, __pyx_v_flank_length); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1569, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_2);
          __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
          __pyx_t_3 = NULL;
          __pyx_t_4 = 0;
          if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_10))) {
            __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_10);
            if (likely(__pyx_t_3)) {
              PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_10);
              __Pyx_INCREF(__pyx_t_3);
              __Pyx_INCREF(function);
              __Pyx_DECREF_SET(__pyx_t_10, function);
              __pyx_t_4 = 1;
            }
          }
          __pyx_t_12 = PyTuple_New(4+__pyx_t_4); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1569, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_12);
          if (__pyx_t_3) {
            __Pyx_GIVEREF(__pyx_t_3); PyTuple_SET_ITEM(__pyx_t_12, 0, __pyx_t_3); __pyx_t_3 = NULL;
          }
          __Pyx_INCREF(__pyx_v_ref);
          __Pyx_GIVEREF(__pyx_v_ref);
          PyTuple_SET_ITEM(__pyx_t_12, 0+__pyx_t_4, __pyx_v_ref);
          __Pyx_GIVEREF(__pyx_t_6);
          PyTuple_SET_ITEM(__pyx_t_12, 1+__pyx_t_4, __pyx_t_6);
          __Pyx_GIVEREF(__pyx_t_11);
          PyTuple_SET_ITEM(__pyx_t_12, 2+__pyx_t_4, __pyx_t_11);
          __Pyx_GIVEREF(__pyx_t_2);
          PyTuple_SET_ITEM(__pyx_t_12, 3+__pyx_t_4, __pyx_t_2);
          __pyx_t_6 = 0;
          __pyx_t_11 = 0;
          __pyx_t_2 = 0;
          __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_10, __pyx_t_12, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1569, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_1);
          __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
          __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
          __pyx_t_10 = PyNumber_InPlaceAdd(__pyx_v_alt_seq, __pyx_t_1); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1569, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_10);
          __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
          __Pyx_DECREF_SET(__pyx_v_alt_seq, __pyx_t_10);
          __pyx_t_10 = 0;

          /* "vapor_vali/Simple_function.pyx":1570
 *                         elif x=='b^':   alt_seq+=reverse(complementary(b_seq))
 *                     alt_seq+=ref_seq_readin(ref,sv_info[0],max(bp_info),max(bp_info)+flank_length)
 *                     [window_size,window_size_qc]=window_size_refine(alt_seq)             # <<<<<<<<<<<<<<
 *                     if not window_size=='Error':
 *                         best_read_rec=''
 */
          __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_window_size_refine); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1570, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_1);
          __pyx_t_12 = NULL;
          if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_1))) {
            __pyx_t_12 = PyMethod_GET_SELF(__pyx_t_1);
            if (likely(__pyx_t_12)) {
              PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
              __Pyx_INCREF(__pyx_t_12);
              __Pyx_INCREF(function);
              __Pyx_DECREF_SET(__pyx_t_1, function);
            }
          }
          if (!__pyx_t_12) {
            __pyx_t_10 = __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_v_alt_seq); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1570, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_10);
          } else {
            __pyx_t_2 = PyTuple_New(1+1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1570, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_2);
            __Pyx_GIVEREF(__pyx_t_12); PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_12); __pyx_t_12 = NULL;
            __Pyx_INCREF(__pyx_v_alt_seq);
            __Pyx_GIVEREF(__pyx_v_alt_seq);
            PyTuple_SET_ITEM(__pyx_t_2, 0+1, __pyx_v_alt_seq);
            __pyx_t_10 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_2, NULL); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1570, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_10);
            __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
          }
          __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
          if ((likely(PyTuple_CheckExact(__pyx_t_10))) || (PyList_CheckExact(__pyx_t_10))) {
            PyObject* sequence = __pyx_t_10;
            #if CYTHON_COMPILING_IN_CPYTHON
            Py_ssize_t size = Py_SIZE(sequence);
            #else
            Py_ssize_t size = PySequence_Size(sequence);
            #endif
            if (unlikely(size != 2)) {
              if (size > 2) __Pyx_RaiseTooManyValuesError(2);
              else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
              __PYX_ERR(0, 1570, __pyx_L1_error)
            }
            #if CYTHON_COMPILING_IN_CPYTHON
            if (likely(PyTuple_CheckExact(sequence))) {
              __pyx_t_1 = PyTuple_GET_ITEM(sequence, 0); 
              __pyx_t_2 = PyTuple_GET_ITEM(sequence, 1); 
            } else {
              __pyx_t_1 = PyList_GET_ITEM(sequence, 0); 
              __pyx_t_2 = PyList_GET_ITEM(sequence, 1); 
            }
            __Pyx_INCREF(__pyx_t_1);
            __Pyx_INCREF(__pyx_t_2);
            #else
            __pyx_t_1 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1570, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_1);
            __pyx_t_2 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1570, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_2);
            #endif
            __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
          } else {
            Py_ssize_t index = -1;
            __pyx_t_12 = PyObject_GetIter(__pyx_t_10); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1570, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_12);
            __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
            __pyx_t_13 = Py_TYPE(__pyx_t_12)->tp_iternext;
            index = 0; __pyx_t_1 = __pyx_t_13(__pyx_t_12); if (unlikely(!__pyx_t_1)) goto __pyx_L19_unpacking_failed;
            __Pyx_GOTREF(__pyx_t_1);
            index = 1; __pyx_t_2 = __pyx_t_13(__pyx_t_12); if (unlikely(!__pyx_t_2)) goto __pyx_L19_unpacking_failed;
            __Pyx_GOTREF(__pyx_t_2);
            if (__Pyx_IternextUnpackEndCheck(__pyx_t_13(__pyx_t_12), 2) < 0) __PYX_ERR(0, 1570, __pyx_L1_error)
            __pyx_t_13 = NULL;
            __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
            goto __pyx_L20_unpacking_done;
            __pyx_L19_unpacking_failed:;
            __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
            __pyx_t_13 = NULL;
            if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
            __PYX_ERR(0, 1570, __pyx_L1_error)
            __pyx_L20_unpacking_done:;
          }
          __Pyx_DECREF_SET(__pyx_v_window_size, __pyx_t_1);
          __pyx_t_1 = 0;
          __Pyx_DECREF_SET(__pyx_v_window_size_qc, __pyx_t_2);
          __pyx_t_2 = 0;

          /* "vapor_vali/Simple_function.pyx":1571
 *                     alt_seq+=ref_seq_readin(ref,sv_info[0],max(bp_info),max(bp_info)+flank_length)
 *                     [window_size,window_size_qc]=window_size_refine(alt_seq)
 *                     if not window_size=='Error':             # <<<<<<<<<<<<<<
 *                         best_read_rec=''
 *                         for x in all_reads:
 */
          __pyx_t_9 = (__Pyx_PyString_Equals(__pyx_v_window_size, __pyx_n_s_Error, Py_EQ)); if (unlikely(__pyx_t_9 < 0)) __PYX_ERR(0, 1571, __pyx_L1_error)
          __pyx_t_7 = ((!__pyx_t_9) != 0);
          if (__pyx_t_7) {

            /* "vapor_vali/Simple_function.pyx":1572
 *                     [window_size,window_size_qc]=window_size_refine(alt_seq)
 *                     if not window_size=='Error':
 *                         best_read_rec=''             # <<<<<<<<<<<<<<
 *                         for x in all_reads:
 *                             vapor_single_read_score=calcu_vapor_single_read_score_directed_dis_m1b_redefine_diagnal(ref_seq,alt_seq,x,window_size)
 */
            __Pyx_INCREF(__pyx_kp_s__24);
            __pyx_v_best_read_rec = __pyx_kp_s__24;

            /* "vapor_vali/Simple_function.pyx":1573
 *                     if not window_size=='Error':
 *                         best_read_rec=''
 *                         for x in all_reads:             # <<<<<<<<<<<<<<
 *                             vapor_single_read_score=calcu_vapor_single_read_score_directed_dis_m1b_redefine_diagnal(ref_seq,alt_seq,x,window_size)
 *                             if not 0 in vapor_single_read_score and not math.isnan(vapor_single_read_score[0]) and not math.isnan(vapor_single_read_score[1]):
 */
            if (likely(PyList_CheckExact(__pyx_v_all_reads)) || PyTuple_CheckExact(__pyx_v_all_reads)) {
              __pyx_t_10 = __pyx_v_all_reads; __Pyx_INCREF(__pyx_t_10); __pyx_t_4 = 0;
              __pyx_t_5 = NULL;
            } else {
              __pyx_t_4 = -1; __pyx_t_10 = PyObject_GetIter(__pyx_v_all_reads); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1573, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_10);
              __pyx_t_5 = Py_TYPE(__pyx_t_10)->tp_iternext; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1573, __pyx_L1_error)
            }
            for (;;) {
              if (likely(!__pyx_t_5)) {
                if (likely(PyList_CheckExact(__pyx_t_10))) {
                  if (__pyx_t_4 >= PyList_GET_SIZE(__pyx_t_10)) break;
                  #if CYTHON_COMPILING_IN_CPYTHON
                  __pyx_t_2 = PyList_GET_ITEM(__pyx_t_10, __pyx_t_4); __Pyx_INCREF(__pyx_t_2); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 1573, __pyx_L1_error)
                  #else
                  __pyx_t_2 = PySequence_ITEM(__pyx_t_10, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1573, __pyx_L1_error)
                  __Pyx_GOTREF(__pyx_t_2);
                  #endif
                } else {
                  if (__pyx_t_4 >= PyTuple_GET_SIZE(__pyx_t_10)) break;
                  #if CYTHON_COMPILING_IN_CPYTHON
                  __pyx_t_2 = PyTuple_GET_ITEM(__pyx_t_10, __pyx_t_4); __Pyx_INCREF(__pyx_t_2); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 1573, __pyx_L1_error)
                  #else
                  __pyx_t_2 = PySequence_ITEM(__pyx_t_10, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1573, __pyx_L1_error)
                  __Pyx_GOTREF(__pyx_t_2);
                  #endif
                }
              } else {
                __pyx_t_2 = __pyx_t_5(__pyx_t_10);
                if (unlikely(!__pyx_t_2)) {
                  PyObject* exc_type = PyErr_Occurred();
                  if (exc_type) {
                    if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
                    else __PYX_ERR(0, 1573, __pyx_L1_error)
                  }
                  break;
                }
                __Pyx_GOTREF(__pyx_t_2);
              }
              __Pyx_XDECREF_SET(__pyx_v_x, __pyx_t_2);
              __pyx_t_2 = 0;

              /* "vapor_vali/Simple_function.pyx":1574
 *                         best_read_rec=''
 *                         for x in all_reads:
 *                             vapor_single_read_score=calcu_vapor_single_read_score_directed_dis_m1b_redefine_diagnal(ref_seq,alt_seq,x,window_size)             # <<<<<<<<<<<<<<
 *                             if not 0 in vapor_single_read_score and not math.isnan(vapor_single_read_score[0]) and not math.isnan(vapor_single_read_score[1]):
 *                                 vapor_score_list.append(1-float(vapor_single_read_score[1])/float(vapor_single_read_score[0]))
 */
              __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_calcu_vapor_single_read_score_di); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1574, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_1);
              __pyx_t_12 = NULL;
              __pyx_t_14 = 0;
              if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_1))) {
                __pyx_t_12 = PyMethod_GET_SELF(__pyx_t_1);
                if (likely(__pyx_t_12)) {
                  PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
                  __Pyx_INCREF(__pyx_t_12);
                  __Pyx_INCREF(function);
                  __Pyx_DECREF_SET(__pyx_t_1, function);
                  __pyx_t_14 = 1;
                }
              }
              __pyx_t_11 = PyTuple_New(4+__pyx_t_14); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1574, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_11);
              if (__pyx_t_12) {
                __Pyx_GIVEREF(__pyx_t_12); PyTuple_SET_ITEM(__pyx_t_11, 0, __pyx_t_12); __pyx_t_12 = NULL;
              }
              __Pyx_INCREF(__pyx_v_ref_seq);
              __Pyx_GIVEREF(__pyx_v_ref_seq);
              PyTuple_SET_ITEM(__pyx_t_11, 0+__pyx_t_14, __pyx_v_ref_seq);
              __Pyx_INCREF(__pyx_v_alt_seq);
              __Pyx_GIVEREF(__pyx_v_alt_seq);
              PyTuple_SET_ITEM(__pyx_t_11, 1+__pyx_t_14, __pyx_v_alt_seq);
              __Pyx_INCREF(__pyx_v_x);
              __Pyx_GIVEREF(__pyx_v_x);
              PyTuple_SET_ITEM(__pyx_t_11, 2+__pyx_t_14, __pyx_v_x);
              __Pyx_INCREF(__pyx_v_window_size);
              __Pyx_GIVEREF(__pyx_v_window_size);
              PyTuple_SET_ITEM(__pyx_t_11, 3+__pyx_t_14, __pyx_v_window_size);
              __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_11, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1574, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_2);
              __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
              __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
              __Pyx_XDECREF_SET(__pyx_v_vapor_single_read_score, __pyx_t_2);
              __pyx_t_2 = 0;

              /* "vapor_vali/Simple_function.pyx":1575
 *                         for x in all_reads:
 *                             vapor_single_read_score=calcu_vapor_single_read_score_directed_dis_m1b_redefine_diagnal(ref_seq,alt_seq,x,window_size)
 *                             if not 0 in vapor_single_read_score and not math.isnan(vapor_single_read_score[0]) and not math.isnan(vapor_single_read_score[1]):             # <<<<<<<<<<<<<<
 *                                 vapor_score_list.append(1-float(vapor_single_read_score[1])/float(vapor_single_read_score[0]))
 *                                 if vapor_score_list[-1]==max(vapor_score_list):best_read_rec=x
 */
              __pyx_t_9 = (__Pyx_PySequence_ContainsTF(__pyx_int_0, __pyx_v_vapor_single_read_score, Py_NE)); if (unlikely(__pyx_t_9 < 0)) __PYX_ERR(0, 1575, __pyx_L1_error)
              __pyx_t_15 = (__pyx_t_9 != 0);
              if (__pyx_t_15) {
              } else {
                __pyx_t_7 = __pyx_t_15;
                goto __pyx_L25_bool_binop_done;
              }
              __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_math); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1575, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_1);
              __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_isnan); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1575, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_11);
              __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
              __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_vapor_single_read_score, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1575, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_1);
              __pyx_t_12 = NULL;
              if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_11))) {
                __pyx_t_12 = PyMethod_GET_SELF(__pyx_t_11);
                if (likely(__pyx_t_12)) {
                  PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_11);
                  __Pyx_INCREF(__pyx_t_12);
                  __Pyx_INCREF(function);
                  __Pyx_DECREF_SET(__pyx_t_11, function);
                }
              }
              if (!__pyx_t_12) {
                __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_t_11, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1575, __pyx_L1_error)
                __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
                __Pyx_GOTREF(__pyx_t_2);
              } else {
                __pyx_t_6 = PyTuple_New(1+1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1575, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_6);
                __Pyx_GIVEREF(__pyx_t_12); PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_12); __pyx_t_12 = NULL;
                __Pyx_GIVEREF(__pyx_t_1);
                PyTuple_SET_ITEM(__pyx_t_6, 0+1, __pyx_t_1);
                __pyx_t_1 = 0;
                __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_11, __pyx_t_6, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1575, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_2);
                __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
              }
              __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
              __pyx_t_15 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_15 < 0)) __PYX_ERR(0, 1575, __pyx_L1_error)
              __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
              __pyx_t_9 = ((!__pyx_t_15) != 0);
              if (__pyx_t_9) {
              } else {
                __pyx_t_7 = __pyx_t_9;
                goto __pyx_L25_bool_binop_done;
              }
              __pyx_t_11 = __Pyx_GetModuleGlobalName(__pyx_n_s_math); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1575, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_11);
              __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_11, __pyx_n_s_isnan); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1575, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_6);
              __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
              __pyx_t_11 = __Pyx_GetItemInt(__pyx_v_vapor_single_read_score, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1575, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_11);
              __pyx_t_1 = NULL;
              if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_6))) {
                __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_6);
                if (likely(__pyx_t_1)) {
                  PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
                  __Pyx_INCREF(__pyx_t_1);
                  __Pyx_INCREF(function);
                  __Pyx_DECREF_SET(__pyx_t_6, function);
                }
              }
              if (!__pyx_t_1) {
                __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_11); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1575, __pyx_L1_error)
                __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
                __Pyx_GOTREF(__pyx_t_2);
              } else {
                __pyx_t_12 = PyTuple_New(1+1); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1575, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_12);
                __Pyx_GIVEREF(__pyx_t_1); PyTuple_SET_ITEM(__pyx_t_12, 0, __pyx_t_1); __pyx_t_1 = NULL;
                __Pyx_GIVEREF(__pyx_t_11);
                PyTuple_SET_ITEM(__pyx_t_12, 0+1, __pyx_t_11);
                __pyx_t_11 = 0;
                __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_12, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1575, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_2);
                __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
              }
              __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
              __pyx_t_9 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_9 < 0)) __PYX_ERR(0, 1575, __pyx_L1_error)
              __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
              __pyx_t_15 = ((!__pyx_t_9) != 0);
              __pyx_t_7 = __pyx_t_15;
              __pyx_L25_bool_binop_done:;
              if (__pyx_t_7) {

                /* "vapor_vali/Simple_function.pyx":1576
 *                             vapor_single_read_score=calcu_vapor_single_read_score_directed_dis_m1b_redefine_diagnal(ref_seq,alt_seq,x,window_size)
 *                             if not 0 in vapor_single_read_score and not math.isnan(vapor_single_read_score[0]) and not math.isnan(vapor_single_read_score[1]):
 *                                 vapor_score_list.append(1-float(vapor_single_read_score[1])/float(vapor_single_read_score[0]))             # <<<<<<<<<<<<<<
 *                                 if vapor_score_list[-1]==max(vapor_score_list):best_read_rec=x
 *                         make_event_figure_1(vapor_score_list,best_read_rec,window_size,ref_seq,alt_seq,out_figure_name)
 */
                __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_vapor_single_read_score, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1576, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_2);
                __pyx_t_16 = __Pyx_PyObject_AsDouble(__pyx_t_2); if (unlikely(__pyx_t_16 == ((double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1576, __pyx_L1_error)
                __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
                __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_vapor_single_read_score, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1576, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_2);
                __pyx_t_17 = __Pyx_PyObject_AsDouble(__pyx_t_2); if (unlikely(__pyx_t_17 == ((double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1576, __pyx_L1_error)
                __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
                if (unlikely(__pyx_t_17 == 0)) {
                  PyErr_SetString(PyExc_ZeroDivisionError, "float division");
                  __PYX_ERR(0, 1576, __pyx_L1_error)
                }
                __pyx_t_2 = PyFloat_FromDouble((1.0 - (__pyx_t_16 / __pyx_t_17))); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1576, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_2);
                __pyx_t_8 = __Pyx_PyList_Append(__pyx_v_vapor_score_list, __pyx_t_2); if (unlikely(__pyx_t_8 == -1)) __PYX_ERR(0, 1576, __pyx_L1_error)
                __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

                /* "vapor_vali/Simple_function.pyx":1577
 *                             if not 0 in vapor_single_read_score and not math.isnan(vapor_single_read_score[0]) and not math.isnan(vapor_single_read_score[1]):
 *                                 vapor_score_list.append(1-float(vapor_single_read_score[1])/float(vapor_single_read_score[0]))
 *                                 if vapor_score_list[-1]==max(vapor_score_list):best_read_rec=x             # <<<<<<<<<<<<<<
 *                         make_event_figure_1(vapor_score_list,best_read_rec,window_size,ref_seq,alt_seq,out_figure_name)
 *         if run_flag==0:
 */
                __pyx_t_2 = __Pyx_GetItemInt_List(__pyx_v_vapor_score_list, -1L, long, 1, __Pyx_PyInt_From_long, 1, 1, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1577, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_2);
                __pyx_t_6 = PyTuple_New(1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1577, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_6);
                __Pyx_INCREF(__pyx_v_vapor_score_list);
                __Pyx_GIVEREF(__pyx_v_vapor_score_list);
                PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_v_vapor_score_list);
                __pyx_t_12 = __Pyx_PyObject_Call(__pyx_builtin_max, __pyx_t_6, NULL); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1577, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_12);
                __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
                __pyx_t_6 = PyObject_RichCompare(__pyx_t_2, __pyx_t_12, Py_EQ); __Pyx_XGOTREF(__pyx_t_6); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1577, __pyx_L1_error)
                __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
                __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
                __pyx_t_7 = __Pyx_PyObject_IsTrue(__pyx_t_6); if (unlikely(__pyx_t_7 < 0)) __PYX_ERR(0, 1577, __pyx_L1_error)
                __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
                if (__pyx_t_7) {
                  __Pyx_INCREF(__pyx_v_x);
                  __Pyx_DECREF_SET(__pyx_v_best_read_rec, __pyx_v_x);
                }

                /* "vapor_vali/Simple_function.pyx":1575
 *                         for x in all_reads:
 *                             vapor_single_read_score=calcu_vapor_single_read_score_directed_dis_m1b_redefine_diagnal(ref_seq,alt_seq,x,window_size)
 *                             if not 0 in vapor_single_read_score and not math.isnan(vapor_single_read_score[0]) and not math.isnan(vapor_single_read_score[1]):             # <<<<<<<<<<<<<<
 *                                 vapor_score_list.append(1-float(vapor_single_read_score[1])/float(vapor_single_read_score[0]))
 *                                 if vapor_score_list[-1]==max(vapor_score_list):best_read_rec=x
 */
              }

              /* "vapor_vali/Simple_function.pyx":1573
 *                     if not window_size=='Error':
 *                         best_read_rec=''
 *                         for x in all_reads:             # <<<<<<<<<<<<<<
 *                             vapor_single_read_score=calcu_vapor_single_read_score_directed_dis_m1b_redefine_diagnal(ref_seq,alt_seq,x,window_size)
 *                             if not 0 in vapor_single_read_score and not math.isnan(vapor_single_read_score[0]) and not math.isnan(vapor_single_read_score[1]):
 */
            }
            __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;

            /* "vapor_vali/Simple_function.pyx":1578
 *                                 vapor_score_list.append(1-float(vapor_single_read_score[1])/float(vapor_single_read_score[0]))
 *                                 if vapor_score_list[-1]==max(vapor_score_list):best_read_rec=x
 *                         make_event_figure_1(vapor_score_list,best_read_rec,window_size,ref_seq,alt_seq,out_figure_name)             # <<<<<<<<<<<<<<
 *         if run_flag==0:
 *             if max(bp_info)-min(bp_info)<default_max_sv_test: #only try to read in all reads with sv <100K; else: try breakpoints ;
 */
            __pyx_t_6 = __Pyx_GetModuleGlobalName(__pyx_n_s_make_event_figure_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1578, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_6);
            __pyx_t_12 = NULL;
            __pyx_t_4 = 0;
            if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_6))) {
              __pyx_t_12 = PyMethod_GET_SELF(__pyx_t_6);
              if (likely(__pyx_t_12)) {
                PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
                __Pyx_INCREF(__pyx_t_12);
                __Pyx_INCREF(function);
                __Pyx_DECREF_SET(__pyx_t_6, function);
                __pyx_t_4 = 1;
              }
            }
            __pyx_t_2 = PyTuple_New(6+__pyx_t_4); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1578, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_2);
            if (__pyx_t_12) {
              __Pyx_GIVEREF(__pyx_t_12); PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_12); __pyx_t_12 = NULL;
            }
            __Pyx_INCREF(__pyx_v_vapor_score_list);
            __Pyx_GIVEREF(__pyx_v_vapor_score_list);
            PyTuple_SET_ITEM(__pyx_t_2, 0+__pyx_t_4, __pyx_v_vapor_score_list);
            __Pyx_INCREF(__pyx_v_best_read_rec);
            __Pyx_GIVEREF(__pyx_v_best_read_rec);
            PyTuple_SET_ITEM(__pyx_t_2, 1+__pyx_t_4, __pyx_v_best_read_rec);
            __Pyx_INCREF(__pyx_v_window_size);
            __Pyx_GIVEREF(__pyx_v_window_size);
            PyTuple_SET_ITEM(__pyx_t_2, 2+__pyx_t_4, __pyx_v_window_size);
            __Pyx_INCREF(__pyx_v_ref_seq);
            __Pyx_GIVEREF(__pyx_v_ref_seq);
            PyTuple_SET_ITEM(__pyx_t_2, 3+__pyx_t_4, __pyx_v_ref_seq);
            __Pyx_INCREF(__pyx_v_alt_seq);
            __Pyx_GIVEREF(__pyx_v_alt_seq);
            PyTuple_SET_ITEM(__pyx_t_2, 4+__pyx_t_4, __pyx_v_alt_seq);
            __Pyx_INCREF(__pyx_v_out_figure_name);
            __Pyx_GIVEREF(__pyx_v_out_figure_name);
            PyTuple_SET_ITEM(__pyx_t_2, 5+__pyx_t_4, __pyx_v_out_figure_name);
            __pyx_t_10 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_2, NULL); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1578, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_10);
            __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
            __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
            __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;

            /* "vapor_vali/Simple_function.pyx":1571
 *                     alt_seq+=ref_seq_readin(ref,sv_info[0],max(bp_info),max(bp_info)+flank_length)
 *                     [window_size,window_size_qc]=window_size_refine(alt_seq)
 *                     if not window_size=='Error':             # <<<<<<<<<<<<<<
 *                         best_read_rec=''
 *                         for x in all_reads:
 */
          }

          /* "vapor_vali/Simple_function.pyx":1560
 *                 #dup_block_bps=dup_inv_dup_bps_produce(sv_info,flank_length,alt_structure)
 *                 all_reads=simple_chop_pacbio_read_simple_short(bam_in,[sv_info[0]]+bp_info+[bp_info[-1]+sv_info[2]-sv_info[1]],flank_length)
 *                 if len(all_reads)>0:             # <<<<<<<<<<<<<<
 *                     alt_seq=ref_seq_readin(ref,sv_info[0],min(bp_info)-flank_length,min(bp_info))
 *                     a_seq=ref_seq_readin(ref,sv_info[0],bp_info[0],bp_info[1])
 */
        }

        /* "vapor_vali/Simple_function.pyx":1551
 *             ref_seq=ref_seq_readin(ref,sv_info[0],min(bp_info)-flank_length,max(bp_info)+flank_length)
 *             [window_size,window_size_qc]=window_size_refine(ref_seq)
 *             if not window_size=='Error':             # <<<<<<<<<<<<<<
 *                 run_flag+=1
 *                 ref_structure=[i for i in 'ab']
 */
      }

      /* "vapor_vali/Simple_function.pyx":1548
 *         bp_info=sorted(sv_info[1:3]+[sv_info[4]])
 *         run_flag=0
 *         if sv_info[0]==sv_info[3] and max(bp_info)-min(bp_info)<default_max_sv_test: #try to test on the whole region             # <<<<<<<<<<<<<<
 *             ref_seq=ref_seq_readin(ref,sv_info[0],min(bp_info)-flank_length,max(bp_info)+flank_length)
 *             [window_size,window_size_qc]=window_size_refine(ref_seq)
 */
    }

    /* "vapor_vali/Simple_function.pyx":1579
 *                                 if vapor_score_list[-1]==max(vapor_score_list):best_read_rec=x
 *                         make_event_figure_1(vapor_score_list,best_read_rec,window_size,ref_seq,alt_seq,out_figure_name)
 *         if run_flag==0:             # <<<<<<<<<<<<<<
 *             if max(bp_info)-min(bp_info)<default_max_sv_test: #only try to read in all reads with sv <100K; else: try breakpoints ;
 *                 ref_seq=ref_seq_readin(ref,ins_point[0],ins_point[1]-flank_length,ins_point[1]+flank_length)
 */
    __pyx_t_10 = __Pyx_PyInt_EqObjC(__pyx_v_run_flag, __pyx_int_0, 0, 0); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1579, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_10);
    __pyx_t_7 = __Pyx_PyObject_IsTrue(__pyx_t_10); if (unlikely(__pyx_t_7 < 0)) __PYX_ERR(0, 1579, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
    if (__pyx_t_7) {

      /* "vapor_vali/Simple_function.pyx":1580
 *                         make_event_figure_1(vapor_score_list,best_read_rec,window_size,ref_seq,alt_seq,out_figure_name)
 *         if run_flag==0:
 *             if max(bp_info)-min(bp_info)<default_max_sv_test: #only try to read in all reads with sv <100K; else: try breakpoints ;             # <<<<<<<<<<<<<<
 *                 ref_seq=ref_seq_readin(ref,ins_point[0],ins_point[1]-flank_length,ins_point[1]+flank_length)
 *                 [window_size,window_size_qc]=window_size_refine(ref_seq)
 */
      __pyx_t_10 = PyTuple_New(1); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1580, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_10);
      __Pyx_INCREF(__pyx_v_bp_info);
      __Pyx_GIVEREF(__pyx_v_bp_info);
      PyTuple_SET_ITEM(__pyx_t_10, 0, __pyx_v_bp_info);
      __pyx_t_6 = __Pyx_PyObject_Call(__pyx_builtin_max, __pyx_t_10, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1580, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_6);
      __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
      __pyx_t_10 = PyTuple_New(1); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1580, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_10);
      __Pyx_INCREF(__pyx_v_bp_info);
      __Pyx_GIVEREF(__pyx_v_bp_info);
      PyTuple_SET_ITEM(__pyx_t_10, 0, __pyx_v_bp_info);
      __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_min, __pyx_t_10, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1580, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
      __pyx_t_10 = PyNumber_Subtract(__pyx_t_6, __pyx_t_2); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1580, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_10);
      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_default_max_sv_test); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1580, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __pyx_t_6 = PyObject_RichCompare(__pyx_t_10, __pyx_t_2, Py_LT); __Pyx_XGOTREF(__pyx_t_6); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1580, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_7 = __Pyx_PyObject_IsTrue(__pyx_t_6); if (unlikely(__pyx_t_7 < 0)) __PYX_ERR(0, 1580, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
      if (__pyx_t_7) {

        /* "vapor_vali/Simple_function.pyx":1581
 *         if run_flag==0:
 *             if max(bp_info)-min(bp_info)<default_max_sv_test: #only try to read in all reads with sv <100K; else: try breakpoints ;
 *                 ref_seq=ref_seq_readin(ref,ins_point[0],ins_point[1]-flank_length,ins_point[1]+flank_length)             # <<<<<<<<<<<<<<
 *                 [window_size,window_size_qc]=window_size_refine(ref_seq)
 *                 if not window_size=='Error':
 */
        __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_ref_seq_readin); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1581, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
        __pyx_t_10 = __Pyx_GetItemInt_List(__pyx_v_ins_point, 0, long, 1, __Pyx_PyInt_From_long, 1, 0, 1); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1581, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_10);
        __pyx_t_12 = __Pyx_GetItemInt_List(__pyx_v_ins_point, 1, long, 1, __Pyx_PyInt_From_long, 1, 0, 1); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1581, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_12);
        __pyx_t_11 = PyNumber_Subtract(__pyx_t_12, __pyx_v_flank_length); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1581, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_11);
        __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
        __pyx_t_12 = __Pyx_GetItemInt_List(__pyx_v_ins_point, 1, long, 1, __Pyx_PyInt_From_long, 1, 0, 1); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1581, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_12);
        __pyx_t_1 = PyNumber_Add(__pyx_t_12, __pyx_v_flank_length); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1581, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
        __pyx_t_12 = NULL;
        __pyx_t_4 = 0;
        if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_2))) {
          __pyx_t_12 = PyMethod_GET_SELF(__pyx_t_2);
          if (likely(__pyx_t_12)) {
            PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
            __Pyx_INCREF(__pyx_t_12);
            __Pyx_INCREF(function);
            __Pyx_DECREF_SET(__pyx_t_2, function);
            __pyx_t_4 = 1;
          }
        }
        __pyx_t_3 = PyTuple_New(4+__pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1581, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_3);
        if (__pyx_t_12) {
          __Pyx_GIVEREF(__pyx_t_12); PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_12); __pyx_t_12 = NULL;
        }
        __Pyx_INCREF(__pyx_v_ref);
        __Pyx_GIVEREF(__pyx_v_ref);
        PyTuple_SET_ITEM(__pyx_t_3, 0+__pyx_t_4, __pyx_v_ref);
        __Pyx_GIVEREF(__pyx_t_10);
        PyTuple_SET_ITEM(__pyx_t_3, 1+__pyx_t_4, __pyx_t_10);
        __Pyx_GIVEREF(__pyx_t_11);
        PyTuple_SET_ITEM(__pyx_t_3, 2+__pyx_t_4, __pyx_t_11);
        __Pyx_GIVEREF(__pyx_t_1);
        PyTuple_SET_ITEM(__pyx_t_3, 3+__pyx_t_4, __pyx_t_1);
        __pyx_t_10 = 0;
        __pyx_t_11 = 0;
        __pyx_t_1 = 0;
        __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_3, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1581, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_6);
        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
        __Pyx_XDECREF_SET(__pyx_v_ref_seq, __pyx_t_6);
        __pyx_t_6 = 0;

        /* "vapor_vali/Simple_function.pyx":1582
 *             if max(bp_info)-min(bp_info)<default_max_sv_test: #only try to read in all reads with sv <100K; else: try breakpoints ;
 *                 ref_seq=ref_seq_readin(ref,ins_point[0],ins_point[1]-flank_length,ins_point[1]+flank_length)
 *                 [window_size,window_size_qc]=window_size_refine(ref_seq)             # <<<<<<<<<<<<<<
 *                 if not window_size=='Error':
 *                     all_reads=simple_del_chop_pacbio_read_simple_short(bam_in,ins_point,flank_length)
 */
        __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_window_size_refine); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1582, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
        __pyx_t_3 = NULL;
        if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_2))) {
          __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
          if (likely(__pyx_t_3)) {
            PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
            __Pyx_INCREF(__pyx_t_3);
            __Pyx_INCREF(function);
            __Pyx_DECREF_SET(__pyx_t_2, function);
          }
        }
        if (!__pyx_t_3) {
          __pyx_t_6 = __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_v_ref_seq); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1582, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_6);
        } else {
          __pyx_t_1 = PyTuple_New(1+1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1582, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_1);
          __Pyx_GIVEREF(__pyx_t_3); PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_3); __pyx_t_3 = NULL;
          __Pyx_INCREF(__pyx_v_ref_seq);
          __Pyx_GIVEREF(__pyx_v_ref_seq);
          PyTuple_SET_ITEM(__pyx_t_1, 0+1, __pyx_v_ref_seq);
          __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_1, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1582, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_6);
          __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
        }
        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
        if ((likely(PyTuple_CheckExact(__pyx_t_6))) || (PyList_CheckExact(__pyx_t_6))) {
          PyObject* sequence = __pyx_t_6;
          #if CYTHON_COMPILING_IN_CPYTHON
          Py_ssize_t size = Py_SIZE(sequence);
          #else
          Py_ssize_t size = PySequence_Size(sequence);
          #endif
          if (unlikely(size != 2)) {
            if (size > 2) __Pyx_RaiseTooManyValuesError(2);
            else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
            __PYX_ERR(0, 1582, __pyx_L1_error)
          }
          #if CYTHON_COMPILING_IN_CPYTHON
          if (likely(PyTuple_CheckExact(sequence))) {
            __pyx_t_2 = PyTuple_GET_ITEM(sequence, 0); 
            __pyx_t_1 = PyTuple_GET_ITEM(sequence, 1); 
          } else {
            __pyx_t_2 = PyList_GET_ITEM(sequence, 0); 
            __pyx_t_1 = PyList_GET_ITEM(sequence, 1); 
          }
          __Pyx_INCREF(__pyx_t_2);
          __Pyx_INCREF(__pyx_t_1);
          #else
          __pyx_t_2 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1582, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_2);
          __pyx_t_1 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1582, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_1);
          #endif
          __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
        } else {
          Py_ssize_t index = -1;
          __pyx_t_3 = PyObject_GetIter(__pyx_t_6); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1582, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_3);
          __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
          __pyx_t_13 = Py_TYPE(__pyx_t_3)->tp_iternext;
          index = 0; __pyx_t_2 = __pyx_t_13(__pyx_t_3); if (unlikely(!__pyx_t_2)) goto __pyx_L31_unpacking_failed;
          __Pyx_GOTREF(__pyx_t_2);
          index = 1; __pyx_t_1 = __pyx_t_13(__pyx_t_3); if (unlikely(!__pyx_t_1)) goto __pyx_L31_unpacking_failed;
          __Pyx_GOTREF(__pyx_t_1);
          if (__Pyx_IternextUnpackEndCheck(__pyx_t_13(__pyx_t_3), 2) < 0) __PYX_ERR(0, 1582, __pyx_L1_error)
          __pyx_t_13 = NULL;
          __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
          goto __pyx_L32_unpacking_done;
          __pyx_L31_unpacking_failed:;
          __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
          __pyx_t_13 = NULL;
          if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
          __PYX_ERR(0, 1582, __pyx_L1_error)
          __pyx_L32_unpacking_done:;
        }
        __Pyx_XDECREF_SET(__pyx_v_window_size, __pyx_t_2);
        __pyx_t_2 = 0;
        __Pyx_XDECREF_SET(__pyx_v_window_size_qc, __pyx_t_1);
        __pyx_t_1 = 0;

        /* "vapor_vali/Simple_function.pyx":1583
 *                 ref_seq=ref_seq_readin(ref,ins_point[0],ins_point[1]-flank_length,ins_point[1]+flank_length)
 *                 [window_size,window_size_qc]=window_size_refine(ref_seq)
 *                 if not window_size=='Error':             # <<<<<<<<<<<<<<
 *                     all_reads=simple_del_chop_pacbio_read_simple_short(bam_in,ins_point,flank_length)
 *                     if len(all_reads)>0:
 */
        __pyx_t_7 = (__Pyx_PyString_Equals(__pyx_v_window_size, __pyx_n_s_Error, Py_EQ)); if (unlikely(__pyx_t_7 < 0)) __PYX_ERR(0, 1583, __pyx_L1_error)
        __pyx_t_15 = ((!__pyx_t_7) != 0);
        if (__pyx_t_15) {

          /* "vapor_vali/Simple_function.pyx":1584
 *                 [window_size,window_size_qc]=window_size_refine(ref_seq)
 *                 if not window_size=='Error':
 *                     all_reads=simple_del_chop_pacbio_read_simple_short(bam_in,ins_point,flank_length)             # <<<<<<<<<<<<<<
 *                     if len(all_reads)>0:
 *                         alt_seq=ref_seq[:flank_length]+reverse(complementary(ref_seq_readin(ref,dup_block[0],dup_block[1],dup_block[2])))+ref_seq[-flank_length:]
 */
          __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_simple_del_chop_pacbio_read_simp); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1584, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_1);
          __pyx_t_2 = NULL;
          __pyx_t_4 = 0;
          if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_1))) {
            __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_1);
            if (likely(__pyx_t_2)) {
              PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
              __Pyx_INCREF(__pyx_t_2);
              __Pyx_INCREF(function);
              __Pyx_DECREF_SET(__pyx_t_1, function);
              __pyx_t_4 = 1;
            }
          }
          __pyx_t_3 = PyTuple_New(3+__pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1584, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_3);
          if (__pyx_t_2) {
            __Pyx_GIVEREF(__pyx_t_2); PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_2); __pyx_t_2 = NULL;
          }
          __Pyx_INCREF(__pyx_v_bam_in);
          __Pyx_GIVEREF(__pyx_v_bam_in);
          PyTuple_SET_ITEM(__pyx_t_3, 0+__pyx_t_4, __pyx_v_bam_in);
          __Pyx_INCREF(__pyx_v_ins_point);
          __Pyx_GIVEREF(__pyx_v_ins_point);
          PyTuple_SET_ITEM(__pyx_t_3, 1+__pyx_t_4, __pyx_v_ins_point);
          __Pyx_INCREF(__pyx_v_flank_length);
          __Pyx_GIVEREF(__pyx_v_flank_length);
          PyTuple_SET_ITEM(__pyx_t_3, 2+__pyx_t_4, __pyx_v_flank_length);
          __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_3, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1584, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_6);
          __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
          __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
          __Pyx_XDECREF_SET(__pyx_v_all_reads, __pyx_t_6);
          __pyx_t_6 = 0;

          /* "vapor_vali/Simple_function.pyx":1585
 *                 if not window_size=='Error':
 *                     all_reads=simple_del_chop_pacbio_read_simple_short(bam_in,ins_point,flank_length)
 *                     if len(all_reads)>0:             # <<<<<<<<<<<<<<
 *                         alt_seq=ref_seq[:flank_length]+reverse(complementary(ref_seq_readin(ref,dup_block[0],dup_block[1],dup_block[2])))+ref_seq[-flank_length:]
 *                         [window_size,window_size_qc]=window_size_refine(alt_seq)
 */
          __pyx_t_4 = PyObject_Length(__pyx_v_all_reads); if (unlikely(__pyx_t_4 == -1)) __PYX_ERR(0, 1585, __pyx_L1_error)
          __pyx_t_15 = ((__pyx_t_4 > 0) != 0);
          if (__pyx_t_15) {

            /* "vapor_vali/Simple_function.pyx":1586
 *                     all_reads=simple_del_chop_pacbio_read_simple_short(bam_in,ins_point,flank_length)
 *                     if len(all_reads)>0:
 *                         alt_seq=ref_seq[:flank_length]+reverse(complementary(ref_seq_readin(ref,dup_block[0],dup_block[1],dup_block[2])))+ref_seq[-flank_length:]             # <<<<<<<<<<<<<<
 *                         [window_size,window_size_qc]=window_size_refine(alt_seq)
 *                         if not window_size=='Error':
 */
            __pyx_t_6 = __Pyx_PyObject_GetSlice(__pyx_v_ref_seq, 0, 0, NULL, &__pyx_v_flank_length, NULL, 0, 0, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1586, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_6);
            __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_reverse); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1586, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_3);
            __pyx_t_11 = __Pyx_GetModuleGlobalName(__pyx_n_s_complementary); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1586, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_11);
            __pyx_t_12 = __Pyx_GetModuleGlobalName(__pyx_n_s_ref_seq_readin); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1586, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_12);
            __pyx_t_18 = __Pyx_GetItemInt(__pyx_v_dup_block, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 1586, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_18);
            __pyx_t_19 = __Pyx_GetItemInt(__pyx_v_dup_block, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 1586, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_19);
            __pyx_t_20 = __Pyx_GetItemInt(__pyx_v_dup_block, 2, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 1586, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_20);
            __pyx_t_21 = NULL;
            __pyx_t_4 = 0;
            if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_12))) {
              __pyx_t_21 = PyMethod_GET_SELF(__pyx_t_12);
              if (likely(__pyx_t_21)) {
                PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_12);
                __Pyx_INCREF(__pyx_t_21);
                __Pyx_INCREF(function);
                __Pyx_DECREF_SET(__pyx_t_12, function);
                __pyx_t_4 = 1;
              }
            }
            __pyx_t_22 = PyTuple_New(4+__pyx_t_4); if (unlikely(!__pyx_t_22)) __PYX_ERR(0, 1586, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_22);
            if (__pyx_t_21) {
              __Pyx_GIVEREF(__pyx_t_21); PyTuple_SET_ITEM(__pyx_t_22, 0, __pyx_t_21); __pyx_t_21 = NULL;
            }
            __Pyx_INCREF(__pyx_v_ref);
            __Pyx_GIVEREF(__pyx_v_ref);
            PyTuple_SET_ITEM(__pyx_t_22, 0+__pyx_t_4, __pyx_v_ref);
            __Pyx_GIVEREF(__pyx_t_18);
            PyTuple_SET_ITEM(__pyx_t_22, 1+__pyx_t_4, __pyx_t_18);
            __Pyx_GIVEREF(__pyx_t_19);
            PyTuple_SET_ITEM(__pyx_t_22, 2+__pyx_t_4, __pyx_t_19);
            __Pyx_GIVEREF(__pyx_t_20);
            PyTuple_SET_ITEM(__pyx_t_22, 3+__pyx_t_4, __pyx_t_20);
            __pyx_t_18 = 0;
            __pyx_t_19 = 0;
            __pyx_t_20 = 0;
            __pyx_t_10 = __Pyx_PyObject_Call(__pyx_t_12, __pyx_t_22, NULL); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1586, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_10);
            __Pyx_DECREF(__pyx_t_22); __pyx_t_22 = 0;
            __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
            __pyx_t_12 = NULL;
            if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_11))) {
              __pyx_t_12 = PyMethod_GET_SELF(__pyx_t_11);
              if (likely(__pyx_t_12)) {
                PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_11);
                __Pyx_INCREF(__pyx_t_12);
                __Pyx_INCREF(function);
                __Pyx_DECREF_SET(__pyx_t_11, function);
              }
            }
            if (!__pyx_t_12) {
              __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_t_11, __pyx_t_10); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1586, __pyx_L1_error)
              __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
              __Pyx_GOTREF(__pyx_t_2);
            } else {
              __pyx_t_22 = PyTuple_New(1+1); if (unlikely(!__pyx_t_22)) __PYX_ERR(0, 1586, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_22);
              __Pyx_GIVEREF(__pyx_t_12); PyTuple_SET_ITEM(__pyx_t_22, 0, __pyx_t_12); __pyx_t_12 = NULL;
              __Pyx_GIVEREF(__pyx_t_10);
              PyTuple_SET_ITEM(__pyx_t_22, 0+1, __pyx_t_10);
              __pyx_t_10 = 0;
              __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_11, __pyx_t_22, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1586, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_2);
              __Pyx_DECREF(__pyx_t_22); __pyx_t_22 = 0;
            }
            __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
            __pyx_t_11 = NULL;
            if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_3))) {
              __pyx_t_11 = PyMethod_GET_SELF(__pyx_t_3);
              if (likely(__pyx_t_11)) {
                PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
                __Pyx_INCREF(__pyx_t_11);
                __Pyx_INCREF(function);
                __Pyx_DECREF_SET(__pyx_t_3, function);
              }
            }
            if (!__pyx_t_11) {
              __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1586, __pyx_L1_error)
              __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
              __Pyx_GOTREF(__pyx_t_1);
            } else {
              __pyx_t_22 = PyTuple_New(1+1); if (unlikely(!__pyx_t_22)) __PYX_ERR(0, 1586, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_22);
              __Pyx_GIVEREF(__pyx_t_11); PyTuple_SET_ITEM(__pyx_t_22, 0, __pyx_t_11); __pyx_t_11 = NULL;
              __Pyx_GIVEREF(__pyx_t_2);
              PyTuple_SET_ITEM(__pyx_t_22, 0+1, __pyx_t_2);
              __pyx_t_2 = 0;
              __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_22, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1586, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_1);
              __Pyx_DECREF(__pyx_t_22); __pyx_t_22 = 0;
            }
            __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
            __pyx_t_3 = PyNumber_Add(__pyx_t_6, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1586, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_3);
            __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
            __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
            __pyx_t_1 = PyNumber_Negative(__pyx_v_flank_length); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1586, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_1);
            __pyx_t_6 = __Pyx_PyObject_GetSlice(__pyx_v_ref_seq, 0, 0, &__pyx_t_1, NULL, NULL, 0, 0, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1586, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_6);
            __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
            __pyx_t_1 = PyNumber_Add(__pyx_t_3, __pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1586, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_1);
            __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
            __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
            __Pyx_XDECREF_SET(__pyx_v_alt_seq, __pyx_t_1);
            __pyx_t_1 = 0;

            /* "vapor_vali/Simple_function.pyx":1587
 *                     if len(all_reads)>0:
 *                         alt_seq=ref_seq[:flank_length]+reverse(complementary(ref_seq_readin(ref,dup_block[0],dup_block[1],dup_block[2])))+ref_seq[-flank_length:]
 *                         [window_size,window_size_qc]=window_size_refine(alt_seq)             # <<<<<<<<<<<<<<
 *                         if not window_size=='Error':
 *                             best_read_rec=''
 */
            __pyx_t_6 = __Pyx_GetModuleGlobalName(__pyx_n_s_window_size_refine); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1587, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_6);
            __pyx_t_3 = NULL;
            if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_6))) {
              __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_6);
              if (likely(__pyx_t_3)) {
                PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
                __Pyx_INCREF(__pyx_t_3);
                __Pyx_INCREF(function);
                __Pyx_DECREF_SET(__pyx_t_6, function);
              }
            }
            if (!__pyx_t_3) {
              __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_v_alt_seq); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1587, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_1);
            } else {
              __pyx_t_22 = PyTuple_New(1+1); if (unlikely(!__pyx_t_22)) __PYX_ERR(0, 1587, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_22);
              __Pyx_GIVEREF(__pyx_t_3); PyTuple_SET_ITEM(__pyx_t_22, 0, __pyx_t_3); __pyx_t_3 = NULL;
              __Pyx_INCREF(__pyx_v_alt_seq);
              __Pyx_GIVEREF(__pyx_v_alt_seq);
              PyTuple_SET_ITEM(__pyx_t_22, 0+1, __pyx_v_alt_seq);
              __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_22, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1587, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_1);
              __Pyx_DECREF(__pyx_t_22); __pyx_t_22 = 0;
            }
            __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
            if ((likely(PyTuple_CheckExact(__pyx_t_1))) || (PyList_CheckExact(__pyx_t_1))) {
              PyObject* sequence = __pyx_t_1;
              #if CYTHON_COMPILING_IN_CPYTHON
              Py_ssize_t size = Py_SIZE(sequence);
              #else
              Py_ssize_t size = PySequence_Size(sequence);
              #endif
              if (unlikely(size != 2)) {
                if (size > 2) __Pyx_RaiseTooManyValuesError(2);
                else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
                __PYX_ERR(0, 1587, __pyx_L1_error)
              }
              #if CYTHON_COMPILING_IN_CPYTHON
              if (likely(PyTuple_CheckExact(sequence))) {
                __pyx_t_6 = PyTuple_GET_ITEM(sequence, 0); 
                __pyx_t_22 = PyTuple_GET_ITEM(sequence, 1); 
              } else {
                __pyx_t_6 = PyList_GET_ITEM(sequence, 0); 
                __pyx_t_22 = PyList_GET_ITEM(sequence, 1); 
              }
              __Pyx_INCREF(__pyx_t_6);
              __Pyx_INCREF(__pyx_t_22);
              #else
              __pyx_t_6 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1587, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_6);
              __pyx_t_22 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_22)) __PYX_ERR(0, 1587, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_22);
              #endif
              __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
            } else {
              Py_ssize_t index = -1;
              __pyx_t_3 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1587, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_3);
              __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
              __pyx_t_13 = Py_TYPE(__pyx_t_3)->tp_iternext;
              index = 0; __pyx_t_6 = __pyx_t_13(__pyx_t_3); if (unlikely(!__pyx_t_6)) goto __pyx_L35_unpacking_failed;
              __Pyx_GOTREF(__pyx_t_6);
              index = 1; __pyx_t_22 = __pyx_t_13(__pyx_t_3); if (unlikely(!__pyx_t_22)) goto __pyx_L35_unpacking_failed;
              __Pyx_GOTREF(__pyx_t_22);
              if (__Pyx_IternextUnpackEndCheck(__pyx_t_13(__pyx_t_3), 2) < 0) __PYX_ERR(0, 1587, __pyx_L1_error)
              __pyx_t_13 = NULL;
              __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
              goto __pyx_L36_unpacking_done;
              __pyx_L35_unpacking_failed:;
              __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
              __pyx_t_13 = NULL;
              if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
              __PYX_ERR(0, 1587, __pyx_L1_error)
              __pyx_L36_unpacking_done:;
            }
            __Pyx_DECREF_SET(__pyx_v_window_size, __pyx_t_6);
            __pyx_t_6 = 0;
            __Pyx_DECREF_SET(__pyx_v_window_size_qc, __pyx_t_22);
            __pyx_t_22 = 0;

            /* "vapor_vali/Simple_function.pyx":1588
 *                         alt_seq=ref_seq[:flank_length]+reverse(complementary(ref_seq_readin(ref,dup_block[0],dup_block[1],dup_block[2])))+ref_seq[-flank_length:]
 *                         [window_size,window_size_qc]=window_size_refine(alt_seq)
 *                         if not window_size=='Error':             # <<<<<<<<<<<<<<
 *                             best_read_rec=''
 *                             for x in all_reads:
 */
            __pyx_t_15 = (__Pyx_PyString_Equals(__pyx_v_window_size, __pyx_n_s_Error, Py_EQ)); if (unlikely(__pyx_t_15 < 0)) __PYX_ERR(0, 1588, __pyx_L1_error)
            __pyx_t_7 = ((!__pyx_t_15) != 0);
            if (__pyx_t_7) {

              /* "vapor_vali/Simple_function.pyx":1589
 *                         [window_size,window_size_qc]=window_size_refine(alt_seq)
 *                         if not window_size=='Error':
 *                             best_read_rec=''             # <<<<<<<<<<<<<<
 *                             for x in all_reads:
 *                                 vapor_single_read_score=calcu_vapor_single_read_score_abs_dis_m1b(ref_seq,alt_seq,x,window_size)
 */
              __Pyx_INCREF(__pyx_kp_s__24);
              __Pyx_XDECREF_SET(__pyx_v_best_read_rec, __pyx_kp_s__24);

              /* "vapor_vali/Simple_function.pyx":1590
 *                         if not window_size=='Error':
 *                             best_read_rec=''
 *                             for x in all_reads:             # <<<<<<<<<<<<<<
 *                                 vapor_single_read_score=calcu_vapor_single_read_score_abs_dis_m1b(ref_seq,alt_seq,x,window_size)
 *                                 if not 0 in vapor_single_read_score and not math.isnan(vapor_single_read_score[0]) and not math.isnan(vapor_single_read_score[1]):
 */
              if (likely(PyList_CheckExact(__pyx_v_all_reads)) || PyTuple_CheckExact(__pyx_v_all_reads)) {
                __pyx_t_1 = __pyx_v_all_reads; __Pyx_INCREF(__pyx_t_1); __pyx_t_4 = 0;
                __pyx_t_5 = NULL;
              } else {
                __pyx_t_4 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_v_all_reads); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1590, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_1);
                __pyx_t_5 = Py_TYPE(__pyx_t_1)->tp_iternext; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1590, __pyx_L1_error)
              }
              for (;;) {
                if (likely(!__pyx_t_5)) {
                  if (likely(PyList_CheckExact(__pyx_t_1))) {
                    if (__pyx_t_4 >= PyList_GET_SIZE(__pyx_t_1)) break;
                    #if CYTHON_COMPILING_IN_CPYTHON
                    __pyx_t_22 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_4); __Pyx_INCREF(__pyx_t_22); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 1590, __pyx_L1_error)
                    #else
                    __pyx_t_22 = PySequence_ITEM(__pyx_t_1, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_22)) __PYX_ERR(0, 1590, __pyx_L1_error)
                    __Pyx_GOTREF(__pyx_t_22);
                    #endif
                  } else {
                    if (__pyx_t_4 >= PyTuple_GET_SIZE(__pyx_t_1)) break;
                    #if CYTHON_COMPILING_IN_CPYTHON
                    __pyx_t_22 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_4); __Pyx_INCREF(__pyx_t_22); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 1590, __pyx_L1_error)
                    #else
                    __pyx_t_22 = PySequence_ITEM(__pyx_t_1, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_22)) __PYX_ERR(0, 1590, __pyx_L1_error)
                    __Pyx_GOTREF(__pyx_t_22);
                    #endif
                  }
                } else {
                  __pyx_t_22 = __pyx_t_5(__pyx_t_1);
                  if (unlikely(!__pyx_t_22)) {
                    PyObject* exc_type = PyErr_Occurred();
                    if (exc_type) {
                      if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
                      else __PYX_ERR(0, 1590, __pyx_L1_error)
                    }
                    break;
                  }
                  __Pyx_GOTREF(__pyx_t_22);
                }
                __Pyx_XDECREF_SET(__pyx_v_x, __pyx_t_22);
                __pyx_t_22 = 0;

                /* "vapor_vali/Simple_function.pyx":1591
 *                             best_read_rec=''
 *                             for x in all_reads:
 *                                 vapor_single_read_score=calcu_vapor_single_read_score_abs_dis_m1b(ref_seq,alt_seq,x,window_size)             # <<<<<<<<<<<<<<
 *                                 if not 0 in vapor_single_read_score and not math.isnan(vapor_single_read_score[0]) and not math.isnan(vapor_single_read_score[1]):
 *                                     vapor_score_list.append(1-float(vapor_single_read_score[1])/float(vapor_single_read_score[0]))
 */
                __pyx_t_6 = __Pyx_GetModuleGlobalName(__pyx_n_s_calcu_vapor_single_read_score_ab); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1591, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_6);
                __pyx_t_3 = NULL;
                __pyx_t_14 = 0;
                if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_6))) {
                  __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_6);
                  if (likely(__pyx_t_3)) {
                    PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
                    __Pyx_INCREF(__pyx_t_3);
                    __Pyx_INCREF(function);
                    __Pyx_DECREF_SET(__pyx_t_6, function);
                    __pyx_t_14 = 1;
                  }
                }
                __pyx_t_2 = PyTuple_New(4+__pyx_t_14); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1591, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_2);
                if (__pyx_t_3) {
                  __Pyx_GIVEREF(__pyx_t_3); PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_3); __pyx_t_3 = NULL;
                }
                __Pyx_INCREF(__pyx_v_ref_seq);
                __Pyx_GIVEREF(__pyx_v_ref_seq);
                PyTuple_SET_ITEM(__pyx_t_2, 0+__pyx_t_14, __pyx_v_ref_seq);
                __Pyx_INCREF(__pyx_v_alt_seq);
                __Pyx_GIVEREF(__pyx_v_alt_seq);
                PyTuple_SET_ITEM(__pyx_t_2, 1+__pyx_t_14, __pyx_v_alt_seq);
                __Pyx_INCREF(__pyx_v_x);
                __Pyx_GIVEREF(__pyx_v_x);
                PyTuple_SET_ITEM(__pyx_t_2, 2+__pyx_t_14, __pyx_v_x);
                __Pyx_INCREF(__pyx_v_window_size);
                __Pyx_GIVEREF(__pyx_v_window_size);
                PyTuple_SET_ITEM(__pyx_t_2, 3+__pyx_t_14, __pyx_v_window_size);
                __pyx_t_22 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_2, NULL); if (unlikely(!__pyx_t_22)) __PYX_ERR(0, 1591, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_22);
                __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
                __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
                __Pyx_XDECREF_SET(__pyx_v_vapor_single_read_score, __pyx_t_22);
                __pyx_t_22 = 0;

                /* "vapor_vali/Simple_function.pyx":1592
 *                             for x in all_reads:
 *                                 vapor_single_read_score=calcu_vapor_single_read_score_abs_dis_m1b(ref_seq,alt_seq,x,window_size)
 *                                 if not 0 in vapor_single_read_score and not math.isnan(vapor_single_read_score[0]) and not math.isnan(vapor_single_read_score[1]):             # <<<<<<<<<<<<<<
 *                                     vapor_score_list.append(1-float(vapor_single_read_score[1])/float(vapor_single_read_score[0]))
 *                                     if vapor_score_list[-1]==max(vapor_score_list):best_read_rec=x
 */
                __pyx_t_15 = (__Pyx_PySequence_ContainsTF(__pyx_int_0, __pyx_v_vapor_single_read_score, Py_NE)); if (unlikely(__pyx_t_15 < 0)) __PYX_ERR(0, 1592, __pyx_L1_error)
                __pyx_t_9 = (__pyx_t_15 != 0);
                if (__pyx_t_9) {
                } else {
                  __pyx_t_7 = __pyx_t_9;
                  goto __pyx_L41_bool_binop_done;
                }
                __pyx_t_6 = __Pyx_GetModuleGlobalName(__pyx_n_s_math); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1592, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_6);
                __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_isnan); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1592, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_2);
                __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
                __pyx_t_6 = __Pyx_GetItemInt(__pyx_v_vapor_single_read_score, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1592, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_6);
                __pyx_t_3 = NULL;
                if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_2))) {
                  __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
                  if (likely(__pyx_t_3)) {
                    PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
                    __Pyx_INCREF(__pyx_t_3);
                    __Pyx_INCREF(function);
                    __Pyx_DECREF_SET(__pyx_t_2, function);
                  }
                }
                if (!__pyx_t_3) {
                  __pyx_t_22 = __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_6); if (unlikely(!__pyx_t_22)) __PYX_ERR(0, 1592, __pyx_L1_error)
                  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
                  __Pyx_GOTREF(__pyx_t_22);
                } else {
                  __pyx_t_11 = PyTuple_New(1+1); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1592, __pyx_L1_error)
                  __Pyx_GOTREF(__pyx_t_11);
                  __Pyx_GIVEREF(__pyx_t_3); PyTuple_SET_ITEM(__pyx_t_11, 0, __pyx_t_3); __pyx_t_3 = NULL;
                  __Pyx_GIVEREF(__pyx_t_6);
                  PyTuple_SET_ITEM(__pyx_t_11, 0+1, __pyx_t_6);
                  __pyx_t_6 = 0;
                  __pyx_t_22 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_11, NULL); if (unlikely(!__pyx_t_22)) __PYX_ERR(0, 1592, __pyx_L1_error)
                  __Pyx_GOTREF(__pyx_t_22);
                  __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
                }
                __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
                __pyx_t_9 = __Pyx_PyObject_IsTrue(__pyx_t_22); if (unlikely(__pyx_t_9 < 0)) __PYX_ERR(0, 1592, __pyx_L1_error)
                __Pyx_DECREF(__pyx_t_22); __pyx_t_22 = 0;
                __pyx_t_15 = ((!__pyx_t_9) != 0);
                if (__pyx_t_15) {
                } else {
                  __pyx_t_7 = __pyx_t_15;
                  goto __pyx_L41_bool_binop_done;
                }
                __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_math); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1592, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_2);
                __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_isnan); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1592, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_11);
                __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
                __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_vapor_single_read_score, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1592, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_2);
                __pyx_t_6 = NULL;
                if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_11))) {
                  __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_11);
                  if (likely(__pyx_t_6)) {
                    PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_11);
                    __Pyx_INCREF(__pyx_t_6);
                    __Pyx_INCREF(function);
                    __Pyx_DECREF_SET(__pyx_t_11, function);
                  }
                }
                if (!__pyx_t_6) {
                  __pyx_t_22 = __Pyx_PyObject_CallOneArg(__pyx_t_11, __pyx_t_2); if (unlikely(!__pyx_t_22)) __PYX_ERR(0, 1592, __pyx_L1_error)
                  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
                  __Pyx_GOTREF(__pyx_t_22);
                } else {
                  __pyx_t_3 = PyTuple_New(1+1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1592, __pyx_L1_error)
                  __Pyx_GOTREF(__pyx_t_3);
                  __Pyx_GIVEREF(__pyx_t_6); PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_6); __pyx_t_6 = NULL;
                  __Pyx_GIVEREF(__pyx_t_2);
                  PyTuple_SET_ITEM(__pyx_t_3, 0+1, __pyx_t_2);
                  __pyx_t_2 = 0;
                  __pyx_t_22 = __Pyx_PyObject_Call(__pyx_t_11, __pyx_t_3, NULL); if (unlikely(!__pyx_t_22)) __PYX_ERR(0, 1592, __pyx_L1_error)
                  __Pyx_GOTREF(__pyx_t_22);
                  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
                }
                __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
                __pyx_t_15 = __Pyx_PyObject_IsTrue(__pyx_t_22); if (unlikely(__pyx_t_15 < 0)) __PYX_ERR(0, 1592, __pyx_L1_error)
                __Pyx_DECREF(__pyx_t_22); __pyx_t_22 = 0;
                __pyx_t_9 = ((!__pyx_t_15) != 0);
                __pyx_t_7 = __pyx_t_9;
                __pyx_L41_bool_binop_done:;
                if (__pyx_t_7) {

                  /* "vapor_vali/Simple_function.pyx":1593
 *                                 vapor_single_read_score=calcu_vapor_single_read_score_abs_dis_m1b(ref_seq,alt_seq,x,window_size)
 *                                 if not 0 in vapor_single_read_score and not math.isnan(vapor_single_read_score[0]) and not math.isnan(vapor_single_read_score[1]):
 *                                     vapor_score_list.append(1-float(vapor_single_read_score[1])/float(vapor_single_read_score[0]))             # <<<<<<<<<<<<<<
 *                                     if vapor_score_list[-1]==max(vapor_score_list):best_read_rec=x
 *                             make_event_figure_1(vapor_score_list,best_read_rec,window_size,ref_seq,alt_seq,out_figure_name)
 */
                  __pyx_t_22 = __Pyx_GetItemInt(__pyx_v_vapor_single_read_score, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_22)) __PYX_ERR(0, 1593, __pyx_L1_error)
                  __Pyx_GOTREF(__pyx_t_22);
                  __pyx_t_17 = __Pyx_PyObject_AsDouble(__pyx_t_22); if (unlikely(__pyx_t_17 == ((double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1593, __pyx_L1_error)
                  __Pyx_DECREF(__pyx_t_22); __pyx_t_22 = 0;
                  __pyx_t_22 = __Pyx_GetItemInt(__pyx_v_vapor_single_read_score, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_22)) __PYX_ERR(0, 1593, __pyx_L1_error)
                  __Pyx_GOTREF(__pyx_t_22);
                  __pyx_t_16 = __Pyx_PyObject_AsDouble(__pyx_t_22); if (unlikely(__pyx_t_16 == ((double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1593, __pyx_L1_error)
                  __Pyx_DECREF(__pyx_t_22); __pyx_t_22 = 0;
                  if (unlikely(__pyx_t_16 == 0)) {
                    PyErr_SetString(PyExc_ZeroDivisionError, "float division");
                    __PYX_ERR(0, 1593, __pyx_L1_error)
                  }
                  __pyx_t_22 = PyFloat_FromDouble((1.0 - (__pyx_t_17 / __pyx_t_16))); if (unlikely(!__pyx_t_22)) __PYX_ERR(0, 1593, __pyx_L1_error)
                  __Pyx_GOTREF(__pyx_t_22);
                  __pyx_t_8 = __Pyx_PyList_Append(__pyx_v_vapor_score_list, __pyx_t_22); if (unlikely(__pyx_t_8 == -1)) __PYX_ERR(0, 1593, __pyx_L1_error)
                  __Pyx_DECREF(__pyx_t_22); __pyx_t_22 = 0;

                  /* "vapor_vali/Simple_function.pyx":1594
 *                                 if not 0 in vapor_single_read_score and not math.isnan(vapor_single_read_score[0]) and not math.isnan(vapor_single_read_score[1]):
 *                                     vapor_score_list.append(1-float(vapor_single_read_score[1])/float(vapor_single_read_score[0]))
 *                                     if vapor_score_list[-1]==max(vapor_score_list):best_read_rec=x             # <<<<<<<<<<<<<<
 *                             make_event_figure_1(vapor_score_list,best_read_rec,window_size,ref_seq,alt_seq,out_figure_name)
 *             else:
 */
                  __pyx_t_22 = __Pyx_GetItemInt_List(__pyx_v_vapor_score_list, -1L, long, 1, __Pyx_PyInt_From_long, 1, 1, 1); if (unlikely(!__pyx_t_22)) __PYX_ERR(0, 1594, __pyx_L1_error)
                  __Pyx_GOTREF(__pyx_t_22);
                  __pyx_t_11 = PyTuple_New(1); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1594, __pyx_L1_error)
                  __Pyx_GOTREF(__pyx_t_11);
                  __Pyx_INCREF(__pyx_v_vapor_score_list);
                  __Pyx_GIVEREF(__pyx_v_vapor_score_list);
                  PyTuple_SET_ITEM(__pyx_t_11, 0, __pyx_v_vapor_score_list);
                  __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_max, __pyx_t_11, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1594, __pyx_L1_error)
                  __Pyx_GOTREF(__pyx_t_3);
                  __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
                  __pyx_t_11 = PyObject_RichCompare(__pyx_t_22, __pyx_t_3, Py_EQ); __Pyx_XGOTREF(__pyx_t_11); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1594, __pyx_L1_error)
                  __Pyx_DECREF(__pyx_t_22); __pyx_t_22 = 0;
                  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
                  __pyx_t_7 = __Pyx_PyObject_IsTrue(__pyx_t_11); if (unlikely(__pyx_t_7 < 0)) __PYX_ERR(0, 1594, __pyx_L1_error)
                  __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
                  if (__pyx_t_7) {
                    __Pyx_INCREF(__pyx_v_x);
                    __Pyx_DECREF_SET(__pyx_v_best_read_rec, __pyx_v_x);
                  }

                  /* "vapor_vali/Simple_function.pyx":1592
 *                             for x in all_reads:
 *                                 vapor_single_read_score=calcu_vapor_single_read_score_abs_dis_m1b(ref_seq,alt_seq,x,window_size)
 *                                 if not 0 in vapor_single_read_score and not math.isnan(vapor_single_read_score[0]) and not math.isnan(vapor_single_read_score[1]):             # <<<<<<<<<<<<<<
 *                                     vapor_score_list.append(1-float(vapor_single_read_score[1])/float(vapor_single_read_score[0]))
 *                                     if vapor_score_list[-1]==max(vapor_score_list):best_read_rec=x
 */
                }

                /* "vapor_vali/Simple_function.pyx":1590
 *                         if not window_size=='Error':
 *                             best_read_rec=''
 *                             for x in all_reads:             # <<<<<<<<<<<<<<
 *                                 vapor_single_read_score=calcu_vapor_single_read_score_abs_dis_m1b(ref_seq,alt_seq,x,window_size)
 *                                 if not 0 in vapor_single_read_score and not math.isnan(vapor_single_read_score[0]) and not math.isnan(vapor_single_read_score[1]):
 */
              }
              __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

              /* "vapor_vali/Simple_function.pyx":1595
 *                                     vapor_score_list.append(1-float(vapor_single_read_score[1])/float(vapor_single_read_score[0]))
 *                                     if vapor_score_list[-1]==max(vapor_score_list):best_read_rec=x
 *                             make_event_figure_1(vapor_score_list,best_read_rec,window_size,ref_seq,alt_seq,out_figure_name)             # <<<<<<<<<<<<<<
 *             else:
 *                 ref_seq=ref_seq_readin(ref,ins_point[0],ins_point[1]-flank_length,ins_point[1]+flank_length)
 */
              __pyx_t_11 = __Pyx_GetModuleGlobalName(__pyx_n_s_make_event_figure_1); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1595, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_11);
              __pyx_t_3 = NULL;
              __pyx_t_4 = 0;
              if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_11))) {
                __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_11);
                if (likely(__pyx_t_3)) {
                  PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_11);
                  __Pyx_INCREF(__pyx_t_3);
                  __Pyx_INCREF(function);
                  __Pyx_DECREF_SET(__pyx_t_11, function);
                  __pyx_t_4 = 1;
                }
              }
              __pyx_t_22 = PyTuple_New(6+__pyx_t_4); if (unlikely(!__pyx_t_22)) __PYX_ERR(0, 1595, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_22);
              if (__pyx_t_3) {
                __Pyx_GIVEREF(__pyx_t_3); PyTuple_SET_ITEM(__pyx_t_22, 0, __pyx_t_3); __pyx_t_3 = NULL;
              }
              __Pyx_INCREF(__pyx_v_vapor_score_list);
              __Pyx_GIVEREF(__pyx_v_vapor_score_list);
              PyTuple_SET_ITEM(__pyx_t_22, 0+__pyx_t_4, __pyx_v_vapor_score_list);
              __Pyx_INCREF(__pyx_v_best_read_rec);
              __Pyx_GIVEREF(__pyx_v_best_read_rec);
              PyTuple_SET_ITEM(__pyx_t_22, 1+__pyx_t_4, __pyx_v_best_read_rec);
              __Pyx_INCREF(__pyx_v_window_size);
              __Pyx_GIVEREF(__pyx_v_window_size);
              PyTuple_SET_ITEM(__pyx_t_22, 2+__pyx_t_4, __pyx_v_window_size);
              __Pyx_INCREF(__pyx_v_ref_seq);
              __Pyx_GIVEREF(__pyx_v_ref_seq);
              PyTuple_SET_ITEM(__pyx_t_22, 3+__pyx_t_4, __pyx_v_ref_seq);
              __Pyx_INCREF(__pyx_v_alt_seq);
              __Pyx_GIVEREF(__pyx_v_alt_seq);
              PyTuple_SET_ITEM(__pyx_t_22, 4+__pyx_t_4, __pyx_v_alt_seq);
              __Pyx_INCREF(__pyx_v_out_figure_name);
              __Pyx_GIVEREF(__pyx_v_out_figure_name);
              PyTuple_SET_ITEM(__pyx_t_22, 5+__pyx_t_4, __pyx_v_out_figure_name);
              __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_11, __pyx_t_22, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1595, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_1);
              __Pyx_DECREF(__pyx_t_22); __pyx_t_22 = 0;
              __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
              __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

              /* "vapor_vali/Simple_function.pyx":1588
 *                         alt_seq=ref_seq[:flank_length]+reverse(complementary(ref_seq_readin(ref,dup_block[0],dup_block[1],dup_block[2])))+ref_seq[-flank_length:]
 *                         [window_size,window_size_qc]=window_size_refine(alt_seq)
 *                         if not window_size=='Error':             # <<<<<<<<<<<<<<
 *                             best_read_rec=''
 *                             for x in all_reads:
 */
            }

            /* "vapor_vali/Simple_function.pyx":1585
 *                 if not window_size=='Error':
 *                     all_reads=simple_del_chop_pacbio_read_simple_short(bam_in,ins_point,flank_length)
 *                     if len(all_reads)>0:             # <<<<<<<<<<<<<<
 *                         alt_seq=ref_seq[:flank_length]+reverse(complementary(ref_seq_readin(ref,dup_block[0],dup_block[1],dup_block[2])))+ref_seq[-flank_length:]
 *                         [window_size,window_size_qc]=window_size_refine(alt_seq)
 */
          }

          /* "vapor_vali/Simple_function.pyx":1583
 *                 ref_seq=ref_seq_readin(ref,ins_point[0],ins_point[1]-flank_length,ins_point[1]+flank_length)
 *                 [window_size,window_size_qc]=window_size_refine(ref_seq)
 *                 if not window_size=='Error':             # <<<<<<<<<<<<<<
 *                     all_reads=simple_del_chop_pacbio_read_simple_short(bam_in,ins_point,flank_length)
 *                     if len(all_reads)>0:
 */
        }

        /* "vapor_vali/Simple_function.pyx":1580
 *                         make_event_figure_1(vapor_score_list,best_read_rec,window_size,ref_seq,alt_seq,out_figure_name)
 *         if run_flag==0:
 *             if max(bp_info)-min(bp_info)<default_max_sv_test: #only try to read in all reads with sv <100K; else: try breakpoints ;             # <<<<<<<<<<<<<<
 *                 ref_seq=ref_seq_readin(ref,ins_point[0],ins_point[1]-flank_length,ins_point[1]+flank_length)
 *                 [window_size,window_size_qc]=window_size_refine(ref_seq)
 */
        goto __pyx_L30;
      }

      /* "vapor_vali/Simple_function.pyx":1597
 *                             make_event_figure_1(vapor_score_list,best_read_rec,window_size,ref_seq,alt_seq,out_figure_name)
 *             else:
 *                 ref_seq=ref_seq_readin(ref,ins_point[0],ins_point[1]-flank_length,ins_point[1]+flank_length)             # <<<<<<<<<<<<<<
 *                 [window_size,window_size_qc]=window_size_refine(ref_seq)
 *                 if not window_size=='Error':
 */
      /*else*/ {
        __pyx_t_11 = __Pyx_GetModuleGlobalName(__pyx_n_s_ref_seq_readin); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1597, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_11);
        __pyx_t_22 = __Pyx_GetItemInt_List(__pyx_v_ins_point, 0, long, 1, __Pyx_PyInt_From_long, 1, 0, 1); if (unlikely(!__pyx_t_22)) __PYX_ERR(0, 1597, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_22);
        __pyx_t_3 = __Pyx_GetItemInt_List(__pyx_v_ins_point, 1, long, 1, __Pyx_PyInt_From_long, 1, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1597, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_3);
        __pyx_t_2 = PyNumber_Subtract(__pyx_t_3, __pyx_v_flank_length); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1597, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
        __pyx_t_3 = __Pyx_GetItemInt_List(__pyx_v_ins_point, 1, long, 1, __Pyx_PyInt_From_long, 1, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1597, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_3);
        __pyx_t_6 = PyNumber_Add(__pyx_t_3, __pyx_v_flank_length); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1597, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_6);
        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
        __pyx_t_3 = NULL;
        __pyx_t_4 = 0;
        if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_11))) {
          __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_11);
          if (likely(__pyx_t_3)) {
            PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_11);
            __Pyx_INCREF(__pyx_t_3);
            __Pyx_INCREF(function);
            __Pyx_DECREF_SET(__pyx_t_11, function);
            __pyx_t_4 = 1;
          }
        }
        __pyx_t_10 = PyTuple_New(4+__pyx_t_4); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1597, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_10);
        if (__pyx_t_3) {
          __Pyx_GIVEREF(__pyx_t_3); PyTuple_SET_ITEM(__pyx_t_10, 0, __pyx_t_3); __pyx_t_3 = NULL;
        }
        __Pyx_INCREF(__pyx_v_ref);
        __Pyx_GIVEREF(__pyx_v_ref);
        PyTuple_SET_ITEM(__pyx_t_10, 0+__pyx_t_4, __pyx_v_ref);
        __Pyx_GIVEREF(__pyx_t_22);
        PyTuple_SET_ITEM(__pyx_t_10, 1+__pyx_t_4, __pyx_t_22);
        __Pyx_GIVEREF(__pyx_t_2);
        PyTuple_SET_ITEM(__pyx_t_10, 2+__pyx_t_4, __pyx_t_2);
        __Pyx_GIVEREF(__pyx_t_6);
        PyTuple_SET_ITEM(__pyx_t_10, 3+__pyx_t_4, __pyx_t_6);
        __pyx_t_22 = 0;
        __pyx_t_2 = 0;
        __pyx_t_6 = 0;
        __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_11, __pyx_t_10, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1597, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
        __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
        __Pyx_XDECREF_SET(__pyx_v_ref_seq, __pyx_t_1);
        __pyx_t_1 = 0;

        /* "vapor_vali/Simple_function.pyx":1598
 *             else:
 *                 ref_seq=ref_seq_readin(ref,ins_point[0],ins_point[1]-flank_length,ins_point[1]+flank_length)
 *                 [window_size,window_size_qc]=window_size_refine(ref_seq)             # <<<<<<<<<<<<<<
 *                 if not window_size=='Error':
 *                     all_reads=simple_del_chop_pacbio_read_simple_short(bam_in,ins_point,flank_length)
 */
        __pyx_t_11 = __Pyx_GetModuleGlobalName(__pyx_n_s_window_size_refine); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1598, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_11);
        __pyx_t_10 = NULL;
        if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_11))) {
          __pyx_t_10 = PyMethod_GET_SELF(__pyx_t_11);
          if (likely(__pyx_t_10)) {
            PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_11);
            __Pyx_INCREF(__pyx_t_10);
            __Pyx_INCREF(function);
            __Pyx_DECREF_SET(__pyx_t_11, function);
          }
        }
        if (!__pyx_t_10) {
          __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_11, __pyx_v_ref_seq); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1598, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_1);
        } else {
          __pyx_t_6 = PyTuple_New(1+1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1598, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_6);
          __Pyx_GIVEREF(__pyx_t_10); PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_10); __pyx_t_10 = NULL;
          __Pyx_INCREF(__pyx_v_ref_seq);
          __Pyx_GIVEREF(__pyx_v_ref_seq);
          PyTuple_SET_ITEM(__pyx_t_6, 0+1, __pyx_v_ref_seq);
          __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_11, __pyx_t_6, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1598, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_1);
          __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
        }
        __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
        if ((likely(PyTuple_CheckExact(__pyx_t_1))) || (PyList_CheckExact(__pyx_t_1))) {
          PyObject* sequence = __pyx_t_1;
          #if CYTHON_COMPILING_IN_CPYTHON
          Py_ssize_t size = Py_SIZE(sequence);
          #else
          Py_ssize_t size = PySequence_Size(sequence);
          #endif
          if (unlikely(size != 2)) {
            if (size > 2) __Pyx_RaiseTooManyValuesError(2);
            else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
            __PYX_ERR(0, 1598, __pyx_L1_error)
          }
          #if CYTHON_COMPILING_IN_CPYTHON
          if (likely(PyTuple_CheckExact(sequence))) {
            __pyx_t_11 = PyTuple_GET_ITEM(sequence, 0); 
            __pyx_t_6 = PyTuple_GET_ITEM(sequence, 1); 
          } else {
            __pyx_t_11 = PyList_GET_ITEM(sequence, 0); 
            __pyx_t_6 = PyList_GET_ITEM(sequence, 1); 
          }
          __Pyx_INCREF(__pyx_t_11);
          __Pyx_INCREF(__pyx_t_6);
          #else
          __pyx_t_11 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1598, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_11);
          __pyx_t_6 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1598, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_6);
          #endif
          __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
        } else {
          Py_ssize_t index = -1;
          __pyx_t_10 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1598, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_10);
          __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
          __pyx_t_13 = Py_TYPE(__pyx_t_10)->tp_iternext;
          index = 0; __pyx_t_11 = __pyx_t_13(__pyx_t_10); if (unlikely(!__pyx_t_11)) goto __pyx_L45_unpacking_failed;
          __Pyx_GOTREF(__pyx_t_11);
          index = 1; __pyx_t_6 = __pyx_t_13(__pyx_t_10); if (unlikely(!__pyx_t_6)) goto __pyx_L45_unpacking_failed;
          __Pyx_GOTREF(__pyx_t_6);
          if (__Pyx_IternextUnpackEndCheck(__pyx_t_13(__pyx_t_10), 2) < 0) __PYX_ERR(0, 1598, __pyx_L1_error)
          __pyx_t_13 = NULL;
          __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
          goto __pyx_L46_unpacking_done;
          __pyx_L45_unpacking_failed:;
          __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
          __pyx_t_13 = NULL;
          if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
          __PYX_ERR(0, 1598, __pyx_L1_error)
          __pyx_L46_unpacking_done:;
        }
        __Pyx_XDECREF_SET(__pyx_v_window_size, __pyx_t_11);
        __pyx_t_11 = 0;
        __Pyx_XDECREF_SET(__pyx_v_window_size_qc, __pyx_t_6);
        __pyx_t_6 = 0;

        /* "vapor_vali/Simple_function.pyx":1599
 *                 ref_seq=ref_seq_readin(ref,ins_point[0],ins_point[1]-flank_length,ins_point[1]+flank_length)
 *                 [window_size,window_size_qc]=window_size_refine(ref_seq)
 *                 if not window_size=='Error':             # <<<<<<<<<<<<<<
 *                     all_reads=simple_del_chop_pacbio_read_simple_short(bam_in,ins_point,flank_length)
 *                     if len(all_reads)>0:
 */
        __pyx_t_7 = (__Pyx_PyString_Equals(__pyx_v_window_size, __pyx_n_s_Error, Py_EQ)); if (unlikely(__pyx_t_7 < 0)) __PYX_ERR(0, 1599, __pyx_L1_error)
        __pyx_t_9 = ((!__pyx_t_7) != 0);
        if (__pyx_t_9) {

          /* "vapor_vali/Simple_function.pyx":1600
 *                 [window_size,window_size_qc]=window_size_refine(ref_seq)
 *                 if not window_size=='Error':
 *                     all_reads=simple_del_chop_pacbio_read_simple_short(bam_in,ins_point,flank_length)             # <<<<<<<<<<<<<<
 *                     if len(all_reads)>0:
 *                         alt_seq=ref_seq[:flank_length]+reverse(complementary(ref_seq_readin(ref,dup_block[0],dup_block[2]-flank_length,dup_block[2])))
 */
          __pyx_t_6 = __Pyx_GetModuleGlobalName(__pyx_n_s_simple_del_chop_pacbio_read_simp); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1600, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_6);
          __pyx_t_11 = NULL;
          __pyx_t_4 = 0;
          if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_6))) {
            __pyx_t_11 = PyMethod_GET_SELF(__pyx_t_6);
            if (likely(__pyx_t_11)) {
              PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
              __Pyx_INCREF(__pyx_t_11);
              __Pyx_INCREF(function);
              __Pyx_DECREF_SET(__pyx_t_6, function);
              __pyx_t_4 = 1;
            }
          }
          __pyx_t_10 = PyTuple_New(3+__pyx_t_4); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1600, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_10);
          if (__pyx_t_11) {
            __Pyx_GIVEREF(__pyx_t_11); PyTuple_SET_ITEM(__pyx_t_10, 0, __pyx_t_11); __pyx_t_11 = NULL;
          }
          __Pyx_INCREF(__pyx_v_bam_in);
          __Pyx_GIVEREF(__pyx_v_bam_in);
          PyTuple_SET_ITEM(__pyx_t_10, 0+__pyx_t_4, __pyx_v_bam_in);
          __Pyx_INCREF(__pyx_v_ins_point);
          __Pyx_GIVEREF(__pyx_v_ins_point);
          PyTuple_SET_ITEM(__pyx_t_10, 1+__pyx_t_4, __pyx_v_ins_point);
          __Pyx_INCREF(__pyx_v_flank_length);
          __Pyx_GIVEREF(__pyx_v_flank_length);
          PyTuple_SET_ITEM(__pyx_t_10, 2+__pyx_t_4, __pyx_v_flank_length);
          __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_10, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1600, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_1);
          __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
          __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
          __Pyx_XDECREF_SET(__pyx_v_all_reads, __pyx_t_1);
          __pyx_t_1 = 0;

          /* "vapor_vali/Simple_function.pyx":1601
 *                 if not window_size=='Error':
 *                     all_reads=simple_del_chop_pacbio_read_simple_short(bam_in,ins_point,flank_length)
 *                     if len(all_reads)>0:             # <<<<<<<<<<<<<<
 *                         alt_seq=ref_seq[:flank_length]+reverse(complementary(ref_seq_readin(ref,dup_block[0],dup_block[2]-flank_length,dup_block[2])))
 *                         [window_size,window_size_qc]=window_size_refine(alt_seq)
 */
          __pyx_t_4 = PyObject_Length(__pyx_v_all_reads); if (unlikely(__pyx_t_4 == -1)) __PYX_ERR(0, 1601, __pyx_L1_error)
          __pyx_t_9 = ((__pyx_t_4 > 0) != 0);
          if (__pyx_t_9) {

            /* "vapor_vali/Simple_function.pyx":1602
 *                     all_reads=simple_del_chop_pacbio_read_simple_short(bam_in,ins_point,flank_length)
 *                     if len(all_reads)>0:
 *                         alt_seq=ref_seq[:flank_length]+reverse(complementary(ref_seq_readin(ref,dup_block[0],dup_block[2]-flank_length,dup_block[2])))             # <<<<<<<<<<<<<<
 *                         [window_size,window_size_qc]=window_size_refine(alt_seq)
 *                         if not window_size=='Error':
 */
            __pyx_t_1 = __Pyx_PyObject_GetSlice(__pyx_v_ref_seq, 0, 0, NULL, &__pyx_v_flank_length, NULL, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1602, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_1);
            __pyx_t_10 = __Pyx_GetModuleGlobalName(__pyx_n_s_reverse); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1602, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_10);
            __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_complementary); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1602, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_2);
            __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_ref_seq_readin); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1602, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_3);
            __pyx_t_12 = __Pyx_GetItemInt(__pyx_v_dup_block, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1602, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_12);
            __pyx_t_20 = __Pyx_GetItemInt(__pyx_v_dup_block, 2, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 1602, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_20);
            __pyx_t_19 = PyNumber_Subtract(__pyx_t_20, __pyx_v_flank_length); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 1602, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_19);
            __Pyx_DECREF(__pyx_t_20); __pyx_t_20 = 0;
            __pyx_t_20 = __Pyx_GetItemInt(__pyx_v_dup_block, 2, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 1602, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_20);
            __pyx_t_18 = NULL;
            __pyx_t_4 = 0;
            if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_3))) {
              __pyx_t_18 = PyMethod_GET_SELF(__pyx_t_3);
              if (likely(__pyx_t_18)) {
                PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
                __Pyx_INCREF(__pyx_t_18);
                __Pyx_INCREF(function);
                __Pyx_DECREF_SET(__pyx_t_3, function);
                __pyx_t_4 = 1;
              }
            }
            __pyx_t_21 = PyTuple_New(4+__pyx_t_4); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 1602, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_21);
            if (__pyx_t_18) {
              __Pyx_GIVEREF(__pyx_t_18); PyTuple_SET_ITEM(__pyx_t_21, 0, __pyx_t_18); __pyx_t_18 = NULL;
            }
            __Pyx_INCREF(__pyx_v_ref);
            __Pyx_GIVEREF(__pyx_v_ref);
            PyTuple_SET_ITEM(__pyx_t_21, 0+__pyx_t_4, __pyx_v_ref);
            __Pyx_GIVEREF(__pyx_t_12);
            PyTuple_SET_ITEM(__pyx_t_21, 1+__pyx_t_4, __pyx_t_12);
            __Pyx_GIVEREF(__pyx_t_19);
            PyTuple_SET_ITEM(__pyx_t_21, 2+__pyx_t_4, __pyx_t_19);
            __Pyx_GIVEREF(__pyx_t_20);
            PyTuple_SET_ITEM(__pyx_t_21, 3+__pyx_t_4, __pyx_t_20);
            __pyx_t_12 = 0;
            __pyx_t_19 = 0;
            __pyx_t_20 = 0;
            __pyx_t_22 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_21, NULL); if (unlikely(!__pyx_t_22)) __PYX_ERR(0, 1602, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_22);
            __Pyx_DECREF(__pyx_t_21); __pyx_t_21 = 0;
            __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
            __pyx_t_3 = NULL;
            if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_2))) {
              __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
              if (likely(__pyx_t_3)) {
                PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
                __Pyx_INCREF(__pyx_t_3);
                __Pyx_INCREF(function);
                __Pyx_DECREF_SET(__pyx_t_2, function);
              }
            }
            if (!__pyx_t_3) {
              __pyx_t_11 = __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_22); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1602, __pyx_L1_error)
              __Pyx_DECREF(__pyx_t_22); __pyx_t_22 = 0;
              __Pyx_GOTREF(__pyx_t_11);
            } else {
              __pyx_t_21 = PyTuple_New(1+1); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 1602, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_21);
              __Pyx_GIVEREF(__pyx_t_3); PyTuple_SET_ITEM(__pyx_t_21, 0, __pyx_t_3); __pyx_t_3 = NULL;
              __Pyx_GIVEREF(__pyx_t_22);
              PyTuple_SET_ITEM(__pyx_t_21, 0+1, __pyx_t_22);
              __pyx_t_22 = 0;
              __pyx_t_11 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_21, NULL); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1602, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_11);
              __Pyx_DECREF(__pyx_t_21); __pyx_t_21 = 0;
            }
            __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
            __pyx_t_2 = NULL;
            if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_10))) {
              __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_10);
              if (likely(__pyx_t_2)) {
                PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_10);
                __Pyx_INCREF(__pyx_t_2);
                __Pyx_INCREF(function);
                __Pyx_DECREF_SET(__pyx_t_10, function);
              }
            }
            if (!__pyx_t_2) {
              __pyx_t_6 = __Pyx_PyObject_CallOneArg(__pyx_t_10, __pyx_t_11); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1602, __pyx_L1_error)
              __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
              __Pyx_GOTREF(__pyx_t_6);
            } else {
              __pyx_t_21 = PyTuple_New(1+1); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 1602, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_21);
              __Pyx_GIVEREF(__pyx_t_2); PyTuple_SET_ITEM(__pyx_t_21, 0, __pyx_t_2); __pyx_t_2 = NULL;
              __Pyx_GIVEREF(__pyx_t_11);
              PyTuple_SET_ITEM(__pyx_t_21, 0+1, __pyx_t_11);
              __pyx_t_11 = 0;
              __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_10, __pyx_t_21, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1602, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_6);
              __Pyx_DECREF(__pyx_t_21); __pyx_t_21 = 0;
            }
            __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
            __pyx_t_10 = PyNumber_Add(__pyx_t_1, __pyx_t_6); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1602, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_10);
            __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
            __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
            __Pyx_XDECREF_SET(__pyx_v_alt_seq, __pyx_t_10);
            __pyx_t_10 = 0;

            /* "vapor_vali/Simple_function.pyx":1603
 *                     if len(all_reads)>0:
 *                         alt_seq=ref_seq[:flank_length]+reverse(complementary(ref_seq_readin(ref,dup_block[0],dup_block[2]-flank_length,dup_block[2])))
 *                         [window_size,window_size_qc]=window_size_refine(alt_seq)             # <<<<<<<<<<<<<<
 *                         if not window_size=='Error':
 *                             best_read_rec=''
 */
            __pyx_t_6 = __Pyx_GetModuleGlobalName(__pyx_n_s_window_size_refine); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1603, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_6);
            __pyx_t_1 = NULL;
            if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_6))) {
              __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_6);
              if (likely(__pyx_t_1)) {
                PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
                __Pyx_INCREF(__pyx_t_1);
                __Pyx_INCREF(function);
                __Pyx_DECREF_SET(__pyx_t_6, function);
              }
            }
            if (!__pyx_t_1) {
              __pyx_t_10 = __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_v_alt_seq); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1603, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_10);
            } else {
              __pyx_t_21 = PyTuple_New(1+1); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 1603, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_21);
              __Pyx_GIVEREF(__pyx_t_1); PyTuple_SET_ITEM(__pyx_t_21, 0, __pyx_t_1); __pyx_t_1 = NULL;
              __Pyx_INCREF(__pyx_v_alt_seq);
              __Pyx_GIVEREF(__pyx_v_alt_seq);
              PyTuple_SET_ITEM(__pyx_t_21, 0+1, __pyx_v_alt_seq);
              __pyx_t_10 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_21, NULL); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1603, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_10);
              __Pyx_DECREF(__pyx_t_21); __pyx_t_21 = 0;
            }
            __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
            if ((likely(PyTuple_CheckExact(__pyx_t_10))) || (PyList_CheckExact(__pyx_t_10))) {
              PyObject* sequence = __pyx_t_10;
              #if CYTHON_COMPILING_IN_CPYTHON
              Py_ssize_t size = Py_SIZE(sequence);
              #else
              Py_ssize_t size = PySequence_Size(sequence);
              #endif
              if (unlikely(size != 2)) {
                if (size > 2) __Pyx_RaiseTooManyValuesError(2);
                else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
                __PYX_ERR(0, 1603, __pyx_L1_error)
              }
              #if CYTHON_COMPILING_IN_CPYTHON
              if (likely(PyTuple_CheckExact(sequence))) {
                __pyx_t_6 = PyTuple_GET_ITEM(sequence, 0); 
                __pyx_t_21 = PyTuple_GET_ITEM(sequence, 1); 
              } else {
                __pyx_t_6 = PyList_GET_ITEM(sequence, 0); 
                __pyx_t_21 = PyList_GET_ITEM(sequence, 1); 
              }
              __Pyx_INCREF(__pyx_t_6);
              __Pyx_INCREF(__pyx_t_21);
              #else
              __pyx_t_6 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1603, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_6);
              __pyx_t_21 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 1603, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_21);
              #endif
              __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
            } else {
              Py_ssize_t index = -1;
              __pyx_t_1 = PyObject_GetIter(__pyx_t_10); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1603, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_1);
              __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
              __pyx_t_13 = Py_TYPE(__pyx_t_1)->tp_iternext;
              index = 0; __pyx_t_6 = __pyx_t_13(__pyx_t_1); if (unlikely(!__pyx_t_6)) goto __pyx_L49_unpacking_failed;
              __Pyx_GOTREF(__pyx_t_6);
              index = 1; __pyx_t_21 = __pyx_t_13(__pyx_t_1); if (unlikely(!__pyx_t_21)) goto __pyx_L49_unpacking_failed;
              __Pyx_GOTREF(__pyx_t_21);
              if (__Pyx_IternextUnpackEndCheck(__pyx_t_13(__pyx_t_1), 2) < 0) __PYX_ERR(0, 1603, __pyx_L1_error)
              __pyx_t_13 = NULL;
              __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
              goto __pyx_L50_unpacking_done;
              __pyx_L49_unpacking_failed:;
              __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
              __pyx_t_13 = NULL;
              if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
              __PYX_ERR(0, 1603, __pyx_L1_error)
              __pyx_L50_unpacking_done:;
            }
            __Pyx_DECREF_SET(__pyx_v_window_size, __pyx_t_6);
            __pyx_t_6 = 0;
            __Pyx_DECREF_SET(__pyx_v_window_size_qc, __pyx_t_21);
            __pyx_t_21 = 0;

            /* "vapor_vali/Simple_function.pyx":1604
 *                         alt_seq=ref_seq[:flank_length]+reverse(complementary(ref_seq_readin(ref,dup_block[0],dup_block[2]-flank_length,dup_block[2])))
 *                         [window_size,window_size_qc]=window_size_refine(alt_seq)
 *                         if not window_size=='Error':             # <<<<<<<<<<<<<<
 *                             best_read_rec=''
 *                             for x in all_reads:
 */
            __pyx_t_9 = (__Pyx_PyString_Equals(__pyx_v_window_size, __pyx_n_s_Error, Py_EQ)); if (unlikely(__pyx_t_9 < 0)) __PYX_ERR(0, 1604, __pyx_L1_error)
            __pyx_t_7 = ((!__pyx_t_9) != 0);
            if (__pyx_t_7) {

              /* "vapor_vali/Simple_function.pyx":1605
 *                         [window_size,window_size_qc]=window_size_refine(alt_seq)
 *                         if not window_size=='Error':
 *                             best_read_rec=''             # <<<<<<<<<<<<<<
 *                             for x in all_reads:
 *                                 vapor_single_read_score=calcu_vapor_single_read_score_within_10Perc_m1b(ref_seq,alt_seq,x,window_size)
 */
              __Pyx_INCREF(__pyx_kp_s__24);
              __Pyx_XDECREF_SET(__pyx_v_best_read_rec, __pyx_kp_s__24);

              /* "vapor_vali/Simple_function.pyx":1606
 *                         if not window_size=='Error':
 *                             best_read_rec=''
 *                             for x in all_reads:             # <<<<<<<<<<<<<<
 *                                 vapor_single_read_score=calcu_vapor_single_read_score_within_10Perc_m1b(ref_seq,alt_seq,x,window_size)
 *                                 if not 0 in vapor_single_read_score and not math.isnan(vapor_single_read_score[0]) and not math.isnan(vapor_single_read_score[1]):
 */
              if (likely(PyList_CheckExact(__pyx_v_all_reads)) || PyTuple_CheckExact(__pyx_v_all_reads)) {
                __pyx_t_10 = __pyx_v_all_reads; __Pyx_INCREF(__pyx_t_10); __pyx_t_4 = 0;
                __pyx_t_5 = NULL;
              } else {
                __pyx_t_4 = -1; __pyx_t_10 = PyObject_GetIter(__pyx_v_all_reads); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1606, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_10);
                __pyx_t_5 = Py_TYPE(__pyx_t_10)->tp_iternext; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1606, __pyx_L1_error)
              }
              for (;;) {
                if (likely(!__pyx_t_5)) {
                  if (likely(PyList_CheckExact(__pyx_t_10))) {
                    if (__pyx_t_4 >= PyList_GET_SIZE(__pyx_t_10)) break;
                    #if CYTHON_COMPILING_IN_CPYTHON
                    __pyx_t_21 = PyList_GET_ITEM(__pyx_t_10, __pyx_t_4); __Pyx_INCREF(__pyx_t_21); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 1606, __pyx_L1_error)
                    #else
                    __pyx_t_21 = PySequence_ITEM(__pyx_t_10, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 1606, __pyx_L1_error)
                    __Pyx_GOTREF(__pyx_t_21);
                    #endif
                  } else {
                    if (__pyx_t_4 >= PyTuple_GET_SIZE(__pyx_t_10)) break;
                    #if CYTHON_COMPILING_IN_CPYTHON
                    __pyx_t_21 = PyTuple_GET_ITEM(__pyx_t_10, __pyx_t_4); __Pyx_INCREF(__pyx_t_21); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 1606, __pyx_L1_error)
                    #else
                    __pyx_t_21 = PySequence_ITEM(__pyx_t_10, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 1606, __pyx_L1_error)
                    __Pyx_GOTREF(__pyx_t_21);
                    #endif
                  }
                } else {
                  __pyx_t_21 = __pyx_t_5(__pyx_t_10);
                  if (unlikely(!__pyx_t_21)) {
                    PyObject* exc_type = PyErr_Occurred();
                    if (exc_type) {
                      if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
                      else __PYX_ERR(0, 1606, __pyx_L1_error)
                    }
                    break;
                  }
                  __Pyx_GOTREF(__pyx_t_21);
                }
                __Pyx_XDECREF_SET(__pyx_v_x, __pyx_t_21);
                __pyx_t_21 = 0;

                /* "vapor_vali/Simple_function.pyx":1607
 *                             best_read_rec=''
 *                             for x in all_reads:
 *                                 vapor_single_read_score=calcu_vapor_single_read_score_within_10Perc_m1b(ref_seq,alt_seq,x,window_size)             # <<<<<<<<<<<<<<
 *                                 if not 0 in vapor_single_read_score and not math.isnan(vapor_single_read_score[0]) and not math.isnan(vapor_single_read_score[1]):
 *                                     vapor_score_list.append(1-float(vapor_single_read_score[1])/float(vapor_single_read_score[0]))
 */
                __pyx_t_6 = __Pyx_GetModuleGlobalName(__pyx_n_s_calcu_vapor_single_read_score_wi); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1607, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_6);
                __pyx_t_1 = NULL;
                __pyx_t_14 = 0;
                if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_6))) {
                  __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_6);
                  if (likely(__pyx_t_1)) {
                    PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
                    __Pyx_INCREF(__pyx_t_1);
                    __Pyx_INCREF(function);
                    __Pyx_DECREF_SET(__pyx_t_6, function);
                    __pyx_t_14 = 1;
                  }
                }
                __pyx_t_11 = PyTuple_New(4+__pyx_t_14); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1607, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_11);
                if (__pyx_t_1) {
                  __Pyx_GIVEREF(__pyx_t_1); PyTuple_SET_ITEM(__pyx_t_11, 0, __pyx_t_1); __pyx_t_1 = NULL;
                }
                __Pyx_INCREF(__pyx_v_ref_seq);
                __Pyx_GIVEREF(__pyx_v_ref_seq);
                PyTuple_SET_ITEM(__pyx_t_11, 0+__pyx_t_14, __pyx_v_ref_seq);
                __Pyx_INCREF(__pyx_v_alt_seq);
                __Pyx_GIVEREF(__pyx_v_alt_seq);
                PyTuple_SET_ITEM(__pyx_t_11, 1+__pyx_t_14, __pyx_v_alt_seq);
                __Pyx_INCREF(__pyx_v_x);
                __Pyx_GIVEREF(__pyx_v_x);
                PyTuple_SET_ITEM(__pyx_t_11, 2+__pyx_t_14, __pyx_v_x);
                __Pyx_INCREF(__pyx_v_window_size);
                __Pyx_GIVEREF(__pyx_v_window_size);
                PyTuple_SET_ITEM(__pyx_t_11, 3+__pyx_t_14, __pyx_v_window_size);
                __pyx_t_21 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_11, NULL); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 1607, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_21);
                __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
                __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
                __Pyx_XDECREF_SET(__pyx_v_vapor_single_read_score, __pyx_t_21);
                __pyx_t_21 = 0;

                /* "vapor_vali/Simple_function.pyx":1608
 *                             for x in all_reads:
 *                                 vapor_single_read_score=calcu_vapor_single_read_score_within_10Perc_m1b(ref_seq,alt_seq,x,window_size)
 *                                 if not 0 in vapor_single_read_score and not math.isnan(vapor_single_read_score[0]) and not math.isnan(vapor_single_read_score[1]):             # <<<<<<<<<<<<<<
 *                                     vapor_score_list.append(1-float(vapor_single_read_score[1])/float(vapor_single_read_score[0]))
 *                                     if vapor_score_list[-1]==max(vapor_score_list):best_read_rec=x
 */
                __pyx_t_9 = (__Pyx_PySequence_ContainsTF(__pyx_int_0, __pyx_v_vapor_single_read_score, Py_NE)); if (unlikely(__pyx_t_9 < 0)) __PYX_ERR(0, 1608, __pyx_L1_error)
                __pyx_t_15 = (__pyx_t_9 != 0);
                if (__pyx_t_15) {
                } else {
                  __pyx_t_7 = __pyx_t_15;
                  goto __pyx_L55_bool_binop_done;
                }
                __pyx_t_6 = __Pyx_GetModuleGlobalName(__pyx_n_s_math); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1608, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_6);
                __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_isnan); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1608, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_11);
                __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
                __pyx_t_6 = __Pyx_GetItemInt(__pyx_v_vapor_single_read_score, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1608, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_6);
                __pyx_t_1 = NULL;
                if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_11))) {
                  __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_11);
                  if (likely(__pyx_t_1)) {
                    PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_11);
                    __Pyx_INCREF(__pyx_t_1);
                    __Pyx_INCREF(function);
                    __Pyx_DECREF_SET(__pyx_t_11, function);
                  }
                }
                if (!__pyx_t_1) {
                  __pyx_t_21 = __Pyx_PyObject_CallOneArg(__pyx_t_11, __pyx_t_6); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 1608, __pyx_L1_error)
                  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
                  __Pyx_GOTREF(__pyx_t_21);
                } else {
                  __pyx_t_2 = PyTuple_New(1+1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1608, __pyx_L1_error)
                  __Pyx_GOTREF(__pyx_t_2);
                  __Pyx_GIVEREF(__pyx_t_1); PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_1); __pyx_t_1 = NULL;
                  __Pyx_GIVEREF(__pyx_t_6);
                  PyTuple_SET_ITEM(__pyx_t_2, 0+1, __pyx_t_6);
                  __pyx_t_6 = 0;
                  __pyx_t_21 = __Pyx_PyObject_Call(__pyx_t_11, __pyx_t_2, NULL); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 1608, __pyx_L1_error)
                  __Pyx_GOTREF(__pyx_t_21);
                  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
                }
                __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
                __pyx_t_15 = __Pyx_PyObject_IsTrue(__pyx_t_21); if (unlikely(__pyx_t_15 < 0)) __PYX_ERR(0, 1608, __pyx_L1_error)
                __Pyx_DECREF(__pyx_t_21); __pyx_t_21 = 0;
                __pyx_t_9 = ((!__pyx_t_15) != 0);
                if (__pyx_t_9) {
                } else {
                  __pyx_t_7 = __pyx_t_9;
                  goto __pyx_L55_bool_binop_done;
                }
                __pyx_t_11 = __Pyx_GetModuleGlobalName(__pyx_n_s_math); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1608, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_11);
                __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_11, __pyx_n_s_isnan); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1608, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_2);
                __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
                __pyx_t_11 = __Pyx_GetItemInt(__pyx_v_vapor_single_read_score, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1608, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_11);
                __pyx_t_6 = NULL;
                if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_2))) {
                  __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_2);
                  if (likely(__pyx_t_6)) {
                    PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
                    __Pyx_INCREF(__pyx_t_6);
                    __Pyx_INCREF(function);
                    __Pyx_DECREF_SET(__pyx_t_2, function);
                  }
                }
                if (!__pyx_t_6) {
                  __pyx_t_21 = __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_11); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 1608, __pyx_L1_error)
                  __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
                  __Pyx_GOTREF(__pyx_t_21);
                } else {
                  __pyx_t_1 = PyTuple_New(1+1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1608, __pyx_L1_error)
                  __Pyx_GOTREF(__pyx_t_1);
                  __Pyx_GIVEREF(__pyx_t_6); PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_6); __pyx_t_6 = NULL;
                  __Pyx_GIVEREF(__pyx_t_11);
                  PyTuple_SET_ITEM(__pyx_t_1, 0+1, __pyx_t_11);
                  __pyx_t_11 = 0;
                  __pyx_t_21 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_1, NULL); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 1608, __pyx_L1_error)
                  __Pyx_GOTREF(__pyx_t_21);
                  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
                }
                __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
                __pyx_t_9 = __Pyx_PyObject_IsTrue(__pyx_t_21); if (unlikely(__pyx_t_9 < 0)) __PYX_ERR(0, 1608, __pyx_L1_error)
                __Pyx_DECREF(__pyx_t_21); __pyx_t_21 = 0;
                __pyx_t_15 = ((!__pyx_t_9) != 0);
                __pyx_t_7 = __pyx_t_15;
                __pyx_L55_bool_binop_done:;
                if (__pyx_t_7) {

                  /* "vapor_vali/Simple_function.pyx":1609
 *                                 vapor_single_read_score=calcu_vapor_single_read_score_within_10Perc_m1b(ref_seq,alt_seq,x,window_size)
 *                                 if not 0 in vapor_single_read_score and not math.isnan(vapor_single_read_score[0]) and not math.isnan(vapor_single_read_score[1]):
 *                                     vapor_score_list.append(1-float(vapor_single_read_score[1])/float(vapor_single_read_score[0]))             # <<<<<<<<<<<<<<
 *                                     if vapor_score_list[-1]==max(vapor_score_list):best_read_rec=x
 *                             make_event_figure_1(vapor_score_list,best_read_rec,window_size,ref_seq,alt_seq,out_figure_name)
 */
                  __pyx_t_21 = __Pyx_GetItemInt(__pyx_v_vapor_single_read_score, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 1609, __pyx_L1_error)
                  __Pyx_GOTREF(__pyx_t_21);
                  __pyx_t_16 = __Pyx_PyObject_AsDouble(__pyx_t_21); if (unlikely(__pyx_t_16 == ((double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1609, __pyx_L1_error)
                  __Pyx_DECREF(__pyx_t_21); __pyx_t_21 = 0;
                  __pyx_t_21 = __Pyx_GetItemInt(__pyx_v_vapor_single_read_score, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 1609, __pyx_L1_error)
                  __Pyx_GOTREF(__pyx_t_21);
                  __pyx_t_17 = __Pyx_PyObject_AsDouble(__pyx_t_21); if (unlikely(__pyx_t_17 == ((double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1609, __pyx_L1_error)
                  __Pyx_DECREF(__pyx_t_21); __pyx_t_21 = 0;
                  if (unlikely(__pyx_t_17 == 0)) {
                    PyErr_SetString(PyExc_ZeroDivisionError, "float division");
                    __PYX_ERR(0, 1609, __pyx_L1_error)
                  }
                  __pyx_t_21 = PyFloat_FromDouble((1.0 - (__pyx_t_16 / __pyx_t_17))); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 1609, __pyx_L1_error)
                  __Pyx_GOTREF(__pyx_t_21);
                  __pyx_t_8 = __Pyx_PyList_Append(__pyx_v_vapor_score_list, __pyx_t_21); if (unlikely(__pyx_t_8 == -1)) __PYX_ERR(0, 1609, __pyx_L1_error)
                  __Pyx_DECREF(__pyx_t_21); __pyx_t_21 = 0;

                  /* "vapor_vali/Simple_function.pyx":1610
 *                                 if not 0 in vapor_single_read_score and not math.isnan(vapor_single_read_score[0]) and not math.isnan(vapor_single_read_score[1]):
 *                                     vapor_score_list.append(1-float(vapor_single_read_score[1])/float(vapor_single_read_score[0]))
 *                                     if vapor_score_list[-1]==max(vapor_score_list):best_read_rec=x             # <<<<<<<<<<<<<<
 *                             make_event_figure_1(vapor_score_list,best_read_rec,window_size,ref_seq,alt_seq,out_figure_name)
 *     return vapor_score_list
 */
                  __pyx_t_21 = __Pyx_GetItemInt_List(__pyx_v_vapor_score_list, -1L, long, 1, __Pyx_PyInt_From_long, 1, 1, 1); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 1610, __pyx_L1_error)
                  __Pyx_GOTREF(__pyx_t_21);
                  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1610, __pyx_L1_error)
                  __Pyx_GOTREF(__pyx_t_2);
                  __Pyx_INCREF(__pyx_v_vapor_score_list);
                  __Pyx_GIVEREF(__pyx_v_vapor_score_list);
                  PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_v_vapor_score_list);
                  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_max, __pyx_t_2, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1610, __pyx_L1_error)
                  __Pyx_GOTREF(__pyx_t_1);
                  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
                  __pyx_t_2 = PyObject_RichCompare(__pyx_t_21, __pyx_t_1, Py_EQ); __Pyx_XGOTREF(__pyx_t_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1610, __pyx_L1_error)
                  __Pyx_DECREF(__pyx_t_21); __pyx_t_21 = 0;
                  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
                  __pyx_t_7 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_7 < 0)) __PYX_ERR(0, 1610, __pyx_L1_error)
                  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
                  if (__pyx_t_7) {
                    __Pyx_INCREF(__pyx_v_x);
                    __Pyx_DECREF_SET(__pyx_v_best_read_rec, __pyx_v_x);
                  }

                  /* "vapor_vali/Simple_function.pyx":1608
 *                             for x in all_reads:
 *                                 vapor_single_read_score=calcu_vapor_single_read_score_within_10Perc_m1b(ref_seq,alt_seq,x,window_size)
 *                                 if not 0 in vapor_single_read_score and not math.isnan(vapor_single_read_score[0]) and not math.isnan(vapor_single_read_score[1]):             # <<<<<<<<<<<<<<
 *                                     vapor_score_list.append(1-float(vapor_single_read_score[1])/float(vapor_single_read_score[0]))
 *                                     if vapor_score_list[-1]==max(vapor_score_list):best_read_rec=x
 */
                }

                /* "vapor_vali/Simple_function.pyx":1606
 *                         if not window_size=='Error':
 *                             best_read_rec=''
 *                             for x in all_reads:             # <<<<<<<<<<<<<<
 *                                 vapor_single_read_score=calcu_vapor_single_read_score_within_10Perc_m1b(ref_seq,alt_seq,x,window_size)
 *                                 if not 0 in vapor_single_read_score and not math.isnan(vapor_single_read_score[0]) and not math.isnan(vapor_single_read_score[1]):
 */
              }
              __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;

              /* "vapor_vali/Simple_function.pyx":1611
 *                                     vapor_score_list.append(1-float(vapor_single_read_score[1])/float(vapor_single_read_score[0]))
 *                                     if vapor_score_list[-1]==max(vapor_score_list):best_read_rec=x
 *                             make_event_figure_1(vapor_score_list,best_read_rec,window_size,ref_seq,alt_seq,out_figure_name)             # <<<<<<<<<<<<<<
 *     return vapor_score_list
 * 
 */
              __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_make_event_figure_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1611, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_2);
              __pyx_t_1 = NULL;
              __pyx_t_4 = 0;
              if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_2))) {
                __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_2);
                if (likely(__pyx_t_1)) {
                  PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
                  __Pyx_INCREF(__pyx_t_1);
                  __Pyx_INCREF(function);
                  __Pyx_DECREF_SET(__pyx_t_2, function);
                  __pyx_t_4 = 1;
                }
              }
              __pyx_t_21 = PyTuple_New(6+__pyx_t_4); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 1611, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_21);
              if (__pyx_t_1) {
                __Pyx_GIVEREF(__pyx_t_1); PyTuple_SET_ITEM(__pyx_t_21, 0, __pyx_t_1); __pyx_t_1 = NULL;
              }
              __Pyx_INCREF(__pyx_v_vapor_score_list);
              __Pyx_GIVEREF(__pyx_v_vapor_score_list);
              PyTuple_SET_ITEM(__pyx_t_21, 0+__pyx_t_4, __pyx_v_vapor_score_list);
              __Pyx_INCREF(__pyx_v_best_read_rec);
              __Pyx_GIVEREF(__pyx_v_best_read_rec);
              PyTuple_SET_ITEM(__pyx_t_21, 1+__pyx_t_4, __pyx_v_best_read_rec);
              __Pyx_INCREF(__pyx_v_window_size);
              __Pyx_GIVEREF(__pyx_v_window_size);
              PyTuple_SET_ITEM(__pyx_t_21, 2+__pyx_t_4, __pyx_v_window_size);
              __Pyx_INCREF(__pyx_v_ref_seq);
              __Pyx_GIVEREF(__pyx_v_ref_seq);
              PyTuple_SET_ITEM(__pyx_t_21, 3+__pyx_t_4, __pyx_v_ref_seq);
              __Pyx_INCREF(__pyx_v_alt_seq);
              __Pyx_GIVEREF(__pyx_v_alt_seq);
              PyTuple_SET_ITEM(__pyx_t_21, 4+__pyx_t_4, __pyx_v_alt_seq);
              __Pyx_INCREF(__pyx_v_out_figure_name);
              __Pyx_GIVEREF(__pyx_v_out_figure_name);
              PyTuple_SET_ITEM(__pyx_t_21, 5+__pyx_t_4, __pyx_v_out_figure_name);
              __pyx_t_10 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_21, NULL); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1611, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_10);
              __Pyx_DECREF(__pyx_t_21); __pyx_t_21 = 0;
              __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
              __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;

              /* "vapor_vali/Simple_function.pyx":1604
 *                         alt_seq=ref_seq[:flank_length]+reverse(complementary(ref_seq_readin(ref,dup_block[0],dup_block[2]-flank_length,dup_block[2])))
 *                         [window_size,window_size_qc]=window_size_refine(alt_seq)
 *                         if not window_size=='Error':             # <<<<<<<<<<<<<<
 *                             best_read_rec=''
 *                             for x in all_reads:
 */
            }

            /* "vapor_vali/Simple_function.pyx":1601
 *                 if not window_size=='Error':
 *                     all_reads=simple_del_chop_pacbio_read_simple_short(bam_in,ins_point,flank_length)
 *                     if len(all_reads)>0:             # <<<<<<<<<<<<<<
 *                         alt_seq=ref_seq[:flank_length]+reverse(complementary(ref_seq_readin(ref,dup_block[0],dup_block[2]-flank_length,dup_block[2])))
 *                         [window_size,window_size_qc]=window_size_refine(alt_seq)
 */
          }

          /* "vapor_vali/Simple_function.pyx":1599
 *                 ref_seq=ref_seq_readin(ref,ins_point[0],ins_point[1]-flank_length,ins_point[1]+flank_length)
 *                 [window_size,window_size_qc]=window_size_refine(ref_seq)
 *                 if not window_size=='Error':             # <<<<<<<<<<<<<<
 *                     all_reads=simple_del_chop_pacbio_read_simple_short(bam_in,ins_point,flank_length)
 *                     if len(all_reads)>0:
 */
        }
      }
      __pyx_L30:;

      /* "vapor_vali/Simple_function.pyx":1579
 *                                 if vapor_score_list[-1]==max(vapor_score_list):best_read_rec=x
 *                         make_event_figure_1(vapor_score_list,best_read_rec,window_size,ref_seq,alt_seq,out_figure_name)
 *         if run_flag==0:             # <<<<<<<<<<<<<<
 *             if max(bp_info)-min(bp_info)<default_max_sv_test: #only try to read in all reads with sv <100K; else: try breakpoints ;
 *                 ref_seq=ref_seq_readin(ref,ins_point[0],ins_point[1]-flank_length,ins_point[1]+flank_length)
 */
    }

    /* "vapor_vali/Simple_function.pyx":1545
 *     flank_length=flank_length_calculate(dup_block)
 *     vapor_score_list=[]
 *     if sv_info[0]==sv_info[3]:  #dup inv on the same chromosome             # <<<<<<<<<<<<<<
 *         bp_info=sorted(sv_info[1:3]+[sv_info[4]])
 *         run_flag=0
 */
  }

  /* "vapor_vali/Simple_function.pyx":1612
 *                                     if vapor_score_list[-1]==max(vapor_score_list):best_read_rec=x
 *                             make_event_figure_1(vapor_score_list,best_read_rec,window_size,ref_seq,alt_seq,out_figure_name)
 *     return vapor_score_list             # <<<<<<<<<<<<<<
 * 
 * def vapor_long_del_inv(bam_in,ref,sv_info,out_figure_name):
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_vapor_score_list);
  __pyx_r = __pyx_v_vapor_score_list;
  goto __pyx_L0;

  /* "vapor_vali/Simple_function.pyx":1538
 *     return vapor_score_list
 * 
 * def vapor_dup_inv_VapoR(bam_in,ref,sv_info,out_figure_name):             # <<<<<<<<<<<<<<
 *     #eg of sv_info=['chr1', 114103333, 114103408, 'chr1', 114111746]
 *     sv_info[1:3]=[int(i) for i in sv_info[1:3]]
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_XDECREF(__pyx_t_10);
  __Pyx_XDECREF(__pyx_t_11);
  __Pyx_XDECREF(__pyx_t_12);
  __Pyx_XDECREF(__pyx_t_18);
  __Pyx_XDECREF(__pyx_t_19);
  __Pyx_XDECREF(__pyx_t_20);
  __Pyx_XDECREF(__pyx_t_21);
  __Pyx_XDECREF(__pyx_t_22);
  __Pyx_AddTraceback("vapor_vali.Simple_function.vapor_dup_inv_VapoR", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_dup_block);
  __Pyx_XDECREF(__pyx_v_ins_point);
  __Pyx_XDECREF(__pyx_v_flank_length);
  __Pyx_XDECREF(__pyx_v_vapor_score_list);
  __Pyx_XDECREF(__pyx_v_bp_info);
  __Pyx_XDECREF(__pyx_v_run_flag);
  __Pyx_XDECREF(__pyx_v_ref_seq);
  __Pyx_XDECREF(__pyx_v_window_size);
  __Pyx_XDECREF(__pyx_v_window_size_qc);
  __Pyx_XDECREF(__pyx_v_ref_structure);
  __Pyx_XDECREF(__pyx_v_alt_structure);
  __Pyx_XDECREF(__pyx_v_all_reads);
  __Pyx_XDECREF(__pyx_v_alt_seq);
  __Pyx_XDECREF(__pyx_v_a_seq);
  __Pyx_XDECREF(__pyx_v_b_seq);
  __Pyx_XDECREF(__pyx_v_x);
  __Pyx_XDECREF(__pyx_v_best_read_rec);
  __Pyx_XDECREF(__pyx_v_vapor_single_read_score);
  __Pyx_XDECREF(__pyx_v_i);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "vapor_vali/Simple_function.pyx":1614
 *     return vapor_score_list
 * 
 * def vapor_long_del_inv(bam_in,ref,sv_info,out_figure_name):             # <<<<<<<<<<<<<<
 *     #eg of sv_info=[['chr19', 46275941, 46314150, 'del'], ['chr19', 46314150, 46314312, 'inv']]
 *     vapor_score_list=[]
 */

/* Python wrapper */
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_207vapor_long_del_inv(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_10vapor_vali_15Simple_function_207vapor_long_del_inv = {"vapor_long_del_inv", (PyCFunction)__pyx_pw_10vapor_vali_15Simple_function_207vapor_long_del_inv, METH_VARARGS|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_207vapor_long_del_inv(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_bam_in = 0;
  PyObject *__pyx_v_ref = 0;
  PyObject *__pyx_v_sv_info = 0;
  PyObject *__pyx_v_out_figure_name = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("vapor_long_del_inv (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_bam_in,&__pyx_n_s_ref,&__pyx_n_s_sv_info,&__pyx_n_s_out_figure_name,0};
    PyObject* values[4] = {0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
      switch (pos_args) {
        case  4: values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
        case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_bam_in)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_ref)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("vapor_long_del_inv", 1, 4, 4, 1); __PYX_ERR(0, 1614, __pyx_L3_error)
        }
        case  2:
        if (likely((values[2] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_sv_info)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("vapor_long_del_inv", 1, 4, 4, 2); __PYX_ERR(0, 1614, __pyx_L3_error)
        }
        case  3:
        if (likely((values[3] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_out_figure_name)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("vapor_long_del_inv", 1, 4, 4, 3); __PYX_ERR(0, 1614, __pyx_L3_error)
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "vapor_long_del_inv") < 0)) __PYX_ERR(0, 1614, __pyx_L3_error)
      }
    } else if (PyTuple_GET_SIZE(__pyx_args) != 4) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
      values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
    }
    __pyx_v_bam_in = values[0];
    __pyx_v_ref = values[1];
    __pyx_v_sv_info = values[2];
    __pyx_v_out_figure_name = values[3];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("vapor_long_del_inv", 1, 4, 4, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1614, __pyx_L3_error)
  __pyx_L3_error:;
  __Pyx_AddTraceback("vapor_vali.Simple_function.vapor_long_del_inv", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_10vapor_vali_15Simple_function_206vapor_long_del_inv(__pyx_self, __pyx_v_bam_in, __pyx_v_ref, __pyx_v_sv_info, __pyx_v_out_figure_name);

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10vapor_vali_15Simple_function_206vapor_long_del_inv(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_bam_in, PyObject *__pyx_v_ref, PyObject *__pyx_v_sv_info, PyObject *__pyx_v_out_figure_name) {
  PyObject *__pyx_v_vapor_score_list = NULL;
  PyObject *__pyx_v_best_read_rec = NULL;
  PyObject *__pyx_v_flank_length = NULL;
  PyObject *__pyx_v_ref_seq = NULL;
  PyObject *__pyx_v_window_size = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_window_size_qc = NULL;
  PyObject *__pyx_v_alt_seq = NULL;
  PyObject *__pyx_v_all_reads = NULL;
  PyObject *__pyx_v_x = NULL;
  PyObject *__pyx_v_vapor_single_read_score = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  PyObject *__pyx_t_6 = NULL;
  Py_ssize_t __pyx_t_7;
  PyObject *__pyx_t_8 = NULL;
  PyObject *(*__pyx_t_9)(PyObject *);
  int __pyx_t_10;
  int __pyx_t_11;
  PyObject *__pyx_t_12 = NULL;
  PyObject *__pyx_t_13 = NULL;
  PyObject *__pyx_t_14 = NULL;
  PyObject *__pyx_t_15 = NULL;
  PyObject *__pyx_t_16 = NULL;
  PyObject *(*__pyx_t_17)(PyObject *);
  Py_ssize_t __pyx_t_18;
  double __pyx_t_19;
  double __pyx_t_20;
  int __pyx_t_21;
  __Pyx_RefNannySetupContext("vapor_long_del_inv", 0);

  /* "vapor_vali/Simple_function.pyx":1616
 * def vapor_long_del_inv(bam_in,ref,sv_info,out_figure_name):
 *     #eg of sv_info=[['chr19', 46275941, 46314150, 'del'], ['chr19', 46314150, 46314312, 'inv']]
 *     vapor_score_list=[]             # <<<<<<<<<<<<<<
 *     best_read_rec=''
 *     flank_length=500
 */
  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1616, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_vapor_score_list = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":1617
 *     #eg of sv_info=[['chr19', 46275941, 46314150, 'del'], ['chr19', 46314150, 46314312, 'inv']]
 *     vapor_score_list=[]
 *     best_read_rec=''             # <<<<<<<<<<<<<<
 *     flank_length=500
 *     ref_seq=ref_seq_readin(ref,sv_info[0][0],sv_info[0][1]-flank_length,sv_info[1][1]+flank_length)
 */
  __Pyx_INCREF(__pyx_kp_s__24);
  __pyx_v_best_read_rec = __pyx_kp_s__24;

  /* "vapor_vali/Simple_function.pyx":1618
 *     vapor_score_list=[]
 *     best_read_rec=''
 *     flank_length=500             # <<<<<<<<<<<<<<
 *     ref_seq=ref_seq_readin(ref,sv_info[0][0],sv_info[0][1]-flank_length,sv_info[1][1]+flank_length)
 *     [window_size,window_size_qc]=window_size_refine(ref_seq)
 */
  __Pyx_INCREF(__pyx_int_500);
  __pyx_v_flank_length = __pyx_int_500;

  /* "vapor_vali/Simple_function.pyx":1619
 *     best_read_rec=''
 *     flank_length=500
 *     ref_seq=ref_seq_readin(ref,sv_info[0][0],sv_info[0][1]-flank_length,sv_info[1][1]+flank_length)             # <<<<<<<<<<<<<<
 *     [window_size,window_size_qc]=window_size_refine(ref_seq)
 *     if not window_size=='Error':
 */
  __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_ref_seq_readin); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1619, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_sv_info, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1619, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_4 = __Pyx_GetItemInt(__pyx_t_3, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1619, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_sv_info, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1619, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_5 = __Pyx_GetItemInt(__pyx_t_3, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1619, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = PyNumber_Subtract(__pyx_t_5, __pyx_v_flank_length); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1619, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = __Pyx_GetItemInt(__pyx_v_sv_info, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1619, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_6 = __Pyx_GetItemInt(__pyx_t_5, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1619, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = PyNumber_Add(__pyx_t_6, __pyx_v_flank_length); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1619, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = NULL;
  __pyx_t_7 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_2);
    if (likely(__pyx_t_6)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_6);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_2, function);
      __pyx_t_7 = 1;
    }
  }
  __pyx_t_8 = PyTuple_New(4+__pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1619, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_8);
  if (__pyx_t_6) {
    __Pyx_GIVEREF(__pyx_t_6); PyTuple_SET_ITEM(__pyx_t_8, 0, __pyx_t_6); __pyx_t_6 = NULL;
  }
  __Pyx_INCREF(__pyx_v_ref);
  __Pyx_GIVEREF(__pyx_v_ref);
  PyTuple_SET_ITEM(__pyx_t_8, 0+__pyx_t_7, __pyx_v_ref);
  __Pyx_GIVEREF(__pyx_t_4);
  PyTuple_SET_ITEM(__pyx_t_8, 1+__pyx_t_7, __pyx_t_4);
  __Pyx_GIVEREF(__pyx_t_3);
  PyTuple_SET_ITEM(__pyx_t_8, 2+__pyx_t_7, __pyx_t_3);
  __Pyx_GIVEREF(__pyx_t_5);
  PyTuple_SET_ITEM(__pyx_t_8, 3+__pyx_t_7, __pyx_t_5);
  __pyx_t_4 = 0;
  __pyx_t_3 = 0;
  __pyx_t_5 = 0;
  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_8, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1619, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_ref_seq = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":1620
 *     flank_length=500
 *     ref_seq=ref_seq_readin(ref,sv_info[0][0],sv_info[0][1]-flank_length,sv_info[1][1]+flank_length)
 *     [window_size,window_size_qc]=window_size_refine(ref_seq)             # <<<<<<<<<<<<<<
 *     if not window_size=='Error':
 *         alt_seq=ref_seq[:flank_length]+reverse(complementary(ref_seq_readin(ref,sv_info[1][0],sv_info[1][2]-flank_length,sv_info[1][2])))
 */
  __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_window_size_refine); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1620, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_8 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_8 = PyMethod_GET_SELF(__pyx_t_2);
    if (likely(__pyx_t_8)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_8);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_2, function);
    }
  }
  if (!__pyx_t_8) {
    __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_v_ref_seq); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1620, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
  } else {
    __pyx_t_5 = PyTuple_New(1+1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1620, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_GIVEREF(__pyx_t_8); PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_8); __pyx_t_8 = NULL;
    __Pyx_INCREF(__pyx_v_ref_seq);
    __Pyx_GIVEREF(__pyx_v_ref_seq);
    PyTuple_SET_ITEM(__pyx_t_5, 0+1, __pyx_v_ref_seq);
    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_5, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1620, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  }
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  if ((likely(PyTuple_CheckExact(__pyx_t_1))) || (PyList_CheckExact(__pyx_t_1))) {
    PyObject* sequence = __pyx_t_1;
    #if CYTHON_COMPILING_IN_CPYTHON
    Py_ssize_t size = Py_SIZE(sequence);
    #else
    Py_ssize_t size = PySequence_Size(sequence);
    #endif
    if (unlikely(size != 2)) {
      if (size > 2) __Pyx_RaiseTooManyValuesError(2);
      else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
      __PYX_ERR(0, 1620, __pyx_L1_error)
    }
    #if CYTHON_COMPILING_IN_CPYTHON
    if (likely(PyTuple_CheckExact(sequence))) {
      __pyx_t_2 = PyTuple_GET_ITEM(sequence, 0); 
      __pyx_t_5 = PyTuple_GET_ITEM(sequence, 1); 
    } else {
      __pyx_t_2 = PyList_GET_ITEM(sequence, 0); 
      __pyx_t_5 = PyList_GET_ITEM(sequence, 1); 
    }
    __Pyx_INCREF(__pyx_t_2);
    __Pyx_INCREF(__pyx_t_5);
    #else
    __pyx_t_2 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1620, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_5 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1620, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    #endif
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  } else {
    Py_ssize_t index = -1;
    __pyx_t_8 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1620, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_8);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_9 = Py_TYPE(__pyx_t_8)->tp_iternext;
    index = 0; __pyx_t_2 = __pyx_t_9(__pyx_t_8); if (unlikely(!__pyx_t_2)) goto __pyx_L3_unpacking_failed;
    __Pyx_GOTREF(__pyx_t_2);
    index = 1; __pyx_t_5 = __pyx_t_9(__pyx_t_8); if (unlikely(!__pyx_t_5)) goto __pyx_L3_unpacking_failed;
    __Pyx_GOTREF(__pyx_t_5);
    if (__Pyx_IternextUnpackEndCheck(__pyx_t_9(__pyx_t_8), 2) < 0) __PYX_ERR(0, 1620, __pyx_L1_error)
    __pyx_t_9 = NULL;
    __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
    goto __pyx_L4_unpacking_done;
    __pyx_L3_unpacking_failed:;
    __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
    __pyx_t_9 = NULL;
    if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
    __PYX_ERR(0, 1620, __pyx_L1_error)
    __pyx_L4_unpacking_done:;
  }
  __pyx_v_window_size = __pyx_t_2;
  __pyx_t_2 = 0;
  __pyx_v_window_size_qc = __pyx_t_5;
  __pyx_t_5 = 0;

  /* "vapor_vali/Simple_function.pyx":1621
 *     ref_seq=ref_seq_readin(ref,sv_info[0][0],sv_info[0][1]-flank_length,sv_info[1][1]+flank_length)
 *     [window_size,window_size_qc]=window_size_refine(ref_seq)
 *     if not window_size=='Error':             # <<<<<<<<<<<<<<
 *         alt_seq=ref_seq[:flank_length]+reverse(complementary(ref_seq_readin(ref,sv_info[1][0],sv_info[1][2]-flank_length,sv_info[1][2])))
 *         [window_size,window_size_qc]=window_size_refine(alt_seq)
 */
  __pyx_t_10 = (__Pyx_PyString_Equals(__pyx_v_window_size, __pyx_n_s_Error, Py_EQ)); if (unlikely(__pyx_t_10 < 0)) __PYX_ERR(0, 1621, __pyx_L1_error)
  __pyx_t_11 = ((!__pyx_t_10) != 0);
  if (__pyx_t_11) {

    /* "vapor_vali/Simple_function.pyx":1622
 *     [window_size,window_size_qc]=window_size_refine(ref_seq)
 *     if not window_size=='Error':
 *         alt_seq=ref_seq[:flank_length]+reverse(complementary(ref_seq_readin(ref,sv_info[1][0],sv_info[1][2]-flank_length,sv_info[1][2])))             # <<<<<<<<<<<<<<
 *         [window_size,window_size_qc]=window_size_refine(alt_seq)
 *         if not window_size=='Error':
 */
    __pyx_t_1 = __Pyx_PyObject_GetSlice(__pyx_v_ref_seq, 0, 0, NULL, &__pyx_v_flank_length, NULL, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1622, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_reverse); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1622, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_complementary); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1622, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_6 = __Pyx_GetModuleGlobalName(__pyx_n_s_ref_seq_readin); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1622, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __pyx_t_12 = __Pyx_GetItemInt(__pyx_v_sv_info, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1622, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_12);
    __pyx_t_13 = __Pyx_GetItemInt(__pyx_t_12, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1622, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_13);
    __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
    __pyx_t_12 = __Pyx_GetItemInt(__pyx_v_sv_info, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1622, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_12);
    __pyx_t_14 = __Pyx_GetItemInt(__pyx_t_12, 2, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1622, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_14);
    __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
    __pyx_t_12 = PyNumber_Subtract(__pyx_t_14, __pyx_v_flank_length); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1622, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_12);
    __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
    __pyx_t_14 = __Pyx_GetItemInt(__pyx_v_sv_info, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1622, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_14);
    __pyx_t_15 = __Pyx_GetItemInt(__pyx_t_14, 2, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1622, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_15);
    __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
    __pyx_t_14 = NULL;
    __pyx_t_7 = 0;
    if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_6))) {
      __pyx_t_14 = PyMethod_GET_SELF(__pyx_t_6);
      if (likely(__pyx_t_14)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
        __Pyx_INCREF(__pyx_t_14);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_6, function);
        __pyx_t_7 = 1;
      }
    }
    __pyx_t_16 = PyTuple_New(4+__pyx_t_7); if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 1622, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_16);
    if (__pyx_t_14) {
      __Pyx_GIVEREF(__pyx_t_14); PyTuple_SET_ITEM(__pyx_t_16, 0, __pyx_t_14); __pyx_t_14 = NULL;
    }
    __Pyx_INCREF(__pyx_v_ref);
    __Pyx_GIVEREF(__pyx_v_ref);
    PyTuple_SET_ITEM(__pyx_t_16, 0+__pyx_t_7, __pyx_v_ref);
    __Pyx_GIVEREF(__pyx_t_13);
    PyTuple_SET_ITEM(__pyx_t_16, 1+__pyx_t_7, __pyx_t_13);
    __Pyx_GIVEREF(__pyx_t_12);
    PyTuple_SET_ITEM(__pyx_t_16, 2+__pyx_t_7, __pyx_t_12);
    __Pyx_GIVEREF(__pyx_t_15);
    PyTuple_SET_ITEM(__pyx_t_16, 3+__pyx_t_7, __pyx_t_15);
    __pyx_t_13 = 0;
    __pyx_t_12 = 0;
    __pyx_t_15 = 0;
    __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_16, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1622, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_16); __pyx_t_16 = 0;
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_3))) {
      __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_3);
      if (likely(__pyx_t_6)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
        __Pyx_INCREF(__pyx_t_6);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_3, function);
      }
    }
    if (!__pyx_t_6) {
      __pyx_t_8 = __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_4); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1622, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      __Pyx_GOTREF(__pyx_t_8);
    } else {
      __pyx_t_16 = PyTuple_New(1+1); if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 1622, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_16);
      __Pyx_GIVEREF(__pyx_t_6); PyTuple_SET_ITEM(__pyx_t_16, 0, __pyx_t_6); __pyx_t_6 = NULL;
      __Pyx_GIVEREF(__pyx_t_4);
      PyTuple_SET_ITEM(__pyx_t_16, 0+1, __pyx_t_4);
      __pyx_t_4 = 0;
      __pyx_t_8 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_16, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1622, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_8);
      __Pyx_DECREF(__pyx_t_16); __pyx_t_16 = 0;
    }
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_2))) {
      __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
      if (likely(__pyx_t_3)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
        __Pyx_INCREF(__pyx_t_3);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_2, function);
      }
    }
    if (!__pyx_t_3) {
      __pyx_t_5 = __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_8); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1622, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
      __Pyx_GOTREF(__pyx_t_5);
    } else {
      __pyx_t_16 = PyTuple_New(1+1); if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 1622, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_16);
      __Pyx_GIVEREF(__pyx_t_3); PyTuple_SET_ITEM(__pyx_t_16, 0, __pyx_t_3); __pyx_t_3 = NULL;
      __Pyx_GIVEREF(__pyx_t_8);
      PyTuple_SET_ITEM(__pyx_t_16, 0+1, __pyx_t_8);
      __pyx_t_8 = 0;
      __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_16, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1622, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_5);
      __Pyx_DECREF(__pyx_t_16); __pyx_t_16 = 0;
    }
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = PyNumber_Add(__pyx_t_1, __pyx_t_5); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1622, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_v_alt_seq = __pyx_t_2;
    __pyx_t_2 = 0;

    /* "vapor_vali/Simple_function.pyx":1623
 *     if not window_size=='Error':
 *         alt_seq=ref_seq[:flank_length]+reverse(complementary(ref_seq_readin(ref,sv_info[1][0],sv_info[1][2]-flank_length,sv_info[1][2])))
 *         [window_size,window_size_qc]=window_size_refine(alt_seq)             # <<<<<<<<<<<<<<
 *         if not window_size=='Error':
 *             all_reads=simple_del_chop_pacbio_read_simple_short(bam_in,sv_info[0],flank_length)
 */
    __pyx_t_5 = __Pyx_GetModuleGlobalName(__pyx_n_s_window_size_refine); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1623, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __pyx_t_1 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_5))) {
      __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_5);
      if (likely(__pyx_t_1)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
        __Pyx_INCREF(__pyx_t_1);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_5, function);
      }
    }
    if (!__pyx_t_1) {
      __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_v_alt_seq); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1623, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
    } else {
      __pyx_t_16 = PyTuple_New(1+1); if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 1623, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_16);
      __Pyx_GIVEREF(__pyx_t_1); PyTuple_SET_ITEM(__pyx_t_16, 0, __pyx_t_1); __pyx_t_1 = NULL;
      __Pyx_INCREF(__pyx_v_alt_seq);
      __Pyx_GIVEREF(__pyx_v_alt_seq);
      PyTuple_SET_ITEM(__pyx_t_16, 0+1, __pyx_v_alt_seq);
      __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_16, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1623, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __Pyx_DECREF(__pyx_t_16); __pyx_t_16 = 0;
    }
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    if ((likely(PyTuple_CheckExact(__pyx_t_2))) || (PyList_CheckExact(__pyx_t_2))) {
      PyObject* sequence = __pyx_t_2;
      #if CYTHON_COMPILING_IN_CPYTHON
      Py_ssize_t size = Py_SIZE(sequence);
      #else
      Py_ssize_t size = PySequence_Size(sequence);
      #endif
      if (unlikely(size != 2)) {
        if (size > 2) __Pyx_RaiseTooManyValuesError(2);
        else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
        __PYX_ERR(0, 1623, __pyx_L1_error)
      }
      #if CYTHON_COMPILING_IN_CPYTHON
      if (likely(PyTuple_CheckExact(sequence))) {
        __pyx_t_5 = PyTuple_GET_ITEM(sequence, 0); 
        __pyx_t_16 = PyTuple_GET_ITEM(sequence, 1); 
      } else {
        __pyx_t_5 = PyList_GET_ITEM(sequence, 0); 
        __pyx_t_16 = PyList_GET_ITEM(sequence, 1); 
      }
      __Pyx_INCREF(__pyx_t_5);
      __Pyx_INCREF(__pyx_t_16);
      #else
      __pyx_t_5 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1623, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_5);
      __pyx_t_16 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 1623, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_16);
      #endif
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    } else {
      Py_ssize_t index = -1;
      __pyx_t_1 = PyObject_GetIter(__pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1623, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_9 = Py_TYPE(__pyx_t_1)->tp_iternext;
      index = 0; __pyx_t_5 = __pyx_t_9(__pyx_t_1); if (unlikely(!__pyx_t_5)) goto __pyx_L6_unpacking_failed;
      __Pyx_GOTREF(__pyx_t_5);
      index = 1; __pyx_t_16 = __pyx_t_9(__pyx_t_1); if (unlikely(!__pyx_t_16)) goto __pyx_L6_unpacking_failed;
      __Pyx_GOTREF(__pyx_t_16);
      if (__Pyx_IternextUnpackEndCheck(__pyx_t_9(__pyx_t_1), 2) < 0) __PYX_ERR(0, 1623, __pyx_L1_error)
      __pyx_t_9 = NULL;
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      goto __pyx_L7_unpacking_done;
      __pyx_L6_unpacking_failed:;
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_9 = NULL;
      if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
      __PYX_ERR(0, 1623, __pyx_L1_error)
      __pyx_L7_unpacking_done:;
    }
    __Pyx_DECREF_SET(__pyx_v_window_size, __pyx_t_5);
    __pyx_t_5 = 0;
    __Pyx_DECREF_SET(__pyx_v_window_size_qc, __pyx_t_16);
    __pyx_t_16 = 0;

    /* "vapor_vali/Simple_function.pyx":1624
 *         alt_seq=ref_seq[:flank_length]+reverse(complementary(ref_seq_readin(ref,sv_info[1][0],sv_info[1][2]-flank_length,sv_info[1][2])))
 *         [window_size,window_size_qc]=window_size_refine(alt_seq)
 *         if not window_size=='Error':             # <<<<<<<<<<<<<<
 *             all_reads=simple_del_chop_pacbio_read_simple_short(bam_in,sv_info[0],flank_length)
 *             if len(all_reads)>0:
 */
    __pyx_t_11 = (__Pyx_PyString_Equals(__pyx_v_window_size, __pyx_n_s_Error, Py_EQ)); if (unlikely(__pyx_t_11 < 0)) __PYX_ERR(0, 1624, __pyx_L1_error)
    __pyx_t_10 = ((!__pyx_t_11) != 0);
    if (__pyx_t_10) {

      /* "vapor_vali/Simple_function.pyx":1625
 *         [window_size,window_size_qc]=window_size_refine(alt_seq)
 *         if not window_size=='Error':
 *             all_reads=simple_del_chop_pacbio_read_simple_short(bam_in,sv_info[0],flank_length)             # <<<<<<<<<<<<<<
 *             if len(all_reads)>0:
 *                 best_read_rec=''
 */
      __pyx_t_16 = __Pyx_GetModuleGlobalName(__pyx_n_s_simple_del_chop_pacbio_read_simp); if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 1625, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_16);
      __pyx_t_5 = __Pyx_GetItemInt(__pyx_v_sv_info, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1625, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_5);
      __pyx_t_1 = NULL;
      __pyx_t_7 = 0;
      if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_16))) {
        __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_16);
        if (likely(__pyx_t_1)) {
          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_16);
          __Pyx_INCREF(__pyx_t_1);
          __Pyx_INCREF(function);
          __Pyx_DECREF_SET(__pyx_t_16, function);
          __pyx_t_7 = 1;
        }
      }
      __pyx_t_8 = PyTuple_New(3+__pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1625, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_8);
      if (__pyx_t_1) {
        __Pyx_GIVEREF(__pyx_t_1); PyTuple_SET_ITEM(__pyx_t_8, 0, __pyx_t_1); __pyx_t_1 = NULL;
      }
      __Pyx_INCREF(__pyx_v_bam_in);
      __Pyx_GIVEREF(__pyx_v_bam_in);
      PyTuple_SET_ITEM(__pyx_t_8, 0+__pyx_t_7, __pyx_v_bam_in);
      __Pyx_GIVEREF(__pyx_t_5);
      PyTuple_SET_ITEM(__pyx_t_8, 1+__pyx_t_7, __pyx_t_5);
      __Pyx_INCREF(__pyx_v_flank_length);
      __Pyx_GIVEREF(__pyx_v_flank_length);
      PyTuple_SET_ITEM(__pyx_t_8, 2+__pyx_t_7, __pyx_v_flank_length);
      __pyx_t_5 = 0;
      __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_16, __pyx_t_8, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1625, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
      __Pyx_DECREF(__pyx_t_16); __pyx_t_16 = 0;
      __pyx_v_all_reads = __pyx_t_2;
      __pyx_t_2 = 0;

      /* "vapor_vali/Simple_function.pyx":1626
 *         if not window_size=='Error':
 *             all_reads=simple_del_chop_pacbio_read_simple_short(bam_in,sv_info[0],flank_length)
 *             if len(all_reads)>0:             # <<<<<<<<<<<<<<
 *                 best_read_rec=''
 *                 for x in all_reads:
 */
      __pyx_t_7 = PyObject_Length(__pyx_v_all_reads); if (unlikely(__pyx_t_7 == -1)) __PYX_ERR(0, 1626, __pyx_L1_error)
      __pyx_t_10 = ((__pyx_t_7 > 0) != 0);
      if (__pyx_t_10) {

        /* "vapor_vali/Simple_function.pyx":1627
 *             all_reads=simple_del_chop_pacbio_read_simple_short(bam_in,sv_info[0],flank_length)
 *             if len(all_reads)>0:
 *                 best_read_rec=''             # <<<<<<<<<<<<<<
 *                 for x in all_reads:
 *                     vapor_single_read_score=calcu_vapor_single_read_score_within_10Perc_m1b(ref_seq,alt_seq,x,window_size)
 */
        __Pyx_INCREF(__pyx_kp_s__24);
        __Pyx_DECREF_SET(__pyx_v_best_read_rec, __pyx_kp_s__24);

        /* "vapor_vali/Simple_function.pyx":1628
 *             if len(all_reads)>0:
 *                 best_read_rec=''
 *                 for x in all_reads:             # <<<<<<<<<<<<<<
 *                     vapor_single_read_score=calcu_vapor_single_read_score_within_10Perc_m1b(ref_seq,alt_seq,x,window_size)
 *                     if not 0 in vapor_single_read_score:
 */
        if (likely(PyList_CheckExact(__pyx_v_all_reads)) || PyTuple_CheckExact(__pyx_v_all_reads)) {
          __pyx_t_2 = __pyx_v_all_reads; __Pyx_INCREF(__pyx_t_2); __pyx_t_7 = 0;
          __pyx_t_17 = NULL;
        } else {
          __pyx_t_7 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_v_all_reads); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1628, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_2);
          __pyx_t_17 = Py_TYPE(__pyx_t_2)->tp_iternext; if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 1628, __pyx_L1_error)
        }
        for (;;) {
          if (likely(!__pyx_t_17)) {
            if (likely(PyList_CheckExact(__pyx_t_2))) {
              if (__pyx_t_7 >= PyList_GET_SIZE(__pyx_t_2)) break;
              #if CYTHON_COMPILING_IN_CPYTHON
              __pyx_t_16 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_7); __Pyx_INCREF(__pyx_t_16); __pyx_t_7++; if (unlikely(0 < 0)) __PYX_ERR(0, 1628, __pyx_L1_error)
              #else
              __pyx_t_16 = PySequence_ITEM(__pyx_t_2, __pyx_t_7); __pyx_t_7++; if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 1628, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_16);
              #endif
            } else {
              if (__pyx_t_7 >= PyTuple_GET_SIZE(__pyx_t_2)) break;
              #if CYTHON_COMPILING_IN_CPYTHON
              __pyx_t_16 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_7); __Pyx_INCREF(__pyx_t_16); __pyx_t_7++; if (unlikely(0 < 0)) __PYX_ERR(0, 1628, __pyx_L1_error)
              #else
              __pyx_t_16 = PySequence_ITEM(__pyx_t_2, __pyx_t_7); __pyx_t_7++; if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 1628, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_16);
              #endif
            }
          } else {
            __pyx_t_16 = __pyx_t_17(__pyx_t_2);
            if (unlikely(!__pyx_t_16)) {
              PyObject* exc_type = PyErr_Occurred();
              if (exc_type) {
                if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
                else __PYX_ERR(0, 1628, __pyx_L1_error)
              }
              break;
            }
            __Pyx_GOTREF(__pyx_t_16);
          }
          __Pyx_XDECREF_SET(__pyx_v_x, __pyx_t_16);
          __pyx_t_16 = 0;

          /* "vapor_vali/Simple_function.pyx":1629
 *                 best_read_rec=''
 *                 for x in all_reads:
 *                     vapor_single_read_score=calcu_vapor_single_read_score_within_10Perc_m1b(ref_seq,alt_seq,x,window_size)             # <<<<<<<<<<<<<<
 *                     if not 0 in vapor_single_read_score:
 *                         vapor_score_list.append(1-float(vapor_single_read_score[1])/float(vapor_single_read_score[0]))
 */
          __pyx_t_8 = __Pyx_GetModuleGlobalName(__pyx_n_s_calcu_vapor_single_read_score_wi); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1629, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_8);
          __pyx_t_5 = NULL;
          __pyx_t_18 = 0;
          if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_8))) {
            __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_8);
            if (likely(__pyx_t_5)) {
              PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_8);
              __Pyx_INCREF(__pyx_t_5);
              __Pyx_INCREF(function);
              __Pyx_DECREF_SET(__pyx_t_8, function);
              __pyx_t_18 = 1;
            }
          }
          __pyx_t_1 = PyTuple_New(4+__pyx_t_18); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1629, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_1);
          if (__pyx_t_5) {
            __Pyx_GIVEREF(__pyx_t_5); PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_5); __pyx_t_5 = NULL;
          }
          __Pyx_INCREF(__pyx_v_ref_seq);
          __Pyx_GIVEREF(__pyx_v_ref_seq);
          PyTuple_SET_ITEM(__pyx_t_1, 0+__pyx_t_18, __pyx_v_ref_seq);
          __Pyx_INCREF(__pyx_v_alt_seq);
          __Pyx_GIVEREF(__pyx_v_alt_seq);
          PyTuple_SET_ITEM(__pyx_t_1, 1+__pyx_t_18, __pyx_v_alt_seq);
          __Pyx_INCREF(__pyx_v_x);
          __Pyx_GIVEREF(__pyx_v_x);
          PyTuple_SET_ITEM(__pyx_t_1, 2+__pyx_t_18, __pyx_v_x);
          __Pyx_INCREF(__pyx_v_window_size);
          __Pyx_GIVEREF(__pyx_v_window_size);
          PyTuple_SET_ITEM(__pyx_t_1, 3+__pyx_t_18, __pyx_v_window_size);
          __pyx_t_16 = __Pyx_PyObject_Call(__pyx_t_8, __pyx_t_1, NULL); if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 1629, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_16);
          __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
          __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
          __Pyx_XDECREF_SET(__pyx_v_vapor_single_read_score, __pyx_t_16);
          __pyx_t_16 = 0;

          /* "vapor_vali/Simple_function.pyx":1630
 *                 for x in all_reads:
 *                     vapor_single_read_score=calcu_vapor_single_read_score_within_10Perc_m1b(ref_seq,alt_seq,x,window_size)
 *                     if not 0 in vapor_single_read_score:             # <<<<<<<<<<<<<<
 *                         vapor_score_list.append(1-float(vapor_single_read_score[1])/float(vapor_single_read_score[0]))
 *                         if vapor_score_list[-1]==max(vapor_score_list):best_read_rec=x
 */
          __pyx_t_10 = (__Pyx_PySequence_ContainsTF(__pyx_int_0, __pyx_v_vapor_single_read_score, Py_NE)); if (unlikely(__pyx_t_10 < 0)) __PYX_ERR(0, 1630, __pyx_L1_error)
          __pyx_t_11 = (__pyx_t_10 != 0);
          if (__pyx_t_11) {

            /* "vapor_vali/Simple_function.pyx":1631
 *                     vapor_single_read_score=calcu_vapor_single_read_score_within_10Perc_m1b(ref_seq,alt_seq,x,window_size)
 *                     if not 0 in vapor_single_read_score:
 *                         vapor_score_list.append(1-float(vapor_single_read_score[1])/float(vapor_single_read_score[0]))             # <<<<<<<<<<<<<<
 *                         if vapor_score_list[-1]==max(vapor_score_list):best_read_rec=x
 *                 make_event_figure_1(vapor_score_list,best_read_rec,window_size,ref_seq,alt_seq,out_figure_name)
 */
            __pyx_t_16 = __Pyx_GetItemInt(__pyx_v_vapor_single_read_score, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 1631, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_16);
            __pyx_t_19 = __Pyx_PyObject_AsDouble(__pyx_t_16); if (unlikely(__pyx_t_19 == ((double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1631, __pyx_L1_error)
            __Pyx_DECREF(__pyx_t_16); __pyx_t_16 = 0;
            __pyx_t_16 = __Pyx_GetItemInt(__pyx_v_vapor_single_read_score, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 1631, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_16);
            __pyx_t_20 = __Pyx_PyObject_AsDouble(__pyx_t_16); if (unlikely(__pyx_t_20 == ((double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1631, __pyx_L1_error)
            __Pyx_DECREF(__pyx_t_16); __pyx_t_16 = 0;
            if (unlikely(__pyx_t_20 == 0)) {
              PyErr_SetString(PyExc_ZeroDivisionError, "float division");
              __PYX_ERR(0, 1631, __pyx_L1_error)
            }
            __pyx_t_16 = PyFloat_FromDouble((1.0 - (__pyx_t_19 / __pyx_t_20))); if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 1631, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_16);
            __pyx_t_21 = __Pyx_PyList_Append(__pyx_v_vapor_score_list, __pyx_t_16); if (unlikely(__pyx_t_21 == -1)) __PYX_ERR(0, 1631, __pyx_L1_error)
            __Pyx_DECREF(__pyx_t_16); __pyx_t_16 = 0;

            /* "vapor_vali/Simple_function.pyx":1632
 *                     if not 0 in vapor_single_read_score:
 *                         vapor_score_list.append(1-float(vapor_single_read_score[1])/float(vapor_single_read_score[0]))
 *                         if vapor_score_list[-1]==max(vapor_score_list):best_read_rec=x             # <<<<<<<<<<<<<<
 *                 make_event_figure_1(vapor_score_list,best_read_rec,window_size,ref_seq,alt_seq,out_figure_name)
 *     return vapor_score_list
 */
            __pyx_t_16 = __Pyx_GetItemInt_List(__pyx_v_vapor_score_list, -1L, long, 1, __Pyx_PyInt_From_long, 1, 1, 1); if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 1632, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_16);
            __pyx_t_8 = PyTuple_New(1); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1632, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_8);
            __Pyx_INCREF(__pyx_v_vapor_score_list);
            __Pyx_GIVEREF(__pyx_v_vapor_score_list);
            PyTuple_SET_ITEM(__pyx_t_8, 0, __pyx_v_vapor_score_list);
            __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_max, __pyx_t_8, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1632, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_1);
            __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
            __pyx_t_8 = PyObject_RichCompare(__pyx_t_16, __pyx_t_1, Py_EQ); __Pyx_XGOTREF(__pyx_t_8); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1632, __pyx_L1_error)
            __Pyx_DECREF(__pyx_t_16); __pyx_t_16 = 0;
            __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
            __pyx_t_11 = __Pyx_PyObject_IsTrue(__pyx_t_8); if (unlikely(__pyx_t_11 < 0)) __PYX_ERR(0, 1632, __pyx_L1_error)
            __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
            if (__pyx_t_11) {
              __Pyx_INCREF(__pyx_v_x);
              __Pyx_DECREF_SET(__pyx_v_best_read_rec, __pyx_v_x);
            }

            /* "vapor_vali/Simple_function.pyx":1630
 *                 for x in all_reads:
 *                     vapor_single_read_score=calcu_vapor_single_read_score_within_10Perc_m1b(ref_seq,alt_seq,x,window_size)
 *                     if not 0 in vapor_single_read_score:             # <<<<<<<<<<<<<<
 *                         vapor_score_list.append(1-float(vapor_single_read_score[1])/float(vapor_single_read_score[0]))
 *                         if vapor_score_list[-1]==max(vapor_score_list):best_read_rec=x
 */
          }

          /* "vapor_vali/Simple_function.pyx":1628
 *             if len(all_reads)>0:
 *                 best_read_rec=''
 *                 for x in all_reads:             # <<<<<<<<<<<<<<
 *                     vapor_single_read_score=calcu_vapor_single_read_score_within_10Perc_m1b(ref_seq,alt_seq,x,window_size)
 *                     if not 0 in vapor_single_read_score:
 */
        }
        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

        /* "vapor_vali/Simple_function.pyx":1633
 *                         vapor_score_list.append(1-float(vapor_single_read_score[1])/float(vapor_single_read_score[0]))
 *                         if vapor_score_list[-1]==max(vapor_score_list):best_read_rec=x
 *                 make_event_figure_1(vapor_score_list,best_read_rec,window_size,ref_seq,alt_seq,out_figure_name)             # <<<<<<<<<<<<<<
 *     return vapor_score_list
 * 
 */
        __pyx_t_8 = __Pyx_GetModuleGlobalName(__pyx_n_s_make_event_figure_1); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1633, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_8);
        __pyx_t_1 = NULL;
        __pyx_t_7 = 0;
        if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_8))) {
          __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_8);
          if (likely(__pyx_t_1)) {
            PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_8);
            __Pyx_INCREF(__pyx_t_1);
            __Pyx_INCREF(function);
            __Pyx_DECREF_SET(__pyx_t_8, function);
            __pyx_t_7 = 1;
          }
        }
        __pyx_t_16 = PyTuple_New(6+__pyx_t_7); if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 1633, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_16);
        if (__pyx_t_1) {
          __Pyx_GIVEREF(__pyx_t_1); PyTuple_SET_ITEM(__pyx_t_16, 0, __pyx_t_1); __pyx_t_1 = NULL;
        }
        __Pyx_INCREF(__pyx_v_vapor_score_list);
        __Pyx_GIVEREF(__pyx_v_vapor_score_list);
        PyTuple_SET_ITEM(__pyx_t_16, 0+__pyx_t_7, __pyx_v_vapor_score_list);
        __Pyx_INCREF(__pyx_v_best_read_rec);
        __Pyx_GIVEREF(__pyx_v_best_read_rec);
        PyTuple_SET_ITEM(__pyx_t_16, 1+__pyx_t_7, __pyx_v_best_read_rec);
        __Pyx_INCREF(__pyx_v_window_size);
        __Pyx_GIVEREF(__pyx_v_window_size);
        PyTuple_SET_ITEM(__pyx_t_16, 2+__pyx_t_7, __pyx_v_window_size);
        __Pyx_INCREF(__pyx_v_ref_seq);
        __Pyx_GIVEREF(__pyx_v_ref_seq);
        PyTuple_SET_ITEM(__pyx_t_16, 3+__pyx_t_7, __pyx_v_ref_seq);
        __Pyx_INCREF(__pyx_v_alt_seq);
        __Pyx_GIVEREF(__pyx_v_alt_seq);
        PyTuple_SET_ITEM(__pyx_t_16, 4+__pyx_t_7, __pyx_v_alt_seq);
        __Pyx_INCREF(__pyx_v_out_figure_name);
        __Pyx_GIVEREF(__pyx_v_out_figure_name);
        PyTuple_SET_ITEM(__pyx_t_16, 5+__pyx_t_7, __pyx_v_out_figure_name);
        __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_8, __pyx_t_16, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1633, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
        __Pyx_DECREF(__pyx_t_16); __pyx_t_16 = 0;
        __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

        /* "vapor_vali/Simple_function.pyx":1626
 *         if not window_size=='Error':
 *             all_reads=simple_del_chop_pacbio_read_simple_short(bam_in,sv_info[0],flank_length)
 *             if len(all_reads)>0:             # <<<<<<<<<<<<<<
 *                 best_read_rec=''
 *                 for x in all_reads:
 */
      }

      /* "vapor_vali/Simple_function.pyx":1624
 *         alt_seq=ref_seq[:flank_length]+reverse(complementary(ref_seq_readin(ref,sv_info[1][0],sv_info[1][2]-flank_length,sv_info[1][2])))
 *         [window_size,window_size_qc]=window_size_refine(alt_seq)
 *         if not window_size=='Error':             # <<<<<<<<<<<<<<
 *             all_reads=simple_del_chop_pacbio_read_simple_short(bam_in,sv_info[0],flank_length)
 *             if len(all_reads)>0:
 */
    }

    /* "vapor_vali/Simple_function.pyx":1621
 *     ref_seq=ref_seq_readin(ref,sv_info[0][0],sv_info[0][1]-flank_length,sv_info[1][1]+flank_length)
 *     [window_size,window_size_qc]=window_size_refine(ref_seq)
 *     if not window_size=='Error':             # <<<<<<<<<<<<<<
 *         alt_seq=ref_seq[:flank_length]+reverse(complementary(ref_seq_readin(ref,sv_info[1][0],sv_info[1][2]-flank_length,sv_info[1][2])))
 *         [window_size,window_size_qc]=window_size_refine(alt_seq)
 */
  }

  /* "vapor_vali/Simple_function.pyx":1634
 *                         if vapor_score_list[-1]==max(vapor_score_list):best_read_rec=x
 *                 make_event_figure_1(vapor_score_list,best_read_rec,window_size,ref_seq,alt_seq,out_figure_name)
 *     return vapor_score_list             # <<<<<<<<<<<<<<
 * 
 * def vapor_simple_del_Vapor(bam_in,ref,sv_info,out_figure_name):
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_vapor_score_list);
  __pyx_r = __pyx_v_vapor_score_list;
  goto __pyx_L0;

  /* "vapor_vali/Simple_function.pyx":1614
 *     return vapor_score_list
 * 
 * def vapor_long_del_inv(bam_in,ref,sv_info,out_figure_name):             # <<<<<<<<<<<<<<
 *     #eg of sv_info=[['chr19', 46275941, 46314150, 'del'], ['chr19', 46314150, 46314312, 'inv']]
 *     vapor_score_list=[]
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_XDECREF(__pyx_t_8);
  __Pyx_XDECREF(__pyx_t_12);
  __Pyx_XDECREF(__pyx_t_13);
  __Pyx_XDECREF(__pyx_t_14);
  __Pyx_XDECREF(__pyx_t_15);
  __Pyx_XDECREF(__pyx_t_16);
  __Pyx_AddTraceback("vapor_vali.Simple_function.vapor_long_del_inv", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_vapor_score_list);
  __Pyx_XDECREF(__pyx_v_best_read_rec);
  __Pyx_XDECREF(__pyx_v_flank_length);
  __Pyx_XDECREF(__pyx_v_ref_seq);
  __Pyx_XDECREF(__pyx_v_window_size);
  __Pyx_XDECREF(__pyx_v_window_size_qc);
  __Pyx_XDECREF(__pyx_v_alt_seq);
  __Pyx_XDECREF(__pyx_v_all_reads);
  __Pyx_XDECREF(__pyx_v_x);
  __Pyx_XDECREF(__pyx_v_vapor_single_read_score);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "vapor_vali/Simple_function.pyx":1636
 *     return vapor_score_list
 * 
 * def vapor_simple_del_Vapor(bam_in,ref,sv_info,out_figure_name):             # <<<<<<<<<<<<<<
 *     #eg of sv_info=['chr1', 101553562, 101553905]
 *     flank_length=flank_length_calculate(sv_info)
 */

/* Python wrapper */
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_209vapor_simple_del_Vapor(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_10vapor_vali_15Simple_function_209vapor_simple_del_Vapor = {"vapor_simple_del_Vapor", (PyCFunction)__pyx_pw_10vapor_vali_15Simple_function_209vapor_simple_del_Vapor, METH_VARARGS|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_209vapor_simple_del_Vapor(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_bam_in = 0;
  PyObject *__pyx_v_ref = 0;
  PyObject *__pyx_v_sv_info = 0;
  PyObject *__pyx_v_out_figure_name = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("vapor_simple_del_Vapor (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_bam_in,&__pyx_n_s_ref,&__pyx_n_s_sv_info,&__pyx_n_s_out_figure_name,0};
    PyObject* values[4] = {0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
      switch (pos_args) {
        case  4: values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
        case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_bam_in)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_ref)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("vapor_simple_del_Vapor", 1, 4, 4, 1); __PYX_ERR(0, 1636, __pyx_L3_error)
        }
        case  2:
        if (likely((values[2] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_sv_info)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("vapor_simple_del_Vapor", 1, 4, 4, 2); __PYX_ERR(0, 1636, __pyx_L3_error)
        }
        case  3:
        if (likely((values[3] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_out_figure_name)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("vapor_simple_del_Vapor", 1, 4, 4, 3); __PYX_ERR(0, 1636, __pyx_L3_error)
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "vapor_simple_del_Vapor") < 0)) __PYX_ERR(0, 1636, __pyx_L3_error)
      }
    } else if (PyTuple_GET_SIZE(__pyx_args) != 4) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
      values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
    }
    __pyx_v_bam_in = values[0];
    __pyx_v_ref = values[1];
    __pyx_v_sv_info = values[2];
    __pyx_v_out_figure_name = values[3];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("vapor_simple_del_Vapor", 1, 4, 4, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1636, __pyx_L3_error)
  __pyx_L3_error:;
  __Pyx_AddTraceback("vapor_vali.Simple_function.vapor_simple_del_Vapor", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_10vapor_vali_15Simple_function_208vapor_simple_del_Vapor(__pyx_self, __pyx_v_bam_in, __pyx_v_ref, __pyx_v_sv_info, __pyx_v_out_figure_name);

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10vapor_vali_15Simple_function_208vapor_simple_del_Vapor(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_bam_in, PyObject *__pyx_v_ref, PyObject *__pyx_v_sv_info, PyObject *__pyx_v_out_figure_name) {
  PyObject *__pyx_v_flank_length = NULL;
  PyObject *__pyx_v_vapor_score_list = NULL;
  PyObject *__pyx_v_best_read_rec = NULL;
  PyObject *__pyx_v_all_reads = NULL;
  PyObject *__pyx_v_ref_seq = NULL;
  PyObject *__pyx_v_window_size = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_window_size_qc = NULL;
  PyObject *__pyx_v_alt_seq = NULL;
  PyObject *__pyx_v_x = NULL;
  PyObject *__pyx_v_vapor_single_read_score = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  int __pyx_t_5;
  Py_ssize_t __pyx_t_6;
  PyObject *__pyx_t_7 = NULL;
  PyObject *__pyx_t_8 = NULL;
  PyObject *__pyx_t_9 = NULL;
  PyObject *(*__pyx_t_10)(PyObject *);
  int __pyx_t_11;
  PyObject *(*__pyx_t_12)(PyObject *);
  Py_ssize_t __pyx_t_13;
  double __pyx_t_14;
  double __pyx_t_15;
  int __pyx_t_16;
  PyObject *__pyx_t_17 = NULL;
  __Pyx_RefNannySetupContext("vapor_simple_del_Vapor", 0);

  /* "vapor_vali/Simple_function.pyx":1638
 * def vapor_simple_del_Vapor(bam_in,ref,sv_info,out_figure_name):
 *     #eg of sv_info=['chr1', 101553562, 101553905]
 *     flank_length=flank_length_calculate(sv_info)             # <<<<<<<<<<<<<<
 *     vapor_score_list=[]
 *     best_read_rec=''
 */
  __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_flank_length_calculate); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1638, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_3);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_2, function);
    }
  }
  if (!__pyx_t_3) {
    __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_v_sv_info); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1638, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
  } else {
    __pyx_t_4 = PyTuple_New(1+1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1638, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_GIVEREF(__pyx_t_3); PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3); __pyx_t_3 = NULL;
    __Pyx_INCREF(__pyx_v_sv_info);
    __Pyx_GIVEREF(__pyx_v_sv_info);
    PyTuple_SET_ITEM(__pyx_t_4, 0+1, __pyx_v_sv_info);
    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_4, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1638, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  }
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_flank_length = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":1639
 *     #eg of sv_info=['chr1', 101553562, 101553905]
 *     flank_length=flank_length_calculate(sv_info)
 *     vapor_score_list=[]             # <<<<<<<<<<<<<<
 *     best_read_rec=''
 *     if sv_info[2]-sv_info[1]<default_max_sv_test: #only try to read in all reads with sv <100K; else: try breakpoints ;
 */
  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1639, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_vapor_score_list = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":1640
 *     flank_length=flank_length_calculate(sv_info)
 *     vapor_score_list=[]
 *     best_read_rec=''             # <<<<<<<<<<<<<<
 *     if sv_info[2]-sv_info[1]<default_max_sv_test: #only try to read in all reads with sv <100K; else: try breakpoints ;
 *         all_reads=simple_del_chop_pacbio_read_simple_short(bam_in,sv_info,flank_length)
 */
  __Pyx_INCREF(__pyx_kp_s__24);
  __pyx_v_best_read_rec = __pyx_kp_s__24;

  /* "vapor_vali/Simple_function.pyx":1641
 *     vapor_score_list=[]
 *     best_read_rec=''
 *     if sv_info[2]-sv_info[1]<default_max_sv_test: #only try to read in all reads with sv <100K; else: try breakpoints ;             # <<<<<<<<<<<<<<
 *         all_reads=simple_del_chop_pacbio_read_simple_short(bam_in,sv_info,flank_length)
 *         if len(all_reads)>0:
 */
  __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_sv_info, 2, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1641, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_sv_info, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1641, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_4 = PyNumber_Subtract(__pyx_t_1, __pyx_t_2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1641, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_default_max_sv_test); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1641, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_1 = PyObject_RichCompare(__pyx_t_4, __pyx_t_2, Py_LT); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1641, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 1641, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  if (__pyx_t_5) {

    /* "vapor_vali/Simple_function.pyx":1642
 *     best_read_rec=''
 *     if sv_info[2]-sv_info[1]<default_max_sv_test: #only try to read in all reads with sv <100K; else: try breakpoints ;
 *         all_reads=simple_del_chop_pacbio_read_simple_short(bam_in,sv_info,flank_length)             # <<<<<<<<<<<<<<
 *         if len(all_reads)>0:
 *             ref_seq=ref_seq_readin(ref,sv_info[0],sv_info[1]-flank_length,sv_info[2]+flank_length)
 */
    __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_simple_del_chop_pacbio_read_simp); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1642, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_4 = NULL;
    __pyx_t_6 = 0;
    if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_2))) {
      __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_2);
      if (likely(__pyx_t_4)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
        __Pyx_INCREF(__pyx_t_4);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_2, function);
        __pyx_t_6 = 1;
      }
    }
    __pyx_t_3 = PyTuple_New(3+__pyx_t_6); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1642, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    if (__pyx_t_4) {
      __Pyx_GIVEREF(__pyx_t_4); PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_4); __pyx_t_4 = NULL;
    }
    __Pyx_INCREF(__pyx_v_bam_in);
    __Pyx_GIVEREF(__pyx_v_bam_in);
    PyTuple_SET_ITEM(__pyx_t_3, 0+__pyx_t_6, __pyx_v_bam_in);
    __Pyx_INCREF(__pyx_v_sv_info);
    __Pyx_GIVEREF(__pyx_v_sv_info);
    PyTuple_SET_ITEM(__pyx_t_3, 1+__pyx_t_6, __pyx_v_sv_info);
    __Pyx_INCREF(__pyx_v_flank_length);
    __Pyx_GIVEREF(__pyx_v_flank_length);
    PyTuple_SET_ITEM(__pyx_t_3, 2+__pyx_t_6, __pyx_v_flank_length);
    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_3, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1642, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_v_all_reads = __pyx_t_1;
    __pyx_t_1 = 0;

    /* "vapor_vali/Simple_function.pyx":1643
 *     if sv_info[2]-sv_info[1]<default_max_sv_test: #only try to read in all reads with sv <100K; else: try breakpoints ;
 *         all_reads=simple_del_chop_pacbio_read_simple_short(bam_in,sv_info,flank_length)
 *         if len(all_reads)>0:             # <<<<<<<<<<<<<<
 *             ref_seq=ref_seq_readin(ref,sv_info[0],sv_info[1]-flank_length,sv_info[2]+flank_length)
 *             [window_size,window_size_qc]=window_size_refine(ref_seq)
 */
    __pyx_t_6 = PyObject_Length(__pyx_v_all_reads); if (unlikely(__pyx_t_6 == -1)) __PYX_ERR(0, 1643, __pyx_L1_error)
    __pyx_t_5 = ((__pyx_t_6 > 0) != 0);
    if (__pyx_t_5) {

      /* "vapor_vali/Simple_function.pyx":1644
 *         all_reads=simple_del_chop_pacbio_read_simple_short(bam_in,sv_info,flank_length)
 *         if len(all_reads)>0:
 *             ref_seq=ref_seq_readin(ref,sv_info[0],sv_info[1]-flank_length,sv_info[2]+flank_length)             # <<<<<<<<<<<<<<
 *             [window_size,window_size_qc]=window_size_refine(ref_seq)
 *             if not window_size=='Error':
 */
      __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_ref_seq_readin); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1644, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_sv_info, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1644, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __pyx_t_4 = __Pyx_GetItemInt(__pyx_v_sv_info, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1644, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_t_7 = PyNumber_Subtract(__pyx_t_4, __pyx_v_flank_length); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1644, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_7);
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_4 = __Pyx_GetItemInt(__pyx_v_sv_info, 2, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1644, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_t_8 = PyNumber_Add(__pyx_t_4, __pyx_v_flank_length); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1644, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_8);
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_4 = NULL;
      __pyx_t_6 = 0;
      if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_2))) {
        __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_2);
        if (likely(__pyx_t_4)) {
          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
          __Pyx_INCREF(__pyx_t_4);
          __Pyx_INCREF(function);
          __Pyx_DECREF_SET(__pyx_t_2, function);
          __pyx_t_6 = 1;
        }
      }
      __pyx_t_9 = PyTuple_New(4+__pyx_t_6); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1644, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_9);
      if (__pyx_t_4) {
        __Pyx_GIVEREF(__pyx_t_4); PyTuple_SET_ITEM(__pyx_t_9, 0, __pyx_t_4); __pyx_t_4 = NULL;
      }
      __Pyx_INCREF(__pyx_v_ref);
      __Pyx_GIVEREF(__pyx_v_ref);
      PyTuple_SET_ITEM(__pyx_t_9, 0+__pyx_t_6, __pyx_v_ref);
      __Pyx_GIVEREF(__pyx_t_3);
      PyTuple_SET_ITEM(__pyx_t_9, 1+__pyx_t_6, __pyx_t_3);
      __Pyx_GIVEREF(__pyx_t_7);
      PyTuple_SET_ITEM(__pyx_t_9, 2+__pyx_t_6, __pyx_t_7);
      __Pyx_GIVEREF(__pyx_t_8);
      PyTuple_SET_ITEM(__pyx_t_9, 3+__pyx_t_6, __pyx_t_8);
      __pyx_t_3 = 0;
      __pyx_t_7 = 0;
      __pyx_t_8 = 0;
      __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_9, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1644, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_v_ref_seq = __pyx_t_1;
      __pyx_t_1 = 0;

      /* "vapor_vali/Simple_function.pyx":1645
 *         if len(all_reads)>0:
 *             ref_seq=ref_seq_readin(ref,sv_info[0],sv_info[1]-flank_length,sv_info[2]+flank_length)
 *             [window_size,window_size_qc]=window_size_refine(ref_seq)             # <<<<<<<<<<<<<<
 *             if not window_size=='Error':
 *                 alt_seq=ref_seq[:flank_length]+ref_seq[-flank_length:]
 */
      __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_window_size_refine); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1645, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __pyx_t_9 = NULL;
      if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_2))) {
        __pyx_t_9 = PyMethod_GET_SELF(__pyx_t_2);
        if (likely(__pyx_t_9)) {
          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
          __Pyx_INCREF(__pyx_t_9);
          __Pyx_INCREF(function);
          __Pyx_DECREF_SET(__pyx_t_2, function);
        }
      }
      if (!__pyx_t_9) {
        __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_v_ref_seq); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1645, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
      } else {
        __pyx_t_8 = PyTuple_New(1+1); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1645, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_8);
        __Pyx_GIVEREF(__pyx_t_9); PyTuple_SET_ITEM(__pyx_t_8, 0, __pyx_t_9); __pyx_t_9 = NULL;
        __Pyx_INCREF(__pyx_v_ref_seq);
        __Pyx_GIVEREF(__pyx_v_ref_seq);
        PyTuple_SET_ITEM(__pyx_t_8, 0+1, __pyx_v_ref_seq);
        __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_8, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1645, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
      }
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      if ((likely(PyTuple_CheckExact(__pyx_t_1))) || (PyList_CheckExact(__pyx_t_1))) {
        PyObject* sequence = __pyx_t_1;
        #if CYTHON_COMPILING_IN_CPYTHON
        Py_ssize_t size = Py_SIZE(sequence);
        #else
        Py_ssize_t size = PySequence_Size(sequence);
        #endif
        if (unlikely(size != 2)) {
          if (size > 2) __Pyx_RaiseTooManyValuesError(2);
          else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
          __PYX_ERR(0, 1645, __pyx_L1_error)
        }
        #if CYTHON_COMPILING_IN_CPYTHON
        if (likely(PyTuple_CheckExact(sequence))) {
          __pyx_t_2 = PyTuple_GET_ITEM(sequence, 0); 
          __pyx_t_8 = PyTuple_GET_ITEM(sequence, 1); 
        } else {
          __pyx_t_2 = PyList_GET_ITEM(sequence, 0); 
          __pyx_t_8 = PyList_GET_ITEM(sequence, 1); 
        }
        __Pyx_INCREF(__pyx_t_2);
        __Pyx_INCREF(__pyx_t_8);
        #else
        __pyx_t_2 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1645, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
        __pyx_t_8 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1645, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_8);
        #endif
        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      } else {
        Py_ssize_t index = -1;
        __pyx_t_9 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1645, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_9);
        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
        __pyx_t_10 = Py_TYPE(__pyx_t_9)->tp_iternext;
        index = 0; __pyx_t_2 = __pyx_t_10(__pyx_t_9); if (unlikely(!__pyx_t_2)) goto __pyx_L5_unpacking_failed;
        __Pyx_GOTREF(__pyx_t_2);
        index = 1; __pyx_t_8 = __pyx_t_10(__pyx_t_9); if (unlikely(!__pyx_t_8)) goto __pyx_L5_unpacking_failed;
        __Pyx_GOTREF(__pyx_t_8);
        if (__Pyx_IternextUnpackEndCheck(__pyx_t_10(__pyx_t_9), 2) < 0) __PYX_ERR(0, 1645, __pyx_L1_error)
        __pyx_t_10 = NULL;
        __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
        goto __pyx_L6_unpacking_done;
        __pyx_L5_unpacking_failed:;
        __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
        __pyx_t_10 = NULL;
        if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
        __PYX_ERR(0, 1645, __pyx_L1_error)
        __pyx_L6_unpacking_done:;
      }
      __pyx_v_window_size = __pyx_t_2;
      __pyx_t_2 = 0;
      __pyx_v_window_size_qc = __pyx_t_8;
      __pyx_t_8 = 0;

      /* "vapor_vali/Simple_function.pyx":1646
 *             ref_seq=ref_seq_readin(ref,sv_info[0],sv_info[1]-flank_length,sv_info[2]+flank_length)
 *             [window_size,window_size_qc]=window_size_refine(ref_seq)
 *             if not window_size=='Error':             # <<<<<<<<<<<<<<
 *                 alt_seq=ref_seq[:flank_length]+ref_seq[-flank_length:]
 *                 best_read_rec=''
 */
      __pyx_t_5 = (__Pyx_PyString_Equals(__pyx_v_window_size, __pyx_n_s_Error, Py_EQ)); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 1646, __pyx_L1_error)
      __pyx_t_11 = ((!__pyx_t_5) != 0);
      if (__pyx_t_11) {

        /* "vapor_vali/Simple_function.pyx":1647
 *             [window_size,window_size_qc]=window_size_refine(ref_seq)
 *             if not window_size=='Error':
 *                 alt_seq=ref_seq[:flank_length]+ref_seq[-flank_length:]             # <<<<<<<<<<<<<<
 *                 best_read_rec=''
 *                 for x in all_reads:
 */
        __pyx_t_1 = __Pyx_PyObject_GetSlice(__pyx_v_ref_seq, 0, 0, NULL, &__pyx_v_flank_length, NULL, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1647, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        __pyx_t_8 = PyNumber_Negative(__pyx_v_flank_length); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1647, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_8);
        __pyx_t_2 = __Pyx_PyObject_GetSlice(__pyx_v_ref_seq, 0, 0, &__pyx_t_8, NULL, NULL, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1647, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
        __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
        __pyx_t_8 = PyNumber_Add(__pyx_t_1, __pyx_t_2); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1647, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_8);
        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
        __pyx_v_alt_seq = __pyx_t_8;
        __pyx_t_8 = 0;

        /* "vapor_vali/Simple_function.pyx":1648
 *             if not window_size=='Error':
 *                 alt_seq=ref_seq[:flank_length]+ref_seq[-flank_length:]
 *                 best_read_rec=''             # <<<<<<<<<<<<<<
 *                 for x in all_reads:
 *                     vapor_single_read_score=calcu_vapor_single_read_score_within_10Perc_m1b(ref_seq,alt_seq,x,window_size)
 */
        __Pyx_INCREF(__pyx_kp_s__24);
        __Pyx_DECREF_SET(__pyx_v_best_read_rec, __pyx_kp_s__24);

        /* "vapor_vali/Simple_function.pyx":1649
 *                 alt_seq=ref_seq[:flank_length]+ref_seq[-flank_length:]
 *                 best_read_rec=''
 *                 for x in all_reads:             # <<<<<<<<<<<<<<
 *                     vapor_single_read_score=calcu_vapor_single_read_score_within_10Perc_m1b(ref_seq,alt_seq,x,window_size)
 *                     if not 0 in vapor_single_read_score:
 */
        if (likely(PyList_CheckExact(__pyx_v_all_reads)) || PyTuple_CheckExact(__pyx_v_all_reads)) {
          __pyx_t_8 = __pyx_v_all_reads; __Pyx_INCREF(__pyx_t_8); __pyx_t_6 = 0;
          __pyx_t_12 = NULL;
        } else {
          __pyx_t_6 = -1; __pyx_t_8 = PyObject_GetIter(__pyx_v_all_reads); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1649, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_8);
          __pyx_t_12 = Py_TYPE(__pyx_t_8)->tp_iternext; if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1649, __pyx_L1_error)
        }
        for (;;) {
          if (likely(!__pyx_t_12)) {
            if (likely(PyList_CheckExact(__pyx_t_8))) {
              if (__pyx_t_6 >= PyList_GET_SIZE(__pyx_t_8)) break;
              #if CYTHON_COMPILING_IN_CPYTHON
              __pyx_t_2 = PyList_GET_ITEM(__pyx_t_8, __pyx_t_6); __Pyx_INCREF(__pyx_t_2); __pyx_t_6++; if (unlikely(0 < 0)) __PYX_ERR(0, 1649, __pyx_L1_error)
              #else
              __pyx_t_2 = PySequence_ITEM(__pyx_t_8, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1649, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_2);
              #endif
            } else {
              if (__pyx_t_6 >= PyTuple_GET_SIZE(__pyx_t_8)) break;
              #if CYTHON_COMPILING_IN_CPYTHON
              __pyx_t_2 = PyTuple_GET_ITEM(__pyx_t_8, __pyx_t_6); __Pyx_INCREF(__pyx_t_2); __pyx_t_6++; if (unlikely(0 < 0)) __PYX_ERR(0, 1649, __pyx_L1_error)
              #else
              __pyx_t_2 = PySequence_ITEM(__pyx_t_8, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1649, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_2);
              #endif
            }
          } else {
            __pyx_t_2 = __pyx_t_12(__pyx_t_8);
            if (unlikely(!__pyx_t_2)) {
              PyObject* exc_type = PyErr_Occurred();
              if (exc_type) {
                if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
                else __PYX_ERR(0, 1649, __pyx_L1_error)
              }
              break;
            }
            __Pyx_GOTREF(__pyx_t_2);
          }
          __Pyx_XDECREF_SET(__pyx_v_x, __pyx_t_2);
          __pyx_t_2 = 0;

          /* "vapor_vali/Simple_function.pyx":1650
 *                 best_read_rec=''
 *                 for x in all_reads:
 *                     vapor_single_read_score=calcu_vapor_single_read_score_within_10Perc_m1b(ref_seq,alt_seq,x,window_size)             # <<<<<<<<<<<<<<
 *                     if not 0 in vapor_single_read_score:
 *                         vapor_score_list.append(1-float(vapor_single_read_score[1])/float(vapor_single_read_score[0]))
 */
          __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_calcu_vapor_single_read_score_wi); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1650, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_1);
          __pyx_t_9 = NULL;
          __pyx_t_13 = 0;
          if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_1))) {
            __pyx_t_9 = PyMethod_GET_SELF(__pyx_t_1);
            if (likely(__pyx_t_9)) {
              PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
              __Pyx_INCREF(__pyx_t_9);
              __Pyx_INCREF(function);
              __Pyx_DECREF_SET(__pyx_t_1, function);
              __pyx_t_13 = 1;
            }
          }
          __pyx_t_7 = PyTuple_New(4+__pyx_t_13); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1650, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_7);
          if (__pyx_t_9) {
            __Pyx_GIVEREF(__pyx_t_9); PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_9); __pyx_t_9 = NULL;
          }
          __Pyx_INCREF(__pyx_v_ref_seq);
          __Pyx_GIVEREF(__pyx_v_ref_seq);
          PyTuple_SET_ITEM(__pyx_t_7, 0+__pyx_t_13, __pyx_v_ref_seq);
          __Pyx_INCREF(__pyx_v_alt_seq);
          __Pyx_GIVEREF(__pyx_v_alt_seq);
          PyTuple_SET_ITEM(__pyx_t_7, 1+__pyx_t_13, __pyx_v_alt_seq);
          __Pyx_INCREF(__pyx_v_x);
          __Pyx_GIVEREF(__pyx_v_x);
          PyTuple_SET_ITEM(__pyx_t_7, 2+__pyx_t_13, __pyx_v_x);
          __Pyx_INCREF(__pyx_v_window_size);
          __Pyx_GIVEREF(__pyx_v_window_size);
          PyTuple_SET_ITEM(__pyx_t_7, 3+__pyx_t_13, __pyx_v_window_size);
          __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_7, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1650, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_2);
          __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
          __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
          __Pyx_XDECREF_SET(__pyx_v_vapor_single_read_score, __pyx_t_2);
          __pyx_t_2 = 0;

          /* "vapor_vali/Simple_function.pyx":1651
 *                 for x in all_reads:
 *                     vapor_single_read_score=calcu_vapor_single_read_score_within_10Perc_m1b(ref_seq,alt_seq,x,window_size)
 *                     if not 0 in vapor_single_read_score:             # <<<<<<<<<<<<<<
 *                         vapor_score_list.append(1-float(vapor_single_read_score[1])/float(vapor_single_read_score[0]))
 *                         if vapor_score_list[-1]==max(vapor_score_list):best_read_rec=x
 */
          __pyx_t_11 = (__Pyx_PySequence_ContainsTF(__pyx_int_0, __pyx_v_vapor_single_read_score, Py_NE)); if (unlikely(__pyx_t_11 < 0)) __PYX_ERR(0, 1651, __pyx_L1_error)
          __pyx_t_5 = (__pyx_t_11 != 0);
          if (__pyx_t_5) {

            /* "vapor_vali/Simple_function.pyx":1652
 *                     vapor_single_read_score=calcu_vapor_single_read_score_within_10Perc_m1b(ref_seq,alt_seq,x,window_size)
 *                     if not 0 in vapor_single_read_score:
 *                         vapor_score_list.append(1-float(vapor_single_read_score[1])/float(vapor_single_read_score[0]))             # <<<<<<<<<<<<<<
 *                         if vapor_score_list[-1]==max(vapor_score_list):best_read_rec=x
 *                 make_event_figure_1(vapor_score_list,best_read_rec,window_size,ref_seq,alt_seq,out_figure_name)
 */
            __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_vapor_single_read_score, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1652, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_2);
            __pyx_t_14 = __Pyx_PyObject_AsDouble(__pyx_t_2); if (unlikely(__pyx_t_14 == ((double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1652, __pyx_L1_error)
            __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
            __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_vapor_single_read_score, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1652, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_2);
            __pyx_t_15 = __Pyx_PyObject_AsDouble(__pyx_t_2); if (unlikely(__pyx_t_15 == ((double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1652, __pyx_L1_error)
            __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
            if (unlikely(__pyx_t_15 == 0)) {
              PyErr_SetString(PyExc_ZeroDivisionError, "float division");
              __PYX_ERR(0, 1652, __pyx_L1_error)
            }
            __pyx_t_2 = PyFloat_FromDouble((1.0 - (__pyx_t_14 / __pyx_t_15))); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1652, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_2);
            __pyx_t_16 = __Pyx_PyList_Append(__pyx_v_vapor_score_list, __pyx_t_2); if (unlikely(__pyx_t_16 == -1)) __PYX_ERR(0, 1652, __pyx_L1_error)
            __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

            /* "vapor_vali/Simple_function.pyx":1653
 *                     if not 0 in vapor_single_read_score:
 *                         vapor_score_list.append(1-float(vapor_single_read_score[1])/float(vapor_single_read_score[0]))
 *                         if vapor_score_list[-1]==max(vapor_score_list):best_read_rec=x             # <<<<<<<<<<<<<<
 *                 make_event_figure_1(vapor_score_list,best_read_rec,window_size,ref_seq,alt_seq,out_figure_name)
 *     else:
 */
            __pyx_t_2 = __Pyx_GetItemInt_List(__pyx_v_vapor_score_list, -1L, long, 1, __Pyx_PyInt_From_long, 1, 1, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1653, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_2);
            __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1653, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_1);
            __Pyx_INCREF(__pyx_v_vapor_score_list);
            __Pyx_GIVEREF(__pyx_v_vapor_score_list);
            PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_vapor_score_list);
            __pyx_t_7 = __Pyx_PyObject_Call(__pyx_builtin_max, __pyx_t_1, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1653, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_7);
            __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
            __pyx_t_1 = PyObject_RichCompare(__pyx_t_2, __pyx_t_7, Py_EQ); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1653, __pyx_L1_error)
            __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
            __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
            __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 1653, __pyx_L1_error)
            __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
            if (__pyx_t_5) {
              __Pyx_INCREF(__pyx_v_x);
              __Pyx_DECREF_SET(__pyx_v_best_read_rec, __pyx_v_x);
            }

            /* "vapor_vali/Simple_function.pyx":1651
 *                 for x in all_reads:
 *                     vapor_single_read_score=calcu_vapor_single_read_score_within_10Perc_m1b(ref_seq,alt_seq,x,window_size)
 *                     if not 0 in vapor_single_read_score:             # <<<<<<<<<<<<<<
 *                         vapor_score_list.append(1-float(vapor_single_read_score[1])/float(vapor_single_read_score[0]))
 *                         if vapor_score_list[-1]==max(vapor_score_list):best_read_rec=x
 */
          }

          /* "vapor_vali/Simple_function.pyx":1649
 *                 alt_seq=ref_seq[:flank_length]+ref_seq[-flank_length:]
 *                 best_read_rec=''
 *                 for x in all_reads:             # <<<<<<<<<<<<<<
 *                     vapor_single_read_score=calcu_vapor_single_read_score_within_10Perc_m1b(ref_seq,alt_seq,x,window_size)
 *                     if not 0 in vapor_single_read_score:
 */
        }
        __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;

        /* "vapor_vali/Simple_function.pyx":1654
 *                         vapor_score_list.append(1-float(vapor_single_read_score[1])/float(vapor_single_read_score[0]))
 *                         if vapor_score_list[-1]==max(vapor_score_list):best_read_rec=x
 *                 make_event_figure_1(vapor_score_list,best_read_rec,window_size,ref_seq,alt_seq,out_figure_name)             # <<<<<<<<<<<<<<
 *     else:
 *         #change the way of read in ref seq
 */
        __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_make_event_figure_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1654, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        __pyx_t_7 = NULL;
        __pyx_t_6 = 0;
        if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_1))) {
          __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_1);
          if (likely(__pyx_t_7)) {
            PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
            __Pyx_INCREF(__pyx_t_7);
            __Pyx_INCREF(function);
            __Pyx_DECREF_SET(__pyx_t_1, function);
            __pyx_t_6 = 1;
          }
        }
        __pyx_t_2 = PyTuple_New(6+__pyx_t_6); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1654, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
        if (__pyx_t_7) {
          __Pyx_GIVEREF(__pyx_t_7); PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_7); __pyx_t_7 = NULL;
        }
        __Pyx_INCREF(__pyx_v_vapor_score_list);
        __Pyx_GIVEREF(__pyx_v_vapor_score_list);
        PyTuple_SET_ITEM(__pyx_t_2, 0+__pyx_t_6, __pyx_v_vapor_score_list);
        __Pyx_INCREF(__pyx_v_best_read_rec);
        __Pyx_GIVEREF(__pyx_v_best_read_rec);
        PyTuple_SET_ITEM(__pyx_t_2, 1+__pyx_t_6, __pyx_v_best_read_rec);
        __Pyx_INCREF(__pyx_v_window_size);
        __Pyx_GIVEREF(__pyx_v_window_size);
        PyTuple_SET_ITEM(__pyx_t_2, 2+__pyx_t_6, __pyx_v_window_size);
        __Pyx_INCREF(__pyx_v_ref_seq);
        __Pyx_GIVEREF(__pyx_v_ref_seq);
        PyTuple_SET_ITEM(__pyx_t_2, 3+__pyx_t_6, __pyx_v_ref_seq);
        __Pyx_INCREF(__pyx_v_alt_seq);
        __Pyx_GIVEREF(__pyx_v_alt_seq);
        PyTuple_SET_ITEM(__pyx_t_2, 4+__pyx_t_6, __pyx_v_alt_seq);
        __Pyx_INCREF(__pyx_v_out_figure_name);
        __Pyx_GIVEREF(__pyx_v_out_figure_name);
        PyTuple_SET_ITEM(__pyx_t_2, 5+__pyx_t_6, __pyx_v_out_figure_name);
        __pyx_t_8 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_2, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1654, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_8);
        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
        __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;

        /* "vapor_vali/Simple_function.pyx":1646
 *             ref_seq=ref_seq_readin(ref,sv_info[0],sv_info[1]-flank_length,sv_info[2]+flank_length)
 *             [window_size,window_size_qc]=window_size_refine(ref_seq)
 *             if not window_size=='Error':             # <<<<<<<<<<<<<<
 *                 alt_seq=ref_seq[:flank_length]+ref_seq[-flank_length:]
 *                 best_read_rec=''
 */
      }

      /* "vapor_vali/Simple_function.pyx":1643
 *     if sv_info[2]-sv_info[1]<default_max_sv_test: #only try to read in all reads with sv <100K; else: try breakpoints ;
 *         all_reads=simple_del_chop_pacbio_read_simple_short(bam_in,sv_info,flank_length)
 *         if len(all_reads)>0:             # <<<<<<<<<<<<<<
 *             ref_seq=ref_seq_readin(ref,sv_info[0],sv_info[1]-flank_length,sv_info[2]+flank_length)
 *             [window_size,window_size_qc]=window_size_refine(ref_seq)
 */
    }

    /* "vapor_vali/Simple_function.pyx":1641
 *     vapor_score_list=[]
 *     best_read_rec=''
 *     if sv_info[2]-sv_info[1]<default_max_sv_test: #only try to read in all reads with sv <100K; else: try breakpoints ;             # <<<<<<<<<<<<<<
 *         all_reads=simple_del_chop_pacbio_read_simple_short(bam_in,sv_info,flank_length)
 *         if len(all_reads)>0:
 */
    goto __pyx_L3;
  }

  /* "vapor_vali/Simple_function.pyx":1657
 *     else:
 *         #change the way of read in ref seq
 *         all_reads=simple_del_chop_pacbio_read_simple_short(bam_in,sv_info,flank_length)             # <<<<<<<<<<<<<<
 *         if len(all_reads)>0:
 *             ref_seq=ref_seq_readin(ref,sv_info[0],sv_info[1]-flank_length,sv_info[1]+flank_length)
 */
  /*else*/ {
    __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_simple_del_chop_pacbio_read_simp); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1657, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_2 = NULL;
    __pyx_t_6 = 0;
    if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_1))) {
      __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_1);
      if (likely(__pyx_t_2)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
        __Pyx_INCREF(__pyx_t_2);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_1, function);
        __pyx_t_6 = 1;
      }
    }
    __pyx_t_7 = PyTuple_New(3+__pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1657, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    if (__pyx_t_2) {
      __Pyx_GIVEREF(__pyx_t_2); PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_2); __pyx_t_2 = NULL;
    }
    __Pyx_INCREF(__pyx_v_bam_in);
    __Pyx_GIVEREF(__pyx_v_bam_in);
    PyTuple_SET_ITEM(__pyx_t_7, 0+__pyx_t_6, __pyx_v_bam_in);
    __Pyx_INCREF(__pyx_v_sv_info);
    __Pyx_GIVEREF(__pyx_v_sv_info);
    PyTuple_SET_ITEM(__pyx_t_7, 1+__pyx_t_6, __pyx_v_sv_info);
    __Pyx_INCREF(__pyx_v_flank_length);
    __Pyx_GIVEREF(__pyx_v_flank_length);
    PyTuple_SET_ITEM(__pyx_t_7, 2+__pyx_t_6, __pyx_v_flank_length);
    __pyx_t_8 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_7, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1657, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_8);
    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_v_all_reads = __pyx_t_8;
    __pyx_t_8 = 0;

    /* "vapor_vali/Simple_function.pyx":1658
 *         #change the way of read in ref seq
 *         all_reads=simple_del_chop_pacbio_read_simple_short(bam_in,sv_info,flank_length)
 *         if len(all_reads)>0:             # <<<<<<<<<<<<<<
 *             ref_seq=ref_seq_readin(ref,sv_info[0],sv_info[1]-flank_length,sv_info[1]+flank_length)
 *             [window_size,window_size_qc]=window_size_refine(ref_seq)
 */
    __pyx_t_6 = PyObject_Length(__pyx_v_all_reads); if (unlikely(__pyx_t_6 == -1)) __PYX_ERR(0, 1658, __pyx_L1_error)
    __pyx_t_5 = ((__pyx_t_6 > 0) != 0);
    if (__pyx_t_5) {

      /* "vapor_vali/Simple_function.pyx":1659
 *         all_reads=simple_del_chop_pacbio_read_simple_short(bam_in,sv_info,flank_length)
 *         if len(all_reads)>0:
 *             ref_seq=ref_seq_readin(ref,sv_info[0],sv_info[1]-flank_length,sv_info[1]+flank_length)             # <<<<<<<<<<<<<<
 *             [window_size,window_size_qc]=window_size_refine(ref_seq)
 *             if not window_size=='Error':
 */
      __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_ref_seq_readin); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1659, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __pyx_t_7 = __Pyx_GetItemInt(__pyx_v_sv_info, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1659, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_7);
      __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_sv_info, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1659, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __pyx_t_9 = PyNumber_Subtract(__pyx_t_2, __pyx_v_flank_length); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1659, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_9);
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_sv_info, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1659, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __pyx_t_3 = PyNumber_Add(__pyx_t_2, __pyx_v_flank_length); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1659, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_2 = NULL;
      __pyx_t_6 = 0;
      if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_1))) {
        __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_1);
        if (likely(__pyx_t_2)) {
          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
          __Pyx_INCREF(__pyx_t_2);
          __Pyx_INCREF(function);
          __Pyx_DECREF_SET(__pyx_t_1, function);
          __pyx_t_6 = 1;
        }
      }
      __pyx_t_4 = PyTuple_New(4+__pyx_t_6); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1659, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      if (__pyx_t_2) {
        __Pyx_GIVEREF(__pyx_t_2); PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_2); __pyx_t_2 = NULL;
      }
      __Pyx_INCREF(__pyx_v_ref);
      __Pyx_GIVEREF(__pyx_v_ref);
      PyTuple_SET_ITEM(__pyx_t_4, 0+__pyx_t_6, __pyx_v_ref);
      __Pyx_GIVEREF(__pyx_t_7);
      PyTuple_SET_ITEM(__pyx_t_4, 1+__pyx_t_6, __pyx_t_7);
      __Pyx_GIVEREF(__pyx_t_9);
      PyTuple_SET_ITEM(__pyx_t_4, 2+__pyx_t_6, __pyx_t_9);
      __Pyx_GIVEREF(__pyx_t_3);
      PyTuple_SET_ITEM(__pyx_t_4, 3+__pyx_t_6, __pyx_t_3);
      __pyx_t_7 = 0;
      __pyx_t_9 = 0;
      __pyx_t_3 = 0;
      __pyx_t_8 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_4, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1659, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_8);
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_v_ref_seq = __pyx_t_8;
      __pyx_t_8 = 0;

      /* "vapor_vali/Simple_function.pyx":1660
 *         if len(all_reads)>0:
 *             ref_seq=ref_seq_readin(ref,sv_info[0],sv_info[1]-flank_length,sv_info[1]+flank_length)
 *             [window_size,window_size_qc]=window_size_refine(ref_seq)             # <<<<<<<<<<<<<<
 *             if not window_size=='Error':
 *                 alt_seq=ref_seq_readin(ref,sv_info[0],sv_info[1]-flank_length,sv_info[1])+ref_seq_readin(ref,sv_info[0],sv_info[2],sv_info[2]+flank_length)
 */
      __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_window_size_refine); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1660, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __pyx_t_4 = NULL;
      if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_1))) {
        __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_1);
        if (likely(__pyx_t_4)) {
          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
          __Pyx_INCREF(__pyx_t_4);
          __Pyx_INCREF(function);
          __Pyx_DECREF_SET(__pyx_t_1, function);
        }
      }
      if (!__pyx_t_4) {
        __pyx_t_8 = __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_v_ref_seq); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1660, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_8);
      } else {
        __pyx_t_3 = PyTuple_New(1+1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1660, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_3);
        __Pyx_GIVEREF(__pyx_t_4); PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_4); __pyx_t_4 = NULL;
        __Pyx_INCREF(__pyx_v_ref_seq);
        __Pyx_GIVEREF(__pyx_v_ref_seq);
        PyTuple_SET_ITEM(__pyx_t_3, 0+1, __pyx_v_ref_seq);
        __pyx_t_8 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_3, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1660, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_8);
        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      }
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      if ((likely(PyTuple_CheckExact(__pyx_t_8))) || (PyList_CheckExact(__pyx_t_8))) {
        PyObject* sequence = __pyx_t_8;
        #if CYTHON_COMPILING_IN_CPYTHON
        Py_ssize_t size = Py_SIZE(sequence);
        #else
        Py_ssize_t size = PySequence_Size(sequence);
        #endif
        if (unlikely(size != 2)) {
          if (size > 2) __Pyx_RaiseTooManyValuesError(2);
          else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
          __PYX_ERR(0, 1660, __pyx_L1_error)
        }
        #if CYTHON_COMPILING_IN_CPYTHON
        if (likely(PyTuple_CheckExact(sequence))) {
          __pyx_t_1 = PyTuple_GET_ITEM(sequence, 0); 
          __pyx_t_3 = PyTuple_GET_ITEM(sequence, 1); 
        } else {
          __pyx_t_1 = PyList_GET_ITEM(sequence, 0); 
          __pyx_t_3 = PyList_GET_ITEM(sequence, 1); 
        }
        __Pyx_INCREF(__pyx_t_1);
        __Pyx_INCREF(__pyx_t_3);
        #else
        __pyx_t_1 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1660, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        __pyx_t_3 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1660, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_3);
        #endif
        __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
      } else {
        Py_ssize_t index = -1;
        __pyx_t_4 = PyObject_GetIter(__pyx_t_8); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1660, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_4);
        __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
        __pyx_t_10 = Py_TYPE(__pyx_t_4)->tp_iternext;
        index = 0; __pyx_t_1 = __pyx_t_10(__pyx_t_4); if (unlikely(!__pyx_t_1)) goto __pyx_L13_unpacking_failed;
        __Pyx_GOTREF(__pyx_t_1);
        index = 1; __pyx_t_3 = __pyx_t_10(__pyx_t_4); if (unlikely(!__pyx_t_3)) goto __pyx_L13_unpacking_failed;
        __Pyx_GOTREF(__pyx_t_3);
        if (__Pyx_IternextUnpackEndCheck(__pyx_t_10(__pyx_t_4), 2) < 0) __PYX_ERR(0, 1660, __pyx_L1_error)
        __pyx_t_10 = NULL;
        __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
        goto __pyx_L14_unpacking_done;
        __pyx_L13_unpacking_failed:;
        __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
        __pyx_t_10 = NULL;
        if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
        __PYX_ERR(0, 1660, __pyx_L1_error)
        __pyx_L14_unpacking_done:;
      }
      __pyx_v_window_size = __pyx_t_1;
      __pyx_t_1 = 0;
      __pyx_v_window_size_qc = __pyx_t_3;
      __pyx_t_3 = 0;

      /* "vapor_vali/Simple_function.pyx":1661
 *             ref_seq=ref_seq_readin(ref,sv_info[0],sv_info[1]-flank_length,sv_info[1]+flank_length)
 *             [window_size,window_size_qc]=window_size_refine(ref_seq)
 *             if not window_size=='Error':             # <<<<<<<<<<<<<<
 *                 alt_seq=ref_seq_readin(ref,sv_info[0],sv_info[1]-flank_length,sv_info[1])+ref_seq_readin(ref,sv_info[0],sv_info[2],sv_info[2]+flank_length)
 *                 [window_size,window_size_qc]=window_size_refine(alt_seq)
 */
      __pyx_t_5 = (__Pyx_PyString_Equals(__pyx_v_window_size, __pyx_n_s_Error, Py_EQ)); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 1661, __pyx_L1_error)
      __pyx_t_11 = ((!__pyx_t_5) != 0);
      if (__pyx_t_11) {

        /* "vapor_vali/Simple_function.pyx":1662
 *             [window_size,window_size_qc]=window_size_refine(ref_seq)
 *             if not window_size=='Error':
 *                 alt_seq=ref_seq_readin(ref,sv_info[0],sv_info[1]-flank_length,sv_info[1])+ref_seq_readin(ref,sv_info[0],sv_info[2],sv_info[2]+flank_length)             # <<<<<<<<<<<<<<
 *                 [window_size,window_size_qc]=window_size_refine(alt_seq)
 *                 if not window_size=='Error':
 */
        __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_ref_seq_readin); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1662, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_3);
        __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_sv_info, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1662, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        __pyx_t_4 = __Pyx_GetItemInt(__pyx_v_sv_info, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1662, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_4);
        __pyx_t_9 = PyNumber_Subtract(__pyx_t_4, __pyx_v_flank_length); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1662, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_9);
        __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
        __pyx_t_4 = __Pyx_GetItemInt(__pyx_v_sv_info, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1662, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_4);
        __pyx_t_7 = NULL;
        __pyx_t_6 = 0;
        if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_3))) {
          __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_3);
          if (likely(__pyx_t_7)) {
            PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
            __Pyx_INCREF(__pyx_t_7);
            __Pyx_INCREF(function);
            __Pyx_DECREF_SET(__pyx_t_3, function);
            __pyx_t_6 = 1;
          }
        }
        __pyx_t_2 = PyTuple_New(4+__pyx_t_6); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1662, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
        if (__pyx_t_7) {
          __Pyx_GIVEREF(__pyx_t_7); PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_7); __pyx_t_7 = NULL;
        }
        __Pyx_INCREF(__pyx_v_ref);
        __Pyx_GIVEREF(__pyx_v_ref);
        PyTuple_SET_ITEM(__pyx_t_2, 0+__pyx_t_6, __pyx_v_ref);
        __Pyx_GIVEREF(__pyx_t_1);
        PyTuple_SET_ITEM(__pyx_t_2, 1+__pyx_t_6, __pyx_t_1);
        __Pyx_GIVEREF(__pyx_t_9);
        PyTuple_SET_ITEM(__pyx_t_2, 2+__pyx_t_6, __pyx_t_9);
        __Pyx_GIVEREF(__pyx_t_4);
        PyTuple_SET_ITEM(__pyx_t_2, 3+__pyx_t_6, __pyx_t_4);
        __pyx_t_1 = 0;
        __pyx_t_9 = 0;
        __pyx_t_4 = 0;
        __pyx_t_8 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_2, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1662, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_8);
        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
        __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_ref_seq_readin); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1662, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
        __pyx_t_4 = __Pyx_GetItemInt(__pyx_v_sv_info, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1662, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_4);
        __pyx_t_9 = __Pyx_GetItemInt(__pyx_v_sv_info, 2, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1662, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_9);
        __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_sv_info, 2, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1662, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        __pyx_t_7 = PyNumber_Add(__pyx_t_1, __pyx_v_flank_length); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1662, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_7);
        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
        __pyx_t_1 = NULL;
        __pyx_t_6 = 0;
        if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_2))) {
          __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_2);
          if (likely(__pyx_t_1)) {
            PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
            __Pyx_INCREF(__pyx_t_1);
            __Pyx_INCREF(function);
            __Pyx_DECREF_SET(__pyx_t_2, function);
            __pyx_t_6 = 1;
          }
        }
        __pyx_t_17 = PyTuple_New(4+__pyx_t_6); if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 1662, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_17);
        if (__pyx_t_1) {
          __Pyx_GIVEREF(__pyx_t_1); PyTuple_SET_ITEM(__pyx_t_17, 0, __pyx_t_1); __pyx_t_1 = NULL;
        }
        __Pyx_INCREF(__pyx_v_ref);
        __Pyx_GIVEREF(__pyx_v_ref);
        PyTuple_SET_ITEM(__pyx_t_17, 0+__pyx_t_6, __pyx_v_ref);
        __Pyx_GIVEREF(__pyx_t_4);
        PyTuple_SET_ITEM(__pyx_t_17, 1+__pyx_t_6, __pyx_t_4);
        __Pyx_GIVEREF(__pyx_t_9);
        PyTuple_SET_ITEM(__pyx_t_17, 2+__pyx_t_6, __pyx_t_9);
        __Pyx_GIVEREF(__pyx_t_7);
        PyTuple_SET_ITEM(__pyx_t_17, 3+__pyx_t_6, __pyx_t_7);
        __pyx_t_4 = 0;
        __pyx_t_9 = 0;
        __pyx_t_7 = 0;
        __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_17, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1662, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_3);
        __Pyx_DECREF(__pyx_t_17); __pyx_t_17 = 0;
        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
        __pyx_t_2 = PyNumber_Add(__pyx_t_8, __pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1662, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
        __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
        __pyx_v_alt_seq = __pyx_t_2;
        __pyx_t_2 = 0;

        /* "vapor_vali/Simple_function.pyx":1663
 *             if not window_size=='Error':
 *                 alt_seq=ref_seq_readin(ref,sv_info[0],sv_info[1]-flank_length,sv_info[1])+ref_seq_readin(ref,sv_info[0],sv_info[2],sv_info[2]+flank_length)
 *                 [window_size,window_size_qc]=window_size_refine(alt_seq)             # <<<<<<<<<<<<<<
 *                 if not window_size=='Error':
 *                     best_read_rec=''
 */
        __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_window_size_refine); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1663, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_3);
        __pyx_t_8 = NULL;
        if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_3))) {
          __pyx_t_8 = PyMethod_GET_SELF(__pyx_t_3);
          if (likely(__pyx_t_8)) {
            PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
            __Pyx_INCREF(__pyx_t_8);
            __Pyx_INCREF(function);
            __Pyx_DECREF_SET(__pyx_t_3, function);
          }
        }
        if (!__pyx_t_8) {
          __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_v_alt_seq); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1663, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_2);
        } else {
          __pyx_t_17 = PyTuple_New(1+1); if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 1663, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_17);
          __Pyx_GIVEREF(__pyx_t_8); PyTuple_SET_ITEM(__pyx_t_17, 0, __pyx_t_8); __pyx_t_8 = NULL;
          __Pyx_INCREF(__pyx_v_alt_seq);
          __Pyx_GIVEREF(__pyx_v_alt_seq);
          PyTuple_SET_ITEM(__pyx_t_17, 0+1, __pyx_v_alt_seq);
          __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_17, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1663, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_2);
          __Pyx_DECREF(__pyx_t_17); __pyx_t_17 = 0;
        }
        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
        if ((likely(PyTuple_CheckExact(__pyx_t_2))) || (PyList_CheckExact(__pyx_t_2))) {
          PyObject* sequence = __pyx_t_2;
          #if CYTHON_COMPILING_IN_CPYTHON
          Py_ssize_t size = Py_SIZE(sequence);
          #else
          Py_ssize_t size = PySequence_Size(sequence);
          #endif
          if (unlikely(size != 2)) {
            if (size > 2) __Pyx_RaiseTooManyValuesError(2);
            else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
            __PYX_ERR(0, 1663, __pyx_L1_error)
          }
          #if CYTHON_COMPILING_IN_CPYTHON
          if (likely(PyTuple_CheckExact(sequence))) {
            __pyx_t_3 = PyTuple_GET_ITEM(sequence, 0); 
            __pyx_t_17 = PyTuple_GET_ITEM(sequence, 1); 
          } else {
            __pyx_t_3 = PyList_GET_ITEM(sequence, 0); 
            __pyx_t_17 = PyList_GET_ITEM(sequence, 1); 
          }
          __Pyx_INCREF(__pyx_t_3);
          __Pyx_INCREF(__pyx_t_17);
          #else
          __pyx_t_3 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1663, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_3);
          __pyx_t_17 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 1663, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_17);
          #endif
          __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
        } else {
          Py_ssize_t index = -1;
          __pyx_t_8 = PyObject_GetIter(__pyx_t_2); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1663, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_8);
          __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
          __pyx_t_10 = Py_TYPE(__pyx_t_8)->tp_iternext;
          index = 0; __pyx_t_3 = __pyx_t_10(__pyx_t_8); if (unlikely(!__pyx_t_3)) goto __pyx_L16_unpacking_failed;
          __Pyx_GOTREF(__pyx_t_3);
          index = 1; __pyx_t_17 = __pyx_t_10(__pyx_t_8); if (unlikely(!__pyx_t_17)) goto __pyx_L16_unpacking_failed;
          __Pyx_GOTREF(__pyx_t_17);
          if (__Pyx_IternextUnpackEndCheck(__pyx_t_10(__pyx_t_8), 2) < 0) __PYX_ERR(0, 1663, __pyx_L1_error)
          __pyx_t_10 = NULL;
          __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
          goto __pyx_L17_unpacking_done;
          __pyx_L16_unpacking_failed:;
          __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
          __pyx_t_10 = NULL;
          if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
          __PYX_ERR(0, 1663, __pyx_L1_error)
          __pyx_L17_unpacking_done:;
        }
        __Pyx_DECREF_SET(__pyx_v_window_size, __pyx_t_3);
        __pyx_t_3 = 0;
        __Pyx_DECREF_SET(__pyx_v_window_size_qc, __pyx_t_17);
        __pyx_t_17 = 0;

        /* "vapor_vali/Simple_function.pyx":1664
 *                 alt_seq=ref_seq_readin(ref,sv_info[0],sv_info[1]-flank_length,sv_info[1])+ref_seq_readin(ref,sv_info[0],sv_info[2],sv_info[2]+flank_length)
 *                 [window_size,window_size_qc]=window_size_refine(alt_seq)
 *                 if not window_size=='Error':             # <<<<<<<<<<<<<<
 *                     best_read_rec=''
 *                     for x in all_reads:
 */
        __pyx_t_11 = (__Pyx_PyString_Equals(__pyx_v_window_size, __pyx_n_s_Error, Py_EQ)); if (unlikely(__pyx_t_11 < 0)) __PYX_ERR(0, 1664, __pyx_L1_error)
        __pyx_t_5 = ((!__pyx_t_11) != 0);
        if (__pyx_t_5) {

          /* "vapor_vali/Simple_function.pyx":1665
 *                 [window_size,window_size_qc]=window_size_refine(alt_seq)
 *                 if not window_size=='Error':
 *                     best_read_rec=''             # <<<<<<<<<<<<<<
 *                     for x in all_reads:
 *                         vapor_single_read_score=calcu_vapor_single_read_score_within_10Perc_m1b(ref_seq,alt_seq,x,window_size)
 */
          __Pyx_INCREF(__pyx_kp_s__24);
          __Pyx_DECREF_SET(__pyx_v_best_read_rec, __pyx_kp_s__24);

          /* "vapor_vali/Simple_function.pyx":1666
 *                 if not window_size=='Error':
 *                     best_read_rec=''
 *                     for x in all_reads:             # <<<<<<<<<<<<<<
 *                         vapor_single_read_score=calcu_vapor_single_read_score_within_10Perc_m1b(ref_seq,alt_seq,x,window_size)
 *                         if not 0 in vapor_single_read_score:
 */
          if (likely(PyList_CheckExact(__pyx_v_all_reads)) || PyTuple_CheckExact(__pyx_v_all_reads)) {
            __pyx_t_2 = __pyx_v_all_reads; __Pyx_INCREF(__pyx_t_2); __pyx_t_6 = 0;
            __pyx_t_12 = NULL;
          } else {
            __pyx_t_6 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_v_all_reads); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1666, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_2);
            __pyx_t_12 = Py_TYPE(__pyx_t_2)->tp_iternext; if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1666, __pyx_L1_error)
          }
          for (;;) {
            if (likely(!__pyx_t_12)) {
              if (likely(PyList_CheckExact(__pyx_t_2))) {
                if (__pyx_t_6 >= PyList_GET_SIZE(__pyx_t_2)) break;
                #if CYTHON_COMPILING_IN_CPYTHON
                __pyx_t_17 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_6); __Pyx_INCREF(__pyx_t_17); __pyx_t_6++; if (unlikely(0 < 0)) __PYX_ERR(0, 1666, __pyx_L1_error)
                #else
                __pyx_t_17 = PySequence_ITEM(__pyx_t_2, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 1666, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_17);
                #endif
              } else {
                if (__pyx_t_6 >= PyTuple_GET_SIZE(__pyx_t_2)) break;
                #if CYTHON_COMPILING_IN_CPYTHON
                __pyx_t_17 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_6); __Pyx_INCREF(__pyx_t_17); __pyx_t_6++; if (unlikely(0 < 0)) __PYX_ERR(0, 1666, __pyx_L1_error)
                #else
                __pyx_t_17 = PySequence_ITEM(__pyx_t_2, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 1666, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_17);
                #endif
              }
            } else {
              __pyx_t_17 = __pyx_t_12(__pyx_t_2);
              if (unlikely(!__pyx_t_17)) {
                PyObject* exc_type = PyErr_Occurred();
                if (exc_type) {
                  if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
                  else __PYX_ERR(0, 1666, __pyx_L1_error)
                }
                break;
              }
              __Pyx_GOTREF(__pyx_t_17);
            }
            __Pyx_XDECREF_SET(__pyx_v_x, __pyx_t_17);
            __pyx_t_17 = 0;

            /* "vapor_vali/Simple_function.pyx":1667
 *                     best_read_rec=''
 *                     for x in all_reads:
 *                         vapor_single_read_score=calcu_vapor_single_read_score_within_10Perc_m1b(ref_seq,alt_seq,x,window_size)             # <<<<<<<<<<<<<<
 *                         if not 0 in vapor_single_read_score:
 *                             vapor_score_list.append(1-float(vapor_single_read_score[1])/float(vapor_single_read_score[0]))
 */
            __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_calcu_vapor_single_read_score_wi); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1667, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_3);
            __pyx_t_8 = NULL;
            __pyx_t_13 = 0;
            if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_3))) {
              __pyx_t_8 = PyMethod_GET_SELF(__pyx_t_3);
              if (likely(__pyx_t_8)) {
                PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
                __Pyx_INCREF(__pyx_t_8);
                __Pyx_INCREF(function);
                __Pyx_DECREF_SET(__pyx_t_3, function);
                __pyx_t_13 = 1;
              }
            }
            __pyx_t_7 = PyTuple_New(4+__pyx_t_13); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1667, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_7);
            if (__pyx_t_8) {
              __Pyx_GIVEREF(__pyx_t_8); PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_8); __pyx_t_8 = NULL;
            }
            __Pyx_INCREF(__pyx_v_ref_seq);
            __Pyx_GIVEREF(__pyx_v_ref_seq);
            PyTuple_SET_ITEM(__pyx_t_7, 0+__pyx_t_13, __pyx_v_ref_seq);
            __Pyx_INCREF(__pyx_v_alt_seq);
            __Pyx_GIVEREF(__pyx_v_alt_seq);
            PyTuple_SET_ITEM(__pyx_t_7, 1+__pyx_t_13, __pyx_v_alt_seq);
            __Pyx_INCREF(__pyx_v_x);
            __Pyx_GIVEREF(__pyx_v_x);
            PyTuple_SET_ITEM(__pyx_t_7, 2+__pyx_t_13, __pyx_v_x);
            __Pyx_INCREF(__pyx_v_window_size);
            __Pyx_GIVEREF(__pyx_v_window_size);
            PyTuple_SET_ITEM(__pyx_t_7, 3+__pyx_t_13, __pyx_v_window_size);
            __pyx_t_17 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_7, NULL); if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 1667, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_17);
            __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
            __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
            __Pyx_XDECREF_SET(__pyx_v_vapor_single_read_score, __pyx_t_17);
            __pyx_t_17 = 0;

            /* "vapor_vali/Simple_function.pyx":1668
 *                     for x in all_reads:
 *                         vapor_single_read_score=calcu_vapor_single_read_score_within_10Perc_m1b(ref_seq,alt_seq,x,window_size)
 *                         if not 0 in vapor_single_read_score:             # <<<<<<<<<<<<<<
 *                             vapor_score_list.append(1-float(vapor_single_read_score[1])/float(vapor_single_read_score[0]))
 *                             if vapor_score_list[-1]==max(vapor_score_list):best_read_rec=x
 */
            __pyx_t_5 = (__Pyx_PySequence_ContainsTF(__pyx_int_0, __pyx_v_vapor_single_read_score, Py_NE)); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 1668, __pyx_L1_error)
            __pyx_t_11 = (__pyx_t_5 != 0);
            if (__pyx_t_11) {

              /* "vapor_vali/Simple_function.pyx":1669
 *                         vapor_single_read_score=calcu_vapor_single_read_score_within_10Perc_m1b(ref_seq,alt_seq,x,window_size)
 *                         if not 0 in vapor_single_read_score:
 *                             vapor_score_list.append(1-float(vapor_single_read_score[1])/float(vapor_single_read_score[0]))             # <<<<<<<<<<<<<<
 *                             if vapor_score_list[-1]==max(vapor_score_list):best_read_rec=x
 *                     make_event_figure_1(vapor_score_list,best_read_rec,window_size,ref_seq,alt_seq,out_figure_name)
 */
              __pyx_t_17 = __Pyx_GetItemInt(__pyx_v_vapor_single_read_score, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 1669, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_17);
              __pyx_t_15 = __Pyx_PyObject_AsDouble(__pyx_t_17); if (unlikely(__pyx_t_15 == ((double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1669, __pyx_L1_error)
              __Pyx_DECREF(__pyx_t_17); __pyx_t_17 = 0;
              __pyx_t_17 = __Pyx_GetItemInt(__pyx_v_vapor_single_read_score, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 1669, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_17);
              __pyx_t_14 = __Pyx_PyObject_AsDouble(__pyx_t_17); if (unlikely(__pyx_t_14 == ((double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1669, __pyx_L1_error)
              __Pyx_DECREF(__pyx_t_17); __pyx_t_17 = 0;
              if (unlikely(__pyx_t_14 == 0)) {
                PyErr_SetString(PyExc_ZeroDivisionError, "float division");
                __PYX_ERR(0, 1669, __pyx_L1_error)
              }
              __pyx_t_17 = PyFloat_FromDouble((1.0 - (__pyx_t_15 / __pyx_t_14))); if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 1669, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_17);
              __pyx_t_16 = __Pyx_PyList_Append(__pyx_v_vapor_score_list, __pyx_t_17); if (unlikely(__pyx_t_16 == -1)) __PYX_ERR(0, 1669, __pyx_L1_error)
              __Pyx_DECREF(__pyx_t_17); __pyx_t_17 = 0;

              /* "vapor_vali/Simple_function.pyx":1670
 *                         if not 0 in vapor_single_read_score:
 *                             vapor_score_list.append(1-float(vapor_single_read_score[1])/float(vapor_single_read_score[0]))
 *                             if vapor_score_list[-1]==max(vapor_score_list):best_read_rec=x             # <<<<<<<<<<<<<<
 *                     make_event_figure_1(vapor_score_list,best_read_rec,window_size,ref_seq,alt_seq,out_figure_name)
 *     return vapor_score_list
 */
              __pyx_t_17 = __Pyx_GetItemInt_List(__pyx_v_vapor_score_list, -1L, long, 1, __Pyx_PyInt_From_long, 1, 1, 1); if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 1670, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_17);
              __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1670, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_3);
              __Pyx_INCREF(__pyx_v_vapor_score_list);
              __Pyx_GIVEREF(__pyx_v_vapor_score_list);
              PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_v_vapor_score_list);
              __pyx_t_7 = __Pyx_PyObject_Call(__pyx_builtin_max, __pyx_t_3, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1670, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_7);
              __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
              __pyx_t_3 = PyObject_RichCompare(__pyx_t_17, __pyx_t_7, Py_EQ); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1670, __pyx_L1_error)
              __Pyx_DECREF(__pyx_t_17); __pyx_t_17 = 0;
              __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
              __pyx_t_11 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_11 < 0)) __PYX_ERR(0, 1670, __pyx_L1_error)
              __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
              if (__pyx_t_11) {
                __Pyx_INCREF(__pyx_v_x);
                __Pyx_DECREF_SET(__pyx_v_best_read_rec, __pyx_v_x);
              }

              /* "vapor_vali/Simple_function.pyx":1668
 *                     for x in all_reads:
 *                         vapor_single_read_score=calcu_vapor_single_read_score_within_10Perc_m1b(ref_seq,alt_seq,x,window_size)
 *                         if not 0 in vapor_single_read_score:             # <<<<<<<<<<<<<<
 *                             vapor_score_list.append(1-float(vapor_single_read_score[1])/float(vapor_single_read_score[0]))
 *                             if vapor_score_list[-1]==max(vapor_score_list):best_read_rec=x
 */
            }

            /* "vapor_vali/Simple_function.pyx":1666
 *                 if not window_size=='Error':
 *                     best_read_rec=''
 *                     for x in all_reads:             # <<<<<<<<<<<<<<
 *                         vapor_single_read_score=calcu_vapor_single_read_score_within_10Perc_m1b(ref_seq,alt_seq,x,window_size)
 *                         if not 0 in vapor_single_read_score:
 */
          }
          __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

          /* "vapor_vali/Simple_function.pyx":1671
 *                             vapor_score_list.append(1-float(vapor_single_read_score[1])/float(vapor_single_read_score[0]))
 *                             if vapor_score_list[-1]==max(vapor_score_list):best_read_rec=x
 *                     make_event_figure_1(vapor_score_list,best_read_rec,window_size,ref_seq,alt_seq,out_figure_name)             # <<<<<<<<<<<<<<
 *     return vapor_score_list
 * 
 */
          __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_make_event_figure_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1671, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_3);
          __pyx_t_7 = NULL;
          __pyx_t_6 = 0;
          if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_3))) {
            __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_3);
            if (likely(__pyx_t_7)) {
              PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
              __Pyx_INCREF(__pyx_t_7);
              __Pyx_INCREF(function);
              __Pyx_DECREF_SET(__pyx_t_3, function);
              __pyx_t_6 = 1;
            }
          }
          __pyx_t_17 = PyTuple_New(6+__pyx_t_6); if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 1671, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_17);
          if (__pyx_t_7) {
            __Pyx_GIVEREF(__pyx_t_7); PyTuple_SET_ITEM(__pyx_t_17, 0, __pyx_t_7); __pyx_t_7 = NULL;
          }
          __Pyx_INCREF(__pyx_v_vapor_score_list);
          __Pyx_GIVEREF(__pyx_v_vapor_score_list);
          PyTuple_SET_ITEM(__pyx_t_17, 0+__pyx_t_6, __pyx_v_vapor_score_list);
          __Pyx_INCREF(__pyx_v_best_read_rec);
          __Pyx_GIVEREF(__pyx_v_best_read_rec);
          PyTuple_SET_ITEM(__pyx_t_17, 1+__pyx_t_6, __pyx_v_best_read_rec);
          __Pyx_INCREF(__pyx_v_window_size);
          __Pyx_GIVEREF(__pyx_v_window_size);
          PyTuple_SET_ITEM(__pyx_t_17, 2+__pyx_t_6, __pyx_v_window_size);
          __Pyx_INCREF(__pyx_v_ref_seq);
          __Pyx_GIVEREF(__pyx_v_ref_seq);
          PyTuple_SET_ITEM(__pyx_t_17, 3+__pyx_t_6, __pyx_v_ref_seq);
          __Pyx_INCREF(__pyx_v_alt_seq);
          __Pyx_GIVEREF(__pyx_v_alt_seq);
          PyTuple_SET_ITEM(__pyx_t_17, 4+__pyx_t_6, __pyx_v_alt_seq);
          __Pyx_INCREF(__pyx_v_out_figure_name);
          __Pyx_GIVEREF(__pyx_v_out_figure_name);
          PyTuple_SET_ITEM(__pyx_t_17, 5+__pyx_t_6, __pyx_v_out_figure_name);
          __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_17, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1671, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_2);
          __Pyx_DECREF(__pyx_t_17); __pyx_t_17 = 0;
          __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
          __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

          /* "vapor_vali/Simple_function.pyx":1664
 *                 alt_seq=ref_seq_readin(ref,sv_info[0],sv_info[1]-flank_length,sv_info[1])+ref_seq_readin(ref,sv_info[0],sv_info[2],sv_info[2]+flank_length)
 *                 [window_size,window_size_qc]=window_size_refine(alt_seq)
 *                 if not window_size=='Error':             # <<<<<<<<<<<<<<
 *                     best_read_rec=''
 *                     for x in all_reads:
 */
        }

        /* "vapor_vali/Simple_function.pyx":1661
 *             ref_seq=ref_seq_readin(ref,sv_info[0],sv_info[1]-flank_length,sv_info[1]+flank_length)
 *             [window_size,window_size_qc]=window_size_refine(ref_seq)
 *             if not window_size=='Error':             # <<<<<<<<<<<<<<
 *                 alt_seq=ref_seq_readin(ref,sv_info[0],sv_info[1]-flank_length,sv_info[1])+ref_seq_readin(ref,sv_info[0],sv_info[2],sv_info[2]+flank_length)
 *                 [window_size,window_size_qc]=window_size_refine(alt_seq)
 */
      }

      /* "vapor_vali/Simple_function.pyx":1658
 *         #change the way of read in ref seq
 *         all_reads=simple_del_chop_pacbio_read_simple_short(bam_in,sv_info,flank_length)
 *         if len(all_reads)>0:             # <<<<<<<<<<<<<<
 *             ref_seq=ref_seq_readin(ref,sv_info[0],sv_info[1]-flank_length,sv_info[1]+flank_length)
 *             [window_size,window_size_qc]=window_size_refine(ref_seq)
 */
    }
  }
  __pyx_L3:;

  /* "vapor_vali/Simple_function.pyx":1672
 *                             if vapor_score_list[-1]==max(vapor_score_list):best_read_rec=x
 *                     make_event_figure_1(vapor_score_list,best_read_rec,window_size,ref_seq,alt_seq,out_figure_name)
 *     return vapor_score_list             # <<<<<<<<<<<<<<
 * 
 * def vapor_simple_tandup_Vapor(bam_in,ref,sv_info,out_figure_name):
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_vapor_score_list);
  __pyx_r = __pyx_v_vapor_score_list;
  goto __pyx_L0;

  /* "vapor_vali/Simple_function.pyx":1636
 *     return vapor_score_list
 * 
 * def vapor_simple_del_Vapor(bam_in,ref,sv_info,out_figure_name):             # <<<<<<<<<<<<<<
 *     #eg of sv_info=['chr1', 101553562, 101553905]
 *     flank_length=flank_length_calculate(sv_info)
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_7);
  __Pyx_XDECREF(__pyx_t_8);
  __Pyx_XDECREF(__pyx_t_9);
  __Pyx_XDECREF(__pyx_t_17);
  __Pyx_AddTraceback("vapor_vali.Simple_function.vapor_simple_del_Vapor", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_flank_length);
  __Pyx_XDECREF(__pyx_v_vapor_score_list);
  __Pyx_XDECREF(__pyx_v_best_read_rec);
  __Pyx_XDECREF(__pyx_v_all_reads);
  __Pyx_XDECREF(__pyx_v_ref_seq);
  __Pyx_XDECREF(__pyx_v_window_size);
  __Pyx_XDECREF(__pyx_v_window_size_qc);
  __Pyx_XDECREF(__pyx_v_alt_seq);
  __Pyx_XDECREF(__pyx_v_x);
  __Pyx_XDECREF(__pyx_v_vapor_single_read_score);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "vapor_vali/Simple_function.pyx":1674
 *     return vapor_score_list
 * 
 * def vapor_simple_tandup_Vapor(bam_in,ref,sv_info,out_figure_name):             # <<<<<<<<<<<<<<
 *    #vapor_simple_del_Vapor(bam_in,ref,x[:-2],out_path+sample_name+'.TANDUP.'+key_event+'.png')
 *     flank_length=flank_length_calculate(sv_info)
 */

/* Python wrapper */
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_211vapor_simple_tandup_Vapor(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_10vapor_vali_15Simple_function_211vapor_simple_tandup_Vapor = {"vapor_simple_tandup_Vapor", (PyCFunction)__pyx_pw_10vapor_vali_15Simple_function_211vapor_simple_tandup_Vapor, METH_VARARGS|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_211vapor_simple_tandup_Vapor(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_bam_in = 0;
  PyObject *__pyx_v_ref = 0;
  PyObject *__pyx_v_sv_info = 0;
  PyObject *__pyx_v_out_figure_name = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("vapor_simple_tandup_Vapor (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_bam_in,&__pyx_n_s_ref,&__pyx_n_s_sv_info,&__pyx_n_s_out_figure_name,0};
    PyObject* values[4] = {0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
      switch (pos_args) {
        case  4: values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
        case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_bam_in)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_ref)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("vapor_simple_tandup_Vapor", 1, 4, 4, 1); __PYX_ERR(0, 1674, __pyx_L3_error)
        }
        case  2:
        if (likely((values[2] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_sv_info)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("vapor_simple_tandup_Vapor", 1, 4, 4, 2); __PYX_ERR(0, 1674, __pyx_L3_error)
        }
        case  3:
        if (likely((values[3] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_out_figure_name)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("vapor_simple_tandup_Vapor", 1, 4, 4, 3); __PYX_ERR(0, 1674, __pyx_L3_error)
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "vapor_simple_tandup_Vapor") < 0)) __PYX_ERR(0, 1674, __pyx_L3_error)
      }
    } else if (PyTuple_GET_SIZE(__pyx_args) != 4) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
      values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
    }
    __pyx_v_bam_in = values[0];
    __pyx_v_ref = values[1];
    __pyx_v_sv_info = values[2];
    __pyx_v_out_figure_name = values[3];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("vapor_simple_tandup_Vapor", 1, 4, 4, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1674, __pyx_L3_error)
  __pyx_L3_error:;
  __Pyx_AddTraceback("vapor_vali.Simple_function.vapor_simple_tandup_Vapor", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_10vapor_vali_15Simple_function_210vapor_simple_tandup_Vapor(__pyx_self, __pyx_v_bam_in, __pyx_v_ref, __pyx_v_sv_info, __pyx_v_out_figure_name);

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10vapor_vali_15Simple_function_210vapor_simple_tandup_Vapor(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_bam_in, PyObject *__pyx_v_ref, PyObject *__pyx_v_sv_info, PyObject *__pyx_v_out_figure_name) {
  PyObject *__pyx_v_flank_length = NULL;
  PyObject *__pyx_v_vapor_score_list = NULL;
  PyObject *__pyx_v_best_read_rec = NULL;
  PyObject *__pyx_v_ref_seq = NULL;
  PyObject *__pyx_v_window_size = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_window_size_qc = NULL;
  PyObject *__pyx_v_alt_seq = NULL;
  PyObject *__pyx_v_all_reads = NULL;
  PyObject *__pyx_v_x = NULL;
  PyObject *__pyx_v_vapor_single_read_score = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  int __pyx_t_5;
  PyObject *__pyx_t_6 = NULL;
  PyObject *__pyx_t_7 = NULL;
  Py_ssize_t __pyx_t_8;
  PyObject *__pyx_t_9 = NULL;
  PyObject *(*__pyx_t_10)(PyObject *);
  int __pyx_t_11;
  PyObject *(*__pyx_t_12)(PyObject *);
  Py_ssize_t __pyx_t_13;
  double __pyx_t_14;
  double __pyx_t_15;
  int __pyx_t_16;
  PyObject *__pyx_t_17 = NULL;
  __Pyx_RefNannySetupContext("vapor_simple_tandup_Vapor", 0);

  /* "vapor_vali/Simple_function.pyx":1676
 * def vapor_simple_tandup_Vapor(bam_in,ref,sv_info,out_figure_name):
 *    #vapor_simple_del_Vapor(bam_in,ref,x[:-2],out_path+sample_name+'.TANDUP.'+key_event+'.png')
 *     flank_length=flank_length_calculate(sv_info)             # <<<<<<<<<<<<<<
 *     vapor_score_list=[]
 *     best_read_rec=''
 */
  __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_flank_length_calculate); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1676, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_3);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_2, function);
    }
  }
  if (!__pyx_t_3) {
    __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_v_sv_info); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1676, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
  } else {
    __pyx_t_4 = PyTuple_New(1+1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1676, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_GIVEREF(__pyx_t_3); PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3); __pyx_t_3 = NULL;
    __Pyx_INCREF(__pyx_v_sv_info);
    __Pyx_GIVEREF(__pyx_v_sv_info);
    PyTuple_SET_ITEM(__pyx_t_4, 0+1, __pyx_v_sv_info);
    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_4, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1676, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  }
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_flank_length = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":1677
 *    #vapor_simple_del_Vapor(bam_in,ref,x[:-2],out_path+sample_name+'.TANDUP.'+key_event+'.png')
 *     flank_length=flank_length_calculate(sv_info)
 *     vapor_score_list=[]             # <<<<<<<<<<<<<<
 *     best_read_rec=''
 *     if sv_info[2]-sv_info[1]<default_max_sv_test: #only try to read in all reads with sv <100K; else: try breakpoints ;
 */
  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1677, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_vapor_score_list = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":1678
 *     flank_length=flank_length_calculate(sv_info)
 *     vapor_score_list=[]
 *     best_read_rec=''             # <<<<<<<<<<<<<<
 *     if sv_info[2]-sv_info[1]<default_max_sv_test: #only try to read in all reads with sv <100K; else: try breakpoints ;
 *         ref_seq=ref_seq_readin(ref,sv_info[0],sv_info[1]-flank_length,sv_info[2]+flank_length)
 */
  __Pyx_INCREF(__pyx_kp_s__24);
  __pyx_v_best_read_rec = __pyx_kp_s__24;

  /* "vapor_vali/Simple_function.pyx":1679
 *     vapor_score_list=[]
 *     best_read_rec=''
 *     if sv_info[2]-sv_info[1]<default_max_sv_test: #only try to read in all reads with sv <100K; else: try breakpoints ;             # <<<<<<<<<<<<<<
 *         ref_seq=ref_seq_readin(ref,sv_info[0],sv_info[1]-flank_length,sv_info[2]+flank_length)
 *         [window_size,window_size_qc]=window_size_refine(ref_seq)
 */
  __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_sv_info, 2, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1679, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_sv_info, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1679, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_4 = PyNumber_Subtract(__pyx_t_1, __pyx_t_2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1679, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_default_max_sv_test); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1679, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_1 = PyObject_RichCompare(__pyx_t_4, __pyx_t_2, Py_LT); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1679, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 1679, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  if (__pyx_t_5) {

    /* "vapor_vali/Simple_function.pyx":1680
 *     best_read_rec=''
 *     if sv_info[2]-sv_info[1]<default_max_sv_test: #only try to read in all reads with sv <100K; else: try breakpoints ;
 *         ref_seq=ref_seq_readin(ref,sv_info[0],sv_info[1]-flank_length,sv_info[2]+flank_length)             # <<<<<<<<<<<<<<
 *         [window_size,window_size_qc]=window_size_refine(ref_seq)
 *         if not window_size=='Error':
 */
    __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_ref_seq_readin); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1680, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_4 = __Pyx_GetItemInt(__pyx_v_sv_info, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1680, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_sv_info, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1680, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_6 = PyNumber_Subtract(__pyx_t_3, __pyx_v_flank_length); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1680, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_sv_info, 2, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1680, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_7 = PyNumber_Add(__pyx_t_3, __pyx_v_flank_length); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1680, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = NULL;
    __pyx_t_8 = 0;
    if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_2))) {
      __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
      if (likely(__pyx_t_3)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
        __Pyx_INCREF(__pyx_t_3);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_2, function);
        __pyx_t_8 = 1;
      }
    }
    __pyx_t_9 = PyTuple_New(4+__pyx_t_8); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1680, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_9);
    if (__pyx_t_3) {
      __Pyx_GIVEREF(__pyx_t_3); PyTuple_SET_ITEM(__pyx_t_9, 0, __pyx_t_3); __pyx_t_3 = NULL;
    }
    __Pyx_INCREF(__pyx_v_ref);
    __Pyx_GIVEREF(__pyx_v_ref);
    PyTuple_SET_ITEM(__pyx_t_9, 0+__pyx_t_8, __pyx_v_ref);
    __Pyx_GIVEREF(__pyx_t_4);
    PyTuple_SET_ITEM(__pyx_t_9, 1+__pyx_t_8, __pyx_t_4);
    __Pyx_GIVEREF(__pyx_t_6);
    PyTuple_SET_ITEM(__pyx_t_9, 2+__pyx_t_8, __pyx_t_6);
    __Pyx_GIVEREF(__pyx_t_7);
    PyTuple_SET_ITEM(__pyx_t_9, 3+__pyx_t_8, __pyx_t_7);
    __pyx_t_4 = 0;
    __pyx_t_6 = 0;
    __pyx_t_7 = 0;
    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_9, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1680, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_v_ref_seq = __pyx_t_1;
    __pyx_t_1 = 0;

    /* "vapor_vali/Simple_function.pyx":1681
 *     if sv_info[2]-sv_info[1]<default_max_sv_test: #only try to read in all reads with sv <100K; else: try breakpoints ;
 *         ref_seq=ref_seq_readin(ref,sv_info[0],sv_info[1]-flank_length,sv_info[2]+flank_length)
 *         [window_size,window_size_qc]=window_size_refine(ref_seq)             # <<<<<<<<<<<<<<
 *         if not window_size=='Error':
 *             alt_seq=ref_seq[:flank_length]+ref_seq[flank_length:(-flank_length)]+ref_seq[flank_length:(-flank_length)]+ref_seq[-flank_length:]
 */
    __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_window_size_refine); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1681, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_9 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_2))) {
      __pyx_t_9 = PyMethod_GET_SELF(__pyx_t_2);
      if (likely(__pyx_t_9)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
        __Pyx_INCREF(__pyx_t_9);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_2, function);
      }
    }
    if (!__pyx_t_9) {
      __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_v_ref_seq); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1681, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
    } else {
      __pyx_t_7 = PyTuple_New(1+1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1681, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_7);
      __Pyx_GIVEREF(__pyx_t_9); PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_9); __pyx_t_9 = NULL;
      __Pyx_INCREF(__pyx_v_ref_seq);
      __Pyx_GIVEREF(__pyx_v_ref_seq);
      PyTuple_SET_ITEM(__pyx_t_7, 0+1, __pyx_v_ref_seq);
      __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_7, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1681, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
    }
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    if ((likely(PyTuple_CheckExact(__pyx_t_1))) || (PyList_CheckExact(__pyx_t_1))) {
      PyObject* sequence = __pyx_t_1;
      #if CYTHON_COMPILING_IN_CPYTHON
      Py_ssize_t size = Py_SIZE(sequence);
      #else
      Py_ssize_t size = PySequence_Size(sequence);
      #endif
      if (unlikely(size != 2)) {
        if (size > 2) __Pyx_RaiseTooManyValuesError(2);
        else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
        __PYX_ERR(0, 1681, __pyx_L1_error)
      }
      #if CYTHON_COMPILING_IN_CPYTHON
      if (likely(PyTuple_CheckExact(sequence))) {
        __pyx_t_2 = PyTuple_GET_ITEM(sequence, 0); 
        __pyx_t_7 = PyTuple_GET_ITEM(sequence, 1); 
      } else {
        __pyx_t_2 = PyList_GET_ITEM(sequence, 0); 
        __pyx_t_7 = PyList_GET_ITEM(sequence, 1); 
      }
      __Pyx_INCREF(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_7);
      #else
      __pyx_t_2 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1681, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __pyx_t_7 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1681, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_7);
      #endif
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    } else {
      Py_ssize_t index = -1;
      __pyx_t_9 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1681, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_9);
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_10 = Py_TYPE(__pyx_t_9)->tp_iternext;
      index = 0; __pyx_t_2 = __pyx_t_10(__pyx_t_9); if (unlikely(!__pyx_t_2)) goto __pyx_L4_unpacking_failed;
      __Pyx_GOTREF(__pyx_t_2);
      index = 1; __pyx_t_7 = __pyx_t_10(__pyx_t_9); if (unlikely(!__pyx_t_7)) goto __pyx_L4_unpacking_failed;
      __Pyx_GOTREF(__pyx_t_7);
      if (__Pyx_IternextUnpackEndCheck(__pyx_t_10(__pyx_t_9), 2) < 0) __PYX_ERR(0, 1681, __pyx_L1_error)
      __pyx_t_10 = NULL;
      __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
      goto __pyx_L5_unpacking_done;
      __pyx_L4_unpacking_failed:;
      __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
      __pyx_t_10 = NULL;
      if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
      __PYX_ERR(0, 1681, __pyx_L1_error)
      __pyx_L5_unpacking_done:;
    }
    __pyx_v_window_size = __pyx_t_2;
    __pyx_t_2 = 0;
    __pyx_v_window_size_qc = __pyx_t_7;
    __pyx_t_7 = 0;

    /* "vapor_vali/Simple_function.pyx":1682
 *         ref_seq=ref_seq_readin(ref,sv_info[0],sv_info[1]-flank_length,sv_info[2]+flank_length)
 *         [window_size,window_size_qc]=window_size_refine(ref_seq)
 *         if not window_size=='Error':             # <<<<<<<<<<<<<<
 *             alt_seq=ref_seq[:flank_length]+ref_seq[flank_length:(-flank_length)]+ref_seq[flank_length:(-flank_length)]+ref_seq[-flank_length:]
 *             [window_size,window_size_qc]=window_size_refine(alt_seq)
 */
    __pyx_t_5 = (__Pyx_PyString_Equals(__pyx_v_window_size, __pyx_n_s_Error, Py_EQ)); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 1682, __pyx_L1_error)
    __pyx_t_11 = ((!__pyx_t_5) != 0);
    if (__pyx_t_11) {

      /* "vapor_vali/Simple_function.pyx":1683
 *         [window_size,window_size_qc]=window_size_refine(ref_seq)
 *         if not window_size=='Error':
 *             alt_seq=ref_seq[:flank_length]+ref_seq[flank_length:(-flank_length)]+ref_seq[flank_length:(-flank_length)]+ref_seq[-flank_length:]             # <<<<<<<<<<<<<<
 *             [window_size,window_size_qc]=window_size_refine(alt_seq)
 *             if not window_size=='Error':
 */
      __pyx_t_1 = __Pyx_PyObject_GetSlice(__pyx_v_ref_seq, 0, 0, NULL, &__pyx_v_flank_length, NULL, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1683, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __pyx_t_7 = PyNumber_Negative(__pyx_v_flank_length); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1683, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_7);
      __pyx_t_2 = __Pyx_PyObject_GetSlice(__pyx_v_ref_seq, 0, 0, &__pyx_v_flank_length, &__pyx_t_7, NULL, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1683, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
      __pyx_t_7 = PyNumber_Add(__pyx_t_1, __pyx_t_2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1683, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_7);
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_2 = PyNumber_Negative(__pyx_v_flank_length); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1683, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __pyx_t_1 = __Pyx_PyObject_GetSlice(__pyx_v_ref_seq, 0, 0, &__pyx_v_flank_length, &__pyx_t_2, NULL, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1683, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_2 = PyNumber_Add(__pyx_t_7, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1683, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_1 = PyNumber_Negative(__pyx_v_flank_length); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1683, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __pyx_t_7 = __Pyx_PyObject_GetSlice(__pyx_v_ref_seq, 0, 0, &__pyx_t_1, NULL, NULL, 0, 0, 1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1683, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_7);
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_1 = PyNumber_Add(__pyx_t_2, __pyx_t_7); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1683, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
      __pyx_v_alt_seq = __pyx_t_1;
      __pyx_t_1 = 0;

      /* "vapor_vali/Simple_function.pyx":1684
 *         if not window_size=='Error':
 *             alt_seq=ref_seq[:flank_length]+ref_seq[flank_length:(-flank_length)]+ref_seq[flank_length:(-flank_length)]+ref_seq[-flank_length:]
 *             [window_size,window_size_qc]=window_size_refine(alt_seq)             # <<<<<<<<<<<<<<
 *             if not window_size=='Error':
 *                 all_reads=simple_chop_pacbio_read_simple_short(bam_in,sv_info[:2]+[sv_info[1]+2*(sv_info[2]-sv_info[1])],flank_length)
 */
      __pyx_t_7 = __Pyx_GetModuleGlobalName(__pyx_n_s_window_size_refine); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1684, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_7);
      __pyx_t_2 = NULL;
      if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_7))) {
        __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_7);
        if (likely(__pyx_t_2)) {
          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_7);
          __Pyx_INCREF(__pyx_t_2);
          __Pyx_INCREF(function);
          __Pyx_DECREF_SET(__pyx_t_7, function);
        }
      }
      if (!__pyx_t_2) {
        __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_7, __pyx_v_alt_seq); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1684, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
      } else {
        __pyx_t_9 = PyTuple_New(1+1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1684, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_9);
        __Pyx_GIVEREF(__pyx_t_2); PyTuple_SET_ITEM(__pyx_t_9, 0, __pyx_t_2); __pyx_t_2 = NULL;
        __Pyx_INCREF(__pyx_v_alt_seq);
        __Pyx_GIVEREF(__pyx_v_alt_seq);
        PyTuple_SET_ITEM(__pyx_t_9, 0+1, __pyx_v_alt_seq);
        __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_7, __pyx_t_9, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1684, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
      }
      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
      if ((likely(PyTuple_CheckExact(__pyx_t_1))) || (PyList_CheckExact(__pyx_t_1))) {
        PyObject* sequence = __pyx_t_1;
        #if CYTHON_COMPILING_IN_CPYTHON
        Py_ssize_t size = Py_SIZE(sequence);
        #else
        Py_ssize_t size = PySequence_Size(sequence);
        #endif
        if (unlikely(size != 2)) {
          if (size > 2) __Pyx_RaiseTooManyValuesError(2);
          else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
          __PYX_ERR(0, 1684, __pyx_L1_error)
        }
        #if CYTHON_COMPILING_IN_CPYTHON
        if (likely(PyTuple_CheckExact(sequence))) {
          __pyx_t_7 = PyTuple_GET_ITEM(sequence, 0); 
          __pyx_t_9 = PyTuple_GET_ITEM(sequence, 1); 
        } else {
          __pyx_t_7 = PyList_GET_ITEM(sequence, 0); 
          __pyx_t_9 = PyList_GET_ITEM(sequence, 1); 
        }
        __Pyx_INCREF(__pyx_t_7);
        __Pyx_INCREF(__pyx_t_9);
        #else
        __pyx_t_7 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1684, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_7);
        __pyx_t_9 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1684, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_9);
        #endif
        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      } else {
        Py_ssize_t index = -1;
        __pyx_t_2 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1684, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
        __pyx_t_10 = Py_TYPE(__pyx_t_2)->tp_iternext;
        index = 0; __pyx_t_7 = __pyx_t_10(__pyx_t_2); if (unlikely(!__pyx_t_7)) goto __pyx_L7_unpacking_failed;
        __Pyx_GOTREF(__pyx_t_7);
        index = 1; __pyx_t_9 = __pyx_t_10(__pyx_t_2); if (unlikely(!__pyx_t_9)) goto __pyx_L7_unpacking_failed;
        __Pyx_GOTREF(__pyx_t_9);
        if (__Pyx_IternextUnpackEndCheck(__pyx_t_10(__pyx_t_2), 2) < 0) __PYX_ERR(0, 1684, __pyx_L1_error)
        __pyx_t_10 = NULL;
        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
        goto __pyx_L8_unpacking_done;
        __pyx_L7_unpacking_failed:;
        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
        __pyx_t_10 = NULL;
        if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
        __PYX_ERR(0, 1684, __pyx_L1_error)
        __pyx_L8_unpacking_done:;
      }
      __Pyx_DECREF_SET(__pyx_v_window_size, __pyx_t_7);
      __pyx_t_7 = 0;
      __Pyx_DECREF_SET(__pyx_v_window_size_qc, __pyx_t_9);
      __pyx_t_9 = 0;

      /* "vapor_vali/Simple_function.pyx":1685
 *             alt_seq=ref_seq[:flank_length]+ref_seq[flank_length:(-flank_length)]+ref_seq[flank_length:(-flank_length)]+ref_seq[-flank_length:]
 *             [window_size,window_size_qc]=window_size_refine(alt_seq)
 *             if not window_size=='Error':             # <<<<<<<<<<<<<<
 *                 all_reads=simple_chop_pacbio_read_simple_short(bam_in,sv_info[:2]+[sv_info[1]+2*(sv_info[2]-sv_info[1])],flank_length)
 *                 if len(all_reads)>10:
 */
      __pyx_t_11 = (__Pyx_PyString_Equals(__pyx_v_window_size, __pyx_n_s_Error, Py_EQ)); if (unlikely(__pyx_t_11 < 0)) __PYX_ERR(0, 1685, __pyx_L1_error)
      __pyx_t_5 = ((!__pyx_t_11) != 0);
      if (__pyx_t_5) {

        /* "vapor_vali/Simple_function.pyx":1686
 *             [window_size,window_size_qc]=window_size_refine(alt_seq)
 *             if not window_size=='Error':
 *                 all_reads=simple_chop_pacbio_read_simple_short(bam_in,sv_info[:2]+[sv_info[1]+2*(sv_info[2]-sv_info[1])],flank_length)             # <<<<<<<<<<<<<<
 *                 if len(all_reads)>10:
 *                     best_read_rec=''
 */
        __pyx_t_9 = __Pyx_GetModuleGlobalName(__pyx_n_s_simple_chop_pacbio_read_simple_s); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1686, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_9);
        __pyx_t_7 = __Pyx_PyObject_GetSlice(__pyx_v_sv_info, 0, 2, NULL, NULL, &__pyx_slice__134, 0, 1, 1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1686, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_7);
        __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_sv_info, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1686, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
        __pyx_t_6 = __Pyx_GetItemInt(__pyx_v_sv_info, 2, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1686, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_6);
        __pyx_t_4 = __Pyx_GetItemInt(__pyx_v_sv_info, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1686, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_4);
        __pyx_t_3 = PyNumber_Subtract(__pyx_t_6, __pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1686, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_3);
        __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
        __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
        __pyx_t_4 = PyNumber_Multiply(__pyx_int_2, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1686, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_4);
        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
        __pyx_t_3 = PyNumber_Add(__pyx_t_2, __pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1686, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_3);
        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
        __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
        __pyx_t_4 = PyList_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1686, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_4);
        __Pyx_GIVEREF(__pyx_t_3);
        PyList_SET_ITEM(__pyx_t_4, 0, __pyx_t_3);
        __pyx_t_3 = 0;
        __pyx_t_3 = PyNumber_Add(__pyx_t_7, __pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1686, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_3);
        __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
        __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
        __pyx_t_4 = NULL;
        __pyx_t_8 = 0;
        if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_9))) {
          __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_9);
          if (likely(__pyx_t_4)) {
            PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_9);
            __Pyx_INCREF(__pyx_t_4);
            __Pyx_INCREF(function);
            __Pyx_DECREF_SET(__pyx_t_9, function);
            __pyx_t_8 = 1;
          }
        }
        __pyx_t_7 = PyTuple_New(3+__pyx_t_8); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1686, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_7);
        if (__pyx_t_4) {
          __Pyx_GIVEREF(__pyx_t_4); PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_4); __pyx_t_4 = NULL;
        }
        __Pyx_INCREF(__pyx_v_bam_in);
        __Pyx_GIVEREF(__pyx_v_bam_in);
        PyTuple_SET_ITEM(__pyx_t_7, 0+__pyx_t_8, __pyx_v_bam_in);
        __Pyx_GIVEREF(__pyx_t_3);
        PyTuple_SET_ITEM(__pyx_t_7, 1+__pyx_t_8, __pyx_t_3);
        __Pyx_INCREF(__pyx_v_flank_length);
        __Pyx_GIVEREF(__pyx_v_flank_length);
        PyTuple_SET_ITEM(__pyx_t_7, 2+__pyx_t_8, __pyx_v_flank_length);
        __pyx_t_3 = 0;
        __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_9, __pyx_t_7, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1686, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
        __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
        __pyx_v_all_reads = __pyx_t_1;
        __pyx_t_1 = 0;

        /* "vapor_vali/Simple_function.pyx":1687
 *             if not window_size=='Error':
 *                 all_reads=simple_chop_pacbio_read_simple_short(bam_in,sv_info[:2]+[sv_info[1]+2*(sv_info[2]-sv_info[1])],flank_length)
 *                 if len(all_reads)>10:             # <<<<<<<<<<<<<<
 *                     best_read_rec=''
 *                     for x in all_reads:
 */
        __pyx_t_8 = PyObject_Length(__pyx_v_all_reads); if (unlikely(__pyx_t_8 == -1)) __PYX_ERR(0, 1687, __pyx_L1_error)
        __pyx_t_5 = ((__pyx_t_8 > 10) != 0);
        if (__pyx_t_5) {

          /* "vapor_vali/Simple_function.pyx":1688
 *                 all_reads=simple_chop_pacbio_read_simple_short(bam_in,sv_info[:2]+[sv_info[1]+2*(sv_info[2]-sv_info[1])],flank_length)
 *                 if len(all_reads)>10:
 *                     best_read_rec=''             # <<<<<<<<<<<<<<
 *                     for x in all_reads:
 *                         vapor_single_read_score=calcu_vapor_single_read_score_directed_dis_m1b_redefine_diagnal(ref_seq,alt_seq,x,window_size)
 */
          __Pyx_INCREF(__pyx_kp_s__24);
          __Pyx_DECREF_SET(__pyx_v_best_read_rec, __pyx_kp_s__24);

          /* "vapor_vali/Simple_function.pyx":1689
 *                 if len(all_reads)>10:
 *                     best_read_rec=''
 *                     for x in all_reads:             # <<<<<<<<<<<<<<
 *                         vapor_single_read_score=calcu_vapor_single_read_score_directed_dis_m1b_redefine_diagnal(ref_seq,alt_seq,x,window_size)
 *                         if not 0 in vapor_single_read_score:
 */
          if (likely(PyList_CheckExact(__pyx_v_all_reads)) || PyTuple_CheckExact(__pyx_v_all_reads)) {
            __pyx_t_1 = __pyx_v_all_reads; __Pyx_INCREF(__pyx_t_1); __pyx_t_8 = 0;
            __pyx_t_12 = NULL;
          } else {
            __pyx_t_8 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_v_all_reads); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1689, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_1);
            __pyx_t_12 = Py_TYPE(__pyx_t_1)->tp_iternext; if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1689, __pyx_L1_error)
          }
          for (;;) {
            if (likely(!__pyx_t_12)) {
              if (likely(PyList_CheckExact(__pyx_t_1))) {
                if (__pyx_t_8 >= PyList_GET_SIZE(__pyx_t_1)) break;
                #if CYTHON_COMPILING_IN_CPYTHON
                __pyx_t_9 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_8); __Pyx_INCREF(__pyx_t_9); __pyx_t_8++; if (unlikely(0 < 0)) __PYX_ERR(0, 1689, __pyx_L1_error)
                #else
                __pyx_t_9 = PySequence_ITEM(__pyx_t_1, __pyx_t_8); __pyx_t_8++; if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1689, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_9);
                #endif
              } else {
                if (__pyx_t_8 >= PyTuple_GET_SIZE(__pyx_t_1)) break;
                #if CYTHON_COMPILING_IN_CPYTHON
                __pyx_t_9 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_8); __Pyx_INCREF(__pyx_t_9); __pyx_t_8++; if (unlikely(0 < 0)) __PYX_ERR(0, 1689, __pyx_L1_error)
                #else
                __pyx_t_9 = PySequence_ITEM(__pyx_t_1, __pyx_t_8); __pyx_t_8++; if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1689, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_9);
                #endif
              }
            } else {
              __pyx_t_9 = __pyx_t_12(__pyx_t_1);
              if (unlikely(!__pyx_t_9)) {
                PyObject* exc_type = PyErr_Occurred();
                if (exc_type) {
                  if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
                  else __PYX_ERR(0, 1689, __pyx_L1_error)
                }
                break;
              }
              __Pyx_GOTREF(__pyx_t_9);
            }
            __Pyx_XDECREF_SET(__pyx_v_x, __pyx_t_9);
            __pyx_t_9 = 0;

            /* "vapor_vali/Simple_function.pyx":1690
 *                     best_read_rec=''
 *                     for x in all_reads:
 *                         vapor_single_read_score=calcu_vapor_single_read_score_directed_dis_m1b_redefine_diagnal(ref_seq,alt_seq,x,window_size)             # <<<<<<<<<<<<<<
 *                         if not 0 in vapor_single_read_score:
 *                             vapor_score_list.append(1-float(vapor_single_read_score[1])/float(vapor_single_read_score[0]))
 */
            __pyx_t_7 = __Pyx_GetModuleGlobalName(__pyx_n_s_calcu_vapor_single_read_score_di); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1690, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_7);
            __pyx_t_3 = NULL;
            __pyx_t_13 = 0;
            if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_7))) {
              __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_7);
              if (likely(__pyx_t_3)) {
                PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_7);
                __Pyx_INCREF(__pyx_t_3);
                __Pyx_INCREF(function);
                __Pyx_DECREF_SET(__pyx_t_7, function);
                __pyx_t_13 = 1;
              }
            }
            __pyx_t_4 = PyTuple_New(4+__pyx_t_13); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1690, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_4);
            if (__pyx_t_3) {
              __Pyx_GIVEREF(__pyx_t_3); PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3); __pyx_t_3 = NULL;
            }
            __Pyx_INCREF(__pyx_v_ref_seq);
            __Pyx_GIVEREF(__pyx_v_ref_seq);
            PyTuple_SET_ITEM(__pyx_t_4, 0+__pyx_t_13, __pyx_v_ref_seq);
            __Pyx_INCREF(__pyx_v_alt_seq);
            __Pyx_GIVEREF(__pyx_v_alt_seq);
            PyTuple_SET_ITEM(__pyx_t_4, 1+__pyx_t_13, __pyx_v_alt_seq);
            __Pyx_INCREF(__pyx_v_x);
            __Pyx_GIVEREF(__pyx_v_x);
            PyTuple_SET_ITEM(__pyx_t_4, 2+__pyx_t_13, __pyx_v_x);
            __Pyx_INCREF(__pyx_v_window_size);
            __Pyx_GIVEREF(__pyx_v_window_size);
            PyTuple_SET_ITEM(__pyx_t_4, 3+__pyx_t_13, __pyx_v_window_size);
            __pyx_t_9 = __Pyx_PyObject_Call(__pyx_t_7, __pyx_t_4, NULL); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1690, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_9);
            __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
            __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
            __Pyx_XDECREF_SET(__pyx_v_vapor_single_read_score, __pyx_t_9);
            __pyx_t_9 = 0;

            /* "vapor_vali/Simple_function.pyx":1691
 *                     for x in all_reads:
 *                         vapor_single_read_score=calcu_vapor_single_read_score_directed_dis_m1b_redefine_diagnal(ref_seq,alt_seq,x,window_size)
 *                         if not 0 in vapor_single_read_score:             # <<<<<<<<<<<<<<
 *                             vapor_score_list.append(1-float(vapor_single_read_score[1])/float(vapor_single_read_score[0]))
 *                             if vapor_score_list[-1]==max(vapor_score_list):best_read_rec=x
 */
            __pyx_t_5 = (__Pyx_PySequence_ContainsTF(__pyx_int_0, __pyx_v_vapor_single_read_score, Py_NE)); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 1691, __pyx_L1_error)
            __pyx_t_11 = (__pyx_t_5 != 0);
            if (__pyx_t_11) {

              /* "vapor_vali/Simple_function.pyx":1692
 *                         vapor_single_read_score=calcu_vapor_single_read_score_directed_dis_m1b_redefine_diagnal(ref_seq,alt_seq,x,window_size)
 *                         if not 0 in vapor_single_read_score:
 *                             vapor_score_list.append(1-float(vapor_single_read_score[1])/float(vapor_single_read_score[0]))             # <<<<<<<<<<<<<<
 *                             if vapor_score_list[-1]==max(vapor_score_list):best_read_rec=x
 *                     make_event_figure_1(vapor_score_list,best_read_rec,window_size,ref_seq,alt_seq,out_figure_name)
 */
              __pyx_t_9 = __Pyx_GetItemInt(__pyx_v_vapor_single_read_score, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1692, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_9);
              __pyx_t_14 = __Pyx_PyObject_AsDouble(__pyx_t_9); if (unlikely(__pyx_t_14 == ((double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1692, __pyx_L1_error)
              __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
              __pyx_t_9 = __Pyx_GetItemInt(__pyx_v_vapor_single_read_score, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1692, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_9);
              __pyx_t_15 = __Pyx_PyObject_AsDouble(__pyx_t_9); if (unlikely(__pyx_t_15 == ((double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1692, __pyx_L1_error)
              __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
              if (unlikely(__pyx_t_15 == 0)) {
                PyErr_SetString(PyExc_ZeroDivisionError, "float division");
                __PYX_ERR(0, 1692, __pyx_L1_error)
              }
              __pyx_t_9 = PyFloat_FromDouble((1.0 - (__pyx_t_14 / __pyx_t_15))); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1692, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_9);
              __pyx_t_16 = __Pyx_PyList_Append(__pyx_v_vapor_score_list, __pyx_t_9); if (unlikely(__pyx_t_16 == -1)) __PYX_ERR(0, 1692, __pyx_L1_error)
              __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;

              /* "vapor_vali/Simple_function.pyx":1693
 *                         if not 0 in vapor_single_read_score:
 *                             vapor_score_list.append(1-float(vapor_single_read_score[1])/float(vapor_single_read_score[0]))
 *                             if vapor_score_list[-1]==max(vapor_score_list):best_read_rec=x             # <<<<<<<<<<<<<<
 *                     make_event_figure_1(vapor_score_list,best_read_rec,window_size,ref_seq,alt_seq,out_figure_name)
 *                     return vapor_score_list
 */
              __pyx_t_9 = __Pyx_GetItemInt_List(__pyx_v_vapor_score_list, -1L, long, 1, __Pyx_PyInt_From_long, 1, 1, 1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1693, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_9);
              __pyx_t_7 = PyTuple_New(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1693, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_7);
              __Pyx_INCREF(__pyx_v_vapor_score_list);
              __Pyx_GIVEREF(__pyx_v_vapor_score_list);
              PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_v_vapor_score_list);
              __pyx_t_4 = __Pyx_PyObject_Call(__pyx_builtin_max, __pyx_t_7, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1693, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_4);
              __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
              __pyx_t_7 = PyObject_RichCompare(__pyx_t_9, __pyx_t_4, Py_EQ); __Pyx_XGOTREF(__pyx_t_7); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1693, __pyx_L1_error)
              __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
              __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
              __pyx_t_11 = __Pyx_PyObject_IsTrue(__pyx_t_7); if (unlikely(__pyx_t_11 < 0)) __PYX_ERR(0, 1693, __pyx_L1_error)
              __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
              if (__pyx_t_11) {
                __Pyx_INCREF(__pyx_v_x);
                __Pyx_DECREF_SET(__pyx_v_best_read_rec, __pyx_v_x);
              }

              /* "vapor_vali/Simple_function.pyx":1691
 *                     for x in all_reads:
 *                         vapor_single_read_score=calcu_vapor_single_read_score_directed_dis_m1b_redefine_diagnal(ref_seq,alt_seq,x,window_size)
 *                         if not 0 in vapor_single_read_score:             # <<<<<<<<<<<<<<
 *                             vapor_score_list.append(1-float(vapor_single_read_score[1])/float(vapor_single_read_score[0]))
 *                             if vapor_score_list[-1]==max(vapor_score_list):best_read_rec=x
 */
            }

            /* "vapor_vali/Simple_function.pyx":1689
 *                 if len(all_reads)>10:
 *                     best_read_rec=''
 *                     for x in all_reads:             # <<<<<<<<<<<<<<
 *                         vapor_single_read_score=calcu_vapor_single_read_score_directed_dis_m1b_redefine_diagnal(ref_seq,alt_seq,x,window_size)
 *                         if not 0 in vapor_single_read_score:
 */
          }
          __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

          /* "vapor_vali/Simple_function.pyx":1694
 *                             vapor_score_list.append(1-float(vapor_single_read_score[1])/float(vapor_single_read_score[0]))
 *                             if vapor_score_list[-1]==max(vapor_score_list):best_read_rec=x
 *                     make_event_figure_1(vapor_score_list,best_read_rec,window_size,ref_seq,alt_seq,out_figure_name)             # <<<<<<<<<<<<<<
 *                     return vapor_score_list
 *     ref_seq=ref_seq_readin(ref,sv_info[0],sv_info[2]-flank_length,sv_info[2]+flank_length)
 */
          __pyx_t_7 = __Pyx_GetModuleGlobalName(__pyx_n_s_make_event_figure_1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1694, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_7);
          __pyx_t_4 = NULL;
          __pyx_t_8 = 0;
          if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_7))) {
            __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_7);
            if (likely(__pyx_t_4)) {
              PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_7);
              __Pyx_INCREF(__pyx_t_4);
              __Pyx_INCREF(function);
              __Pyx_DECREF_SET(__pyx_t_7, function);
              __pyx_t_8 = 1;
            }
          }
          __pyx_t_9 = PyTuple_New(6+__pyx_t_8); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1694, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_9);
          if (__pyx_t_4) {
            __Pyx_GIVEREF(__pyx_t_4); PyTuple_SET_ITEM(__pyx_t_9, 0, __pyx_t_4); __pyx_t_4 = NULL;
          }
          __Pyx_INCREF(__pyx_v_vapor_score_list);
          __Pyx_GIVEREF(__pyx_v_vapor_score_list);
          PyTuple_SET_ITEM(__pyx_t_9, 0+__pyx_t_8, __pyx_v_vapor_score_list);
          __Pyx_INCREF(__pyx_v_best_read_rec);
          __Pyx_GIVEREF(__pyx_v_best_read_rec);
          PyTuple_SET_ITEM(__pyx_t_9, 1+__pyx_t_8, __pyx_v_best_read_rec);
          __Pyx_INCREF(__pyx_v_window_size);
          __Pyx_GIVEREF(__pyx_v_window_size);
          PyTuple_SET_ITEM(__pyx_t_9, 2+__pyx_t_8, __pyx_v_window_size);
          __Pyx_INCREF(__pyx_v_ref_seq);
          __Pyx_GIVEREF(__pyx_v_ref_seq);
          PyTuple_SET_ITEM(__pyx_t_9, 3+__pyx_t_8, __pyx_v_ref_seq);
          __Pyx_INCREF(__pyx_v_alt_seq);
          __Pyx_GIVEREF(__pyx_v_alt_seq);
          PyTuple_SET_ITEM(__pyx_t_9, 4+__pyx_t_8, __pyx_v_alt_seq);
          __Pyx_INCREF(__pyx_v_out_figure_name);
          __Pyx_GIVEREF(__pyx_v_out_figure_name);
          PyTuple_SET_ITEM(__pyx_t_9, 5+__pyx_t_8, __pyx_v_out_figure_name);
          __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_7, __pyx_t_9, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1694, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_1);
          __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
          __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
          __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

          /* "vapor_vali/Simple_function.pyx":1695
 *                             if vapor_score_list[-1]==max(vapor_score_list):best_read_rec=x
 *                     make_event_figure_1(vapor_score_list,best_read_rec,window_size,ref_seq,alt_seq,out_figure_name)
 *                     return vapor_score_list             # <<<<<<<<<<<<<<
 *     ref_seq=ref_seq_readin(ref,sv_info[0],sv_info[2]-flank_length,sv_info[2]+flank_length)
 *     [window_size,window_size_qc]=window_size_refine(ref_seq)
 */
          __Pyx_XDECREF(__pyx_r);
          __Pyx_INCREF(__pyx_v_vapor_score_list);
          __pyx_r = __pyx_v_vapor_score_list;
          goto __pyx_L0;

          /* "vapor_vali/Simple_function.pyx":1687
 *             if not window_size=='Error':
 *                 all_reads=simple_chop_pacbio_read_simple_short(bam_in,sv_info[:2]+[sv_info[1]+2*(sv_info[2]-sv_info[1])],flank_length)
 *                 if len(all_reads)>10:             # <<<<<<<<<<<<<<
 *                     best_read_rec=''
 *                     for x in all_reads:
 */
        }

        /* "vapor_vali/Simple_function.pyx":1685
 *             alt_seq=ref_seq[:flank_length]+ref_seq[flank_length:(-flank_length)]+ref_seq[flank_length:(-flank_length)]+ref_seq[-flank_length:]
 *             [window_size,window_size_qc]=window_size_refine(alt_seq)
 *             if not window_size=='Error':             # <<<<<<<<<<<<<<
 *                 all_reads=simple_chop_pacbio_read_simple_short(bam_in,sv_info[:2]+[sv_info[1]+2*(sv_info[2]-sv_info[1])],flank_length)
 *                 if len(all_reads)>10:
 */
      }

      /* "vapor_vali/Simple_function.pyx":1682
 *         ref_seq=ref_seq_readin(ref,sv_info[0],sv_info[1]-flank_length,sv_info[2]+flank_length)
 *         [window_size,window_size_qc]=window_size_refine(ref_seq)
 *         if not window_size=='Error':             # <<<<<<<<<<<<<<
 *             alt_seq=ref_seq[:flank_length]+ref_seq[flank_length:(-flank_length)]+ref_seq[flank_length:(-flank_length)]+ref_seq[-flank_length:]
 *             [window_size,window_size_qc]=window_size_refine(alt_seq)
 */
    }

    /* "vapor_vali/Simple_function.pyx":1679
 *     vapor_score_list=[]
 *     best_read_rec=''
 *     if sv_info[2]-sv_info[1]<default_max_sv_test: #only try to read in all reads with sv <100K; else: try breakpoints ;             # <<<<<<<<<<<<<<
 *         ref_seq=ref_seq_readin(ref,sv_info[0],sv_info[1]-flank_length,sv_info[2]+flank_length)
 *         [window_size,window_size_qc]=window_size_refine(ref_seq)
 */
  }

  /* "vapor_vali/Simple_function.pyx":1696
 *                     make_event_figure_1(vapor_score_list,best_read_rec,window_size,ref_seq,alt_seq,out_figure_name)
 *                     return vapor_score_list
 *     ref_seq=ref_seq_readin(ref,sv_info[0],sv_info[2]-flank_length,sv_info[2]+flank_length)             # <<<<<<<<<<<<<<
 *     [window_size,window_size_qc]=window_size_refine(ref_seq)
 *     if not window_size=='Error':
 */
  __pyx_t_7 = __Pyx_GetModuleGlobalName(__pyx_n_s_ref_seq_readin); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1696, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  __pyx_t_9 = __Pyx_GetItemInt(__pyx_v_sv_info, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1696, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_9);
  __pyx_t_4 = __Pyx_GetItemInt(__pyx_v_sv_info, 2, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1696, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_3 = PyNumber_Subtract(__pyx_t_4, __pyx_v_flank_length); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1696, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = __Pyx_GetItemInt(__pyx_v_sv_info, 2, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1696, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_2 = PyNumber_Add(__pyx_t_4, __pyx_v_flank_length); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1696, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = NULL;
  __pyx_t_8 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_7))) {
    __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_7);
    if (likely(__pyx_t_4)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_7);
      __Pyx_INCREF(__pyx_t_4);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_7, function);
      __pyx_t_8 = 1;
    }
  }
  __pyx_t_6 = PyTuple_New(4+__pyx_t_8); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1696, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  if (__pyx_t_4) {
    __Pyx_GIVEREF(__pyx_t_4); PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_4); __pyx_t_4 = NULL;
  }
  __Pyx_INCREF(__pyx_v_ref);
  __Pyx_GIVEREF(__pyx_v_ref);
  PyTuple_SET_ITEM(__pyx_t_6, 0+__pyx_t_8, __pyx_v_ref);
  __Pyx_GIVEREF(__pyx_t_9);
  PyTuple_SET_ITEM(__pyx_t_6, 1+__pyx_t_8, __pyx_t_9);
  __Pyx_GIVEREF(__pyx_t_3);
  PyTuple_SET_ITEM(__pyx_t_6, 2+__pyx_t_8, __pyx_t_3);
  __Pyx_GIVEREF(__pyx_t_2);
  PyTuple_SET_ITEM(__pyx_t_6, 3+__pyx_t_8, __pyx_t_2);
  __pyx_t_9 = 0;
  __pyx_t_3 = 0;
  __pyx_t_2 = 0;
  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_7, __pyx_t_6, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1696, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
  __Pyx_XDECREF_SET(__pyx_v_ref_seq, __pyx_t_1);
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":1697
 *                     return vapor_score_list
 *     ref_seq=ref_seq_readin(ref,sv_info[0],sv_info[2]-flank_length,sv_info[2]+flank_length)
 *     [window_size,window_size_qc]=window_size_refine(ref_seq)             # <<<<<<<<<<<<<<
 *     if not window_size=='Error':
 *         alt_seq=ref_seq_readin(ref,sv_info[0],sv_info[2]-flank_length,sv_info[2])+ref_seq_readin(ref,sv_info[0],sv_info[1],sv_info[1]+flank_length)
 */
  __pyx_t_7 = __Pyx_GetModuleGlobalName(__pyx_n_s_window_size_refine); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1697, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  __pyx_t_6 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_7))) {
    __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_7);
    if (likely(__pyx_t_6)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_7);
      __Pyx_INCREF(__pyx_t_6);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_7, function);
    }
  }
  if (!__pyx_t_6) {
    __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_7, __pyx_v_ref_seq); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1697, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
  } else {
    __pyx_t_2 = PyTuple_New(1+1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1697, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_GIVEREF(__pyx_t_6); PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_6); __pyx_t_6 = NULL;
    __Pyx_INCREF(__pyx_v_ref_seq);
    __Pyx_GIVEREF(__pyx_v_ref_seq);
    PyTuple_SET_ITEM(__pyx_t_2, 0+1, __pyx_v_ref_seq);
    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_7, __pyx_t_2, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1697, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  }
  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
  if ((likely(PyTuple_CheckExact(__pyx_t_1))) || (PyList_CheckExact(__pyx_t_1))) {
    PyObject* sequence = __pyx_t_1;
    #if CYTHON_COMPILING_IN_CPYTHON
    Py_ssize_t size = Py_SIZE(sequence);
    #else
    Py_ssize_t size = PySequence_Size(sequence);
    #endif
    if (unlikely(size != 2)) {
      if (size > 2) __Pyx_RaiseTooManyValuesError(2);
      else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
      __PYX_ERR(0, 1697, __pyx_L1_error)
    }
    #if CYTHON_COMPILING_IN_CPYTHON
    if (likely(PyTuple_CheckExact(sequence))) {
      __pyx_t_7 = PyTuple_GET_ITEM(sequence, 0); 
      __pyx_t_2 = PyTuple_GET_ITEM(sequence, 1); 
    } else {
      __pyx_t_7 = PyList_GET_ITEM(sequence, 0); 
      __pyx_t_2 = PyList_GET_ITEM(sequence, 1); 
    }
    __Pyx_INCREF(__pyx_t_7);
    __Pyx_INCREF(__pyx_t_2);
    #else
    __pyx_t_7 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1697, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    __pyx_t_2 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1697, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    #endif
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  } else {
    Py_ssize_t index = -1;
    __pyx_t_6 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1697, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_10 = Py_TYPE(__pyx_t_6)->tp_iternext;
    index = 0; __pyx_t_7 = __pyx_t_10(__pyx_t_6); if (unlikely(!__pyx_t_7)) goto __pyx_L15_unpacking_failed;
    __Pyx_GOTREF(__pyx_t_7);
    index = 1; __pyx_t_2 = __pyx_t_10(__pyx_t_6); if (unlikely(!__pyx_t_2)) goto __pyx_L15_unpacking_failed;
    __Pyx_GOTREF(__pyx_t_2);
    if (__Pyx_IternextUnpackEndCheck(__pyx_t_10(__pyx_t_6), 2) < 0) __PYX_ERR(0, 1697, __pyx_L1_error)
    __pyx_t_10 = NULL;
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    goto __pyx_L16_unpacking_done;
    __pyx_L15_unpacking_failed:;
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_10 = NULL;
    if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
    __PYX_ERR(0, 1697, __pyx_L1_error)
    __pyx_L16_unpacking_done:;
  }
  __Pyx_XDECREF_SET(__pyx_v_window_size, __pyx_t_7);
  __pyx_t_7 = 0;
  __Pyx_XDECREF_SET(__pyx_v_window_size_qc, __pyx_t_2);
  __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":1698
 *     ref_seq=ref_seq_readin(ref,sv_info[0],sv_info[2]-flank_length,sv_info[2]+flank_length)
 *     [window_size,window_size_qc]=window_size_refine(ref_seq)
 *     if not window_size=='Error':             # <<<<<<<<<<<<<<
 *         alt_seq=ref_seq_readin(ref,sv_info[0],sv_info[2]-flank_length,sv_info[2])+ref_seq_readin(ref,sv_info[0],sv_info[1],sv_info[1]+flank_length)
 *         [window_size,window_size_qc]=window_size_refine(alt_seq)
 */
  __pyx_t_11 = (__Pyx_PyString_Equals(__pyx_v_window_size, __pyx_n_s_Error, Py_EQ)); if (unlikely(__pyx_t_11 < 0)) __PYX_ERR(0, 1698, __pyx_L1_error)
  __pyx_t_5 = ((!__pyx_t_11) != 0);
  if (__pyx_t_5) {

    /* "vapor_vali/Simple_function.pyx":1699
 *     [window_size,window_size_qc]=window_size_refine(ref_seq)
 *     if not window_size=='Error':
 *         alt_seq=ref_seq_readin(ref,sv_info[0],sv_info[2]-flank_length,sv_info[2])+ref_seq_readin(ref,sv_info[0],sv_info[1],sv_info[1]+flank_length)             # <<<<<<<<<<<<<<
 *         [window_size,window_size_qc]=window_size_refine(alt_seq)
 *         if not window_size=='Error':
 */
    __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_ref_seq_readin); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1699, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_7 = __Pyx_GetItemInt(__pyx_v_sv_info, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1699, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    __pyx_t_6 = __Pyx_GetItemInt(__pyx_v_sv_info, 2, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1699, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __pyx_t_3 = PyNumber_Subtract(__pyx_t_6, __pyx_v_flank_length); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1699, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = __Pyx_GetItemInt(__pyx_v_sv_info, 2, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1699, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __pyx_t_9 = NULL;
    __pyx_t_8 = 0;
    if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_2))) {
      __pyx_t_9 = PyMethod_GET_SELF(__pyx_t_2);
      if (likely(__pyx_t_9)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
        __Pyx_INCREF(__pyx_t_9);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_2, function);
        __pyx_t_8 = 1;
      }
    }
    __pyx_t_4 = PyTuple_New(4+__pyx_t_8); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1699, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    if (__pyx_t_9) {
      __Pyx_GIVEREF(__pyx_t_9); PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_9); __pyx_t_9 = NULL;
    }
    __Pyx_INCREF(__pyx_v_ref);
    __Pyx_GIVEREF(__pyx_v_ref);
    PyTuple_SET_ITEM(__pyx_t_4, 0+__pyx_t_8, __pyx_v_ref);
    __Pyx_GIVEREF(__pyx_t_7);
    PyTuple_SET_ITEM(__pyx_t_4, 1+__pyx_t_8, __pyx_t_7);
    __Pyx_GIVEREF(__pyx_t_3);
    PyTuple_SET_ITEM(__pyx_t_4, 2+__pyx_t_8, __pyx_t_3);
    __Pyx_GIVEREF(__pyx_t_6);
    PyTuple_SET_ITEM(__pyx_t_4, 3+__pyx_t_8, __pyx_t_6);
    __pyx_t_7 = 0;
    __pyx_t_3 = 0;
    __pyx_t_6 = 0;
    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_4, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1699, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_4 = __Pyx_GetModuleGlobalName(__pyx_n_s_ref_seq_readin); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1699, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_6 = __Pyx_GetItemInt(__pyx_v_sv_info, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1699, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_sv_info, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1699, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_7 = __Pyx_GetItemInt(__pyx_v_sv_info, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1699, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    __pyx_t_9 = PyNumber_Add(__pyx_t_7, __pyx_v_flank_length); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1699, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_9);
    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_t_7 = NULL;
    __pyx_t_8 = 0;
    if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_4))) {
      __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_4);
      if (likely(__pyx_t_7)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
        __Pyx_INCREF(__pyx_t_7);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_4, function);
        __pyx_t_8 = 1;
      }
    }
    __pyx_t_17 = PyTuple_New(4+__pyx_t_8); if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 1699, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_17);
    if (__pyx_t_7) {
      __Pyx_GIVEREF(__pyx_t_7); PyTuple_SET_ITEM(__pyx_t_17, 0, __pyx_t_7); __pyx_t_7 = NULL;
    }
    __Pyx_INCREF(__pyx_v_ref);
    __Pyx_GIVEREF(__pyx_v_ref);
    PyTuple_SET_ITEM(__pyx_t_17, 0+__pyx_t_8, __pyx_v_ref);
    __Pyx_GIVEREF(__pyx_t_6);
    PyTuple_SET_ITEM(__pyx_t_17, 1+__pyx_t_8, __pyx_t_6);
    __Pyx_GIVEREF(__pyx_t_3);
    PyTuple_SET_ITEM(__pyx_t_17, 2+__pyx_t_8, __pyx_t_3);
    __Pyx_GIVEREF(__pyx_t_9);
    PyTuple_SET_ITEM(__pyx_t_17, 3+__pyx_t_8, __pyx_t_9);
    __pyx_t_6 = 0;
    __pyx_t_3 = 0;
    __pyx_t_9 = 0;
    __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_17, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1699, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(__pyx_t_17); __pyx_t_17 = 0;
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = PyNumber_Add(__pyx_t_1, __pyx_t_2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1699, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __Pyx_XDECREF_SET(__pyx_v_alt_seq, __pyx_t_4);
    __pyx_t_4 = 0;

    /* "vapor_vali/Simple_function.pyx":1700
 *     if not window_size=='Error':
 *         alt_seq=ref_seq_readin(ref,sv_info[0],sv_info[2]-flank_length,sv_info[2])+ref_seq_readin(ref,sv_info[0],sv_info[1],sv_info[1]+flank_length)
 *         [window_size,window_size_qc]=window_size_refine(alt_seq)             # <<<<<<<<<<<<<<
 *         if not window_size=='Error':
 *             all_reads=simple_del_chop_pacbio_read_simple_short(bam_in,[sv_info[0],sv_info[2]],flank_length)
 */
    __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_window_size_refine); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1700, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_1 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_2))) {
      __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_2);
      if (likely(__pyx_t_1)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
        __Pyx_INCREF(__pyx_t_1);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_2, function);
      }
    }
    if (!__pyx_t_1) {
      __pyx_t_4 = __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_v_alt_seq); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1700, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
    } else {
      __pyx_t_17 = PyTuple_New(1+1); if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 1700, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_17);
      __Pyx_GIVEREF(__pyx_t_1); PyTuple_SET_ITEM(__pyx_t_17, 0, __pyx_t_1); __pyx_t_1 = NULL;
      __Pyx_INCREF(__pyx_v_alt_seq);
      __Pyx_GIVEREF(__pyx_v_alt_seq);
      PyTuple_SET_ITEM(__pyx_t_17, 0+1, __pyx_v_alt_seq);
      __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_17, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1700, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      __Pyx_DECREF(__pyx_t_17); __pyx_t_17 = 0;
    }
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    if ((likely(PyTuple_CheckExact(__pyx_t_4))) || (PyList_CheckExact(__pyx_t_4))) {
      PyObject* sequence = __pyx_t_4;
      #if CYTHON_COMPILING_IN_CPYTHON
      Py_ssize_t size = Py_SIZE(sequence);
      #else
      Py_ssize_t size = PySequence_Size(sequence);
      #endif
      if (unlikely(size != 2)) {
        if (size > 2) __Pyx_RaiseTooManyValuesError(2);
        else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
        __PYX_ERR(0, 1700, __pyx_L1_error)
      }
      #if CYTHON_COMPILING_IN_CPYTHON
      if (likely(PyTuple_CheckExact(sequence))) {
        __pyx_t_2 = PyTuple_GET_ITEM(sequence, 0); 
        __pyx_t_17 = PyTuple_GET_ITEM(sequence, 1); 
      } else {
        __pyx_t_2 = PyList_GET_ITEM(sequence, 0); 
        __pyx_t_17 = PyList_GET_ITEM(sequence, 1); 
      }
      __Pyx_INCREF(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_17);
      #else
      __pyx_t_2 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1700, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __pyx_t_17 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 1700, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_17);
      #endif
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    } else {
      Py_ssize_t index = -1;
      __pyx_t_1 = PyObject_GetIter(__pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1700, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_10 = Py_TYPE(__pyx_t_1)->tp_iternext;
      index = 0; __pyx_t_2 = __pyx_t_10(__pyx_t_1); if (unlikely(!__pyx_t_2)) goto __pyx_L18_unpacking_failed;
      __Pyx_GOTREF(__pyx_t_2);
      index = 1; __pyx_t_17 = __pyx_t_10(__pyx_t_1); if (unlikely(!__pyx_t_17)) goto __pyx_L18_unpacking_failed;
      __Pyx_GOTREF(__pyx_t_17);
      if (__Pyx_IternextUnpackEndCheck(__pyx_t_10(__pyx_t_1), 2) < 0) __PYX_ERR(0, 1700, __pyx_L1_error)
      __pyx_t_10 = NULL;
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      goto __pyx_L19_unpacking_done;
      __pyx_L18_unpacking_failed:;
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_10 = NULL;
      if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
      __PYX_ERR(0, 1700, __pyx_L1_error)
      __pyx_L19_unpacking_done:;
    }
    __Pyx_DECREF_SET(__pyx_v_window_size, __pyx_t_2);
    __pyx_t_2 = 0;
    __Pyx_DECREF_SET(__pyx_v_window_size_qc, __pyx_t_17);
    __pyx_t_17 = 0;

    /* "vapor_vali/Simple_function.pyx":1701
 *         alt_seq=ref_seq_readin(ref,sv_info[0],sv_info[2]-flank_length,sv_info[2])+ref_seq_readin(ref,sv_info[0],sv_info[1],sv_info[1]+flank_length)
 *         [window_size,window_size_qc]=window_size_refine(alt_seq)
 *         if not window_size=='Error':             # <<<<<<<<<<<<<<
 *             all_reads=simple_del_chop_pacbio_read_simple_short(bam_in,[sv_info[0],sv_info[2]],flank_length)
 *             if len(all_reads)>0:
 */
    __pyx_t_5 = (__Pyx_PyString_Equals(__pyx_v_window_size, __pyx_n_s_Error, Py_EQ)); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 1701, __pyx_L1_error)
    __pyx_t_11 = ((!__pyx_t_5) != 0);
    if (__pyx_t_11) {

      /* "vapor_vali/Simple_function.pyx":1702
 *         [window_size,window_size_qc]=window_size_refine(alt_seq)
 *         if not window_size=='Error':
 *             all_reads=simple_del_chop_pacbio_read_simple_short(bam_in,[sv_info[0],sv_info[2]],flank_length)             # <<<<<<<<<<<<<<
 *             if len(all_reads)>0:
 *                 best_read_rec=''
 */
      __pyx_t_17 = __Pyx_GetModuleGlobalName(__pyx_n_s_simple_del_chop_pacbio_read_simp); if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 1702, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_17);
      __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_sv_info, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1702, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_sv_info, 2, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1702, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __pyx_t_9 = PyList_New(2); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1702, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_9);
      __Pyx_GIVEREF(__pyx_t_2);
      PyList_SET_ITEM(__pyx_t_9, 0, __pyx_t_2);
      __Pyx_GIVEREF(__pyx_t_1);
      PyList_SET_ITEM(__pyx_t_9, 1, __pyx_t_1);
      __pyx_t_2 = 0;
      __pyx_t_1 = 0;
      __pyx_t_1 = NULL;
      __pyx_t_8 = 0;
      if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_17))) {
        __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_17);
        if (likely(__pyx_t_1)) {
          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_17);
          __Pyx_INCREF(__pyx_t_1);
          __Pyx_INCREF(function);
          __Pyx_DECREF_SET(__pyx_t_17, function);
          __pyx_t_8 = 1;
        }
      }
      __pyx_t_2 = PyTuple_New(3+__pyx_t_8); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1702, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      if (__pyx_t_1) {
        __Pyx_GIVEREF(__pyx_t_1); PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_1); __pyx_t_1 = NULL;
      }
      __Pyx_INCREF(__pyx_v_bam_in);
      __Pyx_GIVEREF(__pyx_v_bam_in);
      PyTuple_SET_ITEM(__pyx_t_2, 0+__pyx_t_8, __pyx_v_bam_in);
      __Pyx_GIVEREF(__pyx_t_9);
      PyTuple_SET_ITEM(__pyx_t_2, 1+__pyx_t_8, __pyx_t_9);
      __Pyx_INCREF(__pyx_v_flank_length);
      __Pyx_GIVEREF(__pyx_v_flank_length);
      PyTuple_SET_ITEM(__pyx_t_2, 2+__pyx_t_8, __pyx_v_flank_length);
      __pyx_t_9 = 0;
      __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_17, __pyx_t_2, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1702, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      __Pyx_DECREF(__pyx_t_17); __pyx_t_17 = 0;
      __Pyx_XDECREF_SET(__pyx_v_all_reads, __pyx_t_4);
      __pyx_t_4 = 0;

      /* "vapor_vali/Simple_function.pyx":1703
 *         if not window_size=='Error':
 *             all_reads=simple_del_chop_pacbio_read_simple_short(bam_in,[sv_info[0],sv_info[2]],flank_length)
 *             if len(all_reads)>0:             # <<<<<<<<<<<<<<
 *                 best_read_rec=''
 *                 for x in all_reads:
 */
      __pyx_t_8 = PyObject_Length(__pyx_v_all_reads); if (unlikely(__pyx_t_8 == -1)) __PYX_ERR(0, 1703, __pyx_L1_error)
      __pyx_t_11 = ((__pyx_t_8 > 0) != 0);
      if (__pyx_t_11) {

        /* "vapor_vali/Simple_function.pyx":1704
 *             all_reads=simple_del_chop_pacbio_read_simple_short(bam_in,[sv_info[0],sv_info[2]],flank_length)
 *             if len(all_reads)>0:
 *                 best_read_rec=''             # <<<<<<<<<<<<<<
 *                 for x in all_reads:
 *                     vapor_single_read_score=calcu_vapor_single_read_score_within_10Perc_m1b(ref_seq,alt_seq,x,window_size)
 */
        __Pyx_INCREF(__pyx_kp_s__24);
        __Pyx_DECREF_SET(__pyx_v_best_read_rec, __pyx_kp_s__24);

        /* "vapor_vali/Simple_function.pyx":1705
 *             if len(all_reads)>0:
 *                 best_read_rec=''
 *                 for x in all_reads:             # <<<<<<<<<<<<<<
 *                     vapor_single_read_score=calcu_vapor_single_read_score_within_10Perc_m1b(ref_seq,alt_seq,x,window_size)
 *                     if not 0 in vapor_single_read_score:
 */
        if (likely(PyList_CheckExact(__pyx_v_all_reads)) || PyTuple_CheckExact(__pyx_v_all_reads)) {
          __pyx_t_4 = __pyx_v_all_reads; __Pyx_INCREF(__pyx_t_4); __pyx_t_8 = 0;
          __pyx_t_12 = NULL;
        } else {
          __pyx_t_8 = -1; __pyx_t_4 = PyObject_GetIter(__pyx_v_all_reads); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1705, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_4);
          __pyx_t_12 = Py_TYPE(__pyx_t_4)->tp_iternext; if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1705, __pyx_L1_error)
        }
        for (;;) {
          if (likely(!__pyx_t_12)) {
            if (likely(PyList_CheckExact(__pyx_t_4))) {
              if (__pyx_t_8 >= PyList_GET_SIZE(__pyx_t_4)) break;
              #if CYTHON_COMPILING_IN_CPYTHON
              __pyx_t_17 = PyList_GET_ITEM(__pyx_t_4, __pyx_t_8); __Pyx_INCREF(__pyx_t_17); __pyx_t_8++; if (unlikely(0 < 0)) __PYX_ERR(0, 1705, __pyx_L1_error)
              #else
              __pyx_t_17 = PySequence_ITEM(__pyx_t_4, __pyx_t_8); __pyx_t_8++; if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 1705, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_17);
              #endif
            } else {
              if (__pyx_t_8 >= PyTuple_GET_SIZE(__pyx_t_4)) break;
              #if CYTHON_COMPILING_IN_CPYTHON
              __pyx_t_17 = PyTuple_GET_ITEM(__pyx_t_4, __pyx_t_8); __Pyx_INCREF(__pyx_t_17); __pyx_t_8++; if (unlikely(0 < 0)) __PYX_ERR(0, 1705, __pyx_L1_error)
              #else
              __pyx_t_17 = PySequence_ITEM(__pyx_t_4, __pyx_t_8); __pyx_t_8++; if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 1705, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_17);
              #endif
            }
          } else {
            __pyx_t_17 = __pyx_t_12(__pyx_t_4);
            if (unlikely(!__pyx_t_17)) {
              PyObject* exc_type = PyErr_Occurred();
              if (exc_type) {
                if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
                else __PYX_ERR(0, 1705, __pyx_L1_error)
              }
              break;
            }
            __Pyx_GOTREF(__pyx_t_17);
          }
          __Pyx_XDECREF_SET(__pyx_v_x, __pyx_t_17);
          __pyx_t_17 = 0;

          /* "vapor_vali/Simple_function.pyx":1706
 *                 best_read_rec=''
 *                 for x in all_reads:
 *                     vapor_single_read_score=calcu_vapor_single_read_score_within_10Perc_m1b(ref_seq,alt_seq,x,window_size)             # <<<<<<<<<<<<<<
 *                     if not 0 in vapor_single_read_score:
 *                         vapor_score_list.append(1-float(vapor_single_read_score[1])/float(vapor_single_read_score[0]))
 */
          __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_calcu_vapor_single_read_score_wi); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1706, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_2);
          __pyx_t_9 = NULL;
          __pyx_t_13 = 0;
          if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_2))) {
            __pyx_t_9 = PyMethod_GET_SELF(__pyx_t_2);
            if (likely(__pyx_t_9)) {
              PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
              __Pyx_INCREF(__pyx_t_9);
              __Pyx_INCREF(function);
              __Pyx_DECREF_SET(__pyx_t_2, function);
              __pyx_t_13 = 1;
            }
          }
          __pyx_t_1 = PyTuple_New(4+__pyx_t_13); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1706, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_1);
          if (__pyx_t_9) {
            __Pyx_GIVEREF(__pyx_t_9); PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_9); __pyx_t_9 = NULL;
          }
          __Pyx_INCREF(__pyx_v_ref_seq);
          __Pyx_GIVEREF(__pyx_v_ref_seq);
          PyTuple_SET_ITEM(__pyx_t_1, 0+__pyx_t_13, __pyx_v_ref_seq);
          __Pyx_INCREF(__pyx_v_alt_seq);
          __Pyx_GIVEREF(__pyx_v_alt_seq);
          PyTuple_SET_ITEM(__pyx_t_1, 1+__pyx_t_13, __pyx_v_alt_seq);
          __Pyx_INCREF(__pyx_v_x);
          __Pyx_GIVEREF(__pyx_v_x);
          PyTuple_SET_ITEM(__pyx_t_1, 2+__pyx_t_13, __pyx_v_x);
          __Pyx_INCREF(__pyx_v_window_size);
          __Pyx_GIVEREF(__pyx_v_window_size);
          PyTuple_SET_ITEM(__pyx_t_1, 3+__pyx_t_13, __pyx_v_window_size);
          __pyx_t_17 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_1, NULL); if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 1706, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_17);
          __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
          __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
          __Pyx_XDECREF_SET(__pyx_v_vapor_single_read_score, __pyx_t_17);
          __pyx_t_17 = 0;

          /* "vapor_vali/Simple_function.pyx":1707
 *                 for x in all_reads:
 *                     vapor_single_read_score=calcu_vapor_single_read_score_within_10Perc_m1b(ref_seq,alt_seq,x,window_size)
 *                     if not 0 in vapor_single_read_score:             # <<<<<<<<<<<<<<
 *                         vapor_score_list.append(1-float(vapor_single_read_score[1])/float(vapor_single_read_score[0]))
 *                         if vapor_score_list[-1]==max(vapor_score_list):best_read_rec=x
 */
          __pyx_t_11 = (__Pyx_PySequence_ContainsTF(__pyx_int_0, __pyx_v_vapor_single_read_score, Py_NE)); if (unlikely(__pyx_t_11 < 0)) __PYX_ERR(0, 1707, __pyx_L1_error)
          __pyx_t_5 = (__pyx_t_11 != 0);
          if (__pyx_t_5) {

            /* "vapor_vali/Simple_function.pyx":1708
 *                     vapor_single_read_score=calcu_vapor_single_read_score_within_10Perc_m1b(ref_seq,alt_seq,x,window_size)
 *                     if not 0 in vapor_single_read_score:
 *                         vapor_score_list.append(1-float(vapor_single_read_score[1])/float(vapor_single_read_score[0]))             # <<<<<<<<<<<<<<
 *                         if vapor_score_list[-1]==max(vapor_score_list):best_read_rec=x
 *                 make_event_figure_1(vapor_score_list,best_read_rec,window_size,ref_seq,alt_seq,out_figure_name)
 */
            __pyx_t_17 = __Pyx_GetItemInt(__pyx_v_vapor_single_read_score, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 1708, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_17);
            __pyx_t_15 = __Pyx_PyObject_AsDouble(__pyx_t_17); if (unlikely(__pyx_t_15 == ((double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1708, __pyx_L1_error)
            __Pyx_DECREF(__pyx_t_17); __pyx_t_17 = 0;
            __pyx_t_17 = __Pyx_GetItemInt(__pyx_v_vapor_single_read_score, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 1708, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_17);
            __pyx_t_14 = __Pyx_PyObject_AsDouble(__pyx_t_17); if (unlikely(__pyx_t_14 == ((double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1708, __pyx_L1_error)
            __Pyx_DECREF(__pyx_t_17); __pyx_t_17 = 0;
            if (unlikely(__pyx_t_14 == 0)) {
              PyErr_SetString(PyExc_ZeroDivisionError, "float division");
              __PYX_ERR(0, 1708, __pyx_L1_error)
            }
            __pyx_t_17 = PyFloat_FromDouble((1.0 - (__pyx_t_15 / __pyx_t_14))); if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 1708, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_17);
            __pyx_t_16 = __Pyx_PyList_Append(__pyx_v_vapor_score_list, __pyx_t_17); if (unlikely(__pyx_t_16 == -1)) __PYX_ERR(0, 1708, __pyx_L1_error)
            __Pyx_DECREF(__pyx_t_17); __pyx_t_17 = 0;

            /* "vapor_vali/Simple_function.pyx":1709
 *                     if not 0 in vapor_single_read_score:
 *                         vapor_score_list.append(1-float(vapor_single_read_score[1])/float(vapor_single_read_score[0]))
 *                         if vapor_score_list[-1]==max(vapor_score_list):best_read_rec=x             # <<<<<<<<<<<<<<
 *                 make_event_figure_1(vapor_score_list,best_read_rec,window_size,ref_seq,alt_seq,out_figure_name)
 *     return vapor_score_list
 */
            __pyx_t_17 = __Pyx_GetItemInt_List(__pyx_v_vapor_score_list, -1L, long, 1, __Pyx_PyInt_From_long, 1, 1, 1); if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 1709, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_17);
            __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1709, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_2);
            __Pyx_INCREF(__pyx_v_vapor_score_list);
            __Pyx_GIVEREF(__pyx_v_vapor_score_list);
            PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_v_vapor_score_list);
            __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_max, __pyx_t_2, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1709, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_1);
            __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
            __pyx_t_2 = PyObject_RichCompare(__pyx_t_17, __pyx_t_1, Py_EQ); __Pyx_XGOTREF(__pyx_t_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1709, __pyx_L1_error)
            __Pyx_DECREF(__pyx_t_17); __pyx_t_17 = 0;
            __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
            __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 1709, __pyx_L1_error)
            __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
            if (__pyx_t_5) {
              __Pyx_INCREF(__pyx_v_x);
              __Pyx_DECREF_SET(__pyx_v_best_read_rec, __pyx_v_x);
            }

            /* "vapor_vali/Simple_function.pyx":1707
 *                 for x in all_reads:
 *                     vapor_single_read_score=calcu_vapor_single_read_score_within_10Perc_m1b(ref_seq,alt_seq,x,window_size)
 *                     if not 0 in vapor_single_read_score:             # <<<<<<<<<<<<<<
 *                         vapor_score_list.append(1-float(vapor_single_read_score[1])/float(vapor_single_read_score[0]))
 *                         if vapor_score_list[-1]==max(vapor_score_list):best_read_rec=x
 */
          }

          /* "vapor_vali/Simple_function.pyx":1705
 *             if len(all_reads)>0:
 *                 best_read_rec=''
 *                 for x in all_reads:             # <<<<<<<<<<<<<<
 *                     vapor_single_read_score=calcu_vapor_single_read_score_within_10Perc_m1b(ref_seq,alt_seq,x,window_size)
 *                     if not 0 in vapor_single_read_score:
 */
        }
        __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;

        /* "vapor_vali/Simple_function.pyx":1710
 *                         vapor_score_list.append(1-float(vapor_single_read_score[1])/float(vapor_single_read_score[0]))
 *                         if vapor_score_list[-1]==max(vapor_score_list):best_read_rec=x
 *                 make_event_figure_1(vapor_score_list,best_read_rec,window_size,ref_seq,alt_seq,out_figure_name)             # <<<<<<<<<<<<<<
 *     return vapor_score_list
 * 
 */
        __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_make_event_figure_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1710, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
        __pyx_t_1 = NULL;
        __pyx_t_8 = 0;
        if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_2))) {
          __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_2);
          if (likely(__pyx_t_1)) {
            PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
            __Pyx_INCREF(__pyx_t_1);
            __Pyx_INCREF(function);
            __Pyx_DECREF_SET(__pyx_t_2, function);
            __pyx_t_8 = 1;
          }
        }
        __pyx_t_17 = PyTuple_New(6+__pyx_t_8); if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 1710, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_17);
        if (__pyx_t_1) {
          __Pyx_GIVEREF(__pyx_t_1); PyTuple_SET_ITEM(__pyx_t_17, 0, __pyx_t_1); __pyx_t_1 = NULL;
        }
        __Pyx_INCREF(__pyx_v_vapor_score_list);
        __Pyx_GIVEREF(__pyx_v_vapor_score_list);
        PyTuple_SET_ITEM(__pyx_t_17, 0+__pyx_t_8, __pyx_v_vapor_score_list);
        __Pyx_INCREF(__pyx_v_best_read_rec);
        __Pyx_GIVEREF(__pyx_v_best_read_rec);
        PyTuple_SET_ITEM(__pyx_t_17, 1+__pyx_t_8, __pyx_v_best_read_rec);
        __Pyx_INCREF(__pyx_v_window_size);
        __Pyx_GIVEREF(__pyx_v_window_size);
        PyTuple_SET_ITEM(__pyx_t_17, 2+__pyx_t_8, __pyx_v_window_size);
        __Pyx_INCREF(__pyx_v_ref_seq);
        __Pyx_GIVEREF(__pyx_v_ref_seq);
        PyTuple_SET_ITEM(__pyx_t_17, 3+__pyx_t_8, __pyx_v_ref_seq);
        __Pyx_INCREF(__pyx_v_alt_seq);
        __Pyx_GIVEREF(__pyx_v_alt_seq);
        PyTuple_SET_ITEM(__pyx_t_17, 4+__pyx_t_8, __pyx_v_alt_seq);
        __Pyx_INCREF(__pyx_v_out_figure_name);
        __Pyx_GIVEREF(__pyx_v_out_figure_name);
        PyTuple_SET_ITEM(__pyx_t_17, 5+__pyx_t_8, __pyx_v_out_figure_name);
        __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_17, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1710, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_4);
        __Pyx_DECREF(__pyx_t_17); __pyx_t_17 = 0;
        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
        __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;

        /* "vapor_vali/Simple_function.pyx":1703
 *         if not window_size=='Error':
 *             all_reads=simple_del_chop_pacbio_read_simple_short(bam_in,[sv_info[0],sv_info[2]],flank_length)
 *             if len(all_reads)>0:             # <<<<<<<<<<<<<<
 *                 best_read_rec=''
 *                 for x in all_reads:
 */
      }

      /* "vapor_vali/Simple_function.pyx":1701
 *         alt_seq=ref_seq_readin(ref,sv_info[0],sv_info[2]-flank_length,sv_info[2])+ref_seq_readin(ref,sv_info[0],sv_info[1],sv_info[1]+flank_length)
 *         [window_size,window_size_qc]=window_size_refine(alt_seq)
 *         if not window_size=='Error':             # <<<<<<<<<<<<<<
 *             all_reads=simple_del_chop_pacbio_read_simple_short(bam_in,[sv_info[0],sv_info[2]],flank_length)
 *             if len(all_reads)>0:
 */
    }

    /* "vapor_vali/Simple_function.pyx":1698
 *     ref_seq=ref_seq_readin(ref,sv_info[0],sv_info[2]-flank_length,sv_info[2]+flank_length)
 *     [window_size,window_size_qc]=window_size_refine(ref_seq)
 *     if not window_size=='Error':             # <<<<<<<<<<<<<<
 *         alt_seq=ref_seq_readin(ref,sv_info[0],sv_info[2]-flank_length,sv_info[2])+ref_seq_readin(ref,sv_info[0],sv_info[1],sv_info[1]+flank_length)
 *         [window_size,window_size_qc]=window_size_refine(alt_seq)
 */
  }

  /* "vapor_vali/Simple_function.pyx":1711
 *                         if vapor_score_list[-1]==max(vapor_score_list):best_read_rec=x
 *                 make_event_figure_1(vapor_score_list,best_read_rec,window_size,ref_seq,alt_seq,out_figure_name)
 *     return vapor_score_list             # <<<<<<<<<<<<<<
 * 
 * def vapor_simple_disdup_Vapor(bam_in,ref,sv_info,out_figure_name):
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_vapor_score_list);
  __pyx_r = __pyx_v_vapor_score_list;
  goto __pyx_L0;

  /* "vapor_vali/Simple_function.pyx":1674
 *     return vapor_score_list
 * 
 * def vapor_simple_tandup_Vapor(bam_in,ref,sv_info,out_figure_name):             # <<<<<<<<<<<<<<
 *    #vapor_simple_del_Vapor(bam_in,ref,x[:-2],out_path+sample_name+'.TANDUP.'+key_event+'.png')
 *     flank_length=flank_length_calculate(sv_info)
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_XDECREF(__pyx_t_7);
  __Pyx_XDECREF(__pyx_t_9);
  __Pyx_XDECREF(__pyx_t_17);
  __Pyx_AddTraceback("vapor_vali.Simple_function.vapor_simple_tandup_Vapor", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_flank_length);
  __Pyx_XDECREF(__pyx_v_vapor_score_list);
  __Pyx_XDECREF(__pyx_v_best_read_rec);
  __Pyx_XDECREF(__pyx_v_ref_seq);
  __Pyx_XDECREF(__pyx_v_window_size);
  __Pyx_XDECREF(__pyx_v_window_size_qc);
  __Pyx_XDECREF(__pyx_v_alt_seq);
  __Pyx_XDECREF(__pyx_v_all_reads);
  __Pyx_XDECREF(__pyx_v_x);
  __Pyx_XDECREF(__pyx_v_vapor_single_read_score);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "vapor_vali/Simple_function.pyx":1713
 *     return vapor_score_list
 * 
 * def vapor_simple_disdup_Vapor(bam_in,ref,sv_info,out_figure_name):             # <<<<<<<<<<<<<<
 *     sv_info[1:3]=[int(i) for i in sv_info[1:3]]
 *     dup_block=sv_info[:3]
 */

/* Python wrapper */
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_213vapor_simple_disdup_Vapor(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_10vapor_vali_15Simple_function_213vapor_simple_disdup_Vapor = {"vapor_simple_disdup_Vapor", (PyCFunction)__pyx_pw_10vapor_vali_15Simple_function_213vapor_simple_disdup_Vapor, METH_VARARGS|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_213vapor_simple_disdup_Vapor(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_bam_in = 0;
  PyObject *__pyx_v_ref = 0;
  PyObject *__pyx_v_sv_info = 0;
  PyObject *__pyx_v_out_figure_name = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("vapor_simple_disdup_Vapor (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_bam_in,&__pyx_n_s_ref,&__pyx_n_s_sv_info,&__pyx_n_s_out_figure_name,0};
    PyObject* values[4] = {0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
      switch (pos_args) {
        case  4: values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
        case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_bam_in)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_ref)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("vapor_simple_disdup_Vapor", 1, 4, 4, 1); __PYX_ERR(0, 1713, __pyx_L3_error)
        }
        case  2:
        if (likely((values[2] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_sv_info)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("vapor_simple_disdup_Vapor", 1, 4, 4, 2); __PYX_ERR(0, 1713, __pyx_L3_error)
        }
        case  3:
        if (likely((values[3] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_out_figure_name)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("vapor_simple_disdup_Vapor", 1, 4, 4, 3); __PYX_ERR(0, 1713, __pyx_L3_error)
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "vapor_simple_disdup_Vapor") < 0)) __PYX_ERR(0, 1713, __pyx_L3_error)
      }
    } else if (PyTuple_GET_SIZE(__pyx_args) != 4) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
      values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
    }
    __pyx_v_bam_in = values[0];
    __pyx_v_ref = values[1];
    __pyx_v_sv_info = values[2];
    __pyx_v_out_figure_name = values[3];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("vapor_simple_disdup_Vapor", 1, 4, 4, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1713, __pyx_L3_error)
  __pyx_L3_error:;
  __Pyx_AddTraceback("vapor_vali.Simple_function.vapor_simple_disdup_Vapor", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_10vapor_vali_15Simple_function_212vapor_simple_disdup_Vapor(__pyx_self, __pyx_v_bam_in, __pyx_v_ref, __pyx_v_sv_info, __pyx_v_out_figure_name);

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10vapor_vali_15Simple_function_212vapor_simple_disdup_Vapor(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_bam_in, PyObject *__pyx_v_ref, PyObject *__pyx_v_sv_info, PyObject *__pyx_v_out_figure_name) {
  PyObject *__pyx_v_dup_block = NULL;
  PyObject *__pyx_v_ins_point = NULL;
  PyObject *__pyx_v_flank_length = NULL;
  PyObject *__pyx_v_vapor_score_list = NULL;
  PyObject *__pyx_v_best_read_rec = NULL;
  PyObject *__pyx_v_bp_info = NULL;
  PyObject *__pyx_v_run_flag = NULL;
  PyObject *__pyx_v_ref_seq = NULL;
  PyObject *__pyx_v_window_size = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_window_size_qc = NULL;
  PyObject *__pyx_v_all_reads = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_ref_structure = NULL;
  PyObject *__pyx_v_alt_structure = NULL;
  PyObject *__pyx_v_alt_seq = NULL;
  PyObject *__pyx_v_a_seq = NULL;
  PyObject *__pyx_v_b_seq = NULL;
  PyObject *__pyx_v_x = NULL;
  PyObject *__pyx_v_vapor_single_read_score = NULL;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  Py_ssize_t __pyx_t_4;
  PyObject *(*__pyx_t_5)(PyObject *);
  PyObject *__pyx_t_6 = NULL;
  PyObject *__pyx_t_7 = NULL;
  int __pyx_t_8;
  int __pyx_t_9;
  int __pyx_t_10;
  PyObject *__pyx_t_11 = NULL;
  PyObject *__pyx_t_12 = NULL;
  PyObject *(*__pyx_t_13)(PyObject *);
  Py_ssize_t __pyx_t_14;
  double __pyx_t_15;
  double __pyx_t_16;
  PyObject *__pyx_t_17 = NULL;
  __Pyx_RefNannySetupContext("vapor_simple_disdup_Vapor", 0);

  /* "vapor_vali/Simple_function.pyx":1714
 * 
 * def vapor_simple_disdup_Vapor(bam_in,ref,sv_info,out_figure_name):
 *     sv_info[1:3]=[int(i) for i in sv_info[1:3]]             # <<<<<<<<<<<<<<
 *     dup_block=sv_info[:3]
 *     ins_point=[sv_info[3],int(sv_info[4])]
 */
  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1714, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyObject_GetSlice(__pyx_v_sv_info, 1, 3, NULL, NULL, &__pyx_slice__135, 1, 1, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1714, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (likely(PyList_CheckExact(__pyx_t_2)) || PyTuple_CheckExact(__pyx_t_2)) {
    __pyx_t_3 = __pyx_t_2; __Pyx_INCREF(__pyx_t_3); __pyx_t_4 = 0;
    __pyx_t_5 = NULL;
  } else {
    __pyx_t_4 = -1; __pyx_t_3 = PyObject_GetIter(__pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1714, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_5 = Py_TYPE(__pyx_t_3)->tp_iternext; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1714, __pyx_L1_error)
  }
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  for (;;) {
    if (likely(!__pyx_t_5)) {
      if (likely(PyList_CheckExact(__pyx_t_3))) {
        if (__pyx_t_4 >= PyList_GET_SIZE(__pyx_t_3)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_2 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_4); __Pyx_INCREF(__pyx_t_2); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 1714, __pyx_L1_error)
        #else
        __pyx_t_2 = PySequence_ITEM(__pyx_t_3, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1714, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
        #endif
      } else {
        if (__pyx_t_4 >= PyTuple_GET_SIZE(__pyx_t_3)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_2 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_4); __Pyx_INCREF(__pyx_t_2); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 1714, __pyx_L1_error)
        #else
        __pyx_t_2 = PySequence_ITEM(__pyx_t_3, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1714, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
        #endif
      }
    } else {
      __pyx_t_2 = __pyx_t_5(__pyx_t_3);
      if (unlikely(!__pyx_t_2)) {
        PyObject* exc_type = PyErr_Occurred();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
          else __PYX_ERR(0, 1714, __pyx_L1_error)
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_2);
    }
    __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_2);
    __pyx_t_2 = 0;
    __pyx_t_2 = __Pyx_PyNumber_Int(__pyx_v_i); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1714, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    if (unlikely(__Pyx_ListComp_Append(__pyx_t_1, (PyObject*)__pyx_t_2))) __PYX_ERR(0, 1714, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  }
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  if (__Pyx_PyObject_SetSlice(__pyx_v_sv_info, __pyx_t_1, 1, 3, NULL, NULL, &__pyx_slice__136, 1, 1, 1) < 0) __PYX_ERR(0, 1714, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":1715
 * def vapor_simple_disdup_Vapor(bam_in,ref,sv_info,out_figure_name):
 *     sv_info[1:3]=[int(i) for i in sv_info[1:3]]
 *     dup_block=sv_info[:3]             # <<<<<<<<<<<<<<
 *     ins_point=[sv_info[3],int(sv_info[4])]
 *     flank_length=flank_length_calculate(dup_block)
 */
  __pyx_t_1 = __Pyx_PyObject_GetSlice(__pyx_v_sv_info, 0, 3, NULL, NULL, &__pyx_slice__137, 0, 1, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1715, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_dup_block = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":1716
 *     sv_info[1:3]=[int(i) for i in sv_info[1:3]]
 *     dup_block=sv_info[:3]
 *     ins_point=[sv_info[3],int(sv_info[4])]             # <<<<<<<<<<<<<<
 *     flank_length=flank_length_calculate(dup_block)
 *     vapor_score_list=[]
 */
  __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_sv_info, 3, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1716, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_sv_info, 4, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1716, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_2 = __Pyx_PyNumber_Int(__pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1716, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = PyList_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1716, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_GIVEREF(__pyx_t_1);
  PyList_SET_ITEM(__pyx_t_3, 0, __pyx_t_1);
  __Pyx_GIVEREF(__pyx_t_2);
  PyList_SET_ITEM(__pyx_t_3, 1, __pyx_t_2);
  __pyx_t_1 = 0;
  __pyx_t_2 = 0;
  __pyx_v_ins_point = ((PyObject*)__pyx_t_3);
  __pyx_t_3 = 0;

  /* "vapor_vali/Simple_function.pyx":1717
 *     dup_block=sv_info[:3]
 *     ins_point=[sv_info[3],int(sv_info[4])]
 *     flank_length=flank_length_calculate(dup_block)             # <<<<<<<<<<<<<<
 *     vapor_score_list=[]
 *     best_read_rec=''
 */
  __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_flank_length_calculate); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1717, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_1 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_2);
    if (likely(__pyx_t_1)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_1);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_2, function);
    }
  }
  if (!__pyx_t_1) {
    __pyx_t_3 = __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_v_dup_block); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1717, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
  } else {
    __pyx_t_6 = PyTuple_New(1+1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1717, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __Pyx_GIVEREF(__pyx_t_1); PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_1); __pyx_t_1 = NULL;
    __Pyx_INCREF(__pyx_v_dup_block);
    __Pyx_GIVEREF(__pyx_v_dup_block);
    PyTuple_SET_ITEM(__pyx_t_6, 0+1, __pyx_v_dup_block);
    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_6, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1717, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  }
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_flank_length = __pyx_t_3;
  __pyx_t_3 = 0;

  /* "vapor_vali/Simple_function.pyx":1718
 *     ins_point=[sv_info[3],int(sv_info[4])]
 *     flank_length=flank_length_calculate(dup_block)
 *     vapor_score_list=[]             # <<<<<<<<<<<<<<
 *     best_read_rec=''
 *     bp_info=sorted([int(i) for i in sv_info[1:3]+[sv_info[4]]])
 */
  __pyx_t_3 = PyList_New(0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1718, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_v_vapor_score_list = ((PyObject*)__pyx_t_3);
  __pyx_t_3 = 0;

  /* "vapor_vali/Simple_function.pyx":1719
 *     flank_length=flank_length_calculate(dup_block)
 *     vapor_score_list=[]
 *     best_read_rec=''             # <<<<<<<<<<<<<<
 *     bp_info=sorted([int(i) for i in sv_info[1:3]+[sv_info[4]]])
 *     run_flag=0
 */
  __Pyx_INCREF(__pyx_kp_s__24);
  __pyx_v_best_read_rec = __pyx_kp_s__24;

  /* "vapor_vali/Simple_function.pyx":1720
 *     vapor_score_list=[]
 *     best_read_rec=''
 *     bp_info=sorted([int(i) for i in sv_info[1:3]+[sv_info[4]]])             # <<<<<<<<<<<<<<
 *     run_flag=0
 *     if sv_info[0]==sv_info[3] and max(bp_info)-min(bp_info)<default_max_sv_test: #try to test on the whole region
 */
  __pyx_t_2 = PyList_New(0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1720, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_6 = __Pyx_PyObject_GetSlice(__pyx_v_sv_info, 1, 3, NULL, NULL, &__pyx_slice__138, 1, 1, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1720, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_sv_info, 4, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1720, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_7 = PyList_New(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1720, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  __Pyx_GIVEREF(__pyx_t_1);
  PyList_SET_ITEM(__pyx_t_7, 0, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = PyNumber_Add(__pyx_t_6, __pyx_t_7); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1720, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
  if (likely(PyList_CheckExact(__pyx_t_1)) || PyTuple_CheckExact(__pyx_t_1)) {
    __pyx_t_7 = __pyx_t_1; __Pyx_INCREF(__pyx_t_7); __pyx_t_4 = 0;
    __pyx_t_5 = NULL;
  } else {
    __pyx_t_4 = -1; __pyx_t_7 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1720, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    __pyx_t_5 = Py_TYPE(__pyx_t_7)->tp_iternext; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1720, __pyx_L1_error)
  }
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  for (;;) {
    if (likely(!__pyx_t_5)) {
      if (likely(PyList_CheckExact(__pyx_t_7))) {
        if (__pyx_t_4 >= PyList_GET_SIZE(__pyx_t_7)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_1 = PyList_GET_ITEM(__pyx_t_7, __pyx_t_4); __Pyx_INCREF(__pyx_t_1); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 1720, __pyx_L1_error)
        #else
        __pyx_t_1 = PySequence_ITEM(__pyx_t_7, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1720, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        #endif
      } else {
        if (__pyx_t_4 >= PyTuple_GET_SIZE(__pyx_t_7)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_7, __pyx_t_4); __Pyx_INCREF(__pyx_t_1); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 1720, __pyx_L1_error)
        #else
        __pyx_t_1 = PySequence_ITEM(__pyx_t_7, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1720, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        #endif
      }
    } else {
      __pyx_t_1 = __pyx_t_5(__pyx_t_7);
      if (unlikely(!__pyx_t_1)) {
        PyObject* exc_type = PyErr_Occurred();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
          else __PYX_ERR(0, 1720, __pyx_L1_error)
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_1);
    }
    __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_1);
    __pyx_t_1 = 0;
    __pyx_t_1 = __Pyx_PyNumber_Int(__pyx_v_i); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1720, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    if (unlikely(__Pyx_ListComp_Append(__pyx_t_2, (PyObject*)__pyx_t_1))) __PYX_ERR(0, 1720, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  }
  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_3 = ((PyObject*)__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_8 = PyList_Sort(__pyx_t_3); if (unlikely(__pyx_t_8 == -1)) __PYX_ERR(0, 1720, __pyx_L1_error)
  __pyx_v_bp_info = ((PyObject*)__pyx_t_3);
  __pyx_t_3 = 0;

  /* "vapor_vali/Simple_function.pyx":1721
 *     best_read_rec=''
 *     bp_info=sorted([int(i) for i in sv_info[1:3]+[sv_info[4]]])
 *     run_flag=0             # <<<<<<<<<<<<<<
 *     if sv_info[0]==sv_info[3] and max(bp_info)-min(bp_info)<default_max_sv_test: #try to test on the whole region
 *         ref_seq=ref_seq_readin(ref,sv_info[0],min(bp_info)-flank_length,max(bp_info)+flank_length)
 */
  __Pyx_INCREF(__pyx_int_0);
  __pyx_v_run_flag = __pyx_int_0;

  /* "vapor_vali/Simple_function.pyx":1722
 *     bp_info=sorted([int(i) for i in sv_info[1:3]+[sv_info[4]]])
 *     run_flag=0
 *     if sv_info[0]==sv_info[3] and max(bp_info)-min(bp_info)<default_max_sv_test: #try to test on the whole region             # <<<<<<<<<<<<<<
 *         ref_seq=ref_seq_readin(ref,sv_info[0],min(bp_info)-flank_length,max(bp_info)+flank_length)
 *         [window_size,window_size_qc]=window_size_refine(ref_seq)
 */
  __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_sv_info, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1722, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_sv_info, 3, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1722, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_7 = PyObject_RichCompare(__pyx_t_3, __pyx_t_2, Py_EQ); __Pyx_XGOTREF(__pyx_t_7); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1722, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_10 = __Pyx_PyObject_IsTrue(__pyx_t_7); if (unlikely(__pyx_t_10 < 0)) __PYX_ERR(0, 1722, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
  if (__pyx_t_10) {
  } else {
    __pyx_t_9 = __pyx_t_10;
    goto __pyx_L8_bool_binop_done;
  }
  __pyx_t_7 = PyTuple_New(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1722, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  __Pyx_INCREF(__pyx_v_bp_info);
  __Pyx_GIVEREF(__pyx_v_bp_info);
  PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_v_bp_info);
  __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_max, __pyx_t_7, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1722, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_7 = PyTuple_New(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1722, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  __Pyx_INCREF(__pyx_v_bp_info);
  __Pyx_GIVEREF(__pyx_v_bp_info);
  PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_v_bp_info);
  __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_min, __pyx_t_7, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1722, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_7 = PyNumber_Subtract(__pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1722, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_default_max_sv_test); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1722, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_2 = PyObject_RichCompare(__pyx_t_7, __pyx_t_3, Py_LT); __Pyx_XGOTREF(__pyx_t_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1722, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_10 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_10 < 0)) __PYX_ERR(0, 1722, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_9 = __pyx_t_10;
  __pyx_L8_bool_binop_done:;
  if (__pyx_t_9) {

    /* "vapor_vali/Simple_function.pyx":1723
 *     run_flag=0
 *     if sv_info[0]==sv_info[3] and max(bp_info)-min(bp_info)<default_max_sv_test: #try to test on the whole region
 *         ref_seq=ref_seq_readin(ref,sv_info[0],min(bp_info)-flank_length,max(bp_info)+flank_length)             # <<<<<<<<<<<<<<
 *         [window_size,window_size_qc]=window_size_refine(ref_seq)
 *         if not window_size=='Error':
 */
    __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_ref_seq_readin); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1723, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_7 = __Pyx_GetItemInt(__pyx_v_sv_info, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1723, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1723, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_INCREF(__pyx_v_bp_info);
    __Pyx_GIVEREF(__pyx_v_bp_info);
    PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_bp_info);
    __pyx_t_6 = __Pyx_PyObject_Call(__pyx_builtin_min, __pyx_t_1, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1723, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = PyNumber_Subtract(__pyx_t_6, __pyx_v_flank_length); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1723, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = PyTuple_New(1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1723, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __Pyx_INCREF(__pyx_v_bp_info);
    __Pyx_GIVEREF(__pyx_v_bp_info);
    PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_v_bp_info);
    __pyx_t_11 = __Pyx_PyObject_Call(__pyx_builtin_max, __pyx_t_6, NULL); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1723, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_11);
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = PyNumber_Add(__pyx_t_11, __pyx_v_flank_length); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1723, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
    __pyx_t_11 = NULL;
    __pyx_t_4 = 0;
    if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_3))) {
      __pyx_t_11 = PyMethod_GET_SELF(__pyx_t_3);
      if (likely(__pyx_t_11)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
        __Pyx_INCREF(__pyx_t_11);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_3, function);
        __pyx_t_4 = 1;
      }
    }
    __pyx_t_12 = PyTuple_New(4+__pyx_t_4); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1723, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_12);
    if (__pyx_t_11) {
      __Pyx_GIVEREF(__pyx_t_11); PyTuple_SET_ITEM(__pyx_t_12, 0, __pyx_t_11); __pyx_t_11 = NULL;
    }
    __Pyx_INCREF(__pyx_v_ref);
    __Pyx_GIVEREF(__pyx_v_ref);
    PyTuple_SET_ITEM(__pyx_t_12, 0+__pyx_t_4, __pyx_v_ref);
    __Pyx_GIVEREF(__pyx_t_7);
    PyTuple_SET_ITEM(__pyx_t_12, 1+__pyx_t_4, __pyx_t_7);
    __Pyx_GIVEREF(__pyx_t_1);
    PyTuple_SET_ITEM(__pyx_t_12, 2+__pyx_t_4, __pyx_t_1);
    __Pyx_GIVEREF(__pyx_t_6);
    PyTuple_SET_ITEM(__pyx_t_12, 3+__pyx_t_4, __pyx_t_6);
    __pyx_t_7 = 0;
    __pyx_t_1 = 0;
    __pyx_t_6 = 0;
    __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_12, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1723, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_v_ref_seq = __pyx_t_2;
    __pyx_t_2 = 0;

    /* "vapor_vali/Simple_function.pyx":1724
 *     if sv_info[0]==sv_info[3] and max(bp_info)-min(bp_info)<default_max_sv_test: #try to test on the whole region
 *         ref_seq=ref_seq_readin(ref,sv_info[0],min(bp_info)-flank_length,max(bp_info)+flank_length)
 *         [window_size,window_size_qc]=window_size_refine(ref_seq)             # <<<<<<<<<<<<<<
 *         if not window_size=='Error':
 *             all_reads=simple_chop_pacbio_read_simple_short(bam_in,[sv_info[0]]+bp_info+[int(bp_info[-1])+sv_info[2]-sv_info[1]],flank_length)
 */
    __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_window_size_refine); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1724, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_12 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_3))) {
      __pyx_t_12 = PyMethod_GET_SELF(__pyx_t_3);
      if (likely(__pyx_t_12)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
        __Pyx_INCREF(__pyx_t_12);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_3, function);
      }
    }
    if (!__pyx_t_12) {
      __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_v_ref_seq); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1724, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
    } else {
      __pyx_t_6 = PyTuple_New(1+1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1724, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_6);
      __Pyx_GIVEREF(__pyx_t_12); PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_12); __pyx_t_12 = NULL;
      __Pyx_INCREF(__pyx_v_ref_seq);
      __Pyx_GIVEREF(__pyx_v_ref_seq);
      PyTuple_SET_ITEM(__pyx_t_6, 0+1, __pyx_v_ref_seq);
      __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_6, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1724, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    }
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    if ((likely(PyTuple_CheckExact(__pyx_t_2))) || (PyList_CheckExact(__pyx_t_2))) {
      PyObject* sequence = __pyx_t_2;
      #if CYTHON_COMPILING_IN_CPYTHON
      Py_ssize_t size = Py_SIZE(sequence);
      #else
      Py_ssize_t size = PySequence_Size(sequence);
      #endif
      if (unlikely(size != 2)) {
        if (size > 2) __Pyx_RaiseTooManyValuesError(2);
        else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
        __PYX_ERR(0, 1724, __pyx_L1_error)
      }
      #if CYTHON_COMPILING_IN_CPYTHON
      if (likely(PyTuple_CheckExact(sequence))) {
        __pyx_t_3 = PyTuple_GET_ITEM(sequence, 0); 
        __pyx_t_6 = PyTuple_GET_ITEM(sequence, 1); 
      } else {
        __pyx_t_3 = PyList_GET_ITEM(sequence, 0); 
        __pyx_t_6 = PyList_GET_ITEM(sequence, 1); 
      }
      __Pyx_INCREF(__pyx_t_3);
      __Pyx_INCREF(__pyx_t_6);
      #else
      __pyx_t_3 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1724, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __pyx_t_6 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1724, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_6);
      #endif
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    } else {
      Py_ssize_t index = -1;
      __pyx_t_12 = PyObject_GetIter(__pyx_t_2); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1724, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_12);
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_13 = Py_TYPE(__pyx_t_12)->tp_iternext;
      index = 0; __pyx_t_3 = __pyx_t_13(__pyx_t_12); if (unlikely(!__pyx_t_3)) goto __pyx_L10_unpacking_failed;
      __Pyx_GOTREF(__pyx_t_3);
      index = 1; __pyx_t_6 = __pyx_t_13(__pyx_t_12); if (unlikely(!__pyx_t_6)) goto __pyx_L10_unpacking_failed;
      __Pyx_GOTREF(__pyx_t_6);
      if (__Pyx_IternextUnpackEndCheck(__pyx_t_13(__pyx_t_12), 2) < 0) __PYX_ERR(0, 1724, __pyx_L1_error)
      __pyx_t_13 = NULL;
      __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
      goto __pyx_L11_unpacking_done;
      __pyx_L10_unpacking_failed:;
      __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
      __pyx_t_13 = NULL;
      if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
      __PYX_ERR(0, 1724, __pyx_L1_error)
      __pyx_L11_unpacking_done:;
    }
    __pyx_v_window_size = __pyx_t_3;
    __pyx_t_3 = 0;
    __pyx_v_window_size_qc = __pyx_t_6;
    __pyx_t_6 = 0;

    /* "vapor_vali/Simple_function.pyx":1725
 *         ref_seq=ref_seq_readin(ref,sv_info[0],min(bp_info)-flank_length,max(bp_info)+flank_length)
 *         [window_size,window_size_qc]=window_size_refine(ref_seq)
 *         if not window_size=='Error':             # <<<<<<<<<<<<<<
 *             all_reads=simple_chop_pacbio_read_simple_short(bam_in,[sv_info[0]]+bp_info+[int(bp_info[-1])+sv_info[2]-sv_info[1]],flank_length)
 *             if len(all_reads)>0:
 */
    __pyx_t_9 = (__Pyx_PyString_Equals(__pyx_v_window_size, __pyx_n_s_Error, Py_EQ)); if (unlikely(__pyx_t_9 < 0)) __PYX_ERR(0, 1725, __pyx_L1_error)
    __pyx_t_10 = ((!__pyx_t_9) != 0);
    if (__pyx_t_10) {

      /* "vapor_vali/Simple_function.pyx":1726
 *         [window_size,window_size_qc]=window_size_refine(ref_seq)
 *         if not window_size=='Error':
 *             all_reads=simple_chop_pacbio_read_simple_short(bam_in,[sv_info[0]]+bp_info+[int(bp_info[-1])+sv_info[2]-sv_info[1]],flank_length)             # <<<<<<<<<<<<<<
 *             if len(all_reads)>0:
 *                 run_flag+=1
 */
      __pyx_t_6 = __Pyx_GetModuleGlobalName(__pyx_n_s_simple_chop_pacbio_read_simple_s); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1726, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_6);
      __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_sv_info, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1726, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __pyx_t_12 = PyList_New(1); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1726, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_12);
      __Pyx_GIVEREF(__pyx_t_3);
      PyList_SET_ITEM(__pyx_t_12, 0, __pyx_t_3);
      __pyx_t_3 = 0;
      __pyx_t_3 = PyNumber_Add(__pyx_t_12, __pyx_v_bp_info); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1726, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
      if (unlikely(__pyx_v_bp_info == Py_None)) {
        PyErr_SetString(PyExc_TypeError, "'NoneType' object is not subscriptable");
        __PYX_ERR(0, 1726, __pyx_L1_error)
      }
      __pyx_t_12 = __Pyx_GetItemInt_List(__pyx_v_bp_info, -1L, long, 1, __Pyx_PyInt_From_long, 1, 1, 1); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1726, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_12);
      __pyx_t_1 = __Pyx_PyNumber_Int(__pyx_t_12); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1726, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
      __pyx_t_12 = __Pyx_GetItemInt(__pyx_v_sv_info, 2, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1726, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_12);
      __pyx_t_7 = PyNumber_Add(__pyx_t_1, __pyx_t_12); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1726, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_7);
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
      __pyx_t_12 = __Pyx_GetItemInt(__pyx_v_sv_info, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1726, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_12);
      __pyx_t_1 = PyNumber_Subtract(__pyx_t_7, __pyx_t_12); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1726, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
      __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
      __pyx_t_12 = PyList_New(1); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1726, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_12);
      __Pyx_GIVEREF(__pyx_t_1);
      PyList_SET_ITEM(__pyx_t_12, 0, __pyx_t_1);
      __pyx_t_1 = 0;
      __pyx_t_1 = PyNumber_Add(__pyx_t_3, __pyx_t_12); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1726, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
      __pyx_t_12 = NULL;
      __pyx_t_4 = 0;
      if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_6))) {
        __pyx_t_12 = PyMethod_GET_SELF(__pyx_t_6);
        if (likely(__pyx_t_12)) {
          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
          __Pyx_INCREF(__pyx_t_12);
          __Pyx_INCREF(function);
          __Pyx_DECREF_SET(__pyx_t_6, function);
          __pyx_t_4 = 1;
        }
      }
      __pyx_t_3 = PyTuple_New(3+__pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1726, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      if (__pyx_t_12) {
        __Pyx_GIVEREF(__pyx_t_12); PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_12); __pyx_t_12 = NULL;
      }
      __Pyx_INCREF(__pyx_v_bam_in);
      __Pyx_GIVEREF(__pyx_v_bam_in);
      PyTuple_SET_ITEM(__pyx_t_3, 0+__pyx_t_4, __pyx_v_bam_in);
      __Pyx_GIVEREF(__pyx_t_1);
      PyTuple_SET_ITEM(__pyx_t_3, 1+__pyx_t_4, __pyx_t_1);
      __Pyx_INCREF(__pyx_v_flank_length);
      __Pyx_GIVEREF(__pyx_v_flank_length);
      PyTuple_SET_ITEM(__pyx_t_3, 2+__pyx_t_4, __pyx_v_flank_length);
      __pyx_t_1 = 0;
      __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_3, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1726, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
      __pyx_v_all_reads = __pyx_t_2;
      __pyx_t_2 = 0;

      /* "vapor_vali/Simple_function.pyx":1727
 *         if not window_size=='Error':
 *             all_reads=simple_chop_pacbio_read_simple_short(bam_in,[sv_info[0]]+bp_info+[int(bp_info[-1])+sv_info[2]-sv_info[1]],flank_length)
 *             if len(all_reads)>0:             # <<<<<<<<<<<<<<
 *                 run_flag+=1
 *                 ref_structure=[i for i in 'ab']
 */
      __pyx_t_4 = PyObject_Length(__pyx_v_all_reads); if (unlikely(__pyx_t_4 == -1)) __PYX_ERR(0, 1727, __pyx_L1_error)
      __pyx_t_10 = ((__pyx_t_4 > 0) != 0);
      if (__pyx_t_10) {

        /* "vapor_vali/Simple_function.pyx":1728
 *             all_reads=simple_chop_pacbio_read_simple_short(bam_in,[sv_info[0]]+bp_info+[int(bp_info[-1])+sv_info[2]-sv_info[1]],flank_length)
 *             if len(all_reads)>0:
 *                 run_flag+=1             # <<<<<<<<<<<<<<
 *                 ref_structure=[i for i in 'ab']
 *                 if sv_info[4]>sv_info[2]:   alt_structure=['a','b','a']
 */
        __pyx_t_2 = __Pyx_PyInt_AddObjC(__pyx_v_run_flag, __pyx_int_1, 1, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1728, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
        __Pyx_DECREF_SET(__pyx_v_run_flag, __pyx_t_2);
        __pyx_t_2 = 0;

        /* "vapor_vali/Simple_function.pyx":1729
 *             if len(all_reads)>0:
 *                 run_flag+=1
 *                 ref_structure=[i for i in 'ab']             # <<<<<<<<<<<<<<
 *                 if sv_info[4]>sv_info[2]:   alt_structure=['a','b','a']
 *                 elif sv_info[4]<sv_info[1]: alt_structure=['b','a','b']
 */
        __pyx_t_2 = PyList_New(0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1729, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
        __pyx_t_6 = PyObject_GetIter(__pyx_n_s_ab); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1729, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_6);
        __pyx_t_5 = Py_TYPE(__pyx_t_6)->tp_iternext; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1729, __pyx_L1_error)
        for (;;) {
          {
            __pyx_t_3 = __pyx_t_5(__pyx_t_6);
            if (unlikely(!__pyx_t_3)) {
              PyObject* exc_type = PyErr_Occurred();
              if (exc_type) {
                if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
                else __PYX_ERR(0, 1729, __pyx_L1_error)
              }
              break;
            }
            __Pyx_GOTREF(__pyx_t_3);
          }
          __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_3);
          __pyx_t_3 = 0;
          if (unlikely(__Pyx_ListComp_Append(__pyx_t_2, (PyObject*)__pyx_v_i))) __PYX_ERR(0, 1729, __pyx_L1_error)
        }
        __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
        __pyx_v_ref_structure = ((PyObject*)__pyx_t_2);
        __pyx_t_2 = 0;

        /* "vapor_vali/Simple_function.pyx":1730
 *                 run_flag+=1
 *                 ref_structure=[i for i in 'ab']
 *                 if sv_info[4]>sv_info[2]:   alt_structure=['a','b','a']             # <<<<<<<<<<<<<<
 *                 elif sv_info[4]<sv_info[1]: alt_structure=['b','a','b']
 *                 alt_seq=ref_seq_readin(ref,sv_info[0],min(bp_info)-flank_length,min(bp_info))
 */
        __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_sv_info, 4, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1730, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
        __pyx_t_6 = __Pyx_GetItemInt(__pyx_v_sv_info, 2, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1730, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_6);
        __pyx_t_3 = PyObject_RichCompare(__pyx_t_2, __pyx_t_6, Py_GT); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1730, __pyx_L1_error)
        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
        __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
        __pyx_t_10 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_10 < 0)) __PYX_ERR(0, 1730, __pyx_L1_error)
        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
        if (__pyx_t_10) {
          __pyx_t_3 = PyList_New(3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1730, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_3);
          __Pyx_INCREF(__pyx_n_s_a);
          __Pyx_GIVEREF(__pyx_n_s_a);
          PyList_SET_ITEM(__pyx_t_3, 0, __pyx_n_s_a);
          __Pyx_INCREF(__pyx_n_s_b);
          __Pyx_GIVEREF(__pyx_n_s_b);
          PyList_SET_ITEM(__pyx_t_3, 1, __pyx_n_s_b);
          __Pyx_INCREF(__pyx_n_s_a);
          __Pyx_GIVEREF(__pyx_n_s_a);
          PyList_SET_ITEM(__pyx_t_3, 2, __pyx_n_s_a);
          __pyx_v_alt_structure = ((PyObject*)__pyx_t_3);
          __pyx_t_3 = 0;
          goto __pyx_L16;
        }

        /* "vapor_vali/Simple_function.pyx":1731
 *                 ref_structure=[i for i in 'ab']
 *                 if sv_info[4]>sv_info[2]:   alt_structure=['a','b','a']
 *                 elif sv_info[4]<sv_info[1]: alt_structure=['b','a','b']             # <<<<<<<<<<<<<<
 *                 alt_seq=ref_seq_readin(ref,sv_info[0],min(bp_info)-flank_length,min(bp_info))
 *                 a_seq=ref_seq_readin(ref,sv_info[0],bp_info[0],bp_info[1])
 */
        __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_sv_info, 4, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1731, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_3);
        __pyx_t_6 = __Pyx_GetItemInt(__pyx_v_sv_info, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1731, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_6);
        __pyx_t_2 = PyObject_RichCompare(__pyx_t_3, __pyx_t_6, Py_LT); __Pyx_XGOTREF(__pyx_t_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1731, __pyx_L1_error)
        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
        __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
        __pyx_t_10 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_10 < 0)) __PYX_ERR(0, 1731, __pyx_L1_error)
        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
        if (__pyx_t_10) {
          __pyx_t_2 = PyList_New(3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1731, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_2);
          __Pyx_INCREF(__pyx_n_s_b);
          __Pyx_GIVEREF(__pyx_n_s_b);
          PyList_SET_ITEM(__pyx_t_2, 0, __pyx_n_s_b);
          __Pyx_INCREF(__pyx_n_s_a);
          __Pyx_GIVEREF(__pyx_n_s_a);
          PyList_SET_ITEM(__pyx_t_2, 1, __pyx_n_s_a);
          __Pyx_INCREF(__pyx_n_s_b);
          __Pyx_GIVEREF(__pyx_n_s_b);
          PyList_SET_ITEM(__pyx_t_2, 2, __pyx_n_s_b);
          __pyx_v_alt_structure = ((PyObject*)__pyx_t_2);
          __pyx_t_2 = 0;
        }
        __pyx_L16:;

        /* "vapor_vali/Simple_function.pyx":1732
 *                 if sv_info[4]>sv_info[2]:   alt_structure=['a','b','a']
 *                 elif sv_info[4]<sv_info[1]: alt_structure=['b','a','b']
 *                 alt_seq=ref_seq_readin(ref,sv_info[0],min(bp_info)-flank_length,min(bp_info))             # <<<<<<<<<<<<<<
 *                 a_seq=ref_seq_readin(ref,sv_info[0],bp_info[0],bp_info[1])
 *                 b_seq=ref_seq_readin(ref,sv_info[0],bp_info[1],bp_info[2])
 */
        __pyx_t_6 = __Pyx_GetModuleGlobalName(__pyx_n_s_ref_seq_readin); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1732, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_6);
        __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_sv_info, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1732, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_3);
        __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1732, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        __Pyx_INCREF(__pyx_v_bp_info);
        __Pyx_GIVEREF(__pyx_v_bp_info);
        PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_bp_info);
        __pyx_t_12 = __Pyx_PyObject_Call(__pyx_builtin_min, __pyx_t_1, NULL); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1732, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_12);
        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
        __pyx_t_1 = PyNumber_Subtract(__pyx_t_12, __pyx_v_flank_length); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1732, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
        __pyx_t_12 = PyTuple_New(1); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1732, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_12);
        __Pyx_INCREF(__pyx_v_bp_info);
        __Pyx_GIVEREF(__pyx_v_bp_info);
        PyTuple_SET_ITEM(__pyx_t_12, 0, __pyx_v_bp_info);
        __pyx_t_7 = __Pyx_PyObject_Call(__pyx_builtin_min, __pyx_t_12, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1732, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_7);
        __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
        __pyx_t_12 = NULL;
        __pyx_t_4 = 0;
        if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_6))) {
          __pyx_t_12 = PyMethod_GET_SELF(__pyx_t_6);
          if (likely(__pyx_t_12)) {
            PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
            __Pyx_INCREF(__pyx_t_12);
            __Pyx_INCREF(function);
            __Pyx_DECREF_SET(__pyx_t_6, function);
            __pyx_t_4 = 1;
          }
        }
        __pyx_t_11 = PyTuple_New(4+__pyx_t_4); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1732, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_11);
        if (__pyx_t_12) {
          __Pyx_GIVEREF(__pyx_t_12); PyTuple_SET_ITEM(__pyx_t_11, 0, __pyx_t_12); __pyx_t_12 = NULL;
        }
        __Pyx_INCREF(__pyx_v_ref);
        __Pyx_GIVEREF(__pyx_v_ref);
        PyTuple_SET_ITEM(__pyx_t_11, 0+__pyx_t_4, __pyx_v_ref);
        __Pyx_GIVEREF(__pyx_t_3);
        PyTuple_SET_ITEM(__pyx_t_11, 1+__pyx_t_4, __pyx_t_3);
        __Pyx_GIVEREF(__pyx_t_1);
        PyTuple_SET_ITEM(__pyx_t_11, 2+__pyx_t_4, __pyx_t_1);
        __Pyx_GIVEREF(__pyx_t_7);
        PyTuple_SET_ITEM(__pyx_t_11, 3+__pyx_t_4, __pyx_t_7);
        __pyx_t_3 = 0;
        __pyx_t_1 = 0;
        __pyx_t_7 = 0;
        __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_11, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1732, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
        __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
        __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
        __pyx_v_alt_seq = __pyx_t_2;
        __pyx_t_2 = 0;

        /* "vapor_vali/Simple_function.pyx":1733
 *                 elif sv_info[4]<sv_info[1]: alt_structure=['b','a','b']
 *                 alt_seq=ref_seq_readin(ref,sv_info[0],min(bp_info)-flank_length,min(bp_info))
 *                 a_seq=ref_seq_readin(ref,sv_info[0],bp_info[0],bp_info[1])             # <<<<<<<<<<<<<<
 *                 b_seq=ref_seq_readin(ref,sv_info[0],bp_info[1],bp_info[2])
 *                 for x in alt_structure:
 */
        __pyx_t_6 = __Pyx_GetModuleGlobalName(__pyx_n_s_ref_seq_readin); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1733, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_6);
        __pyx_t_11 = __Pyx_GetItemInt(__pyx_v_sv_info, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1733, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_11);
        if (unlikely(__pyx_v_bp_info == Py_None)) {
          PyErr_SetString(PyExc_TypeError, "'NoneType' object is not subscriptable");
          __PYX_ERR(0, 1733, __pyx_L1_error)
        }
        __pyx_t_7 = __Pyx_GetItemInt_List(__pyx_v_bp_info, 0, long, 1, __Pyx_PyInt_From_long, 1, 0, 1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1733, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_7);
        if (unlikely(__pyx_v_bp_info == Py_None)) {
          PyErr_SetString(PyExc_TypeError, "'NoneType' object is not subscriptable");
          __PYX_ERR(0, 1733, __pyx_L1_error)
        }
        __pyx_t_1 = __Pyx_GetItemInt_List(__pyx_v_bp_info, 1, long, 1, __Pyx_PyInt_From_long, 1, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1733, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        __pyx_t_3 = NULL;
        __pyx_t_4 = 0;
        if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_6))) {
          __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_6);
          if (likely(__pyx_t_3)) {
            PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
            __Pyx_INCREF(__pyx_t_3);
            __Pyx_INCREF(function);
            __Pyx_DECREF_SET(__pyx_t_6, function);
            __pyx_t_4 = 1;
          }
        }
        __pyx_t_12 = PyTuple_New(4+__pyx_t_4); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1733, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_12);
        if (__pyx_t_3) {
          __Pyx_GIVEREF(__pyx_t_3); PyTuple_SET_ITEM(__pyx_t_12, 0, __pyx_t_3); __pyx_t_3 = NULL;
        }
        __Pyx_INCREF(__pyx_v_ref);
        __Pyx_GIVEREF(__pyx_v_ref);
        PyTuple_SET_ITEM(__pyx_t_12, 0+__pyx_t_4, __pyx_v_ref);
        __Pyx_GIVEREF(__pyx_t_11);
        PyTuple_SET_ITEM(__pyx_t_12, 1+__pyx_t_4, __pyx_t_11);
        __Pyx_GIVEREF(__pyx_t_7);
        PyTuple_SET_ITEM(__pyx_t_12, 2+__pyx_t_4, __pyx_t_7);
        __Pyx_GIVEREF(__pyx_t_1);
        PyTuple_SET_ITEM(__pyx_t_12, 3+__pyx_t_4, __pyx_t_1);
        __pyx_t_11 = 0;
        __pyx_t_7 = 0;
        __pyx_t_1 = 0;
        __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_12, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1733, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
        __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
        __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
        __pyx_v_a_seq = __pyx_t_2;
        __pyx_t_2 = 0;

        /* "vapor_vali/Simple_function.pyx":1734
 *                 alt_seq=ref_seq_readin(ref,sv_info[0],min(bp_info)-flank_length,min(bp_info))
 *                 a_seq=ref_seq_readin(ref,sv_info[0],bp_info[0],bp_info[1])
 *                 b_seq=ref_seq_readin(ref,sv_info[0],bp_info[1],bp_info[2])             # <<<<<<<<<<<<<<
 *                 for x in alt_structure:
 *                     if x=='a':  alt_seq+=a_seq
 */
        __pyx_t_6 = __Pyx_GetModuleGlobalName(__pyx_n_s_ref_seq_readin); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1734, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_6);
        __pyx_t_12 = __Pyx_GetItemInt(__pyx_v_sv_info, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1734, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_12);
        if (unlikely(__pyx_v_bp_info == Py_None)) {
          PyErr_SetString(PyExc_TypeError, "'NoneType' object is not subscriptable");
          __PYX_ERR(0, 1734, __pyx_L1_error)
        }
        __pyx_t_1 = __Pyx_GetItemInt_List(__pyx_v_bp_info, 1, long, 1, __Pyx_PyInt_From_long, 1, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1734, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        if (unlikely(__pyx_v_bp_info == Py_None)) {
          PyErr_SetString(PyExc_TypeError, "'NoneType' object is not subscriptable");
          __PYX_ERR(0, 1734, __pyx_L1_error)
        }
        __pyx_t_7 = __Pyx_GetItemInt_List(__pyx_v_bp_info, 2, long, 1, __Pyx_PyInt_From_long, 1, 0, 1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1734, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_7);
        __pyx_t_11 = NULL;
        __pyx_t_4 = 0;
        if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_6))) {
          __pyx_t_11 = PyMethod_GET_SELF(__pyx_t_6);
          if (likely(__pyx_t_11)) {
            PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
            __Pyx_INCREF(__pyx_t_11);
            __Pyx_INCREF(function);
            __Pyx_DECREF_SET(__pyx_t_6, function);
            __pyx_t_4 = 1;
          }
        }
        __pyx_t_3 = PyTuple_New(4+__pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1734, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_3);
        if (__pyx_t_11) {
          __Pyx_GIVEREF(__pyx_t_11); PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_11); __pyx_t_11 = NULL;
        }
        __Pyx_INCREF(__pyx_v_ref);
        __Pyx_GIVEREF(__pyx_v_ref);
        PyTuple_SET_ITEM(__pyx_t_3, 0+__pyx_t_4, __pyx_v_ref);
        __Pyx_GIVEREF(__pyx_t_12);
        PyTuple_SET_ITEM(__pyx_t_3, 1+__pyx_t_4, __pyx_t_12);
        __Pyx_GIVEREF(__pyx_t_1);
        PyTuple_SET_ITEM(__pyx_t_3, 2+__pyx_t_4, __pyx_t_1);
        __Pyx_GIVEREF(__pyx_t_7);
        PyTuple_SET_ITEM(__pyx_t_3, 3+__pyx_t_4, __pyx_t_7);
        __pyx_t_12 = 0;
        __pyx_t_1 = 0;
        __pyx_t_7 = 0;
        __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_3, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1734, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
        __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
        __pyx_v_b_seq = __pyx_t_2;
        __pyx_t_2 = 0;

        /* "vapor_vali/Simple_function.pyx":1735
 *                 a_seq=ref_seq_readin(ref,sv_info[0],bp_info[0],bp_info[1])
 *                 b_seq=ref_seq_readin(ref,sv_info[0],bp_info[1],bp_info[2])
 *                 for x in alt_structure:             # <<<<<<<<<<<<<<
 *                     if x=='a':  alt_seq+=a_seq
 *                     elif x=='b':    alt_seq+=b_seq
 */
        if (unlikely(!__pyx_v_alt_structure)) { __Pyx_RaiseUnboundLocalError("alt_structure"); __PYX_ERR(0, 1735, __pyx_L1_error) }
        __pyx_t_2 = __pyx_v_alt_structure; __Pyx_INCREF(__pyx_t_2); __pyx_t_4 = 0;
        for (;;) {
          if (__pyx_t_4 >= PyList_GET_SIZE(__pyx_t_2)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_6 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_4); __Pyx_INCREF(__pyx_t_6); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 1735, __pyx_L1_error)
          #else
          __pyx_t_6 = PySequence_ITEM(__pyx_t_2, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1735, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_6);
          #endif
          __Pyx_XDECREF_SET(__pyx_v_x, __pyx_t_6);
          __pyx_t_6 = 0;

          /* "vapor_vali/Simple_function.pyx":1736
 *                 b_seq=ref_seq_readin(ref,sv_info[0],bp_info[1],bp_info[2])
 *                 for x in alt_structure:
 *                     if x=='a':  alt_seq+=a_seq             # <<<<<<<<<<<<<<
 *                     elif x=='b':    alt_seq+=b_seq
 *                 alt_seq+=ref_seq_readin(ref,sv_info[0],max(bp_info),max(bp_info)+flank_length)
 */
          __pyx_t_10 = (__Pyx_PyString_Equals(__pyx_v_x, __pyx_n_s_a, Py_EQ)); if (unlikely(__pyx_t_10 < 0)) __PYX_ERR(0, 1736, __pyx_L1_error)
          if (__pyx_t_10) {
            __pyx_t_6 = PyNumber_InPlaceAdd(__pyx_v_alt_seq, __pyx_v_a_seq); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1736, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_6);
            __Pyx_DECREF_SET(__pyx_v_alt_seq, __pyx_t_6);
            __pyx_t_6 = 0;
            goto __pyx_L19;
          }

          /* "vapor_vali/Simple_function.pyx":1737
 *                 for x in alt_structure:
 *                     if x=='a':  alt_seq+=a_seq
 *                     elif x=='b':    alt_seq+=b_seq             # <<<<<<<<<<<<<<
 *                 alt_seq+=ref_seq_readin(ref,sv_info[0],max(bp_info),max(bp_info)+flank_length)
 *                 [window_size,window_size_qc]=window_size_refine(alt_seq)
 */
          __pyx_t_10 = (__Pyx_PyString_Equals(__pyx_v_x, __pyx_n_s_b, Py_EQ)); if (unlikely(__pyx_t_10 < 0)) __PYX_ERR(0, 1737, __pyx_L1_error)
          if (__pyx_t_10) {
            __pyx_t_6 = PyNumber_InPlaceAdd(__pyx_v_alt_seq, __pyx_v_b_seq); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1737, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_6);
            __Pyx_DECREF_SET(__pyx_v_alt_seq, __pyx_t_6);
            __pyx_t_6 = 0;
          }
          __pyx_L19:;

          /* "vapor_vali/Simple_function.pyx":1735
 *                 a_seq=ref_seq_readin(ref,sv_info[0],bp_info[0],bp_info[1])
 *                 b_seq=ref_seq_readin(ref,sv_info[0],bp_info[1],bp_info[2])
 *                 for x in alt_structure:             # <<<<<<<<<<<<<<
 *                     if x=='a':  alt_seq+=a_seq
 *                     elif x=='b':    alt_seq+=b_seq
 */
        }
        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

        /* "vapor_vali/Simple_function.pyx":1738
 *                     if x=='a':  alt_seq+=a_seq
 *                     elif x=='b':    alt_seq+=b_seq
 *                 alt_seq+=ref_seq_readin(ref,sv_info[0],max(bp_info),max(bp_info)+flank_length)             # <<<<<<<<<<<<<<
 *                 [window_size,window_size_qc]=window_size_refine(alt_seq)
 *                 if not window_size=='Error':
 */
        __pyx_t_6 = __Pyx_GetModuleGlobalName(__pyx_n_s_ref_seq_readin); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1738, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_6);
        __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_sv_info, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1738, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_3);
        __pyx_t_7 = PyTuple_New(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1738, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_7);
        __Pyx_INCREF(__pyx_v_bp_info);
        __Pyx_GIVEREF(__pyx_v_bp_info);
        PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_v_bp_info);
        __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_max, __pyx_t_7, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1738, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
        __pyx_t_7 = PyTuple_New(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1738, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_7);
        __Pyx_INCREF(__pyx_v_bp_info);
        __Pyx_GIVEREF(__pyx_v_bp_info);
        PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_v_bp_info);
        __pyx_t_12 = __Pyx_PyObject_Call(__pyx_builtin_max, __pyx_t_7, NULL); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1738, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_12);
        __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
        __pyx_t_7 = PyNumber_Add(__pyx_t_12, __pyx_v_flank_length); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1738, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_7);
        __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
        __pyx_t_12 = NULL;
        __pyx_t_4 = 0;
        if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_6))) {
          __pyx_t_12 = PyMethod_GET_SELF(__pyx_t_6);
          if (likely(__pyx_t_12)) {
            PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
            __Pyx_INCREF(__pyx_t_12);
            __Pyx_INCREF(function);
            __Pyx_DECREF_SET(__pyx_t_6, function);
            __pyx_t_4 = 1;
          }
        }
        __pyx_t_11 = PyTuple_New(4+__pyx_t_4); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1738, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_11);
        if (__pyx_t_12) {
          __Pyx_GIVEREF(__pyx_t_12); PyTuple_SET_ITEM(__pyx_t_11, 0, __pyx_t_12); __pyx_t_12 = NULL;
        }
        __Pyx_INCREF(__pyx_v_ref);
        __Pyx_GIVEREF(__pyx_v_ref);
        PyTuple_SET_ITEM(__pyx_t_11, 0+__pyx_t_4, __pyx_v_ref);
        __Pyx_GIVEREF(__pyx_t_3);
        PyTuple_SET_ITEM(__pyx_t_11, 1+__pyx_t_4, __pyx_t_3);
        __Pyx_GIVEREF(__pyx_t_1);
        PyTuple_SET_ITEM(__pyx_t_11, 2+__pyx_t_4, __pyx_t_1);
        __Pyx_GIVEREF(__pyx_t_7);
        PyTuple_SET_ITEM(__pyx_t_11, 3+__pyx_t_4, __pyx_t_7);
        __pyx_t_3 = 0;
        __pyx_t_1 = 0;
        __pyx_t_7 = 0;
        __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_11, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1738, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
        __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
        __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
        __pyx_t_6 = PyNumber_InPlaceAdd(__pyx_v_alt_seq, __pyx_t_2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1738, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_6);
        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
        __Pyx_DECREF_SET(__pyx_v_alt_seq, __pyx_t_6);
        __pyx_t_6 = 0;

        /* "vapor_vali/Simple_function.pyx":1739
 *                     elif x=='b':    alt_seq+=b_seq
 *                 alt_seq+=ref_seq_readin(ref,sv_info[0],max(bp_info),max(bp_info)+flank_length)
 *                 [window_size,window_size_qc]=window_size_refine(alt_seq)             # <<<<<<<<<<<<<<
 *                 if not window_size=='Error':
 *                     best_read_rec=''
 */
        __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_window_size_refine); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1739, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
        __pyx_t_11 = NULL;
        if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_2))) {
          __pyx_t_11 = PyMethod_GET_SELF(__pyx_t_2);
          if (likely(__pyx_t_11)) {
            PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
            __Pyx_INCREF(__pyx_t_11);
            __Pyx_INCREF(function);
            __Pyx_DECREF_SET(__pyx_t_2, function);
          }
        }
        if (!__pyx_t_11) {
          __pyx_t_6 = __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_v_alt_seq); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1739, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_6);
        } else {
          __pyx_t_7 = PyTuple_New(1+1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1739, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_7);
          __Pyx_GIVEREF(__pyx_t_11); PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_11); __pyx_t_11 = NULL;
          __Pyx_INCREF(__pyx_v_alt_seq);
          __Pyx_GIVEREF(__pyx_v_alt_seq);
          PyTuple_SET_ITEM(__pyx_t_7, 0+1, __pyx_v_alt_seq);
          __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_7, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1739, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_6);
          __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
        }
        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
        if ((likely(PyTuple_CheckExact(__pyx_t_6))) || (PyList_CheckExact(__pyx_t_6))) {
          PyObject* sequence = __pyx_t_6;
          #if CYTHON_COMPILING_IN_CPYTHON
          Py_ssize_t size = Py_SIZE(sequence);
          #else
          Py_ssize_t size = PySequence_Size(sequence);
          #endif
          if (unlikely(size != 2)) {
            if (size > 2) __Pyx_RaiseTooManyValuesError(2);
            else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
            __PYX_ERR(0, 1739, __pyx_L1_error)
          }
          #if CYTHON_COMPILING_IN_CPYTHON
          if (likely(PyTuple_CheckExact(sequence))) {
            __pyx_t_2 = PyTuple_GET_ITEM(sequence, 0); 
            __pyx_t_7 = PyTuple_GET_ITEM(sequence, 1); 
          } else {
            __pyx_t_2 = PyList_GET_ITEM(sequence, 0); 
            __pyx_t_7 = PyList_GET_ITEM(sequence, 1); 
          }
          __Pyx_INCREF(__pyx_t_2);
          __Pyx_INCREF(__pyx_t_7);
          #else
          __pyx_t_2 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1739, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_2);
          __pyx_t_7 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1739, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_7);
          #endif
          __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
        } else {
          Py_ssize_t index = -1;
          __pyx_t_11 = PyObject_GetIter(__pyx_t_6); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1739, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_11);
          __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
          __pyx_t_13 = Py_TYPE(__pyx_t_11)->tp_iternext;
          index = 0; __pyx_t_2 = __pyx_t_13(__pyx_t_11); if (unlikely(!__pyx_t_2)) goto __pyx_L20_unpacking_failed;
          __Pyx_GOTREF(__pyx_t_2);
          index = 1; __pyx_t_7 = __pyx_t_13(__pyx_t_11); if (unlikely(!__pyx_t_7)) goto __pyx_L20_unpacking_failed;
          __Pyx_GOTREF(__pyx_t_7);
          if (__Pyx_IternextUnpackEndCheck(__pyx_t_13(__pyx_t_11), 2) < 0) __PYX_ERR(0, 1739, __pyx_L1_error)
          __pyx_t_13 = NULL;
          __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
          goto __pyx_L21_unpacking_done;
          __pyx_L20_unpacking_failed:;
          __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
          __pyx_t_13 = NULL;
          if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
          __PYX_ERR(0, 1739, __pyx_L1_error)
          __pyx_L21_unpacking_done:;
        }
        __Pyx_DECREF_SET(__pyx_v_window_size, __pyx_t_2);
        __pyx_t_2 = 0;
        __Pyx_DECREF_SET(__pyx_v_window_size_qc, __pyx_t_7);
        __pyx_t_7 = 0;

        /* "vapor_vali/Simple_function.pyx":1740
 *                 alt_seq+=ref_seq_readin(ref,sv_info[0],max(bp_info),max(bp_info)+flank_length)
 *                 [window_size,window_size_qc]=window_size_refine(alt_seq)
 *                 if not window_size=='Error':             # <<<<<<<<<<<<<<
 *                     best_read_rec=''
 *                     for x in all_reads:
 */
        __pyx_t_10 = (__Pyx_PyString_Equals(__pyx_v_window_size, __pyx_n_s_Error, Py_EQ)); if (unlikely(__pyx_t_10 < 0)) __PYX_ERR(0, 1740, __pyx_L1_error)
        __pyx_t_9 = ((!__pyx_t_10) != 0);
        if (__pyx_t_9) {

          /* "vapor_vali/Simple_function.pyx":1741
 *                 [window_size,window_size_qc]=window_size_refine(alt_seq)
 *                 if not window_size=='Error':
 *                     best_read_rec=''             # <<<<<<<<<<<<<<
 *                     for x in all_reads:
 *                         vapor_single_read_score=calcu_vapor_single_read_score_directed_dis_m1b_redefine_diagnal(ref_seq,alt_seq,x,window_size)
 */
          __Pyx_INCREF(__pyx_kp_s__24);
          __Pyx_DECREF_SET(__pyx_v_best_read_rec, __pyx_kp_s__24);

          /* "vapor_vali/Simple_function.pyx":1742
 *                 if not window_size=='Error':
 *                     best_read_rec=''
 *                     for x in all_reads:             # <<<<<<<<<<<<<<
 *                         vapor_single_read_score=calcu_vapor_single_read_score_directed_dis_m1b_redefine_diagnal(ref_seq,alt_seq,x,window_size)
 *                         if not 0 in vapor_single_read_score:
 */
          if (likely(PyList_CheckExact(__pyx_v_all_reads)) || PyTuple_CheckExact(__pyx_v_all_reads)) {
            __pyx_t_6 = __pyx_v_all_reads; __Pyx_INCREF(__pyx_t_6); __pyx_t_4 = 0;
            __pyx_t_5 = NULL;
          } else {
            __pyx_t_4 = -1; __pyx_t_6 = PyObject_GetIter(__pyx_v_all_reads); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1742, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_6);
            __pyx_t_5 = Py_TYPE(__pyx_t_6)->tp_iternext; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1742, __pyx_L1_error)
          }
          for (;;) {
            if (likely(!__pyx_t_5)) {
              if (likely(PyList_CheckExact(__pyx_t_6))) {
                if (__pyx_t_4 >= PyList_GET_SIZE(__pyx_t_6)) break;
                #if CYTHON_COMPILING_IN_CPYTHON
                __pyx_t_7 = PyList_GET_ITEM(__pyx_t_6, __pyx_t_4); __Pyx_INCREF(__pyx_t_7); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 1742, __pyx_L1_error)
                #else
                __pyx_t_7 = PySequence_ITEM(__pyx_t_6, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1742, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_7);
                #endif
              } else {
                if (__pyx_t_4 >= PyTuple_GET_SIZE(__pyx_t_6)) break;
                #if CYTHON_COMPILING_IN_CPYTHON
                __pyx_t_7 = PyTuple_GET_ITEM(__pyx_t_6, __pyx_t_4); __Pyx_INCREF(__pyx_t_7); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 1742, __pyx_L1_error)
                #else
                __pyx_t_7 = PySequence_ITEM(__pyx_t_6, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1742, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_7);
                #endif
              }
            } else {
              __pyx_t_7 = __pyx_t_5(__pyx_t_6);
              if (unlikely(!__pyx_t_7)) {
                PyObject* exc_type = PyErr_Occurred();
                if (exc_type) {
                  if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
                  else __PYX_ERR(0, 1742, __pyx_L1_error)
                }
                break;
              }
              __Pyx_GOTREF(__pyx_t_7);
            }
            __Pyx_XDECREF_SET(__pyx_v_x, __pyx_t_7);
            __pyx_t_7 = 0;

            /* "vapor_vali/Simple_function.pyx":1743
 *                     best_read_rec=''
 *                     for x in all_reads:
 *                         vapor_single_read_score=calcu_vapor_single_read_score_directed_dis_m1b_redefine_diagnal(ref_seq,alt_seq,x,window_size)             # <<<<<<<<<<<<<<
 *                         if not 0 in vapor_single_read_score:
 *                             vapor_score_list.append(1-float(vapor_single_read_score[1])/float(vapor_single_read_score[0]))
 */
            __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_calcu_vapor_single_read_score_di); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1743, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_2);
            __pyx_t_11 = NULL;
            __pyx_t_14 = 0;
            if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_2))) {
              __pyx_t_11 = PyMethod_GET_SELF(__pyx_t_2);
              if (likely(__pyx_t_11)) {
                PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
                __Pyx_INCREF(__pyx_t_11);
                __Pyx_INCREF(function);
                __Pyx_DECREF_SET(__pyx_t_2, function);
                __pyx_t_14 = 1;
              }
            }
            __pyx_t_1 = PyTuple_New(4+__pyx_t_14); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1743, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_1);
            if (__pyx_t_11) {
              __Pyx_GIVEREF(__pyx_t_11); PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_11); __pyx_t_11 = NULL;
            }
            __Pyx_INCREF(__pyx_v_ref_seq);
            __Pyx_GIVEREF(__pyx_v_ref_seq);
            PyTuple_SET_ITEM(__pyx_t_1, 0+__pyx_t_14, __pyx_v_ref_seq);
            __Pyx_INCREF(__pyx_v_alt_seq);
            __Pyx_GIVEREF(__pyx_v_alt_seq);
            PyTuple_SET_ITEM(__pyx_t_1, 1+__pyx_t_14, __pyx_v_alt_seq);
            __Pyx_INCREF(__pyx_v_x);
            __Pyx_GIVEREF(__pyx_v_x);
            PyTuple_SET_ITEM(__pyx_t_1, 2+__pyx_t_14, __pyx_v_x);
            __Pyx_INCREF(__pyx_v_window_size);
            __Pyx_GIVEREF(__pyx_v_window_size);
            PyTuple_SET_ITEM(__pyx_t_1, 3+__pyx_t_14, __pyx_v_window_size);
            __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_1, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1743, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_7);
            __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
            __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
            __Pyx_XDECREF_SET(__pyx_v_vapor_single_read_score, __pyx_t_7);
            __pyx_t_7 = 0;

            /* "vapor_vali/Simple_function.pyx":1744
 *                     for x in all_reads:
 *                         vapor_single_read_score=calcu_vapor_single_read_score_directed_dis_m1b_redefine_diagnal(ref_seq,alt_seq,x,window_size)
 *                         if not 0 in vapor_single_read_score:             # <<<<<<<<<<<<<<
 *                             vapor_score_list.append(1-float(vapor_single_read_score[1])/float(vapor_single_read_score[0]))
 *                             if vapor_score_list[-1]==max(vapor_score_list):best_read_rec=x
 */
            __pyx_t_9 = (__Pyx_PySequence_ContainsTF(__pyx_int_0, __pyx_v_vapor_single_read_score, Py_NE)); if (unlikely(__pyx_t_9 < 0)) __PYX_ERR(0, 1744, __pyx_L1_error)
            __pyx_t_10 = (__pyx_t_9 != 0);
            if (__pyx_t_10) {

              /* "vapor_vali/Simple_function.pyx":1745
 *                         vapor_single_read_score=calcu_vapor_single_read_score_directed_dis_m1b_redefine_diagnal(ref_seq,alt_seq,x,window_size)
 *                         if not 0 in vapor_single_read_score:
 *                             vapor_score_list.append(1-float(vapor_single_read_score[1])/float(vapor_single_read_score[0]))             # <<<<<<<<<<<<<<
 *                             if vapor_score_list[-1]==max(vapor_score_list):best_read_rec=x
 *                     make_event_figure_1(vapor_score_list,best_read_rec,window_size,ref_seq,alt_seq,out_figure_name)
 */
              __pyx_t_7 = __Pyx_GetItemInt(__pyx_v_vapor_single_read_score, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1745, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_7);
              __pyx_t_15 = __Pyx_PyObject_AsDouble(__pyx_t_7); if (unlikely(__pyx_t_15 == ((double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1745, __pyx_L1_error)
              __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
              __pyx_t_7 = __Pyx_GetItemInt(__pyx_v_vapor_single_read_score, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1745, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_7);
              __pyx_t_16 = __Pyx_PyObject_AsDouble(__pyx_t_7); if (unlikely(__pyx_t_16 == ((double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1745, __pyx_L1_error)
              __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
              if (unlikely(__pyx_t_16 == 0)) {
                PyErr_SetString(PyExc_ZeroDivisionError, "float division");
                __PYX_ERR(0, 1745, __pyx_L1_error)
              }
              __pyx_t_7 = PyFloat_FromDouble((1.0 - (__pyx_t_15 / __pyx_t_16))); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1745, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_7);
              __pyx_t_8 = __Pyx_PyList_Append(__pyx_v_vapor_score_list, __pyx_t_7); if (unlikely(__pyx_t_8 == -1)) __PYX_ERR(0, 1745, __pyx_L1_error)
              __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;

              /* "vapor_vali/Simple_function.pyx":1746
 *                         if not 0 in vapor_single_read_score:
 *                             vapor_score_list.append(1-float(vapor_single_read_score[1])/float(vapor_single_read_score[0]))
 *                             if vapor_score_list[-1]==max(vapor_score_list):best_read_rec=x             # <<<<<<<<<<<<<<
 *                     make_event_figure_1(vapor_score_list,best_read_rec,window_size,ref_seq,alt_seq,out_figure_name)
 *     if run_flag==0:
 */
              __pyx_t_7 = __Pyx_GetItemInt_List(__pyx_v_vapor_score_list, -1L, long, 1, __Pyx_PyInt_From_long, 1, 1, 1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1746, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_7);
              __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1746, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_2);
              __Pyx_INCREF(__pyx_v_vapor_score_list);
              __Pyx_GIVEREF(__pyx_v_vapor_score_list);
              PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_v_vapor_score_list);
              __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_max, __pyx_t_2, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1746, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_1);
              __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
              __pyx_t_2 = PyObject_RichCompare(__pyx_t_7, __pyx_t_1, Py_EQ); __Pyx_XGOTREF(__pyx_t_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1746, __pyx_L1_error)
              __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
              __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
              __pyx_t_10 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_10 < 0)) __PYX_ERR(0, 1746, __pyx_L1_error)
              __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
              if (__pyx_t_10) {
                __Pyx_INCREF(__pyx_v_x);
                __Pyx_DECREF_SET(__pyx_v_best_read_rec, __pyx_v_x);
              }

              /* "vapor_vali/Simple_function.pyx":1744
 *                     for x in all_reads:
 *                         vapor_single_read_score=calcu_vapor_single_read_score_directed_dis_m1b_redefine_diagnal(ref_seq,alt_seq,x,window_size)
 *                         if not 0 in vapor_single_read_score:             # <<<<<<<<<<<<<<
 *                             vapor_score_list.append(1-float(vapor_single_read_score[1])/float(vapor_single_read_score[0]))
 *                             if vapor_score_list[-1]==max(vapor_score_list):best_read_rec=x
 */
            }

            /* "vapor_vali/Simple_function.pyx":1742
 *                 if not window_size=='Error':
 *                     best_read_rec=''
 *                     for x in all_reads:             # <<<<<<<<<<<<<<
 *                         vapor_single_read_score=calcu_vapor_single_read_score_directed_dis_m1b_redefine_diagnal(ref_seq,alt_seq,x,window_size)
 *                         if not 0 in vapor_single_read_score:
 */
          }
          __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

          /* "vapor_vali/Simple_function.pyx":1747
 *                             vapor_score_list.append(1-float(vapor_single_read_score[1])/float(vapor_single_read_score[0]))
 *                             if vapor_score_list[-1]==max(vapor_score_list):best_read_rec=x
 *                     make_event_figure_1(vapor_score_list,best_read_rec,window_size,ref_seq,alt_seq,out_figure_name)             # <<<<<<<<<<<<<<
 *     if run_flag==0:
 *         if max(bp_info)-min(bp_info)<default_max_sv_test: #only try to read in all reads with sv <100K; else: try breakpoints ;
 */
          __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_make_event_figure_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1747, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_2);
          __pyx_t_1 = NULL;
          __pyx_t_4 = 0;
          if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_2))) {
            __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_2);
            if (likely(__pyx_t_1)) {
              PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
              __Pyx_INCREF(__pyx_t_1);
              __Pyx_INCREF(function);
              __Pyx_DECREF_SET(__pyx_t_2, function);
              __pyx_t_4 = 1;
            }
          }
          __pyx_t_7 = PyTuple_New(6+__pyx_t_4); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1747, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_7);
          if (__pyx_t_1) {
            __Pyx_GIVEREF(__pyx_t_1); PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_1); __pyx_t_1 = NULL;
          }
          __Pyx_INCREF(__pyx_v_vapor_score_list);
          __Pyx_GIVEREF(__pyx_v_vapor_score_list);
          PyTuple_SET_ITEM(__pyx_t_7, 0+__pyx_t_4, __pyx_v_vapor_score_list);
          __Pyx_INCREF(__pyx_v_best_read_rec);
          __Pyx_GIVEREF(__pyx_v_best_read_rec);
          PyTuple_SET_ITEM(__pyx_t_7, 1+__pyx_t_4, __pyx_v_best_read_rec);
          __Pyx_INCREF(__pyx_v_window_size);
          __Pyx_GIVEREF(__pyx_v_window_size);
          PyTuple_SET_ITEM(__pyx_t_7, 2+__pyx_t_4, __pyx_v_window_size);
          __Pyx_INCREF(__pyx_v_ref_seq);
          __Pyx_GIVEREF(__pyx_v_ref_seq);
          PyTuple_SET_ITEM(__pyx_t_7, 3+__pyx_t_4, __pyx_v_ref_seq);
          __Pyx_INCREF(__pyx_v_alt_seq);
          __Pyx_GIVEREF(__pyx_v_alt_seq);
          PyTuple_SET_ITEM(__pyx_t_7, 4+__pyx_t_4, __pyx_v_alt_seq);
          __Pyx_INCREF(__pyx_v_out_figure_name);
          __Pyx_GIVEREF(__pyx_v_out_figure_name);
          PyTuple_SET_ITEM(__pyx_t_7, 5+__pyx_t_4, __pyx_v_out_figure_name);
          __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_7, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1747, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_6);
          __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
          __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
          __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

          /* "vapor_vali/Simple_function.pyx":1740
 *                 alt_seq+=ref_seq_readin(ref,sv_info[0],max(bp_info),max(bp_info)+flank_length)
 *                 [window_size,window_size_qc]=window_size_refine(alt_seq)
 *                 if not window_size=='Error':             # <<<<<<<<<<<<<<
 *                     best_read_rec=''
 *                     for x in all_reads:
 */
        }

        /* "vapor_vali/Simple_function.pyx":1727
 *         if not window_size=='Error':
 *             all_reads=simple_chop_pacbio_read_simple_short(bam_in,[sv_info[0]]+bp_info+[int(bp_info[-1])+sv_info[2]-sv_info[1]],flank_length)
 *             if len(all_reads)>0:             # <<<<<<<<<<<<<<
 *                 run_flag+=1
 *                 ref_structure=[i for i in 'ab']
 */
      }

      /* "vapor_vali/Simple_function.pyx":1725
 *         ref_seq=ref_seq_readin(ref,sv_info[0],min(bp_info)-flank_length,max(bp_info)+flank_length)
 *         [window_size,window_size_qc]=window_size_refine(ref_seq)
 *         if not window_size=='Error':             # <<<<<<<<<<<<<<
 *             all_reads=simple_chop_pacbio_read_simple_short(bam_in,[sv_info[0]]+bp_info+[int(bp_info[-1])+sv_info[2]-sv_info[1]],flank_length)
 *             if len(all_reads)>0:
 */
    }

    /* "vapor_vali/Simple_function.pyx":1722
 *     bp_info=sorted([int(i) for i in sv_info[1:3]+[sv_info[4]]])
 *     run_flag=0
 *     if sv_info[0]==sv_info[3] and max(bp_info)-min(bp_info)<default_max_sv_test: #try to test on the whole region             # <<<<<<<<<<<<<<
 *         ref_seq=ref_seq_readin(ref,sv_info[0],min(bp_info)-flank_length,max(bp_info)+flank_length)
 *         [window_size,window_size_qc]=window_size_refine(ref_seq)
 */
  }

  /* "vapor_vali/Simple_function.pyx":1748
 *                             if vapor_score_list[-1]==max(vapor_score_list):best_read_rec=x
 *                     make_event_figure_1(vapor_score_list,best_read_rec,window_size,ref_seq,alt_seq,out_figure_name)
 *     if run_flag==0:             # <<<<<<<<<<<<<<
 *         if max(bp_info)-min(bp_info)<default_max_sv_test: #only try to read in all reads with sv <100K; else: try breakpoints ;
 *             all_reads=simple_del_chop_pacbio_read_simple_short(bam_in,ins_point,flank_length)
 */
  __pyx_t_6 = __Pyx_PyInt_EqObjC(__pyx_v_run_flag, __pyx_int_0, 0, 0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1748, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_10 = __Pyx_PyObject_IsTrue(__pyx_t_6); if (unlikely(__pyx_t_10 < 0)) __PYX_ERR(0, 1748, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  if (__pyx_t_10) {

    /* "vapor_vali/Simple_function.pyx":1749
 *                     make_event_figure_1(vapor_score_list,best_read_rec,window_size,ref_seq,alt_seq,out_figure_name)
 *     if run_flag==0:
 *         if max(bp_info)-min(bp_info)<default_max_sv_test: #only try to read in all reads with sv <100K; else: try breakpoints ;             # <<<<<<<<<<<<<<
 *             all_reads=simple_del_chop_pacbio_read_simple_short(bam_in,ins_point,flank_length)
 *             if len(all_reads)>0:
 */
    __pyx_t_6 = PyTuple_New(1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1749, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __Pyx_INCREF(__pyx_v_bp_info);
    __Pyx_GIVEREF(__pyx_v_bp_info);
    PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_v_bp_info);
    __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_max, __pyx_t_6, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1749, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = PyTuple_New(1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1749, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __Pyx_INCREF(__pyx_v_bp_info);
    __Pyx_GIVEREF(__pyx_v_bp_info);
    PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_v_bp_info);
    __pyx_t_7 = __Pyx_PyObject_Call(__pyx_builtin_min, __pyx_t_6, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1749, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = PyNumber_Subtract(__pyx_t_2, __pyx_t_7); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1749, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_t_7 = __Pyx_GetModuleGlobalName(__pyx_n_s_default_max_sv_test); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1749, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    __pyx_t_2 = PyObject_RichCompare(__pyx_t_6, __pyx_t_7, Py_LT); __Pyx_XGOTREF(__pyx_t_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1749, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_t_10 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_10 < 0)) __PYX_ERR(0, 1749, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    if (__pyx_t_10) {

      /* "vapor_vali/Simple_function.pyx":1750
 *     if run_flag==0:
 *         if max(bp_info)-min(bp_info)<default_max_sv_test: #only try to read in all reads with sv <100K; else: try breakpoints ;
 *             all_reads=simple_del_chop_pacbio_read_simple_short(bam_in,ins_point,flank_length)             # <<<<<<<<<<<<<<
 *             if len(all_reads)>0:
 *                 ref_seq=ref_seq_readin(ref,ins_point[0],ins_point[1]-flank_length,ins_point[1]+flank_length)
 */
      __pyx_t_7 = __Pyx_GetModuleGlobalName(__pyx_n_s_simple_del_chop_pacbio_read_simp); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1750, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_7);
      __pyx_t_6 = NULL;
      __pyx_t_4 = 0;
      if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_7))) {
        __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_7);
        if (likely(__pyx_t_6)) {
          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_7);
          __Pyx_INCREF(__pyx_t_6);
          __Pyx_INCREF(function);
          __Pyx_DECREF_SET(__pyx_t_7, function);
          __pyx_t_4 = 1;
        }
      }
      __pyx_t_1 = PyTuple_New(3+__pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1750, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      if (__pyx_t_6) {
        __Pyx_GIVEREF(__pyx_t_6); PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_6); __pyx_t_6 = NULL;
      }
      __Pyx_INCREF(__pyx_v_bam_in);
      __Pyx_GIVEREF(__pyx_v_bam_in);
      PyTuple_SET_ITEM(__pyx_t_1, 0+__pyx_t_4, __pyx_v_bam_in);
      __Pyx_INCREF(__pyx_v_ins_point);
      __Pyx_GIVEREF(__pyx_v_ins_point);
      PyTuple_SET_ITEM(__pyx_t_1, 1+__pyx_t_4, __pyx_v_ins_point);
      __Pyx_INCREF(__pyx_v_flank_length);
      __Pyx_GIVEREF(__pyx_v_flank_length);
      PyTuple_SET_ITEM(__pyx_t_1, 2+__pyx_t_4, __pyx_v_flank_length);
      __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_7, __pyx_t_1, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1750, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
      __Pyx_XDECREF_SET(__pyx_v_all_reads, __pyx_t_2);
      __pyx_t_2 = 0;

      /* "vapor_vali/Simple_function.pyx":1751
 *         if max(bp_info)-min(bp_info)<default_max_sv_test: #only try to read in all reads with sv <100K; else: try breakpoints ;
 *             all_reads=simple_del_chop_pacbio_read_simple_short(bam_in,ins_point,flank_length)
 *             if len(all_reads)>0:             # <<<<<<<<<<<<<<
 *                 ref_seq=ref_seq_readin(ref,ins_point[0],ins_point[1]-flank_length,ins_point[1]+flank_length)
 *                 [window_size,window_size_qc]=window_size_refine(ref_seq)
 */
      __pyx_t_4 = PyObject_Length(__pyx_v_all_reads); if (unlikely(__pyx_t_4 == -1)) __PYX_ERR(0, 1751, __pyx_L1_error)
      __pyx_t_10 = ((__pyx_t_4 > 0) != 0);
      if (__pyx_t_10) {

        /* "vapor_vali/Simple_function.pyx":1752
 *             all_reads=simple_del_chop_pacbio_read_simple_short(bam_in,ins_point,flank_length)
 *             if len(all_reads)>0:
 *                 ref_seq=ref_seq_readin(ref,ins_point[0],ins_point[1]-flank_length,ins_point[1]+flank_length)             # <<<<<<<<<<<<<<
 *                 [window_size,window_size_qc]=window_size_refine(ref_seq)
 *                 if not window_size=='Error':
 */
        __pyx_t_7 = __Pyx_GetModuleGlobalName(__pyx_n_s_ref_seq_readin); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1752, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_7);
        __pyx_t_1 = __Pyx_GetItemInt_List(__pyx_v_ins_point, 0, long, 1, __Pyx_PyInt_From_long, 1, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1752, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        __pyx_t_6 = __Pyx_GetItemInt_List(__pyx_v_ins_point, 1, long, 1, __Pyx_PyInt_From_long, 1, 0, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1752, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_6);
        __pyx_t_11 = PyNumber_Subtract(__pyx_t_6, __pyx_v_flank_length); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1752, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_11);
        __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
        __pyx_t_6 = __Pyx_GetItemInt_List(__pyx_v_ins_point, 1, long, 1, __Pyx_PyInt_From_long, 1, 0, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1752, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_6);
        __pyx_t_3 = PyNumber_Add(__pyx_t_6, __pyx_v_flank_length); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1752, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_3);
        __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
        __pyx_t_6 = NULL;
        __pyx_t_4 = 0;
        if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_7))) {
          __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_7);
          if (likely(__pyx_t_6)) {
            PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_7);
            __Pyx_INCREF(__pyx_t_6);
            __Pyx_INCREF(function);
            __Pyx_DECREF_SET(__pyx_t_7, function);
            __pyx_t_4 = 1;
          }
        }
        __pyx_t_12 = PyTuple_New(4+__pyx_t_4); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1752, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_12);
        if (__pyx_t_6) {
          __Pyx_GIVEREF(__pyx_t_6); PyTuple_SET_ITEM(__pyx_t_12, 0, __pyx_t_6); __pyx_t_6 = NULL;
        }
        __Pyx_INCREF(__pyx_v_ref);
        __Pyx_GIVEREF(__pyx_v_ref);
        PyTuple_SET_ITEM(__pyx_t_12, 0+__pyx_t_4, __pyx_v_ref);
        __Pyx_GIVEREF(__pyx_t_1);
        PyTuple_SET_ITEM(__pyx_t_12, 1+__pyx_t_4, __pyx_t_1);
        __Pyx_GIVEREF(__pyx_t_11);
        PyTuple_SET_ITEM(__pyx_t_12, 2+__pyx_t_4, __pyx_t_11);
        __Pyx_GIVEREF(__pyx_t_3);
        PyTuple_SET_ITEM(__pyx_t_12, 3+__pyx_t_4, __pyx_t_3);
        __pyx_t_1 = 0;
        __pyx_t_11 = 0;
        __pyx_t_3 = 0;
        __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_7, __pyx_t_12, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1752, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
        __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
        __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
        __Pyx_XDECREF_SET(__pyx_v_ref_seq, __pyx_t_2);
        __pyx_t_2 = 0;

        /* "vapor_vali/Simple_function.pyx":1753
 *             if len(all_reads)>0:
 *                 ref_seq=ref_seq_readin(ref,ins_point[0],ins_point[1]-flank_length,ins_point[1]+flank_length)
 *                 [window_size,window_size_qc]=window_size_refine(ref_seq)             # <<<<<<<<<<<<<<
 *                 if not window_size=='Error':
 *                     alt_seq=ref_seq[:flank_length]+ref_seq_readin(ref,dup_block[0],dup_block[1],dup_block[2])+ref_seq[-flank_length:]
 */
        __pyx_t_7 = __Pyx_GetModuleGlobalName(__pyx_n_s_window_size_refine); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1753, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_7);
        __pyx_t_12 = NULL;
        if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_7))) {
          __pyx_t_12 = PyMethod_GET_SELF(__pyx_t_7);
          if (likely(__pyx_t_12)) {
            PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_7);
            __Pyx_INCREF(__pyx_t_12);
            __Pyx_INCREF(function);
            __Pyx_DECREF_SET(__pyx_t_7, function);
          }
        }
        if (!__pyx_t_12) {
          __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_t_7, __pyx_v_ref_seq); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1753, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_2);
        } else {
          __pyx_t_3 = PyTuple_New(1+1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1753, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_3);
          __Pyx_GIVEREF(__pyx_t_12); PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_12); __pyx_t_12 = NULL;
          __Pyx_INCREF(__pyx_v_ref_seq);
          __Pyx_GIVEREF(__pyx_v_ref_seq);
          PyTuple_SET_ITEM(__pyx_t_3, 0+1, __pyx_v_ref_seq);
          __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_7, __pyx_t_3, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1753, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_2);
          __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
        }
        __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
        if ((likely(PyTuple_CheckExact(__pyx_t_2))) || (PyList_CheckExact(__pyx_t_2))) {
          PyObject* sequence = __pyx_t_2;
          #if CYTHON_COMPILING_IN_CPYTHON
          Py_ssize_t size = Py_SIZE(sequence);
          #else
          Py_ssize_t size = PySequence_Size(sequence);
          #endif
          if (unlikely(size != 2)) {
            if (size > 2) __Pyx_RaiseTooManyValuesError(2);
            else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
            __PYX_ERR(0, 1753, __pyx_L1_error)
          }
          #if CYTHON_COMPILING_IN_CPYTHON
          if (likely(PyTuple_CheckExact(sequence))) {
            __pyx_t_7 = PyTuple_GET_ITEM(sequence, 0); 
            __pyx_t_3 = PyTuple_GET_ITEM(sequence, 1); 
          } else {
            __pyx_t_7 = PyList_GET_ITEM(sequence, 0); 
            __pyx_t_3 = PyList_GET_ITEM(sequence, 1); 
          }
          __Pyx_INCREF(__pyx_t_7);
          __Pyx_INCREF(__pyx_t_3);
          #else
          __pyx_t_7 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1753, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_7);
          __pyx_t_3 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1753, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_3);
          #endif
          __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
        } else {
          Py_ssize_t index = -1;
          __pyx_t_12 = PyObject_GetIter(__pyx_t_2); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1753, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_12);
          __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
          __pyx_t_13 = Py_TYPE(__pyx_t_12)->tp_iternext;
          index = 0; __pyx_t_7 = __pyx_t_13(__pyx_t_12); if (unlikely(!__pyx_t_7)) goto __pyx_L30_unpacking_failed;
          __Pyx_GOTREF(__pyx_t_7);
          index = 1; __pyx_t_3 = __pyx_t_13(__pyx_t_12); if (unlikely(!__pyx_t_3)) goto __pyx_L30_unpacking_failed;
          __Pyx_GOTREF(__pyx_t_3);
          if (__Pyx_IternextUnpackEndCheck(__pyx_t_13(__pyx_t_12), 2) < 0) __PYX_ERR(0, 1753, __pyx_L1_error)
          __pyx_t_13 = NULL;
          __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
          goto __pyx_L31_unpacking_done;
          __pyx_L30_unpacking_failed:;
          __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
          __pyx_t_13 = NULL;
          if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
          __PYX_ERR(0, 1753, __pyx_L1_error)
          __pyx_L31_unpacking_done:;
        }
        __Pyx_XDECREF_SET(__pyx_v_window_size, __pyx_t_7);
        __pyx_t_7 = 0;
        __Pyx_XDECREF_SET(__pyx_v_window_size_qc, __pyx_t_3);
        __pyx_t_3 = 0;

        /* "vapor_vali/Simple_function.pyx":1754
 *                 ref_seq=ref_seq_readin(ref,ins_point[0],ins_point[1]-flank_length,ins_point[1]+flank_length)
 *                 [window_size,window_size_qc]=window_size_refine(ref_seq)
 *                 if not window_size=='Error':             # <<<<<<<<<<<<<<
 *                     alt_seq=ref_seq[:flank_length]+ref_seq_readin(ref,dup_block[0],dup_block[1],dup_block[2])+ref_seq[-flank_length:]
 *                     [window_size,window_size_qc]=window_size_refine(alt_seq)
 */
        __pyx_t_10 = (__Pyx_PyString_Equals(__pyx_v_window_size, __pyx_n_s_Error, Py_EQ)); if (unlikely(__pyx_t_10 < 0)) __PYX_ERR(0, 1754, __pyx_L1_error)
        __pyx_t_9 = ((!__pyx_t_10) != 0);
        if (__pyx_t_9) {

          /* "vapor_vali/Simple_function.pyx":1755
 *                 [window_size,window_size_qc]=window_size_refine(ref_seq)
 *                 if not window_size=='Error':
 *                     alt_seq=ref_seq[:flank_length]+ref_seq_readin(ref,dup_block[0],dup_block[1],dup_block[2])+ref_seq[-flank_length:]             # <<<<<<<<<<<<<<
 *                     [window_size,window_size_qc]=window_size_refine(alt_seq)
 *                     if not window_size=='Error':
 */
          __pyx_t_2 = __Pyx_PyObject_GetSlice(__pyx_v_ref_seq, 0, 0, NULL, &__pyx_v_flank_length, NULL, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1755, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_2);
          __pyx_t_7 = __Pyx_GetModuleGlobalName(__pyx_n_s_ref_seq_readin); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1755, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_7);
          __pyx_t_12 = __Pyx_GetItemInt(__pyx_v_dup_block, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1755, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_12);
          __pyx_t_11 = __Pyx_GetItemInt(__pyx_v_dup_block, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1755, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_11);
          __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_dup_block, 2, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1755, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_1);
          __pyx_t_6 = NULL;
          __pyx_t_4 = 0;
          if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_7))) {
            __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_7);
            if (likely(__pyx_t_6)) {
              PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_7);
              __Pyx_INCREF(__pyx_t_6);
              __Pyx_INCREF(function);
              __Pyx_DECREF_SET(__pyx_t_7, function);
              __pyx_t_4 = 1;
            }
          }
          __pyx_t_17 = PyTuple_New(4+__pyx_t_4); if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 1755, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_17);
          if (__pyx_t_6) {
            __Pyx_GIVEREF(__pyx_t_6); PyTuple_SET_ITEM(__pyx_t_17, 0, __pyx_t_6); __pyx_t_6 = NULL;
          }
          __Pyx_INCREF(__pyx_v_ref);
          __Pyx_GIVEREF(__pyx_v_ref);
          PyTuple_SET_ITEM(__pyx_t_17, 0+__pyx_t_4, __pyx_v_ref);
          __Pyx_GIVEREF(__pyx_t_12);
          PyTuple_SET_ITEM(__pyx_t_17, 1+__pyx_t_4, __pyx_t_12);
          __Pyx_GIVEREF(__pyx_t_11);
          PyTuple_SET_ITEM(__pyx_t_17, 2+__pyx_t_4, __pyx_t_11);
          __Pyx_GIVEREF(__pyx_t_1);
          PyTuple_SET_ITEM(__pyx_t_17, 3+__pyx_t_4, __pyx_t_1);
          __pyx_t_12 = 0;
          __pyx_t_11 = 0;
          __pyx_t_1 = 0;
          __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_7, __pyx_t_17, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1755, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_3);
          __Pyx_DECREF(__pyx_t_17); __pyx_t_17 = 0;
          __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
          __pyx_t_7 = PyNumber_Add(__pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1755, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_7);
          __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
          __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
          __pyx_t_3 = PyNumber_Negative(__pyx_v_flank_length); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1755, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_3);
          __pyx_t_2 = __Pyx_PyObject_GetSlice(__pyx_v_ref_seq, 0, 0, &__pyx_t_3, NULL, NULL, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1755, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_2);
          __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
          __pyx_t_3 = PyNumber_Add(__pyx_t_7, __pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1755, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_3);
          __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
          __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
          __Pyx_XDECREF_SET(__pyx_v_alt_seq, __pyx_t_3);
          __pyx_t_3 = 0;

          /* "vapor_vali/Simple_function.pyx":1756
 *                 if not window_size=='Error':
 *                     alt_seq=ref_seq[:flank_length]+ref_seq_readin(ref,dup_block[0],dup_block[1],dup_block[2])+ref_seq[-flank_length:]
 *                     [window_size,window_size_qc]=window_size_refine(alt_seq)             # <<<<<<<<<<<<<<
 *                     if not window_size=='Error':
 *                         best_read_rec=''
 */
          __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_window_size_refine); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1756, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_2);
          __pyx_t_7 = NULL;
          if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_2))) {
            __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_2);
            if (likely(__pyx_t_7)) {
              PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
              __Pyx_INCREF(__pyx_t_7);
              __Pyx_INCREF(function);
              __Pyx_DECREF_SET(__pyx_t_2, function);
            }
          }
          if (!__pyx_t_7) {
            __pyx_t_3 = __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_v_alt_seq); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1756, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_3);
          } else {
            __pyx_t_17 = PyTuple_New(1+1); if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 1756, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_17);
            __Pyx_GIVEREF(__pyx_t_7); PyTuple_SET_ITEM(__pyx_t_17, 0, __pyx_t_7); __pyx_t_7 = NULL;
            __Pyx_INCREF(__pyx_v_alt_seq);
            __Pyx_GIVEREF(__pyx_v_alt_seq);
            PyTuple_SET_ITEM(__pyx_t_17, 0+1, __pyx_v_alt_seq);
            __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_17, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1756, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_3);
            __Pyx_DECREF(__pyx_t_17); __pyx_t_17 = 0;
          }
          __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
          if ((likely(PyTuple_CheckExact(__pyx_t_3))) || (PyList_CheckExact(__pyx_t_3))) {
            PyObject* sequence = __pyx_t_3;
            #if CYTHON_COMPILING_IN_CPYTHON
            Py_ssize_t size = Py_SIZE(sequence);
            #else
            Py_ssize_t size = PySequence_Size(sequence);
            #endif
            if (unlikely(size != 2)) {
              if (size > 2) __Pyx_RaiseTooManyValuesError(2);
              else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
              __PYX_ERR(0, 1756, __pyx_L1_error)
            }
            #if CYTHON_COMPILING_IN_CPYTHON
            if (likely(PyTuple_CheckExact(sequence))) {
              __pyx_t_2 = PyTuple_GET_ITEM(sequence, 0); 
              __pyx_t_17 = PyTuple_GET_ITEM(sequence, 1); 
            } else {
              __pyx_t_2 = PyList_GET_ITEM(sequence, 0); 
              __pyx_t_17 = PyList_GET_ITEM(sequence, 1); 
            }
            __Pyx_INCREF(__pyx_t_2);
            __Pyx_INCREF(__pyx_t_17);
            #else
            __pyx_t_2 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1756, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_2);
            __pyx_t_17 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 1756, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_17);
            #endif
            __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
          } else {
            Py_ssize_t index = -1;
            __pyx_t_7 = PyObject_GetIter(__pyx_t_3); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1756, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_7);
            __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
            __pyx_t_13 = Py_TYPE(__pyx_t_7)->tp_iternext;
            index = 0; __pyx_t_2 = __pyx_t_13(__pyx_t_7); if (unlikely(!__pyx_t_2)) goto __pyx_L33_unpacking_failed;
            __Pyx_GOTREF(__pyx_t_2);
            index = 1; __pyx_t_17 = __pyx_t_13(__pyx_t_7); if (unlikely(!__pyx_t_17)) goto __pyx_L33_unpacking_failed;
            __Pyx_GOTREF(__pyx_t_17);
            if (__Pyx_IternextUnpackEndCheck(__pyx_t_13(__pyx_t_7), 2) < 0) __PYX_ERR(0, 1756, __pyx_L1_error)
            __pyx_t_13 = NULL;
            __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
            goto __pyx_L34_unpacking_done;
            __pyx_L33_unpacking_failed:;
            __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
            __pyx_t_13 = NULL;
            if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
            __PYX_ERR(0, 1756, __pyx_L1_error)
            __pyx_L34_unpacking_done:;
          }
          __Pyx_DECREF_SET(__pyx_v_window_size, __pyx_t_2);
          __pyx_t_2 = 0;
          __Pyx_DECREF_SET(__pyx_v_window_size_qc, __pyx_t_17);
          __pyx_t_17 = 0;

          /* "vapor_vali/Simple_function.pyx":1757
 *                     alt_seq=ref_seq[:flank_length]+ref_seq_readin(ref,dup_block[0],dup_block[1],dup_block[2])+ref_seq[-flank_length:]
 *                     [window_size,window_size_qc]=window_size_refine(alt_seq)
 *                     if not window_size=='Error':             # <<<<<<<<<<<<<<
 *                         best_read_rec=''
 *                         for x in all_reads:
 */
          __pyx_t_9 = (__Pyx_PyString_Equals(__pyx_v_window_size, __pyx_n_s_Error, Py_EQ)); if (unlikely(__pyx_t_9 < 0)) __PYX_ERR(0, 1757, __pyx_L1_error)
          __pyx_t_10 = ((!__pyx_t_9) != 0);
          if (__pyx_t_10) {

            /* "vapor_vali/Simple_function.pyx":1758
 *                     [window_size,window_size_qc]=window_size_refine(alt_seq)
 *                     if not window_size=='Error':
 *                         best_read_rec=''             # <<<<<<<<<<<<<<
 *                         for x in all_reads:
 *                             vapor_single_read_score=calcu_vapor_single_read_score_abs_dis_m1b(ref_seq,alt_seq,x,window_size)
 */
            __Pyx_INCREF(__pyx_kp_s__24);
            __Pyx_DECREF_SET(__pyx_v_best_read_rec, __pyx_kp_s__24);

            /* "vapor_vali/Simple_function.pyx":1759
 *                     if not window_size=='Error':
 *                         best_read_rec=''
 *                         for x in all_reads:             # <<<<<<<<<<<<<<
 *                             vapor_single_read_score=calcu_vapor_single_read_score_abs_dis_m1b(ref_seq,alt_seq,x,window_size)
 *                             if not 0 in vapor_single_read_score:
 */
            if (likely(PyList_CheckExact(__pyx_v_all_reads)) || PyTuple_CheckExact(__pyx_v_all_reads)) {
              __pyx_t_3 = __pyx_v_all_reads; __Pyx_INCREF(__pyx_t_3); __pyx_t_4 = 0;
              __pyx_t_5 = NULL;
            } else {
              __pyx_t_4 = -1; __pyx_t_3 = PyObject_GetIter(__pyx_v_all_reads); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1759, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_3);
              __pyx_t_5 = Py_TYPE(__pyx_t_3)->tp_iternext; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1759, __pyx_L1_error)
            }
            for (;;) {
              if (likely(!__pyx_t_5)) {
                if (likely(PyList_CheckExact(__pyx_t_3))) {
                  if (__pyx_t_4 >= PyList_GET_SIZE(__pyx_t_3)) break;
                  #if CYTHON_COMPILING_IN_CPYTHON
                  __pyx_t_17 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_4); __Pyx_INCREF(__pyx_t_17); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 1759, __pyx_L1_error)
                  #else
                  __pyx_t_17 = PySequence_ITEM(__pyx_t_3, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 1759, __pyx_L1_error)
                  __Pyx_GOTREF(__pyx_t_17);
                  #endif
                } else {
                  if (__pyx_t_4 >= PyTuple_GET_SIZE(__pyx_t_3)) break;
                  #if CYTHON_COMPILING_IN_CPYTHON
                  __pyx_t_17 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_4); __Pyx_INCREF(__pyx_t_17); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 1759, __pyx_L1_error)
                  #else
                  __pyx_t_17 = PySequence_ITEM(__pyx_t_3, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 1759, __pyx_L1_error)
                  __Pyx_GOTREF(__pyx_t_17);
                  #endif
                }
              } else {
                __pyx_t_17 = __pyx_t_5(__pyx_t_3);
                if (unlikely(!__pyx_t_17)) {
                  PyObject* exc_type = PyErr_Occurred();
                  if (exc_type) {
                    if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
                    else __PYX_ERR(0, 1759, __pyx_L1_error)
                  }
                  break;
                }
                __Pyx_GOTREF(__pyx_t_17);
              }
              __Pyx_XDECREF_SET(__pyx_v_x, __pyx_t_17);
              __pyx_t_17 = 0;

              /* "vapor_vali/Simple_function.pyx":1760
 *                         best_read_rec=''
 *                         for x in all_reads:
 *                             vapor_single_read_score=calcu_vapor_single_read_score_abs_dis_m1b(ref_seq,alt_seq,x,window_size)             # <<<<<<<<<<<<<<
 *                             if not 0 in vapor_single_read_score:
 *                                 vapor_score_list.append(1-float(vapor_single_read_score[1])/float(vapor_single_read_score[0]))
 */
              __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_calcu_vapor_single_read_score_ab); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1760, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_2);
              __pyx_t_7 = NULL;
              __pyx_t_14 = 0;
              if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_2))) {
                __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_2);
                if (likely(__pyx_t_7)) {
                  PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
                  __Pyx_INCREF(__pyx_t_7);
                  __Pyx_INCREF(function);
                  __Pyx_DECREF_SET(__pyx_t_2, function);
                  __pyx_t_14 = 1;
                }
              }
              __pyx_t_1 = PyTuple_New(4+__pyx_t_14); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1760, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_1);
              if (__pyx_t_7) {
                __Pyx_GIVEREF(__pyx_t_7); PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_7); __pyx_t_7 = NULL;
              }
              __Pyx_INCREF(__pyx_v_ref_seq);
              __Pyx_GIVEREF(__pyx_v_ref_seq);
              PyTuple_SET_ITEM(__pyx_t_1, 0+__pyx_t_14, __pyx_v_ref_seq);
              __Pyx_INCREF(__pyx_v_alt_seq);
              __Pyx_GIVEREF(__pyx_v_alt_seq);
              PyTuple_SET_ITEM(__pyx_t_1, 1+__pyx_t_14, __pyx_v_alt_seq);
              __Pyx_INCREF(__pyx_v_x);
              __Pyx_GIVEREF(__pyx_v_x);
              PyTuple_SET_ITEM(__pyx_t_1, 2+__pyx_t_14, __pyx_v_x);
              __Pyx_INCREF(__pyx_v_window_size);
              __Pyx_GIVEREF(__pyx_v_window_size);
              PyTuple_SET_ITEM(__pyx_t_1, 3+__pyx_t_14, __pyx_v_window_size);
              __pyx_t_17 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_1, NULL); if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 1760, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_17);
              __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
              __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
              __Pyx_XDECREF_SET(__pyx_v_vapor_single_read_score, __pyx_t_17);
              __pyx_t_17 = 0;

              /* "vapor_vali/Simple_function.pyx":1761
 *                         for x in all_reads:
 *                             vapor_single_read_score=calcu_vapor_single_read_score_abs_dis_m1b(ref_seq,alt_seq,x,window_size)
 *                             if not 0 in vapor_single_read_score:             # <<<<<<<<<<<<<<
 *                                 vapor_score_list.append(1-float(vapor_single_read_score[1])/float(vapor_single_read_score[0]))
 *                                 if vapor_score_list[-1]==max(vapor_score_list):best_read_rec=x
 */
              __pyx_t_10 = (__Pyx_PySequence_ContainsTF(__pyx_int_0, __pyx_v_vapor_single_read_score, Py_NE)); if (unlikely(__pyx_t_10 < 0)) __PYX_ERR(0, 1761, __pyx_L1_error)
              __pyx_t_9 = (__pyx_t_10 != 0);
              if (__pyx_t_9) {

                /* "vapor_vali/Simple_function.pyx":1762
 *                             vapor_single_read_score=calcu_vapor_single_read_score_abs_dis_m1b(ref_seq,alt_seq,x,window_size)
 *                             if not 0 in vapor_single_read_score:
 *                                 vapor_score_list.append(1-float(vapor_single_read_score[1])/float(vapor_single_read_score[0]))             # <<<<<<<<<<<<<<
 *                                 if vapor_score_list[-1]==max(vapor_score_list):best_read_rec=x
 *                         make_event_figure_1(vapor_score_list,best_read_rec,window_size,ref_seq,alt_seq,out_figure_name)
 */
                __pyx_t_17 = __Pyx_GetItemInt(__pyx_v_vapor_single_read_score, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 1762, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_17);
                __pyx_t_16 = __Pyx_PyObject_AsDouble(__pyx_t_17); if (unlikely(__pyx_t_16 == ((double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1762, __pyx_L1_error)
                __Pyx_DECREF(__pyx_t_17); __pyx_t_17 = 0;
                __pyx_t_17 = __Pyx_GetItemInt(__pyx_v_vapor_single_read_score, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 1762, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_17);
                __pyx_t_15 = __Pyx_PyObject_AsDouble(__pyx_t_17); if (unlikely(__pyx_t_15 == ((double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1762, __pyx_L1_error)
                __Pyx_DECREF(__pyx_t_17); __pyx_t_17 = 0;
                if (unlikely(__pyx_t_15 == 0)) {
                  PyErr_SetString(PyExc_ZeroDivisionError, "float division");
                  __PYX_ERR(0, 1762, __pyx_L1_error)
                }
                __pyx_t_17 = PyFloat_FromDouble((1.0 - (__pyx_t_16 / __pyx_t_15))); if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 1762, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_17);
                __pyx_t_8 = __Pyx_PyList_Append(__pyx_v_vapor_score_list, __pyx_t_17); if (unlikely(__pyx_t_8 == -1)) __PYX_ERR(0, 1762, __pyx_L1_error)
                __Pyx_DECREF(__pyx_t_17); __pyx_t_17 = 0;

                /* "vapor_vali/Simple_function.pyx":1763
 *                             if not 0 in vapor_single_read_score:
 *                                 vapor_score_list.append(1-float(vapor_single_read_score[1])/float(vapor_single_read_score[0]))
 *                                 if vapor_score_list[-1]==max(vapor_score_list):best_read_rec=x             # <<<<<<<<<<<<<<
 *                         make_event_figure_1(vapor_score_list,best_read_rec,window_size,ref_seq,alt_seq,out_figure_name)
 *         else:
 */
                __pyx_t_17 = __Pyx_GetItemInt_List(__pyx_v_vapor_score_list, -1L, long, 1, __Pyx_PyInt_From_long, 1, 1, 1); if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 1763, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_17);
                __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1763, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_2);
                __Pyx_INCREF(__pyx_v_vapor_score_list);
                __Pyx_GIVEREF(__pyx_v_vapor_score_list);
                PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_v_vapor_score_list);
                __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_max, __pyx_t_2, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1763, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_1);
                __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
                __pyx_t_2 = PyObject_RichCompare(__pyx_t_17, __pyx_t_1, Py_EQ); __Pyx_XGOTREF(__pyx_t_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1763, __pyx_L1_error)
                __Pyx_DECREF(__pyx_t_17); __pyx_t_17 = 0;
                __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
                __pyx_t_9 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_9 < 0)) __PYX_ERR(0, 1763, __pyx_L1_error)
                __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
                if (__pyx_t_9) {
                  __Pyx_INCREF(__pyx_v_x);
                  __Pyx_DECREF_SET(__pyx_v_best_read_rec, __pyx_v_x);
                }

                /* "vapor_vali/Simple_function.pyx":1761
 *                         for x in all_reads:
 *                             vapor_single_read_score=calcu_vapor_single_read_score_abs_dis_m1b(ref_seq,alt_seq,x,window_size)
 *                             if not 0 in vapor_single_read_score:             # <<<<<<<<<<<<<<
 *                                 vapor_score_list.append(1-float(vapor_single_read_score[1])/float(vapor_single_read_score[0]))
 *                                 if vapor_score_list[-1]==max(vapor_score_list):best_read_rec=x
 */
              }

              /* "vapor_vali/Simple_function.pyx":1759
 *                     if not window_size=='Error':
 *                         best_read_rec=''
 *                         for x in all_reads:             # <<<<<<<<<<<<<<
 *                             vapor_single_read_score=calcu_vapor_single_read_score_abs_dis_m1b(ref_seq,alt_seq,x,window_size)
 *                             if not 0 in vapor_single_read_score:
 */
            }
            __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;

            /* "vapor_vali/Simple_function.pyx":1764
 *                                 vapor_score_list.append(1-float(vapor_single_read_score[1])/float(vapor_single_read_score[0]))
 *                                 if vapor_score_list[-1]==max(vapor_score_list):best_read_rec=x
 *                         make_event_figure_1(vapor_score_list,best_read_rec,window_size,ref_seq,alt_seq,out_figure_name)             # <<<<<<<<<<<<<<
 *         else:
 *             all_reads=simple_del_chop_pacbio_read_simple_short(bam_in,ins_point,flank_length)
 */
            __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_make_event_figure_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1764, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_2);
            __pyx_t_1 = NULL;
            __pyx_t_4 = 0;
            if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_2))) {
              __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_2);
              if (likely(__pyx_t_1)) {
                PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
                __Pyx_INCREF(__pyx_t_1);
                __Pyx_INCREF(function);
                __Pyx_DECREF_SET(__pyx_t_2, function);
                __pyx_t_4 = 1;
              }
            }
            __pyx_t_17 = PyTuple_New(6+__pyx_t_4); if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 1764, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_17);
            if (__pyx_t_1) {
              __Pyx_GIVEREF(__pyx_t_1); PyTuple_SET_ITEM(__pyx_t_17, 0, __pyx_t_1); __pyx_t_1 = NULL;
            }
            __Pyx_INCREF(__pyx_v_vapor_score_list);
            __Pyx_GIVEREF(__pyx_v_vapor_score_list);
            PyTuple_SET_ITEM(__pyx_t_17, 0+__pyx_t_4, __pyx_v_vapor_score_list);
            __Pyx_INCREF(__pyx_v_best_read_rec);
            __Pyx_GIVEREF(__pyx_v_best_read_rec);
            PyTuple_SET_ITEM(__pyx_t_17, 1+__pyx_t_4, __pyx_v_best_read_rec);
            __Pyx_INCREF(__pyx_v_window_size);
            __Pyx_GIVEREF(__pyx_v_window_size);
            PyTuple_SET_ITEM(__pyx_t_17, 2+__pyx_t_4, __pyx_v_window_size);
            __Pyx_INCREF(__pyx_v_ref_seq);
            __Pyx_GIVEREF(__pyx_v_ref_seq);
            PyTuple_SET_ITEM(__pyx_t_17, 3+__pyx_t_4, __pyx_v_ref_seq);
            __Pyx_INCREF(__pyx_v_alt_seq);
            __Pyx_GIVEREF(__pyx_v_alt_seq);
            PyTuple_SET_ITEM(__pyx_t_17, 4+__pyx_t_4, __pyx_v_alt_seq);
            __Pyx_INCREF(__pyx_v_out_figure_name);
            __Pyx_GIVEREF(__pyx_v_out_figure_name);
            PyTuple_SET_ITEM(__pyx_t_17, 5+__pyx_t_4, __pyx_v_out_figure_name);
            __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_17, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1764, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_3);
            __Pyx_DECREF(__pyx_t_17); __pyx_t_17 = 0;
            __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
            __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;

            /* "vapor_vali/Simple_function.pyx":1757
 *                     alt_seq=ref_seq[:flank_length]+ref_seq_readin(ref,dup_block[0],dup_block[1],dup_block[2])+ref_seq[-flank_length:]
 *                     [window_size,window_size_qc]=window_size_refine(alt_seq)
 *                     if not window_size=='Error':             # <<<<<<<<<<<<<<
 *                         best_read_rec=''
 *                         for x in all_reads:
 */
          }

          /* "vapor_vali/Simple_function.pyx":1754
 *                 ref_seq=ref_seq_readin(ref,ins_point[0],ins_point[1]-flank_length,ins_point[1]+flank_length)
 *                 [window_size,window_size_qc]=window_size_refine(ref_seq)
 *                 if not window_size=='Error':             # <<<<<<<<<<<<<<
 *                     alt_seq=ref_seq[:flank_length]+ref_seq_readin(ref,dup_block[0],dup_block[1],dup_block[2])+ref_seq[-flank_length:]
 *                     [window_size,window_size_qc]=window_size_refine(alt_seq)
 */
        }

        /* "vapor_vali/Simple_function.pyx":1751
 *         if max(bp_info)-min(bp_info)<default_max_sv_test: #only try to read in all reads with sv <100K; else: try breakpoints ;
 *             all_reads=simple_del_chop_pacbio_read_simple_short(bam_in,ins_point,flank_length)
 *             if len(all_reads)>0:             # <<<<<<<<<<<<<<
 *                 ref_seq=ref_seq_readin(ref,ins_point[0],ins_point[1]-flank_length,ins_point[1]+flank_length)
 *                 [window_size,window_size_qc]=window_size_refine(ref_seq)
 */
      }

      /* "vapor_vali/Simple_function.pyx":1749
 *                     make_event_figure_1(vapor_score_list,best_read_rec,window_size,ref_seq,alt_seq,out_figure_name)
 *     if run_flag==0:
 *         if max(bp_info)-min(bp_info)<default_max_sv_test: #only try to read in all reads with sv <100K; else: try breakpoints ;             # <<<<<<<<<<<<<<
 *             all_reads=simple_del_chop_pacbio_read_simple_short(bam_in,ins_point,flank_length)
 *             if len(all_reads)>0:
 */
      goto __pyx_L28;
    }

    /* "vapor_vali/Simple_function.pyx":1766
 *                         make_event_figure_1(vapor_score_list,best_read_rec,window_size,ref_seq,alt_seq,out_figure_name)
 *         else:
 *             all_reads=simple_del_chop_pacbio_read_simple_short(bam_in,ins_point,flank_length)             # <<<<<<<<<<<<<<
 *             if len(all_reads)>0:
 *                 ref_seq=ref_seq_readin(ref,ins_point[0],ins_point[1]-flank_length,ins_point[1]+flank_length)
 */
    /*else*/ {
      __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_simple_del_chop_pacbio_read_simp); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1766, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __pyx_t_17 = NULL;
      __pyx_t_4 = 0;
      if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_2))) {
        __pyx_t_17 = PyMethod_GET_SELF(__pyx_t_2);
        if (likely(__pyx_t_17)) {
          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
          __Pyx_INCREF(__pyx_t_17);
          __Pyx_INCREF(function);
          __Pyx_DECREF_SET(__pyx_t_2, function);
          __pyx_t_4 = 1;
        }
      }
      __pyx_t_1 = PyTuple_New(3+__pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1766, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      if (__pyx_t_17) {
        __Pyx_GIVEREF(__pyx_t_17); PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_17); __pyx_t_17 = NULL;
      }
      __Pyx_INCREF(__pyx_v_bam_in);
      __Pyx_GIVEREF(__pyx_v_bam_in);
      PyTuple_SET_ITEM(__pyx_t_1, 0+__pyx_t_4, __pyx_v_bam_in);
      __Pyx_INCREF(__pyx_v_ins_point);
      __Pyx_GIVEREF(__pyx_v_ins_point);
      PyTuple_SET_ITEM(__pyx_t_1, 1+__pyx_t_4, __pyx_v_ins_point);
      __Pyx_INCREF(__pyx_v_flank_length);
      __Pyx_GIVEREF(__pyx_v_flank_length);
      PyTuple_SET_ITEM(__pyx_t_1, 2+__pyx_t_4, __pyx_v_flank_length);
      __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_1, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1766, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      __Pyx_XDECREF_SET(__pyx_v_all_reads, __pyx_t_3);
      __pyx_t_3 = 0;

      /* "vapor_vali/Simple_function.pyx":1767
 *         else:
 *             all_reads=simple_del_chop_pacbio_read_simple_short(bam_in,ins_point,flank_length)
 *             if len(all_reads)>0:             # <<<<<<<<<<<<<<
 *                 ref_seq=ref_seq_readin(ref,ins_point[0],ins_point[1]-flank_length,ins_point[1]+flank_length)
 *                 [window_size,window_size_qc]=window_size_refine(ref_seq)
 */
      __pyx_t_4 = PyObject_Length(__pyx_v_all_reads); if (unlikely(__pyx_t_4 == -1)) __PYX_ERR(0, 1767, __pyx_L1_error)
      __pyx_t_9 = ((__pyx_t_4 > 0) != 0);
      if (__pyx_t_9) {

        /* "vapor_vali/Simple_function.pyx":1768
 *             all_reads=simple_del_chop_pacbio_read_simple_short(bam_in,ins_point,flank_length)
 *             if len(all_reads)>0:
 *                 ref_seq=ref_seq_readin(ref,ins_point[0],ins_point[1]-flank_length,ins_point[1]+flank_length)             # <<<<<<<<<<<<<<
 *                 [window_size,window_size_qc]=window_size_refine(ref_seq)
 *                 if not window_size=='Error':
 */
        __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_ref_seq_readin); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1768, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
        __pyx_t_1 = __Pyx_GetItemInt_List(__pyx_v_ins_point, 0, long, 1, __Pyx_PyInt_From_long, 1, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1768, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        __pyx_t_17 = __Pyx_GetItemInt_List(__pyx_v_ins_point, 1, long, 1, __Pyx_PyInt_From_long, 1, 0, 1); if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 1768, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_17);
        __pyx_t_7 = PyNumber_Subtract(__pyx_t_17, __pyx_v_flank_length); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1768, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_7);
        __Pyx_DECREF(__pyx_t_17); __pyx_t_17 = 0;
        __pyx_t_17 = __Pyx_GetItemInt_List(__pyx_v_ins_point, 1, long, 1, __Pyx_PyInt_From_long, 1, 0, 1); if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 1768, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_17);
        __pyx_t_11 = PyNumber_Add(__pyx_t_17, __pyx_v_flank_length); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1768, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_11);
        __Pyx_DECREF(__pyx_t_17); __pyx_t_17 = 0;
        __pyx_t_17 = NULL;
        __pyx_t_4 = 0;
        if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_2))) {
          __pyx_t_17 = PyMethod_GET_SELF(__pyx_t_2);
          if (likely(__pyx_t_17)) {
            PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
            __Pyx_INCREF(__pyx_t_17);
            __Pyx_INCREF(function);
            __Pyx_DECREF_SET(__pyx_t_2, function);
            __pyx_t_4 = 1;
          }
        }
        __pyx_t_12 = PyTuple_New(4+__pyx_t_4); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1768, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_12);
        if (__pyx_t_17) {
          __Pyx_GIVEREF(__pyx_t_17); PyTuple_SET_ITEM(__pyx_t_12, 0, __pyx_t_17); __pyx_t_17 = NULL;
        }
        __Pyx_INCREF(__pyx_v_ref);
        __Pyx_GIVEREF(__pyx_v_ref);
        PyTuple_SET_ITEM(__pyx_t_12, 0+__pyx_t_4, __pyx_v_ref);
        __Pyx_GIVEREF(__pyx_t_1);
        PyTuple_SET_ITEM(__pyx_t_12, 1+__pyx_t_4, __pyx_t_1);
        __Pyx_GIVEREF(__pyx_t_7);
        PyTuple_SET_ITEM(__pyx_t_12, 2+__pyx_t_4, __pyx_t_7);
        __Pyx_GIVEREF(__pyx_t_11);
        PyTuple_SET_ITEM(__pyx_t_12, 3+__pyx_t_4, __pyx_t_11);
        __pyx_t_1 = 0;
        __pyx_t_7 = 0;
        __pyx_t_11 = 0;
        __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_12, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1768, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_3);
        __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
        __Pyx_XDECREF_SET(__pyx_v_ref_seq, __pyx_t_3);
        __pyx_t_3 = 0;

        /* "vapor_vali/Simple_function.pyx":1769
 *             if len(all_reads)>0:
 *                 ref_seq=ref_seq_readin(ref,ins_point[0],ins_point[1]-flank_length,ins_point[1]+flank_length)
 *                 [window_size,window_size_qc]=window_size_refine(ref_seq)             # <<<<<<<<<<<<<<
 *                 if not window_size=='Error':
 *                     alt_seq=ref_seq[:flank_length]+ref_seq_readin(ref,dup_block[0],dup_block[1],dup_block[1]+flank_length)
 */
        __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_window_size_refine); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1769, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
        __pyx_t_12 = NULL;
        if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_2))) {
          __pyx_t_12 = PyMethod_GET_SELF(__pyx_t_2);
          if (likely(__pyx_t_12)) {
            PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
            __Pyx_INCREF(__pyx_t_12);
            __Pyx_INCREF(function);
            __Pyx_DECREF_SET(__pyx_t_2, function);
          }
        }
        if (!__pyx_t_12) {
          __pyx_t_3 = __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_v_ref_seq); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1769, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_3);
        } else {
          __pyx_t_11 = PyTuple_New(1+1); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1769, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_11);
          __Pyx_GIVEREF(__pyx_t_12); PyTuple_SET_ITEM(__pyx_t_11, 0, __pyx_t_12); __pyx_t_12 = NULL;
          __Pyx_INCREF(__pyx_v_ref_seq);
          __Pyx_GIVEREF(__pyx_v_ref_seq);
          PyTuple_SET_ITEM(__pyx_t_11, 0+1, __pyx_v_ref_seq);
          __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_11, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1769, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_3);
          __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
        }
        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
        if ((likely(PyTuple_CheckExact(__pyx_t_3))) || (PyList_CheckExact(__pyx_t_3))) {
          PyObject* sequence = __pyx_t_3;
          #if CYTHON_COMPILING_IN_CPYTHON
          Py_ssize_t size = Py_SIZE(sequence);
          #else
          Py_ssize_t size = PySequence_Size(sequence);
          #endif
          if (unlikely(size != 2)) {
            if (size > 2) __Pyx_RaiseTooManyValuesError(2);
            else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
            __PYX_ERR(0, 1769, __pyx_L1_error)
          }
          #if CYTHON_COMPILING_IN_CPYTHON
          if (likely(PyTuple_CheckExact(sequence))) {
            __pyx_t_2 = PyTuple_GET_ITEM(sequence, 0); 
            __pyx_t_11 = PyTuple_GET_ITEM(sequence, 1); 
          } else {
            __pyx_t_2 = PyList_GET_ITEM(sequence, 0); 
            __pyx_t_11 = PyList_GET_ITEM(sequence, 1); 
          }
          __Pyx_INCREF(__pyx_t_2);
          __Pyx_INCREF(__pyx_t_11);
          #else
          __pyx_t_2 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1769, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_2);
          __pyx_t_11 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1769, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_11);
          #endif
          __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
        } else {
          Py_ssize_t index = -1;
          __pyx_t_12 = PyObject_GetIter(__pyx_t_3); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1769, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_12);
          __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
          __pyx_t_13 = Py_TYPE(__pyx_t_12)->tp_iternext;
          index = 0; __pyx_t_2 = __pyx_t_13(__pyx_t_12); if (unlikely(!__pyx_t_2)) goto __pyx_L41_unpacking_failed;
          __Pyx_GOTREF(__pyx_t_2);
          index = 1; __pyx_t_11 = __pyx_t_13(__pyx_t_12); if (unlikely(!__pyx_t_11)) goto __pyx_L41_unpacking_failed;
          __Pyx_GOTREF(__pyx_t_11);
          if (__Pyx_IternextUnpackEndCheck(__pyx_t_13(__pyx_t_12), 2) < 0) __PYX_ERR(0, 1769, __pyx_L1_error)
          __pyx_t_13 = NULL;
          __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
          goto __pyx_L42_unpacking_done;
          __pyx_L41_unpacking_failed:;
          __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
          __pyx_t_13 = NULL;
          if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
          __PYX_ERR(0, 1769, __pyx_L1_error)
          __pyx_L42_unpacking_done:;
        }
        __Pyx_XDECREF_SET(__pyx_v_window_size, __pyx_t_2);
        __pyx_t_2 = 0;
        __Pyx_XDECREF_SET(__pyx_v_window_size_qc, __pyx_t_11);
        __pyx_t_11 = 0;

        /* "vapor_vali/Simple_function.pyx":1770
 *                 ref_seq=ref_seq_readin(ref,ins_point[0],ins_point[1]-flank_length,ins_point[1]+flank_length)
 *                 [window_size,window_size_qc]=window_size_refine(ref_seq)
 *                 if not window_size=='Error':             # <<<<<<<<<<<<<<
 *                     alt_seq=ref_seq[:flank_length]+ref_seq_readin(ref,dup_block[0],dup_block[1],dup_block[1]+flank_length)
 *                     [window_size,window_size_qc]=window_size_refine(alt_seq)
 */
        __pyx_t_9 = (__Pyx_PyString_Equals(__pyx_v_window_size, __pyx_n_s_Error, Py_EQ)); if (unlikely(__pyx_t_9 < 0)) __PYX_ERR(0, 1770, __pyx_L1_error)
        __pyx_t_10 = ((!__pyx_t_9) != 0);
        if (__pyx_t_10) {

          /* "vapor_vali/Simple_function.pyx":1771
 *                 [window_size,window_size_qc]=window_size_refine(ref_seq)
 *                 if not window_size=='Error':
 *                     alt_seq=ref_seq[:flank_length]+ref_seq_readin(ref,dup_block[0],dup_block[1],dup_block[1]+flank_length)             # <<<<<<<<<<<<<<
 *                     [window_size,window_size_qc]=window_size_refine(alt_seq)
 *                     if not window_size=='Error':
 */
          __pyx_t_3 = __Pyx_PyObject_GetSlice(__pyx_v_ref_seq, 0, 0, NULL, &__pyx_v_flank_length, NULL, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1771, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_3);
          __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_ref_seq_readin); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1771, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_2);
          __pyx_t_12 = __Pyx_GetItemInt(__pyx_v_dup_block, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1771, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_12);
          __pyx_t_7 = __Pyx_GetItemInt(__pyx_v_dup_block, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1771, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_7);
          __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_dup_block, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1771, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_1);
          __pyx_t_17 = PyNumber_Add(__pyx_t_1, __pyx_v_flank_length); if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 1771, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_17);
          __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
          __pyx_t_1 = NULL;
          __pyx_t_4 = 0;
          if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_2))) {
            __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_2);
            if (likely(__pyx_t_1)) {
              PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
              __Pyx_INCREF(__pyx_t_1);
              __Pyx_INCREF(function);
              __Pyx_DECREF_SET(__pyx_t_2, function);
              __pyx_t_4 = 1;
            }
          }
          __pyx_t_6 = PyTuple_New(4+__pyx_t_4); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1771, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_6);
          if (__pyx_t_1) {
            __Pyx_GIVEREF(__pyx_t_1); PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_1); __pyx_t_1 = NULL;
          }
          __Pyx_INCREF(__pyx_v_ref);
          __Pyx_GIVEREF(__pyx_v_ref);
          PyTuple_SET_ITEM(__pyx_t_6, 0+__pyx_t_4, __pyx_v_ref);
          __Pyx_GIVEREF(__pyx_t_12);
          PyTuple_SET_ITEM(__pyx_t_6, 1+__pyx_t_4, __pyx_t_12);
          __Pyx_GIVEREF(__pyx_t_7);
          PyTuple_SET_ITEM(__pyx_t_6, 2+__pyx_t_4, __pyx_t_7);
          __Pyx_GIVEREF(__pyx_t_17);
          PyTuple_SET_ITEM(__pyx_t_6, 3+__pyx_t_4, __pyx_t_17);
          __pyx_t_12 = 0;
          __pyx_t_7 = 0;
          __pyx_t_17 = 0;
          __pyx_t_11 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_6, NULL); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1771, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_11);
          __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
          __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
          __pyx_t_2 = PyNumber_Add(__pyx_t_3, __pyx_t_11); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1771, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_2);
          __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
          __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
          __Pyx_XDECREF_SET(__pyx_v_alt_seq, __pyx_t_2);
          __pyx_t_2 = 0;

          /* "vapor_vali/Simple_function.pyx":1772
 *                 if not window_size=='Error':
 *                     alt_seq=ref_seq[:flank_length]+ref_seq_readin(ref,dup_block[0],dup_block[1],dup_block[1]+flank_length)
 *                     [window_size,window_size_qc]=window_size_refine(alt_seq)             # <<<<<<<<<<<<<<
 *                     if not window_size=='Error':
 *                         best_read_rec=''
 */
          __pyx_t_11 = __Pyx_GetModuleGlobalName(__pyx_n_s_window_size_refine); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1772, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_11);
          __pyx_t_3 = NULL;
          if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_11))) {
            __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_11);
            if (likely(__pyx_t_3)) {
              PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_11);
              __Pyx_INCREF(__pyx_t_3);
              __Pyx_INCREF(function);
              __Pyx_DECREF_SET(__pyx_t_11, function);
            }
          }
          if (!__pyx_t_3) {
            __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_t_11, __pyx_v_alt_seq); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1772, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_2);
          } else {
            __pyx_t_6 = PyTuple_New(1+1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1772, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_6);
            __Pyx_GIVEREF(__pyx_t_3); PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_3); __pyx_t_3 = NULL;
            __Pyx_INCREF(__pyx_v_alt_seq);
            __Pyx_GIVEREF(__pyx_v_alt_seq);
            PyTuple_SET_ITEM(__pyx_t_6, 0+1, __pyx_v_alt_seq);
            __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_11, __pyx_t_6, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1772, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_2);
            __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
          }
          __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
          if ((likely(PyTuple_CheckExact(__pyx_t_2))) || (PyList_CheckExact(__pyx_t_2))) {
            PyObject* sequence = __pyx_t_2;
            #if CYTHON_COMPILING_IN_CPYTHON
            Py_ssize_t size = Py_SIZE(sequence);
            #else
            Py_ssize_t size = PySequence_Size(sequence);
            #endif
            if (unlikely(size != 2)) {
              if (size > 2) __Pyx_RaiseTooManyValuesError(2);
              else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
              __PYX_ERR(0, 1772, __pyx_L1_error)
            }
            #if CYTHON_COMPILING_IN_CPYTHON
            if (likely(PyTuple_CheckExact(sequence))) {
              __pyx_t_11 = PyTuple_GET_ITEM(sequence, 0); 
              __pyx_t_6 = PyTuple_GET_ITEM(sequence, 1); 
            } else {
              __pyx_t_11 = PyList_GET_ITEM(sequence, 0); 
              __pyx_t_6 = PyList_GET_ITEM(sequence, 1); 
            }
            __Pyx_INCREF(__pyx_t_11);
            __Pyx_INCREF(__pyx_t_6);
            #else
            __pyx_t_11 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1772, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_11);
            __pyx_t_6 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1772, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_6);
            #endif
            __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
          } else {
            Py_ssize_t index = -1;
            __pyx_t_3 = PyObject_GetIter(__pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1772, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_3);
            __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
            __pyx_t_13 = Py_TYPE(__pyx_t_3)->tp_iternext;
            index = 0; __pyx_t_11 = __pyx_t_13(__pyx_t_3); if (unlikely(!__pyx_t_11)) goto __pyx_L44_unpacking_failed;
            __Pyx_GOTREF(__pyx_t_11);
            index = 1; __pyx_t_6 = __pyx_t_13(__pyx_t_3); if (unlikely(!__pyx_t_6)) goto __pyx_L44_unpacking_failed;
            __Pyx_GOTREF(__pyx_t_6);
            if (__Pyx_IternextUnpackEndCheck(__pyx_t_13(__pyx_t_3), 2) < 0) __PYX_ERR(0, 1772, __pyx_L1_error)
            __pyx_t_13 = NULL;
            __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
            goto __pyx_L45_unpacking_done;
            __pyx_L44_unpacking_failed:;
            __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
            __pyx_t_13 = NULL;
            if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
            __PYX_ERR(0, 1772, __pyx_L1_error)
            __pyx_L45_unpacking_done:;
          }
          __Pyx_DECREF_SET(__pyx_v_window_size, __pyx_t_11);
          __pyx_t_11 = 0;
          __Pyx_DECREF_SET(__pyx_v_window_size_qc, __pyx_t_6);
          __pyx_t_6 = 0;

          /* "vapor_vali/Simple_function.pyx":1773
 *                     alt_seq=ref_seq[:flank_length]+ref_seq_readin(ref,dup_block[0],dup_block[1],dup_block[1]+flank_length)
 *                     [window_size,window_size_qc]=window_size_refine(alt_seq)
 *                     if not window_size=='Error':             # <<<<<<<<<<<<<<
 *                         best_read_rec=''
 *                         for x in all_reads:
 */
          __pyx_t_10 = (__Pyx_PyString_Equals(__pyx_v_window_size, __pyx_n_s_Error, Py_EQ)); if (unlikely(__pyx_t_10 < 0)) __PYX_ERR(0, 1773, __pyx_L1_error)
          __pyx_t_9 = ((!__pyx_t_10) != 0);
          if (__pyx_t_9) {

            /* "vapor_vali/Simple_function.pyx":1774
 *                     [window_size,window_size_qc]=window_size_refine(alt_seq)
 *                     if not window_size=='Error':
 *                         best_read_rec=''             # <<<<<<<<<<<<<<
 *                         for x in all_reads:
 *                             vapor_single_read_score=calcu_vapor_single_read_score_within_10Perc_m1b(ref_seq,alt_seq,x,window_size)
 */
            __Pyx_INCREF(__pyx_kp_s__24);
            __Pyx_DECREF_SET(__pyx_v_best_read_rec, __pyx_kp_s__24);

            /* "vapor_vali/Simple_function.pyx":1775
 *                     if not window_size=='Error':
 *                         best_read_rec=''
 *                         for x in all_reads:             # <<<<<<<<<<<<<<
 *                             vapor_single_read_score=calcu_vapor_single_read_score_within_10Perc_m1b(ref_seq,alt_seq,x,window_size)
 *                             if not 0 in vapor_single_read_score:
 */
            if (likely(PyList_CheckExact(__pyx_v_all_reads)) || PyTuple_CheckExact(__pyx_v_all_reads)) {
              __pyx_t_2 = __pyx_v_all_reads; __Pyx_INCREF(__pyx_t_2); __pyx_t_4 = 0;
              __pyx_t_5 = NULL;
            } else {
              __pyx_t_4 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_v_all_reads); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1775, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_2);
              __pyx_t_5 = Py_TYPE(__pyx_t_2)->tp_iternext; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1775, __pyx_L1_error)
            }
            for (;;) {
              if (likely(!__pyx_t_5)) {
                if (likely(PyList_CheckExact(__pyx_t_2))) {
                  if (__pyx_t_4 >= PyList_GET_SIZE(__pyx_t_2)) break;
                  #if CYTHON_COMPILING_IN_CPYTHON
                  __pyx_t_6 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_4); __Pyx_INCREF(__pyx_t_6); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 1775, __pyx_L1_error)
                  #else
                  __pyx_t_6 = PySequence_ITEM(__pyx_t_2, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1775, __pyx_L1_error)
                  __Pyx_GOTREF(__pyx_t_6);
                  #endif
                } else {
                  if (__pyx_t_4 >= PyTuple_GET_SIZE(__pyx_t_2)) break;
                  #if CYTHON_COMPILING_IN_CPYTHON
                  __pyx_t_6 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_4); __Pyx_INCREF(__pyx_t_6); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 1775, __pyx_L1_error)
                  #else
                  __pyx_t_6 = PySequence_ITEM(__pyx_t_2, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1775, __pyx_L1_error)
                  __Pyx_GOTREF(__pyx_t_6);
                  #endif
                }
              } else {
                __pyx_t_6 = __pyx_t_5(__pyx_t_2);
                if (unlikely(!__pyx_t_6)) {
                  PyObject* exc_type = PyErr_Occurred();
                  if (exc_type) {
                    if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
                    else __PYX_ERR(0, 1775, __pyx_L1_error)
                  }
                  break;
                }
                __Pyx_GOTREF(__pyx_t_6);
              }
              __Pyx_XDECREF_SET(__pyx_v_x, __pyx_t_6);
              __pyx_t_6 = 0;

              /* "vapor_vali/Simple_function.pyx":1776
 *                         best_read_rec=''
 *                         for x in all_reads:
 *                             vapor_single_read_score=calcu_vapor_single_read_score_within_10Perc_m1b(ref_seq,alt_seq,x,window_size)             # <<<<<<<<<<<<<<
 *                             if not 0 in vapor_single_read_score:
 *                                 vapor_score_list.append(1-float(vapor_single_read_score[1])/float(vapor_single_read_score[0]))
 */
              __pyx_t_11 = __Pyx_GetModuleGlobalName(__pyx_n_s_calcu_vapor_single_read_score_wi); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1776, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_11);
              __pyx_t_3 = NULL;
              __pyx_t_14 = 0;
              if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_11))) {
                __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_11);
                if (likely(__pyx_t_3)) {
                  PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_11);
                  __Pyx_INCREF(__pyx_t_3);
                  __Pyx_INCREF(function);
                  __Pyx_DECREF_SET(__pyx_t_11, function);
                  __pyx_t_14 = 1;
                }
              }
              __pyx_t_17 = PyTuple_New(4+__pyx_t_14); if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 1776, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_17);
              if (__pyx_t_3) {
                __Pyx_GIVEREF(__pyx_t_3); PyTuple_SET_ITEM(__pyx_t_17, 0, __pyx_t_3); __pyx_t_3 = NULL;
              }
              __Pyx_INCREF(__pyx_v_ref_seq);
              __Pyx_GIVEREF(__pyx_v_ref_seq);
              PyTuple_SET_ITEM(__pyx_t_17, 0+__pyx_t_14, __pyx_v_ref_seq);
              __Pyx_INCREF(__pyx_v_alt_seq);
              __Pyx_GIVEREF(__pyx_v_alt_seq);
              PyTuple_SET_ITEM(__pyx_t_17, 1+__pyx_t_14, __pyx_v_alt_seq);
              __Pyx_INCREF(__pyx_v_x);
              __Pyx_GIVEREF(__pyx_v_x);
              PyTuple_SET_ITEM(__pyx_t_17, 2+__pyx_t_14, __pyx_v_x);
              __Pyx_INCREF(__pyx_v_window_size);
              __Pyx_GIVEREF(__pyx_v_window_size);
              PyTuple_SET_ITEM(__pyx_t_17, 3+__pyx_t_14, __pyx_v_window_size);
              __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_11, __pyx_t_17, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1776, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_6);
              __Pyx_DECREF(__pyx_t_17); __pyx_t_17 = 0;
              __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
              __Pyx_XDECREF_SET(__pyx_v_vapor_single_read_score, __pyx_t_6);
              __pyx_t_6 = 0;

              /* "vapor_vali/Simple_function.pyx":1777
 *                         for x in all_reads:
 *                             vapor_single_read_score=calcu_vapor_single_read_score_within_10Perc_m1b(ref_seq,alt_seq,x,window_size)
 *                             if not 0 in vapor_single_read_score:             # <<<<<<<<<<<<<<
 *                                 vapor_score_list.append(1-float(vapor_single_read_score[1])/float(vapor_single_read_score[0]))
 *                                 if vapor_score_list[-1]==max(vapor_score_list):best_read_rec=x
 */
              __pyx_t_9 = (__Pyx_PySequence_ContainsTF(__pyx_int_0, __pyx_v_vapor_single_read_score, Py_NE)); if (unlikely(__pyx_t_9 < 0)) __PYX_ERR(0, 1777, __pyx_L1_error)
              __pyx_t_10 = (__pyx_t_9 != 0);
              if (__pyx_t_10) {

                /* "vapor_vali/Simple_function.pyx":1778
 *                             vapor_single_read_score=calcu_vapor_single_read_score_within_10Perc_m1b(ref_seq,alt_seq,x,window_size)
 *                             if not 0 in vapor_single_read_score:
 *                                 vapor_score_list.append(1-float(vapor_single_read_score[1])/float(vapor_single_read_score[0]))             # <<<<<<<<<<<<<<
 *                                 if vapor_score_list[-1]==max(vapor_score_list):best_read_rec=x
 *                         make_event_figure_1(vapor_score_list,best_read_rec,window_size,ref_seq,alt_seq,out_figure_name)
 */
                __pyx_t_6 = __Pyx_GetItemInt(__pyx_v_vapor_single_read_score, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1778, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_6);
                __pyx_t_15 = __Pyx_PyObject_AsDouble(__pyx_t_6); if (unlikely(__pyx_t_15 == ((double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1778, __pyx_L1_error)
                __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
                __pyx_t_6 = __Pyx_GetItemInt(__pyx_v_vapor_single_read_score, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1778, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_6);
                __pyx_t_16 = __Pyx_PyObject_AsDouble(__pyx_t_6); if (unlikely(__pyx_t_16 == ((double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1778, __pyx_L1_error)
                __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
                if (unlikely(__pyx_t_16 == 0)) {
                  PyErr_SetString(PyExc_ZeroDivisionError, "float division");
                  __PYX_ERR(0, 1778, __pyx_L1_error)
                }
                __pyx_t_6 = PyFloat_FromDouble((1.0 - (__pyx_t_15 / __pyx_t_16))); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1778, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_6);
                __pyx_t_8 = __Pyx_PyList_Append(__pyx_v_vapor_score_list, __pyx_t_6); if (unlikely(__pyx_t_8 == -1)) __PYX_ERR(0, 1778, __pyx_L1_error)
                __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

                /* "vapor_vali/Simple_function.pyx":1779
 *                             if not 0 in vapor_single_read_score:
 *                                 vapor_score_list.append(1-float(vapor_single_read_score[1])/float(vapor_single_read_score[0]))
 *                                 if vapor_score_list[-1]==max(vapor_score_list):best_read_rec=x             # <<<<<<<<<<<<<<
 *                         make_event_figure_1(vapor_score_list,best_read_rec,window_size,ref_seq,alt_seq,out_figure_name)
 *     return vapor_score_list
 */
                __pyx_t_6 = __Pyx_GetItemInt_List(__pyx_v_vapor_score_list, -1L, long, 1, __Pyx_PyInt_From_long, 1, 1, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1779, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_6);
                __pyx_t_11 = PyTuple_New(1); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1779, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_11);
                __Pyx_INCREF(__pyx_v_vapor_score_list);
                __Pyx_GIVEREF(__pyx_v_vapor_score_list);
                PyTuple_SET_ITEM(__pyx_t_11, 0, __pyx_v_vapor_score_list);
                __pyx_t_17 = __Pyx_PyObject_Call(__pyx_builtin_max, __pyx_t_11, NULL); if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 1779, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_17);
                __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
                __pyx_t_11 = PyObject_RichCompare(__pyx_t_6, __pyx_t_17, Py_EQ); __Pyx_XGOTREF(__pyx_t_11); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1779, __pyx_L1_error)
                __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
                __Pyx_DECREF(__pyx_t_17); __pyx_t_17 = 0;
                __pyx_t_10 = __Pyx_PyObject_IsTrue(__pyx_t_11); if (unlikely(__pyx_t_10 < 0)) __PYX_ERR(0, 1779, __pyx_L1_error)
                __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
                if (__pyx_t_10) {
                  __Pyx_INCREF(__pyx_v_x);
                  __Pyx_DECREF_SET(__pyx_v_best_read_rec, __pyx_v_x);
                }

                /* "vapor_vali/Simple_function.pyx":1777
 *                         for x in all_reads:
 *                             vapor_single_read_score=calcu_vapor_single_read_score_within_10Perc_m1b(ref_seq,alt_seq,x,window_size)
 *                             if not 0 in vapor_single_read_score:             # <<<<<<<<<<<<<<
 *                                 vapor_score_list.append(1-float(vapor_single_read_score[1])/float(vapor_single_read_score[0]))
 *                                 if vapor_score_list[-1]==max(vapor_score_list):best_read_rec=x
 */
              }

              /* "vapor_vali/Simple_function.pyx":1775
 *                     if not window_size=='Error':
 *                         best_read_rec=''
 *                         for x in all_reads:             # <<<<<<<<<<<<<<
 *                             vapor_single_read_score=calcu_vapor_single_read_score_within_10Perc_m1b(ref_seq,alt_seq,x,window_size)
 *                             if not 0 in vapor_single_read_score:
 */
            }
            __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

            /* "vapor_vali/Simple_function.pyx":1780
 *                                 vapor_score_list.append(1-float(vapor_single_read_score[1])/float(vapor_single_read_score[0]))
 *                                 if vapor_score_list[-1]==max(vapor_score_list):best_read_rec=x
 *                         make_event_figure_1(vapor_score_list,best_read_rec,window_size,ref_seq,alt_seq,out_figure_name)             # <<<<<<<<<<<<<<
 *     return vapor_score_list
 * 
 */
            __pyx_t_11 = __Pyx_GetModuleGlobalName(__pyx_n_s_make_event_figure_1); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1780, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_11);
            __pyx_t_17 = NULL;
            __pyx_t_4 = 0;
            if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_11))) {
              __pyx_t_17 = PyMethod_GET_SELF(__pyx_t_11);
              if (likely(__pyx_t_17)) {
                PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_11);
                __Pyx_INCREF(__pyx_t_17);
                __Pyx_INCREF(function);
                __Pyx_DECREF_SET(__pyx_t_11, function);
                __pyx_t_4 = 1;
              }
            }
            __pyx_t_6 = PyTuple_New(6+__pyx_t_4); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1780, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_6);
            if (__pyx_t_17) {
              __Pyx_GIVEREF(__pyx_t_17); PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_17); __pyx_t_17 = NULL;
            }
            __Pyx_INCREF(__pyx_v_vapor_score_list);
            __Pyx_GIVEREF(__pyx_v_vapor_score_list);
            PyTuple_SET_ITEM(__pyx_t_6, 0+__pyx_t_4, __pyx_v_vapor_score_list);
            __Pyx_INCREF(__pyx_v_best_read_rec);
            __Pyx_GIVEREF(__pyx_v_best_read_rec);
            PyTuple_SET_ITEM(__pyx_t_6, 1+__pyx_t_4, __pyx_v_best_read_rec);
            __Pyx_INCREF(__pyx_v_window_size);
            __Pyx_GIVEREF(__pyx_v_window_size);
            PyTuple_SET_ITEM(__pyx_t_6, 2+__pyx_t_4, __pyx_v_window_size);
            __Pyx_INCREF(__pyx_v_ref_seq);
            __Pyx_GIVEREF(__pyx_v_ref_seq);
            PyTuple_SET_ITEM(__pyx_t_6, 3+__pyx_t_4, __pyx_v_ref_seq);
            __Pyx_INCREF(__pyx_v_alt_seq);
            __Pyx_GIVEREF(__pyx_v_alt_seq);
            PyTuple_SET_ITEM(__pyx_t_6, 4+__pyx_t_4, __pyx_v_alt_seq);
            __Pyx_INCREF(__pyx_v_out_figure_name);
            __Pyx_GIVEREF(__pyx_v_out_figure_name);
            PyTuple_SET_ITEM(__pyx_t_6, 5+__pyx_t_4, __pyx_v_out_figure_name);
            __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_11, __pyx_t_6, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1780, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_2);
            __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
            __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
            __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

            /* "vapor_vali/Simple_function.pyx":1773
 *                     alt_seq=ref_seq[:flank_length]+ref_seq_readin(ref,dup_block[0],dup_block[1],dup_block[1]+flank_length)
 *                     [window_size,window_size_qc]=window_size_refine(alt_seq)
 *                     if not window_size=='Error':             # <<<<<<<<<<<<<<
 *                         best_read_rec=''
 *                         for x in all_reads:
 */
          }

          /* "vapor_vali/Simple_function.pyx":1770
 *                 ref_seq=ref_seq_readin(ref,ins_point[0],ins_point[1]-flank_length,ins_point[1]+flank_length)
 *                 [window_size,window_size_qc]=window_size_refine(ref_seq)
 *                 if not window_size=='Error':             # <<<<<<<<<<<<<<
 *                     alt_seq=ref_seq[:flank_length]+ref_seq_readin(ref,dup_block[0],dup_block[1],dup_block[1]+flank_length)
 *                     [window_size,window_size_qc]=window_size_refine(alt_seq)
 */
        }

        /* "vapor_vali/Simple_function.pyx":1767
 *         else:
 *             all_reads=simple_del_chop_pacbio_read_simple_short(bam_in,ins_point,flank_length)
 *             if len(all_reads)>0:             # <<<<<<<<<<<<<<
 *                 ref_seq=ref_seq_readin(ref,ins_point[0],ins_point[1]-flank_length,ins_point[1]+flank_length)
 *                 [window_size,window_size_qc]=window_size_refine(ref_seq)
 */
      }
    }
    __pyx_L28:;

    /* "vapor_vali/Simple_function.pyx":1748
 *                             if vapor_score_list[-1]==max(vapor_score_list):best_read_rec=x
 *                     make_event_figure_1(vapor_score_list,best_read_rec,window_size,ref_seq,alt_seq,out_figure_name)
 *     if run_flag==0:             # <<<<<<<<<<<<<<
 *         if max(bp_info)-min(bp_info)<default_max_sv_test: #only try to read in all reads with sv <100K; else: try breakpoints ;
 *             all_reads=simple_del_chop_pacbio_read_simple_short(bam_in,ins_point,flank_length)
 */
  }

  /* "vapor_vali/Simple_function.pyx":1781
 *                                 if vapor_score_list[-1]==max(vapor_score_list):best_read_rec=x
 *                         make_event_figure_1(vapor_score_list,best_read_rec,window_size,ref_seq,alt_seq,out_figure_name)
 *     return vapor_score_list             # <<<<<<<<<<<<<<
 * 
 * def vapor_simple_ins_Vapor(bam_in,ref,ins_pos,ins_seq,out_figure_name,POLARITY):
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_vapor_score_list);
  __pyx_r = __pyx_v_vapor_score_list;
  goto __pyx_L0;

  /* "vapor_vali/Simple_function.pyx":1713
 *     return vapor_score_list
 * 
 * def vapor_simple_disdup_Vapor(bam_in,ref,sv_info,out_figure_name):             # <<<<<<<<<<<<<<
 *     sv_info[1:3]=[int(i) for i in sv_info[1:3]]
 *     dup_block=sv_info[:3]
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_XDECREF(__pyx_t_7);
  __Pyx_XDECREF(__pyx_t_11);
  __Pyx_XDECREF(__pyx_t_12);
  __Pyx_XDECREF(__pyx_t_17);
  __Pyx_AddTraceback("vapor_vali.Simple_function.vapor_simple_disdup_Vapor", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_dup_block);
  __Pyx_XDECREF(__pyx_v_ins_point);
  __Pyx_XDECREF(__pyx_v_flank_length);
  __Pyx_XDECREF(__pyx_v_vapor_score_list);
  __Pyx_XDECREF(__pyx_v_best_read_rec);
  __Pyx_XDECREF(__pyx_v_bp_info);
  __Pyx_XDECREF(__pyx_v_run_flag);
  __Pyx_XDECREF(__pyx_v_ref_seq);
  __Pyx_XDECREF(__pyx_v_window_size);
  __Pyx_XDECREF(__pyx_v_window_size_qc);
  __Pyx_XDECREF(__pyx_v_all_reads);
  __Pyx_XDECREF(__pyx_v_ref_structure);
  __Pyx_XDECREF(__pyx_v_alt_structure);
  __Pyx_XDECREF(__pyx_v_alt_seq);
  __Pyx_XDECREF(__pyx_v_a_seq);
  __Pyx_XDECREF(__pyx_v_b_seq);
  __Pyx_XDECREF(__pyx_v_x);
  __Pyx_XDECREF(__pyx_v_vapor_single_read_score);
  __Pyx_XDECREF(__pyx_v_i);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "vapor_vali/Simple_function.pyx":1783
 *     return vapor_score_list
 * 
 * def vapor_simple_ins_Vapor(bam_in,ref,ins_pos,ins_seq,out_figure_name,POLARITY):             # <<<<<<<<<<<<<<
 *     #eg of ins_pos='chr1_83144055'
 *     #eg of bam_in='/nfs/turbo/remillsscr/scratch2_trans/datasets/1000genomes/vol1/ftp/data_collections/hgsv_sv_discovery/PacBio/alignment/HG00512.XXX.bam'
 */

/* Python wrapper */
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_215vapor_simple_ins_Vapor(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_10vapor_vali_15Simple_function_215vapor_simple_ins_Vapor = {"vapor_simple_ins_Vapor", (PyCFunction)__pyx_pw_10vapor_vali_15Simple_function_215vapor_simple_ins_Vapor, METH_VARARGS|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_215vapor_simple_ins_Vapor(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_bam_in = 0;
  PyObject *__pyx_v_ref = 0;
  PyObject *__pyx_v_ins_pos = 0;
  PyObject *__pyx_v_ins_seq = 0;
  PyObject *__pyx_v_out_figure_name = 0;
  PyObject *__pyx_v_POLARITY = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("vapor_simple_ins_Vapor (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_bam_in,&__pyx_n_s_ref,&__pyx_n_s_ins_pos,&__pyx_n_s_ins_seq,&__pyx_n_s_out_figure_name,&__pyx_n_s_POLARITY,0};
    PyObject* values[6] = {0,0,0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
      switch (pos_args) {
        case  6: values[5] = PyTuple_GET_ITEM(__pyx_args, 5);
        case  5: values[4] = PyTuple_GET_ITEM(__pyx_args, 4);
        case  4: values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
        case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_bam_in)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_ref)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("vapor_simple_ins_Vapor", 1, 6, 6, 1); __PYX_ERR(0, 1783, __pyx_L3_error)
        }
        case  2:
        if (likely((values[2] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_ins_pos)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("vapor_simple_ins_Vapor", 1, 6, 6, 2); __PYX_ERR(0, 1783, __pyx_L3_error)
        }
        case  3:
        if (likely((values[3] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_ins_seq)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("vapor_simple_ins_Vapor", 1, 6, 6, 3); __PYX_ERR(0, 1783, __pyx_L3_error)
        }
        case  4:
        if (likely((values[4] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_out_figure_name)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("vapor_simple_ins_Vapor", 1, 6, 6, 4); __PYX_ERR(0, 1783, __pyx_L3_error)
        }
        case  5:
        if (likely((values[5] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_POLARITY)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("vapor_simple_ins_Vapor", 1, 6, 6, 5); __PYX_ERR(0, 1783, __pyx_L3_error)
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "vapor_simple_ins_Vapor") < 0)) __PYX_ERR(0, 1783, __pyx_L3_error)
      }
    } else if (PyTuple_GET_SIZE(__pyx_args) != 6) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
      values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
      values[4] = PyTuple_GET_ITEM(__pyx_args, 4);
      values[5] = PyTuple_GET_ITEM(__pyx_args, 5);
    }
    __pyx_v_bam_in = values[0];
    __pyx_v_ref = values[1];
    __pyx_v_ins_pos = values[2];
    __pyx_v_ins_seq = values[3];
    __pyx_v_out_figure_name = values[4];
    __pyx_v_POLARITY = values[5];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("vapor_simple_ins_Vapor", 1, 6, 6, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1783, __pyx_L3_error)
  __pyx_L3_error:;
  __Pyx_AddTraceback("vapor_vali.Simple_function.vapor_simple_ins_Vapor", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_10vapor_vali_15Simple_function_214vapor_simple_ins_Vapor(__pyx_self, __pyx_v_bam_in, __pyx_v_ref, __pyx_v_ins_pos, __pyx_v_ins_seq, __pyx_v_out_figure_name, __pyx_v_POLARITY);

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10vapor_vali_15Simple_function_214vapor_simple_ins_Vapor(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_bam_in, PyObject *__pyx_v_ref, PyObject *__pyx_v_ins_pos, PyObject *__pyx_v_ins_seq, PyObject *__pyx_v_out_figure_name, PyObject *__pyx_v_POLARITY) {
  PyObject *__pyx_v_ins_seq_2 = NULL;
  PyObject *__pyx_v_flank_length = NULL;
  PyObject *__pyx_v_vapor_score_list = NULL;
  PyObject *__pyx_v_best_read_rec = NULL;
  PyObject *__pyx_v_all_reads = NULL;
  PyObject *__pyx_v_ref_seq = NULL;
  PyObject *__pyx_v_window_size = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_window_size_qc = NULL;
  PyObject *__pyx_v_alt_seq = NULL;
  PyObject *__pyx_v_x = NULL;
  PyObject *__pyx_v_vapor_single_read_score = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  PyObject *__pyx_t_6 = NULL;
  PyObject *__pyx_t_7 = NULL;
  Py_ssize_t __pyx_t_8;
  PyObject *(*__pyx_t_9)(PyObject *);
  int __pyx_t_10;
  PyObject *(*__pyx_t_11)(PyObject *);
  double __pyx_t_12;
  Py_ssize_t __pyx_t_13;
  double __pyx_t_14;
  int __pyx_t_15;
  __Pyx_RefNannySetupContext("vapor_simple_ins_Vapor", 0);

  /* "vapor_vali/Simple_function.pyx":1787
 *     #eg of bam_in='/nfs/turbo/remillsscr/scratch2_trans/datasets/1000genomes/vol1/ftp/data_collections/hgsv_sv_discovery/PacBio/alignment/HG00512.XXX.bam'
 *     #eg of ref='/scratch/remills_flux/xuefzhao/reference/GRCh38.1KGP/GRCh38_full_analysis_set_plus_decoy_hla.fa'
 *     if POLARITY=='+':             # <<<<<<<<<<<<<<
 *         ins_seq_2=ins_seq
 *     elif POLARITY=='-':
 */
  __pyx_t_1 = (__Pyx_PyString_Equals(__pyx_v_POLARITY, __pyx_kp_s__2, Py_EQ)); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(0, 1787, __pyx_L1_error)
  if (__pyx_t_1) {

    /* "vapor_vali/Simple_function.pyx":1788
 *     #eg of ref='/scratch/remills_flux/xuefzhao/reference/GRCh38.1KGP/GRCh38_full_analysis_set_plus_decoy_hla.fa'
 *     if POLARITY=='+':
 *         ins_seq_2=ins_seq             # <<<<<<<<<<<<<<
 *     elif POLARITY=='-':
 *         ins_seq_2=reverse(complementary(ins_seq))
 */
    __Pyx_INCREF(__pyx_v_ins_seq);
    __pyx_v_ins_seq_2 = __pyx_v_ins_seq;

    /* "vapor_vali/Simple_function.pyx":1787
 *     #eg of bam_in='/nfs/turbo/remillsscr/scratch2_trans/datasets/1000genomes/vol1/ftp/data_collections/hgsv_sv_discovery/PacBio/alignment/HG00512.XXX.bam'
 *     #eg of ref='/scratch/remills_flux/xuefzhao/reference/GRCh38.1KGP/GRCh38_full_analysis_set_plus_decoy_hla.fa'
 *     if POLARITY=='+':             # <<<<<<<<<<<<<<
 *         ins_seq_2=ins_seq
 *     elif POLARITY=='-':
 */
    goto __pyx_L3;
  }

  /* "vapor_vali/Simple_function.pyx":1789
 *     if POLARITY=='+':
 *         ins_seq_2=ins_seq
 *     elif POLARITY=='-':             # <<<<<<<<<<<<<<
 *         ins_seq_2=reverse(complementary(ins_seq))
 *     flank_length=default_flank_length if len(ins_seq)>default_flank_length else len(ins_seq)
 */
  __pyx_t_1 = (__Pyx_PyString_Equals(__pyx_v_POLARITY, __pyx_kp_s_, Py_EQ)); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(0, 1789, __pyx_L1_error)
  if (__pyx_t_1) {

    /* "vapor_vali/Simple_function.pyx":1790
 *         ins_seq_2=ins_seq
 *     elif POLARITY=='-':
 *         ins_seq_2=reverse(complementary(ins_seq))             # <<<<<<<<<<<<<<
 *     flank_length=default_flank_length if len(ins_seq)>default_flank_length else len(ins_seq)
 *     vapor_score_list=[]
 */
    __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_reverse); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1790, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_5 = __Pyx_GetModuleGlobalName(__pyx_n_s_complementary); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1790, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __pyx_t_6 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_5))) {
      __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_5);
      if (likely(__pyx_t_6)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
        __Pyx_INCREF(__pyx_t_6);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_5, function);
      }
    }
    if (!__pyx_t_6) {
      __pyx_t_4 = __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_v_ins_seq); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1790, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
    } else {
      __pyx_t_7 = PyTuple_New(1+1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1790, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_7);
      __Pyx_GIVEREF(__pyx_t_6); PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_6); __pyx_t_6 = NULL;
      __Pyx_INCREF(__pyx_v_ins_seq);
      __Pyx_GIVEREF(__pyx_v_ins_seq);
      PyTuple_SET_ITEM(__pyx_t_7, 0+1, __pyx_v_ins_seq);
      __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_7, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1790, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
    }
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_3))) {
      __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_3);
      if (likely(__pyx_t_5)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
        __Pyx_INCREF(__pyx_t_5);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_3, function);
      }
    }
    if (!__pyx_t_5) {
      __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_4); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1790, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      __Pyx_GOTREF(__pyx_t_2);
    } else {
      __pyx_t_7 = PyTuple_New(1+1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1790, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_7);
      __Pyx_GIVEREF(__pyx_t_5); PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_5); __pyx_t_5 = NULL;
      __Pyx_GIVEREF(__pyx_t_4);
      PyTuple_SET_ITEM(__pyx_t_7, 0+1, __pyx_t_4);
      __pyx_t_4 = 0;
      __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_7, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1790, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
    }
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_v_ins_seq_2 = __pyx_t_2;
    __pyx_t_2 = 0;

    /* "vapor_vali/Simple_function.pyx":1789
 *     if POLARITY=='+':
 *         ins_seq_2=ins_seq
 *     elif POLARITY=='-':             # <<<<<<<<<<<<<<
 *         ins_seq_2=reverse(complementary(ins_seq))
 *     flank_length=default_flank_length if len(ins_seq)>default_flank_length else len(ins_seq)
 */
  }
  __pyx_L3:;

  /* "vapor_vali/Simple_function.pyx":1791
 *     elif POLARITY=='-':
 *         ins_seq_2=reverse(complementary(ins_seq))
 *     flank_length=default_flank_length if len(ins_seq)>default_flank_length else len(ins_seq)             # <<<<<<<<<<<<<<
 *     vapor_score_list=[]
 *     best_read_rec=''
 */
  __pyx_t_8 = PyObject_Length(__pyx_v_ins_seq); if (unlikely(__pyx_t_8 == -1)) __PYX_ERR(0, 1791, __pyx_L1_error)
  __pyx_t_3 = PyInt_FromSsize_t(__pyx_t_8); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1791, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_7 = __Pyx_GetModuleGlobalName(__pyx_n_s_default_flank_length); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1791, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  __pyx_t_4 = PyObject_RichCompare(__pyx_t_3, __pyx_t_7, Py_GT); __Pyx_XGOTREF(__pyx_t_4); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1791, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_1 = __Pyx_PyObject_IsTrue(__pyx_t_4); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(0, 1791, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  if (__pyx_t_1) {
    __pyx_t_4 = __Pyx_GetModuleGlobalName(__pyx_n_s_default_flank_length); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1791, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_2 = __pyx_t_4;
    __pyx_t_4 = 0;
  } else {
    __pyx_t_8 = PyObject_Length(__pyx_v_ins_seq); if (unlikely(__pyx_t_8 == -1)) __PYX_ERR(0, 1791, __pyx_L1_error)
    __pyx_t_4 = PyInt_FromSsize_t(__pyx_t_8); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1791, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_2 = __pyx_t_4;
    __pyx_t_4 = 0;
  }
  __pyx_v_flank_length = __pyx_t_2;
  __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":1792
 *         ins_seq_2=reverse(complementary(ins_seq))
 *     flank_length=default_flank_length if len(ins_seq)>default_flank_length else len(ins_seq)
 *     vapor_score_list=[]             # <<<<<<<<<<<<<<
 *     best_read_rec=''
 *     all_reads=simple_chop_pacbio_read_simple_short(bam_in,['_'.join(ins_pos.split('_')[:-1]),ins_pos.split('_')[-1]]+[int(ins_pos.split('_')[-1])+len(ins_seq)],flank_length)
 */
  __pyx_t_2 = PyList_New(0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1792, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_v_vapor_score_list = ((PyObject*)__pyx_t_2);
  __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":1793
 *     flank_length=default_flank_length if len(ins_seq)>default_flank_length else len(ins_seq)
 *     vapor_score_list=[]
 *     best_read_rec=''             # <<<<<<<<<<<<<<
 *     all_reads=simple_chop_pacbio_read_simple_short(bam_in,['_'.join(ins_pos.split('_')[:-1]),ins_pos.split('_')[-1]]+[int(ins_pos.split('_')[-1])+len(ins_seq)],flank_length)
 *     if len(all_reads)>0:
 */
  __Pyx_INCREF(__pyx_kp_s__24);
  __pyx_v_best_read_rec = __pyx_kp_s__24;

  /* "vapor_vali/Simple_function.pyx":1794
 *     vapor_score_list=[]
 *     best_read_rec=''
 *     all_reads=simple_chop_pacbio_read_simple_short(bam_in,['_'.join(ins_pos.split('_')[:-1]),ins_pos.split('_')[-1]]+[int(ins_pos.split('_')[-1])+len(ins_seq)],flank_length)             # <<<<<<<<<<<<<<
 *     if len(all_reads)>0:
 *         ref_seq=ref_seq_readin(ref,['_'.join(ins_pos.split('_')[:-1]),ins_pos.split('_')[-1]][0],int(ins_pos.split('_')[-1])-flank_length,int(ins_pos.split('_')[-1])+flank_length+len(ins_seq),reverse_flag='FALSE')
 */
  __pyx_t_4 = __Pyx_GetModuleGlobalName(__pyx_n_s_simple_chop_pacbio_read_simple_s); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1794, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_ins_pos, __pyx_n_s_split); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1794, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_7, __pyx_tuple__139, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1794, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_7 = __Pyx_PyObject_GetSlice(__pyx_t_3, 0, -1L, NULL, NULL, &__pyx_slice__140, 0, 1, 1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1794, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = __Pyx_PyString_Join(__pyx_n_s__115, __pyx_t_7); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1794, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_ins_pos, __pyx_n_s_split); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1794, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_7, __pyx_tuple__141, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1794, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_7 = __Pyx_GetItemInt(__pyx_t_5, -1L, long, 1, __Pyx_PyInt_From_long, 0, 1, 1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1794, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = PyList_New(2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1794, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_GIVEREF(__pyx_t_3);
  PyList_SET_ITEM(__pyx_t_5, 0, __pyx_t_3);
  __Pyx_GIVEREF(__pyx_t_7);
  PyList_SET_ITEM(__pyx_t_5, 1, __pyx_t_7);
  __pyx_t_3 = 0;
  __pyx_t_7 = 0;
  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_ins_pos, __pyx_n_s_split); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1794, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_7, __pyx_tuple__142, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1794, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_7 = __Pyx_GetItemInt(__pyx_t_3, -1L, long, 1, __Pyx_PyInt_From_long, 0, 1, 1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1794, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = __Pyx_PyNumber_Int(__pyx_t_7); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1794, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_8 = PyObject_Length(__pyx_v_ins_seq); if (unlikely(__pyx_t_8 == -1)) __PYX_ERR(0, 1794, __pyx_L1_error)
  __pyx_t_7 = PyInt_FromSsize_t(__pyx_t_8); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1794, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  __pyx_t_6 = PyNumber_Add(__pyx_t_3, __pyx_t_7); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1794, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_7 = PyList_New(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1794, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  __Pyx_GIVEREF(__pyx_t_6);
  PyList_SET_ITEM(__pyx_t_7, 0, __pyx_t_6);
  __pyx_t_6 = 0;
  __pyx_t_6 = PyNumber_Add(__pyx_t_5, __pyx_t_7); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1794, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_7 = NULL;
  __pyx_t_8 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_4))) {
    __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_4);
    if (likely(__pyx_t_7)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
      __Pyx_INCREF(__pyx_t_7);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_4, function);
      __pyx_t_8 = 1;
    }
  }
  __pyx_t_5 = PyTuple_New(3+__pyx_t_8); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1794, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  if (__pyx_t_7) {
    __Pyx_GIVEREF(__pyx_t_7); PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_7); __pyx_t_7 = NULL;
  }
  __Pyx_INCREF(__pyx_v_bam_in);
  __Pyx_GIVEREF(__pyx_v_bam_in);
  PyTuple_SET_ITEM(__pyx_t_5, 0+__pyx_t_8, __pyx_v_bam_in);
  __Pyx_GIVEREF(__pyx_t_6);
  PyTuple_SET_ITEM(__pyx_t_5, 1+__pyx_t_8, __pyx_t_6);
  __Pyx_INCREF(__pyx_v_flank_length);
  __Pyx_GIVEREF(__pyx_v_flank_length);
  PyTuple_SET_ITEM(__pyx_t_5, 2+__pyx_t_8, __pyx_v_flank_length);
  __pyx_t_6 = 0;
  __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_5, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1794, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_all_reads = __pyx_t_2;
  __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":1795
 *     best_read_rec=''
 *     all_reads=simple_chop_pacbio_read_simple_short(bam_in,['_'.join(ins_pos.split('_')[:-1]),ins_pos.split('_')[-1]]+[int(ins_pos.split('_')[-1])+len(ins_seq)],flank_length)
 *     if len(all_reads)>0:             # <<<<<<<<<<<<<<
 *         ref_seq=ref_seq_readin(ref,['_'.join(ins_pos.split('_')[:-1]),ins_pos.split('_')[-1]][0],int(ins_pos.split('_')[-1])-flank_length,int(ins_pos.split('_')[-1])+flank_length+len(ins_seq),reverse_flag='FALSE')
 *         [window_size,window_size_qc]=window_size_refine(ref_seq)
 */
  __pyx_t_8 = PyObject_Length(__pyx_v_all_reads); if (unlikely(__pyx_t_8 == -1)) __PYX_ERR(0, 1795, __pyx_L1_error)
  __pyx_t_1 = ((__pyx_t_8 > 0) != 0);
  if (__pyx_t_1) {

    /* "vapor_vali/Simple_function.pyx":1796
 *     all_reads=simple_chop_pacbio_read_simple_short(bam_in,['_'.join(ins_pos.split('_')[:-1]),ins_pos.split('_')[-1]]+[int(ins_pos.split('_')[-1])+len(ins_seq)],flank_length)
 *     if len(all_reads)>0:
 *         ref_seq=ref_seq_readin(ref,['_'.join(ins_pos.split('_')[:-1]),ins_pos.split('_')[-1]][0],int(ins_pos.split('_')[-1])-flank_length,int(ins_pos.split('_')[-1])+flank_length+len(ins_seq),reverse_flag='FALSE')             # <<<<<<<<<<<<<<
 *         [window_size,window_size_qc]=window_size_refine(ref_seq)
 *         if not window_size=='Error':
 */
    __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_ref_seq_readin); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1796, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_ins_pos, __pyx_n_s_split); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1796, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_tuple__143, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1796, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = __Pyx_PyObject_GetSlice(__pyx_t_5, 0, -1L, NULL, NULL, &__pyx_slice__144, 0, 1, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1796, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = __Pyx_PyString_Join(__pyx_n_s__115, __pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1796, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_ins_pos, __pyx_n_s_split); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1796, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_tuple__145, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1796, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = __Pyx_GetItemInt(__pyx_t_6, -1L, long, 1, __Pyx_PyInt_From_long, 0, 1, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1796, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = PyList_New(2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1796, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __Pyx_GIVEREF(__pyx_t_5);
    PyList_SET_ITEM(__pyx_t_6, 0, __pyx_t_5);
    __Pyx_GIVEREF(__pyx_t_4);
    PyList_SET_ITEM(__pyx_t_6, 1, __pyx_t_4);
    __pyx_t_5 = 0;
    __pyx_t_4 = 0;
    __pyx_t_4 = __Pyx_GetItemInt_List(__pyx_t_6, 0, long, 1, __Pyx_PyInt_From_long, 1, 0, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1796, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_ins_pos, __pyx_n_s_split); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1796, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_tuple__146, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1796, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = __Pyx_GetItemInt(__pyx_t_5, -1L, long, 1, __Pyx_PyInt_From_long, 0, 1, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1796, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = __Pyx_PyNumber_Int(__pyx_t_6); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1796, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = PyNumber_Subtract(__pyx_t_5, __pyx_v_flank_length); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1796, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_ins_pos, __pyx_n_s_split); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1796, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_tuple__147, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1796, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = __Pyx_GetItemInt(__pyx_t_7, -1L, long, 1, __Pyx_PyInt_From_long, 0, 1, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1796, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_t_7 = __Pyx_PyNumber_Int(__pyx_t_5); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1796, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = PyNumber_Add(__pyx_t_7, __pyx_v_flank_length); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1796, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_t_8 = PyObject_Length(__pyx_v_ins_seq); if (unlikely(__pyx_t_8 == -1)) __PYX_ERR(0, 1796, __pyx_L1_error)
    __pyx_t_7 = PyInt_FromSsize_t(__pyx_t_8); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1796, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    __pyx_t_3 = PyNumber_Add(__pyx_t_5, __pyx_t_7); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1796, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_t_7 = PyTuple_New(4); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1796, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    __Pyx_INCREF(__pyx_v_ref);
    __Pyx_GIVEREF(__pyx_v_ref);
    PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_v_ref);
    __Pyx_GIVEREF(__pyx_t_4);
    PyTuple_SET_ITEM(__pyx_t_7, 1, __pyx_t_4);
    __Pyx_GIVEREF(__pyx_t_6);
    PyTuple_SET_ITEM(__pyx_t_7, 2, __pyx_t_6);
    __Pyx_GIVEREF(__pyx_t_3);
    PyTuple_SET_ITEM(__pyx_t_7, 3, __pyx_t_3);
    __pyx_t_4 = 0;
    __pyx_t_6 = 0;
    __pyx_t_3 = 0;
    __pyx_t_3 = PyDict_New(); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1796, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_reverse_flag, __pyx_n_s_FALSE) < 0) __PYX_ERR(0, 1796, __pyx_L1_error)
    __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_7, __pyx_t_3); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1796, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_v_ref_seq = __pyx_t_6;
    __pyx_t_6 = 0;

    /* "vapor_vali/Simple_function.pyx":1797
 *     if len(all_reads)>0:
 *         ref_seq=ref_seq_readin(ref,['_'.join(ins_pos.split('_')[:-1]),ins_pos.split('_')[-1]][0],int(ins_pos.split('_')[-1])-flank_length,int(ins_pos.split('_')[-1])+flank_length+len(ins_seq),reverse_flag='FALSE')
 *         [window_size,window_size_qc]=window_size_refine(ref_seq)             # <<<<<<<<<<<<<<
 *         if not window_size=='Error':
 *             alt_seq=ref_seq[:flank_length]+ins_seq_2+ref_seq[flank_length:(2*flank_length)]
 */
    __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_window_size_refine); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1797, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_7 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_3))) {
      __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_3);
      if (likely(__pyx_t_7)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
        __Pyx_INCREF(__pyx_t_7);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_3, function);
      }
    }
    if (!__pyx_t_7) {
      __pyx_t_6 = __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_v_ref_seq); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1797, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_6);
    } else {
      __pyx_t_2 = PyTuple_New(1+1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1797, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __Pyx_GIVEREF(__pyx_t_7); PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_7); __pyx_t_7 = NULL;
      __Pyx_INCREF(__pyx_v_ref_seq);
      __Pyx_GIVEREF(__pyx_v_ref_seq);
      PyTuple_SET_ITEM(__pyx_t_2, 0+1, __pyx_v_ref_seq);
      __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_2, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1797, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_6);
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    }
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    if ((likely(PyTuple_CheckExact(__pyx_t_6))) || (PyList_CheckExact(__pyx_t_6))) {
      PyObject* sequence = __pyx_t_6;
      #if CYTHON_COMPILING_IN_CPYTHON
      Py_ssize_t size = Py_SIZE(sequence);
      #else
      Py_ssize_t size = PySequence_Size(sequence);
      #endif
      if (unlikely(size != 2)) {
        if (size > 2) __Pyx_RaiseTooManyValuesError(2);
        else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
        __PYX_ERR(0, 1797, __pyx_L1_error)
      }
      #if CYTHON_COMPILING_IN_CPYTHON
      if (likely(PyTuple_CheckExact(sequence))) {
        __pyx_t_3 = PyTuple_GET_ITEM(sequence, 0); 
        __pyx_t_2 = PyTuple_GET_ITEM(sequence, 1); 
      } else {
        __pyx_t_3 = PyList_GET_ITEM(sequence, 0); 
        __pyx_t_2 = PyList_GET_ITEM(sequence, 1); 
      }
      __Pyx_INCREF(__pyx_t_3);
      __Pyx_INCREF(__pyx_t_2);
      #else
      __pyx_t_3 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1797, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __pyx_t_2 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1797, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      #endif
      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    } else {
      Py_ssize_t index = -1;
      __pyx_t_7 = PyObject_GetIter(__pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1797, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_7);
      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
      __pyx_t_9 = Py_TYPE(__pyx_t_7)->tp_iternext;
      index = 0; __pyx_t_3 = __pyx_t_9(__pyx_t_7); if (unlikely(!__pyx_t_3)) goto __pyx_L5_unpacking_failed;
      __Pyx_GOTREF(__pyx_t_3);
      index = 1; __pyx_t_2 = __pyx_t_9(__pyx_t_7); if (unlikely(!__pyx_t_2)) goto __pyx_L5_unpacking_failed;
      __Pyx_GOTREF(__pyx_t_2);
      if (__Pyx_IternextUnpackEndCheck(__pyx_t_9(__pyx_t_7), 2) < 0) __PYX_ERR(0, 1797, __pyx_L1_error)
      __pyx_t_9 = NULL;
      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
      goto __pyx_L6_unpacking_done;
      __pyx_L5_unpacking_failed:;
      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
      __pyx_t_9 = NULL;
      if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
      __PYX_ERR(0, 1797, __pyx_L1_error)
      __pyx_L6_unpacking_done:;
    }
    __pyx_v_window_size = __pyx_t_3;
    __pyx_t_3 = 0;
    __pyx_v_window_size_qc = __pyx_t_2;
    __pyx_t_2 = 0;

    /* "vapor_vali/Simple_function.pyx":1798
 *         ref_seq=ref_seq_readin(ref,['_'.join(ins_pos.split('_')[:-1]),ins_pos.split('_')[-1]][0],int(ins_pos.split('_')[-1])-flank_length,int(ins_pos.split('_')[-1])+flank_length+len(ins_seq),reverse_flag='FALSE')
 *         [window_size,window_size_qc]=window_size_refine(ref_seq)
 *         if not window_size=='Error':             # <<<<<<<<<<<<<<
 *             alt_seq=ref_seq[:flank_length]+ins_seq_2+ref_seq[flank_length:(2*flank_length)]
 *             if not window_size=='Error':
 */
    __pyx_t_1 = (__Pyx_PyString_Equals(__pyx_v_window_size, __pyx_n_s_Error, Py_EQ)); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(0, 1798, __pyx_L1_error)
    __pyx_t_10 = ((!__pyx_t_1) != 0);
    if (__pyx_t_10) {

      /* "vapor_vali/Simple_function.pyx":1799
 *         [window_size,window_size_qc]=window_size_refine(ref_seq)
 *         if not window_size=='Error':
 *             alt_seq=ref_seq[:flank_length]+ins_seq_2+ref_seq[flank_length:(2*flank_length)]             # <<<<<<<<<<<<<<
 *             if not window_size=='Error':
 *                 best_read_rec=''
 */
      __pyx_t_6 = __Pyx_PyObject_GetSlice(__pyx_v_ref_seq, 0, 0, NULL, &__pyx_v_flank_length, NULL, 0, 0, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1799, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_6);
      if (unlikely(!__pyx_v_ins_seq_2)) { __Pyx_RaiseUnboundLocalError("ins_seq_2"); __PYX_ERR(0, 1799, __pyx_L1_error) }
      __pyx_t_2 = PyNumber_Add(__pyx_t_6, __pyx_v_ins_seq_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1799, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
      __pyx_t_6 = PyNumber_Multiply(__pyx_int_2, __pyx_v_flank_length); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1799, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_6);
      __pyx_t_3 = __Pyx_PyObject_GetSlice(__pyx_v_ref_seq, 0, 0, &__pyx_v_flank_length, &__pyx_t_6, NULL, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1799, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
      __pyx_t_6 = PyNumber_Add(__pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1799, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_6);
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_v_alt_seq = __pyx_t_6;
      __pyx_t_6 = 0;

      /* "vapor_vali/Simple_function.pyx":1800
 *         if not window_size=='Error':
 *             alt_seq=ref_seq[:flank_length]+ins_seq_2+ref_seq[flank_length:(2*flank_length)]
 *             if not window_size=='Error':             # <<<<<<<<<<<<<<
 *                 best_read_rec=''
 *                 if len(all_reads)>10:
 */
      __pyx_t_10 = (__Pyx_PyString_Equals(__pyx_v_window_size, __pyx_n_s_Error, Py_EQ)); if (unlikely(__pyx_t_10 < 0)) __PYX_ERR(0, 1800, __pyx_L1_error)
      __pyx_t_1 = ((!__pyx_t_10) != 0);
      if (__pyx_t_1) {

        /* "vapor_vali/Simple_function.pyx":1801
 *             alt_seq=ref_seq[:flank_length]+ins_seq_2+ref_seq[flank_length:(2*flank_length)]
 *             if not window_size=='Error':
 *                 best_read_rec=''             # <<<<<<<<<<<<<<
 *                 if len(all_reads)>10:
 *                     for x in all_reads:
 */
        __Pyx_INCREF(__pyx_kp_s__24);
        __Pyx_DECREF_SET(__pyx_v_best_read_rec, __pyx_kp_s__24);

        /* "vapor_vali/Simple_function.pyx":1802
 *             if not window_size=='Error':
 *                 best_read_rec=''
 *                 if len(all_reads)>10:             # <<<<<<<<<<<<<<
 *                     for x in all_reads:
 *                         if float(x[0].count('N')+x[0].count('n'))/float(len(x[0]))<0.1:
 */
        __pyx_t_8 = PyObject_Length(__pyx_v_all_reads); if (unlikely(__pyx_t_8 == -1)) __PYX_ERR(0, 1802, __pyx_L1_error)
        __pyx_t_1 = ((__pyx_t_8 > 10) != 0);
        if (__pyx_t_1) {

          /* "vapor_vali/Simple_function.pyx":1803
 *                 best_read_rec=''
 *                 if len(all_reads)>10:
 *                     for x in all_reads:             # <<<<<<<<<<<<<<
 *                         if float(x[0].count('N')+x[0].count('n'))/float(len(x[0]))<0.1:
 *                             vapor_single_read_score=calcu_vapor_single_read_score_abs_dis_m1b(ref_seq,alt_seq,x,window_size)
 */
          if (likely(PyList_CheckExact(__pyx_v_all_reads)) || PyTuple_CheckExact(__pyx_v_all_reads)) {
            __pyx_t_6 = __pyx_v_all_reads; __Pyx_INCREF(__pyx_t_6); __pyx_t_8 = 0;
            __pyx_t_11 = NULL;
          } else {
            __pyx_t_8 = -1; __pyx_t_6 = PyObject_GetIter(__pyx_v_all_reads); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1803, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_6);
            __pyx_t_11 = Py_TYPE(__pyx_t_6)->tp_iternext; if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1803, __pyx_L1_error)
          }
          for (;;) {
            if (likely(!__pyx_t_11)) {
              if (likely(PyList_CheckExact(__pyx_t_6))) {
                if (__pyx_t_8 >= PyList_GET_SIZE(__pyx_t_6)) break;
                #if CYTHON_COMPILING_IN_CPYTHON
                __pyx_t_3 = PyList_GET_ITEM(__pyx_t_6, __pyx_t_8); __Pyx_INCREF(__pyx_t_3); __pyx_t_8++; if (unlikely(0 < 0)) __PYX_ERR(0, 1803, __pyx_L1_error)
                #else
                __pyx_t_3 = PySequence_ITEM(__pyx_t_6, __pyx_t_8); __pyx_t_8++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1803, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_3);
                #endif
              } else {
                if (__pyx_t_8 >= PyTuple_GET_SIZE(__pyx_t_6)) break;
                #if CYTHON_COMPILING_IN_CPYTHON
                __pyx_t_3 = PyTuple_GET_ITEM(__pyx_t_6, __pyx_t_8); __Pyx_INCREF(__pyx_t_3); __pyx_t_8++; if (unlikely(0 < 0)) __PYX_ERR(0, 1803, __pyx_L1_error)
                #else
                __pyx_t_3 = PySequence_ITEM(__pyx_t_6, __pyx_t_8); __pyx_t_8++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1803, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_3);
                #endif
              }
            } else {
              __pyx_t_3 = __pyx_t_11(__pyx_t_6);
              if (unlikely(!__pyx_t_3)) {
                PyObject* exc_type = PyErr_Occurred();
                if (exc_type) {
                  if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
                  else __PYX_ERR(0, 1803, __pyx_L1_error)
                }
                break;
              }
              __Pyx_GOTREF(__pyx_t_3);
            }
            __Pyx_XDECREF_SET(__pyx_v_x, __pyx_t_3);
            __pyx_t_3 = 0;

            /* "vapor_vali/Simple_function.pyx":1804
 *                 if len(all_reads)>10:
 *                     for x in all_reads:
 *                         if float(x[0].count('N')+x[0].count('n'))/float(len(x[0]))<0.1:             # <<<<<<<<<<<<<<
 *                             vapor_single_read_score=calcu_vapor_single_read_score_abs_dis_m1b(ref_seq,alt_seq,x,window_size)
 *                             if not 0 in vapor_single_read_score:
 */
            __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_x, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1804, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_3);
            __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_count); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1804, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_2);
            __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
            __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_tuple__148, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1804, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_3);
            __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
            __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_x, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1804, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_2);
            __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_count); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1804, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_7);
            __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
            __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_7, __pyx_tuple__149, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1804, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_2);
            __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
            __pyx_t_7 = PyNumber_Add(__pyx_t_3, __pyx_t_2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1804, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_7);
            __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
            __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
            __pyx_t_12 = __Pyx_PyObject_AsDouble(__pyx_t_7); if (unlikely(__pyx_t_12 == ((double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1804, __pyx_L1_error)
            __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
            __pyx_t_7 = __Pyx_GetItemInt(__pyx_v_x, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1804, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_7);
            __pyx_t_13 = PyObject_Length(__pyx_t_7); if (unlikely(__pyx_t_13 == -1)) __PYX_ERR(0, 1804, __pyx_L1_error)
            __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
            if (unlikely(((double)__pyx_t_13) == 0)) {
              PyErr_SetString(PyExc_ZeroDivisionError, "float division");
              __PYX_ERR(0, 1804, __pyx_L1_error)
            }
            __pyx_t_1 = (((__pyx_t_12 / ((double)__pyx_t_13)) < 0.1) != 0);
            if (__pyx_t_1) {

              /* "vapor_vali/Simple_function.pyx":1805
 *                     for x in all_reads:
 *                         if float(x[0].count('N')+x[0].count('n'))/float(len(x[0]))<0.1:
 *                             vapor_single_read_score=calcu_vapor_single_read_score_abs_dis_m1b(ref_seq,alt_seq,x,window_size)             # <<<<<<<<<<<<<<
 *                             if not 0 in vapor_single_read_score:
 *                                 vapor_score_list.append(1-float(vapor_single_read_score[1])/float(vapor_single_read_score[0]))
 */
              __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_calcu_vapor_single_read_score_ab); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1805, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_2);
              __pyx_t_3 = NULL;
              __pyx_t_13 = 0;
              if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_2))) {
                __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
                if (likely(__pyx_t_3)) {
                  PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
                  __Pyx_INCREF(__pyx_t_3);
                  __Pyx_INCREF(function);
                  __Pyx_DECREF_SET(__pyx_t_2, function);
                  __pyx_t_13 = 1;
                }
              }
              __pyx_t_4 = PyTuple_New(4+__pyx_t_13); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1805, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_4);
              if (__pyx_t_3) {
                __Pyx_GIVEREF(__pyx_t_3); PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3); __pyx_t_3 = NULL;
              }
              __Pyx_INCREF(__pyx_v_ref_seq);
              __Pyx_GIVEREF(__pyx_v_ref_seq);
              PyTuple_SET_ITEM(__pyx_t_4, 0+__pyx_t_13, __pyx_v_ref_seq);
              __Pyx_INCREF(__pyx_v_alt_seq);
              __Pyx_GIVEREF(__pyx_v_alt_seq);
              PyTuple_SET_ITEM(__pyx_t_4, 1+__pyx_t_13, __pyx_v_alt_seq);
              __Pyx_INCREF(__pyx_v_x);
              __Pyx_GIVEREF(__pyx_v_x);
              PyTuple_SET_ITEM(__pyx_t_4, 2+__pyx_t_13, __pyx_v_x);
              __Pyx_INCREF(__pyx_v_window_size);
              __Pyx_GIVEREF(__pyx_v_window_size);
              PyTuple_SET_ITEM(__pyx_t_4, 3+__pyx_t_13, __pyx_v_window_size);
              __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_4, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1805, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_7);
              __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
              __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
              __Pyx_XDECREF_SET(__pyx_v_vapor_single_read_score, __pyx_t_7);
              __pyx_t_7 = 0;

              /* "vapor_vali/Simple_function.pyx":1806
 *                         if float(x[0].count('N')+x[0].count('n'))/float(len(x[0]))<0.1:
 *                             vapor_single_read_score=calcu_vapor_single_read_score_abs_dis_m1b(ref_seq,alt_seq,x,window_size)
 *                             if not 0 in vapor_single_read_score:             # <<<<<<<<<<<<<<
 *                                 vapor_score_list.append(1-float(vapor_single_read_score[1])/float(vapor_single_read_score[0]))
 *                                 if vapor_score_list[-1]==max(vapor_score_list):best_read_rec=x
 */
              __pyx_t_1 = (__Pyx_PySequence_ContainsTF(__pyx_int_0, __pyx_v_vapor_single_read_score, Py_NE)); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(0, 1806, __pyx_L1_error)
              __pyx_t_10 = (__pyx_t_1 != 0);
              if (__pyx_t_10) {

                /* "vapor_vali/Simple_function.pyx":1807
 *                             vapor_single_read_score=calcu_vapor_single_read_score_abs_dis_m1b(ref_seq,alt_seq,x,window_size)
 *                             if not 0 in vapor_single_read_score:
 *                                 vapor_score_list.append(1-float(vapor_single_read_score[1])/float(vapor_single_read_score[0]))             # <<<<<<<<<<<<<<
 *                                 if vapor_score_list[-1]==max(vapor_score_list):best_read_rec=x
 *                 else:
 */
                __pyx_t_7 = __Pyx_GetItemInt(__pyx_v_vapor_single_read_score, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1807, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_7);
                __pyx_t_12 = __Pyx_PyObject_AsDouble(__pyx_t_7); if (unlikely(__pyx_t_12 == ((double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1807, __pyx_L1_error)
                __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
                __pyx_t_7 = __Pyx_GetItemInt(__pyx_v_vapor_single_read_score, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1807, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_7);
                __pyx_t_14 = __Pyx_PyObject_AsDouble(__pyx_t_7); if (unlikely(__pyx_t_14 == ((double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1807, __pyx_L1_error)
                __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
                if (unlikely(__pyx_t_14 == 0)) {
                  PyErr_SetString(PyExc_ZeroDivisionError, "float division");
                  __PYX_ERR(0, 1807, __pyx_L1_error)
                }
                __pyx_t_7 = PyFloat_FromDouble((1.0 - (__pyx_t_12 / __pyx_t_14))); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1807, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_7);
                __pyx_t_15 = __Pyx_PyList_Append(__pyx_v_vapor_score_list, __pyx_t_7); if (unlikely(__pyx_t_15 == -1)) __PYX_ERR(0, 1807, __pyx_L1_error)
                __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;

                /* "vapor_vali/Simple_function.pyx":1808
 *                             if not 0 in vapor_single_read_score:
 *                                 vapor_score_list.append(1-float(vapor_single_read_score[1])/float(vapor_single_read_score[0]))
 *                                 if vapor_score_list[-1]==max(vapor_score_list):best_read_rec=x             # <<<<<<<<<<<<<<
 *                 else:
 *                     all_reads=simple_chop_pacbio_read_simple_short(bam_in,['_'.join(ins_pos.split('_')[:-1]),ins_pos.split('_')[-1]]+[int(ins_pos.split('_')[-1])],flank_length)
 */
                __pyx_t_7 = __Pyx_GetItemInt_List(__pyx_v_vapor_score_list, -1L, long, 1, __Pyx_PyInt_From_long, 1, 1, 1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1808, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_7);
                __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1808, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_2);
                __Pyx_INCREF(__pyx_v_vapor_score_list);
                __Pyx_GIVEREF(__pyx_v_vapor_score_list);
                PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_v_vapor_score_list);
                __pyx_t_4 = __Pyx_PyObject_Call(__pyx_builtin_max, __pyx_t_2, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1808, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_4);
                __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
                __pyx_t_2 = PyObject_RichCompare(__pyx_t_7, __pyx_t_4, Py_EQ); __Pyx_XGOTREF(__pyx_t_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1808, __pyx_L1_error)
                __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
                __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
                __pyx_t_10 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_10 < 0)) __PYX_ERR(0, 1808, __pyx_L1_error)
                __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
                if (__pyx_t_10) {
                  __Pyx_INCREF(__pyx_v_x);
                  __Pyx_DECREF_SET(__pyx_v_best_read_rec, __pyx_v_x);
                }

                /* "vapor_vali/Simple_function.pyx":1806
 *                         if float(x[0].count('N')+x[0].count('n'))/float(len(x[0]))<0.1:
 *                             vapor_single_read_score=calcu_vapor_single_read_score_abs_dis_m1b(ref_seq,alt_seq,x,window_size)
 *                             if not 0 in vapor_single_read_score:             # <<<<<<<<<<<<<<
 *                                 vapor_score_list.append(1-float(vapor_single_read_score[1])/float(vapor_single_read_score[0]))
 *                                 if vapor_score_list[-1]==max(vapor_score_list):best_read_rec=x
 */
              }

              /* "vapor_vali/Simple_function.pyx":1804
 *                 if len(all_reads)>10:
 *                     for x in all_reads:
 *                         if float(x[0].count('N')+x[0].count('n'))/float(len(x[0]))<0.1:             # <<<<<<<<<<<<<<
 *                             vapor_single_read_score=calcu_vapor_single_read_score_abs_dis_m1b(ref_seq,alt_seq,x,window_size)
 *                             if not 0 in vapor_single_read_score:
 */
            }

            /* "vapor_vali/Simple_function.pyx":1803
 *                 best_read_rec=''
 *                 if len(all_reads)>10:
 *                     for x in all_reads:             # <<<<<<<<<<<<<<
 *                         if float(x[0].count('N')+x[0].count('n'))/float(len(x[0]))<0.1:
 *                             vapor_single_read_score=calcu_vapor_single_read_score_abs_dis_m1b(ref_seq,alt_seq,x,window_size)
 */
          }
          __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

          /* "vapor_vali/Simple_function.pyx":1802
 *             if not window_size=='Error':
 *                 best_read_rec=''
 *                 if len(all_reads)>10:             # <<<<<<<<<<<<<<
 *                     for x in all_reads:
 *                         if float(x[0].count('N')+x[0].count('n'))/float(len(x[0]))<0.1:
 */
          goto __pyx_L9;
        }

        /* "vapor_vali/Simple_function.pyx":1810
 *                                 if vapor_score_list[-1]==max(vapor_score_list):best_read_rec=x
 *                 else:
 *                     all_reads=simple_chop_pacbio_read_simple_short(bam_in,['_'.join(ins_pos.split('_')[:-1]),ins_pos.split('_')[-1]]+[int(ins_pos.split('_')[-1])],flank_length)             # <<<<<<<<<<<<<<
 *                     for x in all_reads:
 *                         if float(x[0].count('N')+x[0].count('n'))/float(len(x[0]))<0.1:
 */
        /*else*/ {
          __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_simple_chop_pacbio_read_simple_s); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1810, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_2);
          __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_ins_pos, __pyx_n_s_split); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1810, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_4);
          __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_tuple__150, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1810, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_7);
          __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
          __pyx_t_4 = __Pyx_PyObject_GetSlice(__pyx_t_7, 0, -1L, NULL, NULL, &__pyx_slice__151, 0, 1, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1810, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_4);
          __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
          __pyx_t_7 = __Pyx_PyString_Join(__pyx_n_s__115, __pyx_t_4); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1810, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_7);
          __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
          __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_ins_pos, __pyx_n_s_split); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1810, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_4);
          __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_tuple__152, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1810, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_3);
          __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
          __pyx_t_4 = __Pyx_GetItemInt(__pyx_t_3, -1L, long, 1, __Pyx_PyInt_From_long, 0, 1, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1810, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_4);
          __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
          __pyx_t_3 = PyList_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1810, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_3);
          __Pyx_GIVEREF(__pyx_t_7);
          PyList_SET_ITEM(__pyx_t_3, 0, __pyx_t_7);
          __Pyx_GIVEREF(__pyx_t_4);
          PyList_SET_ITEM(__pyx_t_3, 1, __pyx_t_4);
          __pyx_t_7 = 0;
          __pyx_t_4 = 0;
          __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_ins_pos, __pyx_n_s_split); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1810, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_4);
          __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_tuple__153, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1810, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_7);
          __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
          __pyx_t_4 = __Pyx_GetItemInt(__pyx_t_7, -1L, long, 1, __Pyx_PyInt_From_long, 0, 1, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1810, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_4);
          __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
          __pyx_t_7 = __Pyx_PyNumber_Int(__pyx_t_4); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1810, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_7);
          __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
          __pyx_t_4 = PyList_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1810, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_4);
          __Pyx_GIVEREF(__pyx_t_7);
          PyList_SET_ITEM(__pyx_t_4, 0, __pyx_t_7);
          __pyx_t_7 = 0;
          __pyx_t_7 = PyNumber_Add(__pyx_t_3, __pyx_t_4); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1810, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_7);
          __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
          __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
          __pyx_t_4 = NULL;
          __pyx_t_8 = 0;
          if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_2))) {
            __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_2);
            if (likely(__pyx_t_4)) {
              PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
              __Pyx_INCREF(__pyx_t_4);
              __Pyx_INCREF(function);
              __Pyx_DECREF_SET(__pyx_t_2, function);
              __pyx_t_8 = 1;
            }
          }
          __pyx_t_3 = PyTuple_New(3+__pyx_t_8); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1810, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_3);
          if (__pyx_t_4) {
            __Pyx_GIVEREF(__pyx_t_4); PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_4); __pyx_t_4 = NULL;
          }
          __Pyx_INCREF(__pyx_v_bam_in);
          __Pyx_GIVEREF(__pyx_v_bam_in);
          PyTuple_SET_ITEM(__pyx_t_3, 0+__pyx_t_8, __pyx_v_bam_in);
          __Pyx_GIVEREF(__pyx_t_7);
          PyTuple_SET_ITEM(__pyx_t_3, 1+__pyx_t_8, __pyx_t_7);
          __Pyx_INCREF(__pyx_v_flank_length);
          __Pyx_GIVEREF(__pyx_v_flank_length);
          PyTuple_SET_ITEM(__pyx_t_3, 2+__pyx_t_8, __pyx_v_flank_length);
          __pyx_t_7 = 0;
          __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_3, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1810, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_6);
          __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
          __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
          __Pyx_DECREF_SET(__pyx_v_all_reads, __pyx_t_6);
          __pyx_t_6 = 0;

          /* "vapor_vali/Simple_function.pyx":1811
 *                 else:
 *                     all_reads=simple_chop_pacbio_read_simple_short(bam_in,['_'.join(ins_pos.split('_')[:-1]),ins_pos.split('_')[-1]]+[int(ins_pos.split('_')[-1])],flank_length)
 *                     for x in all_reads:             # <<<<<<<<<<<<<<
 *                         if float(x[0].count('N')+x[0].count('n'))/float(len(x[0]))<0.1:
 *                             vapor_single_read_score=calcu_vapor_single_read_score_within_10Perc_m1b(ref_seq,alt_seq,x,window_size)
 */
          if (likely(PyList_CheckExact(__pyx_v_all_reads)) || PyTuple_CheckExact(__pyx_v_all_reads)) {
            __pyx_t_6 = __pyx_v_all_reads; __Pyx_INCREF(__pyx_t_6); __pyx_t_8 = 0;
            __pyx_t_11 = NULL;
          } else {
            __pyx_t_8 = -1; __pyx_t_6 = PyObject_GetIter(__pyx_v_all_reads); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1811, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_6);
            __pyx_t_11 = Py_TYPE(__pyx_t_6)->tp_iternext; if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1811, __pyx_L1_error)
          }
          for (;;) {
            if (likely(!__pyx_t_11)) {
              if (likely(PyList_CheckExact(__pyx_t_6))) {
                if (__pyx_t_8 >= PyList_GET_SIZE(__pyx_t_6)) break;
                #if CYTHON_COMPILING_IN_CPYTHON
                __pyx_t_2 = PyList_GET_ITEM(__pyx_t_6, __pyx_t_8); __Pyx_INCREF(__pyx_t_2); __pyx_t_8++; if (unlikely(0 < 0)) __PYX_ERR(0, 1811, __pyx_L1_error)
                #else
                __pyx_t_2 = PySequence_ITEM(__pyx_t_6, __pyx_t_8); __pyx_t_8++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1811, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_2);
                #endif
              } else {
                if (__pyx_t_8 >= PyTuple_GET_SIZE(__pyx_t_6)) break;
                #if CYTHON_COMPILING_IN_CPYTHON
                __pyx_t_2 = PyTuple_GET_ITEM(__pyx_t_6, __pyx_t_8); __Pyx_INCREF(__pyx_t_2); __pyx_t_8++; if (unlikely(0 < 0)) __PYX_ERR(0, 1811, __pyx_L1_error)
                #else
                __pyx_t_2 = PySequence_ITEM(__pyx_t_6, __pyx_t_8); __pyx_t_8++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1811, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_2);
                #endif
              }
            } else {
              __pyx_t_2 = __pyx_t_11(__pyx_t_6);
              if (unlikely(!__pyx_t_2)) {
                PyObject* exc_type = PyErr_Occurred();
                if (exc_type) {
                  if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
                  else __PYX_ERR(0, 1811, __pyx_L1_error)
                }
                break;
              }
              __Pyx_GOTREF(__pyx_t_2);
            }
            __Pyx_XDECREF_SET(__pyx_v_x, __pyx_t_2);
            __pyx_t_2 = 0;

            /* "vapor_vali/Simple_function.pyx":1812
 *                     all_reads=simple_chop_pacbio_read_simple_short(bam_in,['_'.join(ins_pos.split('_')[:-1]),ins_pos.split('_')[-1]]+[int(ins_pos.split('_')[-1])],flank_length)
 *                     for x in all_reads:
 *                         if float(x[0].count('N')+x[0].count('n'))/float(len(x[0]))<0.1:             # <<<<<<<<<<<<<<
 *                             vapor_single_read_score=calcu_vapor_single_read_score_within_10Perc_m1b(ref_seq,alt_seq,x,window_size)
 *                             if not 0 in vapor_single_read_score:
 */
            __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_x, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1812, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_2);
            __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_count); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1812, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_3);
            __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
            __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_tuple__154, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1812, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_2);
            __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
            __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_x, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1812, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_3);
            __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_count); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1812, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_7);
            __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
            __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_7, __pyx_tuple__155, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1812, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_3);
            __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
            __pyx_t_7 = PyNumber_Add(__pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1812, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_7);
            __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
            __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
            __pyx_t_14 = __Pyx_PyObject_AsDouble(__pyx_t_7); if (unlikely(__pyx_t_14 == ((double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1812, __pyx_L1_error)
            __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
            __pyx_t_7 = __Pyx_GetItemInt(__pyx_v_x, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1812, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_7);
            __pyx_t_13 = PyObject_Length(__pyx_t_7); if (unlikely(__pyx_t_13 == -1)) __PYX_ERR(0, 1812, __pyx_L1_error)
            __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
            if (unlikely(((double)__pyx_t_13) == 0)) {
              PyErr_SetString(PyExc_ZeroDivisionError, "float division");
              __PYX_ERR(0, 1812, __pyx_L1_error)
            }
            __pyx_t_10 = (((__pyx_t_14 / ((double)__pyx_t_13)) < 0.1) != 0);
            if (__pyx_t_10) {

              /* "vapor_vali/Simple_function.pyx":1813
 *                     for x in all_reads:
 *                         if float(x[0].count('N')+x[0].count('n'))/float(len(x[0]))<0.1:
 *                             vapor_single_read_score=calcu_vapor_single_read_score_within_10Perc_m1b(ref_seq,alt_seq,x,window_size)             # <<<<<<<<<<<<<<
 *                             if not 0 in vapor_single_read_score:
 *                                 vapor_score_list.append(1-float(vapor_single_read_score[1])/float(vapor_single_read_score[0]))
 */
              __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_calcu_vapor_single_read_score_wi); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1813, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_3);
              __pyx_t_2 = NULL;
              __pyx_t_13 = 0;
              if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_3))) {
                __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_3);
                if (likely(__pyx_t_2)) {
                  PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
                  __Pyx_INCREF(__pyx_t_2);
                  __Pyx_INCREF(function);
                  __Pyx_DECREF_SET(__pyx_t_3, function);
                  __pyx_t_13 = 1;
                }
              }
              __pyx_t_4 = PyTuple_New(4+__pyx_t_13); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1813, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_4);
              if (__pyx_t_2) {
                __Pyx_GIVEREF(__pyx_t_2); PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_2); __pyx_t_2 = NULL;
              }
              __Pyx_INCREF(__pyx_v_ref_seq);
              __Pyx_GIVEREF(__pyx_v_ref_seq);
              PyTuple_SET_ITEM(__pyx_t_4, 0+__pyx_t_13, __pyx_v_ref_seq);
              __Pyx_INCREF(__pyx_v_alt_seq);
              __Pyx_GIVEREF(__pyx_v_alt_seq);
              PyTuple_SET_ITEM(__pyx_t_4, 1+__pyx_t_13, __pyx_v_alt_seq);
              __Pyx_INCREF(__pyx_v_x);
              __Pyx_GIVEREF(__pyx_v_x);
              PyTuple_SET_ITEM(__pyx_t_4, 2+__pyx_t_13, __pyx_v_x);
              __Pyx_INCREF(__pyx_v_window_size);
              __Pyx_GIVEREF(__pyx_v_window_size);
              PyTuple_SET_ITEM(__pyx_t_4, 3+__pyx_t_13, __pyx_v_window_size);
              __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_4, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1813, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_7);
              __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
              __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
              __Pyx_XDECREF_SET(__pyx_v_vapor_single_read_score, __pyx_t_7);
              __pyx_t_7 = 0;

              /* "vapor_vali/Simple_function.pyx":1814
 *                         if float(x[0].count('N')+x[0].count('n'))/float(len(x[0]))<0.1:
 *                             vapor_single_read_score=calcu_vapor_single_read_score_within_10Perc_m1b(ref_seq,alt_seq,x,window_size)
 *                             if not 0 in vapor_single_read_score:             # <<<<<<<<<<<<<<
 *                                 vapor_score_list.append(1-float(vapor_single_read_score[1])/float(vapor_single_read_score[0]))
 *                                 if vapor_score_list[-1]==max(vapor_score_list):best_read_rec=x
 */
              __pyx_t_10 = (__Pyx_PySequence_ContainsTF(__pyx_int_0, __pyx_v_vapor_single_read_score, Py_NE)); if (unlikely(__pyx_t_10 < 0)) __PYX_ERR(0, 1814, __pyx_L1_error)
              __pyx_t_1 = (__pyx_t_10 != 0);
              if (__pyx_t_1) {

                /* "vapor_vali/Simple_function.pyx":1815
 *                             vapor_single_read_score=calcu_vapor_single_read_score_within_10Perc_m1b(ref_seq,alt_seq,x,window_size)
 *                             if not 0 in vapor_single_read_score:
 *                                 vapor_score_list.append(1-float(vapor_single_read_score[1])/float(vapor_single_read_score[0]))             # <<<<<<<<<<<<<<
 *                                 if vapor_score_list[-1]==max(vapor_score_list):best_read_rec=x
 *                 if ins_seq_2.count('X')==len(ins_seq_2):        make_event_figure_1(vapor_score_list,best_read_rec,window_size,ref_seq,ref_seq[2:flank_length],out_figure_name)
 */
                __pyx_t_7 = __Pyx_GetItemInt(__pyx_v_vapor_single_read_score, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1815, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_7);
                __pyx_t_14 = __Pyx_PyObject_AsDouble(__pyx_t_7); if (unlikely(__pyx_t_14 == ((double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1815, __pyx_L1_error)
                __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
                __pyx_t_7 = __Pyx_GetItemInt(__pyx_v_vapor_single_read_score, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1815, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_7);
                __pyx_t_12 = __Pyx_PyObject_AsDouble(__pyx_t_7); if (unlikely(__pyx_t_12 == ((double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1815, __pyx_L1_error)
                __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
                if (unlikely(__pyx_t_12 == 0)) {
                  PyErr_SetString(PyExc_ZeroDivisionError, "float division");
                  __PYX_ERR(0, 1815, __pyx_L1_error)
                }
                __pyx_t_7 = PyFloat_FromDouble((1.0 - (__pyx_t_14 / __pyx_t_12))); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1815, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_7);
                __pyx_t_15 = __Pyx_PyList_Append(__pyx_v_vapor_score_list, __pyx_t_7); if (unlikely(__pyx_t_15 == -1)) __PYX_ERR(0, 1815, __pyx_L1_error)
                __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;

                /* "vapor_vali/Simple_function.pyx":1816
 *                             if not 0 in vapor_single_read_score:
 *                                 vapor_score_list.append(1-float(vapor_single_read_score[1])/float(vapor_single_read_score[0]))
 *                                 if vapor_score_list[-1]==max(vapor_score_list):best_read_rec=x             # <<<<<<<<<<<<<<
 *                 if ins_seq_2.count('X')==len(ins_seq_2):        make_event_figure_1(vapor_score_list,best_read_rec,window_size,ref_seq,ref_seq[2:flank_length],out_figure_name)
 *                 else:            make_event_figure_1(vapor_score_list,best_read_rec,window_size,ref_seq,alt_seq,out_figure_name)
 */
                __pyx_t_7 = __Pyx_GetItemInt_List(__pyx_v_vapor_score_list, -1L, long, 1, __Pyx_PyInt_From_long, 1, 1, 1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1816, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_7);
                __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1816, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_3);
                __Pyx_INCREF(__pyx_v_vapor_score_list);
                __Pyx_GIVEREF(__pyx_v_vapor_score_list);
                PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_v_vapor_score_list);
                __pyx_t_4 = __Pyx_PyObject_Call(__pyx_builtin_max, __pyx_t_3, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1816, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_4);
                __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
                __pyx_t_3 = PyObject_RichCompare(__pyx_t_7, __pyx_t_4, Py_EQ); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1816, __pyx_L1_error)
                __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
                __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
                __pyx_t_1 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(0, 1816, __pyx_L1_error)
                __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
                if (__pyx_t_1) {
                  __Pyx_INCREF(__pyx_v_x);
                  __Pyx_DECREF_SET(__pyx_v_best_read_rec, __pyx_v_x);
                }

                /* "vapor_vali/Simple_function.pyx":1814
 *                         if float(x[0].count('N')+x[0].count('n'))/float(len(x[0]))<0.1:
 *                             vapor_single_read_score=calcu_vapor_single_read_score_within_10Perc_m1b(ref_seq,alt_seq,x,window_size)
 *                             if not 0 in vapor_single_read_score:             # <<<<<<<<<<<<<<
 *                                 vapor_score_list.append(1-float(vapor_single_read_score[1])/float(vapor_single_read_score[0]))
 *                                 if vapor_score_list[-1]==max(vapor_score_list):best_read_rec=x
 */
              }

              /* "vapor_vali/Simple_function.pyx":1812
 *                     all_reads=simple_chop_pacbio_read_simple_short(bam_in,['_'.join(ins_pos.split('_')[:-1]),ins_pos.split('_')[-1]]+[int(ins_pos.split('_')[-1])],flank_length)
 *                     for x in all_reads:
 *                         if float(x[0].count('N')+x[0].count('n'))/float(len(x[0]))<0.1:             # <<<<<<<<<<<<<<
 *                             vapor_single_read_score=calcu_vapor_single_read_score_within_10Perc_m1b(ref_seq,alt_seq,x,window_size)
 *                             if not 0 in vapor_single_read_score:
 */
            }

            /* "vapor_vali/Simple_function.pyx":1811
 *                 else:
 *                     all_reads=simple_chop_pacbio_read_simple_short(bam_in,['_'.join(ins_pos.split('_')[:-1]),ins_pos.split('_')[-1]]+[int(ins_pos.split('_')[-1])],flank_length)
 *                     for x in all_reads:             # <<<<<<<<<<<<<<
 *                         if float(x[0].count('N')+x[0].count('n'))/float(len(x[0]))<0.1:
 *                             vapor_single_read_score=calcu_vapor_single_read_score_within_10Perc_m1b(ref_seq,alt_seq,x,window_size)
 */
          }
          __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
        }
        __pyx_L9:;

        /* "vapor_vali/Simple_function.pyx":1817
 *                                 vapor_score_list.append(1-float(vapor_single_read_score[1])/float(vapor_single_read_score[0]))
 *                                 if vapor_score_list[-1]==max(vapor_score_list):best_read_rec=x
 *                 if ins_seq_2.count('X')==len(ins_seq_2):        make_event_figure_1(vapor_score_list,best_read_rec,window_size,ref_seq,ref_seq[2:flank_length],out_figure_name)             # <<<<<<<<<<<<<<
 *                 else:            make_event_figure_1(vapor_score_list,best_read_rec,window_size,ref_seq,alt_seq,out_figure_name)
 *     return vapor_score_list
 */
        if (unlikely(!__pyx_v_ins_seq_2)) { __Pyx_RaiseUnboundLocalError("ins_seq_2"); __PYX_ERR(0, 1817, __pyx_L1_error) }
        __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_ins_seq_2, __pyx_n_s_count); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1817, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_6);
        __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_tuple__156, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1817, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_3);
        __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
        if (unlikely(!__pyx_v_ins_seq_2)) { __Pyx_RaiseUnboundLocalError("ins_seq_2"); __PYX_ERR(0, 1817, __pyx_L1_error) }
        __pyx_t_8 = PyObject_Length(__pyx_v_ins_seq_2); if (unlikely(__pyx_t_8 == -1)) __PYX_ERR(0, 1817, __pyx_L1_error)
        __pyx_t_6 = PyInt_FromSsize_t(__pyx_t_8); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1817, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_6);
        __pyx_t_4 = PyObject_RichCompare(__pyx_t_3, __pyx_t_6, Py_EQ); __Pyx_XGOTREF(__pyx_t_4); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1817, __pyx_L1_error)
        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
        __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
        __pyx_t_1 = __Pyx_PyObject_IsTrue(__pyx_t_4); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(0, 1817, __pyx_L1_error)
        __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
        if (__pyx_t_1) {
          __pyx_t_6 = __Pyx_GetModuleGlobalName(__pyx_n_s_make_event_figure_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1817, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_6);
          __pyx_t_3 = __Pyx_PyObject_GetSlice(__pyx_v_ref_seq, 2, 0, NULL, &__pyx_v_flank_length, NULL, 1, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1817, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_3);
          __pyx_t_7 = NULL;
          __pyx_t_8 = 0;
          if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_6))) {
            __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_6);
            if (likely(__pyx_t_7)) {
              PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
              __Pyx_INCREF(__pyx_t_7);
              __Pyx_INCREF(function);
              __Pyx_DECREF_SET(__pyx_t_6, function);
              __pyx_t_8 = 1;
            }
          }
          __pyx_t_2 = PyTuple_New(6+__pyx_t_8); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1817, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_2);
          if (__pyx_t_7) {
            __Pyx_GIVEREF(__pyx_t_7); PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_7); __pyx_t_7 = NULL;
          }
          __Pyx_INCREF(__pyx_v_vapor_score_list);
          __Pyx_GIVEREF(__pyx_v_vapor_score_list);
          PyTuple_SET_ITEM(__pyx_t_2, 0+__pyx_t_8, __pyx_v_vapor_score_list);
          __Pyx_INCREF(__pyx_v_best_read_rec);
          __Pyx_GIVEREF(__pyx_v_best_read_rec);
          PyTuple_SET_ITEM(__pyx_t_2, 1+__pyx_t_8, __pyx_v_best_read_rec);
          __Pyx_INCREF(__pyx_v_window_size);
          __Pyx_GIVEREF(__pyx_v_window_size);
          PyTuple_SET_ITEM(__pyx_t_2, 2+__pyx_t_8, __pyx_v_window_size);
          __Pyx_INCREF(__pyx_v_ref_seq);
          __Pyx_GIVEREF(__pyx_v_ref_seq);
          PyTuple_SET_ITEM(__pyx_t_2, 3+__pyx_t_8, __pyx_v_ref_seq);
          __Pyx_GIVEREF(__pyx_t_3);
          PyTuple_SET_ITEM(__pyx_t_2, 4+__pyx_t_8, __pyx_t_3);
          __Pyx_INCREF(__pyx_v_out_figure_name);
          __Pyx_GIVEREF(__pyx_v_out_figure_name);
          PyTuple_SET_ITEM(__pyx_t_2, 5+__pyx_t_8, __pyx_v_out_figure_name);
          __pyx_t_3 = 0;
          __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_2, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1817, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_4);
          __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
          __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
          __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
          goto __pyx_L20;
        }

        /* "vapor_vali/Simple_function.pyx":1818
 *                                 if vapor_score_list[-1]==max(vapor_score_list):best_read_rec=x
 *                 if ins_seq_2.count('X')==len(ins_seq_2):        make_event_figure_1(vapor_score_list,best_read_rec,window_size,ref_seq,ref_seq[2:flank_length],out_figure_name)
 *                 else:            make_event_figure_1(vapor_score_list,best_read_rec,window_size,ref_seq,alt_seq,out_figure_name)             # <<<<<<<<<<<<<<
 *     return vapor_score_list
 * 
 */
        /*else*/ {
          __pyx_t_6 = __Pyx_GetModuleGlobalName(__pyx_n_s_make_event_figure_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1818, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_6);
          __pyx_t_2 = NULL;
          __pyx_t_8 = 0;
          if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_6))) {
            __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_6);
            if (likely(__pyx_t_2)) {
              PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
              __Pyx_INCREF(__pyx_t_2);
              __Pyx_INCREF(function);
              __Pyx_DECREF_SET(__pyx_t_6, function);
              __pyx_t_8 = 1;
            }
          }
          __pyx_t_3 = PyTuple_New(6+__pyx_t_8); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1818, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_3);
          if (__pyx_t_2) {
            __Pyx_GIVEREF(__pyx_t_2); PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_2); __pyx_t_2 = NULL;
          }
          __Pyx_INCREF(__pyx_v_vapor_score_list);
          __Pyx_GIVEREF(__pyx_v_vapor_score_list);
          PyTuple_SET_ITEM(__pyx_t_3, 0+__pyx_t_8, __pyx_v_vapor_score_list);
          __Pyx_INCREF(__pyx_v_best_read_rec);
          __Pyx_GIVEREF(__pyx_v_best_read_rec);
          PyTuple_SET_ITEM(__pyx_t_3, 1+__pyx_t_8, __pyx_v_best_read_rec);
          __Pyx_INCREF(__pyx_v_window_size);
          __Pyx_GIVEREF(__pyx_v_window_size);
          PyTuple_SET_ITEM(__pyx_t_3, 2+__pyx_t_8, __pyx_v_window_size);
          __Pyx_INCREF(__pyx_v_ref_seq);
          __Pyx_GIVEREF(__pyx_v_ref_seq);
          PyTuple_SET_ITEM(__pyx_t_3, 3+__pyx_t_8, __pyx_v_ref_seq);
          __Pyx_INCREF(__pyx_v_alt_seq);
          __Pyx_GIVEREF(__pyx_v_alt_seq);
          PyTuple_SET_ITEM(__pyx_t_3, 4+__pyx_t_8, __pyx_v_alt_seq);
          __Pyx_INCREF(__pyx_v_out_figure_name);
          __Pyx_GIVEREF(__pyx_v_out_figure_name);
          PyTuple_SET_ITEM(__pyx_t_3, 5+__pyx_t_8, __pyx_v_out_figure_name);
          __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_3, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1818, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_4);
          __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
          __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
          __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
        }
        __pyx_L20:;

        /* "vapor_vali/Simple_function.pyx":1800
 *         if not window_size=='Error':
 *             alt_seq=ref_seq[:flank_length]+ins_seq_2+ref_seq[flank_length:(2*flank_length)]
 *             if not window_size=='Error':             # <<<<<<<<<<<<<<
 *                 best_read_rec=''
 *                 if len(all_reads)>10:
 */
      }

      /* "vapor_vali/Simple_function.pyx":1798
 *         ref_seq=ref_seq_readin(ref,['_'.join(ins_pos.split('_')[:-1]),ins_pos.split('_')[-1]][0],int(ins_pos.split('_')[-1])-flank_length,int(ins_pos.split('_')[-1])+flank_length+len(ins_seq),reverse_flag='FALSE')
 *         [window_size,window_size_qc]=window_size_refine(ref_seq)
 *         if not window_size=='Error':             # <<<<<<<<<<<<<<
 *             alt_seq=ref_seq[:flank_length]+ins_seq_2+ref_seq[flank_length:(2*flank_length)]
 *             if not window_size=='Error':
 */
    }

    /* "vapor_vali/Simple_function.pyx":1795
 *     best_read_rec=''
 *     all_reads=simple_chop_pacbio_read_simple_short(bam_in,['_'.join(ins_pos.split('_')[:-1]),ins_pos.split('_')[-1]]+[int(ins_pos.split('_')[-1])+len(ins_seq)],flank_length)
 *     if len(all_reads)>0:             # <<<<<<<<<<<<<<
 *         ref_seq=ref_seq_readin(ref,['_'.join(ins_pos.split('_')[:-1]),ins_pos.split('_')[-1]][0],int(ins_pos.split('_')[-1])-flank_length,int(ins_pos.split('_')[-1])+flank_length+len(ins_seq),reverse_flag='FALSE')
 *         [window_size,window_size_qc]=window_size_refine(ref_seq)
 */
  }

  /* "vapor_vali/Simple_function.pyx":1819
 *                 if ins_seq_2.count('X')==len(ins_seq_2):        make_event_figure_1(vapor_score_list,best_read_rec,window_size,ref_seq,ref_seq[2:flank_length],out_figure_name)
 *                 else:            make_event_figure_1(vapor_score_list,best_read_rec,window_size,ref_seq,alt_seq,out_figure_name)
 *     return vapor_score_list             # <<<<<<<<<<<<<<
 * 
 * def vapor_simple_inv_Vapor(bam_in,ref,sv_info,out_figure_name):
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_vapor_score_list);
  __pyx_r = __pyx_v_vapor_score_list;
  goto __pyx_L0;

  /* "vapor_vali/Simple_function.pyx":1783
 *     return vapor_score_list
 * 
 * def vapor_simple_ins_Vapor(bam_in,ref,ins_pos,ins_seq,out_figure_name,POLARITY):             # <<<<<<<<<<<<<<
 *     #eg of ins_pos='chr1_83144055'
 *     #eg of bam_in='/nfs/turbo/remillsscr/scratch2_trans/datasets/1000genomes/vol1/ftp/data_collections/hgsv_sv_discovery/PacBio/alignment/HG00512.XXX.bam'
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_XDECREF(__pyx_t_7);
  __Pyx_AddTraceback("vapor_vali.Simple_function.vapor_simple_ins_Vapor", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_ins_seq_2);
  __Pyx_XDECREF(__pyx_v_flank_length);
  __Pyx_XDECREF(__pyx_v_vapor_score_list);
  __Pyx_XDECREF(__pyx_v_best_read_rec);
  __Pyx_XDECREF(__pyx_v_all_reads);
  __Pyx_XDECREF(__pyx_v_ref_seq);
  __Pyx_XDECREF(__pyx_v_window_size);
  __Pyx_XDECREF(__pyx_v_window_size_qc);
  __Pyx_XDECREF(__pyx_v_alt_seq);
  __Pyx_XDECREF(__pyx_v_x);
  __Pyx_XDECREF(__pyx_v_vapor_single_read_score);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "vapor_vali/Simple_function.pyx":1821
 *     return vapor_score_list
 * 
 * def vapor_simple_inv_Vapor(bam_in,ref,sv_info,out_figure_name):             # <<<<<<<<<<<<<<
 *     #eg of sv_info=['chr1', 101553562, 101553905]
 *     flank_length=flank_length_calculate(sv_info)
 */

/* Python wrapper */
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_217vapor_simple_inv_Vapor(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_10vapor_vali_15Simple_function_217vapor_simple_inv_Vapor = {"vapor_simple_inv_Vapor", (PyCFunction)__pyx_pw_10vapor_vali_15Simple_function_217vapor_simple_inv_Vapor, METH_VARARGS|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_217vapor_simple_inv_Vapor(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_bam_in = 0;
  PyObject *__pyx_v_ref = 0;
  PyObject *__pyx_v_sv_info = 0;
  PyObject *__pyx_v_out_figure_name = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("vapor_simple_inv_Vapor (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_bam_in,&__pyx_n_s_ref,&__pyx_n_s_sv_info,&__pyx_n_s_out_figure_name,0};
    PyObject* values[4] = {0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
      switch (pos_args) {
        case  4: values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
        case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_bam_in)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_ref)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("vapor_simple_inv_Vapor", 1, 4, 4, 1); __PYX_ERR(0, 1821, __pyx_L3_error)
        }
        case  2:
        if (likely((values[2] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_sv_info)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("vapor_simple_inv_Vapor", 1, 4, 4, 2); __PYX_ERR(0, 1821, __pyx_L3_error)
        }
        case  3:
        if (likely((values[3] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_out_figure_name)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("vapor_simple_inv_Vapor", 1, 4, 4, 3); __PYX_ERR(0, 1821, __pyx_L3_error)
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "vapor_simple_inv_Vapor") < 0)) __PYX_ERR(0, 1821, __pyx_L3_error)
      }
    } else if (PyTuple_GET_SIZE(__pyx_args) != 4) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
      values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
    }
    __pyx_v_bam_in = values[0];
    __pyx_v_ref = values[1];
    __pyx_v_sv_info = values[2];
    __pyx_v_out_figure_name = values[3];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("vapor_simple_inv_Vapor", 1, 4, 4, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1821, __pyx_L3_error)
  __pyx_L3_error:;
  __Pyx_AddTraceback("vapor_vali.Simple_function.vapor_simple_inv_Vapor", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_10vapor_vali_15Simple_function_216vapor_simple_inv_Vapor(__pyx_self, __pyx_v_bam_in, __pyx_v_ref, __pyx_v_sv_info, __pyx_v_out_figure_name);

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10vapor_vali_15Simple_function_216vapor_simple_inv_Vapor(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_bam_in, PyObject *__pyx_v_ref, PyObject *__pyx_v_sv_info, PyObject *__pyx_v_out_figure_name) {
  PyObject *__pyx_v_flank_length = NULL;
  PyObject *__pyx_v_vapor_score_list = NULL;
  PyObject *__pyx_v_best_read_rec = NULL;
  PyObject *__pyx_v_ref_seq = NULL;
  PyObject *__pyx_v_window_size = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_window_size_qc = NULL;
  PyObject *__pyx_v_alt_seq = NULL;
  PyObject *__pyx_v_all_reads = NULL;
  PyObject *__pyx_v_x = NULL;
  PyObject *__pyx_v_vapor_single_read_score = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  int __pyx_t_5;
  PyObject *__pyx_t_6 = NULL;
  PyObject *__pyx_t_7 = NULL;
  Py_ssize_t __pyx_t_8;
  PyObject *__pyx_t_9 = NULL;
  PyObject *(*__pyx_t_10)(PyObject *);
  int __pyx_t_11;
  PyObject *__pyx_t_12 = NULL;
  PyObject *(*__pyx_t_13)(PyObject *);
  Py_ssize_t __pyx_t_14;
  double __pyx_t_15;
  double __pyx_t_16;
  int __pyx_t_17;
  __Pyx_RefNannySetupContext("vapor_simple_inv_Vapor", 0);

  /* "vapor_vali/Simple_function.pyx":1823
 * def vapor_simple_inv_Vapor(bam_in,ref,sv_info,out_figure_name):
 *     #eg of sv_info=['chr1', 101553562, 101553905]
 *     flank_length=flank_length_calculate(sv_info)             # <<<<<<<<<<<<<<
 *     vapor_score_list=[]
 *     best_read_rec=''
 */
  __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_flank_length_calculate); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1823, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_3);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_2, function);
    }
  }
  if (!__pyx_t_3) {
    __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_v_sv_info); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1823, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
  } else {
    __pyx_t_4 = PyTuple_New(1+1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1823, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_GIVEREF(__pyx_t_3); PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3); __pyx_t_3 = NULL;
    __Pyx_INCREF(__pyx_v_sv_info);
    __Pyx_GIVEREF(__pyx_v_sv_info);
    PyTuple_SET_ITEM(__pyx_t_4, 0+1, __pyx_v_sv_info);
    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_4, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1823, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  }
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_flank_length = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":1824
 *     #eg of sv_info=['chr1', 101553562, 101553905]
 *     flank_length=flank_length_calculate(sv_info)
 *     vapor_score_list=[]             # <<<<<<<<<<<<<<
 *     best_read_rec=''
 *     if sv_info[2]-sv_info[1]<default_max_sv_test: #only try to read in all reads with sv <100K; else: try breakpoints ;
 */
  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1824, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_vapor_score_list = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":1825
 *     flank_length=flank_length_calculate(sv_info)
 *     vapor_score_list=[]
 *     best_read_rec=''             # <<<<<<<<<<<<<<
 *     if sv_info[2]-sv_info[1]<default_max_sv_test: #only try to read in all reads with sv <100K; else: try breakpoints ;
 *         ref_seq=ref_seq_readin(ref,sv_info[0],sv_info[1]-flank_length,sv_info[2]+flank_length)
 */
  __Pyx_INCREF(__pyx_kp_s__24);
  __pyx_v_best_read_rec = __pyx_kp_s__24;

  /* "vapor_vali/Simple_function.pyx":1826
 *     vapor_score_list=[]
 *     best_read_rec=''
 *     if sv_info[2]-sv_info[1]<default_max_sv_test: #only try to read in all reads with sv <100K; else: try breakpoints ;             # <<<<<<<<<<<<<<
 *         ref_seq=ref_seq_readin(ref,sv_info[0],sv_info[1]-flank_length,sv_info[2]+flank_length)
 *         [window_size,window_size_qc]=window_size_refine(ref_seq)
 */
  __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_sv_info, 2, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1826, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_sv_info, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1826, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_4 = PyNumber_Subtract(__pyx_t_1, __pyx_t_2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1826, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_default_max_sv_test); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1826, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_1 = PyObject_RichCompare(__pyx_t_4, __pyx_t_2, Py_LT); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1826, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 1826, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  if (__pyx_t_5) {

    /* "vapor_vali/Simple_function.pyx":1827
 *     best_read_rec=''
 *     if sv_info[2]-sv_info[1]<default_max_sv_test: #only try to read in all reads with sv <100K; else: try breakpoints ;
 *         ref_seq=ref_seq_readin(ref,sv_info[0],sv_info[1]-flank_length,sv_info[2]+flank_length)             # <<<<<<<<<<<<<<
 *         [window_size,window_size_qc]=window_size_refine(ref_seq)
 *         if not window_size=='Error':
 */
    __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_ref_seq_readin); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1827, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_4 = __Pyx_GetItemInt(__pyx_v_sv_info, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1827, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_sv_info, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1827, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_6 = PyNumber_Subtract(__pyx_t_3, __pyx_v_flank_length); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1827, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_sv_info, 2, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1827, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_7 = PyNumber_Add(__pyx_t_3, __pyx_v_flank_length); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1827, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = NULL;
    __pyx_t_8 = 0;
    if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_2))) {
      __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
      if (likely(__pyx_t_3)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
        __Pyx_INCREF(__pyx_t_3);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_2, function);
        __pyx_t_8 = 1;
      }
    }
    __pyx_t_9 = PyTuple_New(4+__pyx_t_8); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1827, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_9);
    if (__pyx_t_3) {
      __Pyx_GIVEREF(__pyx_t_3); PyTuple_SET_ITEM(__pyx_t_9, 0, __pyx_t_3); __pyx_t_3 = NULL;
    }
    __Pyx_INCREF(__pyx_v_ref);
    __Pyx_GIVEREF(__pyx_v_ref);
    PyTuple_SET_ITEM(__pyx_t_9, 0+__pyx_t_8, __pyx_v_ref);
    __Pyx_GIVEREF(__pyx_t_4);
    PyTuple_SET_ITEM(__pyx_t_9, 1+__pyx_t_8, __pyx_t_4);
    __Pyx_GIVEREF(__pyx_t_6);
    PyTuple_SET_ITEM(__pyx_t_9, 2+__pyx_t_8, __pyx_t_6);
    __Pyx_GIVEREF(__pyx_t_7);
    PyTuple_SET_ITEM(__pyx_t_9, 3+__pyx_t_8, __pyx_t_7);
    __pyx_t_4 = 0;
    __pyx_t_6 = 0;
    __pyx_t_7 = 0;
    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_9, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1827, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_v_ref_seq = __pyx_t_1;
    __pyx_t_1 = 0;

    /* "vapor_vali/Simple_function.pyx":1828
 *     if sv_info[2]-sv_info[1]<default_max_sv_test: #only try to read in all reads with sv <100K; else: try breakpoints ;
 *         ref_seq=ref_seq_readin(ref,sv_info[0],sv_info[1]-flank_length,sv_info[2]+flank_length)
 *         [window_size,window_size_qc]=window_size_refine(ref_seq)             # <<<<<<<<<<<<<<
 *         if not window_size=='Error':
 *             alt_seq=ref_seq[:flank_length]+reverse(complementary(ref_seq[flank_length:(-flank_length)]))+ref_seq[-flank_length:]
 */
    __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_window_size_refine); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1828, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_9 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_2))) {
      __pyx_t_9 = PyMethod_GET_SELF(__pyx_t_2);
      if (likely(__pyx_t_9)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
        __Pyx_INCREF(__pyx_t_9);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_2, function);
      }
    }
    if (!__pyx_t_9) {
      __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_v_ref_seq); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1828, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
    } else {
      __pyx_t_7 = PyTuple_New(1+1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1828, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_7);
      __Pyx_GIVEREF(__pyx_t_9); PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_9); __pyx_t_9 = NULL;
      __Pyx_INCREF(__pyx_v_ref_seq);
      __Pyx_GIVEREF(__pyx_v_ref_seq);
      PyTuple_SET_ITEM(__pyx_t_7, 0+1, __pyx_v_ref_seq);
      __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_7, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1828, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
    }
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    if ((likely(PyTuple_CheckExact(__pyx_t_1))) || (PyList_CheckExact(__pyx_t_1))) {
      PyObject* sequence = __pyx_t_1;
      #if CYTHON_COMPILING_IN_CPYTHON
      Py_ssize_t size = Py_SIZE(sequence);
      #else
      Py_ssize_t size = PySequence_Size(sequence);
      #endif
      if (unlikely(size != 2)) {
        if (size > 2) __Pyx_RaiseTooManyValuesError(2);
        else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
        __PYX_ERR(0, 1828, __pyx_L1_error)
      }
      #if CYTHON_COMPILING_IN_CPYTHON
      if (likely(PyTuple_CheckExact(sequence))) {
        __pyx_t_2 = PyTuple_GET_ITEM(sequence, 0); 
        __pyx_t_7 = PyTuple_GET_ITEM(sequence, 1); 
      } else {
        __pyx_t_2 = PyList_GET_ITEM(sequence, 0); 
        __pyx_t_7 = PyList_GET_ITEM(sequence, 1); 
      }
      __Pyx_INCREF(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_7);
      #else
      __pyx_t_2 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1828, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __pyx_t_7 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1828, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_7);
      #endif
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    } else {
      Py_ssize_t index = -1;
      __pyx_t_9 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1828, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_9);
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_10 = Py_TYPE(__pyx_t_9)->tp_iternext;
      index = 0; __pyx_t_2 = __pyx_t_10(__pyx_t_9); if (unlikely(!__pyx_t_2)) goto __pyx_L4_unpacking_failed;
      __Pyx_GOTREF(__pyx_t_2);
      index = 1; __pyx_t_7 = __pyx_t_10(__pyx_t_9); if (unlikely(!__pyx_t_7)) goto __pyx_L4_unpacking_failed;
      __Pyx_GOTREF(__pyx_t_7);
      if (__Pyx_IternextUnpackEndCheck(__pyx_t_10(__pyx_t_9), 2) < 0) __PYX_ERR(0, 1828, __pyx_L1_error)
      __pyx_t_10 = NULL;
      __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
      goto __pyx_L5_unpacking_done;
      __pyx_L4_unpacking_failed:;
      __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
      __pyx_t_10 = NULL;
      if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
      __PYX_ERR(0, 1828, __pyx_L1_error)
      __pyx_L5_unpacking_done:;
    }
    __pyx_v_window_size = __pyx_t_2;
    __pyx_t_2 = 0;
    __pyx_v_window_size_qc = __pyx_t_7;
    __pyx_t_7 = 0;

    /* "vapor_vali/Simple_function.pyx":1829
 *         ref_seq=ref_seq_readin(ref,sv_info[0],sv_info[1]-flank_length,sv_info[2]+flank_length)
 *         [window_size,window_size_qc]=window_size_refine(ref_seq)
 *         if not window_size=='Error':             # <<<<<<<<<<<<<<
 *             alt_seq=ref_seq[:flank_length]+reverse(complementary(ref_seq[flank_length:(-flank_length)]))+ref_seq[-flank_length:]
 *             [window_size,window_size_qc]=window_size_refine(alt_seq)
 */
    __pyx_t_5 = (__Pyx_PyString_Equals(__pyx_v_window_size, __pyx_n_s_Error, Py_EQ)); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 1829, __pyx_L1_error)
    __pyx_t_11 = ((!__pyx_t_5) != 0);
    if (__pyx_t_11) {

      /* "vapor_vali/Simple_function.pyx":1830
 *         [window_size,window_size_qc]=window_size_refine(ref_seq)
 *         if not window_size=='Error':
 *             alt_seq=ref_seq[:flank_length]+reverse(complementary(ref_seq[flank_length:(-flank_length)]))+ref_seq[-flank_length:]             # <<<<<<<<<<<<<<
 *             [window_size,window_size_qc]=window_size_refine(alt_seq)
 *             if not window_size=='Error':
 */
      __pyx_t_1 = __Pyx_PyObject_GetSlice(__pyx_v_ref_seq, 0, 0, NULL, &__pyx_v_flank_length, NULL, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1830, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_reverse); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1830, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __pyx_t_6 = __Pyx_GetModuleGlobalName(__pyx_n_s_complementary); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1830, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_6);
      __pyx_t_4 = PyNumber_Negative(__pyx_v_flank_length); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1830, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_t_3 = __Pyx_PyObject_GetSlice(__pyx_v_ref_seq, 0, 0, &__pyx_v_flank_length, &__pyx_t_4, NULL, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1830, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_4 = NULL;
      if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_6))) {
        __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_6);
        if (likely(__pyx_t_4)) {
          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
          __Pyx_INCREF(__pyx_t_4);
          __Pyx_INCREF(function);
          __Pyx_DECREF_SET(__pyx_t_6, function);
        }
      }
      if (!__pyx_t_4) {
        __pyx_t_9 = __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_3); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1830, __pyx_L1_error)
        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
        __Pyx_GOTREF(__pyx_t_9);
      } else {
        __pyx_t_12 = PyTuple_New(1+1); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1830, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_12);
        __Pyx_GIVEREF(__pyx_t_4); PyTuple_SET_ITEM(__pyx_t_12, 0, __pyx_t_4); __pyx_t_4 = NULL;
        __Pyx_GIVEREF(__pyx_t_3);
        PyTuple_SET_ITEM(__pyx_t_12, 0+1, __pyx_t_3);
        __pyx_t_3 = 0;
        __pyx_t_9 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_12, NULL); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1830, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_9);
        __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
      }
      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
      __pyx_t_6 = NULL;
      if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_2))) {
        __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_2);
        if (likely(__pyx_t_6)) {
          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
          __Pyx_INCREF(__pyx_t_6);
          __Pyx_INCREF(function);
          __Pyx_DECREF_SET(__pyx_t_2, function);
        }
      }
      if (!__pyx_t_6) {
        __pyx_t_7 = __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_9); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1830, __pyx_L1_error)
        __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
        __Pyx_GOTREF(__pyx_t_7);
      } else {
        __pyx_t_12 = PyTuple_New(1+1); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1830, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_12);
        __Pyx_GIVEREF(__pyx_t_6); PyTuple_SET_ITEM(__pyx_t_12, 0, __pyx_t_6); __pyx_t_6 = NULL;
        __Pyx_GIVEREF(__pyx_t_9);
        PyTuple_SET_ITEM(__pyx_t_12, 0+1, __pyx_t_9);
        __pyx_t_9 = 0;
        __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_12, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1830, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_7);
        __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
      }
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_2 = PyNumber_Add(__pyx_t_1, __pyx_t_7); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1830, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
      __pyx_t_7 = PyNumber_Negative(__pyx_v_flank_length); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1830, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_7);
      __pyx_t_1 = __Pyx_PyObject_GetSlice(__pyx_v_ref_seq, 0, 0, &__pyx_t_7, NULL, NULL, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1830, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
      __pyx_t_7 = PyNumber_Add(__pyx_t_2, __pyx_t_1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1830, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_7);
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_v_alt_seq = __pyx_t_7;
      __pyx_t_7 = 0;

      /* "vapor_vali/Simple_function.pyx":1831
 *         if not window_size=='Error':
 *             alt_seq=ref_seq[:flank_length]+reverse(complementary(ref_seq[flank_length:(-flank_length)]))+ref_seq[-flank_length:]
 *             [window_size,window_size_qc]=window_size_refine(alt_seq)             # <<<<<<<<<<<<<<
 *             if not window_size=='Error':
 *                 all_reads=simple_chop_pacbio_read_simple_short(bam_in,sv_info,flank_length)
 */
      __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_window_size_refine); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1831, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __pyx_t_2 = NULL;
      if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_1))) {
        __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_1);
        if (likely(__pyx_t_2)) {
          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
          __Pyx_INCREF(__pyx_t_2);
          __Pyx_INCREF(function);
          __Pyx_DECREF_SET(__pyx_t_1, function);
        }
      }
      if (!__pyx_t_2) {
        __pyx_t_7 = __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_v_alt_seq); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1831, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_7);
      } else {
        __pyx_t_12 = PyTuple_New(1+1); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1831, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_12);
        __Pyx_GIVEREF(__pyx_t_2); PyTuple_SET_ITEM(__pyx_t_12, 0, __pyx_t_2); __pyx_t_2 = NULL;
        __Pyx_INCREF(__pyx_v_alt_seq);
        __Pyx_GIVEREF(__pyx_v_alt_seq);
        PyTuple_SET_ITEM(__pyx_t_12, 0+1, __pyx_v_alt_seq);
        __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_12, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1831, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_7);
        __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
      }
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      if ((likely(PyTuple_CheckExact(__pyx_t_7))) || (PyList_CheckExact(__pyx_t_7))) {
        PyObject* sequence = __pyx_t_7;
        #if CYTHON_COMPILING_IN_CPYTHON
        Py_ssize_t size = Py_SIZE(sequence);
        #else
        Py_ssize_t size = PySequence_Size(sequence);
        #endif
        if (unlikely(size != 2)) {
          if (size > 2) __Pyx_RaiseTooManyValuesError(2);
          else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
          __PYX_ERR(0, 1831, __pyx_L1_error)
        }
        #if CYTHON_COMPILING_IN_CPYTHON
        if (likely(PyTuple_CheckExact(sequence))) {
          __pyx_t_1 = PyTuple_GET_ITEM(sequence, 0); 
          __pyx_t_12 = PyTuple_GET_ITEM(sequence, 1); 
        } else {
          __pyx_t_1 = PyList_GET_ITEM(sequence, 0); 
          __pyx_t_12 = PyList_GET_ITEM(sequence, 1); 
        }
        __Pyx_INCREF(__pyx_t_1);
        __Pyx_INCREF(__pyx_t_12);
        #else
        __pyx_t_1 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1831, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        __pyx_t_12 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1831, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_12);
        #endif
        __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
      } else {
        Py_ssize_t index = -1;
        __pyx_t_2 = PyObject_GetIter(__pyx_t_7); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1831, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
        __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
        __pyx_t_10 = Py_TYPE(__pyx_t_2)->tp_iternext;
        index = 0; __pyx_t_1 = __pyx_t_10(__pyx_t_2); if (unlikely(!__pyx_t_1)) goto __pyx_L7_unpacking_failed;
        __Pyx_GOTREF(__pyx_t_1);
        index = 1; __pyx_t_12 = __pyx_t_10(__pyx_t_2); if (unlikely(!__pyx_t_12)) goto __pyx_L7_unpacking_failed;
        __Pyx_GOTREF(__pyx_t_12);
        if (__Pyx_IternextUnpackEndCheck(__pyx_t_10(__pyx_t_2), 2) < 0) __PYX_ERR(0, 1831, __pyx_L1_error)
        __pyx_t_10 = NULL;
        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
        goto __pyx_L8_unpacking_done;
        __pyx_L7_unpacking_failed:;
        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
        __pyx_t_10 = NULL;
        if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
        __PYX_ERR(0, 1831, __pyx_L1_error)
        __pyx_L8_unpacking_done:;
      }
      __Pyx_DECREF_SET(__pyx_v_window_size, __pyx_t_1);
      __pyx_t_1 = 0;
      __Pyx_DECREF_SET(__pyx_v_window_size_qc, __pyx_t_12);
      __pyx_t_12 = 0;

      /* "vapor_vali/Simple_function.pyx":1832
 *             alt_seq=ref_seq[:flank_length]+reverse(complementary(ref_seq[flank_length:(-flank_length)]))+ref_seq[-flank_length:]
 *             [window_size,window_size_qc]=window_size_refine(alt_seq)
 *             if not window_size=='Error':             # <<<<<<<<<<<<<<
 *                 all_reads=simple_chop_pacbio_read_simple_short(bam_in,sv_info,flank_length)
 *                 if len(all_reads)>10:
 */
      __pyx_t_11 = (__Pyx_PyString_Equals(__pyx_v_window_size, __pyx_n_s_Error, Py_EQ)); if (unlikely(__pyx_t_11 < 0)) __PYX_ERR(0, 1832, __pyx_L1_error)
      __pyx_t_5 = ((!__pyx_t_11) != 0);
      if (__pyx_t_5) {

        /* "vapor_vali/Simple_function.pyx":1833
 *             [window_size,window_size_qc]=window_size_refine(alt_seq)
 *             if not window_size=='Error':
 *                 all_reads=simple_chop_pacbio_read_simple_short(bam_in,sv_info,flank_length)             # <<<<<<<<<<<<<<
 *                 if len(all_reads)>10:
 *                     best_read_rec=''
 */
        __pyx_t_12 = __Pyx_GetModuleGlobalName(__pyx_n_s_simple_chop_pacbio_read_simple_s); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1833, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_12);
        __pyx_t_1 = NULL;
        __pyx_t_8 = 0;
        if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_12))) {
          __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_12);
          if (likely(__pyx_t_1)) {
            PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_12);
            __Pyx_INCREF(__pyx_t_1);
            __Pyx_INCREF(function);
            __Pyx_DECREF_SET(__pyx_t_12, function);
            __pyx_t_8 = 1;
          }
        }
        __pyx_t_2 = PyTuple_New(3+__pyx_t_8); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1833, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
        if (__pyx_t_1) {
          __Pyx_GIVEREF(__pyx_t_1); PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_1); __pyx_t_1 = NULL;
        }
        __Pyx_INCREF(__pyx_v_bam_in);
        __Pyx_GIVEREF(__pyx_v_bam_in);
        PyTuple_SET_ITEM(__pyx_t_2, 0+__pyx_t_8, __pyx_v_bam_in);
        __Pyx_INCREF(__pyx_v_sv_info);
        __Pyx_GIVEREF(__pyx_v_sv_info);
        PyTuple_SET_ITEM(__pyx_t_2, 1+__pyx_t_8, __pyx_v_sv_info);
        __Pyx_INCREF(__pyx_v_flank_length);
        __Pyx_GIVEREF(__pyx_v_flank_length);
        PyTuple_SET_ITEM(__pyx_t_2, 2+__pyx_t_8, __pyx_v_flank_length);
        __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_12, __pyx_t_2, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1833, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_7);
        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
        __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
        __pyx_v_all_reads = __pyx_t_7;
        __pyx_t_7 = 0;

        /* "vapor_vali/Simple_function.pyx":1834
 *             if not window_size=='Error':
 *                 all_reads=simple_chop_pacbio_read_simple_short(bam_in,sv_info,flank_length)
 *                 if len(all_reads)>10:             # <<<<<<<<<<<<<<
 *                     best_read_rec=''
 *                     for x in all_reads:
 */
        __pyx_t_8 = PyObject_Length(__pyx_v_all_reads); if (unlikely(__pyx_t_8 == -1)) __PYX_ERR(0, 1834, __pyx_L1_error)
        __pyx_t_5 = ((__pyx_t_8 > 10) != 0);
        if (__pyx_t_5) {

          /* "vapor_vali/Simple_function.pyx":1835
 *                 all_reads=simple_chop_pacbio_read_simple_short(bam_in,sv_info,flank_length)
 *                 if len(all_reads)>10:
 *                     best_read_rec=''             # <<<<<<<<<<<<<<
 *                     for x in all_reads:
 *                         vapor_single_read_score=calcu_vapor_single_read_score_abs_dis_m1b(ref_seq,alt_seq,x,window_size)
 */
          __Pyx_INCREF(__pyx_kp_s__24);
          __Pyx_DECREF_SET(__pyx_v_best_read_rec, __pyx_kp_s__24);

          /* "vapor_vali/Simple_function.pyx":1836
 *                 if len(all_reads)>10:
 *                     best_read_rec=''
 *                     for x in all_reads:             # <<<<<<<<<<<<<<
 *                         vapor_single_read_score=calcu_vapor_single_read_score_abs_dis_m1b(ref_seq,alt_seq,x,window_size)
 *                         if not 0 in vapor_single_read_score:
 */
          if (likely(PyList_CheckExact(__pyx_v_all_reads)) || PyTuple_CheckExact(__pyx_v_all_reads)) {
            __pyx_t_7 = __pyx_v_all_reads; __Pyx_INCREF(__pyx_t_7); __pyx_t_8 = 0;
            __pyx_t_13 = NULL;
          } else {
            __pyx_t_8 = -1; __pyx_t_7 = PyObject_GetIter(__pyx_v_all_reads); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1836, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_7);
            __pyx_t_13 = Py_TYPE(__pyx_t_7)->tp_iternext; if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1836, __pyx_L1_error)
          }
          for (;;) {
            if (likely(!__pyx_t_13)) {
              if (likely(PyList_CheckExact(__pyx_t_7))) {
                if (__pyx_t_8 >= PyList_GET_SIZE(__pyx_t_7)) break;
                #if CYTHON_COMPILING_IN_CPYTHON
                __pyx_t_12 = PyList_GET_ITEM(__pyx_t_7, __pyx_t_8); __Pyx_INCREF(__pyx_t_12); __pyx_t_8++; if (unlikely(0 < 0)) __PYX_ERR(0, 1836, __pyx_L1_error)
                #else
                __pyx_t_12 = PySequence_ITEM(__pyx_t_7, __pyx_t_8); __pyx_t_8++; if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1836, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_12);
                #endif
              } else {
                if (__pyx_t_8 >= PyTuple_GET_SIZE(__pyx_t_7)) break;
                #if CYTHON_COMPILING_IN_CPYTHON
                __pyx_t_12 = PyTuple_GET_ITEM(__pyx_t_7, __pyx_t_8); __Pyx_INCREF(__pyx_t_12); __pyx_t_8++; if (unlikely(0 < 0)) __PYX_ERR(0, 1836, __pyx_L1_error)
                #else
                __pyx_t_12 = PySequence_ITEM(__pyx_t_7, __pyx_t_8); __pyx_t_8++; if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1836, __pyx_L1_error)
                __Pyx_GOTREF(__pyx_t_12);
                #endif
              }
            } else {
              __pyx_t_12 = __pyx_t_13(__pyx_t_7);
              if (unlikely(!__pyx_t_12)) {
                PyObject* exc_type = PyErr_Occurred();
                if (exc_type) {
                  if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
                  else __PYX_ERR(0, 1836, __pyx_L1_error)
                }
                break;
              }
              __Pyx_GOTREF(__pyx_t_12);
            }
            __Pyx_XDECREF_SET(__pyx_v_x, __pyx_t_12);
            __pyx_t_12 = 0;

            /* "vapor_vali/Simple_function.pyx":1837
 *                     best_read_rec=''
 *                     for x in all_reads:
 *                         vapor_single_read_score=calcu_vapor_single_read_score_abs_dis_m1b(ref_seq,alt_seq,x,window_size)             # <<<<<<<<<<<<<<
 *                         if not 0 in vapor_single_read_score:
 *                             vapor_score_list.append(1-float(vapor_single_read_score[1])/float(vapor_single_read_score[0]))
 */
            __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_calcu_vapor_single_read_score_ab); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1837, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_2);
            __pyx_t_1 = NULL;
            __pyx_t_14 = 0;
            if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_2))) {
              __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_2);
              if (likely(__pyx_t_1)) {
                PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
                __Pyx_INCREF(__pyx_t_1);
                __Pyx_INCREF(function);
                __Pyx_DECREF_SET(__pyx_t_2, function);
                __pyx_t_14 = 1;
              }
            }
            __pyx_t_9 = PyTuple_New(4+__pyx_t_14); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1837, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_9);
            if (__pyx_t_1) {
              __Pyx_GIVEREF(__pyx_t_1); PyTuple_SET_ITEM(__pyx_t_9, 0, __pyx_t_1); __pyx_t_1 = NULL;
            }
            __Pyx_INCREF(__pyx_v_ref_seq);
            __Pyx_GIVEREF(__pyx_v_ref_seq);
            PyTuple_SET_ITEM(__pyx_t_9, 0+__pyx_t_14, __pyx_v_ref_seq);
            __Pyx_INCREF(__pyx_v_alt_seq);
            __Pyx_GIVEREF(__pyx_v_alt_seq);
            PyTuple_SET_ITEM(__pyx_t_9, 1+__pyx_t_14, __pyx_v_alt_seq);
            __Pyx_INCREF(__pyx_v_x);
            __Pyx_GIVEREF(__pyx_v_x);
            PyTuple_SET_ITEM(__pyx_t_9, 2+__pyx_t_14, __pyx_v_x);
            __Pyx_INCREF(__pyx_v_window_size);
            __Pyx_GIVEREF(__pyx_v_window_size);
            PyTuple_SET_ITEM(__pyx_t_9, 3+__pyx_t_14, __pyx_v_window_size);
            __pyx_t_12 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_9, NULL); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1837, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_12);
            __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
            __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
            __Pyx_XDECREF_SET(__pyx_v_vapor_single_read_score, __pyx_t_12);
            __pyx_t_12 = 0;

            /* "vapor_vali/Simple_function.pyx":1838
 *                     for x in all_reads:
 *                         vapor_single_read_score=calcu_vapor_single_read_score_abs_dis_m1b(ref_seq,alt_seq,x,window_size)
 *                         if not 0 in vapor_single_read_score:             # <<<<<<<<<<<<<<
 *                             vapor_score_list.append(1-float(vapor_single_read_score[1])/float(vapor_single_read_score[0]))
 *                             if vapor_score_list[-1]==max(vapor_score_list):best_read_rec=x
 */
            __pyx_t_5 = (__Pyx_PySequence_ContainsTF(__pyx_int_0, __pyx_v_vapor_single_read_score, Py_NE)); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 1838, __pyx_L1_error)
            __pyx_t_11 = (__pyx_t_5 != 0);
            if (__pyx_t_11) {

              /* "vapor_vali/Simple_function.pyx":1839
 *                         vapor_single_read_score=calcu_vapor_single_read_score_abs_dis_m1b(ref_seq,alt_seq,x,window_size)
 *                         if not 0 in vapor_single_read_score:
 *                             vapor_score_list.append(1-float(vapor_single_read_score[1])/float(vapor_single_read_score[0]))             # <<<<<<<<<<<<<<
 *                             if vapor_score_list[-1]==max(vapor_score_list):best_read_rec=x
 *                     make_event_figure_1(vapor_score_list,best_read_rec,window_size,ref_seq,alt_seq,out_figure_name)
 */
              __pyx_t_12 = __Pyx_GetItemInt(__pyx_v_vapor_single_read_score, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1839, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_12);
              __pyx_t_15 = __Pyx_PyObject_AsDouble(__pyx_t_12); if (unlikely(__pyx_t_15 == ((double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1839, __pyx_L1_error)
              __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
              __pyx_t_12 = __Pyx_GetItemInt(__pyx_v_vapor_single_read_score, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1839, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_12);
              __pyx_t_16 = __Pyx_PyObject_AsDouble(__pyx_t_12); if (unlikely(__pyx_t_16 == ((double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1839, __pyx_L1_error)
              __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
              if (unlikely(__pyx_t_16 == 0)) {
                PyErr_SetString(PyExc_ZeroDivisionError, "float division");
                __PYX_ERR(0, 1839, __pyx_L1_error)
              }
              __pyx_t_12 = PyFloat_FromDouble((1.0 - (__pyx_t_15 / __pyx_t_16))); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1839, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_12);
              __pyx_t_17 = __Pyx_PyList_Append(__pyx_v_vapor_score_list, __pyx_t_12); if (unlikely(__pyx_t_17 == -1)) __PYX_ERR(0, 1839, __pyx_L1_error)
              __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;

              /* "vapor_vali/Simple_function.pyx":1840
 *                         if not 0 in vapor_single_read_score:
 *                             vapor_score_list.append(1-float(vapor_single_read_score[1])/float(vapor_single_read_score[0]))
 *                             if vapor_score_list[-1]==max(vapor_score_list):best_read_rec=x             # <<<<<<<<<<<<<<
 *                     make_event_figure_1(vapor_score_list,best_read_rec,window_size,ref_seq,alt_seq,out_figure_name)
 *                     return vapor_score_list
 */
              __pyx_t_12 = __Pyx_GetItemInt_List(__pyx_v_vapor_score_list, -1L, long, 1, __Pyx_PyInt_From_long, 1, 1, 1); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1840, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_12);
              __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1840, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_2);
              __Pyx_INCREF(__pyx_v_vapor_score_list);
              __Pyx_GIVEREF(__pyx_v_vapor_score_list);
              PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_v_vapor_score_list);
              __pyx_t_9 = __Pyx_PyObject_Call(__pyx_builtin_max, __pyx_t_2, NULL); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1840, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_9);
              __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
              __pyx_t_2 = PyObject_RichCompare(__pyx_t_12, __pyx_t_9, Py_EQ); __Pyx_XGOTREF(__pyx_t_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1840, __pyx_L1_error)
              __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
              __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
              __pyx_t_11 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_11 < 0)) __PYX_ERR(0, 1840, __pyx_L1_error)
              __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
              if (__pyx_t_11) {
                __Pyx_INCREF(__pyx_v_x);
                __Pyx_DECREF_SET(__pyx_v_best_read_rec, __pyx_v_x);
              }

              /* "vapor_vali/Simple_function.pyx":1838
 *                     for x in all_reads:
 *                         vapor_single_read_score=calcu_vapor_single_read_score_abs_dis_m1b(ref_seq,alt_seq,x,window_size)
 *                         if not 0 in vapor_single_read_score:             # <<<<<<<<<<<<<<
 *                             vapor_score_list.append(1-float(vapor_single_read_score[1])/float(vapor_single_read_score[0]))
 *                             if vapor_score_list[-1]==max(vapor_score_list):best_read_rec=x
 */
            }

            /* "vapor_vali/Simple_function.pyx":1836
 *                 if len(all_reads)>10:
 *                     best_read_rec=''
 *                     for x in all_reads:             # <<<<<<<<<<<<<<
 *                         vapor_single_read_score=calcu_vapor_single_read_score_abs_dis_m1b(ref_seq,alt_seq,x,window_size)
 *                         if not 0 in vapor_single_read_score:
 */
          }
          __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;

          /* "vapor_vali/Simple_function.pyx":1841
 *                             vapor_score_list.append(1-float(vapor_single_read_score[1])/float(vapor_single_read_score[0]))
 *                             if vapor_score_list[-1]==max(vapor_score_list):best_read_rec=x
 *                     make_event_figure_1(vapor_score_list,best_read_rec,window_size,ref_seq,alt_seq,out_figure_name)             # <<<<<<<<<<<<<<
 *                     return vapor_score_list
 *     ref_seq=ref_seq_readin(ref,sv_info[0],sv_info[1]-flank_length,sv_info[1]+flank_length)
 */
          __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_make_event_figure_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1841, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_2);
          __pyx_t_9 = NULL;
          __pyx_t_8 = 0;
          if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_2))) {
            __pyx_t_9 = PyMethod_GET_SELF(__pyx_t_2);
            if (likely(__pyx_t_9)) {
              PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
              __Pyx_INCREF(__pyx_t_9);
              __Pyx_INCREF(function);
              __Pyx_DECREF_SET(__pyx_t_2, function);
              __pyx_t_8 = 1;
            }
          }
          __pyx_t_12 = PyTuple_New(6+__pyx_t_8); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1841, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_12);
          if (__pyx_t_9) {
            __Pyx_GIVEREF(__pyx_t_9); PyTuple_SET_ITEM(__pyx_t_12, 0, __pyx_t_9); __pyx_t_9 = NULL;
          }
          __Pyx_INCREF(__pyx_v_vapor_score_list);
          __Pyx_GIVEREF(__pyx_v_vapor_score_list);
          PyTuple_SET_ITEM(__pyx_t_12, 0+__pyx_t_8, __pyx_v_vapor_score_list);
          __Pyx_INCREF(__pyx_v_best_read_rec);
          __Pyx_GIVEREF(__pyx_v_best_read_rec);
          PyTuple_SET_ITEM(__pyx_t_12, 1+__pyx_t_8, __pyx_v_best_read_rec);
          __Pyx_INCREF(__pyx_v_window_size);
          __Pyx_GIVEREF(__pyx_v_window_size);
          PyTuple_SET_ITEM(__pyx_t_12, 2+__pyx_t_8, __pyx_v_window_size);
          __Pyx_INCREF(__pyx_v_ref_seq);
          __Pyx_GIVEREF(__pyx_v_ref_seq);
          PyTuple_SET_ITEM(__pyx_t_12, 3+__pyx_t_8, __pyx_v_ref_seq);
          __Pyx_INCREF(__pyx_v_alt_seq);
          __Pyx_GIVEREF(__pyx_v_alt_seq);
          PyTuple_SET_ITEM(__pyx_t_12, 4+__pyx_t_8, __pyx_v_alt_seq);
          __Pyx_INCREF(__pyx_v_out_figure_name);
          __Pyx_GIVEREF(__pyx_v_out_figure_name);
          PyTuple_SET_ITEM(__pyx_t_12, 5+__pyx_t_8, __pyx_v_out_figure_name);
          __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_12, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1841, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_7);
          __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
          __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
          __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;

          /* "vapor_vali/Simple_function.pyx":1842
 *                             if vapor_score_list[-1]==max(vapor_score_list):best_read_rec=x
 *                     make_event_figure_1(vapor_score_list,best_read_rec,window_size,ref_seq,alt_seq,out_figure_name)
 *                     return vapor_score_list             # <<<<<<<<<<<<<<
 *     ref_seq=ref_seq_readin(ref,sv_info[0],sv_info[1]-flank_length,sv_info[1]+flank_length)
 *     [window_size,window_size_qc]=window_size_refine(ref_seq)
 */
          __Pyx_XDECREF(__pyx_r);
          __Pyx_INCREF(__pyx_v_vapor_score_list);
          __pyx_r = __pyx_v_vapor_score_list;
          goto __pyx_L0;

          /* "vapor_vali/Simple_function.pyx":1834
 *             if not window_size=='Error':
 *                 all_reads=simple_chop_pacbio_read_simple_short(bam_in,sv_info,flank_length)
 *                 if len(all_reads)>10:             # <<<<<<<<<<<<<<
 *                     best_read_rec=''
 *                     for x in all_reads:
 */
        }

        /* "vapor_vali/Simple_function.pyx":1832
 *             alt_seq=ref_seq[:flank_length]+reverse(complementary(ref_seq[flank_length:(-flank_length)]))+ref_seq[-flank_length:]
 *             [window_size,window_size_qc]=window_size_refine(alt_seq)
 *             if not window_size=='Error':             # <<<<<<<<<<<<<<
 *                 all_reads=simple_chop_pacbio_read_simple_short(bam_in,sv_info,flank_length)
 *                 if len(all_reads)>10:
 */
      }

      /* "vapor_vali/Simple_function.pyx":1829
 *         ref_seq=ref_seq_readin(ref,sv_info[0],sv_info[1]-flank_length,sv_info[2]+flank_length)
 *         [window_size,window_size_qc]=window_size_refine(ref_seq)
 *         if not window_size=='Error':             # <<<<<<<<<<<<<<
 *             alt_seq=ref_seq[:flank_length]+reverse(complementary(ref_seq[flank_length:(-flank_length)]))+ref_seq[-flank_length:]
 *             [window_size,window_size_qc]=window_size_refine(alt_seq)
 */
    }

    /* "vapor_vali/Simple_function.pyx":1826
 *     vapor_score_list=[]
 *     best_read_rec=''
 *     if sv_info[2]-sv_info[1]<default_max_sv_test: #only try to read in all reads with sv <100K; else: try breakpoints ;             # <<<<<<<<<<<<<<
 *         ref_seq=ref_seq_readin(ref,sv_info[0],sv_info[1]-flank_length,sv_info[2]+flank_length)
 *         [window_size,window_size_qc]=window_size_refine(ref_seq)
 */
  }

  /* "vapor_vali/Simple_function.pyx":1843
 *                     make_event_figure_1(vapor_score_list,best_read_rec,window_size,ref_seq,alt_seq,out_figure_name)
 *                     return vapor_score_list
 *     ref_seq=ref_seq_readin(ref,sv_info[0],sv_info[1]-flank_length,sv_info[1]+flank_length)             # <<<<<<<<<<<<<<
 *     [window_size,window_size_qc]=window_size_refine(ref_seq)
 *     if not window_size=='Error':
 */
  __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_ref_seq_readin); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1843, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_12 = __Pyx_GetItemInt(__pyx_v_sv_info, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1843, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_12);
  __pyx_t_9 = __Pyx_GetItemInt(__pyx_v_sv_info, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1843, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_9);
  __pyx_t_1 = PyNumber_Subtract(__pyx_t_9, __pyx_v_flank_length); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1843, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
  __pyx_t_9 = __Pyx_GetItemInt(__pyx_v_sv_info, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1843, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_9);
  __pyx_t_6 = PyNumber_Add(__pyx_t_9, __pyx_v_flank_length); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1843, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
  __pyx_t_9 = NULL;
  __pyx_t_8 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_9 = PyMethod_GET_SELF(__pyx_t_2);
    if (likely(__pyx_t_9)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_9);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_2, function);
      __pyx_t_8 = 1;
    }
  }
  __pyx_t_3 = PyTuple_New(4+__pyx_t_8); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1843, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  if (__pyx_t_9) {
    __Pyx_GIVEREF(__pyx_t_9); PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_9); __pyx_t_9 = NULL;
  }
  __Pyx_INCREF(__pyx_v_ref);
  __Pyx_GIVEREF(__pyx_v_ref);
  PyTuple_SET_ITEM(__pyx_t_3, 0+__pyx_t_8, __pyx_v_ref);
  __Pyx_GIVEREF(__pyx_t_12);
  PyTuple_SET_ITEM(__pyx_t_3, 1+__pyx_t_8, __pyx_t_12);
  __Pyx_GIVEREF(__pyx_t_1);
  PyTuple_SET_ITEM(__pyx_t_3, 2+__pyx_t_8, __pyx_t_1);
  __Pyx_GIVEREF(__pyx_t_6);
  PyTuple_SET_ITEM(__pyx_t_3, 3+__pyx_t_8, __pyx_t_6);
  __pyx_t_12 = 0;
  __pyx_t_1 = 0;
  __pyx_t_6 = 0;
  __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_3, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1843, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __Pyx_XDECREF_SET(__pyx_v_ref_seq, __pyx_t_7);
  __pyx_t_7 = 0;

  /* "vapor_vali/Simple_function.pyx":1844
 *                     return vapor_score_list
 *     ref_seq=ref_seq_readin(ref,sv_info[0],sv_info[1]-flank_length,sv_info[1]+flank_length)
 *     [window_size,window_size_qc]=window_size_refine(ref_seq)             # <<<<<<<<<<<<<<
 *     if not window_size=='Error':
 *         alt_seq=ref_seq[:flank_length]+ref_seq_readin(ref,sv_info[0],sv_info[2]-flank_length,sv_info[2],'TRUE')
 */
  __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_window_size_refine); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1844, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_3);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_2, function);
    }
  }
  if (!__pyx_t_3) {
    __pyx_t_7 = __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_v_ref_seq); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1844, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
  } else {
    __pyx_t_6 = PyTuple_New(1+1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1844, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __Pyx_GIVEREF(__pyx_t_3); PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_3); __pyx_t_3 = NULL;
    __Pyx_INCREF(__pyx_v_ref_seq);
    __Pyx_GIVEREF(__pyx_v_ref_seq);
    PyTuple_SET_ITEM(__pyx_t_6, 0+1, __pyx_v_ref_seq);
    __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_6, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1844, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  }
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  if ((likely(PyTuple_CheckExact(__pyx_t_7))) || (PyList_CheckExact(__pyx_t_7))) {
    PyObject* sequence = __pyx_t_7;
    #if CYTHON_COMPILING_IN_CPYTHON
    Py_ssize_t size = Py_SIZE(sequence);
    #else
    Py_ssize_t size = PySequence_Size(sequence);
    #endif
    if (unlikely(size != 2)) {
      if (size > 2) __Pyx_RaiseTooManyValuesError(2);
      else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
      __PYX_ERR(0, 1844, __pyx_L1_error)
    }
    #if CYTHON_COMPILING_IN_CPYTHON
    if (likely(PyTuple_CheckExact(sequence))) {
      __pyx_t_2 = PyTuple_GET_ITEM(sequence, 0); 
      __pyx_t_6 = PyTuple_GET_ITEM(sequence, 1); 
    } else {
      __pyx_t_2 = PyList_GET_ITEM(sequence, 0); 
      __pyx_t_6 = PyList_GET_ITEM(sequence, 1); 
    }
    __Pyx_INCREF(__pyx_t_2);
    __Pyx_INCREF(__pyx_t_6);
    #else
    __pyx_t_2 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1844, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_6 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1844, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    #endif
    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
  } else {
    Py_ssize_t index = -1;
    __pyx_t_3 = PyObject_GetIter(__pyx_t_7); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1844, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_t_10 = Py_TYPE(__pyx_t_3)->tp_iternext;
    index = 0; __pyx_t_2 = __pyx_t_10(__pyx_t_3); if (unlikely(!__pyx_t_2)) goto __pyx_L15_unpacking_failed;
    __Pyx_GOTREF(__pyx_t_2);
    index = 1; __pyx_t_6 = __pyx_t_10(__pyx_t_3); if (unlikely(!__pyx_t_6)) goto __pyx_L15_unpacking_failed;
    __Pyx_GOTREF(__pyx_t_6);
    if (__Pyx_IternextUnpackEndCheck(__pyx_t_10(__pyx_t_3), 2) < 0) __PYX_ERR(0, 1844, __pyx_L1_error)
    __pyx_t_10 = NULL;
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    goto __pyx_L16_unpacking_done;
    __pyx_L15_unpacking_failed:;
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_10 = NULL;
    if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
    __PYX_ERR(0, 1844, __pyx_L1_error)
    __pyx_L16_unpacking_done:;
  }
  __Pyx_XDECREF_SET(__pyx_v_window_size, __pyx_t_2);
  __pyx_t_2 = 0;
  __Pyx_XDECREF_SET(__pyx_v_window_size_qc, __pyx_t_6);
  __pyx_t_6 = 0;

  /* "vapor_vali/Simple_function.pyx":1845
 *     ref_seq=ref_seq_readin(ref,sv_info[0],sv_info[1]-flank_length,sv_info[1]+flank_length)
 *     [window_size,window_size_qc]=window_size_refine(ref_seq)
 *     if not window_size=='Error':             # <<<<<<<<<<<<<<
 *         alt_seq=ref_seq[:flank_length]+ref_seq_readin(ref,sv_info[0],sv_info[2]-flank_length,sv_info[2],'TRUE')
 *         [window_size,window_size_qc]=window_size_refine(alt_seq)
 */
  __pyx_t_11 = (__Pyx_PyString_Equals(__pyx_v_window_size, __pyx_n_s_Error, Py_EQ)); if (unlikely(__pyx_t_11 < 0)) __PYX_ERR(0, 1845, __pyx_L1_error)
  __pyx_t_5 = ((!__pyx_t_11) != 0);
  if (__pyx_t_5) {

    /* "vapor_vali/Simple_function.pyx":1846
 *     [window_size,window_size_qc]=window_size_refine(ref_seq)
 *     if not window_size=='Error':
 *         alt_seq=ref_seq[:flank_length]+ref_seq_readin(ref,sv_info[0],sv_info[2]-flank_length,sv_info[2],'TRUE')             # <<<<<<<<<<<<<<
 *         [window_size,window_size_qc]=window_size_refine(alt_seq)
 *         if not window_size=='Error':
 */
    __pyx_t_7 = __Pyx_PyObject_GetSlice(__pyx_v_ref_seq, 0, 0, NULL, &__pyx_v_flank_length, NULL, 0, 0, 1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1846, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_ref_seq_readin); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1846, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_sv_info, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1846, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_sv_info, 2, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1846, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_12 = PyNumber_Subtract(__pyx_t_1, __pyx_v_flank_length); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1846, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_12);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_sv_info, 2, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1846, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_9 = NULL;
    __pyx_t_8 = 0;
    if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_2))) {
      __pyx_t_9 = PyMethod_GET_SELF(__pyx_t_2);
      if (likely(__pyx_t_9)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
        __Pyx_INCREF(__pyx_t_9);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_2, function);
        __pyx_t_8 = 1;
      }
    }
    __pyx_t_4 = PyTuple_New(5+__pyx_t_8); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1846, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    if (__pyx_t_9) {
      __Pyx_GIVEREF(__pyx_t_9); PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_9); __pyx_t_9 = NULL;
    }
    __Pyx_INCREF(__pyx_v_ref);
    __Pyx_GIVEREF(__pyx_v_ref);
    PyTuple_SET_ITEM(__pyx_t_4, 0+__pyx_t_8, __pyx_v_ref);
    __Pyx_GIVEREF(__pyx_t_3);
    PyTuple_SET_ITEM(__pyx_t_4, 1+__pyx_t_8, __pyx_t_3);
    __Pyx_GIVEREF(__pyx_t_12);
    PyTuple_SET_ITEM(__pyx_t_4, 2+__pyx_t_8, __pyx_t_12);
    __Pyx_GIVEREF(__pyx_t_1);
    PyTuple_SET_ITEM(__pyx_t_4, 3+__pyx_t_8, __pyx_t_1);
    __Pyx_INCREF(__pyx_n_s_TRUE);
    __Pyx_GIVEREF(__pyx_n_s_TRUE);
    PyTuple_SET_ITEM(__pyx_t_4, 4+__pyx_t_8, __pyx_n_s_TRUE);
    __pyx_t_3 = 0;
    __pyx_t_12 = 0;
    __pyx_t_1 = 0;
    __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_4, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1846, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = PyNumber_Add(__pyx_t_7, __pyx_t_6); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1846, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    __Pyx_XDECREF_SET(__pyx_v_alt_seq, __pyx_t_2);
    __pyx_t_2 = 0;

    /* "vapor_vali/Simple_function.pyx":1847
 *     if not window_size=='Error':
 *         alt_seq=ref_seq[:flank_length]+ref_seq_readin(ref,sv_info[0],sv_info[2]-flank_length,sv_info[2],'TRUE')
 *         [window_size,window_size_qc]=window_size_refine(alt_seq)             # <<<<<<<<<<<<<<
 *         if not window_size=='Error':
 *             all_reads=simple_del_chop_pacbio_read_simple_short(bam_in,sv_info,flank_length)
 */
    __pyx_t_6 = __Pyx_GetModuleGlobalName(__pyx_n_s_window_size_refine); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1847, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __pyx_t_7 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_6))) {
      __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_6);
      if (likely(__pyx_t_7)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
        __Pyx_INCREF(__pyx_t_7);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_6, function);
      }
    }
    if (!__pyx_t_7) {
      __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_v_alt_seq); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1847, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
    } else {
      __pyx_t_4 = PyTuple_New(1+1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1847, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      __Pyx_GIVEREF(__pyx_t_7); PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_7); __pyx_t_7 = NULL;
      __Pyx_INCREF(__pyx_v_alt_seq);
      __Pyx_GIVEREF(__pyx_v_alt_seq);
      PyTuple_SET_ITEM(__pyx_t_4, 0+1, __pyx_v_alt_seq);
      __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_4, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1847, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    }
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    if ((likely(PyTuple_CheckExact(__pyx_t_2))) || (PyList_CheckExact(__pyx_t_2))) {
      PyObject* sequence = __pyx_t_2;
      #if CYTHON_COMPILING_IN_CPYTHON
      Py_ssize_t size = Py_SIZE(sequence);
      #else
      Py_ssize_t size = PySequence_Size(sequence);
      #endif
      if (unlikely(size != 2)) {
        if (size > 2) __Pyx_RaiseTooManyValuesError(2);
        else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
        __PYX_ERR(0, 1847, __pyx_L1_error)
      }
      #if CYTHON_COMPILING_IN_CPYTHON
      if (likely(PyTuple_CheckExact(sequence))) {
        __pyx_t_6 = PyTuple_GET_ITEM(sequence, 0); 
        __pyx_t_4 = PyTuple_GET_ITEM(sequence, 1); 
      } else {
        __pyx_t_6 = PyList_GET_ITEM(sequence, 0); 
        __pyx_t_4 = PyList_GET_ITEM(sequence, 1); 
      }
      __Pyx_INCREF(__pyx_t_6);
      __Pyx_INCREF(__pyx_t_4);
      #else
      __pyx_t_6 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1847, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_6);
      __pyx_t_4 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1847, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      #endif
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    } else {
      Py_ssize_t index = -1;
      __pyx_t_7 = PyObject_GetIter(__pyx_t_2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1847, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_7);
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_10 = Py_TYPE(__pyx_t_7)->tp_iternext;
      index = 0; __pyx_t_6 = __pyx_t_10(__pyx_t_7); if (unlikely(!__pyx_t_6)) goto __pyx_L18_unpacking_failed;
      __Pyx_GOTREF(__pyx_t_6);
      index = 1; __pyx_t_4 = __pyx_t_10(__pyx_t_7); if (unlikely(!__pyx_t_4)) goto __pyx_L18_unpacking_failed;
      __Pyx_GOTREF(__pyx_t_4);
      if (__Pyx_IternextUnpackEndCheck(__pyx_t_10(__pyx_t_7), 2) < 0) __PYX_ERR(0, 1847, __pyx_L1_error)
      __pyx_t_10 = NULL;
      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
      goto __pyx_L19_unpacking_done;
      __pyx_L18_unpacking_failed:;
      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
      __pyx_t_10 = NULL;
      if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
      __PYX_ERR(0, 1847, __pyx_L1_error)
      __pyx_L19_unpacking_done:;
    }
    __Pyx_DECREF_SET(__pyx_v_window_size, __pyx_t_6);
    __pyx_t_6 = 0;
    __Pyx_DECREF_SET(__pyx_v_window_size_qc, __pyx_t_4);
    __pyx_t_4 = 0;

    /* "vapor_vali/Simple_function.pyx":1848
 *         alt_seq=ref_seq[:flank_length]+ref_seq_readin(ref,sv_info[0],sv_info[2]-flank_length,sv_info[2],'TRUE')
 *         [window_size,window_size_qc]=window_size_refine(alt_seq)
 *         if not window_size=='Error':             # <<<<<<<<<<<<<<
 *             all_reads=simple_del_chop_pacbio_read_simple_short(bam_in,sv_info,flank_length)
 *             if len(all_reads)>0:
 */
    __pyx_t_5 = (__Pyx_PyString_Equals(__pyx_v_window_size, __pyx_n_s_Error, Py_EQ)); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 1848, __pyx_L1_error)
    __pyx_t_11 = ((!__pyx_t_5) != 0);
    if (__pyx_t_11) {

      /* "vapor_vali/Simple_function.pyx":1849
 *         [window_size,window_size_qc]=window_size_refine(alt_seq)
 *         if not window_size=='Error':
 *             all_reads=simple_del_chop_pacbio_read_simple_short(bam_in,sv_info,flank_length)             # <<<<<<<<<<<<<<
 *             if len(all_reads)>0:
 *                 best_read_rec=''
 */
      __pyx_t_4 = __Pyx_GetModuleGlobalName(__pyx_n_s_simple_del_chop_pacbio_read_simp); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1849, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_t_6 = NULL;
      __pyx_t_8 = 0;
      if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_4))) {
        __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_4);
        if (likely(__pyx_t_6)) {
          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
          __Pyx_INCREF(__pyx_t_6);
          __Pyx_INCREF(function);
          __Pyx_DECREF_SET(__pyx_t_4, function);
          __pyx_t_8 = 1;
        }
      }
      __pyx_t_7 = PyTuple_New(3+__pyx_t_8); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1849, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_7);
      if (__pyx_t_6) {
        __Pyx_GIVEREF(__pyx_t_6); PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_6); __pyx_t_6 = NULL;
      }
      __Pyx_INCREF(__pyx_v_bam_in);
      __Pyx_GIVEREF(__pyx_v_bam_in);
      PyTuple_SET_ITEM(__pyx_t_7, 0+__pyx_t_8, __pyx_v_bam_in);
      __Pyx_INCREF(__pyx_v_sv_info);
      __Pyx_GIVEREF(__pyx_v_sv_info);
      PyTuple_SET_ITEM(__pyx_t_7, 1+__pyx_t_8, __pyx_v_sv_info);
      __Pyx_INCREF(__pyx_v_flank_length);
      __Pyx_GIVEREF(__pyx_v_flank_length);
      PyTuple_SET_ITEM(__pyx_t_7, 2+__pyx_t_8, __pyx_v_flank_length);
      __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_7, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1849, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      __Pyx_XDECREF_SET(__pyx_v_all_reads, __pyx_t_2);
      __pyx_t_2 = 0;

      /* "vapor_vali/Simple_function.pyx":1850
 *         if not window_size=='Error':
 *             all_reads=simple_del_chop_pacbio_read_simple_short(bam_in,sv_info,flank_length)
 *             if len(all_reads)>0:             # <<<<<<<<<<<<<<
 *                 best_read_rec=''
 *                 for x in all_reads:
 */
      __pyx_t_8 = PyObject_Length(__pyx_v_all_reads); if (unlikely(__pyx_t_8 == -1)) __PYX_ERR(0, 1850, __pyx_L1_error)
      __pyx_t_11 = ((__pyx_t_8 > 0) != 0);
      if (__pyx_t_11) {

        /* "vapor_vali/Simple_function.pyx":1851
 *             all_reads=simple_del_chop_pacbio_read_simple_short(bam_in,sv_info,flank_length)
 *             if len(all_reads)>0:
 *                 best_read_rec=''             # <<<<<<<<<<<<<<
 *                 for x in all_reads:
 *                     vapor_single_read_score=calcu_vapor_single_read_score_within_10Perc_m1b(ref_seq,alt_seq,x,window_size)
 */
        __Pyx_INCREF(__pyx_kp_s__24);
        __Pyx_DECREF_SET(__pyx_v_best_read_rec, __pyx_kp_s__24);

        /* "vapor_vali/Simple_function.pyx":1852
 *             if len(all_reads)>0:
 *                 best_read_rec=''
 *                 for x in all_reads:             # <<<<<<<<<<<<<<
 *                     vapor_single_read_score=calcu_vapor_single_read_score_within_10Perc_m1b(ref_seq,alt_seq,x,window_size)
 *                     if not 0 in vapor_single_read_score:
 */
        if (likely(PyList_CheckExact(__pyx_v_all_reads)) || PyTuple_CheckExact(__pyx_v_all_reads)) {
          __pyx_t_2 = __pyx_v_all_reads; __Pyx_INCREF(__pyx_t_2); __pyx_t_8 = 0;
          __pyx_t_13 = NULL;
        } else {
          __pyx_t_8 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_v_all_reads); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1852, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_2);
          __pyx_t_13 = Py_TYPE(__pyx_t_2)->tp_iternext; if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1852, __pyx_L1_error)
        }
        for (;;) {
          if (likely(!__pyx_t_13)) {
            if (likely(PyList_CheckExact(__pyx_t_2))) {
              if (__pyx_t_8 >= PyList_GET_SIZE(__pyx_t_2)) break;
              #if CYTHON_COMPILING_IN_CPYTHON
              __pyx_t_4 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_8); __Pyx_INCREF(__pyx_t_4); __pyx_t_8++; if (unlikely(0 < 0)) __PYX_ERR(0, 1852, __pyx_L1_error)
              #else
              __pyx_t_4 = PySequence_ITEM(__pyx_t_2, __pyx_t_8); __pyx_t_8++; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1852, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_4);
              #endif
            } else {
              if (__pyx_t_8 >= PyTuple_GET_SIZE(__pyx_t_2)) break;
              #if CYTHON_COMPILING_IN_CPYTHON
              __pyx_t_4 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_8); __Pyx_INCREF(__pyx_t_4); __pyx_t_8++; if (unlikely(0 < 0)) __PYX_ERR(0, 1852, __pyx_L1_error)
              #else
              __pyx_t_4 = PySequence_ITEM(__pyx_t_2, __pyx_t_8); __pyx_t_8++; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1852, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_4);
              #endif
            }
          } else {
            __pyx_t_4 = __pyx_t_13(__pyx_t_2);
            if (unlikely(!__pyx_t_4)) {
              PyObject* exc_type = PyErr_Occurred();
              if (exc_type) {
                if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
                else __PYX_ERR(0, 1852, __pyx_L1_error)
              }
              break;
            }
            __Pyx_GOTREF(__pyx_t_4);
          }
          __Pyx_XDECREF_SET(__pyx_v_x, __pyx_t_4);
          __pyx_t_4 = 0;

          /* "vapor_vali/Simple_function.pyx":1853
 *                 best_read_rec=''
 *                 for x in all_reads:
 *                     vapor_single_read_score=calcu_vapor_single_read_score_within_10Perc_m1b(ref_seq,alt_seq,x,window_size)             # <<<<<<<<<<<<<<
 *                     if not 0 in vapor_single_read_score:
 *                         vapor_score_list.append(1-float(vapor_single_read_score[1])/float(vapor_single_read_score[0]))
 */
          __pyx_t_7 = __Pyx_GetModuleGlobalName(__pyx_n_s_calcu_vapor_single_read_score_wi); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1853, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_7);
          __pyx_t_6 = NULL;
          __pyx_t_14 = 0;
          if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_7))) {
            __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_7);
            if (likely(__pyx_t_6)) {
              PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_7);
              __Pyx_INCREF(__pyx_t_6);
              __Pyx_INCREF(function);
              __Pyx_DECREF_SET(__pyx_t_7, function);
              __pyx_t_14 = 1;
            }
          }
          __pyx_t_1 = PyTuple_New(4+__pyx_t_14); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1853, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_1);
          if (__pyx_t_6) {
            __Pyx_GIVEREF(__pyx_t_6); PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_6); __pyx_t_6 = NULL;
          }
          __Pyx_INCREF(__pyx_v_ref_seq);
          __Pyx_GIVEREF(__pyx_v_ref_seq);
          PyTuple_SET_ITEM(__pyx_t_1, 0+__pyx_t_14, __pyx_v_ref_seq);
          __Pyx_INCREF(__pyx_v_alt_seq);
          __Pyx_GIVEREF(__pyx_v_alt_seq);
          PyTuple_SET_ITEM(__pyx_t_1, 1+__pyx_t_14, __pyx_v_alt_seq);
          __Pyx_INCREF(__pyx_v_x);
          __Pyx_GIVEREF(__pyx_v_x);
          PyTuple_SET_ITEM(__pyx_t_1, 2+__pyx_t_14, __pyx_v_x);
          __Pyx_INCREF(__pyx_v_window_size);
          __Pyx_GIVEREF(__pyx_v_window_size);
          PyTuple_SET_ITEM(__pyx_t_1, 3+__pyx_t_14, __pyx_v_window_size);
          __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_7, __pyx_t_1, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1853, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_4);
          __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
          __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
          __Pyx_XDECREF_SET(__pyx_v_vapor_single_read_score, __pyx_t_4);
          __pyx_t_4 = 0;

          /* "vapor_vali/Simple_function.pyx":1854
 *                 for x in all_reads:
 *                     vapor_single_read_score=calcu_vapor_single_read_score_within_10Perc_m1b(ref_seq,alt_seq,x,window_size)
 *                     if not 0 in vapor_single_read_score:             # <<<<<<<<<<<<<<
 *                         vapor_score_list.append(1-float(vapor_single_read_score[1])/float(vapor_single_read_score[0]))
 *                         if vapor_score_list[-1]==max(vapor_score_list):best_read_rec=x
 */
          __pyx_t_11 = (__Pyx_PySequence_ContainsTF(__pyx_int_0, __pyx_v_vapor_single_read_score, Py_NE)); if (unlikely(__pyx_t_11 < 0)) __PYX_ERR(0, 1854, __pyx_L1_error)
          __pyx_t_5 = (__pyx_t_11 != 0);
          if (__pyx_t_5) {

            /* "vapor_vali/Simple_function.pyx":1855
 *                     vapor_single_read_score=calcu_vapor_single_read_score_within_10Perc_m1b(ref_seq,alt_seq,x,window_size)
 *                     if not 0 in vapor_single_read_score:
 *                         vapor_score_list.append(1-float(vapor_single_read_score[1])/float(vapor_single_read_score[0]))             # <<<<<<<<<<<<<<
 *                         if vapor_score_list[-1]==max(vapor_score_list):best_read_rec=x
 *                 make_event_figure_1(vapor_score_list,best_read_rec,window_size,ref_seq,alt_seq,out_figure_name)
 */
            __pyx_t_4 = __Pyx_GetItemInt(__pyx_v_vapor_single_read_score, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1855, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_4);
            __pyx_t_16 = __Pyx_PyObject_AsDouble(__pyx_t_4); if (unlikely(__pyx_t_16 == ((double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1855, __pyx_L1_error)
            __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
            __pyx_t_4 = __Pyx_GetItemInt(__pyx_v_vapor_single_read_score, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1855, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_4);
            __pyx_t_15 = __Pyx_PyObject_AsDouble(__pyx_t_4); if (unlikely(__pyx_t_15 == ((double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1855, __pyx_L1_error)
            __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
            if (unlikely(__pyx_t_15 == 0)) {
              PyErr_SetString(PyExc_ZeroDivisionError, "float division");
              __PYX_ERR(0, 1855, __pyx_L1_error)
            }
            __pyx_t_4 = PyFloat_FromDouble((1.0 - (__pyx_t_16 / __pyx_t_15))); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1855, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_4);
            __pyx_t_17 = __Pyx_PyList_Append(__pyx_v_vapor_score_list, __pyx_t_4); if (unlikely(__pyx_t_17 == -1)) __PYX_ERR(0, 1855, __pyx_L1_error)
            __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;

            /* "vapor_vali/Simple_function.pyx":1856
 *                     if not 0 in vapor_single_read_score:
 *                         vapor_score_list.append(1-float(vapor_single_read_score[1])/float(vapor_single_read_score[0]))
 *                         if vapor_score_list[-1]==max(vapor_score_list):best_read_rec=x             # <<<<<<<<<<<<<<
 *                 make_event_figure_1(vapor_score_list,best_read_rec,window_size,ref_seq,alt_seq,out_figure_name)
 *     return vapor_score_list
 */
            __pyx_t_4 = __Pyx_GetItemInt_List(__pyx_v_vapor_score_list, -1L, long, 1, __Pyx_PyInt_From_long, 1, 1, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1856, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_4);
            __pyx_t_7 = PyTuple_New(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1856, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_7);
            __Pyx_INCREF(__pyx_v_vapor_score_list);
            __Pyx_GIVEREF(__pyx_v_vapor_score_list);
            PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_v_vapor_score_list);
            __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_max, __pyx_t_7, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1856, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_1);
            __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
            __pyx_t_7 = PyObject_RichCompare(__pyx_t_4, __pyx_t_1, Py_EQ); __Pyx_XGOTREF(__pyx_t_7); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1856, __pyx_L1_error)
            __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
            __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
            __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_7); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 1856, __pyx_L1_error)
            __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
            if (__pyx_t_5) {
              __Pyx_INCREF(__pyx_v_x);
              __Pyx_DECREF_SET(__pyx_v_best_read_rec, __pyx_v_x);
            }

            /* "vapor_vali/Simple_function.pyx":1854
 *                 for x in all_reads:
 *                     vapor_single_read_score=calcu_vapor_single_read_score_within_10Perc_m1b(ref_seq,alt_seq,x,window_size)
 *                     if not 0 in vapor_single_read_score:             # <<<<<<<<<<<<<<
 *                         vapor_score_list.append(1-float(vapor_single_read_score[1])/float(vapor_single_read_score[0]))
 *                         if vapor_score_list[-1]==max(vapor_score_list):best_read_rec=x
 */
          }

          /* "vapor_vali/Simple_function.pyx":1852
 *             if len(all_reads)>0:
 *                 best_read_rec=''
 *                 for x in all_reads:             # <<<<<<<<<<<<<<
 *                     vapor_single_read_score=calcu_vapor_single_read_score_within_10Perc_m1b(ref_seq,alt_seq,x,window_size)
 *                     if not 0 in vapor_single_read_score:
 */
        }
        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

        /* "vapor_vali/Simple_function.pyx":1857
 *                         vapor_score_list.append(1-float(vapor_single_read_score[1])/float(vapor_single_read_score[0]))
 *                         if vapor_score_list[-1]==max(vapor_score_list):best_read_rec=x
 *                 make_event_figure_1(vapor_score_list,best_read_rec,window_size,ref_seq,alt_seq,out_figure_name)             # <<<<<<<<<<<<<<
 *     return vapor_score_list
 * 
 */
        __pyx_t_7 = __Pyx_GetModuleGlobalName(__pyx_n_s_make_event_figure_1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1857, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_7);
        __pyx_t_1 = NULL;
        __pyx_t_8 = 0;
        if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_7))) {
          __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_7);
          if (likely(__pyx_t_1)) {
            PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_7);
            __Pyx_INCREF(__pyx_t_1);
            __Pyx_INCREF(function);
            __Pyx_DECREF_SET(__pyx_t_7, function);
            __pyx_t_8 = 1;
          }
        }
        __pyx_t_4 = PyTuple_New(6+__pyx_t_8); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1857, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_4);
        if (__pyx_t_1) {
          __Pyx_GIVEREF(__pyx_t_1); PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_1); __pyx_t_1 = NULL;
        }
        __Pyx_INCREF(__pyx_v_vapor_score_list);
        __Pyx_GIVEREF(__pyx_v_vapor_score_list);
        PyTuple_SET_ITEM(__pyx_t_4, 0+__pyx_t_8, __pyx_v_vapor_score_list);
        __Pyx_INCREF(__pyx_v_best_read_rec);
        __Pyx_GIVEREF(__pyx_v_best_read_rec);
        PyTuple_SET_ITEM(__pyx_t_4, 1+__pyx_t_8, __pyx_v_best_read_rec);
        __Pyx_INCREF(__pyx_v_window_size);
        __Pyx_GIVEREF(__pyx_v_window_size);
        PyTuple_SET_ITEM(__pyx_t_4, 2+__pyx_t_8, __pyx_v_window_size);
        __Pyx_INCREF(__pyx_v_ref_seq);
        __Pyx_GIVEREF(__pyx_v_ref_seq);
        PyTuple_SET_ITEM(__pyx_t_4, 3+__pyx_t_8, __pyx_v_ref_seq);
        __Pyx_INCREF(__pyx_v_alt_seq);
        __Pyx_GIVEREF(__pyx_v_alt_seq);
        PyTuple_SET_ITEM(__pyx_t_4, 4+__pyx_t_8, __pyx_v_alt_seq);
        __Pyx_INCREF(__pyx_v_out_figure_name);
        __Pyx_GIVEREF(__pyx_v_out_figure_name);
        PyTuple_SET_ITEM(__pyx_t_4, 5+__pyx_t_8, __pyx_v_out_figure_name);
        __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_7, __pyx_t_4, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1857, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
        __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
        __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

        /* "vapor_vali/Simple_function.pyx":1850
 *         if not window_size=='Error':
 *             all_reads=simple_del_chop_pacbio_read_simple_short(bam_in,sv_info,flank_length)
 *             if len(all_reads)>0:             # <<<<<<<<<<<<<<
 *                 best_read_rec=''
 *                 for x in all_reads:
 */
      }

      /* "vapor_vali/Simple_function.pyx":1848
 *         alt_seq=ref_seq[:flank_length]+ref_seq_readin(ref,sv_info[0],sv_info[2]-flank_length,sv_info[2],'TRUE')
 *         [window_size,window_size_qc]=window_size_refine(alt_seq)
 *         if not window_size=='Error':             # <<<<<<<<<<<<<<
 *             all_reads=simple_del_chop_pacbio_read_simple_short(bam_in,sv_info,flank_length)
 *             if len(all_reads)>0:
 */
    }

    /* "vapor_vali/Simple_function.pyx":1845
 *     ref_seq=ref_seq_readin(ref,sv_info[0],sv_info[1]-flank_length,sv_info[1]+flank_length)
 *     [window_size,window_size_qc]=window_size_refine(ref_seq)
 *     if not window_size=='Error':             # <<<<<<<<<<<<<<
 *         alt_seq=ref_seq[:flank_length]+ref_seq_readin(ref,sv_info[0],sv_info[2]-flank_length,sv_info[2],'TRUE')
 *         [window_size,window_size_qc]=window_size_refine(alt_seq)
 */
  }

  /* "vapor_vali/Simple_function.pyx":1858
 *                         if vapor_score_list[-1]==max(vapor_score_list):best_read_rec=x
 *                 make_event_figure_1(vapor_score_list,best_read_rec,window_size,ref_seq,alt_seq,out_figure_name)
 *     return vapor_score_list             # <<<<<<<<<<<<<<
 * 
 * def vcf_rec_hash_modify(vcf_rec_hash):
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_vapor_score_list);
  __pyx_r = __pyx_v_vapor_score_list;
  goto __pyx_L0;

  /* "vapor_vali/Simple_function.pyx":1821
 *     return vapor_score_list
 * 
 * def vapor_simple_inv_Vapor(bam_in,ref,sv_info,out_figure_name):             # <<<<<<<<<<<<<<
 *     #eg of sv_info=['chr1', 101553562, 101553905]
 *     flank_length=flank_length_calculate(sv_info)
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_XDECREF(__pyx_t_7);
  __Pyx_XDECREF(__pyx_t_9);
  __Pyx_XDECREF(__pyx_t_12);
  __Pyx_AddTraceback("vapor_vali.Simple_function.vapor_simple_inv_Vapor", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_flank_length);
  __Pyx_XDECREF(__pyx_v_vapor_score_list);
  __Pyx_XDECREF(__pyx_v_best_read_rec);
  __Pyx_XDECREF(__pyx_v_ref_seq);
  __Pyx_XDECREF(__pyx_v_window_size);
  __Pyx_XDECREF(__pyx_v_window_size_qc);
  __Pyx_XDECREF(__pyx_v_alt_seq);
  __Pyx_XDECREF(__pyx_v_all_reads);
  __Pyx_XDECREF(__pyx_v_x);
  __Pyx_XDECREF(__pyx_v_vapor_single_read_score);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "vapor_vali/Simple_function.pyx":1860
 *     return vapor_score_list
 * 
 * def vcf_rec_hash_modify(vcf_rec_hash):             # <<<<<<<<<<<<<<
 *     out={}
 *     for k1 in list(vcf_rec_hash.keys()):
 */

/* Python wrapper */
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_219vcf_rec_hash_modify(PyObject *__pyx_self, PyObject *__pyx_v_vcf_rec_hash); /*proto*/
static PyMethodDef __pyx_mdef_10vapor_vali_15Simple_function_219vcf_rec_hash_modify = {"vcf_rec_hash_modify", (PyCFunction)__pyx_pw_10vapor_vali_15Simple_function_219vcf_rec_hash_modify, METH_O, 0};
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_219vcf_rec_hash_modify(PyObject *__pyx_self, PyObject *__pyx_v_vcf_rec_hash) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("vcf_rec_hash_modify (wrapper)", 0);
  __pyx_r = __pyx_pf_10vapor_vali_15Simple_function_218vcf_rec_hash_modify(__pyx_self, ((PyObject *)__pyx_v_vcf_rec_hash));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10vapor_vali_15Simple_function_218vcf_rec_hash_modify(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_vcf_rec_hash) {
  PyObject *__pyx_v_out = NULL;
  PyObject *__pyx_v_k1 = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  Py_ssize_t __pyx_t_4;
  PyObject *__pyx_t_5 = NULL;
  int __pyx_t_6;
  int __pyx_t_7;
  int __pyx_t_8;
  __Pyx_RefNannySetupContext("vcf_rec_hash_modify", 0);

  /* "vapor_vali/Simple_function.pyx":1861
 * 
 * def vcf_rec_hash_modify(vcf_rec_hash):
 *     out={}             # <<<<<<<<<<<<<<
 *     for k1 in list(vcf_rec_hash.keys()):
 *         if not vcf_rec_hash[k1] in list(out.keys()):  out[vcf_rec_hash[k1]]=[]
 */
  __pyx_t_1 = PyDict_New(); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1861, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_out = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":1862
 * def vcf_rec_hash_modify(vcf_rec_hash):
 *     out={}
 *     for k1 in list(vcf_rec_hash.keys()):             # <<<<<<<<<<<<<<
 *         if not vcf_rec_hash[k1] in list(out.keys()):  out[vcf_rec_hash[k1]]=[]
 *         out[vcf_rec_hash[k1]].append(k1)
 */
  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_vcf_rec_hash, __pyx_n_s_keys); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1862, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_3);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_2, function);
    }
  }
  if (__pyx_t_3) {
    __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1862, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  } else {
    __pyx_t_1 = __Pyx_PyObject_CallNoArg(__pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1862, __pyx_L1_error)
  }
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = PySequence_List(__pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1862, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __pyx_t_2; __Pyx_INCREF(__pyx_t_1); __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  for (;;) {
    if (__pyx_t_4 >= PyList_GET_SIZE(__pyx_t_1)) break;
    #if CYTHON_COMPILING_IN_CPYTHON
    __pyx_t_2 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_4); __Pyx_INCREF(__pyx_t_2); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 1862, __pyx_L1_error)
    #else
    __pyx_t_2 = PySequence_ITEM(__pyx_t_1, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1862, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    #endif
    __Pyx_XDECREF_SET(__pyx_v_k1, __pyx_t_2);
    __pyx_t_2 = 0;

    /* "vapor_vali/Simple_function.pyx":1863
 *     out={}
 *     for k1 in list(vcf_rec_hash.keys()):
 *         if not vcf_rec_hash[k1] in list(out.keys()):  out[vcf_rec_hash[k1]]=[]             # <<<<<<<<<<<<<<
 *         out[vcf_rec_hash[k1]].append(k1)
 *     return out
 */
    __pyx_t_2 = PyObject_GetItem(__pyx_v_vcf_rec_hash, __pyx_v_k1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1863, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_3 = __Pyx_PyDict_Keys(__pyx_v_out); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1863, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_5 = PySequence_List(__pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1863, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_6 = (__Pyx_PySequence_ContainsTF(__pyx_t_2, __pyx_t_5, Py_NE)); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 1863, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_7 = (__pyx_t_6 != 0);
    if (__pyx_t_7) {
      __pyx_t_5 = PyList_New(0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1863, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_5);
      __pyx_t_2 = PyObject_GetItem(__pyx_v_vcf_rec_hash, __pyx_v_k1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1863, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      if (unlikely(PyDict_SetItem(__pyx_v_out, __pyx_t_2, __pyx_t_5) < 0)) __PYX_ERR(0, 1863, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    }

    /* "vapor_vali/Simple_function.pyx":1864
 *     for k1 in list(vcf_rec_hash.keys()):
 *         if not vcf_rec_hash[k1] in list(out.keys()):  out[vcf_rec_hash[k1]]=[]
 *         out[vcf_rec_hash[k1]].append(k1)             # <<<<<<<<<<<<<<
 *     return out
 * 
 */
    __pyx_t_5 = PyObject_GetItem(__pyx_v_vcf_rec_hash, __pyx_v_k1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1864, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __pyx_t_2 = __Pyx_PyDict_GetItem(__pyx_v_out, __pyx_t_5); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1864, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_8 = __Pyx_PyObject_Append(__pyx_t_2, __pyx_v_k1); if (unlikely(__pyx_t_8 == -1)) __PYX_ERR(0, 1864, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

    /* "vapor_vali/Simple_function.pyx":1862
 * def vcf_rec_hash_modify(vcf_rec_hash):
 *     out={}
 *     for k1 in list(vcf_rec_hash.keys()):             # <<<<<<<<<<<<<<
 *         if not vcf_rec_hash[k1] in list(out.keys()):  out[vcf_rec_hash[k1]]=[]
 *         out[vcf_rec_hash[k1]].append(k1)
 */
  }
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":1865
 *         if not vcf_rec_hash[k1] in list(out.keys()):  out[vcf_rec_hash[k1]]=[]
 *         out[vcf_rec_hash[k1]].append(k1)
 *     return out             # <<<<<<<<<<<<<<
 * 
 * def vcf_vapor_modify(vcf_input,vcf_rec_hash_new):
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_out);
  __pyx_r = __pyx_v_out;
  goto __pyx_L0;

  /* "vapor_vali/Simple_function.pyx":1860
 *     return vapor_score_list
 * 
 * def vcf_rec_hash_modify(vcf_rec_hash):             # <<<<<<<<<<<<<<
 *     out={}
 *     for k1 in list(vcf_rec_hash.keys()):
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_AddTraceback("vapor_vali.Simple_function.vcf_rec_hash_modify", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_out);
  __Pyx_XDECREF(__pyx_v_k1);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "vapor_vali/Simple_function.pyx":1867
 *     return out
 * 
 * def vcf_vapor_modify(vcf_input,vcf_rec_hash_new):             # <<<<<<<<<<<<<<
 *     vapor_input=vcf_input+'.vapor'
 *     vapor_rec={}
 */

/* Python wrapper */
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_221vcf_vapor_modify(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_10vapor_vali_15Simple_function_221vcf_vapor_modify = {"vcf_vapor_modify", (PyCFunction)__pyx_pw_10vapor_vali_15Simple_function_221vcf_vapor_modify, METH_VARARGS|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_221vcf_vapor_modify(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_vcf_input = 0;
  PyObject *__pyx_v_vcf_rec_hash_new = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("vcf_vapor_modify (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_vcf_input,&__pyx_n_s_vcf_rec_hash_new,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_vcf_input)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_vcf_rec_hash_new)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("vcf_vapor_modify", 1, 2, 2, 1); __PYX_ERR(0, 1867, __pyx_L3_error)
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "vcf_vapor_modify") < 0)) __PYX_ERR(0, 1867, __pyx_L3_error)
      }
    } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
    }
    __pyx_v_vcf_input = values[0];
    __pyx_v_vcf_rec_hash_new = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("vcf_vapor_modify", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1867, __pyx_L3_error)
  __pyx_L3_error:;
  __Pyx_AddTraceback("vapor_vali.Simple_function.vcf_vapor_modify", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_10vapor_vali_15Simple_function_220vcf_vapor_modify(__pyx_self, __pyx_v_vcf_input, __pyx_v_vcf_rec_hash_new);

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10vapor_vali_15Simple_function_220vcf_vapor_modify(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_vcf_input, PyObject *__pyx_v_vcf_rec_hash_new) {
  PyObject *__pyx_v_vapor_input = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_vapor_rec = NULL;
  PyObject *__pyx_v_fin = NULL;
  PyObject *__pyx_v_vcf_info_hash = NULL;
  PyObject *__pyx_v_rec = NULL;
  PyObject *__pyx_v_line = NULL;
  PyObject *__pyx_v_pin = NULL;
  PyObject *__pyx_v_keep_rec = NULL;
  PyObject *__pyx_v_sv_rec_label = NULL;
  PyObject *__pyx_v_y = NULL;
  PyObject *__pyx_v_fo = NULL;
  PyObject *__pyx_v_k1 = NULL;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  Py_ssize_t __pyx_t_3;
  PyObject *(*__pyx_t_4)(PyObject *);
  PyObject *__pyx_t_5 = NULL;
  PyObject *__pyx_t_6 = NULL;
  PyObject *__pyx_t_7 = NULL;
  int __pyx_t_8;
  int __pyx_t_9;
  Py_ssize_t __pyx_t_10;
  PyObject *(*__pyx_t_11)(PyObject *);
  PyObject *__pyx_t_12 = NULL;
  PyObject *__pyx_t_13 = NULL;
  Py_ssize_t __pyx_t_14;
  PyObject *(*__pyx_t_15)(PyObject *);
  PyObject *__pyx_t_16 = NULL;
  PyObject *__pyx_t_17 = NULL;
  int __pyx_t_18;
  __Pyx_RefNannySetupContext("vcf_vapor_modify", 0);

  /* "vapor_vali/Simple_function.pyx":1868
 * 
 * def vcf_vapor_modify(vcf_input,vcf_rec_hash_new):
 *     vapor_input=vcf_input+'.vapor'             # <<<<<<<<<<<<<<
 *     vapor_rec={}
 *     fin=open(vcf_input)
 */
  __pyx_t_1 = PyNumber_Add(__pyx_v_vcf_input, __pyx_kp_s_vapor); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1868, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_vapor_input = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":1869
 * def vcf_vapor_modify(vcf_input,vcf_rec_hash_new):
 *     vapor_input=vcf_input+'.vapor'
 *     vapor_rec={}             # <<<<<<<<<<<<<<
 *     fin=open(vcf_input)
 *     vcf_info_hash={}
 */
  __pyx_t_1 = PyDict_New(); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1869, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_vapor_rec = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":1870
 *     vapor_input=vcf_input+'.vapor'
 *     vapor_rec={}
 *     fin=open(vcf_input)             # <<<<<<<<<<<<<<
 *     vcf_info_hash={}
 *     rec=-1
 */
  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1870, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_INCREF(__pyx_v_vcf_input);
  __Pyx_GIVEREF(__pyx_v_vcf_input);
  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_vcf_input);
  __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_open, __pyx_t_1, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1870, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_fin = __pyx_t_2;
  __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":1871
 *     vapor_rec={}
 *     fin=open(vcf_input)
 *     vcf_info_hash={}             # <<<<<<<<<<<<<<
 *     rec=-1
 *     for line in fin:
 */
  __pyx_t_2 = PyDict_New(); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1871, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_v_vcf_info_hash = ((PyObject*)__pyx_t_2);
  __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":1872
 *     fin=open(vcf_input)
 *     vcf_info_hash={}
 *     rec=-1             # <<<<<<<<<<<<<<
 *     for line in fin:
 *         rec+=1
 */
  __Pyx_INCREF(__pyx_int_neg_1);
  __pyx_v_rec = __pyx_int_neg_1;

  /* "vapor_vali/Simple_function.pyx":1873
 *     vcf_info_hash={}
 *     rec=-1
 *     for line in fin:             # <<<<<<<<<<<<<<
 *         rec+=1
 *         pin=line.strip().split()
 */
  if (likely(PyList_CheckExact(__pyx_v_fin)) || PyTuple_CheckExact(__pyx_v_fin)) {
    __pyx_t_2 = __pyx_v_fin; __Pyx_INCREF(__pyx_t_2); __pyx_t_3 = 0;
    __pyx_t_4 = NULL;
  } else {
    __pyx_t_3 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_v_fin); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1873, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_4 = Py_TYPE(__pyx_t_2)->tp_iternext; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1873, __pyx_L1_error)
  }
  for (;;) {
    if (likely(!__pyx_t_4)) {
      if (likely(PyList_CheckExact(__pyx_t_2))) {
        if (__pyx_t_3 >= PyList_GET_SIZE(__pyx_t_2)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_1 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_3); __Pyx_INCREF(__pyx_t_1); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 1873, __pyx_L1_error)
        #else
        __pyx_t_1 = PySequence_ITEM(__pyx_t_2, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1873, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        #endif
      } else {
        if (__pyx_t_3 >= PyTuple_GET_SIZE(__pyx_t_2)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_3); __Pyx_INCREF(__pyx_t_1); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 1873, __pyx_L1_error)
        #else
        __pyx_t_1 = PySequence_ITEM(__pyx_t_2, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1873, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        #endif
      }
    } else {
      __pyx_t_1 = __pyx_t_4(__pyx_t_2);
      if (unlikely(!__pyx_t_1)) {
        PyObject* exc_type = PyErr_Occurred();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
          else __PYX_ERR(0, 1873, __pyx_L1_error)
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_1);
    }
    __Pyx_XDECREF_SET(__pyx_v_line, __pyx_t_1);
    __pyx_t_1 = 0;

    /* "vapor_vali/Simple_function.pyx":1874
 *     rec=-1
 *     for line in fin:
 *         rec+=1             # <<<<<<<<<<<<<<
 *         pin=line.strip().split()
 *         if not pin[0][0]=='#':
 */
    __pyx_t_1 = __Pyx_PyInt_AddObjC(__pyx_v_rec, __pyx_int_1, 1, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1874, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF_SET(__pyx_v_rec, __pyx_t_1);
    __pyx_t_1 = 0;

    /* "vapor_vali/Simple_function.pyx":1875
 *     for line in fin:
 *         rec+=1
 *         pin=line.strip().split()             # <<<<<<<<<<<<<<
 *         if not pin[0][0]=='#':
 *             if pin[6]=='PASS':
 */
    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_line, __pyx_n_s_strip); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1875, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __pyx_t_7 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_6))) {
      __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_6);
      if (likely(__pyx_t_7)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
        __Pyx_INCREF(__pyx_t_7);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_6, function);
      }
    }
    if (__pyx_t_7) {
      __pyx_t_5 = __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_7); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1875, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
    } else {
      __pyx_t_5 = __Pyx_PyObject_CallNoArg(__pyx_t_6); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1875, __pyx_L1_error)
    }
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_split); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1875, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_6))) {
      __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_6);
      if (likely(__pyx_t_5)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
        __Pyx_INCREF(__pyx_t_5);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_6, function);
      }
    }
    if (__pyx_t_5) {
      __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1875, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    } else {
      __pyx_t_1 = __Pyx_PyObject_CallNoArg(__pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1875, __pyx_L1_error)
    }
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    __Pyx_XDECREF_SET(__pyx_v_pin, __pyx_t_1);
    __pyx_t_1 = 0;

    /* "vapor_vali/Simple_function.pyx":1876
 *         rec+=1
 *         pin=line.strip().split()
 *         if not pin[0][0]=='#':             # <<<<<<<<<<<<<<
 *             if pin[6]=='PASS':
 *                 vcf_info_hash[rec]=pin
 */
    __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_pin, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1876, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_6 = __Pyx_GetItemInt(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1876, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_8 = (__Pyx_PyString_Equals(__pyx_t_6, __pyx_kp_s__157, Py_EQ)); if (unlikely(__pyx_t_8 < 0)) __PYX_ERR(0, 1876, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_9 = ((!__pyx_t_8) != 0);
    if (__pyx_t_9) {

      /* "vapor_vali/Simple_function.pyx":1877
 *         pin=line.strip().split()
 *         if not pin[0][0]=='#':
 *             if pin[6]=='PASS':             # <<<<<<<<<<<<<<
 *                 vcf_info_hash[rec]=pin
 *     fin.close()
 */
      __pyx_t_6 = __Pyx_GetItemInt(__pyx_v_pin, 6, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1877, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_6);
      __pyx_t_9 = (__Pyx_PyString_Equals(__pyx_t_6, __pyx_n_s_PASS, Py_EQ)); if (unlikely(__pyx_t_9 < 0)) __PYX_ERR(0, 1877, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
      if (__pyx_t_9) {

        /* "vapor_vali/Simple_function.pyx":1878
 *         if not pin[0][0]=='#':
 *             if pin[6]=='PASS':
 *                 vcf_info_hash[rec]=pin             # <<<<<<<<<<<<<<
 *     fin.close()
 *     fin=open(vapor_input)
 */
        if (unlikely(PyDict_SetItem(__pyx_v_vcf_info_hash, __pyx_v_rec, __pyx_v_pin) < 0)) __PYX_ERR(0, 1878, __pyx_L1_error)

        /* "vapor_vali/Simple_function.pyx":1877
 *         pin=line.strip().split()
 *         if not pin[0][0]=='#':
 *             if pin[6]=='PASS':             # <<<<<<<<<<<<<<
 *                 vcf_info_hash[rec]=pin
 *     fin.close()
 */
      }

      /* "vapor_vali/Simple_function.pyx":1876
 *         rec+=1
 *         pin=line.strip().split()
 *         if not pin[0][0]=='#':             # <<<<<<<<<<<<<<
 *             if pin[6]=='PASS':
 *                 vcf_info_hash[rec]=pin
 */
    }

    /* "vapor_vali/Simple_function.pyx":1873
 *     vcf_info_hash={}
 *     rec=-1
 *     for line in fin:             # <<<<<<<<<<<<<<
 *         rec+=1
 *         pin=line.strip().split()
 */
  }
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":1879
 *             if pin[6]=='PASS':
 *                 vcf_info_hash[rec]=pin
 *     fin.close()             # <<<<<<<<<<<<<<
 *     fin=open(vapor_input)
 *     keep_rec=[]
 */
  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_fin, __pyx_n_s_close); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1879, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_1 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_6))) {
    __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_6);
    if (likely(__pyx_t_1)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
      __Pyx_INCREF(__pyx_t_1);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_6, function);
    }
  }
  if (__pyx_t_1) {
    __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1879, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  } else {
    __pyx_t_2 = __Pyx_PyObject_CallNoArg(__pyx_t_6); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1879, __pyx_L1_error)
  }
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":1880
 *                 vcf_info_hash[rec]=pin
 *     fin.close()
 *     fin=open(vapor_input)             # <<<<<<<<<<<<<<
 *     keep_rec=[]
 *     for line in fin:
 */
  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1880, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_INCREF(__pyx_v_vapor_input);
  __Pyx_GIVEREF(__pyx_v_vapor_input);
  PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_v_vapor_input);
  __pyx_t_6 = __Pyx_PyObject_Call(__pyx_builtin_open, __pyx_t_2, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1880, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __Pyx_DECREF_SET(__pyx_v_fin, __pyx_t_6);
  __pyx_t_6 = 0;

  /* "vapor_vali/Simple_function.pyx":1881
 *     fin.close()
 *     fin=open(vapor_input)
 *     keep_rec=[]             # <<<<<<<<<<<<<<
 *     for line in fin:
 *         pin=line.strip().split()
 */
  __pyx_t_6 = PyList_New(0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1881, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_v_keep_rec = ((PyObject*)__pyx_t_6);
  __pyx_t_6 = 0;

  /* "vapor_vali/Simple_function.pyx":1882
 *     fin=open(vapor_input)
 *     keep_rec=[]
 *     for line in fin:             # <<<<<<<<<<<<<<
 *         pin=line.strip().split()
 *         if pin[0] in list(vcf_rec_hash_new.keys()):
 */
  if (likely(PyList_CheckExact(__pyx_v_fin)) || PyTuple_CheckExact(__pyx_v_fin)) {
    __pyx_t_6 = __pyx_v_fin; __Pyx_INCREF(__pyx_t_6); __pyx_t_3 = 0;
    __pyx_t_4 = NULL;
  } else {
    __pyx_t_3 = -1; __pyx_t_6 = PyObject_GetIter(__pyx_v_fin); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1882, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __pyx_t_4 = Py_TYPE(__pyx_t_6)->tp_iternext; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1882, __pyx_L1_error)
  }
  for (;;) {
    if (likely(!__pyx_t_4)) {
      if (likely(PyList_CheckExact(__pyx_t_6))) {
        if (__pyx_t_3 >= PyList_GET_SIZE(__pyx_t_6)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_2 = PyList_GET_ITEM(__pyx_t_6, __pyx_t_3); __Pyx_INCREF(__pyx_t_2); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 1882, __pyx_L1_error)
        #else
        __pyx_t_2 = PySequence_ITEM(__pyx_t_6, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1882, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
        #endif
      } else {
        if (__pyx_t_3 >= PyTuple_GET_SIZE(__pyx_t_6)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_2 = PyTuple_GET_ITEM(__pyx_t_6, __pyx_t_3); __Pyx_INCREF(__pyx_t_2); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 1882, __pyx_L1_error)
        #else
        __pyx_t_2 = PySequence_ITEM(__pyx_t_6, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1882, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
        #endif
      }
    } else {
      __pyx_t_2 = __pyx_t_4(__pyx_t_6);
      if (unlikely(!__pyx_t_2)) {
        PyObject* exc_type = PyErr_Occurred();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
          else __PYX_ERR(0, 1882, __pyx_L1_error)
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_2);
    }
    __Pyx_XDECREF_SET(__pyx_v_line, __pyx_t_2);
    __pyx_t_2 = 0;

    /* "vapor_vali/Simple_function.pyx":1883
 *     keep_rec=[]
 *     for line in fin:
 *         pin=line.strip().split()             # <<<<<<<<<<<<<<
 *         if pin[0] in list(vcf_rec_hash_new.keys()):
 *             sv_rec_label=vcf_rec_hash_new[pin[0]]
 */
    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_line, __pyx_n_s_strip); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1883, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __pyx_t_7 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_5))) {
      __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_5);
      if (likely(__pyx_t_7)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
        __Pyx_INCREF(__pyx_t_7);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_5, function);
      }
    }
    if (__pyx_t_7) {
      __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_t_7); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1883, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
    } else {
      __pyx_t_1 = __Pyx_PyObject_CallNoArg(__pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1883, __pyx_L1_error)
    }
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_split); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1883, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_5))) {
      __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_5);
      if (likely(__pyx_t_1)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
        __Pyx_INCREF(__pyx_t_1);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_5, function);
      }
    }
    if (__pyx_t_1) {
      __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1883, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    } else {
      __pyx_t_2 = __Pyx_PyObject_CallNoArg(__pyx_t_5); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1883, __pyx_L1_error)
    }
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    __Pyx_XDECREF_SET(__pyx_v_pin, __pyx_t_2);
    __pyx_t_2 = 0;

    /* "vapor_vali/Simple_function.pyx":1884
 *     for line in fin:
 *         pin=line.strip().split()
 *         if pin[0] in list(vcf_rec_hash_new.keys()):             # <<<<<<<<<<<<<<
 *             sv_rec_label=vcf_rec_hash_new[pin[0]]
 *             for y in sv_rec_label:
 */
    __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_pin, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1884, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_vcf_rec_hash_new, __pyx_n_s_keys); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1884, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_7 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_1))) {
      __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_1);
      if (likely(__pyx_t_7)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
        __Pyx_INCREF(__pyx_t_7);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_1, function);
      }
    }
    if (__pyx_t_7) {
      __pyx_t_5 = __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_t_7); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1884, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
    } else {
      __pyx_t_5 = __Pyx_PyObject_CallNoArg(__pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1884, __pyx_L1_error)
    }
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = PySequence_List(__pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1884, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_9 = (__Pyx_PySequence_ContainsTF(__pyx_t_2, __pyx_t_1, Py_EQ)); if (unlikely(__pyx_t_9 < 0)) __PYX_ERR(0, 1884, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_8 = (__pyx_t_9 != 0);
    if (__pyx_t_8) {

      /* "vapor_vali/Simple_function.pyx":1885
 *         pin=line.strip().split()
 *         if pin[0] in list(vcf_rec_hash_new.keys()):
 *             sv_rec_label=vcf_rec_hash_new[pin[0]]             # <<<<<<<<<<<<<<
 *             for y in sv_rec_label:
 *                 vcf_info_hash[y]+=[round(float(i),2) if not i=='NA' else i for i in pin[1:3]]
 */
      __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_pin, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1885, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __pyx_t_2 = PyObject_GetItem(__pyx_v_vcf_rec_hash_new, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1885, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      __Pyx_XDECREF_SET(__pyx_v_sv_rec_label, __pyx_t_2);
      __pyx_t_2 = 0;

      /* "vapor_vali/Simple_function.pyx":1886
 *         if pin[0] in list(vcf_rec_hash_new.keys()):
 *             sv_rec_label=vcf_rec_hash_new[pin[0]]
 *             for y in sv_rec_label:             # <<<<<<<<<<<<<<
 *                 vcf_info_hash[y]+=[round(float(i),2) if not i=='NA' else i for i in pin[1:3]]
 *                 keep_rec.append(y)
 */
      if (likely(PyList_CheckExact(__pyx_v_sv_rec_label)) || PyTuple_CheckExact(__pyx_v_sv_rec_label)) {
        __pyx_t_2 = __pyx_v_sv_rec_label; __Pyx_INCREF(__pyx_t_2); __pyx_t_10 = 0;
        __pyx_t_11 = NULL;
      } else {
        __pyx_t_10 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_v_sv_rec_label); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1886, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
        __pyx_t_11 = Py_TYPE(__pyx_t_2)->tp_iternext; if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1886, __pyx_L1_error)
      }
      for (;;) {
        if (likely(!__pyx_t_11)) {
          if (likely(PyList_CheckExact(__pyx_t_2))) {
            if (__pyx_t_10 >= PyList_GET_SIZE(__pyx_t_2)) break;
            #if CYTHON_COMPILING_IN_CPYTHON
            __pyx_t_1 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_10); __Pyx_INCREF(__pyx_t_1); __pyx_t_10++; if (unlikely(0 < 0)) __PYX_ERR(0, 1886, __pyx_L1_error)
            #else
            __pyx_t_1 = PySequence_ITEM(__pyx_t_2, __pyx_t_10); __pyx_t_10++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1886, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_1);
            #endif
          } else {
            if (__pyx_t_10 >= PyTuple_GET_SIZE(__pyx_t_2)) break;
            #if CYTHON_COMPILING_IN_CPYTHON
            __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_10); __Pyx_INCREF(__pyx_t_1); __pyx_t_10++; if (unlikely(0 < 0)) __PYX_ERR(0, 1886, __pyx_L1_error)
            #else
            __pyx_t_1 = PySequence_ITEM(__pyx_t_2, __pyx_t_10); __pyx_t_10++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1886, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_1);
            #endif
          }
        } else {
          __pyx_t_1 = __pyx_t_11(__pyx_t_2);
          if (unlikely(!__pyx_t_1)) {
            PyObject* exc_type = PyErr_Occurred();
            if (exc_type) {
              if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
              else __PYX_ERR(0, 1886, __pyx_L1_error)
            }
            break;
          }
          __Pyx_GOTREF(__pyx_t_1);
        }
        __Pyx_XDECREF_SET(__pyx_v_y, __pyx_t_1);
        __pyx_t_1 = 0;

        /* "vapor_vali/Simple_function.pyx":1887
 *             sv_rec_label=vcf_rec_hash_new[pin[0]]
 *             for y in sv_rec_label:
 *                 vcf_info_hash[y]+=[round(float(i),2) if not i=='NA' else i for i in pin[1:3]]             # <<<<<<<<<<<<<<
 *                 keep_rec.append(y)
 *     fin.close()
 */
        __Pyx_INCREF(__pyx_v_y);
        __pyx_t_1 = __pyx_v_y;
        __pyx_t_5 = __Pyx_PyDict_GetItem(__pyx_v_vcf_info_hash, __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1887, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_5);
        __pyx_t_7 = PyList_New(0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1887, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_7);
        __pyx_t_12 = __Pyx_PyObject_GetSlice(__pyx_v_pin, 1, 3, NULL, NULL, &__pyx_slice__158, 1, 1, 1); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1887, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_12);
        if (likely(PyList_CheckExact(__pyx_t_12)) || PyTuple_CheckExact(__pyx_t_12)) {
          __pyx_t_13 = __pyx_t_12; __Pyx_INCREF(__pyx_t_13); __pyx_t_14 = 0;
          __pyx_t_15 = NULL;
        } else {
          __pyx_t_14 = -1; __pyx_t_13 = PyObject_GetIter(__pyx_t_12); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1887, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_13);
          __pyx_t_15 = Py_TYPE(__pyx_t_13)->tp_iternext; if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1887, __pyx_L1_error)
        }
        __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
        for (;;) {
          if (likely(!__pyx_t_15)) {
            if (likely(PyList_CheckExact(__pyx_t_13))) {
              if (__pyx_t_14 >= PyList_GET_SIZE(__pyx_t_13)) break;
              #if CYTHON_COMPILING_IN_CPYTHON
              __pyx_t_12 = PyList_GET_ITEM(__pyx_t_13, __pyx_t_14); __Pyx_INCREF(__pyx_t_12); __pyx_t_14++; if (unlikely(0 < 0)) __PYX_ERR(0, 1887, __pyx_L1_error)
              #else
              __pyx_t_12 = PySequence_ITEM(__pyx_t_13, __pyx_t_14); __pyx_t_14++; if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1887, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_12);
              #endif
            } else {
              if (__pyx_t_14 >= PyTuple_GET_SIZE(__pyx_t_13)) break;
              #if CYTHON_COMPILING_IN_CPYTHON
              __pyx_t_12 = PyTuple_GET_ITEM(__pyx_t_13, __pyx_t_14); __Pyx_INCREF(__pyx_t_12); __pyx_t_14++; if (unlikely(0 < 0)) __PYX_ERR(0, 1887, __pyx_L1_error)
              #else
              __pyx_t_12 = PySequence_ITEM(__pyx_t_13, __pyx_t_14); __pyx_t_14++; if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1887, __pyx_L1_error)
              __Pyx_GOTREF(__pyx_t_12);
              #endif
            }
          } else {
            __pyx_t_12 = __pyx_t_15(__pyx_t_13);
            if (unlikely(!__pyx_t_12)) {
              PyObject* exc_type = PyErr_Occurred();
              if (exc_type) {
                if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
                else __PYX_ERR(0, 1887, __pyx_L1_error)
              }
              break;
            }
            __Pyx_GOTREF(__pyx_t_12);
          }
          __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_12);
          __pyx_t_12 = 0;
          __pyx_t_8 = (__Pyx_PyString_Equals(__pyx_v_i, __pyx_n_s_NA, Py_EQ)); if (unlikely(__pyx_t_8 < 0)) __PYX_ERR(0, 1887, __pyx_L1_error)
          if (((!__pyx_t_8) != 0)) {
            __pyx_t_16 = __Pyx_PyNumber_Float(__pyx_v_i); if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 1887, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_16);
            __pyx_t_17 = PyTuple_New(2); if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 1887, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_17);
            __Pyx_GIVEREF(__pyx_t_16);
            PyTuple_SET_ITEM(__pyx_t_17, 0, __pyx_t_16);
            __Pyx_INCREF(__pyx_int_2);
            __Pyx_GIVEREF(__pyx_int_2);
            PyTuple_SET_ITEM(__pyx_t_17, 1, __pyx_int_2);
            __pyx_t_16 = 0;
            __pyx_t_16 = __Pyx_PyObject_Call(__pyx_builtin_round, __pyx_t_17, NULL); if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 1887, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_16);
            __Pyx_DECREF(__pyx_t_17); __pyx_t_17 = 0;
            __pyx_t_12 = __pyx_t_16;
            __pyx_t_16 = 0;
          } else {
            __Pyx_INCREF(__pyx_v_i);
            __pyx_t_12 = __pyx_v_i;
          }
          if (unlikely(__Pyx_ListComp_Append(__pyx_t_7, (PyObject*)__pyx_t_12))) __PYX_ERR(0, 1887, __pyx_L1_error)
          __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
        }
        __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
        __pyx_t_13 = PyNumber_InPlaceAdd(__pyx_t_5, __pyx_t_7); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1887, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_13);
        __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
        __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
        if (unlikely(PyDict_SetItem(__pyx_v_vcf_info_hash, __pyx_t_1, __pyx_t_13) < 0)) __PYX_ERR(0, 1887, __pyx_L1_error)
        __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

        /* "vapor_vali/Simple_function.pyx":1888
 *             for y in sv_rec_label:
 *                 vcf_info_hash[y]+=[round(float(i),2) if not i=='NA' else i for i in pin[1:3]]
 *                 keep_rec.append(y)             # <<<<<<<<<<<<<<
 *     fin.close()
 *     fo=open(vapor_input,'w')
 */
        __pyx_t_18 = __Pyx_PyList_Append(__pyx_v_keep_rec, __pyx_v_y); if (unlikely(__pyx_t_18 == -1)) __PYX_ERR(0, 1888, __pyx_L1_error)

        /* "vapor_vali/Simple_function.pyx":1886
 *         if pin[0] in list(vcf_rec_hash_new.keys()):
 *             sv_rec_label=vcf_rec_hash_new[pin[0]]
 *             for y in sv_rec_label:             # <<<<<<<<<<<<<<
 *                 vcf_info_hash[y]+=[round(float(i),2) if not i=='NA' else i for i in pin[1:3]]
 *                 keep_rec.append(y)
 */
      }
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

      /* "vapor_vali/Simple_function.pyx":1884
 *     for line in fin:
 *         pin=line.strip().split()
 *         if pin[0] in list(vcf_rec_hash_new.keys()):             # <<<<<<<<<<<<<<
 *             sv_rec_label=vcf_rec_hash_new[pin[0]]
 *             for y in sv_rec_label:
 */
    }

    /* "vapor_vali/Simple_function.pyx":1882
 *     fin=open(vapor_input)
 *     keep_rec=[]
 *     for line in fin:             # <<<<<<<<<<<<<<
 *         pin=line.strip().split()
 *         if pin[0] in list(vcf_rec_hash_new.keys()):
 */
  }
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

  /* "vapor_vali/Simple_function.pyx":1889
 *                 vcf_info_hash[y]+=[round(float(i),2) if not i=='NA' else i for i in pin[1:3]]
 *                 keep_rec.append(y)
 *     fin.close()             # <<<<<<<<<<<<<<
 *     fo=open(vapor_input,'w')
 *     print('\t'.join(['#CHROM','POS','ID','REF','ALT','QUAL','FILTER','INFO','FORMAT','SAMPLE','VaPoR_value','VaPoR_geno']), file=fo)
 */
  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_fin, __pyx_n_s_close); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1889, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_1 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_2);
    if (likely(__pyx_t_1)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_1);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_2, function);
    }
  }
  if (__pyx_t_1) {
    __pyx_t_6 = __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1889, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  } else {
    __pyx_t_6 = __Pyx_PyObject_CallNoArg(__pyx_t_2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1889, __pyx_L1_error)
  }
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

  /* "vapor_vali/Simple_function.pyx":1890
 *                 keep_rec.append(y)
 *     fin.close()
 *     fo=open(vapor_input,'w')             # <<<<<<<<<<<<<<
 *     print('\t'.join(['#CHROM','POS','ID','REF','ALT','QUAL','FILTER','INFO','FORMAT','SAMPLE','VaPoR_value','VaPoR_geno']), file=fo)
 *     for k1 in sorted(vcf_info_hash.keys()):
 */
  __pyx_t_6 = PyTuple_New(2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1890, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_INCREF(__pyx_v_vapor_input);
  __Pyx_GIVEREF(__pyx_v_vapor_input);
  PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_v_vapor_input);
  __Pyx_INCREF(__pyx_n_s_w);
  __Pyx_GIVEREF(__pyx_n_s_w);
  PyTuple_SET_ITEM(__pyx_t_6, 1, __pyx_n_s_w);
  __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_open, __pyx_t_6, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1890, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_v_fo = __pyx_t_2;
  __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":1891
 *     fin.close()
 *     fo=open(vapor_input,'w')
 *     print('\t'.join(['#CHROM','POS','ID','REF','ALT','QUAL','FILTER','INFO','FORMAT','SAMPLE','VaPoR_value','VaPoR_geno']), file=fo)             # <<<<<<<<<<<<<<
 *     for k1 in sorted(vcf_info_hash.keys()):
 *         if k1 in keep_rec:
 */
  __pyx_t_2 = PyList_New(12); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1891, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_INCREF(__pyx_kp_s_CHROM);
  __Pyx_GIVEREF(__pyx_kp_s_CHROM);
  PyList_SET_ITEM(__pyx_t_2, 0, __pyx_kp_s_CHROM);
  __Pyx_INCREF(__pyx_n_s_POS);
  __Pyx_GIVEREF(__pyx_n_s_POS);
  PyList_SET_ITEM(__pyx_t_2, 1, __pyx_n_s_POS);
  __Pyx_INCREF(__pyx_n_s_ID);
  __Pyx_GIVEREF(__pyx_n_s_ID);
  PyList_SET_ITEM(__pyx_t_2, 2, __pyx_n_s_ID);
  __Pyx_INCREF(__pyx_n_s_REF);
  __Pyx_GIVEREF(__pyx_n_s_REF);
  PyList_SET_ITEM(__pyx_t_2, 3, __pyx_n_s_REF);
  __Pyx_INCREF(__pyx_n_s_ALT);
  __Pyx_GIVEREF(__pyx_n_s_ALT);
  PyList_SET_ITEM(__pyx_t_2, 4, __pyx_n_s_ALT);
  __Pyx_INCREF(__pyx_n_s_QUAL);
  __Pyx_GIVEREF(__pyx_n_s_QUAL);
  PyList_SET_ITEM(__pyx_t_2, 5, __pyx_n_s_QUAL);
  __Pyx_INCREF(__pyx_n_s_FILTER);
  __Pyx_GIVEREF(__pyx_n_s_FILTER);
  PyList_SET_ITEM(__pyx_t_2, 6, __pyx_n_s_FILTER);
  __Pyx_INCREF(__pyx_n_s_INFO);
  __Pyx_GIVEREF(__pyx_n_s_INFO);
  PyList_SET_ITEM(__pyx_t_2, 7, __pyx_n_s_INFO);
  __Pyx_INCREF(__pyx_n_s_FORMAT);
  __Pyx_GIVEREF(__pyx_n_s_FORMAT);
  PyList_SET_ITEM(__pyx_t_2, 8, __pyx_n_s_FORMAT);
  __Pyx_INCREF(__pyx_n_s_SAMPLE);
  __Pyx_GIVEREF(__pyx_n_s_SAMPLE);
  PyList_SET_ITEM(__pyx_t_2, 9, __pyx_n_s_SAMPLE);
  __Pyx_INCREF(__pyx_n_s_VaPoR_value);
  __Pyx_GIVEREF(__pyx_n_s_VaPoR_value);
  PyList_SET_ITEM(__pyx_t_2, 10, __pyx_n_s_VaPoR_value);
  __Pyx_INCREF(__pyx_n_s_VaPoR_geno);
  __Pyx_GIVEREF(__pyx_n_s_VaPoR_geno);
  PyList_SET_ITEM(__pyx_t_2, 11, __pyx_n_s_VaPoR_geno);
  __pyx_t_6 = __Pyx_PyString_Join(__pyx_kp_s__159, __pyx_t_2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1891, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1891, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_GIVEREF(__pyx_t_6);
  PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_6);
  __pyx_t_6 = 0;
  __pyx_t_6 = PyDict_New(); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1891, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  if (PyDict_SetItem(__pyx_t_6, __pyx_n_s_file, __pyx_v_fo) < 0) __PYX_ERR(0, 1891, __pyx_L1_error)
  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_print, __pyx_t_2, __pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1891, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":1892
 *     fo=open(vapor_input,'w')
 *     print('\t'.join(['#CHROM','POS','ID','REF','ALT','QUAL','FILTER','INFO','FORMAT','SAMPLE','VaPoR_value','VaPoR_geno']), file=fo)
 *     for k1 in sorted(vcf_info_hash.keys()):             # <<<<<<<<<<<<<<
 *         if k1 in keep_rec:
 *             print('\t'.join([str(i) for i in vcf_info_hash[k1]]), file=fo)
 */
  __pyx_t_6 = __Pyx_PyDict_Keys(__pyx_v_vcf_info_hash); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1892, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_2 = PySequence_List(__pyx_t_6); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1892, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_1 = ((PyObject*)__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_18 = PyList_Sort(__pyx_t_1); if (unlikely(__pyx_t_18 == -1)) __PYX_ERR(0, 1892, __pyx_L1_error)
  if (unlikely(__pyx_t_1 == Py_None)) {
    PyErr_SetString(PyExc_TypeError, "'NoneType' object is not iterable");
    __PYX_ERR(0, 1892, __pyx_L1_error)
  }
  __pyx_t_2 = __pyx_t_1; __Pyx_INCREF(__pyx_t_2); __pyx_t_3 = 0;
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  for (;;) {
    if (__pyx_t_3 >= PyList_GET_SIZE(__pyx_t_2)) break;
    #if CYTHON_COMPILING_IN_CPYTHON
    __pyx_t_1 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_3); __Pyx_INCREF(__pyx_t_1); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 1892, __pyx_L1_error)
    #else
    __pyx_t_1 = PySequence_ITEM(__pyx_t_2, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1892, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    #endif
    __Pyx_XDECREF_SET(__pyx_v_k1, __pyx_t_1);
    __pyx_t_1 = 0;

    /* "vapor_vali/Simple_function.pyx":1893
 *     print('\t'.join(['#CHROM','POS','ID','REF','ALT','QUAL','FILTER','INFO','FORMAT','SAMPLE','VaPoR_value','VaPoR_geno']), file=fo)
 *     for k1 in sorted(vcf_info_hash.keys()):
 *         if k1 in keep_rec:             # <<<<<<<<<<<<<<
 *             print('\t'.join([str(i) for i in vcf_info_hash[k1]]), file=fo)
 *     fo.close()
 */
    __pyx_t_8 = (__Pyx_PySequence_ContainsTF(__pyx_v_k1, __pyx_v_keep_rec, Py_EQ)); if (unlikely(__pyx_t_8 < 0)) __PYX_ERR(0, 1893, __pyx_L1_error)
    __pyx_t_9 = (__pyx_t_8 != 0);
    if (__pyx_t_9) {

      /* "vapor_vali/Simple_function.pyx":1894
 *     for k1 in sorted(vcf_info_hash.keys()):
 *         if k1 in keep_rec:
 *             print('\t'.join([str(i) for i in vcf_info_hash[k1]]), file=fo)             # <<<<<<<<<<<<<<
 *     fo.close()
 * 
 */
      __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1894, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __pyx_t_6 = __Pyx_PyDict_GetItem(__pyx_v_vcf_info_hash, __pyx_v_k1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1894, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_6);
      if (likely(PyList_CheckExact(__pyx_t_6)) || PyTuple_CheckExact(__pyx_t_6)) {
        __pyx_t_13 = __pyx_t_6; __Pyx_INCREF(__pyx_t_13); __pyx_t_10 = 0;
        __pyx_t_4 = NULL;
      } else {
        __pyx_t_10 = -1; __pyx_t_13 = PyObject_GetIter(__pyx_t_6); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1894, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_13);
        __pyx_t_4 = Py_TYPE(__pyx_t_13)->tp_iternext; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1894, __pyx_L1_error)
      }
      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
      for (;;) {
        if (likely(!__pyx_t_4)) {
          if (likely(PyList_CheckExact(__pyx_t_13))) {
            if (__pyx_t_10 >= PyList_GET_SIZE(__pyx_t_13)) break;
            #if CYTHON_COMPILING_IN_CPYTHON
            __pyx_t_6 = PyList_GET_ITEM(__pyx_t_13, __pyx_t_10); __Pyx_INCREF(__pyx_t_6); __pyx_t_10++; if (unlikely(0 < 0)) __PYX_ERR(0, 1894, __pyx_L1_error)
            #else
            __pyx_t_6 = PySequence_ITEM(__pyx_t_13, __pyx_t_10); __pyx_t_10++; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1894, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_6);
            #endif
          } else {
            if (__pyx_t_10 >= PyTuple_GET_SIZE(__pyx_t_13)) break;
            #if CYTHON_COMPILING_IN_CPYTHON
            __pyx_t_6 = PyTuple_GET_ITEM(__pyx_t_13, __pyx_t_10); __Pyx_INCREF(__pyx_t_6); __pyx_t_10++; if (unlikely(0 < 0)) __PYX_ERR(0, 1894, __pyx_L1_error)
            #else
            __pyx_t_6 = PySequence_ITEM(__pyx_t_13, __pyx_t_10); __pyx_t_10++; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1894, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_6);
            #endif
          }
        } else {
          __pyx_t_6 = __pyx_t_4(__pyx_t_13);
          if (unlikely(!__pyx_t_6)) {
            PyObject* exc_type = PyErr_Occurred();
            if (exc_type) {
              if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
              else __PYX_ERR(0, 1894, __pyx_L1_error)
            }
            break;
          }
          __Pyx_GOTREF(__pyx_t_6);
        }
        __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_6);
        __pyx_t_6 = 0;
        __pyx_t_6 = PyTuple_New(1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1894, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_6);
        __Pyx_INCREF(__pyx_v_i);
        __Pyx_GIVEREF(__pyx_v_i);
        PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_v_i);
        __pyx_t_7 = __Pyx_PyObject_Call(((PyObject *)(&PyString_Type)), __pyx_t_6, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1894, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_7);
        __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
        if (unlikely(__Pyx_ListComp_Append(__pyx_t_1, (PyObject*)__pyx_t_7))) __PYX_ERR(0, 1894, __pyx_L1_error)
        __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
      }
      __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
      __pyx_t_13 = __Pyx_PyString_Join(__pyx_kp_s__159, __pyx_t_1); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1894, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_13);
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1894, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_GIVEREF(__pyx_t_13);
      PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_13);
      __pyx_t_13 = 0;
      __pyx_t_13 = PyDict_New(); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1894, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_13);
      if (PyDict_SetItem(__pyx_t_13, __pyx_n_s_file, __pyx_v_fo) < 0) __PYX_ERR(0, 1894, __pyx_L1_error)
      __pyx_t_7 = __Pyx_PyObject_Call(__pyx_builtin_print, __pyx_t_1, __pyx_t_13); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1894, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_7);
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;

      /* "vapor_vali/Simple_function.pyx":1893
 *     print('\t'.join(['#CHROM','POS','ID','REF','ALT','QUAL','FILTER','INFO','FORMAT','SAMPLE','VaPoR_value','VaPoR_geno']), file=fo)
 *     for k1 in sorted(vcf_info_hash.keys()):
 *         if k1 in keep_rec:             # <<<<<<<<<<<<<<
 *             print('\t'.join([str(i) for i in vcf_info_hash[k1]]), file=fo)
 *     fo.close()
 */
    }

    /* "vapor_vali/Simple_function.pyx":1892
 *     fo=open(vapor_input,'w')
 *     print('\t'.join(['#CHROM','POS','ID','REF','ALT','QUAL','FILTER','INFO','FORMAT','SAMPLE','VaPoR_value','VaPoR_geno']), file=fo)
 *     for k1 in sorted(vcf_info_hash.keys()):             # <<<<<<<<<<<<<<
 *         if k1 in keep_rec:
 *             print('\t'.join([str(i) for i in vcf_info_hash[k1]]), file=fo)
 */
  }
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":1895
 *         if k1 in keep_rec:
 *             print('\t'.join([str(i) for i in vcf_info_hash[k1]]), file=fo)
 *     fo.close()             # <<<<<<<<<<<<<<
 * 
 * def window_size_refine(seq2,region_QC_Cff=0.4):
 */
  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_fo, __pyx_n_s_close); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1895, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  __pyx_t_13 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_7))) {
    __pyx_t_13 = PyMethod_GET_SELF(__pyx_t_7);
    if (likely(__pyx_t_13)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_7);
      __Pyx_INCREF(__pyx_t_13);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_7, function);
    }
  }
  if (__pyx_t_13) {
    __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_t_7, __pyx_t_13); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1895, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
  } else {
    __pyx_t_2 = __Pyx_PyObject_CallNoArg(__pyx_t_7); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1895, __pyx_L1_error)
  }
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":1867
 *     return out
 * 
 * def vcf_vapor_modify(vcf_input,vcf_rec_hash_new):             # <<<<<<<<<<<<<<
 *     vapor_input=vcf_input+'.vapor'
 *     vapor_rec={}
 */

  /* function exit code */
  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_XDECREF(__pyx_t_7);
  __Pyx_XDECREF(__pyx_t_12);
  __Pyx_XDECREF(__pyx_t_13);
  __Pyx_XDECREF(__pyx_t_16);
  __Pyx_XDECREF(__pyx_t_17);
  __Pyx_AddTraceback("vapor_vali.Simple_function.vcf_vapor_modify", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_vapor_input);
  __Pyx_XDECREF(__pyx_v_vapor_rec);
  __Pyx_XDECREF(__pyx_v_fin);
  __Pyx_XDECREF(__pyx_v_vcf_info_hash);
  __Pyx_XDECREF(__pyx_v_rec);
  __Pyx_XDECREF(__pyx_v_line);
  __Pyx_XDECREF(__pyx_v_pin);
  __Pyx_XDECREF(__pyx_v_keep_rec);
  __Pyx_XDECREF(__pyx_v_sv_rec_label);
  __Pyx_XDECREF(__pyx_v_y);
  __Pyx_XDECREF(__pyx_v_fo);
  __Pyx_XDECREF(__pyx_v_k1);
  __Pyx_XDECREF(__pyx_v_i);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "vapor_vali/Simple_function.pyx":1897
 *     fo.close()
 * 
 * def window_size_refine(seq2,region_QC_Cff=0.4):             # <<<<<<<<<<<<<<
 *     window_size=10
 *     if not seq2.count('N')+seq2.count('n')>100:
 */

/* Python wrapper */
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_223window_size_refine(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_10vapor_vali_15Simple_function_223window_size_refine = {"window_size_refine", (PyCFunction)__pyx_pw_10vapor_vali_15Simple_function_223window_size_refine, METH_VARARGS|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_223window_size_refine(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_seq2 = 0;
  PyObject *__pyx_v_region_QC_Cff = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("window_size_refine (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_seq2,&__pyx_n_s_region_QC_Cff,0};
    PyObject* values[2] = {0,0};
    values[1] = ((PyObject *)__pyx_float_0_4);
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_seq2)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (kw_args > 0) {
          PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_region_QC_Cff);
          if (value) { values[1] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "window_size_refine") < 0)) __PYX_ERR(0, 1897, __pyx_L3_error)
      }
    } else {
      switch (PyTuple_GET_SIZE(__pyx_args)) {
        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_seq2 = values[0];
    __pyx_v_region_QC_Cff = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("window_size_refine", 0, 1, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1897, __pyx_L3_error)
  __pyx_L3_error:;
  __Pyx_AddTraceback("vapor_vali.Simple_function.window_size_refine", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_10vapor_vali_15Simple_function_222window_size_refine(__pyx_self, __pyx_v_seq2, __pyx_v_region_QC_Cff);

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10vapor_vali_15Simple_function_222window_size_refine(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_seq2, PyObject *__pyx_v_region_QC_Cff) {
  PyObject *__pyx_v_window_size = NULL;
  PyObject *__pyx_v_dotdata_qual_check = NULL;
  PyObject *__pyx_v_region_QC = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  int __pyx_t_4;
  int __pyx_t_5;
  Py_ssize_t __pyx_t_6;
  PyObject *__pyx_t_7 = NULL;
  __Pyx_RefNannySetupContext("window_size_refine", 0);

  /* "vapor_vali/Simple_function.pyx":1898
 * 
 * def window_size_refine(seq2,region_QC_Cff=0.4):
 *     window_size=10             # <<<<<<<<<<<<<<
 *     if not seq2.count('N')+seq2.count('n')>100:
 *         dotdata_qual_check=dotdata(window_size,seq2,seq2)
 */
  __Pyx_INCREF(__pyx_int_10);
  __pyx_v_window_size = __pyx_int_10;

  /* "vapor_vali/Simple_function.pyx":1899
 * def window_size_refine(seq2,region_QC_Cff=0.4):
 *     window_size=10
 *     if not seq2.count('N')+seq2.count('n')>100:             # <<<<<<<<<<<<<<
 *         dotdata_qual_check=dotdata(window_size,seq2,seq2)
 *         if len(dotdata_qual_check)>0:
 */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_seq2, __pyx_n_s_count); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1899, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_tuple__160, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1899, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_seq2, __pyx_n_s_count); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1899, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_tuple__161, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1899, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = PyNumber_Add(__pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1899, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = PyObject_RichCompare(__pyx_t_1, __pyx_int_100, Py_GT); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1899, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 1899, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_5 = ((!__pyx_t_4) != 0);
  if (__pyx_t_5) {

    /* "vapor_vali/Simple_function.pyx":1900
 *     window_size=10
 *     if not seq2.count('N')+seq2.count('n')>100:
 *         dotdata_qual_check=dotdata(window_size,seq2,seq2)             # <<<<<<<<<<<<<<
 *         if len(dotdata_qual_check)>0:
 *             region_QC=qual_check_repetitive_region(dotdata_qual_check)
 */
    __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_dotdata); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1900, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_2 = NULL;
    __pyx_t_6 = 0;
    if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_1))) {
      __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_1);
      if (likely(__pyx_t_2)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
        __Pyx_INCREF(__pyx_t_2);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_1, function);
        __pyx_t_6 = 1;
      }
    }
    __pyx_t_7 = PyTuple_New(3+__pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1900, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    if (__pyx_t_2) {
      __Pyx_GIVEREF(__pyx_t_2); PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_2); __pyx_t_2 = NULL;
    }
    __Pyx_INCREF(__pyx_v_window_size);
    __Pyx_GIVEREF(__pyx_v_window_size);
    PyTuple_SET_ITEM(__pyx_t_7, 0+__pyx_t_6, __pyx_v_window_size);
    __Pyx_INCREF(__pyx_v_seq2);
    __Pyx_GIVEREF(__pyx_v_seq2);
    PyTuple_SET_ITEM(__pyx_t_7, 1+__pyx_t_6, __pyx_v_seq2);
    __Pyx_INCREF(__pyx_v_seq2);
    __Pyx_GIVEREF(__pyx_v_seq2);
    PyTuple_SET_ITEM(__pyx_t_7, 2+__pyx_t_6, __pyx_v_seq2);
    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_7, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1900, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_v_dotdata_qual_check = __pyx_t_3;
    __pyx_t_3 = 0;

    /* "vapor_vali/Simple_function.pyx":1901
 *     if not seq2.count('N')+seq2.count('n')>100:
 *         dotdata_qual_check=dotdata(window_size,seq2,seq2)
 *         if len(dotdata_qual_check)>0:             # <<<<<<<<<<<<<<
 *             region_QC=qual_check_repetitive_region(dotdata_qual_check)
 *             while True:
 */
    __pyx_t_6 = PyObject_Length(__pyx_v_dotdata_qual_check); if (unlikely(__pyx_t_6 == -1)) __PYX_ERR(0, 1901, __pyx_L1_error)
    __pyx_t_5 = ((__pyx_t_6 > 0) != 0);
    if (__pyx_t_5) {

      /* "vapor_vali/Simple_function.pyx":1902
 *         dotdata_qual_check=dotdata(window_size,seq2,seq2)
 *         if len(dotdata_qual_check)>0:
 *             region_QC=qual_check_repetitive_region(dotdata_qual_check)             # <<<<<<<<<<<<<<
 *             while True:
 *                 if window_size>30: break
 */
      __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_qual_check_repetitive_region); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1902, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __pyx_t_7 = NULL;
      if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_1))) {
        __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_1);
        if (likely(__pyx_t_7)) {
          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
          __Pyx_INCREF(__pyx_t_7);
          __Pyx_INCREF(function);
          __Pyx_DECREF_SET(__pyx_t_1, function);
        }
      }
      if (!__pyx_t_7) {
        __pyx_t_3 = __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_v_dotdata_qual_check); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1902, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_3);
      } else {
        __pyx_t_2 = PyTuple_New(1+1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1902, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
        __Pyx_GIVEREF(__pyx_t_7); PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_7); __pyx_t_7 = NULL;
        __Pyx_INCREF(__pyx_v_dotdata_qual_check);
        __Pyx_GIVEREF(__pyx_v_dotdata_qual_check);
        PyTuple_SET_ITEM(__pyx_t_2, 0+1, __pyx_v_dotdata_qual_check);
        __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_2, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1902, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_3);
        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      }
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_v_region_QC = __pyx_t_3;
      __pyx_t_3 = 0;

      /* "vapor_vali/Simple_function.pyx":1903
 *         if len(dotdata_qual_check)>0:
 *             region_QC=qual_check_repetitive_region(dotdata_qual_check)
 *             while True:             # <<<<<<<<<<<<<<
 *                 if window_size>30: break
 *                 if region_QC[0]>region_QC_Cff or sum(region_QC[1])/float(len(seq2))<0.3: break
 */
      while (1) {

        /* "vapor_vali/Simple_function.pyx":1904
 *             region_QC=qual_check_repetitive_region(dotdata_qual_check)
 *             while True:
 *                 if window_size>30: break             # <<<<<<<<<<<<<<
 *                 if region_QC[0]>region_QC_Cff or sum(region_QC[1])/float(len(seq2))<0.3: break
 *                 else:
 */
        __pyx_t_3 = PyObject_RichCompare(__pyx_v_window_size, __pyx_int_30, Py_GT); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1904, __pyx_L1_error)
        __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 1904, __pyx_L1_error)
        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
        if (__pyx_t_5) {
          goto __pyx_L6_break;
        }

        /* "vapor_vali/Simple_function.pyx":1905
 *             while True:
 *                 if window_size>30: break
 *                 if region_QC[0]>region_QC_Cff or sum(region_QC[1])/float(len(seq2))<0.3: break             # <<<<<<<<<<<<<<
 *                 else:
 *                     window_size+=10
 */
        __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_region_QC, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1905, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_3);
        __pyx_t_1 = PyObject_RichCompare(__pyx_t_3, __pyx_v_region_QC_Cff, Py_GT); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1905, __pyx_L1_error)
        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
        __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 1905, __pyx_L1_error)
        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
        if (!__pyx_t_4) {
        } else {
          __pyx_t_5 = __pyx_t_4;
          goto __pyx_L9_bool_binop_done;
        }
        __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_region_QC, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1905, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1905, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_3);
        __Pyx_GIVEREF(__pyx_t_1);
        PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_1);
        __pyx_t_1 = 0;
        __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_sum, __pyx_t_3, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1905, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
        __pyx_t_6 = PyObject_Length(__pyx_v_seq2); if (unlikely(__pyx_t_6 == -1)) __PYX_ERR(0, 1905, __pyx_L1_error)
        __pyx_t_3 = PyFloat_FromDouble(((double)__pyx_t_6)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1905, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_3);
        __pyx_t_2 = __Pyx_PyNumber_Divide(__pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1905, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
        __pyx_t_3 = PyObject_RichCompare(__pyx_t_2, __pyx_float_0_3, Py_LT); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1905, __pyx_L1_error)
        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
        __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 1905, __pyx_L1_error)
        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
        __pyx_t_5 = __pyx_t_4;
        __pyx_L9_bool_binop_done:;
        if (__pyx_t_5) {
          goto __pyx_L6_break;
        }

        /* "vapor_vali/Simple_function.pyx":1907
 *                 if region_QC[0]>region_QC_Cff or sum(region_QC[1])/float(len(seq2))<0.3: break
 *                 else:
 *                     window_size+=10             # <<<<<<<<<<<<<<
 *                     dotdata_qual_check=dotdata(window_size,seq2,seq2)
 *                     region_QC=qual_check_repetitive_region(dotdata_qual_check)
 */
        /*else*/ {
          __pyx_t_3 = __Pyx_PyInt_AddObjC(__pyx_v_window_size, __pyx_int_10, 10, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1907, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_3);
          __Pyx_DECREF_SET(__pyx_v_window_size, __pyx_t_3);
          __pyx_t_3 = 0;

          /* "vapor_vali/Simple_function.pyx":1908
 *                 else:
 *                     window_size+=10
 *                     dotdata_qual_check=dotdata(window_size,seq2,seq2)             # <<<<<<<<<<<<<<
 *                     region_QC=qual_check_repetitive_region(dotdata_qual_check)
 *             return [window_size,region_QC]
 */
          __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_dotdata); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1908, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_2);
          __pyx_t_1 = NULL;
          __pyx_t_6 = 0;
          if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_2))) {
            __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_2);
            if (likely(__pyx_t_1)) {
              PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
              __Pyx_INCREF(__pyx_t_1);
              __Pyx_INCREF(function);
              __Pyx_DECREF_SET(__pyx_t_2, function);
              __pyx_t_6 = 1;
            }
          }
          __pyx_t_7 = PyTuple_New(3+__pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1908, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_7);
          if (__pyx_t_1) {
            __Pyx_GIVEREF(__pyx_t_1); PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_1); __pyx_t_1 = NULL;
          }
          __Pyx_INCREF(__pyx_v_window_size);
          __Pyx_GIVEREF(__pyx_v_window_size);
          PyTuple_SET_ITEM(__pyx_t_7, 0+__pyx_t_6, __pyx_v_window_size);
          __Pyx_INCREF(__pyx_v_seq2);
          __Pyx_GIVEREF(__pyx_v_seq2);
          PyTuple_SET_ITEM(__pyx_t_7, 1+__pyx_t_6, __pyx_v_seq2);
          __Pyx_INCREF(__pyx_v_seq2);
          __Pyx_GIVEREF(__pyx_v_seq2);
          PyTuple_SET_ITEM(__pyx_t_7, 2+__pyx_t_6, __pyx_v_seq2);
          __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_7, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1908, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_3);
          __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
          __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
          __Pyx_DECREF_SET(__pyx_v_dotdata_qual_check, __pyx_t_3);
          __pyx_t_3 = 0;

          /* "vapor_vali/Simple_function.pyx":1909
 *                     window_size+=10
 *                     dotdata_qual_check=dotdata(window_size,seq2,seq2)
 *                     region_QC=qual_check_repetitive_region(dotdata_qual_check)             # <<<<<<<<<<<<<<
 *             return [window_size,region_QC]
 *         else:   return ['Error','Error']
 */
          __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_qual_check_repetitive_region); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1909, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_2);
          __pyx_t_7 = NULL;
          if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_2))) {
            __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_2);
            if (likely(__pyx_t_7)) {
              PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
              __Pyx_INCREF(__pyx_t_7);
              __Pyx_INCREF(function);
              __Pyx_DECREF_SET(__pyx_t_2, function);
            }
          }
          if (!__pyx_t_7) {
            __pyx_t_3 = __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_v_dotdata_qual_check); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1909, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_3);
          } else {
            __pyx_t_1 = PyTuple_New(1+1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1909, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_1);
            __Pyx_GIVEREF(__pyx_t_7); PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_7); __pyx_t_7 = NULL;
            __Pyx_INCREF(__pyx_v_dotdata_qual_check);
            __Pyx_GIVEREF(__pyx_v_dotdata_qual_check);
            PyTuple_SET_ITEM(__pyx_t_1, 0+1, __pyx_v_dotdata_qual_check);
            __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_1, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1909, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_3);
            __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
          }
          __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
          __Pyx_DECREF_SET(__pyx_v_region_QC, __pyx_t_3);
          __pyx_t_3 = 0;
        }
      }
      __pyx_L6_break:;

      /* "vapor_vali/Simple_function.pyx":1910
 *                     dotdata_qual_check=dotdata(window_size,seq2,seq2)
 *                     region_QC=qual_check_repetitive_region(dotdata_qual_check)
 *             return [window_size,region_QC]             # <<<<<<<<<<<<<<
 *         else:   return ['Error','Error']
 *     else:       return ['Error','Error']
 */
      __Pyx_XDECREF(__pyx_r);
      __pyx_t_3 = PyList_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1910, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __Pyx_INCREF(__pyx_v_window_size);
      __Pyx_GIVEREF(__pyx_v_window_size);
      PyList_SET_ITEM(__pyx_t_3, 0, __pyx_v_window_size);
      __Pyx_INCREF(__pyx_v_region_QC);
      __Pyx_GIVEREF(__pyx_v_region_QC);
      PyList_SET_ITEM(__pyx_t_3, 1, __pyx_v_region_QC);
      __pyx_r = __pyx_t_3;
      __pyx_t_3 = 0;
      goto __pyx_L0;

      /* "vapor_vali/Simple_function.pyx":1901
 *     if not seq2.count('N')+seq2.count('n')>100:
 *         dotdata_qual_check=dotdata(window_size,seq2,seq2)
 *         if len(dotdata_qual_check)>0:             # <<<<<<<<<<<<<<
 *             region_QC=qual_check_repetitive_region(dotdata_qual_check)
 *             while True:
 */
    }

    /* "vapor_vali/Simple_function.pyx":1911
 *                     region_QC=qual_check_repetitive_region(dotdata_qual_check)
 *             return [window_size,region_QC]
 *         else:   return ['Error','Error']             # <<<<<<<<<<<<<<
 *     else:       return ['Error','Error']
 * 
 */
    /*else*/ {
      __Pyx_XDECREF(__pyx_r);
      __pyx_t_3 = PyList_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1911, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __Pyx_INCREF(__pyx_n_s_Error);
      __Pyx_GIVEREF(__pyx_n_s_Error);
      PyList_SET_ITEM(__pyx_t_3, 0, __pyx_n_s_Error);
      __Pyx_INCREF(__pyx_n_s_Error);
      __Pyx_GIVEREF(__pyx_n_s_Error);
      PyList_SET_ITEM(__pyx_t_3, 1, __pyx_n_s_Error);
      __pyx_r = __pyx_t_3;
      __pyx_t_3 = 0;
      goto __pyx_L0;
    }

    /* "vapor_vali/Simple_function.pyx":1899
 * def window_size_refine(seq2,region_QC_Cff=0.4):
 *     window_size=10
 *     if not seq2.count('N')+seq2.count('n')>100:             # <<<<<<<<<<<<<<
 *         dotdata_qual_check=dotdata(window_size,seq2,seq2)
 *         if len(dotdata_qual_check)>0:
 */
  }

  /* "vapor_vali/Simple_function.pyx":1912
 *             return [window_size,region_QC]
 *         else:   return ['Error','Error']
 *     else:       return ['Error','Error']             # <<<<<<<<<<<<<<
 * 
 * def write_dotdata_to_file(file_out,dotdata_list):
 */
  /*else*/ {
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_3 = PyList_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1912, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_INCREF(__pyx_n_s_Error);
    __Pyx_GIVEREF(__pyx_n_s_Error);
    PyList_SET_ITEM(__pyx_t_3, 0, __pyx_n_s_Error);
    __Pyx_INCREF(__pyx_n_s_Error);
    __Pyx_GIVEREF(__pyx_n_s_Error);
    PyList_SET_ITEM(__pyx_t_3, 1, __pyx_n_s_Error);
    __pyx_r = __pyx_t_3;
    __pyx_t_3 = 0;
    goto __pyx_L0;
  }

  /* "vapor_vali/Simple_function.pyx":1897
 *     fo.close()
 * 
 * def window_size_refine(seq2,region_QC_Cff=0.4):             # <<<<<<<<<<<<<<
 *     window_size=10
 *     if not seq2.count('N')+seq2.count('n')>100:
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_7);
  __Pyx_AddTraceback("vapor_vali.Simple_function.window_size_refine", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_window_size);
  __Pyx_XDECREF(__pyx_v_dotdata_qual_check);
  __Pyx_XDECREF(__pyx_v_region_QC);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "vapor_vali/Simple_function.pyx":1914
 *     else:       return ['Error','Error']
 * 
 * def write_dotdata_to_file(file_out,dotdata_list):             # <<<<<<<<<<<<<<
 *     fo=open(file_out,'w')
 *     for k1 in dotdata_list:
 */

/* Python wrapper */
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_225write_dotdata_to_file(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_10vapor_vali_15Simple_function_225write_dotdata_to_file = {"write_dotdata_to_file", (PyCFunction)__pyx_pw_10vapor_vali_15Simple_function_225write_dotdata_to_file, METH_VARARGS|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_225write_dotdata_to_file(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_file_out = 0;
  PyObject *__pyx_v_dotdata_list = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("write_dotdata_to_file (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_file_out,&__pyx_n_s_dotdata_list,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_file_out)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_dotdata_list)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("write_dotdata_to_file", 1, 2, 2, 1); __PYX_ERR(0, 1914, __pyx_L3_error)
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "write_dotdata_to_file") < 0)) __PYX_ERR(0, 1914, __pyx_L3_error)
      }
    } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
    }
    __pyx_v_file_out = values[0];
    __pyx_v_dotdata_list = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("write_dotdata_to_file", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1914, __pyx_L3_error)
  __pyx_L3_error:;
  __Pyx_AddTraceback("vapor_vali.Simple_function.write_dotdata_to_file", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_10vapor_vali_15Simple_function_224write_dotdata_to_file(__pyx_self, __pyx_v_file_out, __pyx_v_dotdata_list);

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10vapor_vali_15Simple_function_224write_dotdata_to_file(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_file_out, PyObject *__pyx_v_dotdata_list) {
  PyObject *__pyx_v_fo = NULL;
  PyObject *__pyx_v_k1 = NULL;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  Py_ssize_t __pyx_t_3;
  PyObject *(*__pyx_t_4)(PyObject *);
  PyObject *__pyx_t_5 = NULL;
  Py_ssize_t __pyx_t_6;
  PyObject *(*__pyx_t_7)(PyObject *);
  PyObject *__pyx_t_8 = NULL;
  PyObject *__pyx_t_9 = NULL;
  __Pyx_RefNannySetupContext("write_dotdata_to_file", 0);

  /* "vapor_vali/Simple_function.pyx":1915
 * 
 * def write_dotdata_to_file(file_out,dotdata_list):
 *     fo=open(file_out,'w')             # <<<<<<<<<<<<<<
 *     for k1 in dotdata_list:
 *         print(' '.join([str(i) for i in k1]), file=fo)
 */
  __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1915, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_INCREF(__pyx_v_file_out);
  __Pyx_GIVEREF(__pyx_v_file_out);
  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_file_out);
  __Pyx_INCREF(__pyx_n_s_w);
  __Pyx_GIVEREF(__pyx_n_s_w);
  PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_n_s_w);
  __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_open, __pyx_t_1, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1915, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_fo = __pyx_t_2;
  __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":1916
 * def write_dotdata_to_file(file_out,dotdata_list):
 *     fo=open(file_out,'w')
 *     for k1 in dotdata_list:             # <<<<<<<<<<<<<<
 *         print(' '.join([str(i) for i in k1]), file=fo)
 *     fo.close()
 */
  if (likely(PyList_CheckExact(__pyx_v_dotdata_list)) || PyTuple_CheckExact(__pyx_v_dotdata_list)) {
    __pyx_t_2 = __pyx_v_dotdata_list; __Pyx_INCREF(__pyx_t_2); __pyx_t_3 = 0;
    __pyx_t_4 = NULL;
  } else {
    __pyx_t_3 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_v_dotdata_list); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1916, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_4 = Py_TYPE(__pyx_t_2)->tp_iternext; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1916, __pyx_L1_error)
  }
  for (;;) {
    if (likely(!__pyx_t_4)) {
      if (likely(PyList_CheckExact(__pyx_t_2))) {
        if (__pyx_t_3 >= PyList_GET_SIZE(__pyx_t_2)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_1 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_3); __Pyx_INCREF(__pyx_t_1); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 1916, __pyx_L1_error)
        #else
        __pyx_t_1 = PySequence_ITEM(__pyx_t_2, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1916, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        #endif
      } else {
        if (__pyx_t_3 >= PyTuple_GET_SIZE(__pyx_t_2)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_3); __Pyx_INCREF(__pyx_t_1); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 1916, __pyx_L1_error)
        #else
        __pyx_t_1 = PySequence_ITEM(__pyx_t_2, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1916, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        #endif
      }
    } else {
      __pyx_t_1 = __pyx_t_4(__pyx_t_2);
      if (unlikely(!__pyx_t_1)) {
        PyObject* exc_type = PyErr_Occurred();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
          else __PYX_ERR(0, 1916, __pyx_L1_error)
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_1);
    }
    __Pyx_XDECREF_SET(__pyx_v_k1, __pyx_t_1);
    __pyx_t_1 = 0;

    /* "vapor_vali/Simple_function.pyx":1917
 *     fo=open(file_out,'w')
 *     for k1 in dotdata_list:
 *         print(' '.join([str(i) for i in k1]), file=fo)             # <<<<<<<<<<<<<<
 *     fo.close()
 * 
 */
    __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1917, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    if (likely(PyList_CheckExact(__pyx_v_k1)) || PyTuple_CheckExact(__pyx_v_k1)) {
      __pyx_t_5 = __pyx_v_k1; __Pyx_INCREF(__pyx_t_5); __pyx_t_6 = 0;
      __pyx_t_7 = NULL;
    } else {
      __pyx_t_6 = -1; __pyx_t_5 = PyObject_GetIter(__pyx_v_k1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1917, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_5);
      __pyx_t_7 = Py_TYPE(__pyx_t_5)->tp_iternext; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1917, __pyx_L1_error)
    }
    for (;;) {
      if (likely(!__pyx_t_7)) {
        if (likely(PyList_CheckExact(__pyx_t_5))) {
          if (__pyx_t_6 >= PyList_GET_SIZE(__pyx_t_5)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_8 = PyList_GET_ITEM(__pyx_t_5, __pyx_t_6); __Pyx_INCREF(__pyx_t_8); __pyx_t_6++; if (unlikely(0 < 0)) __PYX_ERR(0, 1917, __pyx_L1_error)
          #else
          __pyx_t_8 = PySequence_ITEM(__pyx_t_5, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1917, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_8);
          #endif
        } else {
          if (__pyx_t_6 >= PyTuple_GET_SIZE(__pyx_t_5)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_8 = PyTuple_GET_ITEM(__pyx_t_5, __pyx_t_6); __Pyx_INCREF(__pyx_t_8); __pyx_t_6++; if (unlikely(0 < 0)) __PYX_ERR(0, 1917, __pyx_L1_error)
          #else
          __pyx_t_8 = PySequence_ITEM(__pyx_t_5, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1917, __pyx_L1_error)
          __Pyx_GOTREF(__pyx_t_8);
          #endif
        }
      } else {
        __pyx_t_8 = __pyx_t_7(__pyx_t_5);
        if (unlikely(!__pyx_t_8)) {
          PyObject* exc_type = PyErr_Occurred();
          if (exc_type) {
            if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
            else __PYX_ERR(0, 1917, __pyx_L1_error)
          }
          break;
        }
        __Pyx_GOTREF(__pyx_t_8);
      }
      __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_8);
      __pyx_t_8 = 0;
      __pyx_t_8 = PyTuple_New(1); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1917, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_8);
      __Pyx_INCREF(__pyx_v_i);
      __Pyx_GIVEREF(__pyx_v_i);
      PyTuple_SET_ITEM(__pyx_t_8, 0, __pyx_v_i);
      __pyx_t_9 = __Pyx_PyObject_Call(((PyObject *)(&PyString_Type)), __pyx_t_8, NULL); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1917, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_9);
      __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
      if (unlikely(__Pyx_ListComp_Append(__pyx_t_1, (PyObject*)__pyx_t_9))) __PYX_ERR(0, 1917, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
    }
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = __Pyx_PyString_Join(__pyx_kp_s__162, __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1917, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1917, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_GIVEREF(__pyx_t_5);
    PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_5);
    __pyx_t_5 = 0;
    __pyx_t_5 = PyDict_New(); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1917, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_file, __pyx_v_fo) < 0) __PYX_ERR(0, 1917, __pyx_L1_error)
    __pyx_t_9 = __Pyx_PyObject_Call(__pyx_builtin_print, __pyx_t_1, __pyx_t_5); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1917, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_9);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;

    /* "vapor_vali/Simple_function.pyx":1916
 * def write_dotdata_to_file(file_out,dotdata_list):
 *     fo=open(file_out,'w')
 *     for k1 in dotdata_list:             # <<<<<<<<<<<<<<
 *         print(' '.join([str(i) for i in k1]), file=fo)
 *     fo.close()
 */
  }
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":1918
 *     for k1 in dotdata_list:
 *         print(' '.join([str(i) for i in k1]), file=fo)
 *     fo.close()             # <<<<<<<<<<<<<<
 * 
 * def write_output_initiate(out_name):
 */
  __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_v_fo, __pyx_n_s_close); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1918, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_9);
  __pyx_t_5 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_9))) {
    __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_9);
    if (likely(__pyx_t_5)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_9);
      __Pyx_INCREF(__pyx_t_5);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_9, function);
    }
  }
  if (__pyx_t_5) {
    __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_t_9, __pyx_t_5); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1918, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  } else {
    __pyx_t_2 = __Pyx_PyObject_CallNoArg(__pyx_t_9); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1918, __pyx_L1_error)
  }
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":1914
 *     else:       return ['Error','Error']
 * 
 * def write_dotdata_to_file(file_out,dotdata_list):             # <<<<<<<<<<<<<<
 *     fo=open(file_out,'w')
 *     for k1 in dotdata_list:
 */

  /* function exit code */
  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_8);
  __Pyx_XDECREF(__pyx_t_9);
  __Pyx_AddTraceback("vapor_vali.Simple_function.write_dotdata_to_file", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_fo);
  __Pyx_XDECREF(__pyx_v_k1);
  __Pyx_XDECREF(__pyx_v_i);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "vapor_vali/Simple_function.pyx":1920
 *     fo.close()
 * 
 * def write_output_initiate(out_name):             # <<<<<<<<<<<<<<
 *     fo=open(out_name,'w')
 *     print('\t'.join(['chr','start','end','SV_description','VaPoR_quality_score','VaPoR_genotype_score','other']), file=fo)
 */

/* Python wrapper */
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_227write_output_initiate(PyObject *__pyx_self, PyObject *__pyx_v_out_name); /*proto*/
static PyMethodDef __pyx_mdef_10vapor_vali_15Simple_function_227write_output_initiate = {"write_output_initiate", (PyCFunction)__pyx_pw_10vapor_vali_15Simple_function_227write_output_initiate, METH_O, 0};
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_227write_output_initiate(PyObject *__pyx_self, PyObject *__pyx_v_out_name) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("write_output_initiate (wrapper)", 0);
  __pyx_r = __pyx_pf_10vapor_vali_15Simple_function_226write_output_initiate(__pyx_self, ((PyObject *)__pyx_v_out_name));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10vapor_vali_15Simple_function_226write_output_initiate(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_out_name) {
  PyObject *__pyx_v_fo = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  __Pyx_RefNannySetupContext("write_output_initiate", 0);

  /* "vapor_vali/Simple_function.pyx":1921
 * 
 * def write_output_initiate(out_name):
 *     fo=open(out_name,'w')             # <<<<<<<<<<<<<<
 *     print('\t'.join(['chr','start','end','SV_description','VaPoR_quality_score','VaPoR_genotype_score','other']), file=fo)
 *     fo.close()
 */
  __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1921, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_INCREF(__pyx_v_out_name);
  __Pyx_GIVEREF(__pyx_v_out_name);
  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_out_name);
  __Pyx_INCREF(__pyx_n_s_w);
  __Pyx_GIVEREF(__pyx_n_s_w);
  PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_n_s_w);
  __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_open, __pyx_t_1, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1921, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_fo = __pyx_t_2;
  __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":1922
 * def write_output_initiate(out_name):
 *     fo=open(out_name,'w')
 *     print('\t'.join(['chr','start','end','SV_description','VaPoR_quality_score','VaPoR_genotype_score','other']), file=fo)             # <<<<<<<<<<<<<<
 *     fo.close()
 * 
 */
  __pyx_t_2 = PyList_New(7); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1922, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_INCREF(__pyx_n_s_chr);
  __Pyx_GIVEREF(__pyx_n_s_chr);
  PyList_SET_ITEM(__pyx_t_2, 0, __pyx_n_s_chr);
  __Pyx_INCREF(__pyx_n_s_start);
  __Pyx_GIVEREF(__pyx_n_s_start);
  PyList_SET_ITEM(__pyx_t_2, 1, __pyx_n_s_start);
  __Pyx_INCREF(__pyx_n_s_end);
  __Pyx_GIVEREF(__pyx_n_s_end);
  PyList_SET_ITEM(__pyx_t_2, 2, __pyx_n_s_end);
  __Pyx_INCREF(__pyx_n_s_SV_description);
  __Pyx_GIVEREF(__pyx_n_s_SV_description);
  PyList_SET_ITEM(__pyx_t_2, 3, __pyx_n_s_SV_description);
  __Pyx_INCREF(__pyx_n_s_VaPoR_quality_score);
  __Pyx_GIVEREF(__pyx_n_s_VaPoR_quality_score);
  PyList_SET_ITEM(__pyx_t_2, 4, __pyx_n_s_VaPoR_quality_score);
  __Pyx_INCREF(__pyx_n_s_VaPoR_genotype_score);
  __Pyx_GIVEREF(__pyx_n_s_VaPoR_genotype_score);
  PyList_SET_ITEM(__pyx_t_2, 5, __pyx_n_s_VaPoR_genotype_score);
  __Pyx_INCREF(__pyx_n_s_other);
  __Pyx_GIVEREF(__pyx_n_s_other);
  PyList_SET_ITEM(__pyx_t_2, 6, __pyx_n_s_other);
  __pyx_t_1 = __Pyx_PyString_Join(__pyx_kp_s__159, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1922, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1922, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_GIVEREF(__pyx_t_1);
  PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = PyDict_New(); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1922, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_file, __pyx_v_fo) < 0) __PYX_ERR(0, 1922, __pyx_L1_error)
  __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_print, __pyx_t_2, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1922, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;

  /* "vapor_vali/Simple_function.pyx":1923
 *     fo=open(out_name,'w')
 *     print('\t'.join(['chr','start','end','SV_description','VaPoR_quality_score','VaPoR_genotype_score','other']), file=fo)
 *     fo.close()             # <<<<<<<<<<<<<<
 * 
 * def write_output_main(out_name,out_list):
 */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_fo, __pyx_n_s_close); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1923, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_1))) {
    __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_1);
    if (likely(__pyx_t_2)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
      __Pyx_INCREF(__pyx_t_2);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_1, function);
    }
  }
  if (__pyx_t_2) {
    __pyx_t_3 = __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1923, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  } else {
    __pyx_t_3 = __Pyx_PyObject_CallNoArg(__pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1923, __pyx_L1_error)
  }
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;

  /* "vapor_vali/Simple_function.pyx":1920
 *     fo.close()
 * 
 * def write_output_initiate(out_name):             # <<<<<<<<<<<<<<
 *     fo=open(out_name,'w')
 *     print('\t'.join(['chr','start','end','SV_description','VaPoR_quality_score','VaPoR_genotype_score','other']), file=fo)
 */

  /* function exit code */
  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_AddTraceback("vapor_vali.Simple_function.write_output_initiate", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_fo);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "vapor_vali/Simple_function.pyx":1925
 *     fo.close()
 * 
 * def write_output_main(out_name,out_list):             # <<<<<<<<<<<<<<
 *     fo=open(out_name,'a')
 *     print('\t'.join([str(i) for i in out_list]), file=fo)
 */

/* Python wrapper */
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_229write_output_main(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_10vapor_vali_15Simple_function_229write_output_main = {"write_output_main", (PyCFunction)__pyx_pw_10vapor_vali_15Simple_function_229write_output_main, METH_VARARGS|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_229write_output_main(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_out_name = 0;
  PyObject *__pyx_v_out_list = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("write_output_main (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_out_name,&__pyx_n_s_out_list,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_out_name)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_out_list)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("write_output_main", 1, 2, 2, 1); __PYX_ERR(0, 1925, __pyx_L3_error)
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "write_output_main") < 0)) __PYX_ERR(0, 1925, __pyx_L3_error)
      }
    } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
    }
    __pyx_v_out_name = values[0];
    __pyx_v_out_list = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("write_output_main", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1925, __pyx_L3_error)
  __pyx_L3_error:;
  __Pyx_AddTraceback("vapor_vali.Simple_function.write_output_main", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_10vapor_vali_15Simple_function_228write_output_main(__pyx_self, __pyx_v_out_name, __pyx_v_out_list);

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10vapor_vali_15Simple_function_228write_output_main(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_out_name, PyObject *__pyx_v_out_list) {
  PyObject *__pyx_v_fo = NULL;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  Py_ssize_t __pyx_t_3;
  PyObject *(*__pyx_t_4)(PyObject *);
  PyObject *__pyx_t_5 = NULL;
  PyObject *__pyx_t_6 = NULL;
  __Pyx_RefNannySetupContext("write_output_main", 0);

  /* "vapor_vali/Simple_function.pyx":1926
 * 
 * def write_output_main(out_name,out_list):
 *     fo=open(out_name,'a')             # <<<<<<<<<<<<<<
 *     print('\t'.join([str(i) for i in out_list]), file=fo)
 *     fo.close()
 */
  __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1926, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_INCREF(__pyx_v_out_name);
  __Pyx_GIVEREF(__pyx_v_out_name);
  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_out_name);
  __Pyx_INCREF(__pyx_n_s_a);
  __Pyx_GIVEREF(__pyx_n_s_a);
  PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_n_s_a);
  __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_open, __pyx_t_1, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1926, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_fo = __pyx_t_2;
  __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":1927
 * def write_output_main(out_name,out_list):
 *     fo=open(out_name,'a')
 *     print('\t'.join([str(i) for i in out_list]), file=fo)             # <<<<<<<<<<<<<<
 *     fo.close()
 * 
 */
  __pyx_t_2 = PyList_New(0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1927, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (likely(PyList_CheckExact(__pyx_v_out_list)) || PyTuple_CheckExact(__pyx_v_out_list)) {
    __pyx_t_1 = __pyx_v_out_list; __Pyx_INCREF(__pyx_t_1); __pyx_t_3 = 0;
    __pyx_t_4 = NULL;
  } else {
    __pyx_t_3 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_v_out_list); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1927, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_4 = Py_TYPE(__pyx_t_1)->tp_iternext; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1927, __pyx_L1_error)
  }
  for (;;) {
    if (likely(!__pyx_t_4)) {
      if (likely(PyList_CheckExact(__pyx_t_1))) {
        if (__pyx_t_3 >= PyList_GET_SIZE(__pyx_t_1)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_5 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_3); __Pyx_INCREF(__pyx_t_5); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 1927, __pyx_L1_error)
        #else
        __pyx_t_5 = PySequence_ITEM(__pyx_t_1, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1927, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_5);
        #endif
      } else {
        if (__pyx_t_3 >= PyTuple_GET_SIZE(__pyx_t_1)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_5 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_3); __Pyx_INCREF(__pyx_t_5); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 1927, __pyx_L1_error)
        #else
        __pyx_t_5 = PySequence_ITEM(__pyx_t_1, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1927, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_5);
        #endif
      }
    } else {
      __pyx_t_5 = __pyx_t_4(__pyx_t_1);
      if (unlikely(!__pyx_t_5)) {
        PyObject* exc_type = PyErr_Occurred();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
          else __PYX_ERR(0, 1927, __pyx_L1_error)
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_5);
    }
    __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_5);
    __pyx_t_5 = 0;
    __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1927, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_INCREF(__pyx_v_i);
    __Pyx_GIVEREF(__pyx_v_i);
    PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_v_i);
    __pyx_t_6 = __Pyx_PyObject_Call(((PyObject *)(&PyString_Type)), __pyx_t_5, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1927, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    if (unlikely(__Pyx_ListComp_Append(__pyx_t_2, (PyObject*)__pyx_t_6))) __PYX_ERR(0, 1927, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  }
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_PyString_Join(__pyx_kp_s__159, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1927, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1927, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_GIVEREF(__pyx_t_1);
  PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = PyDict_New(); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1927, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_file, __pyx_v_fo) < 0) __PYX_ERR(0, 1927, __pyx_L1_error)
  __pyx_t_6 = __Pyx_PyObject_Call(__pyx_builtin_print, __pyx_t_2, __pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1927, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

  /* "vapor_vali/Simple_function.pyx":1928
 *     fo=open(out_name,'a')
 *     print('\t'.join([str(i) for i in out_list]), file=fo)
 *     fo.close()             # <<<<<<<<<<<<<<
 * 
 * def x_to_x_modify_new(x,dup_block_combined):
 */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_fo, __pyx_n_s_close); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1928, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_1))) {
    __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_1);
    if (likely(__pyx_t_2)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
      __Pyx_INCREF(__pyx_t_2);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_1, function);
    }
  }
  if (__pyx_t_2) {
    __pyx_t_6 = __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_t_2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1928, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  } else {
    __pyx_t_6 = __Pyx_PyObject_CallNoArg(__pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1928, __pyx_L1_error)
  }
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

  /* "vapor_vali/Simple_function.pyx":1925
 *     fo.close()
 * 
 * def write_output_main(out_name,out_list):             # <<<<<<<<<<<<<<
 *     fo=open(out_name,'a')
 *     print('\t'.join([str(i) for i in out_list]), file=fo)
 */

  /* function exit code */
  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_AddTraceback("vapor_vali.Simple_function.write_output_main", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_fo);
  __Pyx_XDECREF(__pyx_v_i);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "vapor_vali/Simple_function.pyx":1930
 *     fo.close()
 * 
 * def x_to_x_modify_new(x,dup_block_combined):             # <<<<<<<<<<<<<<
 *     x_modify=[[i] for i in list(x)]
 *     block_rec=-1
 */

/* Python wrapper */
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_231x_to_x_modify_new(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_10vapor_vali_15Simple_function_231x_to_x_modify_new = {"x_to_x_modify_new", (PyCFunction)__pyx_pw_10vapor_vali_15Simple_function_231x_to_x_modify_new, METH_VARARGS|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_231x_to_x_modify_new(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_x = 0;
  PyObject *__pyx_v_dup_block_combined = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("x_to_x_modify_new (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_x,&__pyx_n_s_dup_block_combined,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_x)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_dup_block_combined)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("x_to_x_modify_new", 1, 2, 2, 1); __PYX_ERR(0, 1930, __pyx_L3_error)
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "x_to_x_modify_new") < 0)) __PYX_ERR(0, 1930, __pyx_L3_error)
      }
    } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
    }
    __pyx_v_x = values[0];
    __pyx_v_dup_block_combined = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("x_to_x_modify_new", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1930, __pyx_L3_error)
  __pyx_L3_error:;
  __Pyx_AddTraceback("vapor_vali.Simple_function.x_to_x_modify_new", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_10vapor_vali_15Simple_function_230x_to_x_modify_new(__pyx_self, __pyx_v_x, __pyx_v_dup_block_combined);

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10vapor_vali_15Simple_function_230x_to_x_modify_new(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_x, PyObject *__pyx_v_dup_block_combined) {
  PyObject *__pyx_v_x_modify = NULL;
  PyObject *__pyx_v_block_rec = NULL;
  PyObject *__pyx_v_y = NULL;
  PyObject *__pyx_v_x_modify_new = NULL;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  Py_ssize_t __pyx_t_4;
  PyObject *(*__pyx_t_5)(PyObject *);
  Py_ssize_t __pyx_t_6;
  int __pyx_t_7;
  PyObject *__pyx_t_8 = NULL;
  PyObject *__pyx_t_9 = NULL;
  PyObject *__pyx_t_10 = NULL;
  PyObject *(*__pyx_t_11)(PyObject *);
  PyObject *__pyx_t_12 = NULL;
  __Pyx_RefNannySetupContext("x_to_x_modify_new", 0);

  /* "vapor_vali/Simple_function.pyx":1931
 * 
 * def x_to_x_modify_new(x,dup_block_combined):
 *     x_modify=[[i] for i in list(x)]             # <<<<<<<<<<<<<<
 *     block_rec=-1
 *     for y in dup_block_combined:
 */
  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1931, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = PySequence_List(__pyx_v_x); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1931, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = __pyx_t_2; __Pyx_INCREF(__pyx_t_3); __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  for (;;) {
    if (__pyx_t_4 >= PyList_GET_SIZE(__pyx_t_3)) break;
    #if CYTHON_COMPILING_IN_CPYTHON
    __pyx_t_2 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_4); __Pyx_INCREF(__pyx_t_2); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 1931, __pyx_L1_error)
    #else
    __pyx_t_2 = PySequence_ITEM(__pyx_t_3, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1931, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    #endif
    __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_2);
    __pyx_t_2 = 0;
    __pyx_t_2 = PyList_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1931, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_INCREF(__pyx_v_i);
    __Pyx_GIVEREF(__pyx_v_i);
    PyList_SET_ITEM(__pyx_t_2, 0, __pyx_v_i);
    if (unlikely(__Pyx_ListComp_Append(__pyx_t_1, (PyObject*)__pyx_t_2))) __PYX_ERR(0, 1931, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  }
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_x_modify = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":1932
 * def x_to_x_modify_new(x,dup_block_combined):
 *     x_modify=[[i] for i in list(x)]
 *     block_rec=-1             # <<<<<<<<<<<<<<
 *     for y in dup_block_combined:
 *         block_rec+=1
 */
  __Pyx_INCREF(__pyx_int_neg_1);
  __pyx_v_block_rec = __pyx_int_neg_1;

  /* "vapor_vali/Simple_function.pyx":1933
 *     x_modify=[[i] for i in list(x)]
 *     block_rec=-1
 *     for y in dup_block_combined:             # <<<<<<<<<<<<<<
 *         block_rec+=1
 *         if len(y)>1:
 */
  if (likely(PyList_CheckExact(__pyx_v_dup_block_combined)) || PyTuple_CheckExact(__pyx_v_dup_block_combined)) {
    __pyx_t_1 = __pyx_v_dup_block_combined; __Pyx_INCREF(__pyx_t_1); __pyx_t_4 = 0;
    __pyx_t_5 = NULL;
  } else {
    __pyx_t_4 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_v_dup_block_combined); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1933, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_5 = Py_TYPE(__pyx_t_1)->tp_iternext; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1933, __pyx_L1_error)
  }
  for (;;) {
    if (likely(!__pyx_t_5)) {
      if (likely(PyList_CheckExact(__pyx_t_1))) {
        if (__pyx_t_4 >= PyList_GET_SIZE(__pyx_t_1)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_3 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_4); __Pyx_INCREF(__pyx_t_3); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 1933, __pyx_L1_error)
        #else
        __pyx_t_3 = PySequence_ITEM(__pyx_t_1, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1933, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_3);
        #endif
      } else {
        if (__pyx_t_4 >= PyTuple_GET_SIZE(__pyx_t_1)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_3 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_4); __Pyx_INCREF(__pyx_t_3); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 1933, __pyx_L1_error)
        #else
        __pyx_t_3 = PySequence_ITEM(__pyx_t_1, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1933, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_3);
        #endif
      }
    } else {
      __pyx_t_3 = __pyx_t_5(__pyx_t_1);
      if (unlikely(!__pyx_t_3)) {
        PyObject* exc_type = PyErr_Occurred();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
          else __PYX_ERR(0, 1933, __pyx_L1_error)
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_3);
    }
    __Pyx_XDECREF_SET(__pyx_v_y, __pyx_t_3);
    __pyx_t_3 = 0;

    /* "vapor_vali/Simple_function.pyx":1934
 *     block_rec=-1
 *     for y in dup_block_combined:
 *         block_rec+=1             # <<<<<<<<<<<<<<
 *         if len(y)>1:
 *             x_modify[block_rec]+=[x_modify[block_rec][0]+1+i for i in range(len(y)-1)]
 */
    __pyx_t_3 = __Pyx_PyInt_AddObjC(__pyx_v_block_rec, __pyx_int_1, 1, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1934, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF_SET(__pyx_v_block_rec, __pyx_t_3);
    __pyx_t_3 = 0;

    /* "vapor_vali/Simple_function.pyx":1935
 *     for y in dup_block_combined:
 *         block_rec+=1
 *         if len(y)>1:             # <<<<<<<<<<<<<<
 *             x_modify[block_rec]+=[x_modify[block_rec][0]+1+i for i in range(len(y)-1)]
 *     x_modify_new=[]
 */
    __pyx_t_6 = PyObject_Length(__pyx_v_y); if (unlikely(__pyx_t_6 == -1)) __PYX_ERR(0, 1935, __pyx_L1_error)
    __pyx_t_7 = ((__pyx_t_6 > 1) != 0);
    if (__pyx_t_7) {

      /* "vapor_vali/Simple_function.pyx":1936
 *         block_rec+=1
 *         if len(y)>1:
 *             x_modify[block_rec]+=[x_modify[block_rec][0]+1+i for i in range(len(y)-1)]             # <<<<<<<<<<<<<<
 *     x_modify_new=[]
 *     for y in x_modify:  x_modify_new+=y
 */
      __Pyx_INCREF(__pyx_v_block_rec);
      __pyx_t_3 = __pyx_v_block_rec;
      __pyx_t_2 = PyObject_GetItem(__pyx_v_x_modify, __pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1936, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_2);
      __pyx_t_8 = PyList_New(0); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1936, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_8);
      __pyx_t_6 = PyObject_Length(__pyx_v_y); if (unlikely(__pyx_t_6 == -1)) __PYX_ERR(0, 1936, __pyx_L1_error)
      __pyx_t_9 = PyInt_FromSsize_t((__pyx_t_6 - 1)); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1936, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_9);
      __pyx_t_10 = PyTuple_New(1); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1936, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_10);
      __Pyx_GIVEREF(__pyx_t_9);
      PyTuple_SET_ITEM(__pyx_t_10, 0, __pyx_t_9);
      __pyx_t_9 = 0;
      __pyx_t_9 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_t_10, NULL); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1936, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_9);
      __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
      if (likely(PyList_CheckExact(__pyx_t_9)) || PyTuple_CheckExact(__pyx_t_9)) {
        __pyx_t_10 = __pyx_t_9; __Pyx_INCREF(__pyx_t_10); __pyx_t_6 = 0;
        __pyx_t_11 = NULL;
      } else {
        __pyx_t_6 = -1; __pyx_t_10 = PyObject_GetIter(__pyx_t_9); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1936, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_10);
        __pyx_t_11 = Py_TYPE(__pyx_t_10)->tp_iternext; if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1936, __pyx_L1_error)
      }
      __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
      for (;;) {
        if (likely(!__pyx_t_11)) {
          if (likely(PyList_CheckExact(__pyx_t_10))) {
            if (__pyx_t_6 >= PyList_GET_SIZE(__pyx_t_10)) break;
            #if CYTHON_COMPILING_IN_CPYTHON
            __pyx_t_9 = PyList_GET_ITEM(__pyx_t_10, __pyx_t_6); __Pyx_INCREF(__pyx_t_9); __pyx_t_6++; if (unlikely(0 < 0)) __PYX_ERR(0, 1936, __pyx_L1_error)
            #else
            __pyx_t_9 = PySequence_ITEM(__pyx_t_10, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1936, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_9);
            #endif
          } else {
            if (__pyx_t_6 >= PyTuple_GET_SIZE(__pyx_t_10)) break;
            #if CYTHON_COMPILING_IN_CPYTHON
            __pyx_t_9 = PyTuple_GET_ITEM(__pyx_t_10, __pyx_t_6); __Pyx_INCREF(__pyx_t_9); __pyx_t_6++; if (unlikely(0 < 0)) __PYX_ERR(0, 1936, __pyx_L1_error)
            #else
            __pyx_t_9 = PySequence_ITEM(__pyx_t_10, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1936, __pyx_L1_error)
            __Pyx_GOTREF(__pyx_t_9);
            #endif
          }
        } else {
          __pyx_t_9 = __pyx_t_11(__pyx_t_10);
          if (unlikely(!__pyx_t_9)) {
            PyObject* exc_type = PyErr_Occurred();
            if (exc_type) {
              if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
              else __PYX_ERR(0, 1936, __pyx_L1_error)
            }
            break;
          }
          __Pyx_GOTREF(__pyx_t_9);
        }
        __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_9);
        __pyx_t_9 = 0;
        __pyx_t_9 = PyObject_GetItem(__pyx_v_x_modify, __pyx_v_block_rec); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1936, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_9);
        __pyx_t_12 = __Pyx_GetItemInt(__pyx_t_9, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1936, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_12);
        __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
        __pyx_t_9 = __Pyx_PyInt_AddObjC(__pyx_t_12, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1936, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_9);
        __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
        __pyx_t_12 = PyNumber_Add(__pyx_t_9, __pyx_v_i); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1936, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_12);
        __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
        if (unlikely(__Pyx_ListComp_Append(__pyx_t_8, (PyObject*)__pyx_t_12))) __PYX_ERR(0, 1936, __pyx_L1_error)
        __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
      }
      __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
      __pyx_t_10 = PyNumber_InPlaceAdd(__pyx_t_2, __pyx_t_8); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1936, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_10);
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
      if (unlikely(PyObject_SetItem(__pyx_v_x_modify, __pyx_t_3, __pyx_t_10) < 0)) __PYX_ERR(0, 1936, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;

      /* "vapor_vali/Simple_function.pyx":1935
 *     for y in dup_block_combined:
 *         block_rec+=1
 *         if len(y)>1:             # <<<<<<<<<<<<<<
 *             x_modify[block_rec]+=[x_modify[block_rec][0]+1+i for i in range(len(y)-1)]
 *     x_modify_new=[]
 */
    }

    /* "vapor_vali/Simple_function.pyx":1933
 *     x_modify=[[i] for i in list(x)]
 *     block_rec=-1
 *     for y in dup_block_combined:             # <<<<<<<<<<<<<<
 *         block_rec+=1
 *         if len(y)>1:
 */
  }
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":1937
 *         if len(y)>1:
 *             x_modify[block_rec]+=[x_modify[block_rec][0]+1+i for i in range(len(y)-1)]
 *     x_modify_new=[]             # <<<<<<<<<<<<<<
 *     for y in x_modify:  x_modify_new+=y
 *     return x_modify_new
 */
  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1937, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_x_modify_new = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":1938
 *             x_modify[block_rec]+=[x_modify[block_rec][0]+1+i for i in range(len(y)-1)]
 *     x_modify_new=[]
 *     for y in x_modify:  x_modify_new+=y             # <<<<<<<<<<<<<<
 *     return x_modify_new
 * 
 */
  __pyx_t_1 = __pyx_v_x_modify; __Pyx_INCREF(__pyx_t_1); __pyx_t_4 = 0;
  for (;;) {
    if (__pyx_t_4 >= PyList_GET_SIZE(__pyx_t_1)) break;
    #if CYTHON_COMPILING_IN_CPYTHON
    __pyx_t_3 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_4); __Pyx_INCREF(__pyx_t_3); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 1938, __pyx_L1_error)
    #else
    __pyx_t_3 = PySequence_ITEM(__pyx_t_1, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1938, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    #endif
    __Pyx_XDECREF_SET(__pyx_v_y, __pyx_t_3);
    __pyx_t_3 = 0;
    __pyx_t_3 = PyNumber_InPlaceAdd(__pyx_v_x_modify_new, __pyx_v_y); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1938, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF_SET(__pyx_v_x_modify_new, __pyx_t_3);
    __pyx_t_3 = 0;
  }
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":1939
 *     x_modify_new=[]
 *     for y in x_modify:  x_modify_new+=y
 *     return x_modify_new             # <<<<<<<<<<<<<<
 * 
 * def X_means_cluster(data_list):
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_x_modify_new);
  __pyx_r = __pyx_v_x_modify_new;
  goto __pyx_L0;

  /* "vapor_vali/Simple_function.pyx":1930
 *     fo.close()
 * 
 * def x_to_x_modify_new(x,dup_block_combined):             # <<<<<<<<<<<<<<
 *     x_modify=[[i] for i in list(x)]
 *     block_rec=-1
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_8);
  __Pyx_XDECREF(__pyx_t_9);
  __Pyx_XDECREF(__pyx_t_10);
  __Pyx_XDECREF(__pyx_t_12);
  __Pyx_AddTraceback("vapor_vali.Simple_function.x_to_x_modify_new", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_x_modify);
  __Pyx_XDECREF(__pyx_v_block_rec);
  __Pyx_XDECREF(__pyx_v_y);
  __Pyx_XDECREF(__pyx_v_x_modify_new);
  __Pyx_XDECREF(__pyx_v_i);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "vapor_vali/Simple_function.pyx":1941
 *     return x_modify_new
 * 
 * def X_means_cluster(data_list):             # <<<<<<<<<<<<<<
 *     temp_result=[i for i in k_means_cluster(data_list) if not i==[[],[]]]
 *     if temp_result==[data_list]:
 */

/* Python wrapper */
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_233X_means_cluster(PyObject *__pyx_self, PyObject *__pyx_v_data_list); /*proto*/
static PyMethodDef __pyx_mdef_10vapor_vali_15Simple_function_233X_means_cluster = {"X_means_cluster", (PyCFunction)__pyx_pw_10vapor_vali_15Simple_function_233X_means_cluster, METH_O, 0};
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_233X_means_cluster(PyObject *__pyx_self, PyObject *__pyx_v_data_list) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("X_means_cluster (wrapper)", 0);
  __pyx_r = __pyx_pf_10vapor_vali_15Simple_function_232X_means_cluster(__pyx_self, ((PyObject *)__pyx_v_data_list));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10vapor_vali_15Simple_function_232X_means_cluster(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_data_list) {
  PyObject *__pyx_v_temp_result = NULL;
  PyObject *__pyx_v_out = NULL;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  Py_ssize_t __pyx_t_6;
  PyObject *(*__pyx_t_7)(PyObject *);
  int __pyx_t_8;
  int __pyx_t_9;
  __Pyx_RefNannySetupContext("X_means_cluster", 0);

  /* "vapor_vali/Simple_function.pyx":1942
 * 
 * def X_means_cluster(data_list):
 *     temp_result=[i for i in k_means_cluster(data_list) if not i==[[],[]]]             # <<<<<<<<<<<<<<
 *     if temp_result==[data_list]:
 *         return temp_result[0]
 */
  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1942, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_k_means_cluster); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1942, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_4 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_3))) {
    __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
    if (likely(__pyx_t_4)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
      __Pyx_INCREF(__pyx_t_4);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_3, function);
    }
  }
  if (!__pyx_t_4) {
    __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_v_data_list); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1942, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
  } else {
    __pyx_t_5 = PyTuple_New(1+1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1942, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_GIVEREF(__pyx_t_4); PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_4); __pyx_t_4 = NULL;
    __Pyx_INCREF(__pyx_v_data_list);
    __Pyx_GIVEREF(__pyx_v_data_list);
    PyTuple_SET_ITEM(__pyx_t_5, 0+1, __pyx_v_data_list);
    __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_5, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1942, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  }
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  if (likely(PyList_CheckExact(__pyx_t_2)) || PyTuple_CheckExact(__pyx_t_2)) {
    __pyx_t_3 = __pyx_t_2; __Pyx_INCREF(__pyx_t_3); __pyx_t_6 = 0;
    __pyx_t_7 = NULL;
  } else {
    __pyx_t_6 = -1; __pyx_t_3 = PyObject_GetIter(__pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1942, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_7 = Py_TYPE(__pyx_t_3)->tp_iternext; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1942, __pyx_L1_error)
  }
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  for (;;) {
    if (likely(!__pyx_t_7)) {
      if (likely(PyList_CheckExact(__pyx_t_3))) {
        if (__pyx_t_6 >= PyList_GET_SIZE(__pyx_t_3)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_2 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_6); __Pyx_INCREF(__pyx_t_2); __pyx_t_6++; if (unlikely(0 < 0)) __PYX_ERR(0, 1942, __pyx_L1_error)
        #else
        __pyx_t_2 = PySequence_ITEM(__pyx_t_3, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1942, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
        #endif
      } else {
        if (__pyx_t_6 >= PyTuple_GET_SIZE(__pyx_t_3)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_2 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_6); __Pyx_INCREF(__pyx_t_2); __pyx_t_6++; if (unlikely(0 < 0)) __PYX_ERR(0, 1942, __pyx_L1_error)
        #else
        __pyx_t_2 = PySequence_ITEM(__pyx_t_3, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1942, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
        #endif
      }
    } else {
      __pyx_t_2 = __pyx_t_7(__pyx_t_3);
      if (unlikely(!__pyx_t_2)) {
        PyObject* exc_type = PyErr_Occurred();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
          else __PYX_ERR(0, 1942, __pyx_L1_error)
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_2);
    }
    __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_2);
    __pyx_t_2 = 0;
    __pyx_t_2 = PyList_New(0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1942, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_5 = PyList_New(0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1942, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __pyx_t_4 = PyList_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1942, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_GIVEREF(__pyx_t_2);
    PyList_SET_ITEM(__pyx_t_4, 0, __pyx_t_2);
    __Pyx_GIVEREF(__pyx_t_5);
    PyList_SET_ITEM(__pyx_t_4, 1, __pyx_t_5);
    __pyx_t_2 = 0;
    __pyx_t_5 = 0;
    __pyx_t_5 = PyObject_RichCompare(__pyx_v_i, __pyx_t_4, Py_EQ); __Pyx_XGOTREF(__pyx_t_5); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1942, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_8 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_8 < 0)) __PYX_ERR(0, 1942, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_9 = ((!__pyx_t_8) != 0);
    if (__pyx_t_9) {
      if (unlikely(__Pyx_ListComp_Append(__pyx_t_1, (PyObject*)__pyx_v_i))) __PYX_ERR(0, 1942, __pyx_L1_error)
    }
  }
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_temp_result = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":1943
 * def X_means_cluster(data_list):
 *     temp_result=[i for i in k_means_cluster(data_list) if not i==[[],[]]]
 *     if temp_result==[data_list]:             # <<<<<<<<<<<<<<
 *         return temp_result[0]
 *     else:
 */
  __pyx_t_1 = PyList_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1943, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_INCREF(__pyx_v_data_list);
  __Pyx_GIVEREF(__pyx_v_data_list);
  PyList_SET_ITEM(__pyx_t_1, 0, __pyx_v_data_list);
  __pyx_t_3 = PyObject_RichCompare(__pyx_v_temp_result, __pyx_t_1, Py_EQ); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1943, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_9 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_9 < 0)) __PYX_ERR(0, 1943, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  if (__pyx_t_9) {

    /* "vapor_vali/Simple_function.pyx":1944
 *     temp_result=[i for i in k_means_cluster(data_list) if not i==[[],[]]]
 *     if temp_result==[data_list]:
 *         return temp_result[0]             # <<<<<<<<<<<<<<
 *     else:
 *         out=[]
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_3 = __Pyx_GetItemInt_List(__pyx_v_temp_result, 0, long, 1, __Pyx_PyInt_From_long, 1, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1944, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_r = __pyx_t_3;
    __pyx_t_3 = 0;
    goto __pyx_L0;

    /* "vapor_vali/Simple_function.pyx":1943
 * def X_means_cluster(data_list):
 *     temp_result=[i for i in k_means_cluster(data_list) if not i==[[],[]]]
 *     if temp_result==[data_list]:             # <<<<<<<<<<<<<<
 *         return temp_result[0]
 *     else:
 */
  }

  /* "vapor_vali/Simple_function.pyx":1946
 *         return temp_result[0]
 *     else:
 *         out=[]             # <<<<<<<<<<<<<<
 *         for i in temp_result:
 *             out+=X_means_cluster(i)
 */
  /*else*/ {
    __pyx_t_3 = PyList_New(0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1946, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_v_out = __pyx_t_3;
    __pyx_t_3 = 0;

    /* "vapor_vali/Simple_function.pyx":1947
 *     else:
 *         out=[]
 *         for i in temp_result:             # <<<<<<<<<<<<<<
 *             out+=X_means_cluster(i)
 *         return out
 */
    __pyx_t_3 = __pyx_v_temp_result; __Pyx_INCREF(__pyx_t_3); __pyx_t_6 = 0;
    for (;;) {
      if (__pyx_t_6 >= PyList_GET_SIZE(__pyx_t_3)) break;
      #if CYTHON_COMPILING_IN_CPYTHON
      __pyx_t_1 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_6); __Pyx_INCREF(__pyx_t_1); __pyx_t_6++; if (unlikely(0 < 0)) __PYX_ERR(0, 1947, __pyx_L1_error)
      #else
      __pyx_t_1 = PySequence_ITEM(__pyx_t_3, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1947, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      #endif
      __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_1);
      __pyx_t_1 = 0;

      /* "vapor_vali/Simple_function.pyx":1948
 *         out=[]
 *         for i in temp_result:
 *             out+=X_means_cluster(i)             # <<<<<<<<<<<<<<
 *         return out
 * 
 */
      __pyx_t_5 = __Pyx_GetModuleGlobalName(__pyx_n_s_X_means_cluster); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1948, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_5);
      __pyx_t_4 = NULL;
      if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_5))) {
        __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_5);
        if (likely(__pyx_t_4)) {
          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
          __Pyx_INCREF(__pyx_t_4);
          __Pyx_INCREF(function);
          __Pyx_DECREF_SET(__pyx_t_5, function);
        }
      }
      if (!__pyx_t_4) {
        __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_v_i); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1948, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
      } else {
        __pyx_t_2 = PyTuple_New(1+1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1948, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_2);
        __Pyx_GIVEREF(__pyx_t_4); PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_4); __pyx_t_4 = NULL;
        __Pyx_INCREF(__pyx_v_i);
        __Pyx_GIVEREF(__pyx_v_i);
        PyTuple_SET_ITEM(__pyx_t_2, 0+1, __pyx_v_i);
        __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_2, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1948, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      }
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
      __pyx_t_5 = PyNumber_InPlaceAdd(__pyx_v_out, __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1948, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_5);
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      __Pyx_DECREF_SET(__pyx_v_out, __pyx_t_5);
      __pyx_t_5 = 0;

      /* "vapor_vali/Simple_function.pyx":1947
 *     else:
 *         out=[]
 *         for i in temp_result:             # <<<<<<<<<<<<<<
 *             out+=X_means_cluster(i)
 *         return out
 */
    }
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;

    /* "vapor_vali/Simple_function.pyx":1949
 *         for i in temp_result:
 *             out+=X_means_cluster(i)
 *         return out             # <<<<<<<<<<<<<<
 * 
 * def X_means_cluster_reformat(data_list):
 */
    __Pyx_XDECREF(__pyx_r);
    __Pyx_INCREF(__pyx_v_out);
    __pyx_r = __pyx_v_out;
    goto __pyx_L0;
  }

  /* "vapor_vali/Simple_function.pyx":1941
 *     return x_modify_new
 * 
 * def X_means_cluster(data_list):             # <<<<<<<<<<<<<<
 *     temp_result=[i for i in k_means_cluster(data_list) if not i==[[],[]]]
 *     if temp_result==[data_list]:
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_AddTraceback("vapor_vali.Simple_function.X_means_cluster", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_temp_result);
  __Pyx_XDECREF(__pyx_v_out);
  __Pyx_XDECREF(__pyx_v_i);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "vapor_vali/Simple_function.pyx":1951
 *         return out
 * 
 * def X_means_cluster_reformat(data_list):             # <<<<<<<<<<<<<<
 *     out=X_means_cluster(data_list)
 *     out2=[]
 */

/* Python wrapper */
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_235X_means_cluster_reformat(PyObject *__pyx_self, PyObject *__pyx_v_data_list); /*proto*/
static PyMethodDef __pyx_mdef_10vapor_vali_15Simple_function_235X_means_cluster_reformat = {"X_means_cluster_reformat", (PyCFunction)__pyx_pw_10vapor_vali_15Simple_function_235X_means_cluster_reformat, METH_O, 0};
static PyObject *__pyx_pw_10vapor_vali_15Simple_function_235X_means_cluster_reformat(PyObject *__pyx_self, PyObject *__pyx_v_data_list) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("X_means_cluster_reformat (wrapper)", 0);
  __pyx_r = __pyx_pf_10vapor_vali_15Simple_function_234X_means_cluster_reformat(__pyx_self, ((PyObject *)__pyx_v_data_list));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_10vapor_vali_15Simple_function_234X_means_cluster_reformat(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_data_list) {
  PyObject *__pyx_v_out = NULL;
  PyObject *__pyx_v_out2 = NULL;
  PyObject *__pyx_v_y = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  Py_ssize_t __pyx_t_5;
  PyObject *(*__pyx_t_6)(PyObject *);
  int __pyx_t_7;
  __Pyx_RefNannySetupContext("X_means_cluster_reformat", 0);

  /* "vapor_vali/Simple_function.pyx":1952
 * 
 * def X_means_cluster_reformat(data_list):
 *     out=X_means_cluster(data_list)             # <<<<<<<<<<<<<<
 *     out2=[]
 *     for y in range(len(out)/2):
 */
  __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_X_means_cluster); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1952, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_3);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_2, function);
    }
  }
  if (!__pyx_t_3) {
    __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_v_data_list); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1952, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
  } else {
    __pyx_t_4 = PyTuple_New(1+1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1952, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_GIVEREF(__pyx_t_3); PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3); __pyx_t_3 = NULL;
    __Pyx_INCREF(__pyx_v_data_list);
    __Pyx_GIVEREF(__pyx_v_data_list);
    PyTuple_SET_ITEM(__pyx_t_4, 0+1, __pyx_v_data_list);
    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_4, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1952, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  }
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_out = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":1953
 * def X_means_cluster_reformat(data_list):
 *     out=X_means_cluster(data_list)
 *     out2=[]             # <<<<<<<<<<<<<<
 *     for y in range(len(out)/2):
 *         out2.append([out[2*y],out[2*y+1]])
 */
  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1953, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_out2 = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":1954
 *     out=X_means_cluster(data_list)
 *     out2=[]
 *     for y in range(len(out)/2):             # <<<<<<<<<<<<<<
 *         out2.append([out[2*y],out[2*y+1]])
 *     return out2
 */
  __pyx_t_5 = PyObject_Length(__pyx_v_out); if (unlikely(__pyx_t_5 == -1)) __PYX_ERR(0, 1954, __pyx_L1_error)
  __pyx_t_1 = PyInt_FromSsize_t(__Pyx_div_Py_ssize_t(__pyx_t_5, 2)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1954, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1954, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_GIVEREF(__pyx_t_1);
  PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_t_2, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1954, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  if (likely(PyList_CheckExact(__pyx_t_1)) || PyTuple_CheckExact(__pyx_t_1)) {
    __pyx_t_2 = __pyx_t_1; __Pyx_INCREF(__pyx_t_2); __pyx_t_5 = 0;
    __pyx_t_6 = NULL;
  } else {
    __pyx_t_5 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1954, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_6 = Py_TYPE(__pyx_t_2)->tp_iternext; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1954, __pyx_L1_error)
  }
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  for (;;) {
    if (likely(!__pyx_t_6)) {
      if (likely(PyList_CheckExact(__pyx_t_2))) {
        if (__pyx_t_5 >= PyList_GET_SIZE(__pyx_t_2)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_1 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_5); __Pyx_INCREF(__pyx_t_1); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 1954, __pyx_L1_error)
        #else
        __pyx_t_1 = PySequence_ITEM(__pyx_t_2, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1954, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        #endif
      } else {
        if (__pyx_t_5 >= PyTuple_GET_SIZE(__pyx_t_2)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_5); __Pyx_INCREF(__pyx_t_1); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 1954, __pyx_L1_error)
        #else
        __pyx_t_1 = PySequence_ITEM(__pyx_t_2, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1954, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_1);
        #endif
      }
    } else {
      __pyx_t_1 = __pyx_t_6(__pyx_t_2);
      if (unlikely(!__pyx_t_1)) {
        PyObject* exc_type = PyErr_Occurred();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
          else __PYX_ERR(0, 1954, __pyx_L1_error)
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_1);
    }
    __Pyx_XDECREF_SET(__pyx_v_y, __pyx_t_1);
    __pyx_t_1 = 0;

    /* "vapor_vali/Simple_function.pyx":1955
 *     out2=[]
 *     for y in range(len(out)/2):
 *         out2.append([out[2*y],out[2*y+1]])             # <<<<<<<<<<<<<<
 *     return out2
 */
    __pyx_t_1 = PyNumber_Multiply(__pyx_int_2, __pyx_v_y); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1955, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_4 = PyObject_GetItem(__pyx_v_out, __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1955, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = PyNumber_Multiply(__pyx_int_2, __pyx_v_y); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1955, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_3 = __Pyx_PyInt_AddObjC(__pyx_t_1, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1955, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = PyObject_GetItem(__pyx_v_out, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1955, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = PyList_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1955, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_GIVEREF(__pyx_t_4);
    PyList_SET_ITEM(__pyx_t_3, 0, __pyx_t_4);
    __Pyx_GIVEREF(__pyx_t_1);
    PyList_SET_ITEM(__pyx_t_3, 1, __pyx_t_1);
    __pyx_t_4 = 0;
    __pyx_t_1 = 0;
    __pyx_t_7 = __Pyx_PyList_Append(__pyx_v_out2, __pyx_t_3); if (unlikely(__pyx_t_7 == -1)) __PYX_ERR(0, 1955, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;

    /* "vapor_vali/Simple_function.pyx":1954
 *     out=X_means_cluster(data_list)
 *     out2=[]
 *     for y in range(len(out)/2):             # <<<<<<<<<<<<<<
 *         out2.append([out[2*y],out[2*y+1]])
 *     return out2
 */
  }
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":1956
 *     for y in range(len(out)/2):
 *         out2.append([out[2*y],out[2*y+1]])
 *     return out2             # <<<<<<<<<<<<<<
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_out2);
  __pyx_r = __pyx_v_out2;
  goto __pyx_L0;

  /* "vapor_vali/Simple_function.pyx":1951
 *         return out
 * 
 * def X_means_cluster_reformat(data_list):             # <<<<<<<<<<<<<<
 *     out=X_means_cluster(data_list)
 *     out2=[]
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_AddTraceback("vapor_vali.Simple_function.X_means_cluster_reformat", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_out);
  __Pyx_XDECREF(__pyx_v_out2);
  __Pyx_XDECREF(__pyx_v_y);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static struct __pyx_obj_10vapor_vali_15Simple_function___pyx_scope_struct__eu_y_vs_x_ratio_calcu *__pyx_freelist_10vapor_vali_15Simple_function___pyx_scope_struct__eu_y_vs_x_ratio_calcu[8];
static int __pyx_freecount_10vapor_vali_15Simple_function___pyx_scope_struct__eu_y_vs_x_ratio_calcu = 0;

static PyObject *__pyx_tp_new_10vapor_vali_15Simple_function___pyx_scope_struct__eu_y_vs_x_ratio_calcu(PyTypeObject *t, CYTHON_UNUSED PyObject *a, CYTHON_UNUSED PyObject *k) {
  PyObject *o;
  if (CYTHON_COMPILING_IN_CPYTHON && likely((__pyx_freecount_10vapor_vali_15Simple_function___pyx_scope_struct__eu_y_vs_x_ratio_calcu > 0) & (t->tp_basicsize == sizeof(struct __pyx_obj_10vapor_vali_15Simple_function___pyx_scope_struct__eu_y_vs_x_ratio_calcu)))) {
    o = (PyObject*)__pyx_freelist_10vapor_vali_15Simple_function___pyx_scope_struct__eu_y_vs_x_ratio_calcu[--__pyx_freecount_10vapor_vali_15Simple_function___pyx_scope_struct__eu_y_vs_x_ratio_calcu];
    memset(o, 0, sizeof(struct __pyx_obj_10vapor_vali_15Simple_function___pyx_scope_struct__eu_y_vs_x_ratio_calcu));
    (void) PyObject_INIT(o, t);
    PyObject_GC_Track(o);
  } else {
    o = (*t->tp_alloc)(t, 0);
    if (unlikely(!o)) return 0;
  }
  return o;
}

static void __pyx_tp_dealloc_10vapor_vali_15Simple_function___pyx_scope_struct__eu_y_vs_x_ratio_calcu(PyObject *o) {
  struct __pyx_obj_10vapor_vali_15Simple_function___pyx_scope_struct__eu_y_vs_x_ratio_calcu *p = (struct __pyx_obj_10vapor_vali_15Simple_function___pyx_scope_struct__eu_y_vs_x_ratio_calcu *)o;
  PyObject_GC_UnTrack(o);
  Py_CLEAR(p->__pyx_v_nparam_density);
  if (CYTHON_COMPILING_IN_CPYTHON && ((__pyx_freecount_10vapor_vali_15Simple_function___pyx_scope_struct__eu_y_vs_x_ratio_calcu < 8) & (Py_TYPE(o)->tp_basicsize == sizeof(struct __pyx_obj_10vapor_vali_15Simple_function___pyx_scope_struct__eu_y_vs_x_ratio_calcu)))) {
    __pyx_freelist_10vapor_vali_15Simple_function___pyx_scope_struct__eu_y_vs_x_ratio_calcu[__pyx_freecount_10vapor_vali_15Simple_function___pyx_scope_struct__eu_y_vs_x_ratio_calcu++] = ((struct __pyx_obj_10vapor_vali_15Simple_function___pyx_scope_struct__eu_y_vs_x_ratio_calcu *)o);
  } else {
    (*Py_TYPE(o)->tp_free)(o);
  }
}

static int __pyx_tp_traverse_10vapor_vali_15Simple_function___pyx_scope_struct__eu_y_vs_x_ratio_calcu(PyObject *o, visitproc v, void *a) {
  int e;
  struct __pyx_obj_10vapor_vali_15Simple_function___pyx_scope_struct__eu_y_vs_x_ratio_calcu *p = (struct __pyx_obj_10vapor_vali_15Simple_function___pyx_scope_struct__eu_y_vs_x_ratio_calcu *)o;
  if (p->__pyx_v_nparam_density) {
    e = (*v)(p->__pyx_v_nparam_density, a); if (e) return e;
  }
  return 0;
}

static int __pyx_tp_clear_10vapor_vali_15Simple_function___pyx_scope_struct__eu_y_vs_x_ratio_calcu(PyObject *o) {
  PyObject* tmp;
  struct __pyx_obj_10vapor_vali_15Simple_function___pyx_scope_struct__eu_y_vs_x_ratio_calcu *p = (struct __pyx_obj_10vapor_vali_15Simple_function___pyx_scope_struct__eu_y_vs_x_ratio_calcu *)o;
  tmp = ((PyObject*)p->__pyx_v_nparam_density);
  p->__pyx_v_nparam_density = Py_None; Py_INCREF(Py_None);
  Py_XDECREF(tmp);
  return 0;
}

static PyTypeObject __pyx_type_10vapor_vali_15Simple_function___pyx_scope_struct__eu_y_vs_x_ratio_calcu = {
  PyVarObject_HEAD_INIT(0, 0)
  "vapor_vali.Simple_function.__pyx_scope_struct__eu_y_vs_x_ratio_calcu", /*tp_name*/
  sizeof(struct __pyx_obj_10vapor_vali_15Simple_function___pyx_scope_struct__eu_y_vs_x_ratio_calcu), /*tp_basicsize*/
  0, /*tp_itemsize*/
  __pyx_tp_dealloc_10vapor_vali_15Simple_function___pyx_scope_struct__eu_y_vs_x_ratio_calcu, /*tp_dealloc*/
  0, /*tp_print*/
  0, /*tp_getattr*/
  0, /*tp_setattr*/
  #if PY_MAJOR_VERSION < 3
  0, /*tp_compare*/
  #endif
  #if PY_MAJOR_VERSION >= 3
  0, /*tp_as_async*/
  #endif
  0, /*tp_repr*/
  0, /*tp_as_number*/
  0, /*tp_as_sequence*/
  0, /*tp_as_mapping*/
  0, /*tp_hash*/
  0, /*tp_call*/
  0, /*tp_str*/
  0, /*tp_getattro*/
  0, /*tp_setattro*/
  0, /*tp_as_buffer*/
  Py_TPFLAGS_DEFAULT|Py_TPFLAGS_HAVE_VERSION_TAG|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_HAVE_NEWBUFFER|Py_TPFLAGS_HAVE_GC, /*tp_flags*/
  0, /*tp_doc*/
  __pyx_tp_traverse_10vapor_vali_15Simple_function___pyx_scope_struct__eu_y_vs_x_ratio_calcu, /*tp_traverse*/
  __pyx_tp_clear_10vapor_vali_15Simple_function___pyx_scope_struct__eu_y_vs_x_ratio_calcu, /*tp_clear*/
  0, /*tp_richcompare*/
  0, /*tp_weaklistoffset*/
  0, /*tp_iter*/
  0, /*tp_iternext*/
  0, /*tp_methods*/
  0, /*tp_members*/
  0, /*tp_getset*/
  0, /*tp_base*/
  0, /*tp_dict*/
  0, /*tp_descr_get*/
  0, /*tp_descr_set*/
  0, /*tp_dictoffset*/
  0, /*tp_init*/
  0, /*tp_alloc*/
  __pyx_tp_new_10vapor_vali_15Simple_function___pyx_scope_struct__eu_y_vs_x_ratio_calcu, /*tp_new*/
  0, /*tp_free*/
  0, /*tp_is_gc*/
  0, /*tp_bases*/
  0, /*tp_mro*/
  0, /*tp_cache*/
  0, /*tp_subclasses*/
  0, /*tp_weaklist*/
  0, /*tp_del*/
  0, /*tp_version_tag*/
  #if PY_VERSION_HEX >= 0x030400a1
  0, /*tp_finalize*/
  #endif
};

static PyMethodDef __pyx_methods[] = {
  {0, 0, 0, 0}
};

#if PY_MAJOR_VERSION >= 3
static struct PyModuleDef __pyx_moduledef = {
  #if PY_VERSION_HEX < 0x03020000
    { PyObject_HEAD_INIT(NULL) NULL, 0, NULL },
  #else
    PyModuleDef_HEAD_INIT,
  #endif
    "Simple_function",
    0, /* m_doc */
    -1, /* m_size */
    __pyx_methods /* m_methods */,
    NULL, /* m_reload */
    NULL, /* m_traverse */
    NULL, /* m_clear */
    NULL /* m_free */
};
#endif

static __Pyx_StringTabEntry __pyx_string_tab[] = {
  {&__pyx_kp_s_, __pyx_k_, sizeof(__pyx_k_), 0, 0, 1, 0},
  {&__pyx_kp_s_2, __pyx_k_2, sizeof(__pyx_k_2), 0, 0, 1, 0},
  {&__pyx_n_s_A, __pyx_k_A, sizeof(__pyx_k_A), 0, 0, 1, 1},
  {&__pyx_n_s_ALT, __pyx_k_ALT, sizeof(__pyx_k_ALT), 0, 0, 1, 1},
  {&__pyx_n_s_ATGCN, __pyx_k_ATGCN, sizeof(__pyx_k_ATGCN), 0, 0, 1, 1},
  {&__pyx_n_s_B, __pyx_k_B, sizeof(__pyx_k_B), 0, 0, 1, 1},
  {&__pyx_n_s_BIC, __pyx_k_BIC, sizeof(__pyx_k_BIC), 0, 0, 1, 1},
  {&__pyx_n_s_BIC_i, __pyx_k_BIC_i, sizeof(__pyx_k_BIC_i), 0, 0, 1, 1},
  {&__pyx_n_s_BIC_rec, __pyx_k_BIC_rec, sizeof(__pyx_k_BIC_rec), 0, 0, 1, 1},
  {&__pyx_n_s_C, __pyx_k_C, sizeof(__pyx_k_C), 0, 0, 1, 1},
  {&__pyx_kp_s_CHROM, __pyx_k_CHROM, sizeof(__pyx_k_CHROM), 0, 0, 1, 0},
  {&__pyx_n_s_CN, __pyx_k_CN, sizeof(__pyx_k_CN), 0, 0, 1, 1},
  {&__pyx_n_s_D, __pyx_k_D, sizeof(__pyx_k_D), 0, 0, 1, 1},
  {&__pyx_kp_s_END, __pyx_k_END, sizeof(__pyx_k_END), 0, 0, 1, 0},
  {&__pyx_n_s_END_2, __pyx_k_END_2, sizeof(__pyx_k_END_2), 0, 0, 1, 1},
  {&__pyx_n_s_Error, __pyx_k_Error, sizeof(__pyx_k_Error), 0, 0, 1, 1},
  {&__pyx_kp_s_Error_invalid_name_for_pacbio_fi, __pyx_k_Error_invalid_name_for_pacbio_fi, sizeof(__pyx_k_Error_invalid_name_for_pacbio_fi), 0, 0, 1, 0},
  {&__pyx_n_s_FALSE, __pyx_k_FALSE, sizeof(__pyx_k_FALSE), 0, 0, 1, 1},
  {&__pyx_n_s_FILTER, __pyx_k_FILTER, sizeof(__pyx_k_FILTER), 0, 0, 1, 1},
  {&__pyx_n_s_FORMAT, __pyx_k_FORMAT, sizeof(__pyx_k_FORMAT), 0, 0, 1, 1},
  {&__pyx_n_s_FloatVector, __pyx_k_FloatVector, sizeof(__pyx_k_FloatVector), 0, 0, 1, 1},
  {&__pyx_n_s_G, __pyx_k_G, sizeof(__pyx_k_G), 0, 0, 1, 1},
  {&__pyx_n_s_GT, __pyx_k_GT, sizeof(__pyx_k_GT), 0, 0, 1, 1},
  {&__pyx_n_s_H, __pyx_k_H, sizeof(__pyx_k_H), 0, 0, 1, 1},
  {&__pyx_n_s_I, __pyx_k_I, sizeof(__pyx_k_I), 0, 0, 1, 1},
  {&__pyx_n_s_ID, __pyx_k_ID, sizeof(__pyx_k_ID), 0, 0, 1, 1},
  {&__pyx_n_s_INFO, __pyx_k_INFO, sizeof(__pyx_k_INFO), 0, 0, 1, 1},
  {&__pyx_n_s_INS_length_detect, __pyx_k_INS_length_detect, sizeof(__pyx_k_INS_length_detect), 0, 0, 1, 1},
  {&__pyx_n_s_IntVector, __pyx_k_IntVector, sizeof(__pyx_k_IntVector), 0, 0, 1, 1},
  {&__pyx_n_s_K, __pyx_k_K, sizeof(__pyx_k_K), 0, 0, 1, 1},
  {&__pyx_n_s_KMeans, __pyx_k_KMeans, sizeof(__pyx_k_KMeans), 0, 0, 1, 1},
  {&__pyx_n_s_KMeans_predict, __pyx_k_KMeans_predict, sizeof(__pyx_k_KMeans_predict), 0, 0, 1, 1},
  {&__pyx_n_s_M, __pyx_k_M, sizeof(__pyx_k_M), 0, 0, 1, 1},
  {&__pyx_kp_s_MEIINFO, __pyx_k_MEIINFO, sizeof(__pyx_k_MEIINFO), 0, 0, 1, 0},
  {&__pyx_n_s_N, __pyx_k_N, sizeof(__pyx_k_N), 0, 0, 1, 1},
  {&__pyx_n_s_NA, __pyx_k_NA, sizeof(__pyx_k_NA), 0, 0, 1, 1},
  {&__pyx_n_s_PASS, __pyx_k_PASS, sizeof(__pyx_k_PASS), 0, 0, 1, 1},
  {&__pyx_n_s_POLARITY, __pyx_k_POLARITY, sizeof(__pyx_k_POLARITY), 0, 0, 1, 1},
  {&__pyx_n_s_POS, __pyx_k_POS, sizeof(__pyx_k_POS), 0, 0, 1, 1},
  {&__pyx_kp_s_PacBio_read, __pyx_k_PacBio_read, sizeof(__pyx_k_PacBio_read), 0, 0, 1, 0},
  {&__pyx_n_s_QUAL, __pyx_k_QUAL, sizeof(__pyx_k_QUAL), 0, 0, 1, 1},
  {&__pyx_n_s_R, __pyx_k_R, sizeof(__pyx_k_R), 0, 0, 1, 1},
  {&__pyx_n_s_REF, __pyx_k_REF, sizeof(__pyx_k_REF), 0, 0, 1, 1},
  {&__pyx_n_s_S, __pyx_k_S, sizeof(__pyx_k_S), 0, 0, 1, 1},
  {&__pyx_n_s_SAMPLE, __pyx_k_SAMPLE, sizeof(__pyx_k_SAMPLE), 0, 0, 1, 1},
  {&__pyx_kp_s_SEQ, __pyx_k_SEQ, sizeof(__pyx_k_SEQ), 0, 0, 1, 0},
  {&__pyx_kp_s_SVLEN, __pyx_k_SVLEN, sizeof(__pyx_k_SVLEN), 0, 0, 1, 0},
  {&__pyx_n_s_SVLEN_2, __pyx_k_SVLEN_2, sizeof(__pyx_k_SVLEN_2), 0, 0, 1, 1},
  {&__pyx_n_s_SVTYPE, __pyx_k_SVTYPE, sizeof(__pyx_k_SVTYPE), 0, 0, 1, 1},
  {&__pyx_n_s_SV_description, __pyx_k_SV_description, sizeof(__pyx_k_SV_description), 0, 0, 1, 1},
  {&__pyx_n_s_StrVector, __pyx_k_StrVector, sizeof(__pyx_k_StrVector), 0, 0, 1, 1},
  {&__pyx_n_s_T, __pyx_k_T, sizeof(__pyx_k_T), 0, 0, 1, 1},
  {&__pyx_n_s_TACGN, __pyx_k_TACGN, sizeof(__pyx_k_TACGN), 0, 0, 1, 1},
  {&__pyx_n_s_TRUE, __pyx_k_TRUE, sizeof(__pyx_k_TRUE), 0, 0, 1, 1},
  {&__pyx_n_s_V, __pyx_k_V, sizeof(__pyx_k_V), 0, 0, 1, 1},
  {&__pyx_n_s_VaPoR_geno, __pyx_k_VaPoR_geno, sizeof(__pyx_k_VaPoR_geno), 0, 0, 1, 1},
  {&__pyx_n_s_VaPoR_genotype_score, __pyx_k_VaPoR_genotype_score, sizeof(__pyx_k_VaPoR_genotype_score), 0, 0, 1, 1},
  {&__pyx_n_s_VaPoR_quality_score, __pyx_k_VaPoR_quality_score, sizeof(__pyx_k_VaPoR_quality_score), 0, 0, 1, 1},
  {&__pyx_n_s_VaPoR_value, __pyx_k_VaPoR_value, sizeof(__pyx_k_VaPoR_value), 0, 0, 1, 1},
  {&__pyx_n_s_W, __pyx_k_W, sizeof(__pyx_k_W), 0, 0, 1, 1},
  {&__pyx_kp_s_Window_size, __pyx_k_Window_size, sizeof(__pyx_k_Window_size), 0, 0, 1, 0},
  {&__pyx_n_s_X, __pyx_k_X, sizeof(__pyx_k_X), 0, 0, 1, 1},
  {&__pyx_n_s_XXX, __pyx_k_XXX, sizeof(__pyx_k_XXX), 0, 0, 1, 1},
  {&__pyx_n_s_X_means_cluster, __pyx_k_X_means_cluster, sizeof(__pyx_k_X_means_cluster), 0, 0, 1, 1},
  {&__pyx_n_s_X_means_cluster_reformat, __pyx_k_X_means_cluster_reformat, sizeof(__pyx_k_X_means_cluster_reformat), 0, 0, 1, 1},
  {&__pyx_n_s_Y, __pyx_k_Y, sizeof(__pyx_k_Y), 0, 0, 1, 1},
  {&__pyx_kp_s__100, __pyx_k__100, sizeof(__pyx_k__100), 0, 0, 1, 0},
  {&__pyx_kp_s__102, __pyx_k__102, sizeof(__pyx_k__102), 0, 0, 1, 0},
  {&__pyx_n_s__115, __pyx_k__115, sizeof(__pyx_k__115), 0, 0, 1, 1},
  {&__pyx_kp_s__14, __pyx_k__14, sizeof(__pyx_k__14), 0, 0, 1, 0},
  {&__pyx_kp_s__157, __pyx_k__157, sizeof(__pyx_k__157), 0, 0, 1, 0},
  {&__pyx_kp_s__159, __pyx_k__159, sizeof(__pyx_k__159), 0, 0, 1, 0},
  {&__pyx_kp_s__162, __pyx_k__162, sizeof(__pyx_k__162), 0, 0, 1, 0},
  {&__pyx_kp_s__19, __pyx_k__19, sizeof(__pyx_k__19), 0, 0, 1, 0},
  {&__pyx_kp_s__2, __pyx_k__2, sizeof(__pyx_k__2), 0, 0, 1, 0},
  {&__pyx_kp_s__24, __pyx_k__24, sizeof(__pyx_k__24), 0, 0, 1, 0},
  {&__pyx_kp_s__25, __pyx_k__25, sizeof(__pyx_k__25), 0, 0, 1, 0},
  {&__pyx_kp_s__26, __pyx_k__26, sizeof(__pyx_k__26), 0, 0, 1, 0},
  {&__pyx_kp_s__29, __pyx_k__29, sizeof(__pyx_k__29), 0, 0, 1, 0},
  {&__pyx_kp_s__3, __pyx_k__3, sizeof(__pyx_k__3), 0, 0, 1, 0},
  {&__pyx_kp_s__38, __pyx_k__38, sizeof(__pyx_k__38), 0, 0, 1, 0},
  {&__pyx_kp_s__45, __pyx_k__45, sizeof(__pyx_k__45), 0, 0, 1, 0},
  {&__pyx_kp_s__47, __pyx_k__47, sizeof(__pyx_k__47), 0, 0, 1, 0},
  {&__pyx_kp_s__48, __pyx_k__48, sizeof(__pyx_k__48), 0, 0, 1, 0},
  {&__pyx_kp_s__7, __pyx_k__7, sizeof(__pyx_k__7), 0, 0, 1, 0},
  {&__pyx_kp_s__83, __pyx_k__83, sizeof(__pyx_k__83), 0, 0, 1, 0},
  {&__pyx_n_s_a, __pyx_k_a, sizeof(__pyx_k_a), 0, 0, 1, 1},
  {&__pyx_kp_s_a_2, __pyx_k_a_2, sizeof(__pyx_k_a_2), 0, 0, 1, 0},
  {&__pyx_n_s_a_seq, __pyx_k_a_seq, sizeof(__pyx_k_a_seq), 0, 0, 1, 1},
  {&__pyx_n_s_ab, __pyx_k_ab, sizeof(__pyx_k_ab), 0, 0, 1, 1},
  {&__pyx_n_s_align_info, __pyx_k_align_info, sizeof(__pyx_k_align_info), 0, 0, 1, 1},
  {&__pyx_n_s_align_rec, __pyx_k_align_rec, sizeof(__pyx_k_align_rec), 0, 0, 1, 1},
  {&__pyx_n_s_align_start, __pyx_k_align_start, sizeof(__pyx_k_align_start), 0, 0, 1, 1},
  {&__pyx_n_s_all_combines, __pyx_k_all_combines, sizeof(__pyx_k_all_combines), 0, 0, 1, 1},
  {&__pyx_n_s_all_reads, __pyx_k_all_reads, sizeof(__pyx_k_all_reads), 0, 0, 1, 1},
  {&__pyx_n_s_all_reads_a, __pyx_k_all_reads_a, sizeof(__pyx_k_all_reads_a), 0, 0, 1, 1},
  {&__pyx_n_s_alt_allele, __pyx_k_alt_allele, sizeof(__pyx_k_alt_allele), 0, 0, 1, 1},
  {&__pyx_n_s_alt_anti_diag_clean_dotdata, __pyx_k_alt_anti_diag_clean_dotdata, sizeof(__pyx_k_alt_anti_diag_clean_dotdata), 0, 0, 1, 1},
  {&__pyx_n_s_alt_anti_diag_kept_segs, __pyx_k_alt_anti_diag_kept_segs, sizeof(__pyx_k_alt_anti_diag_kept_segs), 0, 0, 1, 1},
  {&__pyx_n_s_alt_bps, __pyx_k_alt_bps, sizeof(__pyx_k_alt_bps), 0, 0, 1, 1},
  {&__pyx_n_s_alt_bps_new, __pyx_k_alt_bps_new, sizeof(__pyx_k_alt_bps_new), 0, 0, 1, 1},
  {&__pyx_n_s_alt_clean_dotdata, __pyx_k_alt_clean_dotdata, sizeof(__pyx_k_alt_clean_dotdata), 0, 0, 1, 1},
  {&__pyx_n_s_alt_dotdata, __pyx_k_alt_dotdata, sizeof(__pyx_k_alt_dotdata), 0, 0, 1, 1},
  {&__pyx_n_s_alt_jun, __pyx_k_alt_jun, sizeof(__pyx_k_alt_jun), 0, 0, 1, 1},
  {&__pyx_n_s_alt_juncs, __pyx_k_alt_juncs, sizeof(__pyx_k_alt_juncs), 0, 0, 1, 1},
  {&__pyx_n_s_alt_kept_segs, __pyx_k_alt_kept_segs, sizeof(__pyx_k_alt_kept_segs), 0, 0, 1, 1},
  {&__pyx_n_s_alt_left, __pyx_k_alt_left, sizeof(__pyx_k_alt_left), 0, 0, 1, 1},
  {&__pyx_n_s_alt_new_intercept, __pyx_k_alt_new_intercept, sizeof(__pyx_k_alt_new_intercept), 0, 0, 1, 1},
  {&__pyx_n_s_alt_seq, __pyx_k_alt_seq, sizeof(__pyx_k_alt_seq), 0, 0, 1, 1},
  {&__pyx_n_s_alt_seq_readin, __pyx_k_alt_seq_readin, sizeof(__pyx_k_alt_seq_readin), 0, 0, 1, 1},
  {&__pyx_n_s_alt_structure, __pyx_k_alt_structure, sizeof(__pyx_k_alt_structure), 0, 0, 1, 1},
  {&__pyx_n_s_alt_sv, __pyx_k_alt_sv, sizeof(__pyx_k_alt_sv), 0, 0, 1, 1},
  {&__pyx_n_s_altered_reference, __pyx_k_altered_reference, sizeof(__pyx_k_altered_reference), 0, 0, 1, 1},
  {&__pyx_n_s_append, __pyx_k_append, sizeof(__pyx_k_append), 0, 0, 1, 1},
  {&__pyx_n_s_array, __pyx_k_array, sizeof(__pyx_k_array), 0, 0, 1, 1},
  {&__pyx_n_s_array_diagnal, __pyx_k_array_diagnal, sizeof(__pyx_k_array_diagnal), 0, 0, 1, 1},
  {&__pyx_n_s_atgcn, __pyx_k_atgcn, sizeof(__pyx_k_atgcn), 0, 0, 1, 1},
  {&__pyx_n_s_b, __pyx_k_b, sizeof(__pyx_k_b), 0, 0, 1, 1},
  {&__pyx_kp_s_b_2, __pyx_k_b_2, sizeof(__pyx_k_b_2), 0, 0, 1, 0},
  {&__pyx_n_s_b_seq, __pyx_k_b_seq, sizeof(__pyx_k_b_seq), 0, 0, 1, 1},
  {&__pyx_n_s_bam_in, __pyx_k_bam_in, sizeof(__pyx_k_bam_in), 0, 0, 1, 1},
  {&__pyx_n_s_bam_in_decide, __pyx_k_bam_in_decide, sizeof(__pyx_k_bam_in_decide), 0, 0, 1, 1},
  {&__pyx_n_s_bam_in_keys, __pyx_k_bam_in_keys, sizeof(__pyx_k_bam_in_keys), 0, 0, 1, 1},
  {&__pyx_n_s_bam_in_new, __pyx_k_bam_in_new, sizeof(__pyx_k_bam_in_new), 0, 0, 1, 1},
  {&__pyx_n_s_bam_in_new_list, __pyx_k_bam_in_new_list, sizeof(__pyx_k_bam_in_new_list), 0, 0, 1, 1},
  {&__pyx_n_s_bam_in_path, __pyx_k_bam_in_path, sizeof(__pyx_k_bam_in_path), 0, 0, 1, 1},
  {&__pyx_n_s_best_read_rec, __pyx_k_best_read_rec, sizeof(__pyx_k_best_read_rec), 0, 0, 1, 1},
  {&__pyx_n_s_bincount, __pyx_k_bincount, sizeof(__pyx_k_bincount), 0, 0, 1, 1},
  {&__pyx_n_s_block, __pyx_k_block, sizeof(__pyx_k_block), 0, 0, 1, 1},
  {&__pyx_n_s_block_around_check, __pyx_k_block_around_check, sizeof(__pyx_k_block_around_check), 0, 0, 1, 1},
  {&__pyx_n_s_block_hash, __pyx_k_block_hash, sizeof(__pyx_k_block_hash), 0, 0, 1, 1},
  {&__pyx_n_s_block_len, __pyx_k_block_len, sizeof(__pyx_k_block_len), 0, 0, 1, 1},
  {&__pyx_n_s_block_modify, __pyx_k_block_modify, sizeof(__pyx_k_block_modify), 0, 0, 1, 1},
  {&__pyx_n_s_block_rec, __pyx_k_block_rec, sizeof(__pyx_k_block_rec), 0, 0, 1, 1},
  {&__pyx_n_s_block_subsplot, __pyx_k_block_subsplot, sizeof(__pyx_k_block_subsplot), 0, 0, 1, 1},
  {&__pyx_n_s_bp_info, __pyx_k_bp_info, sizeof(__pyx_k_bp_info), 0, 0, 1, 1},
  {&__pyx_n_s_bp_let_hash, __pyx_k_bp_let_hash, sizeof(__pyx_k_bp_let_hash), 0, 0, 1, 1},
  {&__pyx_n_s_bp_let_seq, __pyx_k_bp_let_seq, sizeof(__pyx_k_bp_let_seq), 0, 0, 1, 1},
  {&__pyx_n_s_bp_list, __pyx_k_bp_list, sizeof(__pyx_k_bp_list), 0, 0, 1, 1},
  {&__pyx_n_s_bp_to_block_len, __pyx_k_bp_to_block_len, sizeof(__pyx_k_bp_to_block_len), 0, 0, 1, 1},
  {&__pyx_n_s_bp_to_chr_hash, __pyx_k_bp_to_chr_hash, sizeof(__pyx_k_bp_to_chr_hash), 0, 0, 1, 1},
  {&__pyx_n_s_bps, __pyx_k_bps, sizeof(__pyx_k_bps), 0, 0, 1, 1},
  {&__pyx_n_s_c, __pyx_k_c, sizeof(__pyx_k_c), 0, 0, 1, 1},
  {&__pyx_n_s_calcu_log10, __pyx_k_calcu_log10, sizeof(__pyx_k_calcu_log10), 0, 0, 1, 1},
  {&__pyx_n_s_calcu_vapor_single_read_score_ab, __pyx_k_calcu_vapor_single_read_score_ab, sizeof(__pyx_k_calcu_vapor_single_read_score_ab), 0, 0, 1, 1},
  {&__pyx_n_s_calcu_vapor_single_read_score_ab_2, __pyx_k_calcu_vapor_single_read_score_ab_2, sizeof(__pyx_k_calcu_vapor_single_read_score_ab_2), 0, 0, 1, 1},
  {&__pyx_n_s_calcu_vapor_single_read_score_ab_3, __pyx_k_calcu_vapor_single_read_score_ab_3, sizeof(__pyx_k_calcu_vapor_single_read_score_ab_3), 0, 0, 1, 1},
  {&__pyx_n_s_calcu_vapor_single_read_score_di, __pyx_k_calcu_vapor_single_read_score_di, sizeof(__pyx_k_calcu_vapor_single_read_score_di), 0, 0, 1, 1},
  {&__pyx_n_s_calcu_vapor_single_read_score_di_2, __pyx_k_calcu_vapor_single_read_score_di_2, sizeof(__pyx_k_calcu_vapor_single_read_score_di_2), 0, 0, 1, 1},
  {&__pyx_n_s_calcu_vapor_single_read_score_di_3, __pyx_k_calcu_vapor_single_read_score_di_3, sizeof(__pyx_k_calcu_vapor_single_read_score_di_3), 0, 0, 1, 1},
  {&__pyx_n_s_calcu_vapor_single_read_score_di_4, __pyx_k_calcu_vapor_single_read_score_di_4, sizeof(__pyx_k_calcu_vapor_single_read_score_di_4), 0, 0, 1, 1},
  {&__pyx_n_s_calcu_vapor_single_read_score_wi, __pyx_k_calcu_vapor_single_read_score_wi, sizeof(__pyx_k_calcu_vapor_single_read_score_wi), 0, 0, 1, 1},
  {&__pyx_n_s_cdist, __pyx_k_cdist, sizeof(__pyx_k_cdist), 0, 0, 1, 1},
  {&__pyx_n_s_centers, __pyx_k_centers, sizeof(__pyx_k_centers), 0, 0, 1, 1},
  {&__pyx_n_s_centroids, __pyx_k_centroids, sizeof(__pyx_k_centroids), 0, 0, 1, 1},
  {&__pyx_n_s_chop_pacbio_read_by_pos, __pyx_k_chop_pacbio_read_by_pos, sizeof(__pyx_k_chop_pacbio_read_by_pos), 0, 0, 1, 1},
  {&__pyx_n_s_chr, __pyx_k_chr, sizeof(__pyx_k_chr), 0, 0, 1, 1},
  {&__pyx_n_s_chr_start_end_extract, __pyx_k_chr_start_end_extract, sizeof(__pyx_k_chr_start_end_extract), 0, 0, 1, 1},
  {&__pyx_n_s_chrom, __pyx_k_chrom, sizeof(__pyx_k_chrom), 0, 0, 1, 1},
  {&__pyx_n_s_chromos, __pyx_k_chromos, sizeof(__pyx_k_chromos), 0, 0, 1, 1},
  {&__pyx_n_s_chromos_readin, __pyx_k_chromos_readin, sizeof(__pyx_k_chromos_readin), 0, 0, 1, 1},
  {&__pyx_n_s_cigar, __pyx_k_cigar, sizeof(__pyx_k_cigar), 0, 0, 1, 1},
  {&__pyx_n_s_cigar2alignstart_by_pos, __pyx_k_cigar2alignstart_by_pos, sizeof(__pyx_k_cigar2alignstart_by_pos), 0, 0, 1, 1},
  {&__pyx_n_s_cigar_record, __pyx_k_cigar_record, sizeof(__pyx_k_cigar_record), 0, 0, 1, 1},
  {&__pyx_n_s_cigars, __pyx_k_cigars, sizeof(__pyx_k_cigars), 0, 0, 1, 1},
  {&__pyx_n_s_cl_var, __pyx_k_cl_var, sizeof(__pyx_k_cl_var), 0, 0, 1, 1},
  {&__pyx_n_s_clean_dotdata_anti_diagnal_m1b, __pyx_k_clean_dotdata_anti_diagnal_m1b, sizeof(__pyx_k_clean_dotdata_anti_diagnal_m1b), 0, 0, 1, 1},
  {&__pyx_n_s_clean_dotdata_diagnal_and_anti_d, __pyx_k_clean_dotdata_diagnal_and_anti_d, sizeof(__pyx_k_clean_dotdata_diagnal_and_anti_d), 0, 0, 1, 1},
  {&__pyx_n_s_clean_dotdata_diagnal_m1b, __pyx_k_clean_dotdata_diagnal_m1b, sizeof(__pyx_k_clean_dotdata_diagnal_m1b), 0, 0, 1, 1},
  {&__pyx_n_s_clean_dotdata_m1, __pyx_k_clean_dotdata_m1, sizeof(__pyx_k_clean_dotdata_m1), 0, 0, 1, 1},
  {&__pyx_n_s_clean_dotdata_m2, __pyx_k_clean_dotdata_m2, sizeof(__pyx_k_clean_dotdata_m2), 0, 0, 1, 1},
  {&__pyx_n_s_clean_dotdata_x_and_y, __pyx_k_clean_dotdata_x_and_y, sizeof(__pyx_k_clean_dotdata_x_and_y), 0, 0, 1, 1},
  {&__pyx_n_s_close, __pyx_k_close, sizeof(__pyx_k_close), 0, 0, 1, 1},
  {&__pyx_n_s_clu_1, __pyx_k_clu_1, sizeof(__pyx_k_clu_1), 0, 0, 1, 1},
  {&__pyx_n_s_clu_2_sub, __pyx_k_clu_2_sub, sizeof(__pyx_k_clu_2_sub), 0, 0, 1, 1},
  {&__pyx_n_s_cluster, __pyx_k_cluster, sizeof(__pyx_k_cluster), 0, 0, 1, 1},
  {&__pyx_n_s_cluster1, __pyx_k_cluster1, sizeof(__pyx_k_cluster1), 0, 0, 1, 1},
  {&__pyx_n_s_cluster2, __pyx_k_cluster2, sizeof(__pyx_k_cluster2), 0, 0, 1, 1},
  {&__pyx_n_s_cluster_centers, __pyx_k_cluster_centers, sizeof(__pyx_k_cluster_centers), 0, 0, 1, 1},
  {&__pyx_n_s_cluster_range_decide, __pyx_k_cluster_range_decide, sizeof(__pyx_k_cluster_range_decide), 0, 0, 1, 1},
  {&__pyx_n_s_cluster_size_decide, __pyx_k_cluster_size_decide, sizeof(__pyx_k_cluster_size_decide), 0, 0, 1, 1},
  {&__pyx_n_s_col, __pyx_k_col, sizeof(__pyx_k_col), 0, 0, 1, 1},
  {&__pyx_n_s_combinations, __pyx_k_combinations, sizeof(__pyx_k_combinations), 0, 0, 1, 1},
  {&__pyx_n_s_compile, __pyx_k_compile, sizeof(__pyx_k_compile), 0, 0, 1, 1},
  {&__pyx_n_s_complementary, __pyx_k_complementary, sizeof(__pyx_k_complementary), 0, 0, 1, 1},
  {&__pyx_n_s_compute_bic, __pyx_k_compute_bic, sizeof(__pyx_k_compute_bic), 0, 0, 1, 1},
  {&__pyx_n_s_const_term, __pyx_k_const_term, sizeof(__pyx_k_const_term), 0, 0, 1, 1},
  {&__pyx_n_s_cost_matrix, __pyx_k_cost_matrix, sizeof(__pyx_k_cost_matrix), 0, 0, 1, 1},
  {&__pyx_n_s_count, __pyx_k_count, sizeof(__pyx_k_count), 0, 0, 1, 1},
  {&__pyx_n_s_d, __pyx_k_d, sizeof(__pyx_k_d), 0, 0, 1, 1},
  {&__pyx_n_s_dCost, __pyx_k_dCost, sizeof(__pyx_k_dCost), 0, 0, 1, 1},
  {&__pyx_n_s_dDist, __pyx_k_dDist, sizeof(__pyx_k_dDist), 0, 0, 1, 1},
  {&__pyx_kp_s_d_MIDNSHP_X, __pyx_k_d_MIDNSHP_X, sizeof(__pyx_k_d_MIDNSHP_X), 0, 0, 1, 0},
  {&__pyx_n_s_data_hash, __pyx_k_data_hash, sizeof(__pyx_k_data_hash), 0, 0, 1, 1},
  {&__pyx_n_s_data_list, __pyx_k_data_list, sizeof(__pyx_k_data_list), 0, 0, 1, 1},
  {&__pyx_n_s_default_flank_length, __pyx_k_default_flank_length, sizeof(__pyx_k_default_flank_length), 0, 0, 1, 1},
  {&__pyx_n_s_default_max_sv_test, __pyx_k_default_max_sv_test, sizeof(__pyx_k_default_max_sv_test), 0, 0, 1, 1},
  {&__pyx_n_s_default_read_length, __pyx_k_default_read_length, sizeof(__pyx_k_default_read_length), 0, 0, 1, 1},
  {&__pyx_n_s_del, __pyx_k_del, sizeof(__pyx_k_del), 0, 0, 1, 1},
  {&__pyx_n_s_dev_off, __pyx_k_dev_off, sizeof(__pyx_k_dev_off), 0, 0, 1, 1},
  {&__pyx_n_s_diagnal, __pyx_k_diagnal, sizeof(__pyx_k_diagnal), 0, 0, 1, 1},
  {&__pyx_n_s_dim1, __pyx_k_dim1, sizeof(__pyx_k_dim1), 0, 0, 1, 1},
  {&__pyx_n_s_dim2, __pyx_k_dim2, sizeof(__pyx_k_dim2), 0, 0, 1, 1},
  {&__pyx_n_s_dis_10perc, __pyx_k_dis_10perc, sizeof(__pyx_k_dis_10perc), 0, 0, 1, 1},
  {&__pyx_n_s_dis_cff, __pyx_k_dis_cff, sizeof(__pyx_k_dis_cff), 0, 0, 1, 1},
  {&__pyx_n_s_dis_clu, __pyx_k_dis_clu, sizeof(__pyx_k_dis_clu), 0, 0, 1, 1},
  {&__pyx_n_s_dis_cluster, __pyx_k_dis_cluster, sizeof(__pyx_k_dis_cluster), 0, 0, 1, 1},
  {&__pyx_n_s_dis_cluster_2, __pyx_k_dis_cluster_2, sizeof(__pyx_k_dis_cluster_2), 0, 0, 1, 1},
  {&__pyx_n_s_dis_dup_check, __pyx_k_dis_dup_check, sizeof(__pyx_k_dis_dup_check), 0, 0, 1, 1},
  {&__pyx_n_s_dis_range, __pyx_k_dis_range, sizeof(__pyx_k_dis_range), 0, 0, 1, 1},
  {&__pyx_n_s_dis_to_anti_diagnal, __pyx_k_dis_to_anti_diagnal, sizeof(__pyx_k_dis_to_anti_diagnal), 0, 0, 1, 1},
  {&__pyx_n_s_dis_to_diagnal, __pyx_k_dis_to_diagnal, sizeof(__pyx_k_dis_to_diagnal), 0, 0, 1, 1},
  {&__pyx_n_s_dis_to_diagnal_list, __pyx_k_dis_to_diagnal_list, sizeof(__pyx_k_dis_to_diagnal_list), 0, 0, 1, 1},
  {&__pyx_n_s_dis_to_diagnal_most_abundant_def, __pyx_k_dis_to_diagnal_most_abundant_def, sizeof(__pyx_k_dis_to_diagnal_most_abundant_def), 0, 0, 1, 1},
  {&__pyx_n_s_distance, __pyx_k_distance, sizeof(__pyx_k_distance), 0, 0, 1, 1},
  {&__pyx_n_s_distortion, __pyx_k_distortion, sizeof(__pyx_k_distortion), 0, 0, 1, 1},
  {&__pyx_n_s_dot_cluster1, __pyx_k_dot_cluster1, sizeof(__pyx_k_dot_cluster1), 0, 0, 1, 1},
  {&__pyx_n_s_dot_cluster2, __pyx_k_dot_cluster2, sizeof(__pyx_k_dot_cluster2), 0, 0, 1, 1},
  {&__pyx_n_s_dot_pos, __pyx_k_dot_pos, sizeof(__pyx_k_dot_pos), 0, 0, 1, 1},
  {&__pyx_n_s_dot_to_line, __pyx_k_dot_to_line, sizeof(__pyx_k_dot_to_line), 0, 0, 1, 1},
  {&__pyx_n_s_dotdata, __pyx_k_dotdata, sizeof(__pyx_k_dotdata), 0, 0, 1, 1},
  {&__pyx_n_s_dotdata_list, __pyx_k_dotdata_list, sizeof(__pyx_k_dotdata_list), 0, 0, 1, 1},
  {&__pyx_n_s_dotdata_qual_check, __pyx_k_dotdata_qual_check, sizeof(__pyx_k_dotdata_qual_check), 0, 0, 1, 1},
  {&__pyx_n_s_dotdata_record, __pyx_k_dotdata_record, sizeof(__pyx_k_dotdata_record), 0, 0, 1, 1},
  {&__pyx_n_s_dup_block, __pyx_k_dup_block, sizeof(__pyx_k_dup_block), 0, 0, 1, 1},
  {&__pyx_n_s_dup_block_bps, __pyx_k_dup_block_bps, sizeof(__pyx_k_dup_block_bps), 0, 0, 1, 1},
  {&__pyx_n_s_dup_block_combine, __pyx_k_dup_block_combine, sizeof(__pyx_k_dup_block_combine), 0, 0, 1, 1},
  {&__pyx_n_s_dup_block_combined, __pyx_k_dup_block_combined, sizeof(__pyx_k_dup_block_combined), 0, 0, 1, 1},
  {&__pyx_n_s_dup_block_combined_qc, __pyx_k_dup_block_combined_qc, sizeof(__pyx_k_dup_block_combined_qc), 0, 0, 1, 1},
  {&__pyx_n_s_dup_block_kept_qc, __pyx_k_dup_block_kept_qc, sizeof(__pyx_k_dup_block_kept_qc), 0, 0, 1, 1},
  {&__pyx_n_s_dup_count, __pyx_k_dup_count, sizeof(__pyx_k_dup_count), 0, 0, 1, 1},
  {&__pyx_n_s_dup_dis, __pyx_k_dup_dis, sizeof(__pyx_k_dup_dis), 0, 0, 1, 1},
  {&__pyx_n_s_dup_inv_dup_bps_produce, __pyx_k_dup_inv_dup_bps_produce, sizeof(__pyx_k_dup_inv_dup_bps_produce), 0, 0, 1, 1},
  {&__pyx_n_s_dup_inv_ref_alt_bps_produce, __pyx_k_dup_inv_ref_alt_bps_produce, sizeof(__pyx_k_dup_inv_ref_alt_bps_produce), 0, 0, 1, 1},
  {&__pyx_n_s_dup_let_recombind, __pyx_k_dup_let_recombind, sizeof(__pyx_k_dup_let_recombind), 0, 0, 1, 1},
  {&__pyx_n_s_dup_test, __pyx_k_dup_test, sizeof(__pyx_k_dup_test), 0, 0, 1, 1},
  {&__pyx_n_s_editDistance, __pyx_k_editDistance, sizeof(__pyx_k_editDistance), 0, 0, 1, 1},
  {&__pyx_n_s_edit_dis_setup, __pyx_k_edit_dis_setup, sizeof(__pyx_k_edit_dis_setup), 0, 0, 1, 1},
  {&__pyx_n_s_end, __pyx_k_end, sizeof(__pyx_k_end), 0, 0, 1, 1},
  {&__pyx_n_s_eu_dis_abs, __pyx_k_eu_dis_abs, sizeof(__pyx_k_eu_dis_abs), 0, 0, 1, 1},
  {&__pyx_n_s_eu_dis_abs_calcu, __pyx_k_eu_dis_abs_calcu, sizeof(__pyx_k_eu_dis_abs_calcu), 0, 0, 1, 1},
  {&__pyx_n_s_eu_dis_dir_calcu, __pyx_k_eu_dis_dir_calcu, sizeof(__pyx_k_eu_dis_dir_calcu), 0, 0, 1, 1},
  {&__pyx_n_s_eu_dis_dots_within_10perc, __pyx_k_eu_dis_dots_within_10perc, sizeof(__pyx_k_eu_dis_dots_within_10perc), 0, 0, 1, 1},
  {&__pyx_n_s_eu_dis_reg_calcu, __pyx_k_eu_dis_reg_calcu, sizeof(__pyx_k_eu_dis_reg_calcu), 0, 0, 1, 1},
  {&__pyx_n_s_eu_dis_reg_dup_block_calcu, __pyx_k_eu_dis_reg_dup_block_calcu, sizeof(__pyx_k_eu_dis_reg_dup_block_calcu), 0, 0, 1, 1},
  {&__pyx_n_s_eu_dis_region_calcu, __pyx_k_eu_dis_region_calcu, sizeof(__pyx_k_eu_dis_region_calcu), 0, 0, 1, 1},
  {&__pyx_n_s_eu_dis_single_dot, __pyx_k_eu_dis_single_dot, sizeof(__pyx_k_eu_dis_single_dot), 0, 0, 1, 1},
  {&__pyx_n_s_eu_y_vs_x_ratio_calcu, __pyx_k_eu_y_vs_x_ratio_calcu, sizeof(__pyx_k_eu_y_vs_x_ratio_calcu), 0, 0, 1, 1},
  {&__pyx_n_s_eu_y_vs_x_ratio_calcu_locals_lam, __pyx_k_eu_y_vs_x_ratio_calcu_locals_lam, sizeof(__pyx_k_eu_y_vs_x_ratio_calcu_locals_lam), 0, 0, 1, 1},
  {&__pyx_n_s_eu_y_vs_x_ratio_single_dot, __pyx_k_eu_y_vs_x_ratio_single_dot, sizeof(__pyx_k_eu_y_vs_x_ratio_single_dot), 0, 0, 1, 1},
  {&__pyx_n_s_euclidean, __pyx_k_euclidean, sizeof(__pyx_k_euclidean), 0, 0, 1, 1},
  {&__pyx_kp_s_fai, __pyx_k_fai, sizeof(__pyx_k_fai), 0, 0, 1, 0},
  {&__pyx_n_s_fbam, __pyx_k_fbam, sizeof(__pyx_k_fbam), 0, 0, 1, 1},
  {&__pyx_n_s_file, __pyx_k_file, sizeof(__pyx_k_file), 0, 0, 1, 1},
  {&__pyx_n_s_file_out, __pyx_k_file_out, sizeof(__pyx_k_file_out), 0, 0, 1, 1},
  {&__pyx_n_s_fin, __pyx_k_fin, sizeof(__pyx_k_fin), 0, 0, 1, 1},
  {&__pyx_n_s_find_longest_list, __pyx_k_find_longest_list, sizeof(__pyx_k_find_longest_list), 0, 0, 1, 1},
  {&__pyx_n_s_finditer, __pyx_k_finditer, sizeof(__pyx_k_finditer), 0, 0, 1, 1},
  {&__pyx_n_s_fit, __pyx_k_fit, sizeof(__pyx_k_fit), 0, 0, 1, 1},
  {&__pyx_n_s_fit_predict, __pyx_k_fit_predict, sizeof(__pyx_k_fit_predict), 0, 0, 1, 1},
  {&__pyx_n_s_flag, __pyx_k_flag, sizeof(__pyx_k_flag), 0, 0, 1, 1},
  {&__pyx_n_s_flag_y, __pyx_k_flag_y, sizeof(__pyx_k_flag_y), 0, 0, 1, 1},
  {&__pyx_n_s_flank_length, __pyx_k_flank_length, sizeof(__pyx_k_flank_length), 0, 0, 1, 1},
  {&__pyx_n_s_flank_length_calculate, __pyx_k_flank_length_calculate, sizeof(__pyx_k_flank_length_calculate), 0, 0, 1, 1},
  {&__pyx_n_s_fmin, __pyx_k_fmin, sizeof(__pyx_k_fmin), 0, 0, 1, 1},
  {&__pyx_n_s_fo, __pyx_k_fo, sizeof(__pyx_k_fo), 0, 0, 1, 1},
  {&__pyx_n_s_fref, __pyx_k_fref, sizeof(__pyx_k_fref), 0, 0, 1, 1},
  {&__pyx_n_s_full, __pyx_k_full, sizeof(__pyx_k_full), 0, 0, 1, 1},
  {&__pyx_n_s_g, __pyx_k_g, sizeof(__pyx_k_g), 0, 0, 1, 1},
  {&__pyx_n_s_gap, __pyx_k_gap, sizeof(__pyx_k_gap), 0, 0, 1, 1},
  {&__pyx_n_s_gaussian_kde, __pyx_k_gaussian_kde, sizeof(__pyx_k_gaussian_kde), 0, 0, 1, 1},
  {&__pyx_n_s_geno, __pyx_k_geno, sizeof(__pyx_k_geno), 0, 0, 1, 1},
  {&__pyx_n_s_genoCN_extract, __pyx_k_genoCN_extract, sizeof(__pyx_k_genoCN_extract), 0, 0, 1, 1},
  {&__pyx_n_s_geno_value, __pyx_k_geno_value, sizeof(__pyx_k_geno_value), 0, 0, 1, 1},
  {&__pyx_n_s_genotype_extract, __pyx_k_genotype_extract, sizeof(__pyx_k_genotype_extract), 0, 0, 1, 1},
  {&__pyx_n_s_get, __pyx_k_get, sizeof(__pyx_k_get), 0, 0, 1, 1},
  {&__pyx_n_s_grDevices, __pyx_k_grDevices, sizeof(__pyx_k_grDevices), 0, 0, 1, 1},
  {&__pyx_n_s_graphics, __pyx_k_graphics, sizeof(__pyx_k_graphics), 0, 0, 1, 1},
  {&__pyx_n_s_grdevices, __pyx_k_grdevices, sizeof(__pyx_k_grdevices), 0, 0, 1, 1},
  {&__pyx_n_s_group1, __pyx_k_group1, sizeof(__pyx_k_group1), 0, 0, 1, 1},
  {&__pyx_n_s_groups, __pyx_k_groups, sizeof(__pyx_k_groups), 0, 0, 1, 1},
  {&__pyx_n_s_h, __pyx_k_h, sizeof(__pyx_k_h), 0, 0, 1, 1},
  {&__pyx_n_s_height, __pyx_k_height, sizeof(__pyx_k_height), 0, 0, 1, 1},
  {&__pyx_n_s_hit, __pyx_k_hit, sizeof(__pyx_k_hit), 0, 0, 1, 1},
  {&__pyx_n_s_hits, __pyx_k_hits, sizeof(__pyx_k_hits), 0, 0, 1, 1},
  {&__pyx_n_s_i, __pyx_k_i, sizeof(__pyx_k_i), 0, 0, 1, 1},
  {&__pyx_n_s_iCost, __pyx_k_iCost, sizeof(__pyx_k_iCost), 0, 0, 1, 1},
  {&__pyx_n_s_iDist, __pyx_k_iDist, sizeof(__pyx_k_iDist), 0, 0, 1, 1},
  {&__pyx_n_s_ideal_list_length, __pyx_k_ideal_list_length, sizeof(__pyx_k_ideal_list_length), 0, 0, 1, 1},
  {&__pyx_n_s_idx, __pyx_k_idx, sizeof(__pyx_k_idx), 0, 0, 1, 1},
  {&__pyx_n_s_import, __pyx_k_import, sizeof(__pyx_k_import), 0, 0, 1, 1},
  {&__pyx_n_s_importr, __pyx_k_importr, sizeof(__pyx_k_importr), 0, 0, 1, 1},
  {&__pyx_n_s_index, __pyx_k_index, sizeof(__pyx_k_index), 0, 0, 1, 1},
  {&__pyx_n_s_inf, __pyx_k_inf, sizeof(__pyx_k_inf), 0, 0, 1, 1},
  {&__pyx_n_s_info, __pyx_k_info, sizeof(__pyx_k_info), 0, 0, 1, 1},
  {&__pyx_n_s_info_list, __pyx_k_info_list, sizeof(__pyx_k_info_list), 0, 0, 1, 1},
  {&__pyx_n_s_init, __pyx_k_init, sizeof(__pyx_k_init), 0, 0, 1, 1},
  {&__pyx_n_s_ins_point, __pyx_k_ins_point, sizeof(__pyx_k_ins_point), 0, 0, 1, 1},
  {&__pyx_n_s_ins_pos, __pyx_k_ins_pos, sizeof(__pyx_k_ins_pos), 0, 0, 1, 1},
  {&__pyx_n_s_ins_seq, __pyx_k_ins_seq, sizeof(__pyx_k_ins_seq), 0, 0, 1, 1},
  {&__pyx_n_s_ins_seq_2, __pyx_k_ins_seq_2, sizeof(__pyx_k_ins_seq_2), 0, 0, 1, 1},
  {&__pyx_n_s_insert_block, __pyx_k_insert_block, sizeof(__pyx_k_insert_block), 0, 0, 1, 1},
  {&__pyx_kp_s_insert_point, __pyx_k_insert_point, sizeof(__pyx_k_insert_point), 0, 0, 1, 0},
  {&__pyx_n_s_insert_pos, __pyx_k_insert_pos, sizeof(__pyx_k_insert_pos), 0, 0, 1, 1},
  {&__pyx_n_s_intercept, __pyx_k_intercept, sizeof(__pyx_k_intercept), 0, 0, 1, 1},
  {&__pyx_n_s_intersect, __pyx_k_intersect, sizeof(__pyx_k_intersect), 0, 0, 1, 1},
  {&__pyx_n_s_interval_dis_calcu_max, __pyx_k_interval_dis_calcu_max, sizeof(__pyx_k_interval_dis_calcu_max), 0, 0, 1, 1},
  {&__pyx_n_s_inv, __pyx_k_inv, sizeof(__pyx_k_inv), 0, 0, 1, 1},
  {&__pyx_n_s_inversions, __pyx_k_inversions, sizeof(__pyx_k_inversions), 0, 0, 1, 1},
  {&__pyx_n_s_invert_base, __pyx_k_invert_base, sizeof(__pyx_k_invert_base), 0, 0, 1, 1},
  {&__pyx_n_s_inverted_sv, __pyx_k_inverted_sv, sizeof(__pyx_k_inverted_sv), 0, 0, 1, 1},
  {&__pyx_n_s_inverted_sv_2, __pyx_k_inverted_sv_2, sizeof(__pyx_k_inverted_sv_2), 0, 0, 1, 1},
  {&__pyx_n_s_inverted_sv_3, __pyx_k_inverted_sv_3, sizeof(__pyx_k_inverted_sv_3), 0, 0, 1, 1},
  {&__pyx_n_s_inverted_sv_new, __pyx_k_inverted_sv_new, sizeof(__pyx_k_inverted_sv_new), 0, 0, 1, 1},
  {&__pyx_n_s_isdir, __pyx_k_isdir, sizeof(__pyx_k_isdir), 0, 0, 1, 1},
  {&__pyx_n_s_isfile, __pyx_k_isfile, sizeof(__pyx_k_isfile), 0, 0, 1, 1},
  {&__pyx_n_s_isnan, __pyx_k_isnan, sizeof(__pyx_k_isnan), 0, 0, 1, 1},
  {&__pyx_n_s_itertools, __pyx_k_itertools, sizeof(__pyx_k_itertools), 0, 0, 1, 1},
  {&__pyx_n_s_j, __pyx_k_j, sizeof(__pyx_k_j), 0, 0, 1, 1},
  {&__pyx_n_s_join, __pyx_k_join, sizeof(__pyx_k_join), 0, 0, 1, 1},
  {&__pyx_n_s_k, __pyx_k_k, sizeof(__pyx_k_k), 0, 0, 1, 1},
  {&__pyx_n_s_k1, __pyx_k_k1, sizeof(__pyx_k_k1), 0, 0, 1, 1},
  {&__pyx_n_s_k1_hap, __pyx_k_k1_hap, sizeof(__pyx_k_k1_hap), 0, 0, 1, 1},
  {&__pyx_n_s_k2, __pyx_k_k2, sizeof(__pyx_k_k2), 0, 0, 1, 1},
  {&__pyx_n_s_k2_hap, __pyx_k_k2_hap, sizeof(__pyx_k_k2_hap), 0, 0, 1, 1},
  {&__pyx_n_s_k2_hap_new, __pyx_k_k2_hap_new, sizeof(__pyx_k_k2_hap_new), 0, 0, 1, 1},
  {&__pyx_n_s_k2_haps, __pyx_k_k2_haps, sizeof(__pyx_k_k2_haps), 0, 0, 1, 1},
  {&__pyx_kp_s_k_means, __pyx_k_k_means, sizeof(__pyx_k_k_means), 0, 0, 1, 0},
  {&__pyx_n_s_k_means_cluster, __pyx_k_k_means_cluster, sizeof(__pyx_k_k_means_cluster), 0, 0, 1, 1},
  {&__pyx_n_s_k_means_cluster_Predict, __pyx_k_k_means_cluster_Predict, sizeof(__pyx_k_k_means_cluster_Predict), 0, 0, 1, 1},
  {&__pyx_n_s_ka, __pyx_k_ka, sizeof(__pyx_k_ka), 0, 0, 1, 1},
  {&__pyx_n_s_kb, __pyx_k_kb, sizeof(__pyx_k_kb), 0, 0, 1, 1},
  {&__pyx_n_s_kc, __pyx_k_kc, sizeof(__pyx_k_kc), 0, 0, 1, 1},
  {&__pyx_n_s_kd, __pyx_k_kd, sizeof(__pyx_k_kd), 0, 0, 1, 1},
  {&__pyx_n_s_keep_rec, __pyx_k_keep_rec, sizeof(__pyx_k_keep_rec), 0, 0, 1, 1},
  {&__pyx_n_s_kept_dot, __pyx_k_kept_dot, sizeof(__pyx_k_kept_dot), 0, 0, 1, 1},
  {&__pyx_n_s_kept_dot_anti_diag, __pyx_k_kept_dot_anti_diag, sizeof(__pyx_k_kept_dot_anti_diag), 0, 0, 1, 1},
  {&__pyx_n_s_kept_dot_cluster, __pyx_k_kept_dot_cluster, sizeof(__pyx_k_kept_dot_cluster), 0, 0, 1, 1},
  {&__pyx_n_s_kept_dot_diag, __pyx_k_kept_dot_diag, sizeof(__pyx_k_kept_dot_diag), 0, 0, 1, 1},
  {&__pyx_n_s_kept_dot_pos, __pyx_k_kept_dot_pos, sizeof(__pyx_k_kept_dot_pos), 0, 0, 1, 1},
  {&__pyx_n_s_kept_dot_x, __pyx_k_kept_dot_x, sizeof(__pyx_k_kept_dot_x), 0, 0, 1, 1},
  {&__pyx_n_s_kept_dot_y, __pyx_k_kept_dot_y, sizeof(__pyx_k_kept_dot_y), 0, 0, 1, 1},
  {&__pyx_n_s_kept_dup, __pyx_k_kept_dup, sizeof(__pyx_k_kept_dup), 0, 0, 1, 1},
  {&__pyx_n_s_kept_lines_size_filter, __pyx_k_kept_lines_size_filter, sizeof(__pyx_k_kept_lines_size_filter), 0, 0, 1, 1},
  {&__pyx_n_s_kept_list, __pyx_k_kept_list, sizeof(__pyx_k_kept_list), 0, 0, 1, 1},
  {&__pyx_n_s_kept_list1, __pyx_k_kept_list1, sizeof(__pyx_k_kept_list1), 0, 0, 1, 1},
  {&__pyx_n_s_kept_list2, __pyx_k_kept_list2, sizeof(__pyx_k_kept_list2), 0, 0, 1, 1},
  {&__pyx_n_s_kept_region, __pyx_k_kept_region, sizeof(__pyx_k_kept_region), 0, 0, 1, 1},
  {&__pyx_n_s_key, __pyx_k_key, sizeof(__pyx_k_key), 0, 0, 1, 1},
  {&__pyx_n_s_key_modify, __pyx_k_key_modify, sizeof(__pyx_k_key_modify), 0, 0, 1, 1},
  {&__pyx_n_s_keylen, __pyx_k_keylen, sizeof(__pyx_k_keylen), 0, 0, 1, 1},
  {&__pyx_n_s_keys, __pyx_k_keys, sizeof(__pyx_k_keys), 0, 0, 1, 1},
  {&__pyx_n_s_km, __pyx_k_km, sizeof(__pyx_k_km), 0, 0, 1, 1},
  {&__pyx_n_s_kmeans, __pyx_k_kmeans, sizeof(__pyx_k_kmeans), 0, 0, 1, 1},
  {&__pyx_n_s_kmeansi, __pyx_k_kmeansi, sizeof(__pyx_k_kmeansi), 0, 0, 1, 1},
  {&__pyx_n_s_kmerhits, __pyx_k_kmerhits, sizeof(__pyx_k_kmerhits), 0, 0, 1, 1},
  {&__pyx_n_s_kmerlen, __pyx_k_kmerlen, sizeof(__pyx_k_kmerlen), 0, 0, 1, 1},
  {&__pyx_n_s_ks, __pyx_k_ks, sizeof(__pyx_k_ks), 0, 0, 1, 1},
  {&__pyx_n_s_ks_picked, __pyx_k_ks_picked, sizeof(__pyx_k_ks_picked), 0, 0, 1, 1},
  {&__pyx_n_s_labels, __pyx_k_labels, sizeof(__pyx_k_labels), 0, 0, 1, 1},
  {&__pyx_n_s_labels_2, __pyx_k_labels_2, sizeof(__pyx_k_labels_2), 0, 0, 1, 1},
  {&__pyx_n_s_left_new, __pyx_k_left_new, sizeof(__pyx_k_left_new), 0, 0, 1, 1},
  {&__pyx_n_s_left_part, __pyx_k_left_part, sizeof(__pyx_k_left_part), 0, 0, 1, 1},
  {&__pyx_n_s_lenght_list, __pyx_k_lenght_list, sizeof(__pyx_k_lenght_list), 0, 0, 1, 1},
  {&__pyx_n_s_length, __pyx_k_length, sizeof(__pyx_k_length), 0, 0, 1, 1},
  {&__pyx_n_s_let, __pyx_k_let, sizeof(__pyx_k_let), 0, 0, 1, 1},
  {&__pyx_n_s_let_hash, __pyx_k_let_hash, sizeof(__pyx_k_let_hash), 0, 0, 1, 1},
  {&__pyx_n_s_let_single, __pyx_k_let_single, sizeof(__pyx_k_let_single), 0, 0, 1, 1},
  {&__pyx_n_s_let_to_block_info, __pyx_k_let_to_block_info, sizeof(__pyx_k_let_to_block_info), 0, 0, 1, 1},
  {&__pyx_n_s_letter_split, __pyx_k_letter_split, sizeof(__pyx_k_letter_split), 0, 0, 1, 1},
  {&__pyx_n_s_letter_subgroup, __pyx_k_letter_subgroup, sizeof(__pyx_k_letter_subgroup), 0, 0, 1, 1},
  {&__pyx_n_s_line, __pyx_k_line, sizeof(__pyx_k_line), 0, 0, 1, 1},
  {&__pyx_n_s_linregress, __pyx_k_linregress, sizeof(__pyx_k_linregress), 0, 0, 1, 1},
  {&__pyx_n_s_list, __pyx_k_list, sizeof(__pyx_k_list), 0, 0, 1, 1},
  {&__pyx_n_s_list_bps, __pyx_k_list_bps, sizeof(__pyx_k_list_bps), 0, 0, 1, 1},
  {&__pyx_n_s_list_dotdata, __pyx_k_list_dotdata, sizeof(__pyx_k_list_dotdata), 0, 0, 1, 1},
  {&__pyx_n_s_list_set, __pyx_k_list_set, sizeof(__pyx_k_list_set), 0, 0, 1, 1},
  {&__pyx_n_s_list_unify, __pyx_k_list_unify, sizeof(__pyx_k_list_unify), 0, 0, 1, 1},
  {&__pyx_n_s_listdir, __pyx_k_listdir, sizeof(__pyx_k_listdir), 0, 0, 1, 1},
  {&__pyx_n_s_log10, __pyx_k_log10, sizeof(__pyx_k_log10), 0, 0, 1, 1},
  {&__pyx_n_s_lookup, __pyx_k_lookup, sizeof(__pyx_k_lookup), 0, 0, 1, 1},
  {&__pyx_n_s_m, __pyx_k_m, sizeof(__pyx_k_m), 0, 0, 1, 1},
  {&__pyx_n_s_mCost, __pyx_k_mCost, sizeof(__pyx_k_mCost), 0, 0, 1, 1},
  {&__pyx_n_s_mDist, __pyx_k_mDist, sizeof(__pyx_k_mDist), 0, 0, 1, 1},
  {&__pyx_n_s_main, __pyx_k_main, sizeof(__pyx_k_main), 0, 0, 1, 1},
  {&__pyx_n_s_make_event_figure_1, __pyx_k_make_event_figure_1, sizeof(__pyx_k_make_event_figure_1), 0, 0, 1, 1},
  {&__pyx_n_s_math, __pyx_k_math, sizeof(__pyx_k_math), 0, 0, 1, 1},
  {&__pyx_n_s_matplotlib_pyplot, __pyx_k_matplotlib_pyplot, sizeof(__pyx_k_matplotlib_pyplot), 0, 0, 1, 1},
  {&__pyx_n_s_max, __pyx_k_max, sizeof(__pyx_k_max), 0, 0, 1, 1},
  {&__pyx_n_s_mean, __pyx_k_mean, sizeof(__pyx_k_mean), 0, 0, 1, 1},
  {&__pyx_n_s_median, __pyx_k_median, sizeof(__pyx_k_median), 0, 0, 1, 1},
  {&__pyx_n_s_mfrow, __pyx_k_mfrow, sizeof(__pyx_k_mfrow), 0, 0, 1, 1},
  {&__pyx_n_s_min, __pyx_k_min, sizeof(__pyx_k_min), 0, 0, 1, 1},
  {&__pyx_n_s_minimize_pacbio_read_list, __pyx_k_minimize_pacbio_read_list, sizeof(__pyx_k_minimize_pacbio_read_list), 0, 0, 1, 1},
  {&__pyx_n_s_miss_bp, __pyx_k_miss_bp, sizeof(__pyx_k_miss_bp), 0, 0, 1, 1},
  {&__pyx_kp_s_mkdir_s, __pyx_k_mkdir_s, sizeof(__pyx_k_mkdir_s), 0, 0, 1, 0},
  {&__pyx_n_s_move_matrix, __pyx_k_move_matrix, sizeof(__pyx_k_move_matrix), 0, 0, 1, 1},
  {&__pyx_n_s_n, __pyx_k_n, sizeof(__pyx_k_n), 0, 0, 1, 1},
  {&__pyx_n_s_n_clusters, __pyx_k_n_clusters, sizeof(__pyx_k_n_clusters), 0, 0, 1, 1},
  {&__pyx_n_s_neg_values, __pyx_k_neg_values, sizeof(__pyx_k_neg_values), 0, 0, 1, 1},
  {&__pyx_n_s_new_juncs, __pyx_k_new_juncs, sizeof(__pyx_k_new_juncs), 0, 0, 1, 1},
  {&__pyx_n_s_new_read_rec, __pyx_k_new_read_rec, sizeof(__pyx_k_new_read_rec), 0, 0, 1, 1},
  {&__pyx_n_s_new_start_dis, __pyx_k_new_start_dis, sizeof(__pyx_k_new_start_dis), 0, 0, 1, 1},
  {&__pyx_n_s_no_dup_block, __pyx_k_no_dup_block, sizeof(__pyx_k_no_dup_block), 0, 0, 1, 1},
  {&__pyx_n_s_np, __pyx_k_np, sizeof(__pyx_k_np), 0, 0, 1, 1},
  {&__pyx_n_s_nparam_density, __pyx_k_nparam_density, sizeof(__pyx_k_nparam_density), 0, 0, 1, 1},
  {&__pyx_n_s_nth_base, __pyx_k_nth_base, sizeof(__pyx_k_nth_base), 0, 0, 1, 1},
  {&__pyx_n_s_number_cluster, __pyx_k_number_cluster, sizeof(__pyx_k_number_cluster), 0, 0, 1, 1},
  {&__pyx_n_s_numpy, __pyx_k_numpy, sizeof(__pyx_k_numpy), 0, 0, 1, 1},
  {&__pyx_n_s_one_dimention_cluster_by_gap, __pyx_k_one_dimention_cluster_by_gap, sizeof(__pyx_k_one_dimention_cluster_by_gap), 0, 0, 1, 1},
  {&__pyx_n_s_open, __pyx_k_open, sizeof(__pyx_k_open), 0, 0, 1, 1},
  {&__pyx_n_s_opt_dist, __pyx_k_opt_dist, sizeof(__pyx_k_opt_dist), 0, 0, 1, 1},
  {&__pyx_n_s_optimize, __pyx_k_optimize, sizeof(__pyx_k_optimize), 0, 0, 1, 1},
  {&__pyx_n_s_original_pos, __pyx_k_original_pos, sizeof(__pyx_k_original_pos), 0, 0, 1, 1},
  {&__pyx_n_s_oroginal_reference, __pyx_k_oroginal_reference, sizeof(__pyx_k_oroginal_reference), 0, 0, 1, 1},
  {&__pyx_n_s_os, __pyx_k_os, sizeof(__pyx_k_os), 0, 0, 1, 1},
  {&__pyx_n_s_other, __pyx_k_other, sizeof(__pyx_k_other), 0, 0, 1, 1},
  {&__pyx_n_s_other_cluster, __pyx_k_other_cluster, sizeof(__pyx_k_other_cluster), 0, 0, 1, 1},
  {&__pyx_n_s_out, __pyx_k_out, sizeof(__pyx_k_out), 0, 0, 1, 1},
  {&__pyx_n_s_out1, __pyx_k_out1, sizeof(__pyx_k_out1), 0, 0, 1, 1},
  {&__pyx_n_s_out2, __pyx_k_out2, sizeof(__pyx_k_out2), 0, 0, 1, 1},
  {&__pyx_n_s_out_dots, __pyx_k_out_dots, sizeof(__pyx_k_out_dots), 0, 0, 1, 1},
  {&__pyx_n_s_out_figure_name, __pyx_k_out_figure_name, sizeof(__pyx_k_out_figure_name), 0, 0, 1, 1},
  {&__pyx_n_s_out_hash, __pyx_k_out_hash, sizeof(__pyx_k_out_hash), 0, 0, 1, 1},
  {&__pyx_n_s_out_list, __pyx_k_out_list, sizeof(__pyx_k_out_list), 0, 0, 1, 1},
  {&__pyx_n_s_out_name, __pyx_k_out_name, sizeof(__pyx_k_out_name), 0, 0, 1, 1},
  {&__pyx_n_s_out_new, __pyx_k_out_new, sizeof(__pyx_k_out_new), 0, 0, 1, 1},
  {&__pyx_n_s_out_new_2, __pyx_k_out_new_2, sizeof(__pyx_k_out_new_2), 0, 0, 1, 1},
  {&__pyx_n_s_out_pos, __pyx_k_out_pos, sizeof(__pyx_k_out_pos), 0, 0, 1, 1},
  {&__pyx_n_s_out_total, __pyx_k_out_total, sizeof(__pyx_k_out_total), 0, 0, 1, 1},
  {&__pyx_n_s_overlap, __pyx_k_overlap, sizeof(__pyx_k_overlap), 0, 0, 1, 1},
  {&__pyx_n_s_overlap_count, __pyx_k_overlap_count, sizeof(__pyx_k_overlap_count), 0, 0, 1, 1},
  {&__pyx_n_s_overlap_portion, __pyx_k_overlap_portion, sizeof(__pyx_k_overlap_portion), 0, 0, 1, 1},
  {&__pyx_n_s_par, __pyx_k_par, sizeof(__pyx_k_par), 0, 0, 1, 1},
  {&__pyx_n_s_path, __pyx_k_path, sizeof(__pyx_k_path), 0, 0, 1, 1},
  {&__pyx_n_s_path_mkdir, __pyx_k_path_mkdir, sizeof(__pyx_k_path_mkdir), 0, 0, 1, 1},
  {&__pyx_n_s_path_modify, __pyx_k_path_modify, sizeof(__pyx_k_path_modify), 0, 0, 1, 1},
  {&__pyx_n_s_pbam, __pyx_k_pbam, sizeof(__pyx_k_pbam), 0, 0, 1, 1},
  {&__pyx_n_s_pch, __pyx_k_pch, sizeof(__pyx_k_pch), 0, 0, 1, 1},
  {&__pyx_n_s_pcigar, __pyx_k_pcigar, sizeof(__pyx_k_pcigar), 0, 0, 1, 1},
  {&__pyx_n_s_pdf, __pyx_k_pdf, sizeof(__pyx_k_pdf), 0, 0, 1, 1},
  {&__pyx_n_s_pi, __pyx_k_pi, sizeof(__pyx_k_pi), 0, 0, 1, 1},
  {&__pyx_n_s_pin, __pyx_k_pin, sizeof(__pyx_k_pin), 0, 0, 1, 1},
  {&__pyx_n_s_plot, __pyx_k_plot, sizeof(__pyx_k_plot), 0, 0, 1, 1},
  {&__pyx_n_s_plotting, __pyx_k_plotting, sizeof(__pyx_k_plotting), 0, 0, 1, 1},
  {&__pyx_n_s_plt, __pyx_k_plt, sizeof(__pyx_k_plt), 0, 0, 1, 1},
  {&__pyx_n_s_png, __pyx_k_png, sizeof(__pyx_k_png), 0, 0, 1, 1},
  {&__pyx_n_s_points, __pyx_k_points, sizeof(__pyx_k_points), 0, 0, 1, 1},
  {&__pyx_n_s_polarity_detect, __pyx_k_polarity_detect, sizeof(__pyx_k_polarity_detect), 0, 0, 1, 1},
  {&__pyx_n_s_popen, __pyx_k_popen, sizeof(__pyx_k_popen), 0, 0, 1, 1},
  {&__pyx_n_s_pos_check, __pyx_k_pos_check, sizeof(__pyx_k_pos_check), 0, 0, 1, 1},
  {&__pyx_n_s_pos_compare, __pyx_k_pos_compare, sizeof(__pyx_k_pos_compare), 0, 0, 1, 1},
  {&__pyx_n_s_pos_rec, __pyx_k_pos_rec, sizeof(__pyx_k_pos_rec), 0, 0, 1, 1},
  {&__pyx_n_s_pos_values, __pyx_k_pos_values, sizeof(__pyx_k_pos_values), 0, 0, 1, 1},
  {&__pyx_n_s_pref, __pyx_k_pref, sizeof(__pyx_k_pref), 0, 0, 1, 1},
  {&__pyx_n_s_print, __pyx_k_print, sizeof(__pyx_k_print), 0, 0, 1, 1},
  {&__pyx_n_s_product, __pyx_k_product, sizeof(__pyx_k_product), 0, 0, 1, 1},
  {&__pyx_n_s_qual_check_repetitive_region, __pyx_k_qual_check_repetitive_region, sizeof(__pyx_k_qual_check_repetitive_region), 0, 0, 1, 1},
  {&__pyx_n_s_qual_value, __pyx_k_qual_value, sizeof(__pyx_k_qual_value), 0, 0, 1, 1},
  {&__pyx_n_s_r, __pyx_k_r, sizeof(__pyx_k_r), 0, 0, 1, 1},
  {&__pyx_n_s_random, __pyx_k_random, sizeof(__pyx_k_random), 0, 0, 1, 1},
  {&__pyx_n_s_range, __pyx_k_range, sizeof(__pyx_k_range), 0, 0, 1, 1},
  {&__pyx_n_s_range_cluster, __pyx_k_range_cluster, sizeof(__pyx_k_range_cluster), 0, 0, 1, 1},
  {&__pyx_n_s_ratio, __pyx_k_ratio, sizeof(__pyx_k_ratio), 0, 0, 1, 1},
  {&__pyx_n_s_ratio_new, __pyx_k_ratio_new, sizeof(__pyx_k_ratio_new), 0, 0, 1, 1},
  {&__pyx_n_s_re, __pyx_k_re, sizeof(__pyx_k_re), 0, 0, 1, 1},
  {&__pyx_n_s_read_rec, __pyx_k_read_rec, sizeof(__pyx_k_read_rec), 0, 0, 1, 1},
  {&__pyx_n_s_readline, __pyx_k_readline, sizeof(__pyx_k_readline), 0, 0, 1, 1},
  {&__pyx_n_s_rec, __pyx_k_rec, sizeof(__pyx_k_rec), 0, 0, 1, 1},
  {&__pyx_n_s_rec_pos, __pyx_k_rec_pos, sizeof(__pyx_k_rec_pos), 0, 0, 1, 1},
  {&__pyx_n_s_reca, __pyx_k_reca, sizeof(__pyx_k_reca), 0, 0, 1, 1},
  {&__pyx_n_s_recb, __pyx_k_recb, sizeof(__pyx_k_recb), 0, 0, 1, 1},
  {&__pyx_n_s_red, __pyx_k_red, sizeof(__pyx_k_red), 0, 0, 1, 1},
  {&__pyx_n_s_ref, __pyx_k_ref, sizeof(__pyx_k_ref), 0, 0, 1, 1},
  {&__pyx_n_s_ref_allele, __pyx_k_ref_allele, sizeof(__pyx_k_ref_allele), 0, 0, 1, 1},
  {&__pyx_n_s_ref_anti_diag_clean_dotdata, __pyx_k_ref_anti_diag_clean_dotdata, sizeof(__pyx_k_ref_anti_diag_clean_dotdata), 0, 0, 1, 1},
  {&__pyx_n_s_ref_anti_diag_kept_segs, __pyx_k_ref_anti_diag_kept_segs, sizeof(__pyx_k_ref_anti_diag_kept_segs), 0, 0, 1, 1},
  {&__pyx_n_s_ref_bps, __pyx_k_ref_bps, sizeof(__pyx_k_ref_bps), 0, 0, 1, 1},
  {&__pyx_n_s_ref_bps_new, __pyx_k_ref_bps_new, sizeof(__pyx_k_ref_bps_new), 0, 0, 1, 1},
  {&__pyx_n_s_ref_clean_dotdata, __pyx_k_ref_clean_dotdata, sizeof(__pyx_k_ref_clean_dotdata), 0, 0, 1, 1},
  {&__pyx_n_s_ref_deviate_lines_calcu, __pyx_k_ref_deviate_lines_calcu, sizeof(__pyx_k_ref_deviate_lines_calcu), 0, 0, 1, 1},
  {&__pyx_n_s_ref_dotdata, __pyx_k_ref_dotdata, sizeof(__pyx_k_ref_dotdata), 0, 0, 1, 1},
  {&__pyx_n_s_ref_juncs, __pyx_k_ref_juncs, sizeof(__pyx_k_ref_juncs), 0, 0, 1, 1},
  {&__pyx_n_s_ref_kept_deviate, __pyx_k_ref_kept_deviate, sizeof(__pyx_k_ref_kept_deviate), 0, 0, 1, 1},
  {&__pyx_n_s_ref_kept_segs, __pyx_k_ref_kept_segs, sizeof(__pyx_k_ref_kept_segs), 0, 0, 1, 1},
  {&__pyx_n_s_ref_left, __pyx_k_ref_left, sizeof(__pyx_k_ref_left), 0, 0, 1, 1},
  {&__pyx_n_s_ref_left_new, __pyx_k_ref_left_new, sizeof(__pyx_k_ref_left_new), 0, 0, 1, 1},
  {&__pyx_n_s_ref_left_wings, __pyx_k_ref_left_wings, sizeof(__pyx_k_ref_left_wings), 0, 0, 1, 1},
  {&__pyx_n_s_ref_new_intercept, __pyx_k_ref_new_intercept, sizeof(__pyx_k_ref_new_intercept), 0, 0, 1, 1},
  {&__pyx_n_s_ref_ref_deviate_lines_calcu, __pyx_k_ref_ref_deviate_lines_calcu, sizeof(__pyx_k_ref_ref_deviate_lines_calcu), 0, 0, 1, 1},
  {&__pyx_n_s_ref_ref_deviate_lines_describe, __pyx_k_ref_ref_deviate_lines_describe, sizeof(__pyx_k_ref_ref_deviate_lines_describe), 0, 0, 1, 1},
  {&__pyx_n_s_ref_ref_lines, __pyx_k_ref_ref_lines, sizeof(__pyx_k_ref_ref_lines), 0, 0, 1, 1},
  {&__pyx_n_s_ref_region, __pyx_k_ref_region, sizeof(__pyx_k_ref_region), 0, 0, 1, 1},
  {&__pyx_n_s_ref_seq, __pyx_k_ref_seq, sizeof(__pyx_k_ref_seq), 0, 0, 1, 1},
  {&__pyx_n_s_ref_seq_a, __pyx_k_ref_seq_a, sizeof(__pyx_k_ref_seq_a), 0, 0, 1, 1},
  {&__pyx_n_s_ref_seq_b, __pyx_k_ref_seq_b, sizeof(__pyx_k_ref_seq_b), 0, 0, 1, 1},
  {&__pyx_n_s_ref_seq_readin, __pyx_k_ref_seq_readin, sizeof(__pyx_k_ref_seq_readin), 0, 0, 1, 1},
  {&__pyx_n_s_ref_structure, __pyx_k_ref_structure, sizeof(__pyx_k_ref_structure), 0, 0, 1, 1},
  {&__pyx_n_s_ref_sv, __pyx_k_ref_sv, sizeof(__pyx_k_ref_sv), 0, 0, 1, 1},
  {&__pyx_n_s_region_QC, __pyx_k_region_QC, sizeof(__pyx_k_region_QC), 0, 0, 1, 1},
  {&__pyx_n_s_region_QC_Cff, __pyx_k_region_QC_Cff, sizeof(__pyx_k_region_QC_Cff), 0, 0, 1, 1},
  {&__pyx_n_s_remove_noise_1, __pyx_k_remove_noise_1, sizeof(__pyx_k_remove_noise_1), 0, 0, 1, 1},
  {&__pyx_n_s_removed_dot_anti_diag, __pyx_k_removed_dot_anti_diag, sizeof(__pyx_k_removed_dot_anti_diag), 0, 0, 1, 1},
  {&__pyx_n_s_removed_dot_diag, __pyx_k_removed_dot_diag, sizeof(__pyx_k_removed_dot_diag), 0, 0, 1, 1},
  {&__pyx_n_s_removed_dot_x, __pyx_k_removed_dot_x, sizeof(__pyx_k_removed_dot_x), 0, 0, 1, 1},
  {&__pyx_n_s_removed_dot_y, __pyx_k_removed_dot_y, sizeof(__pyx_k_removed_dot_y), 0, 0, 1, 1},
  {&__pyx_n_s_replace, __pyx_k_replace, sizeof(__pyx_k_replace), 0, 0, 1, 1},
  {&__pyx_n_s_result_organize_ins, __pyx_k_result_organize_ins, sizeof(__pyx_k_result_organize_ins), 0, 0, 1, 1},
  {&__pyx_n_s_reverse, __pyx_k_reverse, sizeof(__pyx_k_reverse), 0, 0, 1, 1},
  {&__pyx_n_s_reverse_flag, __pyx_k_reverse_flag, sizeof(__pyx_k_reverse_flag), 0, 0, 1, 1},
  {&__pyx_n_s_reversed, __pyx_k_reversed, sizeof(__pyx_k_reversed), 0, 0, 1, 1},
  {&__pyx_n_s_right_new, __pyx_k_right_new, sizeof(__pyx_k_right_new), 0, 0, 1, 1},
  {&__pyx_n_s_right_part, __pyx_k_right_part, sizeof(__pyx_k_right_part), 0, 0, 1, 1},
  {&__pyx_n_s_round, __pyx_k_round, sizeof(__pyx_k_round), 0, 0, 1, 1},
  {&__pyx_n_s_rpy2, __pyx_k_rpy2, sizeof(__pyx_k_rpy2), 0, 0, 1, 1},
  {&__pyx_n_s_rpy2_robjects_packages, __pyx_k_rpy2_robjects_packages, sizeof(__pyx_k_rpy2_robjects_packages), 0, 0, 1, 1},
  {&__pyx_n_s_rpy2_robjects_vectors, __pyx_k_rpy2_robjects_vectors, sizeof(__pyx_k_rpy2_robjects_vectors), 0, 0, 1, 1},
  {&__pyx_n_s_run_flag, __pyx_k_run_flag, sizeof(__pyx_k_run_flag), 0, 0, 1, 1},
  {&__pyx_n_s_s, __pyx_k_s, sizeof(__pyx_k_s), 0, 0, 1, 1},
  {&__pyx_kp_s_samtools_faidx_s_s_d_d, __pyx_k_samtools_faidx_s_s_d_d, sizeof(__pyx_k_samtools_faidx_s_s_d_d), 0, 0, 1, 0},
  {&__pyx_kp_s_samtools_view_s_s_d_d, __pyx_k_samtools_view_s_s_d_d, sizeof(__pyx_k_samtools_view_s_s_d_d), 0, 0, 1, 0},
  {&__pyx_n_s_scipy, __pyx_k_scipy, sizeof(__pyx_k_scipy), 0, 0, 1, 1},
  {&__pyx_n_s_scipy_cluster_vq, __pyx_k_scipy_cluster_vq, sizeof(__pyx_k_scipy_cluster_vq), 0, 0, 1, 1},
  {&__pyx_n_s_scipy_optimize, __pyx_k_scipy_optimize, sizeof(__pyx_k_scipy_optimize), 0, 0, 1, 1},
  {&__pyx_n_s_scipy_spatial, __pyx_k_scipy_spatial, sizeof(__pyx_k_scipy_spatial), 0, 0, 1, 1},
  {&__pyx_n_s_scipy_stats, __pyx_k_scipy_stats, sizeof(__pyx_k_scipy_stats), 0, 0, 1, 1},
  {&__pyx_kp_s_scratch_remills_flux_xuefzhao_a, __pyx_k_scratch_remills_flux_xuefzhao_a, sizeof(__pyx_k_scratch_remills_flux_xuefzhao_a), 0, 0, 1, 0},
  {&__pyx_n_s_seq, __pyx_k_seq, sizeof(__pyx_k_seq), 0, 0, 1, 1},
  {&__pyx_n_s_seq1, __pyx_k_seq1, sizeof(__pyx_k_seq1), 0, 0, 1, 1},
  {&__pyx_n_s_seq1len, __pyx_k_seq1len, sizeof(__pyx_k_seq1len), 0, 0, 1, 1},
  {&__pyx_n_s_seq2, __pyx_k_seq2, sizeof(__pyx_k_seq2), 0, 0, 1, 1},
  {&__pyx_n_s_setdefault, __pyx_k_setdefault, sizeof(__pyx_k_setdefault), 0, 0, 1, 1},
  {&__pyx_n_s_shape, __pyx_k_shape, sizeof(__pyx_k_shape), 0, 0, 1, 1},
  {&__pyx_n_s_simple_chop_pacbio_read_simple_s, __pyx_k_simple_chop_pacbio_read_simple_s, sizeof(__pyx_k_simple_chop_pacbio_read_simple_s), 0, 0, 1, 1},
  {&__pyx_n_s_simple_del_chop_pacbio_read_simp, __pyx_k_simple_del_chop_pacbio_read_simp, sizeof(__pyx_k_simple_del_chop_pacbio_read_simp), 0, 0, 1, 1},
  {&__pyx_n_s_simple_del_diploid_decide, __pyx_k_simple_del_diploid_decide, sizeof(__pyx_k_simple_del_diploid_decide), 0, 0, 1, 1},
  {&__pyx_n_s_simple_del_haploid_decide, __pyx_k_simple_del_haploid_decide, sizeof(__pyx_k_simple_del_haploid_decide), 0, 0, 1, 1},
  {&__pyx_n_s_simple_disdup_diploid_decide, __pyx_k_simple_disdup_diploid_decide, sizeof(__pyx_k_simple_disdup_diploid_decide), 0, 0, 1, 1},
  {&__pyx_n_s_simple_disdup_haploid_decide, __pyx_k_simple_disdup_haploid_decide, sizeof(__pyx_k_simple_disdup_haploid_decide), 0, 0, 1, 1},
  {&__pyx_n_s_simple_inv_diploid_decide, __pyx_k_simple_inv_diploid_decide, sizeof(__pyx_k_simple_inv_diploid_decide), 0, 0, 1, 1},
  {&__pyx_n_s_simple_inv_haploid_decide, __pyx_k_simple_inv_haploid_decide, sizeof(__pyx_k_simple_inv_haploid_decide), 0, 0, 1, 1},
  {&__pyx_n_s_simple_tandup_diploid_decide, __pyx_k_simple_tandup_diploid_decide, sizeof(__pyx_k_simple_tandup_diploid_decide), 0, 0, 1, 1},
  {&__pyx_n_s_simple_tandup_haploid_decide, __pyx_k_simple_tandup_haploid_decide, sizeof(__pyx_k_simple_tandup_haploid_decide), 0, 0, 1, 1},
  {&__pyx_n_s_size, __pyx_k_size, sizeof(__pyx_k_size), 0, 0, 1, 1},
  {&__pyx_n_s_size_cluster, __pyx_k_size_cluster, sizeof(__pyx_k_size_cluster), 0, 0, 1, 1},
  {&__pyx_n_s_size_list, __pyx_k_size_list, sizeof(__pyx_k_size_list), 0, 0, 1, 1},
  {&__pyx_n_s_sklearn, __pyx_k_sklearn, sizeof(__pyx_k_sklearn), 0, 0, 1, 1},
  {&__pyx_n_s_sort, __pyx_k_sort, sizeof(__pyx_k_sort), 0, 0, 1, 1},
  {&__pyx_n_s_sorted_keys, __pyx_k_sorted_keys, sizeof(__pyx_k_sorted_keys), 0, 0, 1, 1},
  {&__pyx_n_s_sorted_list, __pyx_k_sorted_list, sizeof(__pyx_k_sorted_list), 0, 0, 1, 1},
  {&__pyx_n_s_split, __pyx_k_split, sizeof(__pyx_k_split), 0, 0, 1, 1},
  {&__pyx_n_s_sqrt, __pyx_k_sqrt, sizeof(__pyx_k_sqrt), 0, 0, 1, 1},
  {&__pyx_n_s_square_size, __pyx_k_square_size, sizeof(__pyx_k_square_size), 0, 0, 1, 1},
  {&__pyx_n_s_start, __pyx_k_start, sizeof(__pyx_k_start), 0, 0, 1, 1},
  {&__pyx_n_s_start_dis, __pyx_k_start_dis, sizeof(__pyx_k_start_dis), 0, 0, 1, 1},
  {&__pyx_n_s_stats, __pyx_k_stats, sizeof(__pyx_k_stats), 0, 0, 1, 1},
  {&__pyx_n_s_std, __pyx_k_std, sizeof(__pyx_k_std), 0, 0, 1, 1},
  {&__pyx_n_s_std_rec, __pyx_k_std_rec, sizeof(__pyx_k_std_rec), 0, 0, 1, 1},
  {&__pyx_n_s_strip, __pyx_k_strip, sizeof(__pyx_k_strip), 0, 0, 1, 1},
  {&__pyx_n_s_sub_group1, __pyx_k_sub_group1, sizeof(__pyx_k_sub_group1), 0, 0, 1, 1},
  {&__pyx_n_s_sub_sv_info, __pyx_k_sub_sv_info, sizeof(__pyx_k_sub_sv_info), 0, 0, 1, 1},
  {&__pyx_n_s_subhits, __pyx_k_subhits, sizeof(__pyx_k_subhits), 0, 0, 1, 1},
  {&__pyx_n_s_subkey, __pyx_k_subkey, sizeof(__pyx_k_subkey), 0, 0, 1, 1},
  {&__pyx_n_s_subkeys, __pyx_k_subkeys, sizeof(__pyx_k_subkeys), 0, 0, 1, 1},
  {&__pyx_n_s_subkeys_info, __pyx_k_subkeys_info, sizeof(__pyx_k_subkeys_info), 0, 0, 1, 1},
  {&__pyx_n_s_substr_list, __pyx_k_substr_list, sizeof(__pyx_k_substr_list), 0, 0, 1, 1},
  {&__pyx_n_s_sum, __pyx_k_sum, sizeof(__pyx_k_sum), 0, 0, 1, 1},
  {&__pyx_n_s_sv_block, __pyx_k_sv_block, sizeof(__pyx_k_sv_block), 0, 0, 1, 1},
  {&__pyx_n_s_sv_info, __pyx_k_sv_info, sizeof(__pyx_k_sv_info), 0, 0, 1, 1},
  {&__pyx_n_s_sv_insert_point_define, __pyx_k_sv_insert_point_define, sizeof(__pyx_k_sv_insert_point_define), 0, 0, 1, 1},
  {&__pyx_n_s_sv_len_extract, __pyx_k_sv_len_extract, sizeof(__pyx_k_sv_len_extract), 0, 0, 1, 1},
  {&__pyx_n_s_sv_rec_label, __pyx_k_sv_rec_label, sizeof(__pyx_k_sv_rec_label), 0, 0, 1, 1},
  {&__pyx_n_s_sv_seq_extract, __pyx_k_sv_seq_extract, sizeof(__pyx_k_sv_seq_extract), 0, 0, 1, 1},
  {&__pyx_n_s_svtype, __pyx_k_svtype, sizeof(__pyx_k_svtype), 0, 0, 1, 1},
  {&__pyx_n_s_svtype_extract, __pyx_k_svtype_extract, sizeof(__pyx_k_svtype_extract), 0, 0, 1, 1},
  {&__pyx_n_s_sym_dots, __pyx_k_sym_dots, sizeof(__pyx_k_sym_dots), 0, 0, 1, 1},
  {&__pyx_n_s_sysm, __pyx_k_sysm, sizeof(__pyx_k_sysm), 0, 0, 1, 1},
  {&__pyx_n_s_system, __pyx_k_system, sizeof(__pyx_k_system), 0, 0, 1, 1},
  {&__pyx_n_s_t, __pyx_k_t, sizeof(__pyx_k_t), 0, 0, 1, 1},
  {&__pyx_n_s_tacgn, __pyx_k_tacgn, sizeof(__pyx_k_tacgn), 0, 0, 1, 1},
  {&__pyx_n_s_take_off_symmetric_dots, __pyx_k_take_off_symmetric_dots, sizeof(__pyx_k_take_off_symmetric_dots), 0, 0, 1, 1},
  {&__pyx_n_s_target_read, __pyx_k_target_read, sizeof(__pyx_k_target_read), 0, 0, 1, 1},
  {&__pyx_n_s_temp, __pyx_k_temp, sizeof(__pyx_k_temp), 0, 0, 1, 1},
  {&__pyx_n_s_temp1, __pyx_k_temp1, sizeof(__pyx_k_temp1), 0, 0, 1, 1},
  {&__pyx_n_s_temp_bam_in, __pyx_k_temp_bam_in, sizeof(__pyx_k_temp_bam_in), 0, 0, 1, 1},
  {&__pyx_n_s_temp_hash, __pyx_k_temp_hash, sizeof(__pyx_k_temp_hash), 0, 0, 1, 1},
  {&__pyx_n_s_temp_result, __pyx_k_temp_result, sizeof(__pyx_k_temp_result), 0, 0, 1, 1},
  {&__pyx_n_s_temp_structure, __pyx_k_temp_structure, sizeof(__pyx_k_temp_structure), 0, 0, 1, 1},
  {&__pyx_n_s_temp_x, __pyx_k_temp_x, sizeof(__pyx_k_temp_x), 0, 0, 1, 1},
  {&__pyx_n_s_test, __pyx_k_test, sizeof(__pyx_k_test), 0, 0, 1, 1},
  {&__pyx_n_s_test_2, __pyx_k_test_2, sizeof(__pyx_k_test_2), 0, 0, 1, 1},
  {&__pyx_n_s_two_dimention_cluster_by_gap, __pyx_k_two_dimention_cluster_by_gap, sizeof(__pyx_k_two_dimention_cluster_by_gap), 0, 0, 1, 1},
  {&__pyx_n_s_type, __pyx_k_type, sizeof(__pyx_k_type), 0, 0, 1, 1},
  {&__pyx_n_s_unify_list, __pyx_k_unify_list, sizeof(__pyx_k_unify_list), 0, 0, 1, 1},
  {&__pyx_n_s_v, __pyx_k_v, sizeof(__pyx_k_v), 0, 0, 1, 1},
  {&__pyx_kp_s_vapor, __pyx_k_vapor, sizeof(__pyx_k_vapor), 0, 0, 1, 0},
  {&__pyx_n_s_vapor_CANNOT_CLASSIFY_VapoR, __pyx_k_vapor_CANNOT_CLASSIFY_VapoR, sizeof(__pyx_k_vapor_CANNOT_CLASSIFY_VapoR), 0, 0, 1, 1},
  {&__pyx_n_s_vapor_del_inv_Vapor, __pyx_k_vapor_del_inv_Vapor, sizeof(__pyx_k_vapor_del_inv_Vapor), 0, 0, 1, 1},
  {&__pyx_n_s_vapor_dup_inv_VapoR, __pyx_k_vapor_dup_inv_VapoR, sizeof(__pyx_k_vapor_dup_inv_VapoR), 0, 0, 1, 1},
  {&__pyx_n_s_vapor_input, __pyx_k_vapor_input, sizeof(__pyx_k_vapor_input), 0, 0, 1, 1},
  {&__pyx_n_s_vapor_long_del_inv, __pyx_k_vapor_long_del_inv, sizeof(__pyx_k_vapor_long_del_inv), 0, 0, 1, 1},
  {&__pyx_n_s_vapor_rec, __pyx_k_vapor_rec, sizeof(__pyx_k_vapor_rec), 0, 0, 1, 1},
  {&__pyx_n_s_vapor_score_list, __pyx_k_vapor_score_list, sizeof(__pyx_k_vapor_score_list), 0, 0, 1, 1},
  {&__pyx_n_s_vapor_simple_del_Vapor, __pyx_k_vapor_simple_del_Vapor, sizeof(__pyx_k_vapor_simple_del_Vapor), 0, 0, 1, 1},
  {&__pyx_n_s_vapor_simple_disdup_Vapor, __pyx_k_vapor_simple_disdup_Vapor, sizeof(__pyx_k_vapor_simple_disdup_Vapor), 0, 0, 1, 1},
  {&__pyx_n_s_vapor_simple_ins_Vapor, __pyx_k_vapor_simple_ins_Vapor, sizeof(__pyx_k_vapor_simple_ins_Vapor), 0, 0, 1, 1},
  {&__pyx_n_s_vapor_simple_inv_Vapor, __pyx_k_vapor_simple_inv_Vapor, sizeof(__pyx_k_vapor_simple_inv_Vapor), 0, 0, 1, 1},
  {&__pyx_n_s_vapor_simple_tandup_Vapor, __pyx_k_vapor_simple_tandup_Vapor, sizeof(__pyx_k_vapor_simple_tandup_Vapor), 0, 0, 1, 1},
  {&__pyx_n_s_vapor_single_read_score, __pyx_k_vapor_single_read_score, sizeof(__pyx_k_vapor_single_read_score), 0, 0, 1, 1},
  {&__pyx_n_s_vapor_vali_Simple_function, __pyx_k_vapor_vali_Simple_function, sizeof(__pyx_k_vapor_vali_Simple_function), 0, 0, 1, 1},
  {&__pyx_n_s_vapor_vali_plotting, __pyx_k_vapor_vali_plotting, sizeof(__pyx_k_vapor_vali_plotting), 0, 0, 1, 1},
  {&__pyx_n_s_vcf_info_hash, __pyx_k_vcf_info_hash, sizeof(__pyx_k_vcf_info_hash), 0, 0, 1, 1},
  {&__pyx_n_s_vcf_input, __pyx_k_vcf_input, sizeof(__pyx_k_vcf_input), 0, 0, 1, 1},
  {&__pyx_n_s_vcf_rec_hash, __pyx_k_vcf_rec_hash, sizeof(__pyx_k_vcf_rec_hash), 0, 0, 1, 1},
  {&__pyx_n_s_vcf_rec_hash_modify, __pyx_k_vcf_rec_hash_modify, sizeof(__pyx_k_vcf_rec_hash_modify), 0, 0, 1, 1},
  {&__pyx_n_s_vcf_rec_hash_new, __pyx_k_vcf_rec_hash_new, sizeof(__pyx_k_vcf_rec_hash_new), 0, 0, 1, 1},
  {&__pyx_n_s_vcf_vapor_modify, __pyx_k_vcf_vapor_modify, sizeof(__pyx_k_vcf_vapor_modify), 0, 0, 1, 1},
  {&__pyx_n_s_vec, __pyx_k_vec, sizeof(__pyx_k_vec), 0, 0, 1, 1},
  {&__pyx_n_s_vec2, __pyx_k_vec2, sizeof(__pyx_k_vec2), 0, 0, 1, 1},
  {&__pyx_n_s_vec3, __pyx_k_vec3, sizeof(__pyx_k_vec3), 0, 0, 1, 1},
  {&__pyx_n_s_vec4, __pyx_k_vec4, sizeof(__pyx_k_vec4), 0, 0, 1, 1},
  {&__pyx_n_s_vec_in, __pyx_k_vec_in, sizeof(__pyx_k_vec_in), 0, 0, 1, 1},
  {&__pyx_n_s_vq, __pyx_k_vq, sizeof(__pyx_k_vq), 0, 0, 1, 1},
  {&__pyx_kp_s_vs, __pyx_k_vs, sizeof(__pyx_k_vs), 0, 0, 1, 0},
  {&__pyx_n_s_w, __pyx_k_w, sizeof(__pyx_k_w), 0, 0, 1, 1},
  {&__pyx_n_s_where, __pyx_k_where, sizeof(__pyx_k_where), 0, 0, 1, 1},
  {&__pyx_n_s_whiten, __pyx_k_whiten, sizeof(__pyx_k_whiten), 0, 0, 1, 1},
  {&__pyx_n_s_whitened, __pyx_k_whitened, sizeof(__pyx_k_whitened), 0, 0, 1, 1},
  {&__pyx_n_s_width, __pyx_k_width, sizeof(__pyx_k_width), 0, 0, 1, 1},
  {&__pyx_n_s_window_size, __pyx_k_window_size, sizeof(__pyx_k_window_size), 0, 0, 1, 1},
  {&__pyx_n_s_window_size_qc, __pyx_k_window_size_qc, sizeof(__pyx_k_window_size_qc), 0, 0, 1, 1},
  {&__pyx_n_s_window_size_refine, __pyx_k_window_size_refine, sizeof(__pyx_k_window_size_refine), 0, 0, 1, 1},
  {&__pyx_n_s_write_dotdata_to_file, __pyx_k_write_dotdata_to_file, sizeof(__pyx_k_write_dotdata_to_file), 0, 0, 1, 1},
  {&__pyx_n_s_write_output_initiate, __pyx_k_write_output_initiate, sizeof(__pyx_k_write_output_initiate), 0, 0, 1, 1},
  {&__pyx_n_s_write_output_main, __pyx_k_write_output_main, sizeof(__pyx_k_write_output_main), 0, 0, 1, 1},
  {&__pyx_n_s_x, __pyx_k_x, sizeof(__pyx_k_x), 0, 0, 1, 1},
  {&__pyx_n_s_x_axis, __pyx_k_x_axis, sizeof(__pyx_k_x_axis), 0, 0, 1, 1},
  {&__pyx_n_s_x_modify, __pyx_k_x_modify, sizeof(__pyx_k_x_modify), 0, 0, 1, 1},
  {&__pyx_n_s_x_modify_new, __pyx_k_x_modify_new, sizeof(__pyx_k_x_modify_new), 0, 0, 1, 1},
  {&__pyx_n_s_x_to_x_modify_new, __pyx_k_x_to_x_modify_new, sizeof(__pyx_k_x_to_x_modify_new), 0, 0, 1, 1},
  {&__pyx_n_s_xlab, __pyx_k_xlab, sizeof(__pyx_k_xlab), 0, 0, 1, 1},
  {&__pyx_n_s_y, __pyx_k_y, sizeof(__pyx_k_y), 0, 0, 1, 1},
  {&__pyx_n_s_y_axis, __pyx_k_y_axis, sizeof(__pyx_k_y_axis), 0, 0, 1, 1},
  {&__pyx_n_s_y_x_ratio_list, __pyx_k_y_x_ratio_list, sizeof(__pyx_k_y_x_ratio_list), 0, 0, 1, 1},
  {&__pyx_n_s_ylab, __pyx_k_ylab, sizeof(__pyx_k_ylab), 0, 0, 1, 1},
  {&__pyx_n_s_z, __pyx_k_z, sizeof(__pyx_k_z), 0, 0, 1, 1},
  {0, 0, 0, 0, 0, 0, 0}
};
static int __Pyx_InitCachedBuiltins(void) {
  __pyx_builtin_range = __Pyx_GetBuiltinName(__pyx_n_s_range); if (!__pyx_builtin_range) __PYX_ERR(0, 29, __pyx_L1_error)
  __pyx_builtin_chr = __Pyx_GetBuiltinName(__pyx_n_s_chr); if (!__pyx_builtin_chr) __PYX_ERR(0, 30, __pyx_L1_error)
  __pyx_builtin_print = __Pyx_GetBuiltinName(__pyx_n_s_print); if (!__pyx_builtin_print) __PYX_ERR(0, 78, __pyx_L1_error)
  __pyx_builtin_open = __Pyx_GetBuiltinName(__pyx_n_s_open); if (!__pyx_builtin_open) __PYX_ERR(0, 351, __pyx_L1_error)
  __pyx_builtin_min = __Pyx_GetBuiltinName(__pyx_n_s_min); if (!__pyx_builtin_min) __PYX_ERR(0, 370, __pyx_L1_error)
  __pyx_builtin_max = __Pyx_GetBuiltinName(__pyx_n_s_max); if (!__pyx_builtin_max) __PYX_ERR(0, 370, __pyx_L1_error)
  __pyx_builtin_sum = __Pyx_GetBuiltinName(__pyx_n_s_sum); if (!__pyx_builtin_sum) __PYX_ERR(0, 498, __pyx_L1_error)
  __pyx_builtin_round = __Pyx_GetBuiltinName(__pyx_n_s_round); if (!__pyx_builtin_round) __PYX_ERR(0, 759, __pyx_L1_error)
  __pyx_builtin_reversed = __Pyx_GetBuiltinName(__pyx_n_s_reversed); if (!__pyx_builtin_reversed) __PYX_ERR(0, 1364, __pyx_L1_error)
  return 0;
  __pyx_L1_error:;
  return -1;
}

static int __Pyx_InitCachedConstants(void) {
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__Pyx_InitCachedConstants", 0);

  /* "vapor_vali/Simple_function.pyx":33
 *     block_hash['-']=[block_hash[info[0][0]][0],block_hash[info[0][0]][1]-flank_length,block_hash[info[0][0]][1]]
 *     block_hash['+']=[block_hash[info[0][-1]][0],block_hash[info[0][-1]][2],block_hash[info[0][-1]][2]+flank_length]
 *     if not info[1].split('/')[0]==info[1].split('/')[1]:             # <<<<<<<<<<<<<<
 *         out=[ref_seq_readin(ref,block_hash['-'][0],block_hash['-'][1],block_hash['-'][2]),ref_seq_readin(ref,block_hash['-'][0],block_hash['-'][1],block_hash['-'][2])]
 *         rec=-1
 */
  __pyx_tuple__4 = PyTuple_Pack(1, __pyx_kp_s__3); if (unlikely(!__pyx_tuple__4)) __PYX_ERR(0, 33, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__4);
  __Pyx_GIVEREF(__pyx_tuple__4);
  __pyx_tuple__5 = PyTuple_Pack(1, __pyx_kp_s__3); if (unlikely(!__pyx_tuple__5)) __PYX_ERR(0, 33, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__5);
  __Pyx_GIVEREF(__pyx_tuple__5);

  /* "vapor_vali/Simple_function.pyx":36
 *         out=[ref_seq_readin(ref,block_hash['-'][0],block_hash['-'][1],block_hash['-'][2]),ref_seq_readin(ref,block_hash['-'][0],block_hash['-'][1],block_hash['-'][2])]
 *         rec=-1
 *         for x in info[1].split('/'):             # <<<<<<<<<<<<<<
 *             rec+=1
 *             temp_x=[]
 */
  __pyx_tuple__6 = PyTuple_Pack(1, __pyx_kp_s__3); if (unlikely(!__pyx_tuple__6)) __PYX_ERR(0, 36, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__6);
  __Pyx_GIVEREF(__pyx_tuple__6);

  /* "vapor_vali/Simple_function.pyx":53
 *         out=[ref_seq_readin(ref,block_hash['-'][0],block_hash['-'][1],block_hash['-'][2])]
 *         rec=-1
 *         for x in [info[1].split('/')[0]]:             # <<<<<<<<<<<<<<
 *             rec+=1
 *             temp_x=[]
 */
  __pyx_tuple__8 = PyTuple_Pack(1, __pyx_kp_s__3); if (unlikely(!__pyx_tuple__8)) __PYX_ERR(0, 53, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__8);
  __Pyx_GIVEREF(__pyx_tuple__8);

  /* "vapor_vali/Simple_function.pyx":72
 *     else:
 *         temp_bam_in=[]
 *         bam_in_path='/'.join(bam_in.split('/')[:-1])+'/'             # <<<<<<<<<<<<<<
 *         if 'XXX' in bam_in.split('/')[-1]:
 *             bam_in_keys=bam_in.split('/')[-1].split('XXX')
 */
  __pyx_tuple__9 = PyTuple_Pack(1, __pyx_kp_s__3); if (unlikely(!__pyx_tuple__9)) __PYX_ERR(0, 72, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__9);
  __Pyx_GIVEREF(__pyx_tuple__9);
  __pyx_slice__10 = PySlice_New(Py_None, __pyx_int_neg_1, Py_None); if (unlikely(!__pyx_slice__10)) __PYX_ERR(0, 72, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_slice__10);
  __Pyx_GIVEREF(__pyx_slice__10);

  /* "vapor_vali/Simple_function.pyx":73
 *         temp_bam_in=[]
 *         bam_in_path='/'.join(bam_in.split('/')[:-1])+'/'
 *         if 'XXX' in bam_in.split('/')[-1]:             # <<<<<<<<<<<<<<
 *             bam_in_keys=bam_in.split('/')[-1].split('XXX')
 *         elif '*' in bam_in.split('/')[-1]:
 */
  __pyx_tuple__11 = PyTuple_Pack(1, __pyx_kp_s__3); if (unlikely(!__pyx_tuple__11)) __PYX_ERR(0, 73, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__11);
  __Pyx_GIVEREF(__pyx_tuple__11);

  /* "vapor_vali/Simple_function.pyx":74
 *         bam_in_path='/'.join(bam_in.split('/')[:-1])+'/'
 *         if 'XXX' in bam_in.split('/')[-1]:
 *             bam_in_keys=bam_in.split('/')[-1].split('XXX')             # <<<<<<<<<<<<<<
 *         elif '*' in bam_in.split('/')[-1]:
 *             bam_in_keys=bam_in.split('/')[-1].split('*')
 */
  __pyx_tuple__12 = PyTuple_Pack(1, __pyx_kp_s__3); if (unlikely(!__pyx_tuple__12)) __PYX_ERR(0, 74, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__12);
  __Pyx_GIVEREF(__pyx_tuple__12);
  __pyx_tuple__13 = PyTuple_Pack(1, __pyx_n_s_XXX); if (unlikely(!__pyx_tuple__13)) __PYX_ERR(0, 74, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__13);
  __Pyx_GIVEREF(__pyx_tuple__13);

  /* "vapor_vali/Simple_function.pyx":75
 *         if 'XXX' in bam_in.split('/')[-1]:
 *             bam_in_keys=bam_in.split('/')[-1].split('XXX')
 *         elif '*' in bam_in.split('/')[-1]:             # <<<<<<<<<<<<<<
 *             bam_in_keys=bam_in.split('/')[-1].split('*')
 *         else:
 */
  __pyx_tuple__15 = PyTuple_Pack(1, __pyx_kp_s__3); if (unlikely(!__pyx_tuple__15)) __PYX_ERR(0, 75, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__15);
  __Pyx_GIVEREF(__pyx_tuple__15);

  /* "vapor_vali/Simple_function.pyx":76
 *             bam_in_keys=bam_in.split('/')[-1].split('XXX')
 *         elif '*' in bam_in.split('/')[-1]:
 *             bam_in_keys=bam_in.split('/')[-1].split('*')             # <<<<<<<<<<<<<<
 *         else:
 *             print ('Error: invalid name for pacbio files !')
 */
  __pyx_tuple__16 = PyTuple_Pack(1, __pyx_kp_s__3); if (unlikely(!__pyx_tuple__16)) __PYX_ERR(0, 76, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__16);
  __Pyx_GIVEREF(__pyx_tuple__16);
  __pyx_tuple__17 = PyTuple_Pack(1, __pyx_kp_s__14); if (unlikely(!__pyx_tuple__17)) __PYX_ERR(0, 76, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__17);
  __Pyx_GIVEREF(__pyx_tuple__17);

  /* "vapor_vali/Simple_function.pyx":78
 *             bam_in_keys=bam_in.split('/')[-1].split('*')
 *         else:
 *             print ('Error: invalid name for pacbio files !')             # <<<<<<<<<<<<<<
 *         for k1 in os.listdir(bam_in_path):
 *             if k1.split('.')[-1]==bam_in.split('.')[-1]:
 */
  __pyx_tuple__18 = PyTuple_Pack(1, __pyx_kp_s_Error_invalid_name_for_pacbio_fi); if (unlikely(!__pyx_tuple__18)) __PYX_ERR(0, 78, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__18);
  __Pyx_GIVEREF(__pyx_tuple__18);

  /* "vapor_vali/Simple_function.pyx":80
 *             print ('Error: invalid name for pacbio files !')
 *         for k1 in os.listdir(bam_in_path):
 *             if k1.split('.')[-1]==bam_in.split('.')[-1]:             # <<<<<<<<<<<<<<
 *                 flag=0
 *                 for y in bam_in_keys:
 */
  __pyx_tuple__20 = PyTuple_Pack(1, __pyx_kp_s__19); if (unlikely(!__pyx_tuple__20)) __PYX_ERR(0, 80, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__20);
  __Pyx_GIVEREF(__pyx_tuple__20);
  __pyx_tuple__21 = PyTuple_Pack(1, __pyx_kp_s__19); if (unlikely(!__pyx_tuple__21)) __PYX_ERR(0, 80, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__21);
  __Pyx_GIVEREF(__pyx_tuple__21);

  /* "vapor_vali/Simple_function.pyx":107
 *     rec=-1
 *     for k1 in temp1:
 *         for k2 in range(len(k1[2:])):             # <<<<<<<<<<<<<<
 *             rec+=1
 *             out[chr(97+rec)]=[k1[0],k1[k2+1],k1[k2+2]]
 */
  __pyx_slice__22 = PySlice_New(__pyx_int_2, Py_None, Py_None); if (unlikely(!__pyx_slice__22)) __PYX_ERR(0, 107, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_slice__22);
  __Pyx_GIVEREF(__pyx_slice__22);

  /* "vapor_vali/Simple_function.pyx":306
 *     #eg cigar2alignstart(pbam[5],int(pbam[3]),bps)
 *     import re
 *     pcigar=re.compile(r'''(\d+)([MIDNSHP=X])''')             # <<<<<<<<<<<<<<
 *     cigars=[]
 *     for m in pcigar.finditer(cigar):
 */
  __pyx_tuple__23 = PyTuple_Pack(1, __pyx_kp_s_d_MIDNSHP_X); if (unlikely(!__pyx_tuple__23)) __PYX_ERR(0, 306, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__23);
  __Pyx_GIVEREF(__pyx_tuple__23);

  /* "vapor_vali/Simple_function.pyx":361
 * def chr_start_end_extract(pin):
 *     out=[pin[0],int(pin[1])]
 *     for x in pin[7].split(';'):             # <<<<<<<<<<<<<<
 *         if x[:4]=='END=' and x.split('=')[0]=='END':
 *             out.append(int(x.split('=')[1]))
 */
  __pyx_tuple__27 = PyTuple_Pack(1, __pyx_kp_s__26); if (unlikely(!__pyx_tuple__27)) __PYX_ERR(0, 361, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__27);
  __Pyx_GIVEREF(__pyx_tuple__27);

  /* "vapor_vali/Simple_function.pyx":362
 *     out=[pin[0],int(pin[1])]
 *     for x in pin[7].split(';'):
 *         if x[:4]=='END=' and x.split('=')[0]=='END':             # <<<<<<<<<<<<<<
 *             out.append(int(x.split('=')[1]))
 *     return out
 */
  __pyx_slice__28 = PySlice_New(Py_None, __pyx_int_4, Py_None); if (unlikely(!__pyx_slice__28)) __PYX_ERR(0, 362, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_slice__28);
  __Pyx_GIVEREF(__pyx_slice__28);
  __pyx_tuple__30 = PyTuple_Pack(1, __pyx_kp_s__29); if (unlikely(!__pyx_tuple__30)) __PYX_ERR(0, 362, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__30);
  __Pyx_GIVEREF(__pyx_tuple__30);

  /* "vapor_vali/Simple_function.pyx":363
 *     for x in pin[7].split(';'):
 *         if x[:4]=='END=' and x.split('=')[0]=='END':
 *             out.append(int(x.split('=')[1]))             # <<<<<<<<<<<<<<
 *     return out
 * 
 */
  __pyx_tuple__31 = PyTuple_Pack(1, __pyx_kp_s__29); if (unlikely(!__pyx_tuple__31)) __PYX_ERR(0, 363, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__31);
  __Pyx_GIVEREF(__pyx_tuple__31);

  /* "vapor_vali/Simple_function.pyx":510
 * 
 * def dup_inv_ref_alt_bps_produce(sv_info,flank_length,alt_structure):
 *     bp_info=sorted(sv_info[1:3]+[sv_info[4]])             # <<<<<<<<<<<<<<
 *     block_len=bp_to_block_len([sv_info[0]]+bp_info)
 *     ref_bps=[bp_info[0]-flank_length]+bp_info+[bp_info[-1]+flank_length]
 */
  __pyx_slice__32 = PySlice_New(__pyx_int_1, __pyx_int_3, Py_None); if (unlikely(!__pyx_slice__32)) __PYX_ERR(0, 510, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_slice__32);
  __Pyx_GIVEREF(__pyx_slice__32);

  /* "vapor_vali/Simple_function.pyx":566
 * def dis_to_diagnal_most_abundant_defined(alt_clean_dotdata):
 *     dis_to_diagnal_list=[i[1]-i[0] for i in alt_clean_dotdata]
 *     dis_range=[min(dis_to_diagnal_list)+i*float(max(dis_to_diagnal_list)-min(dis_to_diagnal_list))/10.0 for i in range(11)]             # <<<<<<<<<<<<<<
 *     kept_list1=find_longest_list(number_cluster(dis_to_diagnal_list,dis_range))
 *     kept_list2=[]
 */
  __pyx_tuple__33 = PyTuple_Pack(1, __pyx_int_11); if (unlikely(!__pyx_tuple__33)) __PYX_ERR(0, 566, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__33);
  __Pyx_GIVEREF(__pyx_tuple__33);

  /* "vapor_vali/Simple_function.pyx":570
 *     kept_list2=[]
 *     for km in kept_list1:
 *         j=[min(km)+i*float(max(km)-min(km))/10.0 for i in range(11)]             # <<<<<<<<<<<<<<
 *         kept_list2+=find_longest_list(number_cluster(km,j))
 *     if len(kept_list2)==1:  return np.median(kept_list2[0])
 */
  __pyx_tuple__34 = PyTuple_Pack(1, __pyx_int_11); if (unlikely(!__pyx_tuple__34)) __PYX_ERR(0, 570, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__34);
  __Pyx_GIVEREF(__pyx_tuple__34);

  /* "vapor_vali/Simple_function.pyx":595
 *     all_combines=dup_block_combined_qc(all_combines)
 *     kept_dup=[]
 *     for x in all_combines[::-1]:             # <<<<<<<<<<<<<<
 *         if k2_hap.count(x)>1:
 *             kept_dup.append(x)
 */
  __pyx_slice__35 = PySlice_New(Py_None, Py_None, __pyx_int_neg_1); if (unlikely(!__pyx_slice__35)) __PYX_ERR(0, 595, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_slice__35);
  __Pyx_GIVEREF(__pyx_slice__35);

  /* "vapor_vali/Simple_function.pyx":598
 *         if k2_hap.count(x)>1:
 *             kept_dup.append(x)
 *     return dup_block_kept_qc(kept_dup)[::-1]             # <<<<<<<<<<<<<<
 * 
 * def dup_block_combined_qc(all_combines):
 */
  __pyx_slice__36 = PySlice_New(Py_None, Py_None, __pyx_int_neg_1); if (unlikely(!__pyx_slice__36)) __PYX_ERR(0, 598, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_slice__36);
  __Pyx_GIVEREF(__pyx_slice__36);

  /* "vapor_vali/Simple_function.pyx":616
 *     if len(kept_dup)>0:
 *         out.append(kept_dup[0])
 *         for y in kept_dup[1:]:             # <<<<<<<<<<<<<<
 *             flag_y=0
 *             for z in out:
 */
  __pyx_slice__37 = PySlice_New(__pyx_int_1, Py_None, Py_None); if (unlikely(!__pyx_slice__37)) __PYX_ERR(0, 616, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_slice__37);
  __Pyx_GIVEREF(__pyx_slice__37);

  /* "vapor_vali/Simple_function.pyx":790
 *     rec_pos=-1
 *     if 'CN' in pin[8]:
 *         for x in pin[8].split(':'):             # <<<<<<<<<<<<<<
 *             rec_pos+=1
 *             if x=='CN': break
 */
  __pyx_tuple__39 = PyTuple_Pack(1, __pyx_kp_s__38); if (unlikely(!__pyx_tuple__39)) __PYX_ERR(0, 790, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__39);
  __Pyx_GIVEREF(__pyx_tuple__39);

  /* "vapor_vali/Simple_function.pyx":793
 *             rec_pos+=1
 *             if x=='CN': break
 *     geno=[i.split(':')[rec_pos] for i in pin[9:]]             # <<<<<<<<<<<<<<
 *     out=[0 if i=='2' else 1 for i in geno]
 *     return out
 */
  __pyx_slice__40 = PySlice_New(__pyx_int_9, Py_None, Py_None); if (unlikely(!__pyx_slice__40)) __PYX_ERR(0, 793, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_slice__40);
  __Pyx_GIVEREF(__pyx_slice__40);
  __pyx_tuple__41 = PyTuple_Pack(1, __pyx_kp_s__38); if (unlikely(!__pyx_tuple__41)) __PYX_ERR(0, 793, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__41);
  __Pyx_GIVEREF(__pyx_tuple__41);

  /* "vapor_vali/Simple_function.pyx":801
 *     rec_pos=-1
 *     if 'GT' in pin[8]:
 *         for x in pin[8].split(':'):             # <<<<<<<<<<<<<<
 *             rec_pos+=1
 *             if x=='GT': break
 */
  __pyx_tuple__42 = PyTuple_Pack(1, __pyx_kp_s__38); if (unlikely(!__pyx_tuple__42)) __PYX_ERR(0, 801, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__42);
  __Pyx_GIVEREF(__pyx_tuple__42);

  /* "vapor_vali/Simple_function.pyx":804
 *             rec_pos+=1
 *             if x=='GT': break
 *     geno=[i.split(':')[rec_pos] for i in pin[9:]]             # <<<<<<<<<<<<<<
 *     for i in geno:
 *         if '/' in i:
 */
  __pyx_slice__43 = PySlice_New(__pyx_int_9, Py_None, Py_None); if (unlikely(!__pyx_slice__43)) __PYX_ERR(0, 804, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_slice__43);
  __Pyx_GIVEREF(__pyx_slice__43);
  __pyx_tuple__44 = PyTuple_Pack(1, __pyx_kp_s__38); if (unlikely(!__pyx_tuple__44)) __PYX_ERR(0, 804, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__44);
  __Pyx_GIVEREF(__pyx_tuple__44);

  /* "vapor_vali/Simple_function.pyx":808
 *         if '/' in i:
 *             if i=='./.': out.append(1)
 *             else:   out.append(sum([int(j) for j in i.split('/')]))             # <<<<<<<<<<<<<<
 *         elif '|' in i:
 *             if i=='.|.': out.append(1)
 */
  __pyx_tuple__46 = PyTuple_Pack(1, __pyx_kp_s__3); if (unlikely(!__pyx_tuple__46)) __PYX_ERR(0, 808, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__46);
  __Pyx_GIVEREF(__pyx_tuple__46);

  /* "vapor_vali/Simple_function.pyx":811
 *         elif '|' in i:
 *             if i=='.|.': out.append(1)
 *             else:   out.append(sum([int(j) for j in i.split('|')]))             # <<<<<<<<<<<<<<
 *         elif i=='.':    out.append(1)
 *     return out
 */
  __pyx_tuple__49 = PyTuple_Pack(1, __pyx_kp_s__47); if (unlikely(!__pyx_tuple__49)) __PYX_ERR(0, 811, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__49);
  __Pyx_GIVEREF(__pyx_tuple__49);

  /* "vapor_vali/Simple_function.pyx":817
 * def INS_length_detect(pin):
 *     out=0
 *     for x in pin[7].split(';'):             # <<<<<<<<<<<<<<
 *         if 'SVLEN=' in x:
 *             out=int(x.split('=')[1])
 */
  __pyx_tuple__50 = PyTuple_Pack(1, __pyx_kp_s__26); if (unlikely(!__pyx_tuple__50)) __PYX_ERR(0, 817, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__50);
  __Pyx_GIVEREF(__pyx_tuple__50);

  /* "vapor_vali/Simple_function.pyx":819
 *     for x in pin[7].split(';'):
 *         if 'SVLEN=' in x:
 *             out=int(x.split('=')[1])             # <<<<<<<<<<<<<<
 *     return out
 * 
 */
  __pyx_tuple__51 = PyTuple_Pack(1, __pyx_kp_s__29); if (unlikely(!__pyx_tuple__51)) __PYX_ERR(0, 819, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__51);
  __Pyx_GIVEREF(__pyx_tuple__51);

  /* "vapor_vali/Simple_function.pyx":892
 * def key_modify(key):
 *     if 'R' in key:
 *             key=key.replace('R','N')             # <<<<<<<<<<<<<<
 *     if 'r' in key:
 *             key=key.replace('r','n')
 */
  __pyx_tuple__52 = PyTuple_Pack(2, __pyx_n_s_R, __pyx_n_s_N); if (unlikely(!__pyx_tuple__52)) __PYX_ERR(0, 892, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__52);
  __Pyx_GIVEREF(__pyx_tuple__52);

  /* "vapor_vali/Simple_function.pyx":894
 *             key=key.replace('R','N')
 *     if 'r' in key:
 *             key=key.replace('r','n')             # <<<<<<<<<<<<<<
 *     if 'Y' in key:
 *             key=key.replace('Y','N')
 */
  __pyx_tuple__53 = PyTuple_Pack(2, __pyx_n_s_r, __pyx_n_s_n); if (unlikely(!__pyx_tuple__53)) __PYX_ERR(0, 894, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__53);
  __Pyx_GIVEREF(__pyx_tuple__53);

  /* "vapor_vali/Simple_function.pyx":896
 *             key=key.replace('r','n')
 *     if 'Y' in key:
 *             key=key.replace('Y','N')             # <<<<<<<<<<<<<<
 *     if 'y' in key:
 *             key=key.replace('y','n')
 */
  __pyx_tuple__54 = PyTuple_Pack(2, __pyx_n_s_Y, __pyx_n_s_N); if (unlikely(!__pyx_tuple__54)) __PYX_ERR(0, 896, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__54);
  __Pyx_GIVEREF(__pyx_tuple__54);

  /* "vapor_vali/Simple_function.pyx":898
 *             key=key.replace('Y','N')
 *     if 'y' in key:
 *             key=key.replace('y','n')             # <<<<<<<<<<<<<<
 *     if 'S' in key:
 *             key=key.replace('S','N')
 */
  __pyx_tuple__55 = PyTuple_Pack(2, __pyx_n_s_y, __pyx_n_s_n); if (unlikely(!__pyx_tuple__55)) __PYX_ERR(0, 898, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__55);
  __Pyx_GIVEREF(__pyx_tuple__55);

  /* "vapor_vali/Simple_function.pyx":900
 *             key=key.replace('y','n')
 *     if 'S' in key:
 *             key=key.replace('S','N')             # <<<<<<<<<<<<<<
 *     if 's' in key:
 *             key=key.replace('s','n')
 */
  __pyx_tuple__56 = PyTuple_Pack(2, __pyx_n_s_S, __pyx_n_s_N); if (unlikely(!__pyx_tuple__56)) __PYX_ERR(0, 900, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__56);
  __Pyx_GIVEREF(__pyx_tuple__56);

  /* "vapor_vali/Simple_function.pyx":902
 *             key=key.replace('S','N')
 *     if 's' in key:
 *             key=key.replace('s','n')             # <<<<<<<<<<<<<<
 *     if 'W' in key:
 *             key=key.replace('W','N')
 */
  __pyx_tuple__57 = PyTuple_Pack(2, __pyx_n_s_s, __pyx_n_s_n); if (unlikely(!__pyx_tuple__57)) __PYX_ERR(0, 902, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__57);
  __Pyx_GIVEREF(__pyx_tuple__57);

  /* "vapor_vali/Simple_function.pyx":904
 *             key=key.replace('s','n')
 *     if 'W' in key:
 *             key=key.replace('W','N')             # <<<<<<<<<<<<<<
 *     if 'w' in key:
 *             key=key.replace('w','n')
 */
  __pyx_tuple__58 = PyTuple_Pack(2, __pyx_n_s_W, __pyx_n_s_N); if (unlikely(!__pyx_tuple__58)) __PYX_ERR(0, 904, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__58);
  __Pyx_GIVEREF(__pyx_tuple__58);

  /* "vapor_vali/Simple_function.pyx":906
 *             key=key.replace('W','N')
 *     if 'w' in key:
 *             key=key.replace('w','n')             # <<<<<<<<<<<<<<
 *     if 'K' in key:
 *             key=key.replace('K','N')
 */
  __pyx_tuple__59 = PyTuple_Pack(2, __pyx_n_s_w, __pyx_n_s_n); if (unlikely(!__pyx_tuple__59)) __PYX_ERR(0, 906, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__59);
  __Pyx_GIVEREF(__pyx_tuple__59);

  /* "vapor_vali/Simple_function.pyx":908
 *             key=key.replace('w','n')
 *     if 'K' in key:
 *             key=key.replace('K','N')             # <<<<<<<<<<<<<<
 *     if 'k' in key:
 *             key=key.replace('k','n')
 */
  __pyx_tuple__60 = PyTuple_Pack(2, __pyx_n_s_K, __pyx_n_s_N); if (unlikely(!__pyx_tuple__60)) __PYX_ERR(0, 908, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__60);
  __Pyx_GIVEREF(__pyx_tuple__60);

  /* "vapor_vali/Simple_function.pyx":910
 *             key=key.replace('K','N')
 *     if 'k' in key:
 *             key=key.replace('k','n')             # <<<<<<<<<<<<<<
 *     if 'M' in key:
 *             key=key.replace('M','N')
 */
  __pyx_tuple__61 = PyTuple_Pack(2, __pyx_n_s_k, __pyx_n_s_n); if (unlikely(!__pyx_tuple__61)) __PYX_ERR(0, 910, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__61);
  __Pyx_GIVEREF(__pyx_tuple__61);

  /* "vapor_vali/Simple_function.pyx":912
 *             key=key.replace('k','n')
 *     if 'M' in key:
 *             key=key.replace('M','N')             # <<<<<<<<<<<<<<
 *     if 'm' in key:
 *             key=key.replace('m','n')
 */
  __pyx_tuple__62 = PyTuple_Pack(2, __pyx_n_s_M, __pyx_n_s_N); if (unlikely(!__pyx_tuple__62)) __PYX_ERR(0, 912, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__62);
  __Pyx_GIVEREF(__pyx_tuple__62);

  /* "vapor_vali/Simple_function.pyx":914
 *             key=key.replace('M','N')
 *     if 'm' in key:
 *             key=key.replace('m','n')             # <<<<<<<<<<<<<<
 *     if 'B' in key:
 *             key=key.replace('B','N')
 */
  __pyx_tuple__63 = PyTuple_Pack(2, __pyx_n_s_m, __pyx_n_s_n); if (unlikely(!__pyx_tuple__63)) __PYX_ERR(0, 914, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__63);
  __Pyx_GIVEREF(__pyx_tuple__63);

  /* "vapor_vali/Simple_function.pyx":916
 *             key=key.replace('m','n')
 *     if 'B' in key:
 *             key=key.replace('B','N')             # <<<<<<<<<<<<<<
 *     if 'b' in key:
 *             key=key.replace('b','n')
 */
  __pyx_tuple__64 = PyTuple_Pack(2, __pyx_n_s_B, __pyx_n_s_N); if (unlikely(!__pyx_tuple__64)) __PYX_ERR(0, 916, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__64);
  __Pyx_GIVEREF(__pyx_tuple__64);

  /* "vapor_vali/Simple_function.pyx":918
 *             key=key.replace('B','N')
 *     if 'b' in key:
 *             key=key.replace('b','n')             # <<<<<<<<<<<<<<
 *     if 'D' in key:
 *             key=key.replace('D','N')
 */
  __pyx_tuple__65 = PyTuple_Pack(2, __pyx_n_s_b, __pyx_n_s_n); if (unlikely(!__pyx_tuple__65)) __PYX_ERR(0, 918, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__65);
  __Pyx_GIVEREF(__pyx_tuple__65);

  /* "vapor_vali/Simple_function.pyx":920
 *             key=key.replace('b','n')
 *     if 'D' in key:
 *             key=key.replace('D','N')             # <<<<<<<<<<<<<<
 *     if 'd' in key:
 *             key=key.replace('d','n')
 */
  __pyx_tuple__66 = PyTuple_Pack(2, __pyx_n_s_D, __pyx_n_s_N); if (unlikely(!__pyx_tuple__66)) __PYX_ERR(0, 920, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__66);
  __Pyx_GIVEREF(__pyx_tuple__66);

  /* "vapor_vali/Simple_function.pyx":922
 *             key=key.replace('D','N')
 *     if 'd' in key:
 *             key=key.replace('d','n')             # <<<<<<<<<<<<<<
 *     if 'H' in key:
 *             key=key.replace('H','N')
 */
  __pyx_tuple__67 = PyTuple_Pack(2, __pyx_n_s_d, __pyx_n_s_n); if (unlikely(!__pyx_tuple__67)) __PYX_ERR(0, 922, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__67);
  __Pyx_GIVEREF(__pyx_tuple__67);

  /* "vapor_vali/Simple_function.pyx":924
 *             key=key.replace('d','n')
 *     if 'H' in key:
 *             key=key.replace('H','N')             # <<<<<<<<<<<<<<
 *     if 'h' in key:
 *             key=key.replace('h','n')
 */
  __pyx_tuple__68 = PyTuple_Pack(2, __pyx_n_s_H, __pyx_n_s_N); if (unlikely(!__pyx_tuple__68)) __PYX_ERR(0, 924, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__68);
  __Pyx_GIVEREF(__pyx_tuple__68);

  /* "vapor_vali/Simple_function.pyx":926
 *             key=key.replace('H','N')
 *     if 'h' in key:
 *             key=key.replace('h','n')             # <<<<<<<<<<<<<<
 *     if 'V' in key:
 *             key=key.replace('V','N')
 */
  __pyx_tuple__69 = PyTuple_Pack(2, __pyx_n_s_h, __pyx_n_s_n); if (unlikely(!__pyx_tuple__69)) __PYX_ERR(0, 926, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__69);
  __Pyx_GIVEREF(__pyx_tuple__69);

  /* "vapor_vali/Simple_function.pyx":928
 *             key=key.replace('h','n')
 *     if 'V' in key:
 *             key=key.replace('V','N')             # <<<<<<<<<<<<<<
 *     if 'v' in key:
 *             key=key.replace('v','n')
 */
  __pyx_tuple__70 = PyTuple_Pack(2, __pyx_n_s_V, __pyx_n_s_N); if (unlikely(!__pyx_tuple__70)) __PYX_ERR(0, 928, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__70);
  __Pyx_GIVEREF(__pyx_tuple__70);

  /* "vapor_vali/Simple_function.pyx":930
 *             key=key.replace('V','N')
 *     if 'v' in key:
 *             key=key.replace('v','n')             # <<<<<<<<<<<<<<
 *     return key
 * 
 */
  __pyx_tuple__71 = PyTuple_Pack(2, __pyx_n_s_v, __pyx_n_s_n); if (unlikely(!__pyx_tuple__71)) __PYX_ERR(0, 930, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__71);
  __Pyx_GIVEREF(__pyx_tuple__71);

  /* "vapor_vali/Simple_function.pyx":992
 *         if not '^' in i:    inverted_sv_3.append(i)
 *         else:
 *             inverted_sv_3.append(i.replace('^','')[::-1]+'^')             # <<<<<<<<<<<<<<
 *     return inverted_sv_3
 * 
 */
  __pyx_tuple__72 = PyTuple_Pack(2, __pyx_kp_s__7, __pyx_kp_s__24); if (unlikely(!__pyx_tuple__72)) __PYX_ERR(0, 992, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__72);
  __Pyx_GIVEREF(__pyx_tuple__72);
  __pyx_slice__73 = PySlice_New(Py_None, Py_None, __pyx_int_neg_1); if (unlikely(!__pyx_slice__73)) __PYX_ERR(0, 992, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_slice__73);
  __Pyx_GIVEREF(__pyx_slice__73);

  /* "vapor_vali/Simple_function.pyx":1014
 *             dotdata_record=[dotdata(window_size,ref_seq,ref_seq),    dotdata(window_size,alt_seq,alt_seq),    dotdata(window_size,best_read_rec[0],ref_seq[best_read_rec[1]:]),    dotdata(window_size,best_read_rec[0],alt_seq[best_read_rec[1]:])]
 *             if not [] in dotdata_record:
 *                 grdevices = importr('grDevices')             # <<<<<<<<<<<<<<
 *                 graphics = importr("graphics")
 *                 if  len(out_figure_name.split('/')[-1])>150:
 */
  __pyx_tuple__74 = PyTuple_Pack(1, __pyx_n_s_grDevices); if (unlikely(!__pyx_tuple__74)) __PYX_ERR(0, 1014, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__74);
  __Pyx_GIVEREF(__pyx_tuple__74);

  /* "vapor_vali/Simple_function.pyx":1015
 *             if not [] in dotdata_record:
 *                 grdevices = importr('grDevices')
 *                 graphics = importr("graphics")             # <<<<<<<<<<<<<<
 *                 if  len(out_figure_name.split('/')[-1])>150:
 *                     out_figure_name='/'.join(out_figure_name.split('/')[:-1])+'/'+out_figure_name.split('/')[-1][:140]+'.'+out_figure_name.split('.')[-1]
 */
  __pyx_tuple__75 = PyTuple_Pack(1, __pyx_n_s_graphics); if (unlikely(!__pyx_tuple__75)) __PYX_ERR(0, 1015, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__75);
  __Pyx_GIVEREF(__pyx_tuple__75);

  /* "vapor_vali/Simple_function.pyx":1016
 *                 grdevices = importr('grDevices')
 *                 graphics = importr("graphics")
 *                 if  len(out_figure_name.split('/')[-1])>150:             # <<<<<<<<<<<<<<
 *                     out_figure_name='/'.join(out_figure_name.split('/')[:-1])+'/'+out_figure_name.split('/')[-1][:140]+'.'+out_figure_name.split('.')[-1]
 *                 grdevices.png(file=out_figure_name, width=512, height=512)
 */
  __pyx_tuple__76 = PyTuple_Pack(1, __pyx_kp_s__3); if (unlikely(!__pyx_tuple__76)) __PYX_ERR(0, 1016, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__76);
  __Pyx_GIVEREF(__pyx_tuple__76);

  /* "vapor_vali/Simple_function.pyx":1017
 *                 graphics = importr("graphics")
 *                 if  len(out_figure_name.split('/')[-1])>150:
 *                     out_figure_name='/'.join(out_figure_name.split('/')[:-1])+'/'+out_figure_name.split('/')[-1][:140]+'.'+out_figure_name.split('.')[-1]             # <<<<<<<<<<<<<<
 *                 grdevices.png(file=out_figure_name, width=512, height=512)
 *                 graphics.par(mfrow=IntVector([2,2]))
 */
  __pyx_tuple__77 = PyTuple_Pack(1, __pyx_kp_s__3); if (unlikely(!__pyx_tuple__77)) __PYX_ERR(0, 1017, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__77);
  __Pyx_GIVEREF(__pyx_tuple__77);
  __pyx_slice__78 = PySlice_New(Py_None, __pyx_int_neg_1, Py_None); if (unlikely(!__pyx_slice__78)) __PYX_ERR(0, 1017, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_slice__78);
  __Pyx_GIVEREF(__pyx_slice__78);
  __pyx_tuple__79 = PyTuple_Pack(1, __pyx_kp_s__3); if (unlikely(!__pyx_tuple__79)) __PYX_ERR(0, 1017, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__79);
  __Pyx_GIVEREF(__pyx_tuple__79);
  __pyx_slice__80 = PySlice_New(Py_None, __pyx_int_140, Py_None); if (unlikely(!__pyx_slice__80)) __PYX_ERR(0, 1017, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_slice__80);
  __Pyx_GIVEREF(__pyx_slice__80);
  __pyx_tuple__81 = PyTuple_Pack(1, __pyx_kp_s__19); if (unlikely(!__pyx_tuple__81)) __PYX_ERR(0, 1017, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__81);
  __Pyx_GIVEREF(__pyx_tuple__81);

  /* "vapor_vali/Simple_function.pyx":1092
 * def polarity_detect(pin):
 *     out='+'
 *     for x in pin[7].split(';'):             # <<<<<<<<<<<<<<
 *         if 'MEIINFO=' in x:
 *             out=x.split(',')[-1]
 */
  __pyx_tuple__82 = PyTuple_Pack(1, __pyx_kp_s__26); if (unlikely(!__pyx_tuple__82)) __PYX_ERR(0, 1092, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__82);
  __Pyx_GIVEREF(__pyx_tuple__82);

  /* "vapor_vali/Simple_function.pyx":1094
 *     for x in pin[7].split(';'):
 *         if 'MEIINFO=' in x:
 *             out=x.split(',')[-1]             # <<<<<<<<<<<<<<
 *     return out
 * 
 */
  __pyx_tuple__84 = PyTuple_Pack(1, __pyx_kp_s__83); if (unlikely(!__pyx_tuple__84)) __PYX_ERR(0, 1094, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__84);
  __Pyx_GIVEREF(__pyx_tuple__84);

  /* "vapor_vali/Simple_function.pyx":1117
 * 
 * def reverse(seq):
 *     return seq[::-1]             # <<<<<<<<<<<<<<
 * 
 * def ref_ref_deviate_lines_calcu(list_dotdata):
 */
  __pyx_slice__85 = PySlice_New(Py_None, Py_None, __pyx_int_neg_1); if (unlikely(!__pyx_slice__85)) __PYX_ERR(0, 1117, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_slice__85);
  __Pyx_GIVEREF(__pyx_slice__85);

  /* "vapor_vali/Simple_function.pyx":1174
 *         return [info_list[0]]+[qual_value,geno_value,','.join([str(round(float(i),2)) for i in info_list[1]])]
 *     else:
 *         return [info_list[0]]+['NA' for i in range(3)]             # <<<<<<<<<<<<<<
 * 
 * def simple_del_diploid_decide(k1,k2):
 */
  __pyx_tuple__86 = PyTuple_Pack(1, __pyx_int_3); if (unlikely(!__pyx_tuple__86)) __PYX_ERR(0, 1174, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__86);
  __Pyx_GIVEREF(__pyx_tuple__86);

  /* "vapor_vali/Simple_function.pyx":1178
 * def simple_del_diploid_decide(k1,k2):
 *     #eg of k1='ab/ab'   ; eg of k2='a/a'
 *     k2_haps=k2.split('/')             # <<<<<<<<<<<<<<
 *     k1_hap=k1.split('/')[0]
 *     out=[]
 */
  __pyx_tuple__87 = PyTuple_Pack(1, __pyx_kp_s__3); if (unlikely(!__pyx_tuple__87)) __PYX_ERR(0, 1178, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__87);
  __Pyx_GIVEREF(__pyx_tuple__87);

  /* "vapor_vali/Simple_function.pyx":1179
 *     #eg of k1='ab/ab'   ; eg of k2='a/a'
 *     k2_haps=k2.split('/')
 *     k1_hap=k1.split('/')[0]             # <<<<<<<<<<<<<<
 *     out=[]
 *     for x in k2_haps:
 */
  __pyx_tuple__88 = PyTuple_Pack(1, __pyx_kp_s__3); if (unlikely(!__pyx_tuple__88)) __PYX_ERR(0, 1179, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__88);
  __Pyx_GIVEREF(__pyx_tuple__88);

  /* "vapor_vali/Simple_function.pyx":1201
 * def simple_inv_diploid_decide(k1,k2):
 *     #eg of k1='ab/ab'   ; eg of k2='ab^/ab'
 *     k2_haps=k2.split('/')             # <<<<<<<<<<<<<<
 *     k1_hap=k1.split('/')[0]
 *     out=[]
 */
  __pyx_tuple__89 = PyTuple_Pack(1, __pyx_kp_s__3); if (unlikely(!__pyx_tuple__89)) __PYX_ERR(0, 1201, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__89);
  __Pyx_GIVEREF(__pyx_tuple__89);

  /* "vapor_vali/Simple_function.pyx":1202
 *     #eg of k1='ab/ab'   ; eg of k2='ab^/ab'
 *     k2_haps=k2.split('/')
 *     k1_hap=k1.split('/')[0]             # <<<<<<<<<<<<<<
 *     out=[]
 *     for x in k2_haps:
 */
  __pyx_tuple__90 = PyTuple_Pack(1, __pyx_kp_s__3); if (unlikely(!__pyx_tuple__90)) __PYX_ERR(0, 1202, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__90);
  __Pyx_GIVEREF(__pyx_tuple__90);

  /* "vapor_vali/Simple_function.pyx":1213
 *     #eg of k1_hap='ab'  ;    eg of k2_hap='b^a^'
 *     if not '^' in k2_hap:   return 'FALSE'      #if not block inverted
 *     if len(k2_hap.replace('^',''))==1 and len(k1_hap)==1:   return [i for i in k1_hap]             # <<<<<<<<<<<<<<
 *     dup_test=[k2_hap.count(i) for i in k2_hap if not i=='^']
 *     if max(dup_test)>1: return 'FALSE'
 */
  __pyx_tuple__91 = PyTuple_Pack(2, __pyx_kp_s__7, __pyx_kp_s__24); if (unlikely(!__pyx_tuple__91)) __PYX_ERR(0, 1213, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__91);
  __Pyx_GIVEREF(__pyx_tuple__91);

  /* "vapor_vali/Simple_function.pyx":1217
 *     if max(dup_test)>1: return 'FALSE'
 *     inverted_sv_new=letter_subgroup(k2_hap)
 *     if ''.join([i.replace('^','') for i in inverted_sv_new])==k1_hap: return [i[:-1] for i in inverted_sv_new if '^' in i]             # <<<<<<<<<<<<<<
 *     else:   return 'FALSE'
 * 
 */
  __pyx_tuple__92 = PyTuple_Pack(2, __pyx_kp_s__7, __pyx_kp_s__24); if (unlikely(!__pyx_tuple__92)) __PYX_ERR(0, 1217, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__92);
  __Pyx_GIVEREF(__pyx_tuple__92);
  __pyx_slice__93 = PySlice_New(Py_None, __pyx_int_neg_1, Py_None); if (unlikely(!__pyx_slice__93)) __PYX_ERR(0, 1217, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_slice__93);
  __Pyx_GIVEREF(__pyx_slice__93);

  /* "vapor_vali/Simple_function.pyx":1222
 * def simple_tandup_diploid_decide(k1,k2):
 *     #eg of k1='ab/ab'   ; eg of k2='abb/ab'
 *     k2_haps=k2.split('/')             # <<<<<<<<<<<<<<
 *     k1_hap=k1.split('/')[0]
 *     out=[]
 */
  __pyx_tuple__94 = PyTuple_Pack(1, __pyx_kp_s__3); if (unlikely(!__pyx_tuple__94)) __PYX_ERR(0, 1222, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__94);
  __Pyx_GIVEREF(__pyx_tuple__94);

  /* "vapor_vali/Simple_function.pyx":1223
 *     #eg of k1='ab/ab'   ; eg of k2='abb/ab'
 *     k2_haps=k2.split('/')
 *     k1_hap=k1.split('/')[0]             # <<<<<<<<<<<<<<
 *     out=[]
 *     for x in k2_haps:
 */
  __pyx_tuple__95 = PyTuple_Pack(1, __pyx_kp_s__3); if (unlikely(!__pyx_tuple__95)) __PYX_ERR(0, 1223, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__95);
  __Pyx_GIVEREF(__pyx_tuple__95);

  /* "vapor_vali/Simple_function.pyx":1266
 * def simple_disdup_diploid_decide(k1,k2):
 *     #eg of k1='ab/ab'   ; eg of k2='bab/ab'
 *     k2_haps=k2.split('/')             # <<<<<<<<<<<<<<
 *     k1_hap=k1.split('/')[0]
 *     out=[]
 */
  __pyx_tuple__96 = PyTuple_Pack(1, __pyx_kp_s__3); if (unlikely(!__pyx_tuple__96)) __PYX_ERR(0, 1266, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__96);
  __Pyx_GIVEREF(__pyx_tuple__96);

  /* "vapor_vali/Simple_function.pyx":1267
 *     #eg of k1='ab/ab'   ; eg of k2='bab/ab'
 *     k2_haps=k2.split('/')
 *     k1_hap=k1.split('/')[0]             # <<<<<<<<<<<<<<
 *     out=[]
 *     for x in k2_haps:
 */
  __pyx_tuple__97 = PyTuple_Pack(1, __pyx_kp_s__3); if (unlikely(!__pyx_tuple__97)) __PYX_ERR(0, 1267, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__97);
  __Pyx_GIVEREF(__pyx_tuple__97);

  /* "vapor_vali/Simple_function.pyx":1369
 * def svtype_extract(pin):
 *     svtype=''
 *     for x in pin[7].split(';'):             # <<<<<<<<<<<<<<
 *         if 'SVTYPE' in x:
 *             svtype=x.split('=')[1]
 */
  __pyx_tuple__98 = PyTuple_Pack(1, __pyx_kp_s__26); if (unlikely(!__pyx_tuple__98)) __PYX_ERR(0, 1369, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__98);
  __Pyx_GIVEREF(__pyx_tuple__98);

  /* "vapor_vali/Simple_function.pyx":1371
 *     for x in pin[7].split(';'):
 *         if 'SVTYPE' in x:
 *             svtype=x.split('=')[1]             # <<<<<<<<<<<<<<
 *     if svtype=='':
 *         svtype=pin[4].replace('<','').replace('>','')
 */
  __pyx_tuple__99 = PyTuple_Pack(1, __pyx_kp_s__29); if (unlikely(!__pyx_tuple__99)) __PYX_ERR(0, 1371, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__99);
  __Pyx_GIVEREF(__pyx_tuple__99);

  /* "vapor_vali/Simple_function.pyx":1373
 *             svtype=x.split('=')[1]
 *     if svtype=='':
 *         svtype=pin[4].replace('<','').replace('>','')             # <<<<<<<<<<<<<<
 *     return svtype
 * 
 */
  __pyx_tuple__101 = PyTuple_Pack(2, __pyx_kp_s__100, __pyx_kp_s__24); if (unlikely(!__pyx_tuple__101)) __PYX_ERR(0, 1373, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__101);
  __Pyx_GIVEREF(__pyx_tuple__101);
  __pyx_tuple__103 = PyTuple_Pack(2, __pyx_kp_s__102, __pyx_kp_s__24); if (unlikely(!__pyx_tuple__103)) __PYX_ERR(0, 1373, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__103);
  __Pyx_GIVEREF(__pyx_tuple__103);

  /* "vapor_vali/Simple_function.pyx":1378
 * def sv_len_extract(pin):
 *     svtype=''
 *     for x in pin[7].split(';'):             # <<<<<<<<<<<<<<
 *         if 'SVLEN' in x:
 *             svtype=x.split('=')[1]
 */
  __pyx_tuple__104 = PyTuple_Pack(1, __pyx_kp_s__26); if (unlikely(!__pyx_tuple__104)) __PYX_ERR(0, 1378, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__104);
  __Pyx_GIVEREF(__pyx_tuple__104);

  /* "vapor_vali/Simple_function.pyx":1380
 *     for x in pin[7].split(';'):
 *         if 'SVLEN' in x:
 *             svtype=x.split('=')[1]             # <<<<<<<<<<<<<<
 *     if svtype=='':
 *         svtype=0
 */
  __pyx_tuple__105 = PyTuple_Pack(1, __pyx_kp_s__29); if (unlikely(!__pyx_tuple__105)) __PYX_ERR(0, 1380, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__105);
  __Pyx_GIVEREF(__pyx_tuple__105);

  /* "vapor_vali/Simple_function.pyx":1387
 * def sv_seq_extract(pin):
 *     seq=''
 *     for x in pin[7].split(';'):             # <<<<<<<<<<<<<<
 *         if x[:4]=='SEQ=':
 *             seq=x.split('=')[1]
 */
  __pyx_tuple__106 = PyTuple_Pack(1, __pyx_kp_s__26); if (unlikely(!__pyx_tuple__106)) __PYX_ERR(0, 1387, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__106);
  __Pyx_GIVEREF(__pyx_tuple__106);

  /* "vapor_vali/Simple_function.pyx":1388
 *     seq=''
 *     for x in pin[7].split(';'):
 *         if x[:4]=='SEQ=':             # <<<<<<<<<<<<<<
 *             seq=x.split('=')[1]
 *     return seq
 */
  __pyx_slice__107 = PySlice_New(Py_None, __pyx_int_4, Py_None); if (unlikely(!__pyx_slice__107)) __PYX_ERR(0, 1388, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_slice__107);
  __Pyx_GIVEREF(__pyx_slice__107);

  /* "vapor_vali/Simple_function.pyx":1389
 *     for x in pin[7].split(';'):
 *         if x[:4]=='SEQ=':
 *             seq=x.split('=')[1]             # <<<<<<<<<<<<<<
 *     return seq
 * 
 */
  __pyx_tuple__108 = PyTuple_Pack(1, __pyx_kp_s__29); if (unlikely(!__pyx_tuple__108)) __PYX_ERR(0, 1389, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__108);
  __Pyx_GIVEREF(__pyx_tuple__108);

  /* "vapor_vali/Simple_function.pyx":1394
 * def sv_insert_point_define(pin):
 *     svtype=[0,0]
 *     for x in pin[7].split(';'):             # <<<<<<<<<<<<<<
 *         if 'insert_point=' in x:
 *             svtype=x.split('=')[1].split(':')
 */
  __pyx_tuple__109 = PyTuple_Pack(1, __pyx_kp_s__26); if (unlikely(!__pyx_tuple__109)) __PYX_ERR(0, 1394, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__109);
  __Pyx_GIVEREF(__pyx_tuple__109);

  /* "vapor_vali/Simple_function.pyx":1396
 *     for x in pin[7].split(';'):
 *         if 'insert_point=' in x:
 *             svtype=x.split('=')[1].split(':')             # <<<<<<<<<<<<<<
 *     if svtype==[0,0]:
 *         sv_info=pin[:2]
 */
  __pyx_tuple__110 = PyTuple_Pack(1, __pyx_kp_s__29); if (unlikely(!__pyx_tuple__110)) __PYX_ERR(0, 1396, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__110);
  __Pyx_GIVEREF(__pyx_tuple__110);
  __pyx_tuple__111 = PyTuple_Pack(1, __pyx_kp_s__38); if (unlikely(!__pyx_tuple__111)) __PYX_ERR(0, 1396, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__111);
  __Pyx_GIVEREF(__pyx_tuple__111);

  /* "vapor_vali/Simple_function.pyx":1398
 *             svtype=x.split('=')[1].split(':')
 *     if svtype==[0,0]:
 *         sv_info=pin[:2]             # <<<<<<<<<<<<<<
 *     return svtype
 * 
 */
  __pyx_slice__112 = PySlice_New(Py_None, __pyx_int_2, Py_None); if (unlikely(!__pyx_slice__112)) __PYX_ERR(0, 1398, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_slice__112);
  __Pyx_GIVEREF(__pyx_slice__112);

  /* "vapor_vali/Simple_function.pyx":1403
 * def take_off_symmetric_dots(list_dotdata):
 *     left_part=[list_dotdata[i] for i in range(len(list_dotdata)/2)]
 *     right_part=[list_dotdata[i][::-1] for i in [len(list_dotdata)-1-i for i in range(len(list_dotdata)/2)]]             # <<<<<<<<<<<<<<
 *     left_new=[i for i in left_part if eu_dis_single_dot(i)>0.15]
 *     right_new=[i for i in right_part if eu_dis_single_dot(i)>0.15]
 */
  __pyx_slice__113 = PySlice_New(Py_None, Py_None, __pyx_int_neg_1); if (unlikely(!__pyx_slice__113)) __PYX_ERR(0, 1403, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_slice__113);
  __Pyx_GIVEREF(__pyx_slice__113);

  /* "vapor_vali/Simple_function.pyx":1411
 *             if abs(i[0]-j[0])<6 and abs(i[1]-j[1])<6:
 *                 sym_dots.append(i)
 *                 sym_dots.append(j[::-1])             # <<<<<<<<<<<<<<
 *     out_dots=[i for i in list_dotdata if not i in sym_dots]
 *     return out_dots
 */
  __pyx_slice__114 = PySlice_New(Py_None, Py_None, __pyx_int_neg_1); if (unlikely(!__pyx_slice__114)) __PYX_ERR(0, 1411, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_slice__114);
  __Pyx_GIVEREF(__pyx_slice__114);

  /* "vapor_vali/Simple_function.pyx":1435
 * def vapor_CANNOT_CLASSIFY_VapoR(bam_in,ref,sv_info,out_figure_name):
 *     #eg of sv_info=['ab_ab', 'b_b^', 'chr7', '70955990', '70961199', '70973901']
 *     ref_sv=sv_info[0].split('_')             # <<<<<<<<<<<<<<
 *     alt_sv=list_unify([i for i in sv_info[1].split('_') if not i in ref_sv])
 *     chromos=chromos_readin(ref)
 */
  __pyx_tuple__116 = PyTuple_Pack(1, __pyx_n_s__115); if (unlikely(!__pyx_tuple__116)) __PYX_ERR(0, 1435, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__116);
  __Pyx_GIVEREF(__pyx_tuple__116);

  /* "vapor_vali/Simple_function.pyx":1436
 *     #eg of sv_info=['ab_ab', 'b_b^', 'chr7', '70955990', '70961199', '70973901']
 *     ref_sv=sv_info[0].split('_')
 *     alt_sv=list_unify([i for i in sv_info[1].split('_') if not i in ref_sv])             # <<<<<<<<<<<<<<
 *     chromos=chromos_readin(ref)
 *     bp_info=block_subsplot(sv_info[2:],chromos)
 */
  __pyx_tuple__117 = PyTuple_Pack(1, __pyx_n_s__115); if (unlikely(!__pyx_tuple__117)) __PYX_ERR(0, 1436, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__117);
  __Pyx_GIVEREF(__pyx_tuple__117);

  /* "vapor_vali/Simple_function.pyx":1438
 *     alt_sv=list_unify([i for i in sv_info[1].split('_') if not i in ref_sv])
 *     chromos=chromos_readin(ref)
 *     bp_info=block_subsplot(sv_info[2:],chromos)             # <<<<<<<<<<<<<<
 *     flank_length=max([flank_length_calculate(i) for i in bp_info])
 *     vapor_score_list=[]
 */
  __pyx_slice__118 = PySlice_New(__pyx_int_2, Py_None, Py_None); if (unlikely(!__pyx_slice__118)) __PYX_ERR(0, 1438, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_slice__118);
  __Pyx_GIVEREF(__pyx_slice__118);

  /* "vapor_vali/Simple_function.pyx":1469
 *                                     vapor_score_list.append(1-float(vapor_single_read_score[1])/float(vapor_single_read_score[0]))
 *                                     if vapor_score_list[-1]==max(vapor_score_list):best_read_rec=x
 *                             make_event_figure_1(vapor_score_list,best_read_rec,window_size,ref_seq,alt_seq,'.'.join(out_figure_name.split('.')[:-1]+[ref_sv[0]+'.vs.'+alt_allele,out_figure_name.split('.')[-1]]))             # <<<<<<<<<<<<<<
 *         if run_flag==0:
 *             for alt_allele in alt_sv:
 */
  __pyx_tuple__119 = PyTuple_Pack(1, __pyx_kp_s__19); if (unlikely(!__pyx_tuple__119)) __PYX_ERR(0, 1469, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__119);
  __Pyx_GIVEREF(__pyx_tuple__119);
  __pyx_slice__120 = PySlice_New(Py_None, __pyx_int_neg_1, Py_None); if (unlikely(!__pyx_slice__120)) __PYX_ERR(0, 1469, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_slice__120);
  __Pyx_GIVEREF(__pyx_slice__120);
  __pyx_tuple__121 = PyTuple_Pack(1, __pyx_kp_s__19); if (unlikely(!__pyx_tuple__121)) __PYX_ERR(0, 1469, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__121);
  __Pyx_GIVEREF(__pyx_tuple__121);

  /* "vapor_vali/Simple_function.pyx":1534
 *     else:
 *         for sub_sv_info in sv_info:
 *             if 'del' in sub_sv_info:    vapor_score_list+=vapor_simple_del_Vapor(bam_in,ref,sub_sv_info[:-1],'.'.join(out_figure_name.split('.')[:-1])+'_'.join([str(i) for i in sub_sv_info])+'.'+out_figure_name.split('.')[-1])             # <<<<<<<<<<<<<<
 *             elif 'inv' in sub_sv_info:    vapor_score_list+=vapor_simple_inv_Vapor(bam_in,ref,sub_sv_info[:-1],'.'.join(out_figure_name.split('.')[:-1])+'_'.join([str(i) for i in sub_sv_info])+'.'+out_figure_name.split('.')[-1])
 *     return vapor_score_list
 */
  __pyx_slice__122 = PySlice_New(Py_None, __pyx_int_neg_1, Py_None); if (unlikely(!__pyx_slice__122)) __PYX_ERR(0, 1534, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_slice__122);
  __Pyx_GIVEREF(__pyx_slice__122);
  __pyx_tuple__123 = PyTuple_Pack(1, __pyx_kp_s__19); if (unlikely(!__pyx_tuple__123)) __PYX_ERR(0, 1534, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__123);
  __Pyx_GIVEREF(__pyx_tuple__123);
  __pyx_slice__124 = PySlice_New(Py_None, __pyx_int_neg_1, Py_None); if (unlikely(!__pyx_slice__124)) __PYX_ERR(0, 1534, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_slice__124);
  __Pyx_GIVEREF(__pyx_slice__124);
  __pyx_tuple__125 = PyTuple_Pack(1, __pyx_kp_s__19); if (unlikely(!__pyx_tuple__125)) __PYX_ERR(0, 1534, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__125);
  __Pyx_GIVEREF(__pyx_tuple__125);

  /* "vapor_vali/Simple_function.pyx":1535
 *         for sub_sv_info in sv_info:
 *             if 'del' in sub_sv_info:    vapor_score_list+=vapor_simple_del_Vapor(bam_in,ref,sub_sv_info[:-1],'.'.join(out_figure_name.split('.')[:-1])+'_'.join([str(i) for i in sub_sv_info])+'.'+out_figure_name.split('.')[-1])
 *             elif 'inv' in sub_sv_info:    vapor_score_list+=vapor_simple_inv_Vapor(bam_in,ref,sub_sv_info[:-1],'.'.join(out_figure_name.split('.')[:-1])+'_'.join([str(i) for i in sub_sv_info])+'.'+out_figure_name.split('.')[-1])             # <<<<<<<<<<<<<<
 *     return vapor_score_list
 * 
 */
  __pyx_slice__126 = PySlice_New(Py_None, __pyx_int_neg_1, Py_None); if (unlikely(!__pyx_slice__126)) __PYX_ERR(0, 1535, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_slice__126);
  __Pyx_GIVEREF(__pyx_slice__126);
  __pyx_tuple__127 = PyTuple_Pack(1, __pyx_kp_s__19); if (unlikely(!__pyx_tuple__127)) __PYX_ERR(0, 1535, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__127);
  __Pyx_GIVEREF(__pyx_tuple__127);
  __pyx_slice__128 = PySlice_New(Py_None, __pyx_int_neg_1, Py_None); if (unlikely(!__pyx_slice__128)) __PYX_ERR(0, 1535, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_slice__128);
  __Pyx_GIVEREF(__pyx_slice__128);
  __pyx_tuple__129 = PyTuple_Pack(1, __pyx_kp_s__19); if (unlikely(!__pyx_tuple__129)) __PYX_ERR(0, 1535, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__129);
  __Pyx_GIVEREF(__pyx_tuple__129);

  /* "vapor_vali/Simple_function.pyx":1540
 * def vapor_dup_inv_VapoR(bam_in,ref,sv_info,out_figure_name):
 *     #eg of sv_info=['chr1', 114103333, 114103408, 'chr1', 114111746]
 *     sv_info[1:3]=[int(i) for i in sv_info[1:3]]             # <<<<<<<<<<<<<<
 *     dup_block=sv_info[:3]
 *     ins_point=[sv_info[3],int(sv_info[4])]
 */
  __pyx_slice__130 = PySlice_New(__pyx_int_1, __pyx_int_3, Py_None); if (unlikely(!__pyx_slice__130)) __PYX_ERR(0, 1540, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_slice__130);
  __Pyx_GIVEREF(__pyx_slice__130);
  __pyx_slice__131 = PySlice_New(__pyx_int_1, __pyx_int_3, Py_None); if (unlikely(!__pyx_slice__131)) __PYX_ERR(0, 1540, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_slice__131);
  __Pyx_GIVEREF(__pyx_slice__131);

  /* "vapor_vali/Simple_function.pyx":1541
 *     #eg of sv_info=['chr1', 114103333, 114103408, 'chr1', 114111746]
 *     sv_info[1:3]=[int(i) for i in sv_info[1:3]]
 *     dup_block=sv_info[:3]             # <<<<<<<<<<<<<<
 *     ins_point=[sv_info[3],int(sv_info[4])]
 *     flank_length=flank_length_calculate(dup_block)
 */
  __pyx_slice__132 = PySlice_New(Py_None, __pyx_int_3, Py_None); if (unlikely(!__pyx_slice__132)) __PYX_ERR(0, 1541, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_slice__132);
  __Pyx_GIVEREF(__pyx_slice__132);

  /* "vapor_vali/Simple_function.pyx":1546
 *     vapor_score_list=[]
 *     if sv_info[0]==sv_info[3]:  #dup inv on the same chromosome
 *         bp_info=sorted(sv_info[1:3]+[sv_info[4]])             # <<<<<<<<<<<<<<
 *         run_flag=0
 *         if sv_info[0]==sv_info[3] and max(bp_info)-min(bp_info)<default_max_sv_test: #try to test on the whole region
 */
  __pyx_slice__133 = PySlice_New(__pyx_int_1, __pyx_int_3, Py_None); if (unlikely(!__pyx_slice__133)) __PYX_ERR(0, 1546, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_slice__133);
  __Pyx_GIVEREF(__pyx_slice__133);

  /* "vapor_vali/Simple_function.pyx":1686
 *             [window_size,window_size_qc]=window_size_refine(alt_seq)
 *             if not window_size=='Error':
 *                 all_reads=simple_chop_pacbio_read_simple_short(bam_in,sv_info[:2]+[sv_info[1]+2*(sv_info[2]-sv_info[1])],flank_length)             # <<<<<<<<<<<<<<
 *                 if len(all_reads)>10:
 *                     best_read_rec=''
 */
  __pyx_slice__134 = PySlice_New(Py_None, __pyx_int_2, Py_None); if (unlikely(!__pyx_slice__134)) __PYX_ERR(0, 1686, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_slice__134);
  __Pyx_GIVEREF(__pyx_slice__134);

  /* "vapor_vali/Simple_function.pyx":1714
 * 
 * def vapor_simple_disdup_Vapor(bam_in,ref,sv_info,out_figure_name):
 *     sv_info[1:3]=[int(i) for i in sv_info[1:3]]             # <<<<<<<<<<<<<<
 *     dup_block=sv_info[:3]
 *     ins_point=[sv_info[3],int(sv_info[4])]
 */
  __pyx_slice__135 = PySlice_New(__pyx_int_1, __pyx_int_3, Py_None); if (unlikely(!__pyx_slice__135)) __PYX_ERR(0, 1714, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_slice__135);
  __Pyx_GIVEREF(__pyx_slice__135);
  __pyx_slice__136 = PySlice_New(__pyx_int_1, __pyx_int_3, Py_None); if (unlikely(!__pyx_slice__136)) __PYX_ERR(0, 1714, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_slice__136);
  __Pyx_GIVEREF(__pyx_slice__136);

  /* "vapor_vali/Simple_function.pyx":1715
 * def vapor_simple_disdup_Vapor(bam_in,ref,sv_info,out_figure_name):
 *     sv_info[1:3]=[int(i) for i in sv_info[1:3]]
 *     dup_block=sv_info[:3]             # <<<<<<<<<<<<<<
 *     ins_point=[sv_info[3],int(sv_info[4])]
 *     flank_length=flank_length_calculate(dup_block)
 */
  __pyx_slice__137 = PySlice_New(Py_None, __pyx_int_3, Py_None); if (unlikely(!__pyx_slice__137)) __PYX_ERR(0, 1715, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_slice__137);
  __Pyx_GIVEREF(__pyx_slice__137);

  /* "vapor_vali/Simple_function.pyx":1720
 *     vapor_score_list=[]
 *     best_read_rec=''
 *     bp_info=sorted([int(i) for i in sv_info[1:3]+[sv_info[4]]])             # <<<<<<<<<<<<<<
 *     run_flag=0
 *     if sv_info[0]==sv_info[3] and max(bp_info)-min(bp_info)<default_max_sv_test: #try to test on the whole region
 */
  __pyx_slice__138 = PySlice_New(__pyx_int_1, __pyx_int_3, Py_None); if (unlikely(!__pyx_slice__138)) __PYX_ERR(0, 1720, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_slice__138);
  __Pyx_GIVEREF(__pyx_slice__138);

  /* "vapor_vali/Simple_function.pyx":1794
 *     vapor_score_list=[]
 *     best_read_rec=''
 *     all_reads=simple_chop_pacbio_read_simple_short(bam_in,['_'.join(ins_pos.split('_')[:-1]),ins_pos.split('_')[-1]]+[int(ins_pos.split('_')[-1])+len(ins_seq)],flank_length)             # <<<<<<<<<<<<<<
 *     if len(all_reads)>0:
 *         ref_seq=ref_seq_readin(ref,['_'.join(ins_pos.split('_')[:-1]),ins_pos.split('_')[-1]][0],int(ins_pos.split('_')[-1])-flank_length,int(ins_pos.split('_')[-1])+flank_length+len(ins_seq),reverse_flag='FALSE')
 */
  __pyx_tuple__139 = PyTuple_Pack(1, __pyx_n_s__115); if (unlikely(!__pyx_tuple__139)) __PYX_ERR(0, 1794, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__139);
  __Pyx_GIVEREF(__pyx_tuple__139);
  __pyx_slice__140 = PySlice_New(Py_None, __pyx_int_neg_1, Py_None); if (unlikely(!__pyx_slice__140)) __PYX_ERR(0, 1794, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_slice__140);
  __Pyx_GIVEREF(__pyx_slice__140);
  __pyx_tuple__141 = PyTuple_Pack(1, __pyx_n_s__115); if (unlikely(!__pyx_tuple__141)) __PYX_ERR(0, 1794, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__141);
  __Pyx_GIVEREF(__pyx_tuple__141);
  __pyx_tuple__142 = PyTuple_Pack(1, __pyx_n_s__115); if (unlikely(!__pyx_tuple__142)) __PYX_ERR(0, 1794, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__142);
  __Pyx_GIVEREF(__pyx_tuple__142);

  /* "vapor_vali/Simple_function.pyx":1796
 *     all_reads=simple_chop_pacbio_read_simple_short(bam_in,['_'.join(ins_pos.split('_')[:-1]),ins_pos.split('_')[-1]]+[int(ins_pos.split('_')[-1])+len(ins_seq)],flank_length)
 *     if len(all_reads)>0:
 *         ref_seq=ref_seq_readin(ref,['_'.join(ins_pos.split('_')[:-1]),ins_pos.split('_')[-1]][0],int(ins_pos.split('_')[-1])-flank_length,int(ins_pos.split('_')[-1])+flank_length+len(ins_seq),reverse_flag='FALSE')             # <<<<<<<<<<<<<<
 *         [window_size,window_size_qc]=window_size_refine(ref_seq)
 *         if not window_size=='Error':
 */
  __pyx_tuple__143 = PyTuple_Pack(1, __pyx_n_s__115); if (unlikely(!__pyx_tuple__143)) __PYX_ERR(0, 1796, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__143);
  __Pyx_GIVEREF(__pyx_tuple__143);
  __pyx_slice__144 = PySlice_New(Py_None, __pyx_int_neg_1, Py_None); if (unlikely(!__pyx_slice__144)) __PYX_ERR(0, 1796, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_slice__144);
  __Pyx_GIVEREF(__pyx_slice__144);
  __pyx_tuple__145 = PyTuple_Pack(1, __pyx_n_s__115); if (unlikely(!__pyx_tuple__145)) __PYX_ERR(0, 1796, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__145);
  __Pyx_GIVEREF(__pyx_tuple__145);
  __pyx_tuple__146 = PyTuple_Pack(1, __pyx_n_s__115); if (unlikely(!__pyx_tuple__146)) __PYX_ERR(0, 1796, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__146);
  __Pyx_GIVEREF(__pyx_tuple__146);
  __pyx_tuple__147 = PyTuple_Pack(1, __pyx_n_s__115); if (unlikely(!__pyx_tuple__147)) __PYX_ERR(0, 1796, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__147);
  __Pyx_GIVEREF(__pyx_tuple__147);

  /* "vapor_vali/Simple_function.pyx":1804
 *                 if len(all_reads)>10:
 *                     for x in all_reads:
 *                         if float(x[0].count('N')+x[0].count('n'))/float(len(x[0]))<0.1:             # <<<<<<<<<<<<<<
 *                             vapor_single_read_score=calcu_vapor_single_read_score_abs_dis_m1b(ref_seq,alt_seq,x,window_size)
 *                             if not 0 in vapor_single_read_score:
 */
  __pyx_tuple__148 = PyTuple_Pack(1, __pyx_n_s_N); if (unlikely(!__pyx_tuple__148)) __PYX_ERR(0, 1804, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__148);
  __Pyx_GIVEREF(__pyx_tuple__148);
  __pyx_tuple__149 = PyTuple_Pack(1, __pyx_n_s_n); if (unlikely(!__pyx_tuple__149)) __PYX_ERR(0, 1804, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__149);
  __Pyx_GIVEREF(__pyx_tuple__149);

  /* "vapor_vali/Simple_function.pyx":1810
 *                                 if vapor_score_list[-1]==max(vapor_score_list):best_read_rec=x
 *                 else:
 *                     all_reads=simple_chop_pacbio_read_simple_short(bam_in,['_'.join(ins_pos.split('_')[:-1]),ins_pos.split('_')[-1]]+[int(ins_pos.split('_')[-1])],flank_length)             # <<<<<<<<<<<<<<
 *                     for x in all_reads:
 *                         if float(x[0].count('N')+x[0].count('n'))/float(len(x[0]))<0.1:
 */
  __pyx_tuple__150 = PyTuple_Pack(1, __pyx_n_s__115); if (unlikely(!__pyx_tuple__150)) __PYX_ERR(0, 1810, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__150);
  __Pyx_GIVEREF(__pyx_tuple__150);
  __pyx_slice__151 = PySlice_New(Py_None, __pyx_int_neg_1, Py_None); if (unlikely(!__pyx_slice__151)) __PYX_ERR(0, 1810, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_slice__151);
  __Pyx_GIVEREF(__pyx_slice__151);
  __pyx_tuple__152 = PyTuple_Pack(1, __pyx_n_s__115); if (unlikely(!__pyx_tuple__152)) __PYX_ERR(0, 1810, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__152);
  __Pyx_GIVEREF(__pyx_tuple__152);
  __pyx_tuple__153 = PyTuple_Pack(1, __pyx_n_s__115); if (unlikely(!__pyx_tuple__153)) __PYX_ERR(0, 1810, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__153);
  __Pyx_GIVEREF(__pyx_tuple__153);

  /* "vapor_vali/Simple_function.pyx":1812
 *                     all_reads=simple_chop_pacbio_read_simple_short(bam_in,['_'.join(ins_pos.split('_')[:-1]),ins_pos.split('_')[-1]]+[int(ins_pos.split('_')[-1])],flank_length)
 *                     for x in all_reads:
 *                         if float(x[0].count('N')+x[0].count('n'))/float(len(x[0]))<0.1:             # <<<<<<<<<<<<<<
 *                             vapor_single_read_score=calcu_vapor_single_read_score_within_10Perc_m1b(ref_seq,alt_seq,x,window_size)
 *                             if not 0 in vapor_single_read_score:
 */
  __pyx_tuple__154 = PyTuple_Pack(1, __pyx_n_s_N); if (unlikely(!__pyx_tuple__154)) __PYX_ERR(0, 1812, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__154);
  __Pyx_GIVEREF(__pyx_tuple__154);
  __pyx_tuple__155 = PyTuple_Pack(1, __pyx_n_s_n); if (unlikely(!__pyx_tuple__155)) __PYX_ERR(0, 1812, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__155);
  __Pyx_GIVEREF(__pyx_tuple__155);

  /* "vapor_vali/Simple_function.pyx":1817
 *                                 vapor_score_list.append(1-float(vapor_single_read_score[1])/float(vapor_single_read_score[0]))
 *                                 if vapor_score_list[-1]==max(vapor_score_list):best_read_rec=x
 *                 if ins_seq_2.count('X')==len(ins_seq_2):        make_event_figure_1(vapor_score_list,best_read_rec,window_size,ref_seq,ref_seq[2:flank_length],out_figure_name)             # <<<<<<<<<<<<<<
 *                 else:            make_event_figure_1(vapor_score_list,best_read_rec,window_size,ref_seq,alt_seq,out_figure_name)
 *     return vapor_score_list
 */
  __pyx_tuple__156 = PyTuple_Pack(1, __pyx_n_s_X); if (unlikely(!__pyx_tuple__156)) __PYX_ERR(0, 1817, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__156);
  __Pyx_GIVEREF(__pyx_tuple__156);

  /* "vapor_vali/Simple_function.pyx":1887
 *             sv_rec_label=vcf_rec_hash_new[pin[0]]
 *             for y in sv_rec_label:
 *                 vcf_info_hash[y]+=[round(float(i),2) if not i=='NA' else i for i in pin[1:3]]             # <<<<<<<<<<<<<<
 *                 keep_rec.append(y)
 *     fin.close()
 */
  __pyx_slice__158 = PySlice_New(__pyx_int_1, __pyx_int_3, Py_None); if (unlikely(!__pyx_slice__158)) __PYX_ERR(0, 1887, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_slice__158);
  __Pyx_GIVEREF(__pyx_slice__158);

  /* "vapor_vali/Simple_function.pyx":1899
 * def window_size_refine(seq2,region_QC_Cff=0.4):
 *     window_size=10
 *     if not seq2.count('N')+seq2.count('n')>100:             # <<<<<<<<<<<<<<
 *         dotdata_qual_check=dotdata(window_size,seq2,seq2)
 *         if len(dotdata_qual_check)>0:
 */
  __pyx_tuple__160 = PyTuple_Pack(1, __pyx_n_s_N); if (unlikely(!__pyx_tuple__160)) __PYX_ERR(0, 1899, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__160);
  __Pyx_GIVEREF(__pyx_tuple__160);
  __pyx_tuple__161 = PyTuple_Pack(1, __pyx_n_s_n); if (unlikely(!__pyx_tuple__161)) __PYX_ERR(0, 1899, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__161);
  __Pyx_GIVEREF(__pyx_tuple__161);

  /* "vapor_vali/Simple_function.pyx":26
 * default_max_sv_test=10000 #when size of a sv block excessed default_max_sv_test, try junctions instead of event
 * 
 * def alt_seq_readin(ref,info,flank_length):             # <<<<<<<<<<<<<<
 *     #eg of info=('abcde/abcde', 'db/db', '1', '14436355', '14436655', '14437075', '14438241', '14438566', '14438940']
 *     block_hash={}
 */
  __pyx_tuple__163 = PyTuple_Pack(9, __pyx_n_s_ref, __pyx_n_s_info, __pyx_n_s_flank_length, __pyx_n_s_block_hash, __pyx_n_s_x, __pyx_n_s_out, __pyx_n_s_rec, __pyx_n_s_temp_x, __pyx_n_s_y); if (unlikely(!__pyx_tuple__163)) __PYX_ERR(0, 26, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__163);
  __Pyx_GIVEREF(__pyx_tuple__163);
  __pyx_codeobj__164 = (PyObject*)__Pyx_PyCode_New(3, 0, 9, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__163, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_scratch_remills_flux_xuefzhao_a, __pyx_n_s_alt_seq_readin, 26, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__164)) __PYX_ERR(0, 26, __pyx_L1_error)

  /* "vapor_vali/Simple_function.pyx":67
 *         return [out[0],out[0]]
 * 
 * def bam_in_decide(bam_in,bps):             # <<<<<<<<<<<<<<
 *     if os.path.isfile(bam_in):
 *         return [bam_in]
 */
  __pyx_tuple__165 = PyTuple_Pack(8, __pyx_n_s_bam_in, __pyx_n_s_bps, __pyx_n_s_temp_bam_in, __pyx_n_s_bam_in_path, __pyx_n_s_bam_in_keys, __pyx_n_s_k1, __pyx_n_s_flag, __pyx_n_s_y); if (unlikely(!__pyx_tuple__165)) __PYX_ERR(0, 67, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__165);
  __Pyx_GIVEREF(__pyx_tuple__165);
  __pyx_codeobj__166 = (PyObject*)__Pyx_PyCode_New(2, 0, 8, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__165, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_scratch_remills_flux_xuefzhao_a, __pyx_n_s_bam_in_decide, 67, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__166)) __PYX_ERR(0, 67, __pyx_L1_error)

  /* "vapor_vali/Simple_function.pyx":89
 *         return temp_bam_in
 * 
 * def block_around_check(alt_allele,ref_allele):             # <<<<<<<<<<<<<<
 *     #eg of alt_allele='abcab'  eg of ref_allele='abcd'
 *     alt_juncs=[[['-']+letter_split(alt_allele)+['+']][0][j:j+2] for j in range(len(letter_split(alt_allele))+1)]
 */
  __pyx_tuple__167 = PyTuple_Pack(7, __pyx_n_s_alt_allele, __pyx_n_s_ref_allele, __pyx_n_s_alt_juncs, __pyx_n_s_ref_juncs, __pyx_n_s_new_juncs, __pyx_n_s_j, __pyx_n_s_i); if (unlikely(!__pyx_tuple__167)) __PYX_ERR(0, 89, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__167);
  __Pyx_GIVEREF(__pyx_tuple__167);
  __pyx_codeobj__168 = (PyObject*)__Pyx_PyCode_New(2, 0, 7, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__167, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_scratch_remills_flux_xuefzhao_a, __pyx_n_s_block_around_check, 89, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__168)) __PYX_ERR(0, 89, __pyx_L1_error)

  /* "vapor_vali/Simple_function.pyx":96
 *     return new_juncs
 * 
 * def bp_to_chr_hash(bps,chromos,flank_length=500):             # <<<<<<<<<<<<<<
 *     #eg of bps=['chr16', '34910548', '34911339', '34913149', '34913438', '36181068', '36181482']
 *     temp1=[]
 */
  __pyx_tuple__169 = PyTuple_Pack(9, __pyx_n_s_bps, __pyx_n_s_chromos, __pyx_n_s_flank_length, __pyx_n_s_temp1, __pyx_n_s_i, __pyx_n_s_out, __pyx_n_s_rec, __pyx_n_s_k1, __pyx_n_s_k2); if (unlikely(!__pyx_tuple__169)) __PYX_ERR(0, 96, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__169);
  __Pyx_GIVEREF(__pyx_tuple__169);
  __pyx_codeobj__170 = (PyObject*)__Pyx_PyCode_New(3, 0, 9, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__169, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_scratch_remills_flux_xuefzhao_a, __pyx_n_s_bp_to_chr_hash, 96, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__170)) __PYX_ERR(0, 96, __pyx_L1_error)

  /* "vapor_vali/Simple_function.pyx":114
 *     return out
 * 
 * def bp_to_block_len(bp_info):             # <<<<<<<<<<<<<<
 *     #eg of bp_info=['chr1',127906515, 127907283, 127907399]
 *     out={}
 */
  __pyx_tuple__171 = PyTuple_Pack(3, __pyx_n_s_bp_info, __pyx_n_s_out, __pyx_n_s_i); if (unlikely(!__pyx_tuple__171)) __PYX_ERR(0, 114, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__171);
  __Pyx_GIVEREF(__pyx_tuple__171);
  __pyx_codeobj__172 = (PyObject*)__Pyx_PyCode_New(1, 0, 3, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__171, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_scratch_remills_flux_xuefzhao_a, __pyx_n_s_bp_to_block_len, 114, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__172)) __PYX_ERR(0, 114, __pyx_L1_error)

  /* "vapor_vali/Simple_function.pyx":121
 *     return out
 * 
 * def block_modify(block,chromos):             # <<<<<<<<<<<<<<
 *     #eg of block=['chr16', '34911339', '34913149', 'chr16', '34913149', '34913438']
 *     out=[]
 */
  __pyx_tuple__173 = PyTuple_Pack(7, __pyx_n_s_block, __pyx_n_s_chromos, __pyx_n_s_out, __pyx_n_s_x, __pyx_n_s_out_new, __pyx_n_s_y, __pyx_n_s_out_new_2); if (unlikely(!__pyx_tuple__173)) __PYX_ERR(0, 121, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__173);
  __Pyx_GIVEREF(__pyx_tuple__173);
  __pyx_codeobj__174 = (PyObject*)__Pyx_PyCode_New(2, 0, 7, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__173, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_scratch_remills_flux_xuefzhao_a, __pyx_n_s_block_modify, 121, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__174)) __PYX_ERR(0, 121, __pyx_L1_error)

  /* "vapor_vali/Simple_function.pyx":145
 *     return out_new_2
 * 
 * def block_subsplot(bp_list,chromos):             # <<<<<<<<<<<<<<
 *     #eg of bp_list=['chr1', '9061390', '9061470', 'chr14', '93246136', '93248034']
 *     out=[]
 */
  __pyx_tuple__175 = PyTuple_Pack(4, __pyx_n_s_bp_list, __pyx_n_s_chromos, __pyx_n_s_out, __pyx_n_s_x); if (unlikely(!__pyx_tuple__175)) __PYX_ERR(0, 145, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__175);
  __Pyx_GIVEREF(__pyx_tuple__175);
  __pyx_codeobj__176 = (PyObject*)__Pyx_PyCode_New(2, 0, 4, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__175, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_scratch_remills_flux_xuefzhao_a, __pyx_n_s_block_subsplot, 145, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__176)) __PYX_ERR(0, 145, __pyx_L1_error)

  /* "vapor_vali/Simple_function.pyx":153
 *     return out
 * 
 * def calcu_log10(x):             # <<<<<<<<<<<<<<
 *     if x==0:
 *         return 0
 */
  __pyx_tuple__177 = PyTuple_Pack(1, __pyx_n_s_x); if (unlikely(!__pyx_tuple__177)) __PYX_ERR(0, 153, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__177);
  __Pyx_GIVEREF(__pyx_tuple__177);
  __pyx_codeobj__178 = (PyObject*)__Pyx_PyCode_New(1, 0, 1, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__177, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_scratch_remills_flux_xuefzhao_a, __pyx_n_s_calcu_log10, 153, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__178)) __PYX_ERR(0, 153, __pyx_L1_error)

  /* "vapor_vali/Simple_function.pyx":159
 *         return np.log10(x)
 * 
 * def calcu_vapor_single_read_score_abs_dis_m1(ref_seq,alt_seq,x,window_size):             # <<<<<<<<<<<<<<
 *     ref_dotdata=dotdata(window_size,x[0],ref_seq[x[1]:])
 *     alt_dotdata=dotdata(window_size,x[0],alt_seq[x[1]:])
 */
  __pyx_tuple__179 = PyTuple_Pack(17, __pyx_n_s_ref_seq, __pyx_n_s_alt_seq, __pyx_n_s_x, __pyx_n_s_window_size, __pyx_n_s_ref_dotdata, __pyx_n_s_alt_dotdata, __pyx_n_s_ref_clean_dotdata, __pyx_n_s_ref_kept_segs, __pyx_n_s_alt_clean_dotdata, __pyx_n_s_alt_kept_segs, __pyx_n_s_ref_left, __pyx_n_s_alt_left, __pyx_n_s_ref_anti_diag_clean_dotdata, __pyx_n_s_ref_anti_diag_kept_segs, __pyx_n_s_alt_anti_diag_clean_dotdata, __pyx_n_s_alt_anti_diag_kept_segs, __pyx_n_s_i); if (unlikely(!__pyx_tuple__179)) __PYX_ERR(0, 159, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__179);
  __Pyx_GIVEREF(__pyx_tuple__179);
  __pyx_codeobj__180 = (PyObject*)__Pyx_PyCode_New(4, 0, 17, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__179, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_scratch_remills_flux_xuefzhao_a, __pyx_n_s_calcu_vapor_single_read_score_ab_2, 159, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__180)) __PYX_ERR(0, 159, __pyx_L1_error)

  /* "vapor_vali/Simple_function.pyx":178
 *         return [0,0]
 * 
 * def calcu_vapor_single_read_score_abs_dis_m1b(ref_seq,alt_seq,x,window_size):             # <<<<<<<<<<<<<<
 *     ref_dotdata=dotdata(window_size,x[0],ref_seq[x[1]:])
 *     alt_dotdata=dotdata(window_size,x[0],alt_seq[x[1]:])
 */
  __pyx_tuple__181 = PyTuple_Pack(8, __pyx_n_s_ref_seq, __pyx_n_s_alt_seq, __pyx_n_s_x, __pyx_n_s_window_size, __pyx_n_s_ref_dotdata, __pyx_n_s_alt_dotdata, __pyx_n_s_ref_clean_dotdata, __pyx_n_s_alt_clean_dotdata); if (unlikely(!__pyx_tuple__181)) __PYX_ERR(0, 178, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__181);
  __Pyx_GIVEREF(__pyx_tuple__181);
  __pyx_codeobj__182 = (PyObject*)__Pyx_PyCode_New(4, 0, 8, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__181, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_scratch_remills_flux_xuefzhao_a, __pyx_n_s_calcu_vapor_single_read_score_ab, 178, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__182)) __PYX_ERR(0, 178, __pyx_L1_error)

  /* "vapor_vali/Simple_function.pyx":199
 *         return [0,0]
 * 
 * def calcu_vapor_single_read_score_directed_dis_m1b(ref_seq,alt_seq,x,window_size):             # <<<<<<<<<<<<<<
 *     ref_dotdata=dotdata(window_size,x[0],ref_seq[x[1]:])
 *     alt_dotdata=dotdata(window_size,x[0],alt_seq[x[1]:])
 */
  __pyx_tuple__183 = PyTuple_Pack(8, __pyx_n_s_ref_seq, __pyx_n_s_alt_seq, __pyx_n_s_x, __pyx_n_s_window_size, __pyx_n_s_ref_dotdata, __pyx_n_s_alt_dotdata, __pyx_n_s_ref_clean_dotdata, __pyx_n_s_alt_clean_dotdata); if (unlikely(!__pyx_tuple__183)) __PYX_ERR(0, 199, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__183);
  __Pyx_GIVEREF(__pyx_tuple__183);
  __pyx_codeobj__184 = (PyObject*)__Pyx_PyCode_New(4, 0, 8, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__183, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_scratch_remills_flux_xuefzhao_a, __pyx_n_s_calcu_vapor_single_read_score_di_2, 199, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__184)) __PYX_ERR(0, 199, __pyx_L1_error)

  /* "vapor_vali/Simple_function.pyx":221
 *         return [0,0]
 * 
 * def calcu_vapor_single_read_score_directed_dis_m1b_not_really(ref_seq,alt_seq,x,window_size,ref_bps,alt_bps):             # <<<<<<<<<<<<<<
 *     ref_dotdata=dotdata(window_size,x[0],ref_seq[x[1]:])
 *     alt_dotdata=dotdata(window_size,x[0],alt_seq[x[1]:])
 */
  __pyx_tuple__185 = PyTuple_Pack(10, __pyx_n_s_ref_seq, __pyx_n_s_alt_seq, __pyx_n_s_x, __pyx_n_s_window_size, __pyx_n_s_ref_bps, __pyx_n_s_alt_bps, __pyx_n_s_ref_dotdata, __pyx_n_s_alt_dotdata, __pyx_n_s_ref_clean_dotdata, __pyx_n_s_alt_clean_dotdata); if (unlikely(!__pyx_tuple__185)) __PYX_ERR(0, 221, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__185);
  __Pyx_GIVEREF(__pyx_tuple__185);
  __pyx_codeobj__186 = (PyObject*)__Pyx_PyCode_New(6, 0, 10, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__185, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_scratch_remills_flux_xuefzhao_a, __pyx_n_s_calcu_vapor_single_read_score_di_3, 221, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__186)) __PYX_ERR(0, 221, __pyx_L1_error)

  /* "vapor_vali/Simple_function.pyx":235
 *         return [0,0]
 * 
 * def calcu_vapor_single_read_score_directed_dis_m1b_redefine_diagnal(ref_seq,alt_seq,x,window_size):             # <<<<<<<<<<<<<<
 *     ref_dotdata=dotdata(window_size,x[0],ref_seq[x[1]:])
 *     alt_dotdata=dotdata(window_size,x[0],alt_seq[x[1]:])
 */
  __pyx_tuple__187 = PyTuple_Pack(11, __pyx_n_s_ref_seq, __pyx_n_s_alt_seq, __pyx_n_s_x, __pyx_n_s_window_size, __pyx_n_s_ref_dotdata, __pyx_n_s_alt_dotdata, __pyx_n_s_ref_clean_dotdata, __pyx_n_s_alt_clean_dotdata, __pyx_n_s_ref_new_intercept, __pyx_n_s_alt_new_intercept, __pyx_n_s_i); if (unlikely(!__pyx_tuple__187)) __PYX_ERR(0, 235, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__187);
  __Pyx_GIVEREF(__pyx_tuple__187);
  __pyx_codeobj__188 = (PyObject*)__Pyx_PyCode_New(4, 0, 11, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__187, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_scratch_remills_flux_xuefzhao_a, __pyx_n_s_calcu_vapor_single_read_score_di, 235, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__188)) __PYX_ERR(0, 235, __pyx_L1_error)

  /* "vapor_vali/Simple_function.pyx":253
 *         return [0,0]
 * 
 * def calcu_vapor_single_read_score_directed_dis_m1b_maybe(ref_seq,alt_seq,x,window_size,dup_block_bps):             # <<<<<<<<<<<<<<
 *     #ref_ref_dotdata=dotdata(window_size,ref_seq[x[1]:],ref_seq[x[1]:])
 *     #alt_alt_dotdata=dotdata(window_size,alt_seq[x[1]:],alt_seq[x[1]:])
 */
  __pyx_tuple__189 = PyTuple_Pack(9, __pyx_n_s_ref_seq, __pyx_n_s_alt_seq, __pyx_n_s_x, __pyx_n_s_window_size, __pyx_n_s_dup_block_bps, __pyx_n_s_ref_dotdata, __pyx_n_s_alt_dotdata, __pyx_n_s_ref_clean_dotdata, __pyx_n_s_alt_clean_dotdata); if (unlikely(!__pyx_tuple__189)) __PYX_ERR(0, 253, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__189);
  __Pyx_GIVEREF(__pyx_tuple__189);
  __pyx_codeobj__190 = (PyObject*)__Pyx_PyCode_New(5, 0, 9, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__189, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_scratch_remills_flux_xuefzhao_a, __pyx_n_s_calcu_vapor_single_read_score_di_4, 253, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__190)) __PYX_ERR(0, 253, __pyx_L1_error)

  /* "vapor_vali/Simple_function.pyx":271
 *         return [0,0]
 * 
 * def calcu_vapor_single_read_score_within_10Perc_m1b(ref_seq,alt_seq,x,window_size):             # <<<<<<<<<<<<<<
 *     ref_dotdata=dotdata(window_size,x[0],ref_seq[x[1]:])
 *     alt_dotdata=dotdata(window_size,x[0],alt_seq[x[1]:])
 */
  __pyx_tuple__191 = PyTuple_Pack(17, __pyx_n_s_ref_seq, __pyx_n_s_alt_seq, __pyx_n_s_x, __pyx_n_s_window_size, __pyx_n_s_ref_dotdata, __pyx_n_s_alt_dotdata, __pyx_n_s_ref_clean_dotdata, __pyx_n_s_ref_kept_segs, __pyx_n_s_alt_clean_dotdata, __pyx_n_s_alt_kept_segs, __pyx_n_s_ref_left, __pyx_n_s_alt_left, __pyx_n_s_ref_anti_diag_clean_dotdata, __pyx_n_s_ref_anti_diag_kept_segs, __pyx_n_s_alt_anti_diag_clean_dotdata, __pyx_n_s_alt_anti_diag_kept_segs, __pyx_n_s_i); if (unlikely(!__pyx_tuple__191)) __PYX_ERR(0, 271, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__191);
  __Pyx_GIVEREF(__pyx_tuple__191);
  __pyx_codeobj__192 = (PyObject*)__Pyx_PyCode_New(4, 0, 17, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__191, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_scratch_remills_flux_xuefzhao_a, __pyx_n_s_calcu_vapor_single_read_score_wi, 271, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__192)) __PYX_ERR(0, 271, __pyx_L1_error)

  /* "vapor_vali/Simple_function.pyx":290
 *         return [0,0]
 * 
 * def calcu_vapor_single_read_score_abs_dis_m2(ref_seq,alt_seq,x,window_size):             # <<<<<<<<<<<<<<
 *     ref_dotdata=dotdata(window_size,x[0],ref_seq[x[1]:])
 *     alt_dotdata=dotdata(window_size,x[0],alt_seq[x[1]:])
 */
  __pyx_tuple__193 = PyTuple_Pack(10, __pyx_n_s_ref_seq, __pyx_n_s_alt_seq, __pyx_n_s_x, __pyx_n_s_window_size, __pyx_n_s_ref_dotdata, __pyx_n_s_alt_dotdata, __pyx_n_s_ref_clean_dotdata, __pyx_n_s_ref_kept_segs, __pyx_n_s_alt_clean_dotdata, __pyx_n_s_alt_kept_segs); if (unlikely(!__pyx_tuple__193)) __PYX_ERR(0, 290, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__193);
  __Pyx_GIVEREF(__pyx_tuple__193);
  __pyx_codeobj__194 = (PyObject*)__Pyx_PyCode_New(4, 0, 10, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__193, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_scratch_remills_flux_xuefzhao_a, __pyx_n_s_calcu_vapor_single_read_score_ab_3, 290, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__194)) __PYX_ERR(0, 290, __pyx_L1_error)

  /* "vapor_vali/Simple_function.pyx":303
 *         return [0,0]
 * 
 * def cigar2alignstart_by_pos(cigar,align_start,start,end):             # <<<<<<<<<<<<<<
 *     #eg cigar2alignstart(pbam[5],int(pbam[3]),bps)
 *     import re
 */
  __pyx_tuple__195 = PyTuple_Pack(15, __pyx_n_s_cigar, __pyx_n_s_align_start, __pyx_n_s_start, __pyx_n_s_end, __pyx_n_s_re, __pyx_n_s_pcigar, __pyx_n_s_cigars, __pyx_n_s_m, __pyx_n_s_read_rec, __pyx_n_s_align_rec, __pyx_n_s_cigar_record, __pyx_n_s_x, __pyx_n_s_start_dis, __pyx_n_s_new_read_rec, __pyx_n_s_new_start_dis); if (unlikely(!__pyx_tuple__195)) __PYX_ERR(0, 303, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__195);
  __Pyx_GIVEREF(__pyx_tuple__195);
  __pyx_codeobj__196 = (PyObject*)__Pyx_PyCode_New(4, 0, 15, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__195, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_scratch_remills_flux_xuefzhao_a, __pyx_n_s_cigar2alignstart_by_pos, 303, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__196)) __PYX_ERR(0, 303, __pyx_L1_error)

  /* "vapor_vali/Simple_function.pyx":333
 *         return [read_rec,start_dis]
 * 
 * def chop_pacbio_read_by_pos(bam_in_new,chrom,start,end,flank_length):             # <<<<<<<<<<<<<<
 *     fbam=os.popen(r'''samtools view %s %s:%d-%d'''%(bam_in_new,chrom,start,end))
 *     out=[]
 */
  __pyx_tuple__197 = PyTuple_Pack(13, __pyx_n_s_bam_in_new, __pyx_n_s_chrom, __pyx_n_s_start, __pyx_n_s_end, __pyx_n_s_flank_length, __pyx_n_s_fbam, __pyx_n_s_out, __pyx_n_s_line, __pyx_n_s_pbam, __pyx_n_s_align_info, __pyx_n_s_align_start, __pyx_n_s_miss_bp, __pyx_n_s_target_read); if (unlikely(!__pyx_tuple__197)) __PYX_ERR(0, 333, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__197);
  __Pyx_GIVEREF(__pyx_tuple__197);
  __pyx_codeobj__198 = (PyObject*)__Pyx_PyCode_New(5, 0, 13, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__197, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_scratch_remills_flux_xuefzhao_a, __pyx_n_s_chop_pacbio_read_by_pos, 333, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__198)) __PYX_ERR(0, 333, __pyx_L1_error)

  /* "vapor_vali/Simple_function.pyx":350
 *     return out
 * 
 * def chromos_readin(ref):             # <<<<<<<<<<<<<<
 *     fin=open(ref+'.fai')
 *     chromos=[]
 */
  __pyx_tuple__199 = PyTuple_Pack(5, __pyx_n_s_ref, __pyx_n_s_fin, __pyx_n_s_chromos, __pyx_n_s_line, __pyx_n_s_pin); if (unlikely(!__pyx_tuple__199)) __PYX_ERR(0, 350, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__199);
  __Pyx_GIVEREF(__pyx_tuple__199);
  __pyx_codeobj__200 = (PyObject*)__Pyx_PyCode_New(1, 0, 5, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__199, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_scratch_remills_flux_xuefzhao_a, __pyx_n_s_chromos_readin, 350, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__200)) __PYX_ERR(0, 350, __pyx_L1_error)

  /* "vapor_vali/Simple_function.pyx":359
 *     return chromos
 * 
 * def chr_start_end_extract(pin):             # <<<<<<<<<<<<<<
 *     out=[pin[0],int(pin[1])]
 *     for x in pin[7].split(';'):
 */
  __pyx_tuple__201 = PyTuple_Pack(3, __pyx_n_s_pin, __pyx_n_s_out, __pyx_n_s_x); if (unlikely(!__pyx_tuple__201)) __PYX_ERR(0, 359, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__201);
  __Pyx_GIVEREF(__pyx_tuple__201);
  __pyx_codeobj__202 = (PyObject*)__Pyx_PyCode_New(1, 0, 3, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__201, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_scratch_remills_flux_xuefzhao_a, __pyx_n_s_chr_start_end_extract, 359, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__202)) __PYX_ERR(0, 359, __pyx_L1_error)

  /* "vapor_vali/Simple_function.pyx":366
 *     return out
 * 
 * def cluster_range_decide(other_cluster):             # <<<<<<<<<<<<<<
 *     out=[]
 *     for x in other_cluster:
 */
  __pyx_tuple__203 = PyTuple_Pack(3, __pyx_n_s_other_cluster, __pyx_n_s_out, __pyx_n_s_x); if (unlikely(!__pyx_tuple__203)) __PYX_ERR(0, 366, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__203);
  __Pyx_GIVEREF(__pyx_tuple__203);
  __pyx_codeobj__204 = (PyObject*)__Pyx_PyCode_New(1, 0, 3, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__203, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_scratch_remills_flux_xuefzhao_a, __pyx_n_s_cluster_range_decide, 366, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__204)) __PYX_ERR(0, 366, __pyx_L1_error)

  /* "vapor_vali/Simple_function.pyx":374
 *     return out
 * 
 * def cluster_size_decide(range_cluster):             # <<<<<<<<<<<<<<
 *     out=[]
 *     for x in range_cluster:
 */
  __pyx_tuple__205 = PyTuple_Pack(4, __pyx_n_s_range_cluster, __pyx_n_s_out, __pyx_n_s_x, __pyx_n_s_size); if (unlikely(!__pyx_tuple__205)) __PYX_ERR(0, 374, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__205);
  __Pyx_GIVEREF(__pyx_tuple__205);
  __pyx_codeobj__206 = (PyObject*)__Pyx_PyCode_New(1, 0, 4, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__205, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_scratch_remills_flux_xuefzhao_a, __pyx_n_s_cluster_size_decide, 374, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__206)) __PYX_ERR(0, 374, __pyx_L1_error)

  /* "vapor_vali/Simple_function.pyx":381
 *     return out
 * 
 * def clean_dotdata_m1(ref_dotdata):             # <<<<<<<<<<<<<<
 *     #cluster dots based on their distance to diagnal
 *     x_axis=[i[0] for i in ref_dotdata]
 */
  __pyx_tuple__207 = PyTuple_Pack(13, __pyx_n_s_ref_dotdata, __pyx_n_s_x_axis, __pyx_n_s_y_axis, __pyx_n_s_dis_to_diagnal, __pyx_n_s_kept_dot_pos, __pyx_n_s_kept_dot, __pyx_n_s_x, __pyx_n_s_temp, __pyx_n_s_kept_dot_cluster, __pyx_n_s_y, __pyx_n_s_kept_region, __pyx_n_s_out, __pyx_n_s_i); if (unlikely(!__pyx_tuple__207)) __PYX_ERR(0, 381, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__207);
  __Pyx_GIVEREF(__pyx_tuple__207);
  __pyx_codeobj__208 = (PyObject*)__Pyx_PyCode_New(1, 0, 13, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__207, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_scratch_remills_flux_xuefzhao_a, __pyx_n_s_clean_dotdata_m1, 381, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__208)) __PYX_ERR(0, 381, __pyx_L1_error)

  /* "vapor_vali/Simple_function.pyx":398
 *     return [out,kept_region]
 * 
 * def clean_dotdata_diagnal_m1b(ref_dotdata):             # <<<<<<<<<<<<<<
 *     #cluster dots based on their distance to diagnal
 *     if ref_dotdata==[]:    return [[],[]]
 */
  __pyx_tuple__209 = PyTuple_Pack(10, __pyx_n_s_ref_dotdata, __pyx_n_s_x_axis, __pyx_n_s_y_axis, __pyx_n_s_dis_to_diagnal, __pyx_n_s_kept_dot_pos, __pyx_n_s_kept_dot, __pyx_n_s_x, __pyx_n_s_temp, __pyx_n_s_kept_region, __pyx_n_s_i); if (unlikely(!__pyx_tuple__209)) __PYX_ERR(0, 398, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__209);
  __Pyx_GIVEREF(__pyx_tuple__209);
  __pyx_codeobj__210 = (PyObject*)__Pyx_PyCode_New(1, 0, 10, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__209, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_scratch_remills_flux_xuefzhao_a, __pyx_n_s_clean_dotdata_diagnal_m1b, 398, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__210)) __PYX_ERR(0, 398, __pyx_L1_error)

  /* "vapor_vali/Simple_function.pyx":412
 *     return [kept_dot,kept_region]
 * 
 * def clean_dotdata_anti_diagnal_m1b(ref_dotdata):             # <<<<<<<<<<<<<<
 *     #cluster dots based on their distance to diagnal
 *     if ref_dotdata==[]:    return [[],[]]
 */
  __pyx_tuple__211 = PyTuple_Pack(10, __pyx_n_s_ref_dotdata, __pyx_n_s_x_axis, __pyx_n_s_y_axis, __pyx_n_s_dis_to_diagnal, __pyx_n_s_kept_dot_pos, __pyx_n_s_kept_dot, __pyx_n_s_x, __pyx_n_s_temp, __pyx_n_s_kept_region, __pyx_n_s_i); if (unlikely(!__pyx_tuple__211)) __PYX_ERR(0, 412, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__211);
  __Pyx_GIVEREF(__pyx_tuple__211);
  __pyx_codeobj__212 = (PyObject*)__Pyx_PyCode_New(1, 0, 10, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__211, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_scratch_remills_flux_xuefzhao_a, __pyx_n_s_clean_dotdata_anti_diagnal_m1b, 412, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__212)) __PYX_ERR(0, 412, __pyx_L1_error)

  /* "vapor_vali/Simple_function.pyx":426
 *     return [kept_dot,kept_region]
 * 
 * def clean_dotdata_diagnal_and_anti_diagnal(ref_dotdata):             # <<<<<<<<<<<<<<
 *     if ref_dotdata==[]:    return [[],[]]
 *     x_axis=[i[0] for i in ref_dotdata]
 */
  __pyx_tuple__213 = PyTuple_Pack(13, __pyx_n_s_ref_dotdata, __pyx_n_s_x_axis, __pyx_n_s_y_axis, __pyx_n_s_dis_to_diagnal, __pyx_n_s_dis_to_anti_diagnal, __pyx_n_s_kept_dot_diag, __pyx_n_s_removed_dot_diag, __pyx_n_s_kept_dot_anti_diag, __pyx_n_s_removed_dot_anti_diag, __pyx_n_s_rec, __pyx_n_s_kept_dot, __pyx_n_s_x, __pyx_n_s_i); if (unlikely(!__pyx_tuple__213)) __PYX_ERR(0, 426, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__213);
  __Pyx_GIVEREF(__pyx_tuple__213);
  __pyx_codeobj__214 = (PyObject*)__Pyx_PyCode_New(1, 0, 13, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__213, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_scratch_remills_flux_xuefzhao_a, __pyx_n_s_clean_dotdata_diagnal_and_anti_d, 426, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__214)) __PYX_ERR(0, 426, __pyx_L1_error)

  /* "vapor_vali/Simple_function.pyx":444
 *     return kept_dot
 * 
 * def clean_dotdata_x_and_y(list_dotdata):             # <<<<<<<<<<<<<<
 *     [kept_dot_x,removed_dot_x]=dis_cluster_2([i[0] for i in list_dotdata],dis_cff=10)
 *     kept_list=[]
 */
  __pyx_tuple__215 = PyTuple_Pack(9, __pyx_n_s_list_dotdata, __pyx_n_s_kept_dot_x, __pyx_n_s_removed_dot_x, __pyx_n_s_kept_list, __pyx_n_s_i, __pyx_n_s_kept_dot_y, __pyx_n_s_removed_dot_y, __pyx_n_s_out_list, __pyx_n_s_j); if (unlikely(!__pyx_tuple__215)) __PYX_ERR(0, 444, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__215);
  __Pyx_GIVEREF(__pyx_tuple__215);
  __pyx_codeobj__216 = (PyObject*)__Pyx_PyCode_New(1, 0, 9, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__215, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_scratch_remills_flux_xuefzhao_a, __pyx_n_s_clean_dotdata_x_and_y, 444, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__216)) __PYX_ERR(0, 444, __pyx_L1_error)

  /* "vapor_vali/Simple_function.pyx":455
 *     return out_list
 * 
 * def clean_dotdata_m2(ref_dotdata):             # <<<<<<<<<<<<<<
 *     #keep dots closest to diagnal
 *     data_hash={}
 */
  __pyx_tuple__217 = PyTuple_Pack(5, __pyx_n_s_ref_dotdata, __pyx_n_s_data_hash, __pyx_n_s_x, __pyx_n_s_out, __pyx_n_s_i); if (unlikely(!__pyx_tuple__217)) __PYX_ERR(0, 455, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__217);
  __Pyx_GIVEREF(__pyx_tuple__217);
  __pyx_codeobj__218 = (PyObject*)__Pyx_PyCode_New(1, 0, 5, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__217, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_scratch_remills_flux_xuefzhao_a, __pyx_n_s_clean_dotdata_m2, 455, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__218)) __PYX_ERR(0, 455, __pyx_L1_error)

  /* "vapor_vali/Simple_function.pyx":465
 *     return out
 * 
 * def complementary(seq):             # <<<<<<<<<<<<<<
 *     seq2=[]
 *     for i in seq:
 */
  __pyx_tuple__219 = PyTuple_Pack(3, __pyx_n_s_seq, __pyx_n_s_seq2, __pyx_n_s_i); if (unlikely(!__pyx_tuple__219)) __PYX_ERR(0, 465, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__219);
  __Pyx_GIVEREF(__pyx_tuple__219);
  __pyx_codeobj__220 = (PyObject*)__Pyx_PyCode_New(1, 0, 3, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__219, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_scratch_remills_flux_xuefzhao_a, __pyx_n_s_complementary, 465, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__220)) __PYX_ERR(0, 465, __pyx_L1_error)

  /* "vapor_vali/Simple_function.pyx":474
 *     return ''.join(seq2)
 * 
 * def compute_bic(kmeans,X):             # <<<<<<<<<<<<<<
 *     """
 *     Computes the BIC metric for a given clusters
 */
  __pyx_tuple__221 = PyTuple_Pack(12, __pyx_n_s_kmeans, __pyx_n_s_X, __pyx_n_s_centers, __pyx_n_s_labels_2, __pyx_n_s_m, __pyx_n_s_n, __pyx_n_s_N, __pyx_n_s_d, __pyx_n_s_cl_var, __pyx_n_s_i, __pyx_n_s_const_term, __pyx_n_s_BIC); if (unlikely(!__pyx_tuple__221)) __PYX_ERR(0, 474, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__221);
  __Pyx_GIVEREF(__pyx_tuple__221);
  __pyx_codeobj__222 = (PyObject*)__Pyx_PyCode_New(2, 0, 12, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__221, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_scratch_remills_flux_xuefzhao_a, __pyx_n_s_compute_bic, 474, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__222)) __PYX_ERR(0, 474, __pyx_L1_error)

  /* "vapor_vali/Simple_function.pyx":509
 *     return(BIC)
 * 
 * def dup_inv_ref_alt_bps_produce(sv_info,flank_length,alt_structure):             # <<<<<<<<<<<<<<
 *     bp_info=sorted(sv_info[1:3]+[sv_info[4]])
 *     block_len=bp_to_block_len([sv_info[0]]+bp_info)
 */
  __pyx_tuple__223 = PyTuple_Pack(8, __pyx_n_s_sv_info, __pyx_n_s_flank_length, __pyx_n_s_alt_structure, __pyx_n_s_bp_info, __pyx_n_s_block_len, __pyx_n_s_ref_bps, __pyx_n_s_alt_bps, __pyx_n_s_let_single); if (unlikely(!__pyx_tuple__223)) __PYX_ERR(0, 509, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__223);
  __Pyx_GIVEREF(__pyx_tuple__223);
  __pyx_codeobj__224 = (PyObject*)__Pyx_PyCode_New(3, 0, 8, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__223, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_scratch_remills_flux_xuefzhao_a, __pyx_n_s_dup_inv_ref_alt_bps_produce, 509, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__224)) __PYX_ERR(0, 509, __pyx_L1_error)

  /* "vapor_vali/Simple_function.pyx":519
 *     return [ref_bps,alt_bps]
 * 
 * def dup_inv_dup_bps_produce(sv_info,flank_length,alt_structure):             # <<<<<<<<<<<<<<
 *     [ref_bps,alt_bps]=dup_inv_ref_alt_bps_produce(sv_info,flank_length,alt_structure)
 *     alt_bps_new=[i-alt_bps[0] for i in alt_bps]
 */
  __pyx_tuple__225 = PyTuple_Pack(7, __pyx_n_s_sv_info, __pyx_n_s_flank_length, __pyx_n_s_alt_structure, __pyx_n_s_ref_bps, __pyx_n_s_alt_bps, __pyx_n_s_alt_bps_new, __pyx_n_s_i); if (unlikely(!__pyx_tuple__225)) __PYX_ERR(0, 519, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__225);
  __Pyx_GIVEREF(__pyx_tuple__225);
  __pyx_codeobj__226 = (PyObject*)__Pyx_PyCode_New(3, 0, 7, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__225, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_scratch_remills_flux_xuefzhao_a, __pyx_n_s_dup_inv_dup_bps_produce, 519, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__226)) __PYX_ERR(0, 519, __pyx_L1_error)

  /* "vapor_vali/Simple_function.pyx":527
 *         return [alt_bps_new[1:3],alt_bps_new[3:5]]
 * 
 * def dotdata(kmerlen,seq1, seq2):             # <<<<<<<<<<<<<<
 *     nth_base = 1
 *     inversions = True
 */
  __pyx_tuple__227 = PyTuple_Pack(6, __pyx_n_s_kmerlen, __pyx_n_s_seq1, __pyx_n_s_seq2, __pyx_n_s_nth_base, __pyx_n_s_inversions, __pyx_n_s_hits); if (unlikely(!__pyx_tuple__227)) __PYX_ERR(0, 527, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__227);
  __Pyx_GIVEREF(__pyx_tuple__227);
  __pyx_codeobj__228 = (PyObject*)__Pyx_PyCode_New(3, 0, 6, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__227, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_scratch_remills_flux_xuefzhao_a, __pyx_n_s_dotdata, 527, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__228)) __PYX_ERR(0, 527, __pyx_L1_error)

  /* "vapor_vali/Simple_function.pyx":533
 *     return hits
 * 
 * def dis_cluster(dis_to_diagnal,dis_cff=10):             # <<<<<<<<<<<<<<
 *     #eg of dis_list=[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 683, 854, 0, 683, 854, 0, 683, 854, 0, 683, 854, 0, 683, 0, 683, 0, 683, 0, 683, 0, 341, 512, 683, 0, 341, 512, 683, 0, 341, 512, 683, 0, 341, 512, 683, 1025, 0, 341, 512, 683, 1025, 0, 170, 341, 512, 683, 1025, 0, 170, 341, 683, 854, 1025, 0, 170, 683, 854, 1025, 0, 683, 1025, 0, 0, 0, 0, 0, 0, 0, 0, 512, 0, 512, 0, 512, 1196, 0, 170, 341, 512, 854, 1196, 1367, 0, 170, 341, 512, 854, 1196, 1367, 0]
 *     sorted_list=sorted(dis_to_diagnal)
 */
  __pyx_tuple__229 = PyTuple_Pack(8, __pyx_n_s_dis_to_diagnal, __pyx_n_s_dis_cff, __pyx_n_s_sorted_list, __pyx_n_s_sub_group1, __pyx_n_s_i, __pyx_n_s_remove_noise_1, __pyx_n_s_lenght_list, __pyx_n_s_j); if (unlikely(!__pyx_tuple__229)) __PYX_ERR(0, 533, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__229);
  __Pyx_GIVEREF(__pyx_tuple__229);
  __pyx_codeobj__230 = (PyObject*)__Pyx_PyCode_New(2, 0, 8, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__229, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_scratch_remills_flux_xuefzhao_a, __pyx_n_s_dis_cluster, 533, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__230)) __PYX_ERR(0, 533, __pyx_L1_error)

  /* "vapor_vali/Simple_function.pyx":548
 *     return [[i for i in range(len(dis_to_diagnal)) if dis_to_diagnal[i] in j] for j in remove_noise_1]
 * 
 * def dis_cluster_2(dis_to_diagnal,dis_cff=10):             # <<<<<<<<<<<<<<
 *     #eg of dis_list=[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 683, 854, 0, 683, 854, 0, 683, 854, 0, 683, 854, 0, 683, 0, 683, 0, 683, 0, 683, 0, 341, 512, 683, 0, 341, 512, 683, 0, 341, 512, 683, 0, 341, 512, 683, 1025, 0, 341, 512, 683, 1025, 0, 170, 341, 512, 683, 1025, 0, 170, 341, 683, 854, 1025, 0, 170, 683, 854, 1025, 0, 683, 1025, 0, 0, 0, 0, 0, 0, 0, 0, 512, 0, 512, 0, 512, 1196, 0, 170, 341, 512, 854, 1196, 1367, 0, 170, 341, 512, 854, 1196, 1367, 0]
 *     sorted_list=sorted(dis_to_diagnal)
 */
  __pyx_tuple__231 = PyTuple_Pack(10, __pyx_n_s_dis_to_diagnal, __pyx_n_s_dis_cff, __pyx_n_s_sorted_list, __pyx_n_s_sub_group1, __pyx_n_s_i, __pyx_n_s_remove_noise_1, __pyx_n_s_out1, __pyx_n_s_out_total, __pyx_n_s_out2, __pyx_n_s_j); if (unlikely(!__pyx_tuple__231)) __PYX_ERR(0, 548, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__231);
  __Pyx_GIVEREF(__pyx_tuple__231);
  __pyx_codeobj__232 = (PyObject*)__Pyx_PyCode_New(2, 0, 10, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__231, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_scratch_remills_flux_xuefzhao_a, __pyx_n_s_dis_cluster_2, 548, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__232)) __PYX_ERR(0, 548, __pyx_L1_error)

  /* "vapor_vali/Simple_function.pyx":564
 *     return [out1,out2]
 * 
 * def dis_to_diagnal_most_abundant_defined(alt_clean_dotdata):             # <<<<<<<<<<<<<<
 *     dis_to_diagnal_list=[i[1]-i[0] for i in alt_clean_dotdata]
 *     dis_range=[min(dis_to_diagnal_list)+i*float(max(dis_to_diagnal_list)-min(dis_to_diagnal_list))/10.0 for i in range(11)]
 */
  __pyx_tuple__233 = PyTuple_Pack(8, __pyx_n_s_alt_clean_dotdata, __pyx_n_s_dis_to_diagnal_list, __pyx_n_s_dis_range, __pyx_n_s_kept_list1, __pyx_n_s_kept_list2, __pyx_n_s_km, __pyx_n_s_j, __pyx_n_s_i); if (unlikely(!__pyx_tuple__233)) __PYX_ERR(0, 564, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__233);
  __Pyx_GIVEREF(__pyx_tuple__233);
  __pyx_codeobj__234 = (PyObject*)__Pyx_PyCode_New(1, 0, 8, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__233, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_scratch_remills_flux_xuefzhao_a, __pyx_n_s_dis_to_diagnal_most_abundant_def, 564, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__234)) __PYX_ERR(0, 564, __pyx_L1_error)

  /* "vapor_vali/Simple_function.pyx":575
 *     else:                   return 0
 * 
 * def dot_to_line(list_dotdata,gap=50,length=10):             # <<<<<<<<<<<<<<
 *     ####This function try to recognize lines in the dot plot
 *     dis_to_diagnal=[i[1]-i[0] for i in list_dotdata]
 */
  __pyx_tuple__235 = PyTuple_Pack(13, __pyx_n_s_list_dotdata, __pyx_n_s_gap, __pyx_n_s_length, __pyx_n_s_dis_to_diagnal, __pyx_n_s_cluster1, __pyx_n_s_dot_cluster1, __pyx_n_s_dis_to_anti_diagnal, __pyx_n_s_cluster2, __pyx_n_s_dot_cluster2, __pyx_n_s_out, __pyx_n_s_i, __pyx_n_s_j, __pyx_n_s_k); if (unlikely(!__pyx_tuple__235)) __PYX_ERR(0, 575, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__235);
  __Pyx_GIVEREF(__pyx_tuple__235);
  __pyx_codeobj__236 = (PyObject*)__Pyx_PyCode_New(3, 0, 13, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__235, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_scratch_remills_flux_xuefzhao_a, __pyx_n_s_dot_to_line, 575, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__236)) __PYX_ERR(0, 575, __pyx_L1_error)

  /* "vapor_vali/Simple_function.pyx":588
 *     return [[i[0],i[-1]] for i in out]
 * 
 * def dup_block_combine(dup_block,k1_hap,k2_hap):             # <<<<<<<<<<<<<<
 *     #eg of dup_block=['a', 'b'];     k1_hap='abcd'   ; k2_hap='abab'
 *     all_combines=[]
 */
  __pyx_tuple__237 = PyTuple_Pack(7, __pyx_n_s_dup_block, __pyx_n_s_k1_hap, __pyx_n_s_k2_hap, __pyx_n_s_all_combines, __pyx_n_s_x, __pyx_n_s_kept_dup, __pyx_n_s_i); if (unlikely(!__pyx_tuple__237)) __PYX_ERR(0, 588, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__237);
  __Pyx_GIVEREF(__pyx_tuple__237);
  __pyx_codeobj__238 = (PyObject*)__Pyx_PyCode_New(3, 0, 7, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__237, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_scratch_remills_flux_xuefzhao_a, __pyx_n_s_dup_block_combine, 588, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__238)) __PYX_ERR(0, 588, __pyx_L1_error)

  /* "vapor_vali/Simple_function.pyx":600
 *     return dup_block_kept_qc(kept_dup)[::-1]
 * 
 * def dup_block_combined_qc(all_combines):             # <<<<<<<<<<<<<<
 *     #eg of all_combines=['a', 'b', 'c', 'd', 'ab', 'ac', 'ad', 'bc', 'bd', 'cd', 'abc', 'abd', 'acd', 'bcd', 'abcd']
 *     out=[]
 */
  __pyx_tuple__239 = PyTuple_Pack(5, __pyx_n_s_all_combines, __pyx_n_s_out, __pyx_n_s_x, __pyx_n_s_temp, __pyx_n_s_i); if (unlikely(!__pyx_tuple__239)) __PYX_ERR(0, 600, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__239);
  __Pyx_GIVEREF(__pyx_tuple__239);
  __pyx_codeobj__240 = (PyObject*)__Pyx_PyCode_New(1, 0, 5, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__239, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_scratch_remills_flux_xuefzhao_a, __pyx_n_s_dup_block_combined_qc, 600, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__240)) __PYX_ERR(0, 600, __pyx_L1_error)

  /* "vapor_vali/Simple_function.pyx":611
 *     return out
 * 
 * def dup_block_kept_qc(kept_dup):             # <<<<<<<<<<<<<<
 *     #eg of kept_dup:
 *     out=[]
 */
  __pyx_tuple__241 = PyTuple_Pack(5, __pyx_n_s_kept_dup, __pyx_n_s_out, __pyx_n_s_y, __pyx_n_s_flag_y, __pyx_n_s_z); if (unlikely(!__pyx_tuple__241)) __PYX_ERR(0, 611, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__241);
  __Pyx_GIVEREF(__pyx_tuple__241);
  __pyx_codeobj__242 = (PyObject*)__Pyx_PyCode_New(1, 0, 5, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__241, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_scratch_remills_flux_xuefzhao_a, __pyx_n_s_dup_block_kept_qc, 611, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__242)) __PYX_ERR(0, 611, __pyx_L1_error)

  /* "vapor_vali/Simple_function.pyx":623
 *     return out
 * 
 * def dup_let_recombind(vec_in):             # <<<<<<<<<<<<<<
 *     if vec_in==[]:
 *         return []
 */
  __pyx_tuple__243 = PyTuple_Pack(10, __pyx_n_s_vec_in, __pyx_n_s_vec2, __pyx_n_s_vec, __pyx_n_s_ka, __pyx_n_s_vec3, __pyx_n_s_kb, __pyx_n_s_kc, __pyx_n_s_kd, __pyx_n_s_vec4, __pyx_n_s_i); if (unlikely(!__pyx_tuple__243)) __PYX_ERR(0, 623, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__243);
  __Pyx_GIVEREF(__pyx_tuple__243);
  __pyx_codeobj__244 = (PyObject*)__Pyx_PyCode_New(1, 0, 10, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__243, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_scratch_remills_flux_xuefzhao_a, __pyx_n_s_dup_let_recombind, 623, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__244)) __PYX_ERR(0, 623, __pyx_L1_error)

  /* "vapor_vali/Simple_function.pyx":647
 *         return vec4
 * 
 * def editDistance(seq1,seq2,cost_matrix,move_matrix,r,c):             # <<<<<<<<<<<<<<
 *     [iCost, dCost , mCost]=[1,1,1]
 *     if cost_matrix[r][c]==float('inf'):
 */
  __pyx_tuple__245 = PyTuple_Pack(12, __pyx_n_s_seq1, __pyx_n_s_seq2, __pyx_n_s_cost_matrix, __pyx_n_s_move_matrix, __pyx_n_s_r, __pyx_n_s_c, __pyx_n_s_iCost, __pyx_n_s_dCost, __pyx_n_s_mCost, __pyx_n_s_iDist, __pyx_n_s_dDist, __pyx_n_s_mDist); if (unlikely(!__pyx_tuple__245)) __PYX_ERR(0, 647, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__245);
  __Pyx_GIVEREF(__pyx_tuple__245);
  __pyx_codeobj__246 = (PyObject*)__Pyx_PyCode_New(6, 0, 12, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__245, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_scratch_remills_flux_xuefzhao_a, __pyx_n_s_editDistance, 647, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__246)) __PYX_ERR(0, 647, __pyx_L1_error)

  /* "vapor_vali/Simple_function.pyx":681
 *     return cost_matrix[r][c]
 * 
 * def edit_dis_setup(seq1,seq2):             # <<<<<<<<<<<<<<
 *     cost_matrix=np.full((len(seq1)+1,len(seq2)+1),np.inf)
 *     move_matrix=np.full((len(seq1)+1,len(seq2)+1),-1.0)
 */
  __pyx_tuple__247 = PyTuple_Pack(5, __pyx_n_s_seq1, __pyx_n_s_seq2, __pyx_n_s_cost_matrix, __pyx_n_s_move_matrix, __pyx_n_s_opt_dist); if (unlikely(!__pyx_tuple__247)) __PYX_ERR(0, 681, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__247);
  __Pyx_GIVEREF(__pyx_tuple__247);
  __pyx_codeobj__248 = (PyObject*)__Pyx_PyCode_New(2, 0, 5, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__247, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_scratch_remills_flux_xuefzhao_a, __pyx_n_s_edit_dis_setup, 681, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__248)) __PYX_ERR(0, 681, __pyx_L1_error)

  /* "vapor_vali/Simple_function.pyx":687
 *     return opt_dist
 * 
 * def eu_dis_abs_calcu(ref_clean_dotdata):             # <<<<<<<<<<<<<<
 *     #eg of ref_clean_dotdata=[[2380, 471], [2381, 472], [2382, 472], [2383, 472], [2384, 472], [2385, 472], [2386, 472], [2387, 472], [2388, 472], [2389, 473], [2390, 474], [2391, 475], [2402, 486], [2403, 487], [2404, 488], [2405, 489], [2406, 490], [2407, 491], [2408, 492], [2409, 493], [2410, 494], [2411, 495], [2418, 504], [2440, 528], [2441, 529], [2442, 530], [2443, 531], [2454, 542], [2455, 543], [2456, 544], [2473, 563], [2474, 564], [2475, 565], [2476, 566], [2477, 567], [2478, 568], [2479, 569], [2480, 570], [2481, 571], [2482, 572], [2483, 573], [2484, 574], [2485, 575], [2486, 576], [2487, 577], [2488, 578], [2489, 579], [2490, 580], [2500, 589], [2501, 590], [2502, 591], [2503, 592], [2504, 593], [2523, 613], [2524, 614], [2525, 615], [2526, 616], [2527, 617], [2528, 618], [2529, 619], [2530, 620], [2531, 621], [2532, 622], [2533, 623], [2557, 642], [2558, 643], [2559, 644], [2560, 645], [2561, 646], [2562, 647]]
 *     eu_dis_abs=[abs(i[0]-i[1]) for i in ref_clean_dotdata]
 */
  __pyx_tuple__249 = PyTuple_Pack(3, __pyx_n_s_ref_clean_dotdata, __pyx_n_s_eu_dis_abs, __pyx_n_s_i); if (unlikely(!__pyx_tuple__249)) __PYX_ERR(0, 687, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__249);
  __Pyx_GIVEREF(__pyx_tuple__249);
  __pyx_codeobj__250 = (PyObject*)__Pyx_PyCode_New(1, 0, 3, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__249, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_scratch_remills_flux_xuefzhao_a, __pyx_n_s_eu_dis_abs_calcu, 687, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__250)) __PYX_ERR(0, 687, __pyx_L1_error)

  /* "vapor_vali/Simple_function.pyx":692
 *     return np.mean(eu_dis_abs)
 * 
 * def eu_dis_single_dot(dot_pos):             # <<<<<<<<<<<<<<
 *     #############################################
 *     ####eg of dot_pos=(1212, 1217)
 */
  __pyx_tuple__251 = PyTuple_Pack(1, __pyx_n_s_dot_pos); if (unlikely(!__pyx_tuple__251)) __PYX_ERR(0, 692, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__251);
  __Pyx_GIVEREF(__pyx_tuple__251);
  __pyx_codeobj__252 = (PyObject*)__Pyx_PyCode_New(1, 0, 1, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__251, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_scratch_remills_flux_xuefzhao_a, __pyx_n_s_eu_dis_single_dot, 692, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__252)) __PYX_ERR(0, 692, __pyx_L1_error)

  /* "vapor_vali/Simple_function.pyx":700
 *     else:               return abs(float(dot_pos[0]-dot_pos[1])/float(dot_pos[0]))
 * 
 * def eu_dis_dir_calcu(list_dotdata):             # <<<<<<<<<<<<<<
 *     #eg of list_dotdata=[[2380, 471], [2381, 472], [2382, 472], [2383, 472], [2384, 472], [2385, 472], [2386, 472], [2387, 472], [2388, 472], [2389, 473], [2390, 474], [2391, 475], [2402, 486], [2403, 487], [2404, 488], [2405, 489], [2406, 490], [2407, 491], [2408, 492], [2409, 493], [2410, 494], [2411, 495], [2418, 504], [2440, 528], [2441, 529], [2442, 530], [2443, 531], [2454, 542], [2455, 543], [2456, 544], [2473, 563], [2474, 564], [2475, 565], [2476, 566], [2477, 567], [2478, 568], [2479, 569], [2480, 570], [2481, 571], [2482, 572], [2483, 573], [2484, 574], [2485, 575], [2486, 576], [2487, 577], [2488, 578], [2489, 579], [2490, 580], [2500, 589], [2501, 590], [2502, 591], [2503, 592], [2504, 593], [2523, 613], [2524, 614], [2525, 615], [2526, 616], [2527, 617], [2528, 618], [2529, 619], [2530, 620], [2531, 621], [2532, 622], [2533, 623], [2557, 642], [2558, 643], [2559, 644], [2560, 645], [2561, 646], [2562, 647]]
 *     eu_dis_abs=[i[0]-i[1] for i in list_dotdata if eu_dis_single_dot(i)>0.1]
 */
  __pyx_tuple__253 = PyTuple_Pack(3, __pyx_n_s_list_dotdata, __pyx_n_s_eu_dis_abs, __pyx_n_s_i); if (unlikely(!__pyx_tuple__253)) __PYX_ERR(0, 700, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__253);
  __Pyx_GIVEREF(__pyx_tuple__253);
  __pyx_codeobj__254 = (PyObject*)__Pyx_PyCode_New(1, 0, 3, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__253, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_scratch_remills_flux_xuefzhao_a, __pyx_n_s_eu_dis_dir_calcu, 700, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__254)) __PYX_ERR(0, 700, __pyx_L1_error)

  /* "vapor_vali/Simple_function.pyx":706
 *     else:               return np.mean(eu_dis_abs)
 * 
 * def eu_dis_reg_calcu(list_dotdata):             # <<<<<<<<<<<<<<
 *     ratio_new=eu_y_vs_x_ratio_calcu(list_dotdata)
 *     eu_dis_abs=[ratio_new*i[0]-i[1] for i in list_dotdata if eu_dis_single_dot([ratio_new*i[0],i[1]])>0.15]
 */
  __pyx_tuple__255 = PyTuple_Pack(4, __pyx_n_s_list_dotdata, __pyx_n_s_ratio_new, __pyx_n_s_eu_dis_abs, __pyx_n_s_i); if (unlikely(!__pyx_tuple__255)) __PYX_ERR(0, 706, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__255);
  __Pyx_GIVEREF(__pyx_tuple__255);
  __pyx_codeobj__256 = (PyObject*)__Pyx_PyCode_New(1, 0, 4, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__255, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_scratch_remills_flux_xuefzhao_a, __pyx_n_s_eu_dis_reg_calcu, 706, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__256)) __PYX_ERR(0, 706, __pyx_L1_error)

  /* "vapor_vali/Simple_function.pyx":712
 *     else:               return abs(np.mean(eu_dis_abs))
 * 
 * def eu_dis_dots_within_10perc(ref_clean_dotdata):             # <<<<<<<<<<<<<<
 *     #eg of ref_clean_dotdata=[[2380, 471], [2381, 472], [2382, 472], [2383, 472], [2384, 472], [2385, 472], [2386, 472], [2387, 472], [2388, 472], [2389, 473], [2390, 474], [2391, 475], [2402, 486], [2403, 487], [2404, 488], [2405, 489], [2406, 490], [2407, 491], [2408, 492], [2409, 493], [2410, 494], [2411, 495], [2418, 504], [2440, 528], [2441, 529], [2442, 530], [2443, 531], [2454, 542], [2455, 543], [2456, 544], [2473, 563], [2474, 564], [2475, 565], [2476, 566], [2477, 567], [2478, 568], [2479, 569], [2480, 570], [2481, 571], [2482, 572], [2483, 573], [2484, 574], [2485, 575], [2486, 576], [2487, 577], [2488, 578], [2489, 579], [2490, 580], [2500, 589], [2501, 590], [2502, 591], [2503, 592], [2504, 593], [2523, 613], [2524, 614], [2525, 615], [2526, 616], [2527, 617], [2528, 618], [2529, 619], [2530, 620], [2531, 621], [2532, 622], [2533, 623], [2557, 642], [2558, 643], [2559, 644], [2560, 645], [2561, 646], [2562, 647]]
 *     dis_10perc=[abs(float(i[0]-i[1])/float(i[0])) for i in ref_clean_dotdata if i[0]>0]
 */
  __pyx_tuple__257 = PyTuple_Pack(3, __pyx_n_s_ref_clean_dotdata, __pyx_n_s_dis_10perc, __pyx_n_s_i); if (unlikely(!__pyx_tuple__257)) __PYX_ERR(0, 712, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__257);
  __Pyx_GIVEREF(__pyx_tuple__257);
  __pyx_codeobj__258 = (PyObject*)__Pyx_PyCode_New(1, 0, 3, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__257, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_scratch_remills_flux_xuefzhao_a, __pyx_n_s_eu_dis_dots_within_10perc, 712, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__258)) __PYX_ERR(0, 712, __pyx_L1_error)

  /* "vapor_vali/Simple_function.pyx":717
 *     return len([i for i in dis_10perc if i <0.16])
 * 
 * def eu_dis_region_calcu(list_dotdata,list_bps):             # <<<<<<<<<<<<<<
 *     #eg of list_bps=[127906399, 127906515, 127907283, 127907399, 127907515]
 *     ref_bps_new=[i-list_bps[0] for i in list_bps]
 */
  __pyx_tuple__259 = PyTuple_Pack(9, __pyx_n_s_list_dotdata, __pyx_n_s_list_bps, __pyx_n_s_ref_bps_new, __pyx_n_s_ref_region, __pyx_n_s_reca, __pyx_n_s_recb, __pyx_n_s_out, __pyx_n_s_out_new, __pyx_n_s_i); if (unlikely(!__pyx_tuple__259)) __PYX_ERR(0, 717, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__259);
  __Pyx_GIVEREF(__pyx_tuple__259);
  __pyx_codeobj__260 = (PyObject*)__Pyx_PyCode_New(2, 0, 9, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__259, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_scratch_remills_flux_xuefzhao_a, __pyx_n_s_eu_dis_region_calcu, 717, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__260)) __PYX_ERR(0, 717, __pyx_L1_error)

  /* "vapor_vali/Simple_function.pyx":738
 *     else:               return np.mean(out_new)
 * 
 * def eu_dis_reg_dup_block_calcu(list_dotdata,dup_block_bps):             # <<<<<<<<<<<<<<
 *     ref_region=[[] for i in range(len(dup_block_bps)+1)]
 *     for x in list_dotdata:
 */
  __pyx_tuple__261 = PyTuple_Pack(7, __pyx_n_s_list_dotdata, __pyx_n_s_dup_block_bps, __pyx_n_s_ref_region, __pyx_n_s_x, __pyx_n_s_out, __pyx_n_s_out_new, __pyx_n_s_i); if (unlikely(!__pyx_tuple__261)) __PYX_ERR(0, 738, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__261);
  __Pyx_GIVEREF(__pyx_tuple__261);
  __pyx_codeobj__262 = (PyObject*)__Pyx_PyCode_New(2, 0, 7, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__261, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_scratch_remills_flux_xuefzhao_a, __pyx_n_s_eu_dis_reg_dup_block_calcu, 738, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__262)) __PYX_ERR(0, 738, __pyx_L1_error)

  /* "vapor_vali/Simple_function.pyx":750
 *     else:               return np.mean(out_new)
 * 
 * def eu_y_vs_x_ratio_single_dot(dot_pos):             # <<<<<<<<<<<<<<
 *     #############################################
 *     ####eg of dot_pos=(1212, 1217)
 */
  __pyx_tuple__263 = PyTuple_Pack(1, __pyx_n_s_dot_pos); if (unlikely(!__pyx_tuple__263)) __PYX_ERR(0, 750, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__263);
  __Pyx_GIVEREF(__pyx_tuple__263);
  __pyx_codeobj__264 = (PyObject*)__Pyx_PyCode_New(1, 0, 1, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__263, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_scratch_remills_flux_xuefzhao_a, __pyx_n_s_eu_y_vs_x_ratio_single_dot, 750, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__264)) __PYX_ERR(0, 750, __pyx_L1_error)

  /* "vapor_vali/Simple_function.pyx":758
 *     else:               return abs(float(dot_pos[1])/float(dot_pos[0]))
 * 
 * def eu_y_vs_x_ratio_calcu(ref_clean_dotdata):             # <<<<<<<<<<<<<<
 *     y_x_ratio_list=[round(eu_y_vs_x_ratio_single_dot(i),2) for i in ref_clean_dotdata if eu_dis_single_dot(i)<0.15]
 *     if y_x_ratio_list==[]:  return 1
 */
  __pyx_tuple__265 = PyTuple_Pack(5, __pyx_n_s_ref_clean_dotdata, __pyx_n_s_y_x_ratio_list, __pyx_n_s_nparam_density, __pyx_n_s_test, __pyx_n_s_i); if (unlikely(!__pyx_tuple__265)) __PYX_ERR(0, 758, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__265);
  __Pyx_GIVEREF(__pyx_tuple__265);
  __pyx_codeobj__266 = (PyObject*)__Pyx_PyCode_New(1, 0, 5, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__265, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_scratch_remills_flux_xuefzhao_a, __pyx_n_s_eu_y_vs_x_ratio_calcu, 758, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__266)) __PYX_ERR(0, 758, __pyx_L1_error)

  /* "vapor_vali/Simple_function.pyx":770
 *             return unify_list(y_x_ratio_list)[0]
 * 
 * def find_longest_list(list_set):             # <<<<<<<<<<<<<<
 *     length=[len(i) for i in list_set]
 *     out_pos=[i for i in range(len(list_set)) if len(list_set[i])==max(length)]
 */
  __pyx_tuple__267 = PyTuple_Pack(5, __pyx_n_s_list_set, __pyx_n_s_length, __pyx_n_s_out_pos, __pyx_n_s_out, __pyx_n_s_i); if (unlikely(!__pyx_tuple__267)) __PYX_ERR(0, 770, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__267);
  __Pyx_GIVEREF(__pyx_tuple__267);
  __pyx_codeobj__268 = (PyObject*)__Pyx_PyCode_New(1, 0, 5, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__267, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_scratch_remills_flux_xuefzhao_a, __pyx_n_s_find_longest_list, 770, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__268)) __PYX_ERR(0, 770, __pyx_L1_error)

  /* "vapor_vali/Simple_function.pyx":776
 *     return unify_list(out)
 * 
 * def flank_length_calculate(bps):             # <<<<<<<<<<<<<<
 *     if int(bps[-1])-int(bps[1])<100:
 *         flank_length=(int(bps[-1])-int(bps[1]))
 */
  __pyx_tuple__269 = PyTuple_Pack(2, __pyx_n_s_bps, __pyx_n_s_flank_length); if (unlikely(!__pyx_tuple__269)) __PYX_ERR(0, 776, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__269);
  __Pyx_GIVEREF(__pyx_tuple__269);
  __pyx_codeobj__270 = (PyObject*)__Pyx_PyCode_New(1, 0, 2, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__269, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_scratch_remills_flux_xuefzhao_a, __pyx_n_s_flank_length_calculate, 776, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__270)) __PYX_ERR(0, 776, __pyx_L1_error)

  /* "vapor_vali/Simple_function.pyx":786
 *     return flank_length
 * 
 * def genoCN_extract(pin):             # <<<<<<<<<<<<<<
 *     out=[0,0]
 *     rec_pos=-1
 */
  __pyx_tuple__271 = PyTuple_Pack(6, __pyx_n_s_pin, __pyx_n_s_out, __pyx_n_s_rec_pos, __pyx_n_s_x, __pyx_n_s_geno, __pyx_n_s_i); if (unlikely(!__pyx_tuple__271)) __PYX_ERR(0, 786, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__271);
  __Pyx_GIVEREF(__pyx_tuple__271);
  __pyx_codeobj__272 = (PyObject*)__Pyx_PyCode_New(1, 0, 6, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__271, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_scratch_remills_flux_xuefzhao_a, __pyx_n_s_genoCN_extract, 786, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__272)) __PYX_ERR(0, 786, __pyx_L1_error)

  /* "vapor_vali/Simple_function.pyx":797
 *     return out
 * 
 * def genotype_extract(pin):             # <<<<<<<<<<<<<<
 *     out=[0,0]
 *     rec_pos=-1
 */
  __pyx_tuple__273 = PyTuple_Pack(7, __pyx_n_s_pin, __pyx_n_s_out, __pyx_n_s_rec_pos, __pyx_n_s_x, __pyx_n_s_geno, __pyx_n_s_i, __pyx_n_s_j); if (unlikely(!__pyx_tuple__273)) __PYX_ERR(0, 797, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__273);
  __Pyx_GIVEREF(__pyx_tuple__273);
  __pyx_codeobj__274 = (PyObject*)__Pyx_PyCode_New(1, 0, 7, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__273, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_scratch_remills_flux_xuefzhao_a, __pyx_n_s_genotype_extract, 797, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__274)) __PYX_ERR(0, 797, __pyx_L1_error)

  /* "vapor_vali/Simple_function.pyx":815
 *     return out
 * 
 * def INS_length_detect(pin):             # <<<<<<<<<<<<<<
 *     out=0
 *     for x in pin[7].split(';'):
 */
  __pyx_tuple__275 = PyTuple_Pack(3, __pyx_n_s_pin, __pyx_n_s_out, __pyx_n_s_x); if (unlikely(!__pyx_tuple__275)) __PYX_ERR(0, 815, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__275);
  __Pyx_GIVEREF(__pyx_tuple__275);
  __pyx_codeobj__276 = (PyObject*)__Pyx_PyCode_New(1, 0, 3, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__275, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_scratch_remills_flux_xuefzhao_a, __pyx_n_s_INS_length_detect, 815, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__276)) __PYX_ERR(0, 815, __pyx_L1_error)

  /* "vapor_vali/Simple_function.pyx":822
 *     return out
 * 
 * def intersect(a, b):             # <<<<<<<<<<<<<<
 *     return ''.join(sorted(list(set(a) & set(b))))
 * 
 */
  __pyx_tuple__277 = PyTuple_Pack(2, __pyx_n_s_a, __pyx_n_s_b); if (unlikely(!__pyx_tuple__277)) __PYX_ERR(0, 822, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__277);
  __Pyx_GIVEREF(__pyx_tuple__277);
  __pyx_codeobj__278 = (PyObject*)__Pyx_PyCode_New(2, 0, 2, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__277, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_scratch_remills_flux_xuefzhao_a, __pyx_n_s_intersect, 822, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__278)) __PYX_ERR(0, 822, __pyx_L1_error)

  /* "vapor_vali/Simple_function.pyx":825
 *     return ''.join(sorted(list(set(a) & set(b))))
 * 
 * def interval_dis_calcu_max(pos_check):             # <<<<<<<<<<<<<<
 *     #eg of pos_check=[97,98]
 *     if len(pos_check)>1:
 */
  __pyx_tuple__279 = PyTuple_Pack(3, __pyx_n_s_pos_check, __pyx_n_s_out, __pyx_n_s_i); if (unlikely(!__pyx_tuple__279)) __PYX_ERR(0, 825, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__279);
  __Pyx_GIVEREF(__pyx_tuple__279);
  __pyx_codeobj__280 = (PyObject*)__Pyx_PyCode_New(1, 0, 3, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__279, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_scratch_remills_flux_xuefzhao_a, __pyx_n_s_interval_dis_calcu_max, 825, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__280)) __PYX_ERR(0, 825, __pyx_L1_error)

  /* "vapor_vali/Simple_function.pyx":833
 *         return 'NA'
 * 
 * def kept_lines_size_filter(size_list,square_size=400):             # <<<<<<<<<<<<<<
 *     #eg of size_list=[(1582, 415), (1677, 506)]
 *     if abs((size_list[1][0]-size_list[0][0])*(size_list[1][1]-size_list[0][1]))>square_size:    return 'TRUE'
 */
  __pyx_tuple__281 = PyTuple_Pack(2, __pyx_n_s_size_list, __pyx_n_s_square_size); if (unlikely(!__pyx_tuple__281)) __PYX_ERR(0, 833, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__281);
  __Pyx_GIVEREF(__pyx_tuple__281);
  __pyx_codeobj__282 = (PyObject*)__Pyx_PyCode_New(2, 0, 2, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__281, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_scratch_remills_flux_xuefzhao_a, __pyx_n_s_kept_lines_size_filter, 833, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__282)) __PYX_ERR(0, 833, __pyx_L1_error)

  /* "vapor_vali/Simple_function.pyx":838
 *     else:                                                                                       return 'FALSE'
 * 
 * def k_means_cluster(data_list):             # <<<<<<<<<<<<<<
 *     if max(data_list[0])-min(data_list[0])>10 and max(data_list[1])-min(data_list[1])>10:
 *         array_diagnal=np.array([[data_list[0][x],data_list[1][x]] for x in range(len(data_list[0]))])
 */
  __pyx_tuple__283 = PyTuple_Pack(19, __pyx_n_s_data_list, __pyx_n_s_array_diagnal, __pyx_n_s_ks, __pyx_n_s_KMeans, __pyx_n_s_KMeans_predict, __pyx_n_s_BIC, __pyx_n_s_BIC_rec, __pyx_n_s_x, __pyx_n_s_BIC_i, __pyx_n_s_ks_picked, __pyx_n_s_out, __pyx_n_s_std_rec, __pyx_n_s_whitened, __pyx_n_s_centroids, __pyx_n_s_distortion, __pyx_n_s_idx, __pyx_n_s__115, __pyx_n_s_group1, __pyx_n_s_i); if (unlikely(!__pyx_tuple__283)) __PYX_ERR(0, 838, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__283);
  __Pyx_GIVEREF(__pyx_tuple__283);
  __pyx_codeobj__284 = (PyObject*)__Pyx_PyCode_New(1, 0, 19, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__283, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_scratch_remills_flux_xuefzhao_a, __pyx_n_s_k_means_cluster, 838, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__284)) __PYX_ERR(0, 838, __pyx_L1_error)

  /* "vapor_vali/Simple_function.pyx":871
 *         return [data_list]
 * 
 * def k_means_cluster_Predict(data_list,info):             # <<<<<<<<<<<<<<
 *     array_diagnal=np.array([[data_list[0][x],data_list[1][x]] for x in range(len(data_list[0]))])
 *     ks = list(range(1,len(info)))
 */
  __pyx_tuple__285 = PyTuple_Pack(18, __pyx_n_s_data_list, __pyx_n_s_info, __pyx_n_s_array_diagnal, __pyx_n_s_ks, __pyx_n_s_KMeans, __pyx_n_s_BIC, __pyx_n_s_ks_picked, __pyx_n_s_out, __pyx_n_s_std_rec, __pyx_n_s_whitened, __pyx_n_s_centroids, __pyx_n_s_distortion, __pyx_n_s_idx, __pyx_n_s__115, __pyx_n_s_x, __pyx_n_s_group1, __pyx_n_s_i, __pyx_n_s_kmeansi); if (unlikely(!__pyx_tuple__285)) __PYX_ERR(0, 871, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__285);
  __Pyx_GIVEREF(__pyx_tuple__285);
  __pyx_codeobj__286 = (PyObject*)__Pyx_PyCode_New(2, 0, 18, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__285, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_scratch_remills_flux_xuefzhao_a, __pyx_n_s_k_means_cluster_Predict, 871, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__286)) __PYX_ERR(0, 871, __pyx_L1_error)

  /* "vapor_vali/Simple_function.pyx":890
 *         return out
 * 
 * def key_modify(key):             # <<<<<<<<<<<<<<
 *     if 'R' in key:
 *             key=key.replace('R','N')
 */
  __pyx_tuple__287 = PyTuple_Pack(1, __pyx_n_s_key); if (unlikely(!__pyx_tuple__287)) __PYX_ERR(0, 890, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__287);
  __Pyx_GIVEREF(__pyx_tuple__287);
  __pyx_codeobj__288 = (PyObject*)__Pyx_PyCode_New(1, 0, 1, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__287, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_scratch_remills_flux_xuefzhao_a, __pyx_n_s_key_modify, 890, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__288)) __PYX_ERR(0, 890, __pyx_L1_error)

  /* "vapor_vali/Simple_function.pyx":933
 *     return key
 * 
 * def kmerhits(seq1, seq2, kmerlen, nth_base=1, inversions=False):             # <<<<<<<<<<<<<<
 *     # hash table for finding hits
 *     lookup = {}
 */
  __pyx_tuple__289 = PyTuple_Pack(14, __pyx_n_s_seq1, __pyx_n_s_seq2, __pyx_n_s_kmerlen, __pyx_n_s_nth_base, __pyx_n_s_inversions, __pyx_n_s_lookup, __pyx_n_s_seq1len, __pyx_n_s_i, __pyx_n_s_key, __pyx_n_s_subkey, __pyx_n_s_hits, __pyx_n_s_subhits, __pyx_n_s_k1, __pyx_n_s_hit); if (unlikely(!__pyx_tuple__289)) __PYX_ERR(0, 933, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__289);
  __Pyx_GIVEREF(__pyx_tuple__289);
  __pyx_codeobj__290 = (PyObject*)__Pyx_PyCode_New(5, 0, 14, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__289, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_scratch_remills_flux_xuefzhao_a, __pyx_n_s_kmerhits, 933, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__290)) __PYX_ERR(0, 933, __pyx_L1_error)

  /* "vapor_vali/Simple_function.pyx":967
 *     return hits
 * 
 * def let_to_block_info(let,let_hash,chromos):             # <<<<<<<<<<<<<<
 *     #eg of let='ab'; eg of let_hash={'a': ['chrY', '10818935', '10819073'], 'b': ['chrY', '10819073', '10926507'], '+': ['chrY', '10926507', '10927007'], '-': ['chrY', '10818435', 10818935]}
 *     out=[]
 */
  __pyx_tuple__291 = PyTuple_Pack(5, __pyx_n_s_let, __pyx_n_s_let_hash, __pyx_n_s_chromos, __pyx_n_s_out, __pyx_n_s_i); if (unlikely(!__pyx_tuple__291)) __PYX_ERR(0, 967, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__291);
  __Pyx_GIVEREF(__pyx_tuple__291);
  __pyx_codeobj__292 = (PyObject*)__Pyx_PyCode_New(3, 0, 5, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__291, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_scratch_remills_flux_xuefzhao_a, __pyx_n_s_let_to_block_info, 967, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__292)) __PYX_ERR(0, 967, __pyx_L1_error)

  /* "vapor_vali/Simple_function.pyx":975
 *     return(block_modify(out,chromos))
 * 
 * def letter_subgroup(k2_hap):             # <<<<<<<<<<<<<<
 *     #eg of k2_hap='ac^b^'
 *     inverted_sv=[]
 */
  __pyx_tuple__293 = PyTuple_Pack(6, __pyx_n_s_k2_hap, __pyx_n_s_inverted_sv, __pyx_n_s_x, __pyx_n_s_inverted_sv_2, __pyx_n_s_inverted_sv_3, __pyx_n_s_i); if (unlikely(!__pyx_tuple__293)) __PYX_ERR(0, 975, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__293);
  __Pyx_GIVEREF(__pyx_tuple__293);
  __pyx_codeobj__294 = (PyObject*)__Pyx_PyCode_New(1, 0, 6, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__293, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_scratch_remills_flux_xuefzhao_a, __pyx_n_s_letter_subgroup, 975, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__294)) __PYX_ERR(0, 975, __pyx_L1_error)

  /* "vapor_vali/Simple_function.pyx":995
 *     return inverted_sv_3
 * 
 * def letter_split(let):             # <<<<<<<<<<<<<<
 *     #eg of let='c^ba'
 *     out=[]
 */
  __pyx_tuple__295 = PyTuple_Pack(3, __pyx_n_s_let, __pyx_n_s_out, __pyx_n_s_x); if (unlikely(!__pyx_tuple__295)) __PYX_ERR(0, 995, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__295);
  __Pyx_GIVEREF(__pyx_tuple__295);
  __pyx_codeobj__296 = (PyObject*)__Pyx_PyCode_New(1, 0, 3, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__295, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_scratch_remills_flux_xuefzhao_a, __pyx_n_s_letter_split, 995, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__296)) __PYX_ERR(0, 995, __pyx_L1_error)

  /* "vapor_vali/Simple_function.pyx":1003
 *     return out
 * 
 * def list_unify(list):             # <<<<<<<<<<<<<<
 *     out=[]
 *     for i in list:
 */
  __pyx_tuple__297 = PyTuple_Pack(3, __pyx_n_s_list, __pyx_n_s_out, __pyx_n_s_i); if (unlikely(!__pyx_tuple__297)) __PYX_ERR(0, 1003, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__297);
  __Pyx_GIVEREF(__pyx_tuple__297);
  __pyx_codeobj__298 = (PyObject*)__Pyx_PyCode_New(1, 0, 3, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__297, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_scratch_remills_flux_xuefzhao_a, __pyx_n_s_list_unify, 1003, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__298)) __PYX_ERR(0, 1003, __pyx_L1_error)

  /* "vapor_vali/Simple_function.pyx":1009
 *     return out
 * 
 * def make_event_figure_1(vapor_score_list,best_read_rec,window_size,ref_seq,alt_seq,out_figure_name):             # <<<<<<<<<<<<<<
 *     if not best_read_rec=='':
 *         if not best_read_rec==[]:
 */
  __pyx_tuple__299 = PyTuple_Pack(10, __pyx_n_s_vapor_score_list, __pyx_n_s_best_read_rec, __pyx_n_s_window_size, __pyx_n_s_ref_seq, __pyx_n_s_alt_seq, __pyx_n_s_out_figure_name, __pyx_n_s_dotdata_record, __pyx_n_s_grdevices, __pyx_n_s_graphics, __pyx_n_s_i); if (unlikely(!__pyx_tuple__299)) __PYX_ERR(0, 1009, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__299);
  __Pyx_GIVEREF(__pyx_tuple__299);
  __pyx_codeobj__300 = (PyObject*)__Pyx_PyCode_New(6, 0, 10, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__299, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_scratch_remills_flux_xuefzhao_a, __pyx_n_s_make_event_figure_1, 1009, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__300)) __PYX_ERR(0, 1009, __pyx_L1_error)

  /* "vapor_vali/Simple_function.pyx":1034
 *                 grdevices.dev_off()
 * 
 * def minimize_pacbio_read_list(x,ideal_list_length=20):             # <<<<<<<<<<<<<<
 *     #eg of x=chop_pacbio_read_by_pos(bam_in_new,chrom,start,end,flank_length)
 *     if len(x)>ideal_list_length:
 */
  __pyx_tuple__301 = PyTuple_Pack(4, __pyx_n_s_x, __pyx_n_s_ideal_list_length, __pyx_n_s_out, __pyx_n_s_temp_hash); if (unlikely(!__pyx_tuple__301)) __PYX_ERR(0, 1034, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__301);
  __Pyx_GIVEREF(__pyx_tuple__301);
  __pyx_codeobj__302 = (PyObject*)__Pyx_PyCode_New(2, 0, 4, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__301, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_scratch_remills_flux_xuefzhao_a, __pyx_n_s_minimize_pacbio_read_list, 1034, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__302)) __PYX_ERR(0, 1034, __pyx_L1_error)

  /* "vapor_vali/Simple_function.pyx":1047
 *     else: return x
 * 
 * def number_cluster(dis_to_diagnal_list,dis_range):             # <<<<<<<<<<<<<<
 *     dis_clu=[[] for i in dis_range]
 *     reca=0
 */
  __pyx_tuple__303 = PyTuple_Pack(6, __pyx_n_s_dis_to_diagnal_list, __pyx_n_s_dis_range, __pyx_n_s_dis_clu, __pyx_n_s_reca, __pyx_n_s_recb, __pyx_n_s_i); if (unlikely(!__pyx_tuple__303)) __PYX_ERR(0, 1047, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__303);
  __Pyx_GIVEREF(__pyx_tuple__303);
  __pyx_codeobj__304 = (PyObject*)__Pyx_PyCode_New(2, 0, 6, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__303, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_scratch_remills_flux_xuefzhao_a, __pyx_n_s_number_cluster, 1047, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__304)) __PYX_ERR(0, 1047, __pyx_L1_error)

  /* "vapor_vali/Simple_function.pyx":1063
 *     return dis_clu
 * 
 * def one_dimention_cluster_by_gap(dim1,gap,length):             # <<<<<<<<<<<<<<
 *     out_hash={}
 *     for k1 in range(len(dim1)):
 */
  __pyx_tuple__305 = PyTuple_Pack(10, __pyx_n_s_dim1, __pyx_n_s_gap, __pyx_n_s_length, __pyx_n_s_out_hash, __pyx_n_s_k1, __pyx_n_s_sorted_keys, __pyx_n_s_out, __pyx_n_s_out2, __pyx_n_s_k2, __pyx_n_s_i); if (unlikely(!__pyx_tuple__305)) __PYX_ERR(0, 1063, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__305);
  __Pyx_GIVEREF(__pyx_tuple__305);
  __pyx_codeobj__306 = (PyObject*)__Pyx_PyCode_New(3, 0, 10, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__305, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_scratch_remills_flux_xuefzhao_a, __pyx_n_s_one_dimention_cluster_by_gap, 1063, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__306)) __PYX_ERR(0, 1063, __pyx_L1_error)

  /* "vapor_vali/Simple_function.pyx":1081
 *     return out2
 * 
 * def path_mkdir(path):             # <<<<<<<<<<<<<<
 *     if not os.path.isdir(path):
 *         os.system(r'''mkdir %s'''%(path))
 */
  __pyx_tuple__307 = PyTuple_Pack(1, __pyx_n_s_path); if (unlikely(!__pyx_tuple__307)) __PYX_ERR(0, 1081, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__307);
  __Pyx_GIVEREF(__pyx_tuple__307);
  __pyx_codeobj__308 = (PyObject*)__Pyx_PyCode_New(1, 0, 1, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__307, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_scratch_remills_flux_xuefzhao_a, __pyx_n_s_path_mkdir, 1081, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__308)) __PYX_ERR(0, 1081, __pyx_L1_error)

  /* "vapor_vali/Simple_function.pyx":1085
 *         os.system(r'''mkdir %s'''%(path))
 * 
 * def path_modify(path):             # <<<<<<<<<<<<<<
 *     if not path[-1]=='/':
 *         path+='/'
 */
  __pyx_tuple__309 = PyTuple_Pack(1, __pyx_n_s_path); if (unlikely(!__pyx_tuple__309)) __PYX_ERR(0, 1085, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__309);
  __Pyx_GIVEREF(__pyx_tuple__309);
  __pyx_codeobj__310 = (PyObject*)__Pyx_PyCode_New(1, 0, 1, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__309, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_scratch_remills_flux_xuefzhao_a, __pyx_n_s_path_modify, 1085, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__310)) __PYX_ERR(0, 1085, __pyx_L1_error)

  /* "vapor_vali/Simple_function.pyx":1090
 *     return path
 * 
 * def polarity_detect(pin):             # <<<<<<<<<<<<<<
 *     out='+'
 *     for x in pin[7].split(';'):
 */
  __pyx_tuple__311 = PyTuple_Pack(3, __pyx_n_s_pin, __pyx_n_s_out, __pyx_n_s_x); if (unlikely(!__pyx_tuple__311)) __PYX_ERR(0, 1090, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__311);
  __Pyx_GIVEREF(__pyx_tuple__311);
  __pyx_codeobj__312 = (PyObject*)__Pyx_PyCode_New(1, 0, 3, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__311, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_scratch_remills_flux_xuefzhao_a, __pyx_n_s_polarity_detect, 1090, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__312)) __PYX_ERR(0, 1090, __pyx_L1_error)

  /* "vapor_vali/Simple_function.pyx":1097
 *     return out
 * 
 * def qual_check_repetitive_region(dotdata_qual_check):             # <<<<<<<<<<<<<<
 *     #qual_check_R_2(dotdata_qual_check,txt_file)  #not necessary for validator
 *     diagnal=0
 */
  __pyx_tuple__313 = PyTuple_Pack(7, __pyx_n_s_dotdata_qual_check, __pyx_n_s_diagnal, __pyx_n_s_other, __pyx_n_s_x, __pyx_n_s_other_cluster, __pyx_n_s_range_cluster, __pyx_n_s_size_cluster); if (unlikely(!__pyx_tuple__313)) __PYX_ERR(0, 1097, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__313);
  __Pyx_GIVEREF(__pyx_tuple__313);
  __pyx_codeobj__314 = (PyObject*)__Pyx_PyCode_New(1, 0, 7, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__313, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_scratch_remills_flux_xuefzhao_a, __pyx_n_s_qual_check_repetitive_region, 1097, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__314)) __PYX_ERR(0, 1097, __pyx_L1_error)

  /* "vapor_vali/Simple_function.pyx":1116
 *     return [float(diagnal)/float(len(dotdata_qual_check)),size_cluster]
 * 
 * def reverse(seq):             # <<<<<<<<<<<<<<
 *     return seq[::-1]
 * 
 */
  __pyx_tuple__315 = PyTuple_Pack(1, __pyx_n_s_seq); if (unlikely(!__pyx_tuple__315)) __PYX_ERR(0, 1116, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__315);
  __Pyx_GIVEREF(__pyx_tuple__315);
  __pyx_codeobj__316 = (PyObject*)__Pyx_PyCode_New(1, 0, 1, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__315, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_scratch_remills_flux_xuefzhao_a, __pyx_n_s_reverse, 1116, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__316)) __PYX_ERR(0, 1116, __pyx_L1_error)

  /* "vapor_vali/Simple_function.pyx":1119
 *     return seq[::-1]
 * 
 * def ref_ref_deviate_lines_calcu(list_dotdata):             # <<<<<<<<<<<<<<
 *     ref_kept_deviate=[i for i in list_dotdata if eu_dis_single_dot(i) > 0 and i[1]>i[0]]
 *     ref_left_wings=dot_to_line(ref_kept_deviate)
 */
  __pyx_tuple__317 = PyTuple_Pack(7, __pyx_n_s_list_dotdata, __pyx_n_s_ref_kept_deviate, __pyx_n_s_ref_left_wings, __pyx_n_s_ref_left_new, __pyx_n_s_x, __pyx_n_s_out, __pyx_n_s_i); if (unlikely(!__pyx_tuple__317)) __PYX_ERR(0, 1119, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__317);
  __Pyx_GIVEREF(__pyx_tuple__317);
  __pyx_codeobj__318 = (PyObject*)__Pyx_PyCode_New(1, 0, 7, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__317, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_scratch_remills_flux_xuefzhao_a, __pyx_n_s_ref_ref_deviate_lines_calcu, 1119, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__318)) __PYX_ERR(0, 1119, __pyx_L1_error)

  /* "vapor_vali/Simple_function.pyx":1132
 *     return [i for i in out if kept_lines_size_filter(i)=='TRUE']
 * 
 * def ref_ref_deviate_lines_describe(list_dotdata):             # <<<<<<<<<<<<<<
 *     ref_ref_lines=ref_ref_deviate_lines_calcu(list_dotdata)
 *     out=[]
 */
  __pyx_tuple__319 = PyTuple_Pack(6, __pyx_n_s_list_dotdata, __pyx_n_s_ref_ref_lines, __pyx_n_s_out, __pyx_n_s_line, __pyx_n_s_ratio, __pyx_n_s_intercept); if (unlikely(!__pyx_tuple__319)) __PYX_ERR(0, 1132, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__319);
  __Pyx_GIVEREF(__pyx_tuple__319);
  __pyx_codeobj__320 = (PyObject*)__Pyx_PyCode_New(1, 0, 6, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__319, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_scratch_remills_flux_xuefzhao_a, __pyx_n_s_ref_ref_deviate_lines_describe, 1132, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__320)) __PYX_ERR(0, 1132, __pyx_L1_error)

  /* "vapor_vali/Simple_function.pyx":1141
 *     return out
 * 
 * def ref_deviate_lines_calcu(list_dotdata):             # <<<<<<<<<<<<<<
 *     ref_kept_deviate=[i for i in list_dotdata if eu_dis_single_dot(i) > 0.15]
 *     ref_left_wings=dot_to_line(ref_kept_deviate)
 */
  __pyx_tuple__321 = PyTuple_Pack(4, __pyx_n_s_list_dotdata, __pyx_n_s_ref_kept_deviate, __pyx_n_s_ref_left_wings, __pyx_n_s_i); if (unlikely(!__pyx_tuple__321)) __PYX_ERR(0, 1141, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__321);
  __Pyx_GIVEREF(__pyx_tuple__321);
  __pyx_codeobj__322 = (PyObject*)__Pyx_PyCode_New(1, 0, 4, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__321, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_scratch_remills_flux_xuefzhao_a, __pyx_n_s_ref_deviate_lines_calcu, 1141, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__322)) __PYX_ERR(0, 1141, __pyx_L1_error)

  /* "vapor_vali/Simple_function.pyx":1146
 *     return    [i for i in ref_left_wings if kept_lines_size_filter(i)=='TRUE']
 * 
 * def ref_seq_readin(ref,chrom,start,end,reverse_flag='FALSE'):             # <<<<<<<<<<<<<<
 *     #reverse=='TRUE': return rev-comp-seq   ; if not specified, default as 'FALSE'
 *     #else: return original seq
 */
  __pyx_tuple__323 = PyTuple_Pack(8, __pyx_n_s_ref, __pyx_n_s_chrom, __pyx_n_s_start, __pyx_n_s_end, __pyx_n_s_reverse_flag, __pyx_n_s_fref, __pyx_n_s_seq, __pyx_n_s_pref); if (unlikely(!__pyx_tuple__323)) __PYX_ERR(0, 1146, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__323);
  __Pyx_GIVEREF(__pyx_tuple__323);
  __pyx_codeobj__324 = (PyObject*)__Pyx_PyCode_New(5, 0, 8, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__323, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_scratch_remills_flux_xuefzhao_a, __pyx_n_s_ref_seq_readin, 1146, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__324)) __PYX_ERR(0, 1146, __pyx_L1_error)

  /* "vapor_vali/Simple_function.pyx":1162
 *         return reverse(complementary(seq))
 * 
 * def result_organize_ins(info_list):             # <<<<<<<<<<<<<<
 *     #eg of info_list=[key_event,vapor_score_event]=['chr2_82961201', [-9.228366096827557, -106.46718851834126, -667.0858781654538, -38.56838396416415, -64.87185751169045, -147.77261544769615, -28.29536680099185, -25.378519434143666, -17.23542013374081, -113.00564782332029, -64.53043553409316]]
 *     if len(info_list[1])>0:
 */
  __pyx_tuple__325 = PyTuple_Pack(6, __pyx_n_s_info_list, __pyx_n_s_pos_values, __pyx_n_s_neg_values, __pyx_n_s_geno_value, __pyx_n_s_qual_value, __pyx_n_s_i); if (unlikely(!__pyx_tuple__325)) __PYX_ERR(0, 1162, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__325);
  __Pyx_GIVEREF(__pyx_tuple__325);
  __pyx_codeobj__326 = (PyObject*)__Pyx_PyCode_New(1, 0, 6, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__325, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_scratch_remills_flux_xuefzhao_a, __pyx_n_s_result_organize_ins, 1162, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__326)) __PYX_ERR(0, 1162, __pyx_L1_error)

  /* "vapor_vali/Simple_function.pyx":1176
 *         return [info_list[0]]+['NA' for i in range(3)]
 * 
 * def simple_del_diploid_decide(k1,k2):             # <<<<<<<<<<<<<<
 *     #eg of k1='ab/ab'   ; eg of k2='a/a'
 *     k2_haps=k2.split('/')
 */
  __pyx_tuple__327 = PyTuple_Pack(6, __pyx_n_s_k1, __pyx_n_s_k2, __pyx_n_s_k2_haps, __pyx_n_s_k1_hap, __pyx_n_s_out, __pyx_n_s_x); if (unlikely(!__pyx_tuple__327)) __PYX_ERR(0, 1176, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__327);
  __Pyx_GIVEREF(__pyx_tuple__327);
  __pyx_codeobj__328 = (PyObject*)__Pyx_PyCode_New(2, 0, 6, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__327, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_scratch_remills_flux_xuefzhao_a, __pyx_n_s_simple_del_diploid_decide, 1176, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__328)) __PYX_ERR(0, 1176, __pyx_L1_error)

  /* "vapor_vali/Simple_function.pyx":1187
 *     return out
 * 
 * def simple_del_haploid_decide(k1_hap,k2_hap):             # <<<<<<<<<<<<<<
 *     #eg of k1_hap='ab'  ;    eg of k2_hap='b'
 *     if k1_hap==k2_hap: return 'FALSE'   #no alt
 */
  __pyx_tuple__329 = PyTuple_Pack(6, __pyx_n_s_k1_hap, __pyx_n_s_k2_hap, __pyx_n_s_dup_test, __pyx_n_s_pos_compare, __pyx_n_s_i, __pyx_n_s_x); if (unlikely(!__pyx_tuple__329)) __PYX_ERR(0, 1187, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__329);
  __Pyx_GIVEREF(__pyx_tuple__329);
  __pyx_codeobj__330 = (PyObject*)__Pyx_PyCode_New(2, 0, 6, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__329, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_scratch_remills_flux_xuefzhao_a, __pyx_n_s_simple_del_haploid_decide, 1187, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__330)) __PYX_ERR(0, 1187, __pyx_L1_error)

  /* "vapor_vali/Simple_function.pyx":1199
 *     return letter_subgroup(''.join([i for i in k1_hap if not i in k2_hap]))
 * 
 * def simple_inv_diploid_decide(k1,k2):             # <<<<<<<<<<<<<<
 *     #eg of k1='ab/ab'   ; eg of k2='ab^/ab'
 *     k2_haps=k2.split('/')
 */
  __pyx_tuple__331 = PyTuple_Pack(6, __pyx_n_s_k1, __pyx_n_s_k2, __pyx_n_s_k2_haps, __pyx_n_s_k1_hap, __pyx_n_s_out, __pyx_n_s_x); if (unlikely(!__pyx_tuple__331)) __PYX_ERR(0, 1199, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__331);
  __Pyx_GIVEREF(__pyx_tuple__331);
  __pyx_codeobj__332 = (PyObject*)__Pyx_PyCode_New(2, 0, 6, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__331, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_scratch_remills_flux_xuefzhao_a, __pyx_n_s_simple_inv_diploid_decide, 1199, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__332)) __PYX_ERR(0, 1199, __pyx_L1_error)

  /* "vapor_vali/Simple_function.pyx":1210
 *     return out
 * 
 * def simple_inv_haploid_decide(k1_hap,k2_hap):             # <<<<<<<<<<<<<<
 *     #eg of k1_hap='ab'  ;    eg of k2_hap='b^a^'
 *     if not '^' in k2_hap:   return 'FALSE'      #if not block inverted
 */
  __pyx_tuple__333 = PyTuple_Pack(5, __pyx_n_s_k1_hap, __pyx_n_s_k2_hap, __pyx_n_s_dup_test, __pyx_n_s_inverted_sv_new, __pyx_n_s_i); if (unlikely(!__pyx_tuple__333)) __PYX_ERR(0, 1210, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__333);
  __Pyx_GIVEREF(__pyx_tuple__333);
  __pyx_codeobj__334 = (PyObject*)__Pyx_PyCode_New(2, 0, 5, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__333, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_scratch_remills_flux_xuefzhao_a, __pyx_n_s_simple_inv_haploid_decide, 1210, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__334)) __PYX_ERR(0, 1210, __pyx_L1_error)

  /* "vapor_vali/Simple_function.pyx":1220
 *     else:   return 'FALSE'
 * 
 * def simple_tandup_diploid_decide(k1,k2):             # <<<<<<<<<<<<<<
 *     #eg of k1='ab/ab'   ; eg of k2='abb/ab'
 *     k2_haps=k2.split('/')
 */
  __pyx_tuple__335 = PyTuple_Pack(6, __pyx_n_s_k1, __pyx_n_s_k2, __pyx_n_s_k2_haps, __pyx_n_s_k1_hap, __pyx_n_s_out, __pyx_n_s_x); if (unlikely(!__pyx_tuple__335)) __PYX_ERR(0, 1220, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__335);
  __Pyx_GIVEREF(__pyx_tuple__335);
  __pyx_codeobj__336 = (PyObject*)__Pyx_PyCode_New(2, 0, 6, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__335, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_scratch_remills_flux_xuefzhao_a, __pyx_n_s_simple_tandup_diploid_decide, 1220, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__336)) __PYX_ERR(0, 1220, __pyx_L1_error)

  /* "vapor_vali/Simple_function.pyx":1231
 *     return out
 * 
 * def simple_tandup_haploid_decide(k1_hap,k2_hap):             # <<<<<<<<<<<<<<
 *     if '^' in k2_hap:   return 'FALSE'
 *     dup_count=[k2_hap.count(i) for i in k1_hap]
 */
  __pyx_tuple__337 = PyTuple_Pack(10, __pyx_n_s_k1_hap, __pyx_n_s_k2_hap, __pyx_n_s_dup_count, __pyx_n_s_out, __pyx_n_s_temp1, __pyx_n_s_x, __pyx_n_s_overlap_portion, __pyx_n_s_overlap_count, __pyx_n_s_overlap, __pyx_n_s_i); if (unlikely(!__pyx_tuple__337)) __PYX_ERR(0, 1231, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__337);
  __Pyx_GIVEREF(__pyx_tuple__337);
  __pyx_codeobj__338 = (PyObject*)__Pyx_PyCode_New(2, 0, 10, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__337, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_scratch_remills_flux_xuefzhao_a, __pyx_n_s_simple_tandup_haploid_decide, 1231, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__338)) __PYX_ERR(0, 1231, __pyx_L1_error)

  /* "vapor_vali/Simple_function.pyx":1264
 *     return 'FALSE'
 * 
 * def simple_disdup_diploid_decide(k1,k2):             # <<<<<<<<<<<<<<
 *     #eg of k1='ab/ab'   ; eg of k2='bab/ab'
 *     k2_haps=k2.split('/')
 */
  __pyx_tuple__339 = PyTuple_Pack(6, __pyx_n_s_k1, __pyx_n_s_k2, __pyx_n_s_k2_haps, __pyx_n_s_k1_hap, __pyx_n_s_out, __pyx_n_s_x); if (unlikely(!__pyx_tuple__339)) __PYX_ERR(0, 1264, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__339);
  __Pyx_GIVEREF(__pyx_tuple__339);
  __pyx_codeobj__340 = (PyObject*)__Pyx_PyCode_New(2, 0, 6, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__339, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_scratch_remills_flux_xuefzhao_a, __pyx_n_s_simple_disdup_diploid_decide, 1264, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__340)) __PYX_ERR(0, 1264, __pyx_L1_error)

  /* "vapor_vali/Simple_function.pyx":1275
 *     return out
 * 
 * def simple_disdup_haploid_decide(k1_hap,k2_hap):             # <<<<<<<<<<<<<<
 *     #eg of k1_hap='abcd'    ;   eg of k2_hap='babdcd'
 *     if not '^' in k2_hap:
 */
  __pyx_tuple__341 = PyTuple_Pack(20, __pyx_n_s_k1_hap, __pyx_n_s_k2_hap, __pyx_n_s_dup_dis, __pyx_n_s_overlap, __pyx_n_s_dup_count, __pyx_n_s_dup_block, __pyx_n_s_dup_block_combined, __pyx_n_s_dis_dup_check, __pyx_n_s_no_dup_block, __pyx_n_s_x, __pyx_n_s_y, __pyx_n_s_original_pos, __pyx_n_s_x_modify_new, __pyx_n_s_temp_structure, __pyx_n_s_insert_pos, __pyx_n_s_i, __pyx_n_s_j, __pyx_n_s_k2_hap_new, __pyx_n_s_insert_block, __pyx_n_s_pos_rec); if (unlikely(!__pyx_tuple__341)) __PYX_ERR(0, 1275, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__341);
  __Pyx_GIVEREF(__pyx_tuple__341);
  __pyx_codeobj__342 = (PyObject*)__Pyx_PyCode_New(2, 0, 20, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__341, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_scratch_remills_flux_xuefzhao_a, __pyx_n_s_simple_disdup_haploid_decide, 1275, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__342)) __PYX_ERR(0, 1275, __pyx_L1_error)

  /* "vapor_vali/Simple_function.pyx":1321
 *     return 'FALSE'
 * 
 * def simple_del_chop_pacbio_read_simple_short(bam_in,sv_info,flank_length):             # <<<<<<<<<<<<<<
 *     #eg of info = ['a/a','/','chr1', 101553562, 101553905]
 *     #pick read around left breakpoints
 */
  __pyx_tuple__343 = PyTuple_Pack(6, __pyx_n_s_bam_in, __pyx_n_s_sv_info, __pyx_n_s_flank_length, __pyx_n_s_bam_in_new_list, __pyx_n_s_x, __pyx_n_s_bam_in_new); if (unlikely(!__pyx_tuple__343)) __PYX_ERR(0, 1321, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__343);
  __Pyx_GIVEREF(__pyx_tuple__343);
  __pyx_codeobj__344 = (PyObject*)__Pyx_PyCode_New(3, 0, 6, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__343, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_scratch_remills_flux_xuefzhao_a, __pyx_n_s_simple_del_chop_pacbio_read_simp, 1321, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__344)) __PYX_ERR(0, 1321, __pyx_L1_error)

  /* "vapor_vali/Simple_function.pyx":1335
 *     return x
 * 
 * def simple_chop_pacbio_read_simple_short(bam_in,sv_info,flank_length):             # <<<<<<<<<<<<<<
 *     #eg of info = ['a/a','/','chr1', 101553562, 101553905]
 *     #eg of sv_info=['chr1', 101553562, 101553905]
 */
  __pyx_tuple__345 = PyTuple_Pack(6, __pyx_n_s_bam_in, __pyx_n_s_sv_info, __pyx_n_s_flank_length, __pyx_n_s_bam_in_new_list, __pyx_n_s_x, __pyx_n_s_bam_in_new); if (unlikely(!__pyx_tuple__345)) __PYX_ERR(0, 1335, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__345);
  __Pyx_GIVEREF(__pyx_tuple__345);
  __pyx_codeobj__346 = (PyObject*)__Pyx_PyCode_New(3, 0, 6, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__345, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_scratch_remills_flux_xuefzhao_a, __pyx_n_s_simple_chop_pacbio_read_simple_s, 1335, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__346)) __PYX_ERR(0, 1335, __pyx_L1_error)

  /* "vapor_vali/Simple_function.pyx":1346
 *     return x
 * 
 * def subkeys(key, nth_base, inversions):             # <<<<<<<<<<<<<<
 *     subkeys_info = []
 *     key=key_modify(key)
 */
  __pyx_tuple__347 = PyTuple_Pack(10, __pyx_n_s_key, __pyx_n_s_nth_base, __pyx_n_s_inversions, __pyx_n_s_subkeys_info, __pyx_n_s_keylen, __pyx_n_s_k, __pyx_n_s_substr_list, __pyx_n_s_i, __pyx_n_s_j, __pyx_n_s_c); if (unlikely(!__pyx_tuple__347)) __PYX_ERR(0, 1346, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__347);
  __Pyx_GIVEREF(__pyx_tuple__347);
  __pyx_codeobj__348 = (PyObject*)__Pyx_PyCode_New(3, 0, 10, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__347, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_scratch_remills_flux_xuefzhao_a, __pyx_n_s_subkeys, 1346, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__348)) __PYX_ERR(0, 1346, __pyx_L1_error)

  /* "vapor_vali/Simple_function.pyx":1367
 *     return subkeys_info
 * 
 * def svtype_extract(pin):             # <<<<<<<<<<<<<<
 *     svtype=''
 *     for x in pin[7].split(';'):
 */
  __pyx_tuple__349 = PyTuple_Pack(3, __pyx_n_s_pin, __pyx_n_s_svtype, __pyx_n_s_x); if (unlikely(!__pyx_tuple__349)) __PYX_ERR(0, 1367, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__349);
  __Pyx_GIVEREF(__pyx_tuple__349);
  __pyx_codeobj__350 = (PyObject*)__Pyx_PyCode_New(1, 0, 3, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__349, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_scratch_remills_flux_xuefzhao_a, __pyx_n_s_svtype_extract, 1367, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__350)) __PYX_ERR(0, 1367, __pyx_L1_error)

  /* "vapor_vali/Simple_function.pyx":1376
 *     return svtype
 * 
 * def sv_len_extract(pin):             # <<<<<<<<<<<<<<
 *     svtype=''
 *     for x in pin[7].split(';'):
 */
  __pyx_tuple__351 = PyTuple_Pack(3, __pyx_n_s_pin, __pyx_n_s_svtype, __pyx_n_s_x); if (unlikely(!__pyx_tuple__351)) __PYX_ERR(0, 1376, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__351);
  __Pyx_GIVEREF(__pyx_tuple__351);
  __pyx_codeobj__352 = (PyObject*)__Pyx_PyCode_New(1, 0, 3, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__351, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_scratch_remills_flux_xuefzhao_a, __pyx_n_s_sv_len_extract, 1376, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__352)) __PYX_ERR(0, 1376, __pyx_L1_error)

  /* "vapor_vali/Simple_function.pyx":1385
 *     return svtype
 * 
 * def sv_seq_extract(pin):             # <<<<<<<<<<<<<<
 *     seq=''
 *     for x in pin[7].split(';'):
 */
  __pyx_tuple__353 = PyTuple_Pack(3, __pyx_n_s_pin, __pyx_n_s_seq, __pyx_n_s_x); if (unlikely(!__pyx_tuple__353)) __PYX_ERR(0, 1385, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__353);
  __Pyx_GIVEREF(__pyx_tuple__353);
  __pyx_codeobj__354 = (PyObject*)__Pyx_PyCode_New(1, 0, 3, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__353, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_scratch_remills_flux_xuefzhao_a, __pyx_n_s_sv_seq_extract, 1385, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__354)) __PYX_ERR(0, 1385, __pyx_L1_error)

  /* "vapor_vali/Simple_function.pyx":1392
 *     return seq
 * 
 * def sv_insert_point_define(pin):             # <<<<<<<<<<<<<<
 *     svtype=[0,0]
 *     for x in pin[7].split(';'):
 */
  __pyx_tuple__355 = PyTuple_Pack(4, __pyx_n_s_pin, __pyx_n_s_svtype, __pyx_n_s_x, __pyx_n_s_sv_info); if (unlikely(!__pyx_tuple__355)) __PYX_ERR(0, 1392, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__355);
  __Pyx_GIVEREF(__pyx_tuple__355);
  __pyx_codeobj__356 = (PyObject*)__Pyx_PyCode_New(1, 0, 4, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__355, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_scratch_remills_flux_xuefzhao_a, __pyx_n_s_sv_insert_point_define, 1392, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__356)) __PYX_ERR(0, 1392, __pyx_L1_error)

  /* "vapor_vali/Simple_function.pyx":1401
 *     return svtype
 * 
 * def take_off_symmetric_dots(list_dotdata):             # <<<<<<<<<<<<<<
 *     left_part=[list_dotdata[i] for i in range(len(list_dotdata)/2)]
 *     right_part=[list_dotdata[i][::-1] for i in [len(list_dotdata)-1-i for i in range(len(list_dotdata)/2)]]
 */
  __pyx_tuple__357 = PyTuple_Pack(9, __pyx_n_s_list_dotdata, __pyx_n_s_left_part, __pyx_n_s_right_part, __pyx_n_s_left_new, __pyx_n_s_right_new, __pyx_n_s_sym_dots, __pyx_n_s_i, __pyx_n_s_j, __pyx_n_s_out_dots); if (unlikely(!__pyx_tuple__357)) __PYX_ERR(0, 1401, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__357);
  __Pyx_GIVEREF(__pyx_tuple__357);
  __pyx_codeobj__358 = (PyObject*)__Pyx_PyCode_New(1, 0, 9, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__357, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_scratch_remills_flux_xuefzhao_a, __pyx_n_s_take_off_symmetric_dots, 1401, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__358)) __PYX_ERR(0, 1401, __pyx_L1_error)

  /* "vapor_vali/Simple_function.pyx":1415
 *     return out_dots
 * 
 * def two_dimention_cluster_by_gap(dim1,dim2,gap,length):             # <<<<<<<<<<<<<<
 *     ####dim1 and dim2 are both one-dimention data list,of the same length;
 *     ####dots with distance >gap on any dimention would be clustered into different group
 */
  __pyx_tuple__359 = PyTuple_Pack(9, __pyx_n_s_dim1, __pyx_n_s_dim2, __pyx_n_s_gap, __pyx_n_s_length, __pyx_n_s_clu_1, __pyx_n_s_clu_2_sub, __pyx_n_s_out, __pyx_n_s_i, __pyx_n_s_j); if (unlikely(!__pyx_tuple__359)) __PYX_ERR(0, 1415, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__359);
  __Pyx_GIVEREF(__pyx_tuple__359);
  __pyx_codeobj__360 = (PyObject*)__Pyx_PyCode_New(4, 0, 9, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__359, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_scratch_remills_flux_xuefzhao_a, __pyx_n_s_two_dimention_cluster_by_gap, 1415, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__360)) __PYX_ERR(0, 1415, __pyx_L1_error)

  /* "vapor_vali/Simple_function.pyx":1426
 *     return out
 * 
 * def unify_list(list):             # <<<<<<<<<<<<<<
 *     out=[]
 *     for x in list:
 */
  __pyx_tuple__361 = PyTuple_Pack(3, __pyx_n_s_list, __pyx_n_s_out, __pyx_n_s_x); if (unlikely(!__pyx_tuple__361)) __PYX_ERR(0, 1426, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__361);
  __Pyx_GIVEREF(__pyx_tuple__361);
  __pyx_codeobj__362 = (PyObject*)__Pyx_PyCode_New(1, 0, 3, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__361, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_scratch_remills_flux_xuefzhao_a, __pyx_n_s_unify_list, 1426, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__362)) __PYX_ERR(0, 1426, __pyx_L1_error)

  /* "vapor_vali/Simple_function.pyx":1433
 *     return out
 * 
 * def vapor_CANNOT_CLASSIFY_VapoR(bam_in,ref,sv_info,out_figure_name):             # <<<<<<<<<<<<<<
 *     #eg of sv_info=['ab_ab', 'b_b^', 'chr7', '70955990', '70961199', '70973901']
 *     ref_sv=sv_info[0].split('_')
 */
  __pyx_tuple__363 = PyTuple_Pack(28, __pyx_n_s_bam_in, __pyx_n_s_ref, __pyx_n_s_sv_info, __pyx_n_s_out_figure_name, __pyx_n_s_ref_sv, __pyx_n_s_alt_sv, __pyx_n_s_chromos, __pyx_n_s_bp_info, __pyx_n_s_flank_length, __pyx_n_s_vapor_score_list, __pyx_n_s_run_flag, __pyx_n_s_ref_seq, __pyx_n_s_window_size, __pyx_n_s_window_size_qc, __pyx_n_s_all_reads, __pyx_n_s_bp_let_hash, __pyx_n_s_bp_let_seq, __pyx_n_s_i, __pyx_n_s_alt_allele, __pyx_n_s_alt_seq, __pyx_n_s_best_read_rec, __pyx_n_s_x, __pyx_n_s_vapor_single_read_score, __pyx_n_s_alt_juncs, __pyx_n_s_alt_jun, __pyx_n_s_ref_seq_a, __pyx_n_s_ref_seq_b, __pyx_n_s_all_reads_a); if (unlikely(!__pyx_tuple__363)) __PYX_ERR(0, 1433, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__363);
  __Pyx_GIVEREF(__pyx_tuple__363);
  __pyx_codeobj__364 = (PyObject*)__Pyx_PyCode_New(4, 0, 28, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__363, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_scratch_remills_flux_xuefzhao_a, __pyx_n_s_vapor_CANNOT_CLASSIFY_VapoR, 1433, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__364)) __PYX_ERR(0, 1433, __pyx_L1_error)

  /* "vapor_vali/Simple_function.pyx":1500
 *     return vapor_score_list
 * 
 * def vapor_del_inv_Vapor(bam_in,ref,sv_info,out_figure_name):             # <<<<<<<<<<<<<<
 *     sv_block=[sv_info[0][0],sv_info[0][1],sv_info[-1][2]]
 *     flank_length=flank_length_calculate(sv_block)
 */
  __pyx_tuple__365 = PyTuple_Pack(17, __pyx_n_s_bam_in, __pyx_n_s_ref, __pyx_n_s_sv_info, __pyx_n_s_out_figure_name, __pyx_n_s_sv_block, __pyx_n_s_flank_length, __pyx_n_s_vapor_score_list, __pyx_n_s_best_read_rec, __pyx_n_s_ref_seq, __pyx_n_s_window_size, __pyx_n_s_window_size_qc, __pyx_n_s_alt_seq, __pyx_n_s_x, __pyx_n_s_all_reads, __pyx_n_s_vapor_single_read_score, __pyx_n_s_sub_sv_info, __pyx_n_s_i); if (unlikely(!__pyx_tuple__365)) __PYX_ERR(0, 1500, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__365);
  __Pyx_GIVEREF(__pyx_tuple__365);
  __pyx_codeobj__366 = (PyObject*)__Pyx_PyCode_New(4, 0, 17, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__365, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_scratch_remills_flux_xuefzhao_a, __pyx_n_s_vapor_del_inv_Vapor, 1500, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__366)) __PYX_ERR(0, 1500, __pyx_L1_error)

  /* "vapor_vali/Simple_function.pyx":1538
 *     return vapor_score_list
 * 
 * def vapor_dup_inv_VapoR(bam_in,ref,sv_info,out_figure_name):             # <<<<<<<<<<<<<<
 *     #eg of sv_info=['chr1', 114103333, 114103408, 'chr1', 114111746]
 *     sv_info[1:3]=[int(i) for i in sv_info[1:3]]
 */
  __pyx_tuple__367 = PyTuple_Pack(23, __pyx_n_s_bam_in, __pyx_n_s_ref, __pyx_n_s_sv_info, __pyx_n_s_out_figure_name, __pyx_n_s_dup_block, __pyx_n_s_ins_point, __pyx_n_s_flank_length, __pyx_n_s_vapor_score_list, __pyx_n_s_bp_info, __pyx_n_s_run_flag, __pyx_n_s_ref_seq, __pyx_n_s_window_size, __pyx_n_s_window_size_qc, __pyx_n_s_ref_structure, __pyx_n_s_alt_structure, __pyx_n_s_all_reads, __pyx_n_s_alt_seq, __pyx_n_s_a_seq, __pyx_n_s_b_seq, __pyx_n_s_x, __pyx_n_s_best_read_rec, __pyx_n_s_vapor_single_read_score, __pyx_n_s_i); if (unlikely(!__pyx_tuple__367)) __PYX_ERR(0, 1538, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__367);
  __Pyx_GIVEREF(__pyx_tuple__367);
  __pyx_codeobj__368 = (PyObject*)__Pyx_PyCode_New(4, 0, 23, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__367, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_scratch_remills_flux_xuefzhao_a, __pyx_n_s_vapor_dup_inv_VapoR, 1538, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__368)) __PYX_ERR(0, 1538, __pyx_L1_error)

  /* "vapor_vali/Simple_function.pyx":1614
 *     return vapor_score_list
 * 
 * def vapor_long_del_inv(bam_in,ref,sv_info,out_figure_name):             # <<<<<<<<<<<<<<
 *     #eg of sv_info=[['chr19', 46275941, 46314150, 'del'], ['chr19', 46314150, 46314312, 'inv']]
 *     vapor_score_list=[]
 */
  __pyx_tuple__369 = PyTuple_Pack(14, __pyx_n_s_bam_in, __pyx_n_s_ref, __pyx_n_s_sv_info, __pyx_n_s_out_figure_name, __pyx_n_s_vapor_score_list, __pyx_n_s_best_read_rec, __pyx_n_s_flank_length, __pyx_n_s_ref_seq, __pyx_n_s_window_size, __pyx_n_s_window_size_qc, __pyx_n_s_alt_seq, __pyx_n_s_all_reads, __pyx_n_s_x, __pyx_n_s_vapor_single_read_score); if (unlikely(!__pyx_tuple__369)) __PYX_ERR(0, 1614, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__369);
  __Pyx_GIVEREF(__pyx_tuple__369);
  __pyx_codeobj__370 = (PyObject*)__Pyx_PyCode_New(4, 0, 14, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__369, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_scratch_remills_flux_xuefzhao_a, __pyx_n_s_vapor_long_del_inv, 1614, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__370)) __PYX_ERR(0, 1614, __pyx_L1_error)

  /* "vapor_vali/Simple_function.pyx":1636
 *     return vapor_score_list
 * 
 * def vapor_simple_del_Vapor(bam_in,ref,sv_info,out_figure_name):             # <<<<<<<<<<<<<<
 *     #eg of sv_info=['chr1', 101553562, 101553905]
 *     flank_length=flank_length_calculate(sv_info)
 */
  __pyx_tuple__371 = PyTuple_Pack(14, __pyx_n_s_bam_in, __pyx_n_s_ref, __pyx_n_s_sv_info, __pyx_n_s_out_figure_name, __pyx_n_s_flank_length, __pyx_n_s_vapor_score_list, __pyx_n_s_best_read_rec, __pyx_n_s_all_reads, __pyx_n_s_ref_seq, __pyx_n_s_window_size, __pyx_n_s_window_size_qc, __pyx_n_s_alt_seq, __pyx_n_s_x, __pyx_n_s_vapor_single_read_score); if (unlikely(!__pyx_tuple__371)) __PYX_ERR(0, 1636, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__371);
  __Pyx_GIVEREF(__pyx_tuple__371);
  __pyx_codeobj__372 = (PyObject*)__Pyx_PyCode_New(4, 0, 14, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__371, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_scratch_remills_flux_xuefzhao_a, __pyx_n_s_vapor_simple_del_Vapor, 1636, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__372)) __PYX_ERR(0, 1636, __pyx_L1_error)

  /* "vapor_vali/Simple_function.pyx":1674
 *     return vapor_score_list
 * 
 * def vapor_simple_tandup_Vapor(bam_in,ref,sv_info,out_figure_name):             # <<<<<<<<<<<<<<
 *    #vapor_simple_del_Vapor(bam_in,ref,x[:-2],out_path+sample_name+'.TANDUP.'+key_event+'.png')
 *     flank_length=flank_length_calculate(sv_info)
 */
  __pyx_tuple__373 = PyTuple_Pack(14, __pyx_n_s_bam_in, __pyx_n_s_ref, __pyx_n_s_sv_info, __pyx_n_s_out_figure_name, __pyx_n_s_flank_length, __pyx_n_s_vapor_score_list, __pyx_n_s_best_read_rec, __pyx_n_s_ref_seq, __pyx_n_s_window_size, __pyx_n_s_window_size_qc, __pyx_n_s_alt_seq, __pyx_n_s_all_reads, __pyx_n_s_x, __pyx_n_s_vapor_single_read_score); if (unlikely(!__pyx_tuple__373)) __PYX_ERR(0, 1674, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__373);
  __Pyx_GIVEREF(__pyx_tuple__373);
  __pyx_codeobj__374 = (PyObject*)__Pyx_PyCode_New(4, 0, 14, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__373, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_scratch_remills_flux_xuefzhao_a, __pyx_n_s_vapor_simple_tandup_Vapor, 1674, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__374)) __PYX_ERR(0, 1674, __pyx_L1_error)

  /* "vapor_vali/Simple_function.pyx":1713
 *     return vapor_score_list
 * 
 * def vapor_simple_disdup_Vapor(bam_in,ref,sv_info,out_figure_name):             # <<<<<<<<<<<<<<
 *     sv_info[1:3]=[int(i) for i in sv_info[1:3]]
 *     dup_block=sv_info[:3]
 */
  __pyx_tuple__375 = PyTuple_Pack(23, __pyx_n_s_bam_in, __pyx_n_s_ref, __pyx_n_s_sv_info, __pyx_n_s_out_figure_name, __pyx_n_s_dup_block, __pyx_n_s_ins_point, __pyx_n_s_flank_length, __pyx_n_s_vapor_score_list, __pyx_n_s_best_read_rec, __pyx_n_s_bp_info, __pyx_n_s_run_flag, __pyx_n_s_ref_seq, __pyx_n_s_window_size, __pyx_n_s_window_size_qc, __pyx_n_s_all_reads, __pyx_n_s_ref_structure, __pyx_n_s_alt_structure, __pyx_n_s_alt_seq, __pyx_n_s_a_seq, __pyx_n_s_b_seq, __pyx_n_s_x, __pyx_n_s_vapor_single_read_score, __pyx_n_s_i); if (unlikely(!__pyx_tuple__375)) __PYX_ERR(0, 1713, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__375);
  __Pyx_GIVEREF(__pyx_tuple__375);
  __pyx_codeobj__376 = (PyObject*)__Pyx_PyCode_New(4, 0, 23, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__375, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_scratch_remills_flux_xuefzhao_a, __pyx_n_s_vapor_simple_disdup_Vapor, 1713, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__376)) __PYX_ERR(0, 1713, __pyx_L1_error)

  /* "vapor_vali/Simple_function.pyx":1783
 *     return vapor_score_list
 * 
 * def vapor_simple_ins_Vapor(bam_in,ref,ins_pos,ins_seq,out_figure_name,POLARITY):             # <<<<<<<<<<<<<<
 *     #eg of ins_pos='chr1_83144055'
 *     #eg of bam_in='/nfs/turbo/remillsscr/scratch2_trans/datasets/1000genomes/vol1/ftp/data_collections/hgsv_sv_discovery/PacBio/alignment/HG00512.XXX.bam'
 */
  __pyx_tuple__377 = PyTuple_Pack(17, __pyx_n_s_bam_in, __pyx_n_s_ref, __pyx_n_s_ins_pos, __pyx_n_s_ins_seq, __pyx_n_s_out_figure_name, __pyx_n_s_POLARITY, __pyx_n_s_ins_seq_2, __pyx_n_s_flank_length, __pyx_n_s_vapor_score_list, __pyx_n_s_best_read_rec, __pyx_n_s_all_reads, __pyx_n_s_ref_seq, __pyx_n_s_window_size, __pyx_n_s_window_size_qc, __pyx_n_s_alt_seq, __pyx_n_s_x, __pyx_n_s_vapor_single_read_score); if (unlikely(!__pyx_tuple__377)) __PYX_ERR(0, 1783, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__377);
  __Pyx_GIVEREF(__pyx_tuple__377);
  __pyx_codeobj__378 = (PyObject*)__Pyx_PyCode_New(6, 0, 17, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__377, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_scratch_remills_flux_xuefzhao_a, __pyx_n_s_vapor_simple_ins_Vapor, 1783, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__378)) __PYX_ERR(0, 1783, __pyx_L1_error)

  /* "vapor_vali/Simple_function.pyx":1821
 *     return vapor_score_list
 * 
 * def vapor_simple_inv_Vapor(bam_in,ref,sv_info,out_figure_name):             # <<<<<<<<<<<<<<
 *     #eg of sv_info=['chr1', 101553562, 101553905]
 *     flank_length=flank_length_calculate(sv_info)
 */
  __pyx_tuple__379 = PyTuple_Pack(14, __pyx_n_s_bam_in, __pyx_n_s_ref, __pyx_n_s_sv_info, __pyx_n_s_out_figure_name, __pyx_n_s_flank_length, __pyx_n_s_vapor_score_list, __pyx_n_s_best_read_rec, __pyx_n_s_ref_seq, __pyx_n_s_window_size, __pyx_n_s_window_size_qc, __pyx_n_s_alt_seq, __pyx_n_s_all_reads, __pyx_n_s_x, __pyx_n_s_vapor_single_read_score); if (unlikely(!__pyx_tuple__379)) __PYX_ERR(0, 1821, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__379);
  __Pyx_GIVEREF(__pyx_tuple__379);
  __pyx_codeobj__380 = (PyObject*)__Pyx_PyCode_New(4, 0, 14, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__379, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_scratch_remills_flux_xuefzhao_a, __pyx_n_s_vapor_simple_inv_Vapor, 1821, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__380)) __PYX_ERR(0, 1821, __pyx_L1_error)

  /* "vapor_vali/Simple_function.pyx":1860
 *     return vapor_score_list
 * 
 * def vcf_rec_hash_modify(vcf_rec_hash):             # <<<<<<<<<<<<<<
 *     out={}
 *     for k1 in list(vcf_rec_hash.keys()):
 */
  __pyx_tuple__381 = PyTuple_Pack(3, __pyx_n_s_vcf_rec_hash, __pyx_n_s_out, __pyx_n_s_k1); if (unlikely(!__pyx_tuple__381)) __PYX_ERR(0, 1860, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__381);
  __Pyx_GIVEREF(__pyx_tuple__381);
  __pyx_codeobj__382 = (PyObject*)__Pyx_PyCode_New(1, 0, 3, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__381, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_scratch_remills_flux_xuefzhao_a, __pyx_n_s_vcf_rec_hash_modify, 1860, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__382)) __PYX_ERR(0, 1860, __pyx_L1_error)

  /* "vapor_vali/Simple_function.pyx":1867
 *     return out
 * 
 * def vcf_vapor_modify(vcf_input,vcf_rec_hash_new):             # <<<<<<<<<<<<<<
 *     vapor_input=vcf_input+'.vapor'
 *     vapor_rec={}
 */
  __pyx_tuple__383 = PyTuple_Pack(15, __pyx_n_s_vcf_input, __pyx_n_s_vcf_rec_hash_new, __pyx_n_s_vapor_input, __pyx_n_s_vapor_rec, __pyx_n_s_fin, __pyx_n_s_vcf_info_hash, __pyx_n_s_rec, __pyx_n_s_line, __pyx_n_s_pin, __pyx_n_s_keep_rec, __pyx_n_s_sv_rec_label, __pyx_n_s_y, __pyx_n_s_fo, __pyx_n_s_k1, __pyx_n_s_i); if (unlikely(!__pyx_tuple__383)) __PYX_ERR(0, 1867, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__383);
  __Pyx_GIVEREF(__pyx_tuple__383);
  __pyx_codeobj__384 = (PyObject*)__Pyx_PyCode_New(2, 0, 15, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__383, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_scratch_remills_flux_xuefzhao_a, __pyx_n_s_vcf_vapor_modify, 1867, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__384)) __PYX_ERR(0, 1867, __pyx_L1_error)

  /* "vapor_vali/Simple_function.pyx":1897
 *     fo.close()
 * 
 * def window_size_refine(seq2,region_QC_Cff=0.4):             # <<<<<<<<<<<<<<
 *     window_size=10
 *     if not seq2.count('N')+seq2.count('n')>100:
 */
  __pyx_tuple__385 = PyTuple_Pack(5, __pyx_n_s_seq2, __pyx_n_s_region_QC_Cff, __pyx_n_s_window_size, __pyx_n_s_dotdata_qual_check, __pyx_n_s_region_QC); if (unlikely(!__pyx_tuple__385)) __PYX_ERR(0, 1897, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__385);
  __Pyx_GIVEREF(__pyx_tuple__385);
  __pyx_codeobj__386 = (PyObject*)__Pyx_PyCode_New(2, 0, 5, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__385, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_scratch_remills_flux_xuefzhao_a, __pyx_n_s_window_size_refine, 1897, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__386)) __PYX_ERR(0, 1897, __pyx_L1_error)

  /* "vapor_vali/Simple_function.pyx":1914
 *     else:       return ['Error','Error']
 * 
 * def write_dotdata_to_file(file_out,dotdata_list):             # <<<<<<<<<<<<<<
 *     fo=open(file_out,'w')
 *     for k1 in dotdata_list:
 */
  __pyx_tuple__387 = PyTuple_Pack(5, __pyx_n_s_file_out, __pyx_n_s_dotdata_list, __pyx_n_s_fo, __pyx_n_s_k1, __pyx_n_s_i); if (unlikely(!__pyx_tuple__387)) __PYX_ERR(0, 1914, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__387);
  __Pyx_GIVEREF(__pyx_tuple__387);
  __pyx_codeobj__388 = (PyObject*)__Pyx_PyCode_New(2, 0, 5, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__387, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_scratch_remills_flux_xuefzhao_a, __pyx_n_s_write_dotdata_to_file, 1914, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__388)) __PYX_ERR(0, 1914, __pyx_L1_error)

  /* "vapor_vali/Simple_function.pyx":1920
 *     fo.close()
 * 
 * def write_output_initiate(out_name):             # <<<<<<<<<<<<<<
 *     fo=open(out_name,'w')
 *     print('\t'.join(['chr','start','end','SV_description','VaPoR_quality_score','VaPoR_genotype_score','other']), file=fo)
 */
  __pyx_tuple__389 = PyTuple_Pack(2, __pyx_n_s_out_name, __pyx_n_s_fo); if (unlikely(!__pyx_tuple__389)) __PYX_ERR(0, 1920, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__389);
  __Pyx_GIVEREF(__pyx_tuple__389);
  __pyx_codeobj__390 = (PyObject*)__Pyx_PyCode_New(1, 0, 2, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__389, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_scratch_remills_flux_xuefzhao_a, __pyx_n_s_write_output_initiate, 1920, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__390)) __PYX_ERR(0, 1920, __pyx_L1_error)

  /* "vapor_vali/Simple_function.pyx":1925
 *     fo.close()
 * 
 * def write_output_main(out_name,out_list):             # <<<<<<<<<<<<<<
 *     fo=open(out_name,'a')
 *     print('\t'.join([str(i) for i in out_list]), file=fo)
 */
  __pyx_tuple__391 = PyTuple_Pack(4, __pyx_n_s_out_name, __pyx_n_s_out_list, __pyx_n_s_fo, __pyx_n_s_i); if (unlikely(!__pyx_tuple__391)) __PYX_ERR(0, 1925, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__391);
  __Pyx_GIVEREF(__pyx_tuple__391);
  __pyx_codeobj__392 = (PyObject*)__Pyx_PyCode_New(2, 0, 4, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__391, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_scratch_remills_flux_xuefzhao_a, __pyx_n_s_write_output_main, 1925, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__392)) __PYX_ERR(0, 1925, __pyx_L1_error)

  /* "vapor_vali/Simple_function.pyx":1930
 *     fo.close()
 * 
 * def x_to_x_modify_new(x,dup_block_combined):             # <<<<<<<<<<<<<<
 *     x_modify=[[i] for i in list(x)]
 *     block_rec=-1
 */
  __pyx_tuple__393 = PyTuple_Pack(7, __pyx_n_s_x, __pyx_n_s_dup_block_combined, __pyx_n_s_x_modify, __pyx_n_s_block_rec, __pyx_n_s_y, __pyx_n_s_x_modify_new, __pyx_n_s_i); if (unlikely(!__pyx_tuple__393)) __PYX_ERR(0, 1930, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__393);
  __Pyx_GIVEREF(__pyx_tuple__393);
  __pyx_codeobj__394 = (PyObject*)__Pyx_PyCode_New(2, 0, 7, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__393, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_scratch_remills_flux_xuefzhao_a, __pyx_n_s_x_to_x_modify_new, 1930, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__394)) __PYX_ERR(0, 1930, __pyx_L1_error)

  /* "vapor_vali/Simple_function.pyx":1941
 *     return x_modify_new
 * 
 * def X_means_cluster(data_list):             # <<<<<<<<<<<<<<
 *     temp_result=[i for i in k_means_cluster(data_list) if not i==[[],[]]]
 *     if temp_result==[data_list]:
 */
  __pyx_tuple__395 = PyTuple_Pack(4, __pyx_n_s_data_list, __pyx_n_s_temp_result, __pyx_n_s_out, __pyx_n_s_i); if (unlikely(!__pyx_tuple__395)) __PYX_ERR(0, 1941, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__395);
  __Pyx_GIVEREF(__pyx_tuple__395);
  __pyx_codeobj__396 = (PyObject*)__Pyx_PyCode_New(1, 0, 4, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__395, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_scratch_remills_flux_xuefzhao_a, __pyx_n_s_X_means_cluster, 1941, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__396)) __PYX_ERR(0, 1941, __pyx_L1_error)

  /* "vapor_vali/Simple_function.pyx":1951
 *         return out
 * 
 * def X_means_cluster_reformat(data_list):             # <<<<<<<<<<<<<<
 *     out=X_means_cluster(data_list)
 *     out2=[]
 */
  __pyx_tuple__397 = PyTuple_Pack(4, __pyx_n_s_data_list, __pyx_n_s_out, __pyx_n_s_out2, __pyx_n_s_y); if (unlikely(!__pyx_tuple__397)) __PYX_ERR(0, 1951, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__397);
  __Pyx_GIVEREF(__pyx_tuple__397);
  __pyx_codeobj__398 = (PyObject*)__Pyx_PyCode_New(1, 0, 4, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__397, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_scratch_remills_flux_xuefzhao_a, __pyx_n_s_X_means_cluster_reformat, 1951, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__398)) __PYX_ERR(0, 1951, __pyx_L1_error)
  __Pyx_RefNannyFinishContext();
  return 0;
  __pyx_L1_error:;
  __Pyx_RefNannyFinishContext();
  return -1;
}

static int __Pyx_InitGlobals(void) {
  __pyx_umethod_PyDict_Type_keys.type = (PyObject*)&PyDict_Type;
  if (__Pyx_InitStrings(__pyx_string_tab) < 0) __PYX_ERR(0, 1, __pyx_L1_error);
  __pyx_float_0_1 = PyFloat_FromDouble(0.1); if (unlikely(!__pyx_float_0_1)) __PYX_ERR(0, 1, __pyx_L1_error)
  __pyx_float_0_3 = PyFloat_FromDouble(0.3); if (unlikely(!__pyx_float_0_3)) __PYX_ERR(0, 1, __pyx_L1_error)
  __pyx_float_0_4 = PyFloat_FromDouble(0.4); if (unlikely(!__pyx_float_0_4)) __PYX_ERR(0, 1, __pyx_L1_error)
  __pyx_float_0_5 = PyFloat_FromDouble(0.5); if (unlikely(!__pyx_float_0_5)) __PYX_ERR(0, 1, __pyx_L1_error)
  __pyx_float_1_0 = PyFloat_FromDouble(1.0); if (unlikely(!__pyx_float_1_0)) __PYX_ERR(0, 1, __pyx_L1_error)
  __pyx_float_1_1 = PyFloat_FromDouble(1.1); if (unlikely(!__pyx_float_1_1)) __PYX_ERR(0, 1, __pyx_L1_error)
  __pyx_float_2_1 = PyFloat_FromDouble(2.1); if (unlikely(!__pyx_float_2_1)) __PYX_ERR(0, 1, __pyx_L1_error)
  __pyx_float_0_15 = PyFloat_FromDouble(0.15); if (unlikely(!__pyx_float_0_15)) __PYX_ERR(0, 1, __pyx_L1_error)
  __pyx_float_0_16 = PyFloat_FromDouble(0.16); if (unlikely(!__pyx_float_0_16)) __PYX_ERR(0, 1, __pyx_L1_error)
  __pyx_float_10_0 = PyFloat_FromDouble(10.0); if (unlikely(!__pyx_float_10_0)) __PYX_ERR(0, 1, __pyx_L1_error)
  __pyx_float_0_0001 = PyFloat_FromDouble(0.0001); if (unlikely(!__pyx_float_0_0001)) __PYX_ERR(0, 1, __pyx_L1_error)
  __pyx_float_neg_1_0 = PyFloat_FromDouble(-1.0); if (unlikely(!__pyx_float_neg_1_0)) __PYX_ERR(0, 1, __pyx_L1_error)
  __pyx_int_0 = PyInt_FromLong(0); if (unlikely(!__pyx_int_0)) __PYX_ERR(0, 1, __pyx_L1_error)
  __pyx_int_1 = PyInt_FromLong(1); if (unlikely(!__pyx_int_1)) __PYX_ERR(0, 1, __pyx_L1_error)
  __pyx_int_2 = PyInt_FromLong(2); if (unlikely(!__pyx_int_2)) __PYX_ERR(0, 1, __pyx_L1_error)
  __pyx_int_3 = PyInt_FromLong(3); if (unlikely(!__pyx_int_3)) __PYX_ERR(0, 1, __pyx_L1_error)
  __pyx_int_4 = PyInt_FromLong(4); if (unlikely(!__pyx_int_4)) __PYX_ERR(0, 1, __pyx_L1_error)
  __pyx_int_6 = PyInt_FromLong(6); if (unlikely(!__pyx_int_6)) __PYX_ERR(0, 1, __pyx_L1_error)
  __pyx_int_9 = PyInt_FromLong(9); if (unlikely(!__pyx_int_9)) __PYX_ERR(0, 1, __pyx_L1_error)
  __pyx_int_10 = PyInt_FromLong(10); if (unlikely(!__pyx_int_10)) __PYX_ERR(0, 1, __pyx_L1_error)
  __pyx_int_11 = PyInt_FromLong(11); if (unlikely(!__pyx_int_11)) __PYX_ERR(0, 1, __pyx_L1_error)
  __pyx_int_20 = PyInt_FromLong(20); if (unlikely(!__pyx_int_20)) __PYX_ERR(0, 1, __pyx_L1_error)
  __pyx_int_30 = PyInt_FromLong(30); if (unlikely(!__pyx_int_30)) __PYX_ERR(0, 1, __pyx_L1_error)
  __pyx_int_40 = PyInt_FromLong(40); if (unlikely(!__pyx_int_40)) __PYX_ERR(0, 1, __pyx_L1_error)
  __pyx_int_50 = PyInt_FromLong(50); if (unlikely(!__pyx_int_50)) __PYX_ERR(0, 1, __pyx_L1_error)
  __pyx_int_97 = PyInt_FromLong(97); if (unlikely(!__pyx_int_97)) __PYX_ERR(0, 1, __pyx_L1_error)
  __pyx_int_100 = PyInt_FromLong(100); if (unlikely(!__pyx_int_100)) __PYX_ERR(0, 1, __pyx_L1_error)
  __pyx_int_140 = PyInt_FromLong(140); if (unlikely(!__pyx_int_140)) __PYX_ERR(0, 1, __pyx_L1_error)
  __pyx_int_400 = PyInt_FromLong(400); if (unlikely(!__pyx_int_400)) __PYX_ERR(0, 1, __pyx_L1_error)
  __pyx_int_500 = PyInt_FromLong(500); if (unlikely(!__pyx_int_500)) __PYX_ERR(0, 1, __pyx_L1_error)
  __pyx_int_512 = PyInt_FromLong(512); if (unlikely(!__pyx_int_512)) __PYX_ERR(0, 1, __pyx_L1_error)
  __pyx_int_4000 = PyInt_FromLong(4000); if (unlikely(!__pyx_int_4000)) __PYX_ERR(0, 1, __pyx_L1_error)
  __pyx_int_10000 = PyInt_FromLong(10000L); if (unlikely(!__pyx_int_10000)) __PYX_ERR(0, 1, __pyx_L1_error)
  __pyx_int_100000000 = PyInt_FromLong(100000000L); if (unlikely(!__pyx_int_100000000)) __PYX_ERR(0, 1, __pyx_L1_error)
  __pyx_int_100000000000000000000 = PyInt_FromString((char *)"100000000000000000000", 0, 0); if (unlikely(!__pyx_int_100000000000000000000)) __PYX_ERR(0, 1, __pyx_L1_error)
  __pyx_int_neg_1 = PyInt_FromLong(-1); if (unlikely(!__pyx_int_neg_1)) __PYX_ERR(0, 1, __pyx_L1_error)
  return 0;
  __pyx_L1_error:;
  return -1;
}

#if PY_MAJOR_VERSION < 3
PyMODINIT_FUNC initSimple_function(void); /*proto*/
PyMODINIT_FUNC initSimple_function(void)
#else
PyMODINIT_FUNC PyInit_Simple_function(void); /*proto*/
PyMODINIT_FUNC PyInit_Simple_function(void)
#endif
{
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  __Pyx_RefNannyDeclarations
  #if CYTHON_REFNANNY
  __Pyx_RefNanny = __Pyx_RefNannyImportAPI("refnanny");
  if (!__Pyx_RefNanny) {
      PyErr_Clear();
      __Pyx_RefNanny = __Pyx_RefNannyImportAPI("Cython.Runtime.refnanny");
      if (!__Pyx_RefNanny)
          Py_FatalError("failed to import 'refnanny' module");
  }
  #endif
  __Pyx_RefNannySetupContext("PyMODINIT_FUNC PyInit_Simple_function(void)", 0);
  if (__Pyx_check_binary_version() < 0) __PYX_ERR(0, 1, __pyx_L1_error)
  __pyx_empty_tuple = PyTuple_New(0); if (unlikely(!__pyx_empty_tuple)) __PYX_ERR(0, 1, __pyx_L1_error)
  __pyx_empty_bytes = PyBytes_FromStringAndSize("", 0); if (unlikely(!__pyx_empty_bytes)) __PYX_ERR(0, 1, __pyx_L1_error)
  __pyx_empty_unicode = PyUnicode_FromStringAndSize("", 0); if (unlikely(!__pyx_empty_unicode)) __PYX_ERR(0, 1, __pyx_L1_error)
  #ifdef __Pyx_CyFunction_USED
  if (__pyx_CyFunction_init() < 0) __PYX_ERR(0, 1, __pyx_L1_error)
  #endif
  #ifdef __Pyx_FusedFunction_USED
  if (__pyx_FusedFunction_init() < 0) __PYX_ERR(0, 1, __pyx_L1_error)
  #endif
  #ifdef __Pyx_Coroutine_USED
  if (__pyx_Coroutine_init() < 0) __PYX_ERR(0, 1, __pyx_L1_error)
  #endif
  #ifdef __Pyx_Generator_USED
  if (__pyx_Generator_init() < 0) __PYX_ERR(0, 1, __pyx_L1_error)
  #endif
  #ifdef __Pyx_StopAsyncIteration_USED
  if (__pyx_StopAsyncIteration_init() < 0) __PYX_ERR(0, 1, __pyx_L1_error)
  #endif
  /*--- Library function declarations ---*/
  /*--- Threads initialization code ---*/
  #if defined(__PYX_FORCE_INIT_THREADS) && __PYX_FORCE_INIT_THREADS
  #ifdef WITH_THREAD /* Python build with threading support? */
  PyEval_InitThreads();
  #endif
  #endif
  /*--- Module creation code ---*/
  #if PY_MAJOR_VERSION < 3
  __pyx_m = Py_InitModule4("Simple_function", __pyx_methods, 0, 0, PYTHON_API_VERSION); Py_XINCREF(__pyx_m);
  #else
  __pyx_m = PyModule_Create(&__pyx_moduledef);
  #endif
  if (unlikely(!__pyx_m)) __PYX_ERR(0, 1, __pyx_L1_error)
  __pyx_d = PyModule_GetDict(__pyx_m); if (unlikely(!__pyx_d)) __PYX_ERR(0, 1, __pyx_L1_error)
  Py_INCREF(__pyx_d);
  __pyx_b = PyImport_AddModule(__Pyx_BUILTIN_MODULE_NAME); if (unlikely(!__pyx_b)) __PYX_ERR(0, 1, __pyx_L1_error)
  #if CYTHON_COMPILING_IN_PYPY
  Py_INCREF(__pyx_b);
  #endif
  if (PyObject_SetAttrString(__pyx_m, "__builtins__", __pyx_b) < 0) __PYX_ERR(0, 1, __pyx_L1_error);
  /*--- Initialize various global constants etc. ---*/
  if (__Pyx_InitGlobals() < 0) __PYX_ERR(0, 1, __pyx_L1_error)
  #if PY_MAJOR_VERSION < 3 && (__PYX_DEFAULT_STRING_ENCODING_IS_ASCII || __PYX_DEFAULT_STRING_ENCODING_IS_DEFAULT)
  if (__Pyx_init_sys_getdefaultencoding_params() < 0) __PYX_ERR(0, 1, __pyx_L1_error)
  #endif
  if (__pyx_module_is_main_vapor_vali__Simple_function) {
    if (PyObject_SetAttrString(__pyx_m, "__name__", __pyx_n_s_main) < 0) __PYX_ERR(0, 1, __pyx_L1_error)
  }
  #if PY_MAJOR_VERSION >= 3
  {
    PyObject *modules = PyImport_GetModuleDict(); if (unlikely(!modules)) __PYX_ERR(0, 1, __pyx_L1_error)
    if (!PyDict_GetItemString(modules, "vapor_vali.Simple_function")) {
      if (unlikely(PyDict_SetItemString(modules, "vapor_vali.Simple_function", __pyx_m) < 0)) __PYX_ERR(0, 1, __pyx_L1_error)
    }
  }
  #endif
  /*--- Builtin init code ---*/
  if (__Pyx_InitCachedBuiltins() < 0) __PYX_ERR(0, 1, __pyx_L1_error)
  /*--- Constants init code ---*/
  if (__Pyx_InitCachedConstants() < 0) __PYX_ERR(0, 1, __pyx_L1_error)
  /*--- Global init code ---*/
  /*--- Variable export code ---*/
  /*--- Function export code ---*/
  /*--- Type init code ---*/
  if (PyType_Ready(&__pyx_type_10vapor_vali_15Simple_function___pyx_scope_struct__eu_y_vs_x_ratio_calcu) < 0) __PYX_ERR(0, 758, __pyx_L1_error)
  __pyx_type_10vapor_vali_15Simple_function___pyx_scope_struct__eu_y_vs_x_ratio_calcu.tp_print = 0;
  __pyx_ptype_10vapor_vali_15Simple_function___pyx_scope_struct__eu_y_vs_x_ratio_calcu = &__pyx_type_10vapor_vali_15Simple_function___pyx_scope_struct__eu_y_vs_x_ratio_calcu;
  /*--- Type import code ---*/
  /*--- Variable import code ---*/
  /*--- Function import code ---*/
  /*--- Execution code ---*/
  #if defined(__Pyx_Generator_USED) || defined(__Pyx_Coroutine_USED)
  if (__Pyx_patch_abc() < 0) __PYX_ERR(0, 1, __pyx_L1_error)
  #endif

  /* "vapor_vali/Simple_function.pyx":3
 * from __future__ import print_function
 * 
 * import os,sysm,itertools             # <<<<<<<<<<<<<<
 * import matplotlib.pyplot as plt
 * import math,random,numpy,scipy,rpy2
 */
  __pyx_t_1 = __Pyx_Import(__pyx_n_s_os, 0, -1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_os, __pyx_t_1) < 0) __PYX_ERR(0, 3, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_Import(__pyx_n_s_sysm, 0, -1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_sysm, __pyx_t_1) < 0) __PYX_ERR(0, 3, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_Import(__pyx_n_s_itertools, 0, -1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_itertools, __pyx_t_1) < 0) __PYX_ERR(0, 3, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":4
 * 
 * import os,sysm,itertools
 * import matplotlib.pyplot as plt             # <<<<<<<<<<<<<<
 * import math,random,numpy,scipy,rpy2
 * import vapor_vali.plotting as plotting
 */
  __pyx_t_1 = PyList_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_INCREF(__pyx_kp_s__14);
  __Pyx_GIVEREF(__pyx_kp_s__14);
  PyList_SET_ITEM(__pyx_t_1, 0, __pyx_kp_s__14);
  __pyx_t_2 = __Pyx_Import(__pyx_n_s_matplotlib_pyplot, __pyx_t_1, -1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 4, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_plt, __pyx_t_2) < 0) __PYX_ERR(0, 4, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":5
 * import os,sysm,itertools
 * import matplotlib.pyplot as plt
 * import math,random,numpy,scipy,rpy2             # <<<<<<<<<<<<<<
 * import vapor_vali.plotting as plotting
 * import scipy.stats
 */
  __pyx_t_2 = __Pyx_Import(__pyx_n_s_math, 0, -1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 5, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_math, __pyx_t_2) < 0) __PYX_ERR(0, 5, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = __Pyx_Import(__pyx_n_s_random, 0, -1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 5, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_random, __pyx_t_2) < 0) __PYX_ERR(0, 5, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = __Pyx_Import(__pyx_n_s_numpy, 0, -1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 5, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_numpy, __pyx_t_2) < 0) __PYX_ERR(0, 5, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = __Pyx_Import(__pyx_n_s_scipy, 0, -1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 5, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_scipy, __pyx_t_2) < 0) __PYX_ERR(0, 5, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = __Pyx_Import(__pyx_n_s_rpy2, 0, -1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 5, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_rpy2, __pyx_t_2) < 0) __PYX_ERR(0, 5, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":6
 * import matplotlib.pyplot as plt
 * import math,random,numpy,scipy,rpy2
 * import vapor_vali.plotting as plotting             # <<<<<<<<<<<<<<
 * import scipy.stats
 * import scipy.optimize
 */
  __pyx_t_2 = PyList_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 6, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_INCREF(__pyx_kp_s__14);
  __Pyx_GIVEREF(__pyx_kp_s__14);
  PyList_SET_ITEM(__pyx_t_2, 0, __pyx_kp_s__14);
  __pyx_t_1 = __Pyx_Import(__pyx_n_s_vapor_vali_plotting, __pyx_t_2, -1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 6, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_plotting, __pyx_t_1) < 0) __PYX_ERR(0, 6, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":7
 * import math,random,numpy,scipy,rpy2
 * import vapor_vali.plotting as plotting
 * import scipy.stats             # <<<<<<<<<<<<<<
 * import scipy.optimize
 * import numpy as np
 */
  __pyx_t_1 = __Pyx_Import(__pyx_n_s_scipy_stats, 0, -1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 7, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_scipy, __pyx_t_1) < 0) __PYX_ERR(0, 7, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":8
 * import vapor_vali.plotting as plotting
 * import scipy.stats
 * import scipy.optimize             # <<<<<<<<<<<<<<
 * import numpy as np
 * from rpy2.robjects.packages import importr
 */
  __pyx_t_1 = __Pyx_Import(__pyx_n_s_scipy_optimize, 0, -1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 8, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_scipy, __pyx_t_1) < 0) __PYX_ERR(0, 8, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":9
 * import scipy.stats
 * import scipy.optimize
 * import numpy as np             # <<<<<<<<<<<<<<
 * from rpy2.robjects.packages import importr
 * from rpy2.robjects.vectors import IntVector, FloatVector, StrVector
 */
  __pyx_t_1 = __Pyx_Import(__pyx_n_s_numpy, 0, -1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 9, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_np, __pyx_t_1) < 0) __PYX_ERR(0, 9, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":10
 * import scipy.optimize
 * import numpy as np
 * from rpy2.robjects.packages import importr             # <<<<<<<<<<<<<<
 * from rpy2.robjects.vectors import IntVector, FloatVector, StrVector
 * from scipy.cluster.vq import vq, kmeans, whiten
 */
  __pyx_t_1 = PyList_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 10, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_INCREF(__pyx_n_s_importr);
  __Pyx_GIVEREF(__pyx_n_s_importr);
  PyList_SET_ITEM(__pyx_t_1, 0, __pyx_n_s_importr);
  __pyx_t_2 = __Pyx_Import(__pyx_n_s_rpy2_robjects_packages, __pyx_t_1, -1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 10, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_ImportFrom(__pyx_t_2, __pyx_n_s_importr); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 10, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_importr, __pyx_t_1) < 0) __PYX_ERR(0, 10, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":11
 * import numpy as np
 * from rpy2.robjects.packages import importr
 * from rpy2.robjects.vectors import IntVector, FloatVector, StrVector             # <<<<<<<<<<<<<<
 * from scipy.cluster.vq import vq, kmeans, whiten
 * from scipy import stats
 */
  __pyx_t_2 = PyList_New(3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 11, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_INCREF(__pyx_n_s_IntVector);
  __Pyx_GIVEREF(__pyx_n_s_IntVector);
  PyList_SET_ITEM(__pyx_t_2, 0, __pyx_n_s_IntVector);
  __Pyx_INCREF(__pyx_n_s_FloatVector);
  __Pyx_GIVEREF(__pyx_n_s_FloatVector);
  PyList_SET_ITEM(__pyx_t_2, 1, __pyx_n_s_FloatVector);
  __Pyx_INCREF(__pyx_n_s_StrVector);
  __Pyx_GIVEREF(__pyx_n_s_StrVector);
  PyList_SET_ITEM(__pyx_t_2, 2, __pyx_n_s_StrVector);
  __pyx_t_1 = __Pyx_Import(__pyx_n_s_rpy2_robjects_vectors, __pyx_t_2, -1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 11, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = __Pyx_ImportFrom(__pyx_t_1, __pyx_n_s_IntVector); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 11, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_IntVector, __pyx_t_2) < 0) __PYX_ERR(0, 11, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = __Pyx_ImportFrom(__pyx_t_1, __pyx_n_s_FloatVector); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 11, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_FloatVector, __pyx_t_2) < 0) __PYX_ERR(0, 11, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = __Pyx_ImportFrom(__pyx_t_1, __pyx_n_s_StrVector); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 11, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_StrVector, __pyx_t_2) < 0) __PYX_ERR(0, 11, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":12
 * from rpy2.robjects.packages import importr
 * from rpy2.robjects.vectors import IntVector, FloatVector, StrVector
 * from scipy.cluster.vq import vq, kmeans, whiten             # <<<<<<<<<<<<<<
 * from scipy import stats
 * from scipy.stats import linregress
 */
  __pyx_t_1 = PyList_New(3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 12, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_INCREF(__pyx_n_s_vq);
  __Pyx_GIVEREF(__pyx_n_s_vq);
  PyList_SET_ITEM(__pyx_t_1, 0, __pyx_n_s_vq);
  __Pyx_INCREF(__pyx_n_s_kmeans);
  __Pyx_GIVEREF(__pyx_n_s_kmeans);
  PyList_SET_ITEM(__pyx_t_1, 1, __pyx_n_s_kmeans);
  __Pyx_INCREF(__pyx_n_s_whiten);
  __Pyx_GIVEREF(__pyx_n_s_whiten);
  PyList_SET_ITEM(__pyx_t_1, 2, __pyx_n_s_whiten);
  __pyx_t_2 = __Pyx_Import(__pyx_n_s_scipy_cluster_vq, __pyx_t_1, -1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 12, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_ImportFrom(__pyx_t_2, __pyx_n_s_vq); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 12, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_vq, __pyx_t_1) < 0) __PYX_ERR(0, 12, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_ImportFrom(__pyx_t_2, __pyx_n_s_kmeans); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 12, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_kmeans, __pyx_t_1) < 0) __PYX_ERR(0, 12, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_ImportFrom(__pyx_t_2, __pyx_n_s_whiten); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 12, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_whiten, __pyx_t_1) < 0) __PYX_ERR(0, 12, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":13
 * from rpy2.robjects.vectors import IntVector, FloatVector, StrVector
 * from scipy.cluster.vq import vq, kmeans, whiten
 * from scipy import stats             # <<<<<<<<<<<<<<
 * from scipy.stats import linregress
 * from scipy.spatial import distance
 */
  __pyx_t_2 = PyList_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 13, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_INCREF(__pyx_n_s_stats);
  __Pyx_GIVEREF(__pyx_n_s_stats);
  PyList_SET_ITEM(__pyx_t_2, 0, __pyx_n_s_stats);
  __pyx_t_1 = __Pyx_Import(__pyx_n_s_scipy, __pyx_t_2, -1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 13, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = __Pyx_ImportFrom(__pyx_t_1, __pyx_n_s_stats); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 13, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_stats, __pyx_t_2) < 0) __PYX_ERR(0, 13, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":14
 * from scipy.cluster.vq import vq, kmeans, whiten
 * from scipy import stats
 * from scipy.stats import linregress             # <<<<<<<<<<<<<<
 * from scipy.spatial import distance
 * from sklearn import cluster
 */
  __pyx_t_1 = PyList_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 14, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_INCREF(__pyx_n_s_linregress);
  __Pyx_GIVEREF(__pyx_n_s_linregress);
  PyList_SET_ITEM(__pyx_t_1, 0, __pyx_n_s_linregress);
  __pyx_t_2 = __Pyx_Import(__pyx_n_s_scipy_stats, __pyx_t_1, -1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 14, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_ImportFrom(__pyx_t_2, __pyx_n_s_linregress); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 14, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_linregress, __pyx_t_1) < 0) __PYX_ERR(0, 14, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":15
 * from scipy import stats
 * from scipy.stats import linregress
 * from scipy.spatial import distance             # <<<<<<<<<<<<<<
 * from sklearn import cluster
 * global invert_base
 */
  __pyx_t_2 = PyList_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 15, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_INCREF(__pyx_n_s_distance);
  __Pyx_GIVEREF(__pyx_n_s_distance);
  PyList_SET_ITEM(__pyx_t_2, 0, __pyx_n_s_distance);
  __pyx_t_1 = __Pyx_Import(__pyx_n_s_scipy_spatial, __pyx_t_2, -1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 15, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = __Pyx_ImportFrom(__pyx_t_1, __pyx_n_s_distance); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 15, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_distance, __pyx_t_2) < 0) __PYX_ERR(0, 15, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "vapor_vali/Simple_function.pyx":16
 * from scipy.stats import linregress
 * from scipy.spatial import distance
 * from sklearn import cluster             # <<<<<<<<<<<<<<
 * global invert_base
 * invert_base = { 'A' : 'T', 'T' : 'A', 'C' : 'G', 'G' : 'C','N' : 'N','a' : 't', 't' : 'a', 'c' : 'g', 'g' : 'c','n' : 'n'}
 */
  __pyx_t_1 = PyList_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 16, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_INCREF(__pyx_n_s_cluster);
  __Pyx_GIVEREF(__pyx_n_s_cluster);
  PyList_SET_ITEM(__pyx_t_1, 0, __pyx_n_s_cluster);
  __pyx_t_2 = __Pyx_Import(__pyx_n_s_sklearn, __pyx_t_1, -1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 16, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_ImportFrom(__pyx_t_2, __pyx_n_s_cluster); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 16, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_cluster, __pyx_t_1) < 0) __PYX_ERR(0, 16, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":18
 * from sklearn import cluster
 * global invert_base
 * invert_base = { 'A' : 'T', 'T' : 'A', 'C' : 'G', 'G' : 'C','N' : 'N','a' : 't', 't' : 'a', 'c' : 'g', 'g' : 'c','n' : 'n'}             # <<<<<<<<<<<<<<
 * global default_flank_length
 * default_flank_length=500
 */
  __pyx_t_2 = PyDict_New(); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 18, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_A, __pyx_n_s_T) < 0) __PYX_ERR(0, 18, __pyx_L1_error)
  if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_T, __pyx_n_s_A) < 0) __PYX_ERR(0, 18, __pyx_L1_error)
  if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_C, __pyx_n_s_G) < 0) __PYX_ERR(0, 18, __pyx_L1_error)
  if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_G, __pyx_n_s_C) < 0) __PYX_ERR(0, 18, __pyx_L1_error)
  if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_N, __pyx_n_s_N) < 0) __PYX_ERR(0, 18, __pyx_L1_error)
  if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_a, __pyx_n_s_t) < 0) __PYX_ERR(0, 18, __pyx_L1_error)
  if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_t, __pyx_n_s_a) < 0) __PYX_ERR(0, 18, __pyx_L1_error)
  if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_c, __pyx_n_s_g) < 0) __PYX_ERR(0, 18, __pyx_L1_error)
  if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_g, __pyx_n_s_c) < 0) __PYX_ERR(0, 18, __pyx_L1_error)
  if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_n, __pyx_n_s_n) < 0) __PYX_ERR(0, 18, __pyx_L1_error)
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_invert_base, __pyx_t_2) < 0) __PYX_ERR(0, 18, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":20
 * invert_base = { 'A' : 'T', 'T' : 'A', 'C' : 'G', 'G' : 'C','N' : 'N','a' : 't', 't' : 'a', 'c' : 'g', 'g' : 'c','n' : 'n'}
 * global default_flank_length
 * default_flank_length=500             # <<<<<<<<<<<<<<
 * global default_read_length
 * default_read_length=4000    #average length of pacbio read
 */
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_default_flank_length, __pyx_int_500) < 0) __PYX_ERR(0, 20, __pyx_L1_error)

  /* "vapor_vali/Simple_function.pyx":22
 * default_flank_length=500
 * global default_read_length
 * default_read_length=4000    #average length of pacbio read             # <<<<<<<<<<<<<<
 * global default_max_sv_test
 * default_max_sv_test=10000 #when size of a sv block excessed default_max_sv_test, try junctions instead of event
 */
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_default_read_length, __pyx_int_4000) < 0) __PYX_ERR(0, 22, __pyx_L1_error)

  /* "vapor_vali/Simple_function.pyx":24
 * default_read_length=4000    #average length of pacbio read
 * global default_max_sv_test
 * default_max_sv_test=10000 #when size of a sv block excessed default_max_sv_test, try junctions instead of event             # <<<<<<<<<<<<<<
 * 
 * def alt_seq_readin(ref,info,flank_length):
 */
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_default_max_sv_test, __pyx_int_10000) < 0) __PYX_ERR(0, 24, __pyx_L1_error)

  /* "vapor_vali/Simple_function.pyx":26
 * default_max_sv_test=10000 #when size of a sv block excessed default_max_sv_test, try junctions instead of event
 * 
 * def alt_seq_readin(ref,info,flank_length):             # <<<<<<<<<<<<<<
 *     #eg of info=('abcde/abcde', 'db/db', '1', '14436355', '14436655', '14437075', '14438241', '14438566', '14438940']
 *     block_hash={}
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_10vapor_vali_15Simple_function_1alt_seq_readin, NULL, __pyx_n_s_vapor_vali_Simple_function); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 26, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_alt_seq_readin, __pyx_t_2) < 0) __PYX_ERR(0, 26, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":67
 *         return [out[0],out[0]]
 * 
 * def bam_in_decide(bam_in,bps):             # <<<<<<<<<<<<<<
 *     if os.path.isfile(bam_in):
 *         return [bam_in]
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_10vapor_vali_15Simple_function_3bam_in_decide, NULL, __pyx_n_s_vapor_vali_Simple_function); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 67, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_bam_in_decide, __pyx_t_2) < 0) __PYX_ERR(0, 67, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":89
 *         return temp_bam_in
 * 
 * def block_around_check(alt_allele,ref_allele):             # <<<<<<<<<<<<<<
 *     #eg of alt_allele='abcab'  eg of ref_allele='abcd'
 *     alt_juncs=[[['-']+letter_split(alt_allele)+['+']][0][j:j+2] for j in range(len(letter_split(alt_allele))+1)]
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_10vapor_vali_15Simple_function_5block_around_check, NULL, __pyx_n_s_vapor_vali_Simple_function); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 89, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_block_around_check, __pyx_t_2) < 0) __PYX_ERR(0, 89, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":96
 *     return new_juncs
 * 
 * def bp_to_chr_hash(bps,chromos,flank_length=500):             # <<<<<<<<<<<<<<
 *     #eg of bps=['chr16', '34910548', '34911339', '34913149', '34913438', '36181068', '36181482']
 *     temp1=[]
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_10vapor_vali_15Simple_function_7bp_to_chr_hash, NULL, __pyx_n_s_vapor_vali_Simple_function); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 96, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_bp_to_chr_hash, __pyx_t_2) < 0) __PYX_ERR(0, 96, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":114
 *     return out
 * 
 * def bp_to_block_len(bp_info):             # <<<<<<<<<<<<<<
 *     #eg of bp_info=['chr1',127906515, 127907283, 127907399]
 *     out={}
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_10vapor_vali_15Simple_function_9bp_to_block_len, NULL, __pyx_n_s_vapor_vali_Simple_function); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 114, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_bp_to_block_len, __pyx_t_2) < 0) __PYX_ERR(0, 114, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":121
 *     return out
 * 
 * def block_modify(block,chromos):             # <<<<<<<<<<<<<<
 *     #eg of block=['chr16', '34911339', '34913149', 'chr16', '34913149', '34913438']
 *     out=[]
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_10vapor_vali_15Simple_function_11block_modify, NULL, __pyx_n_s_vapor_vali_Simple_function); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 121, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_block_modify, __pyx_t_2) < 0) __PYX_ERR(0, 121, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":145
 *     return out_new_2
 * 
 * def block_subsplot(bp_list,chromos):             # <<<<<<<<<<<<<<
 *     #eg of bp_list=['chr1', '9061390', '9061470', 'chr14', '93246136', '93248034']
 *     out=[]
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_10vapor_vali_15Simple_function_13block_subsplot, NULL, __pyx_n_s_vapor_vali_Simple_function); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 145, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_block_subsplot, __pyx_t_2) < 0) __PYX_ERR(0, 145, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":153
 *     return out
 * 
 * def calcu_log10(x):             # <<<<<<<<<<<<<<
 *     if x==0:
 *         return 0
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_10vapor_vali_15Simple_function_15calcu_log10, NULL, __pyx_n_s_vapor_vali_Simple_function); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 153, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_calcu_log10, __pyx_t_2) < 0) __PYX_ERR(0, 153, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":159
 *         return np.log10(x)
 * 
 * def calcu_vapor_single_read_score_abs_dis_m1(ref_seq,alt_seq,x,window_size):             # <<<<<<<<<<<<<<
 *     ref_dotdata=dotdata(window_size,x[0],ref_seq[x[1]:])
 *     alt_dotdata=dotdata(window_size,x[0],alt_seq[x[1]:])
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_10vapor_vali_15Simple_function_17calcu_vapor_single_read_score_abs_dis_m1, NULL, __pyx_n_s_vapor_vali_Simple_function); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 159, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_calcu_vapor_single_read_score_ab_2, __pyx_t_2) < 0) __PYX_ERR(0, 159, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":178
 *         return [0,0]
 * 
 * def calcu_vapor_single_read_score_abs_dis_m1b(ref_seq,alt_seq,x,window_size):             # <<<<<<<<<<<<<<
 *     ref_dotdata=dotdata(window_size,x[0],ref_seq[x[1]:])
 *     alt_dotdata=dotdata(window_size,x[0],alt_seq[x[1]:])
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_10vapor_vali_15Simple_function_19calcu_vapor_single_read_score_abs_dis_m1b, NULL, __pyx_n_s_vapor_vali_Simple_function); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 178, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_calcu_vapor_single_read_score_ab, __pyx_t_2) < 0) __PYX_ERR(0, 178, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":199
 *         return [0,0]
 * 
 * def calcu_vapor_single_read_score_directed_dis_m1b(ref_seq,alt_seq,x,window_size):             # <<<<<<<<<<<<<<
 *     ref_dotdata=dotdata(window_size,x[0],ref_seq[x[1]:])
 *     alt_dotdata=dotdata(window_size,x[0],alt_seq[x[1]:])
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_10vapor_vali_15Simple_function_21calcu_vapor_single_read_score_directed_dis_m1b, NULL, __pyx_n_s_vapor_vali_Simple_function); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 199, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_calcu_vapor_single_read_score_di_2, __pyx_t_2) < 0) __PYX_ERR(0, 199, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":221
 *         return [0,0]
 * 
 * def calcu_vapor_single_read_score_directed_dis_m1b_not_really(ref_seq,alt_seq,x,window_size,ref_bps,alt_bps):             # <<<<<<<<<<<<<<
 *     ref_dotdata=dotdata(window_size,x[0],ref_seq[x[1]:])
 *     alt_dotdata=dotdata(window_size,x[0],alt_seq[x[1]:])
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_10vapor_vali_15Simple_function_23calcu_vapor_single_read_score_directed_dis_m1b_not_really, NULL, __pyx_n_s_vapor_vali_Simple_function); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 221, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_calcu_vapor_single_read_score_di_3, __pyx_t_2) < 0) __PYX_ERR(0, 221, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":235
 *         return [0,0]
 * 
 * def calcu_vapor_single_read_score_directed_dis_m1b_redefine_diagnal(ref_seq,alt_seq,x,window_size):             # <<<<<<<<<<<<<<
 *     ref_dotdata=dotdata(window_size,x[0],ref_seq[x[1]:])
 *     alt_dotdata=dotdata(window_size,x[0],alt_seq[x[1]:])
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_10vapor_vali_15Simple_function_25calcu_vapor_single_read_score_directed_dis_m1b_redefine_diagnal, NULL, __pyx_n_s_vapor_vali_Simple_function); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 235, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_calcu_vapor_single_read_score_di, __pyx_t_2) < 0) __PYX_ERR(0, 235, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":253
 *         return [0,0]
 * 
 * def calcu_vapor_single_read_score_directed_dis_m1b_maybe(ref_seq,alt_seq,x,window_size,dup_block_bps):             # <<<<<<<<<<<<<<
 *     #ref_ref_dotdata=dotdata(window_size,ref_seq[x[1]:],ref_seq[x[1]:])
 *     #alt_alt_dotdata=dotdata(window_size,alt_seq[x[1]:],alt_seq[x[1]:])
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_10vapor_vali_15Simple_function_27calcu_vapor_single_read_score_directed_dis_m1b_maybe, NULL, __pyx_n_s_vapor_vali_Simple_function); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 253, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_calcu_vapor_single_read_score_di_4, __pyx_t_2) < 0) __PYX_ERR(0, 253, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":271
 *         return [0,0]
 * 
 * def calcu_vapor_single_read_score_within_10Perc_m1b(ref_seq,alt_seq,x,window_size):             # <<<<<<<<<<<<<<
 *     ref_dotdata=dotdata(window_size,x[0],ref_seq[x[1]:])
 *     alt_dotdata=dotdata(window_size,x[0],alt_seq[x[1]:])
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_10vapor_vali_15Simple_function_29calcu_vapor_single_read_score_within_10Perc_m1b, NULL, __pyx_n_s_vapor_vali_Simple_function); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 271, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_calcu_vapor_single_read_score_wi, __pyx_t_2) < 0) __PYX_ERR(0, 271, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":290
 *         return [0,0]
 * 
 * def calcu_vapor_single_read_score_abs_dis_m2(ref_seq,alt_seq,x,window_size):             # <<<<<<<<<<<<<<
 *     ref_dotdata=dotdata(window_size,x[0],ref_seq[x[1]:])
 *     alt_dotdata=dotdata(window_size,x[0],alt_seq[x[1]:])
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_10vapor_vali_15Simple_function_31calcu_vapor_single_read_score_abs_dis_m2, NULL, __pyx_n_s_vapor_vali_Simple_function); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 290, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_calcu_vapor_single_read_score_ab_3, __pyx_t_2) < 0) __PYX_ERR(0, 290, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":303
 *         return [0,0]
 * 
 * def cigar2alignstart_by_pos(cigar,align_start,start,end):             # <<<<<<<<<<<<<<
 *     #eg cigar2alignstart(pbam[5],int(pbam[3]),bps)
 *     import re
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_10vapor_vali_15Simple_function_33cigar2alignstart_by_pos, NULL, __pyx_n_s_vapor_vali_Simple_function); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 303, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_cigar2alignstart_by_pos, __pyx_t_2) < 0) __PYX_ERR(0, 303, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":333
 *         return [read_rec,start_dis]
 * 
 * def chop_pacbio_read_by_pos(bam_in_new,chrom,start,end,flank_length):             # <<<<<<<<<<<<<<
 *     fbam=os.popen(r'''samtools view %s %s:%d-%d'''%(bam_in_new,chrom,start,end))
 *     out=[]
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_10vapor_vali_15Simple_function_35chop_pacbio_read_by_pos, NULL, __pyx_n_s_vapor_vali_Simple_function); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 333, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_chop_pacbio_read_by_pos, __pyx_t_2) < 0) __PYX_ERR(0, 333, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":350
 *     return out
 * 
 * def chromos_readin(ref):             # <<<<<<<<<<<<<<
 *     fin=open(ref+'.fai')
 *     chromos=[]
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_10vapor_vali_15Simple_function_37chromos_readin, NULL, __pyx_n_s_vapor_vali_Simple_function); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 350, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_chromos_readin, __pyx_t_2) < 0) __PYX_ERR(0, 350, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":359
 *     return chromos
 * 
 * def chr_start_end_extract(pin):             # <<<<<<<<<<<<<<
 *     out=[pin[0],int(pin[1])]
 *     for x in pin[7].split(';'):
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_10vapor_vali_15Simple_function_39chr_start_end_extract, NULL, __pyx_n_s_vapor_vali_Simple_function); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 359, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_chr_start_end_extract, __pyx_t_2) < 0) __PYX_ERR(0, 359, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":366
 *     return out
 * 
 * def cluster_range_decide(other_cluster):             # <<<<<<<<<<<<<<
 *     out=[]
 *     for x in other_cluster:
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_10vapor_vali_15Simple_function_41cluster_range_decide, NULL, __pyx_n_s_vapor_vali_Simple_function); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 366, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_cluster_range_decide, __pyx_t_2) < 0) __PYX_ERR(0, 366, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":374
 *     return out
 * 
 * def cluster_size_decide(range_cluster):             # <<<<<<<<<<<<<<
 *     out=[]
 *     for x in range_cluster:
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_10vapor_vali_15Simple_function_43cluster_size_decide, NULL, __pyx_n_s_vapor_vali_Simple_function); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 374, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_cluster_size_decide, __pyx_t_2) < 0) __PYX_ERR(0, 374, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":381
 *     return out
 * 
 * def clean_dotdata_m1(ref_dotdata):             # <<<<<<<<<<<<<<
 *     #cluster dots based on their distance to diagnal
 *     x_axis=[i[0] for i in ref_dotdata]
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_10vapor_vali_15Simple_function_45clean_dotdata_m1, NULL, __pyx_n_s_vapor_vali_Simple_function); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 381, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_clean_dotdata_m1, __pyx_t_2) < 0) __PYX_ERR(0, 381, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":398
 *     return [out,kept_region]
 * 
 * def clean_dotdata_diagnal_m1b(ref_dotdata):             # <<<<<<<<<<<<<<
 *     #cluster dots based on their distance to diagnal
 *     if ref_dotdata==[]:    return [[],[]]
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_10vapor_vali_15Simple_function_47clean_dotdata_diagnal_m1b, NULL, __pyx_n_s_vapor_vali_Simple_function); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 398, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_clean_dotdata_diagnal_m1b, __pyx_t_2) < 0) __PYX_ERR(0, 398, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":412
 *     return [kept_dot,kept_region]
 * 
 * def clean_dotdata_anti_diagnal_m1b(ref_dotdata):             # <<<<<<<<<<<<<<
 *     #cluster dots based on their distance to diagnal
 *     if ref_dotdata==[]:    return [[],[]]
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_10vapor_vali_15Simple_function_49clean_dotdata_anti_diagnal_m1b, NULL, __pyx_n_s_vapor_vali_Simple_function); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 412, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_clean_dotdata_anti_diagnal_m1b, __pyx_t_2) < 0) __PYX_ERR(0, 412, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":426
 *     return [kept_dot,kept_region]
 * 
 * def clean_dotdata_diagnal_and_anti_diagnal(ref_dotdata):             # <<<<<<<<<<<<<<
 *     if ref_dotdata==[]:    return [[],[]]
 *     x_axis=[i[0] for i in ref_dotdata]
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_10vapor_vali_15Simple_function_51clean_dotdata_diagnal_and_anti_diagnal, NULL, __pyx_n_s_vapor_vali_Simple_function); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 426, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_clean_dotdata_diagnal_and_anti_d, __pyx_t_2) < 0) __PYX_ERR(0, 426, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":444
 *     return kept_dot
 * 
 * def clean_dotdata_x_and_y(list_dotdata):             # <<<<<<<<<<<<<<
 *     [kept_dot_x,removed_dot_x]=dis_cluster_2([i[0] for i in list_dotdata],dis_cff=10)
 *     kept_list=[]
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_10vapor_vali_15Simple_function_53clean_dotdata_x_and_y, NULL, __pyx_n_s_vapor_vali_Simple_function); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 444, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_clean_dotdata_x_and_y, __pyx_t_2) < 0) __PYX_ERR(0, 444, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":455
 *     return out_list
 * 
 * def clean_dotdata_m2(ref_dotdata):             # <<<<<<<<<<<<<<
 *     #keep dots closest to diagnal
 *     data_hash={}
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_10vapor_vali_15Simple_function_55clean_dotdata_m2, NULL, __pyx_n_s_vapor_vali_Simple_function); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 455, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_clean_dotdata_m2, __pyx_t_2) < 0) __PYX_ERR(0, 455, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":465
 *     return out
 * 
 * def complementary(seq):             # <<<<<<<<<<<<<<
 *     seq2=[]
 *     for i in seq:
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_10vapor_vali_15Simple_function_57complementary, NULL, __pyx_n_s_vapor_vali_Simple_function); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 465, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_complementary, __pyx_t_2) < 0) __PYX_ERR(0, 465, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":474
 *     return ''.join(seq2)
 * 
 * def compute_bic(kmeans,X):             # <<<<<<<<<<<<<<
 *     """
 *     Computes the BIC metric for a given clusters
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_10vapor_vali_15Simple_function_59compute_bic, NULL, __pyx_n_s_vapor_vali_Simple_function); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 474, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_compute_bic, __pyx_t_2) < 0) __PYX_ERR(0, 474, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":509
 *     return(BIC)
 * 
 * def dup_inv_ref_alt_bps_produce(sv_info,flank_length,alt_structure):             # <<<<<<<<<<<<<<
 *     bp_info=sorted(sv_info[1:3]+[sv_info[4]])
 *     block_len=bp_to_block_len([sv_info[0]]+bp_info)
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_10vapor_vali_15Simple_function_61dup_inv_ref_alt_bps_produce, NULL, __pyx_n_s_vapor_vali_Simple_function); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 509, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_dup_inv_ref_alt_bps_produce, __pyx_t_2) < 0) __PYX_ERR(0, 509, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":519
 *     return [ref_bps,alt_bps]
 * 
 * def dup_inv_dup_bps_produce(sv_info,flank_length,alt_structure):             # <<<<<<<<<<<<<<
 *     [ref_bps,alt_bps]=dup_inv_ref_alt_bps_produce(sv_info,flank_length,alt_structure)
 *     alt_bps_new=[i-alt_bps[0] for i in alt_bps]
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_10vapor_vali_15Simple_function_63dup_inv_dup_bps_produce, NULL, __pyx_n_s_vapor_vali_Simple_function); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 519, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_dup_inv_dup_bps_produce, __pyx_t_2) < 0) __PYX_ERR(0, 519, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":527
 *         return [alt_bps_new[1:3],alt_bps_new[3:5]]
 * 
 * def dotdata(kmerlen,seq1, seq2):             # <<<<<<<<<<<<<<
 *     nth_base = 1
 *     inversions = True
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_10vapor_vali_15Simple_function_65dotdata, NULL, __pyx_n_s_vapor_vali_Simple_function); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 527, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_dotdata, __pyx_t_2) < 0) __PYX_ERR(0, 527, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":533
 *     return hits
 * 
 * def dis_cluster(dis_to_diagnal,dis_cff=10):             # <<<<<<<<<<<<<<
 *     #eg of dis_list=[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 683, 854, 0, 683, 854, 0, 683, 854, 0, 683, 854, 0, 683, 0, 683, 0, 683, 0, 683, 0, 341, 512, 683, 0, 341, 512, 683, 0, 341, 512, 683, 0, 341, 512, 683, 1025, 0, 341, 512, 683, 1025, 0, 170, 341, 512, 683, 1025, 0, 170, 341, 683, 854, 1025, 0, 170, 683, 854, 1025, 0, 683, 1025, 0, 0, 0, 0, 0, 0, 0, 0, 512, 0, 512, 0, 512, 1196, 0, 170, 341, 512, 854, 1196, 1367, 0, 170, 341, 512, 854, 1196, 1367, 0]
 *     sorted_list=sorted(dis_to_diagnal)
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_10vapor_vali_15Simple_function_67dis_cluster, NULL, __pyx_n_s_vapor_vali_Simple_function); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 533, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_dis_cluster, __pyx_t_2) < 0) __PYX_ERR(0, 533, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":548
 *     return [[i for i in range(len(dis_to_diagnal)) if dis_to_diagnal[i] in j] for j in remove_noise_1]
 * 
 * def dis_cluster_2(dis_to_diagnal,dis_cff=10):             # <<<<<<<<<<<<<<
 *     #eg of dis_list=[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 683, 854, 0, 683, 854, 0, 683, 854, 0, 683, 854, 0, 683, 0, 683, 0, 683, 0, 683, 0, 341, 512, 683, 0, 341, 512, 683, 0, 341, 512, 683, 0, 341, 512, 683, 1025, 0, 341, 512, 683, 1025, 0, 170, 341, 512, 683, 1025, 0, 170, 341, 683, 854, 1025, 0, 170, 683, 854, 1025, 0, 683, 1025, 0, 0, 0, 0, 0, 0, 0, 0, 512, 0, 512, 0, 512, 1196, 0, 170, 341, 512, 854, 1196, 1367, 0, 170, 341, 512, 854, 1196, 1367, 0]
 *     sorted_list=sorted(dis_to_diagnal)
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_10vapor_vali_15Simple_function_69dis_cluster_2, NULL, __pyx_n_s_vapor_vali_Simple_function); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 548, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_dis_cluster_2, __pyx_t_2) < 0) __PYX_ERR(0, 548, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":564
 *     return [out1,out2]
 * 
 * def dis_to_diagnal_most_abundant_defined(alt_clean_dotdata):             # <<<<<<<<<<<<<<
 *     dis_to_diagnal_list=[i[1]-i[0] for i in alt_clean_dotdata]
 *     dis_range=[min(dis_to_diagnal_list)+i*float(max(dis_to_diagnal_list)-min(dis_to_diagnal_list))/10.0 for i in range(11)]
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_10vapor_vali_15Simple_function_71dis_to_diagnal_most_abundant_defined, NULL, __pyx_n_s_vapor_vali_Simple_function); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 564, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_dis_to_diagnal_most_abundant_def, __pyx_t_2) < 0) __PYX_ERR(0, 564, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":575
 *     else:                   return 0
 * 
 * def dot_to_line(list_dotdata,gap=50,length=10):             # <<<<<<<<<<<<<<
 *     ####This function try to recognize lines in the dot plot
 *     dis_to_diagnal=[i[1]-i[0] for i in list_dotdata]
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_10vapor_vali_15Simple_function_73dot_to_line, NULL, __pyx_n_s_vapor_vali_Simple_function); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 575, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_dot_to_line, __pyx_t_2) < 0) __PYX_ERR(0, 575, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":588
 *     return [[i[0],i[-1]] for i in out]
 * 
 * def dup_block_combine(dup_block,k1_hap,k2_hap):             # <<<<<<<<<<<<<<
 *     #eg of dup_block=['a', 'b'];     k1_hap='abcd'   ; k2_hap='abab'
 *     all_combines=[]
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_10vapor_vali_15Simple_function_75dup_block_combine, NULL, __pyx_n_s_vapor_vali_Simple_function); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 588, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_dup_block_combine, __pyx_t_2) < 0) __PYX_ERR(0, 588, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":600
 *     return dup_block_kept_qc(kept_dup)[::-1]
 * 
 * def dup_block_combined_qc(all_combines):             # <<<<<<<<<<<<<<
 *     #eg of all_combines=['a', 'b', 'c', 'd', 'ab', 'ac', 'ad', 'bc', 'bd', 'cd', 'abc', 'abd', 'acd', 'bcd', 'abcd']
 *     out=[]
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_10vapor_vali_15Simple_function_77dup_block_combined_qc, NULL, __pyx_n_s_vapor_vali_Simple_function); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 600, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_dup_block_combined_qc, __pyx_t_2) < 0) __PYX_ERR(0, 600, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":611
 *     return out
 * 
 * def dup_block_kept_qc(kept_dup):             # <<<<<<<<<<<<<<
 *     #eg of kept_dup:
 *     out=[]
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_10vapor_vali_15Simple_function_79dup_block_kept_qc, NULL, __pyx_n_s_vapor_vali_Simple_function); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 611, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_dup_block_kept_qc, __pyx_t_2) < 0) __PYX_ERR(0, 611, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":623
 *     return out
 * 
 * def dup_let_recombind(vec_in):             # <<<<<<<<<<<<<<
 *     if vec_in==[]:
 *         return []
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_10vapor_vali_15Simple_function_81dup_let_recombind, NULL, __pyx_n_s_vapor_vali_Simple_function); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 623, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_dup_let_recombind, __pyx_t_2) < 0) __PYX_ERR(0, 623, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":647
 *         return vec4
 * 
 * def editDistance(seq1,seq2,cost_matrix,move_matrix,r,c):             # <<<<<<<<<<<<<<
 *     [iCost, dCost , mCost]=[1,1,1]
 *     if cost_matrix[r][c]==float('inf'):
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_10vapor_vali_15Simple_function_83editDistance, NULL, __pyx_n_s_vapor_vali_Simple_function); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 647, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_editDistance, __pyx_t_2) < 0) __PYX_ERR(0, 647, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":681
 *     return cost_matrix[r][c]
 * 
 * def edit_dis_setup(seq1,seq2):             # <<<<<<<<<<<<<<
 *     cost_matrix=np.full((len(seq1)+1,len(seq2)+1),np.inf)
 *     move_matrix=np.full((len(seq1)+1,len(seq2)+1),-1.0)
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_10vapor_vali_15Simple_function_85edit_dis_setup, NULL, __pyx_n_s_vapor_vali_Simple_function); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 681, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_edit_dis_setup, __pyx_t_2) < 0) __PYX_ERR(0, 681, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":687
 *     return opt_dist
 * 
 * def eu_dis_abs_calcu(ref_clean_dotdata):             # <<<<<<<<<<<<<<
 *     #eg of ref_clean_dotdata=[[2380, 471], [2381, 472], [2382, 472], [2383, 472], [2384, 472], [2385, 472], [2386, 472], [2387, 472], [2388, 472], [2389, 473], [2390, 474], [2391, 475], [2402, 486], [2403, 487], [2404, 488], [2405, 489], [2406, 490], [2407, 491], [2408, 492], [2409, 493], [2410, 494], [2411, 495], [2418, 504], [2440, 528], [2441, 529], [2442, 530], [2443, 531], [2454, 542], [2455, 543], [2456, 544], [2473, 563], [2474, 564], [2475, 565], [2476, 566], [2477, 567], [2478, 568], [2479, 569], [2480, 570], [2481, 571], [2482, 572], [2483, 573], [2484, 574], [2485, 575], [2486, 576], [2487, 577], [2488, 578], [2489, 579], [2490, 580], [2500, 589], [2501, 590], [2502, 591], [2503, 592], [2504, 593], [2523, 613], [2524, 614], [2525, 615], [2526, 616], [2527, 617], [2528, 618], [2529, 619], [2530, 620], [2531, 621], [2532, 622], [2533, 623], [2557, 642], [2558, 643], [2559, 644], [2560, 645], [2561, 646], [2562, 647]]
 *     eu_dis_abs=[abs(i[0]-i[1]) for i in ref_clean_dotdata]
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_10vapor_vali_15Simple_function_87eu_dis_abs_calcu, NULL, __pyx_n_s_vapor_vali_Simple_function); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 687, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_eu_dis_abs_calcu, __pyx_t_2) < 0) __PYX_ERR(0, 687, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":692
 *     return np.mean(eu_dis_abs)
 * 
 * def eu_dis_single_dot(dot_pos):             # <<<<<<<<<<<<<<
 *     #############################################
 *     ####eg of dot_pos=(1212, 1217)
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_10vapor_vali_15Simple_function_89eu_dis_single_dot, NULL, __pyx_n_s_vapor_vali_Simple_function); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 692, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_eu_dis_single_dot, __pyx_t_2) < 0) __PYX_ERR(0, 692, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":700
 *     else:               return abs(float(dot_pos[0]-dot_pos[1])/float(dot_pos[0]))
 * 
 * def eu_dis_dir_calcu(list_dotdata):             # <<<<<<<<<<<<<<
 *     #eg of list_dotdata=[[2380, 471], [2381, 472], [2382, 472], [2383, 472], [2384, 472], [2385, 472], [2386, 472], [2387, 472], [2388, 472], [2389, 473], [2390, 474], [2391, 475], [2402, 486], [2403, 487], [2404, 488], [2405, 489], [2406, 490], [2407, 491], [2408, 492], [2409, 493], [2410, 494], [2411, 495], [2418, 504], [2440, 528], [2441, 529], [2442, 530], [2443, 531], [2454, 542], [2455, 543], [2456, 544], [2473, 563], [2474, 564], [2475, 565], [2476, 566], [2477, 567], [2478, 568], [2479, 569], [2480, 570], [2481, 571], [2482, 572], [2483, 573], [2484, 574], [2485, 575], [2486, 576], [2487, 577], [2488, 578], [2489, 579], [2490, 580], [2500, 589], [2501, 590], [2502, 591], [2503, 592], [2504, 593], [2523, 613], [2524, 614], [2525, 615], [2526, 616], [2527, 617], [2528, 618], [2529, 619], [2530, 620], [2531, 621], [2532, 622], [2533, 623], [2557, 642], [2558, 643], [2559, 644], [2560, 645], [2561, 646], [2562, 647]]
 *     eu_dis_abs=[i[0]-i[1] for i in list_dotdata if eu_dis_single_dot(i)>0.1]
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_10vapor_vali_15Simple_function_91eu_dis_dir_calcu, NULL, __pyx_n_s_vapor_vali_Simple_function); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 700, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_eu_dis_dir_calcu, __pyx_t_2) < 0) __PYX_ERR(0, 700, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":706
 *     else:               return np.mean(eu_dis_abs)
 * 
 * def eu_dis_reg_calcu(list_dotdata):             # <<<<<<<<<<<<<<
 *     ratio_new=eu_y_vs_x_ratio_calcu(list_dotdata)
 *     eu_dis_abs=[ratio_new*i[0]-i[1] for i in list_dotdata if eu_dis_single_dot([ratio_new*i[0],i[1]])>0.15]
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_10vapor_vali_15Simple_function_93eu_dis_reg_calcu, NULL, __pyx_n_s_vapor_vali_Simple_function); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 706, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_eu_dis_reg_calcu, __pyx_t_2) < 0) __PYX_ERR(0, 706, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":712
 *     else:               return abs(np.mean(eu_dis_abs))
 * 
 * def eu_dis_dots_within_10perc(ref_clean_dotdata):             # <<<<<<<<<<<<<<
 *     #eg of ref_clean_dotdata=[[2380, 471], [2381, 472], [2382, 472], [2383, 472], [2384, 472], [2385, 472], [2386, 472], [2387, 472], [2388, 472], [2389, 473], [2390, 474], [2391, 475], [2402, 486], [2403, 487], [2404, 488], [2405, 489], [2406, 490], [2407, 491], [2408, 492], [2409, 493], [2410, 494], [2411, 495], [2418, 504], [2440, 528], [2441, 529], [2442, 530], [2443, 531], [2454, 542], [2455, 543], [2456, 544], [2473, 563], [2474, 564], [2475, 565], [2476, 566], [2477, 567], [2478, 568], [2479, 569], [2480, 570], [2481, 571], [2482, 572], [2483, 573], [2484, 574], [2485, 575], [2486, 576], [2487, 577], [2488, 578], [2489, 579], [2490, 580], [2500, 589], [2501, 590], [2502, 591], [2503, 592], [2504, 593], [2523, 613], [2524, 614], [2525, 615], [2526, 616], [2527, 617], [2528, 618], [2529, 619], [2530, 620], [2531, 621], [2532, 622], [2533, 623], [2557, 642], [2558, 643], [2559, 644], [2560, 645], [2561, 646], [2562, 647]]
 *     dis_10perc=[abs(float(i[0]-i[1])/float(i[0])) for i in ref_clean_dotdata if i[0]>0]
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_10vapor_vali_15Simple_function_95eu_dis_dots_within_10perc, NULL, __pyx_n_s_vapor_vali_Simple_function); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 712, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_eu_dis_dots_within_10perc, __pyx_t_2) < 0) __PYX_ERR(0, 712, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":717
 *     return len([i for i in dis_10perc if i <0.16])
 * 
 * def eu_dis_region_calcu(list_dotdata,list_bps):             # <<<<<<<<<<<<<<
 *     #eg of list_bps=[127906399, 127906515, 127907283, 127907399, 127907515]
 *     ref_bps_new=[i-list_bps[0] for i in list_bps]
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_10vapor_vali_15Simple_function_97eu_dis_region_calcu, NULL, __pyx_n_s_vapor_vali_Simple_function); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 717, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_eu_dis_region_calcu, __pyx_t_2) < 0) __PYX_ERR(0, 717, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":738
 *     else:               return np.mean(out_new)
 * 
 * def eu_dis_reg_dup_block_calcu(list_dotdata,dup_block_bps):             # <<<<<<<<<<<<<<
 *     ref_region=[[] for i in range(len(dup_block_bps)+1)]
 *     for x in list_dotdata:
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_10vapor_vali_15Simple_function_99eu_dis_reg_dup_block_calcu, NULL, __pyx_n_s_vapor_vali_Simple_function); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 738, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_eu_dis_reg_dup_block_calcu, __pyx_t_2) < 0) __PYX_ERR(0, 738, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":750
 *     else:               return np.mean(out_new)
 * 
 * def eu_y_vs_x_ratio_single_dot(dot_pos):             # <<<<<<<<<<<<<<
 *     #############################################
 *     ####eg of dot_pos=(1212, 1217)
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_10vapor_vali_15Simple_function_101eu_y_vs_x_ratio_single_dot, NULL, __pyx_n_s_vapor_vali_Simple_function); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 750, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_eu_y_vs_x_ratio_single_dot, __pyx_t_2) < 0) __PYX_ERR(0, 750, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":758
 *     else:               return abs(float(dot_pos[1])/float(dot_pos[0]))
 * 
 * def eu_y_vs_x_ratio_calcu(ref_clean_dotdata):             # <<<<<<<<<<<<<<
 *     y_x_ratio_list=[round(eu_y_vs_x_ratio_single_dot(i),2) for i in ref_clean_dotdata if eu_dis_single_dot(i)<0.15]
 *     if y_x_ratio_list==[]:  return 1
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_10vapor_vali_15Simple_function_103eu_y_vs_x_ratio_calcu, NULL, __pyx_n_s_vapor_vali_Simple_function); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 758, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_eu_y_vs_x_ratio_calcu, __pyx_t_2) < 0) __PYX_ERR(0, 758, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":770
 *             return unify_list(y_x_ratio_list)[0]
 * 
 * def find_longest_list(list_set):             # <<<<<<<<<<<<<<
 *     length=[len(i) for i in list_set]
 *     out_pos=[i for i in range(len(list_set)) if len(list_set[i])==max(length)]
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_10vapor_vali_15Simple_function_105find_longest_list, NULL, __pyx_n_s_vapor_vali_Simple_function); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 770, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_find_longest_list, __pyx_t_2) < 0) __PYX_ERR(0, 770, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":776
 *     return unify_list(out)
 * 
 * def flank_length_calculate(bps):             # <<<<<<<<<<<<<<
 *     if int(bps[-1])-int(bps[1])<100:
 *         flank_length=(int(bps[-1])-int(bps[1]))
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_10vapor_vali_15Simple_function_107flank_length_calculate, NULL, __pyx_n_s_vapor_vali_Simple_function); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 776, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_flank_length_calculate, __pyx_t_2) < 0) __PYX_ERR(0, 776, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":786
 *     return flank_length
 * 
 * def genoCN_extract(pin):             # <<<<<<<<<<<<<<
 *     out=[0,0]
 *     rec_pos=-1
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_10vapor_vali_15Simple_function_109genoCN_extract, NULL, __pyx_n_s_vapor_vali_Simple_function); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 786, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_genoCN_extract, __pyx_t_2) < 0) __PYX_ERR(0, 786, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":797
 *     return out
 * 
 * def genotype_extract(pin):             # <<<<<<<<<<<<<<
 *     out=[0,0]
 *     rec_pos=-1
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_10vapor_vali_15Simple_function_111genotype_extract, NULL, __pyx_n_s_vapor_vali_Simple_function); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 797, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_genotype_extract, __pyx_t_2) < 0) __PYX_ERR(0, 797, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":815
 *     return out
 * 
 * def INS_length_detect(pin):             # <<<<<<<<<<<<<<
 *     out=0
 *     for x in pin[7].split(';'):
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_10vapor_vali_15Simple_function_113INS_length_detect, NULL, __pyx_n_s_vapor_vali_Simple_function); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 815, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_INS_length_detect, __pyx_t_2) < 0) __PYX_ERR(0, 815, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":822
 *     return out
 * 
 * def intersect(a, b):             # <<<<<<<<<<<<<<
 *     return ''.join(sorted(list(set(a) & set(b))))
 * 
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_10vapor_vali_15Simple_function_115intersect, NULL, __pyx_n_s_vapor_vali_Simple_function); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 822, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_intersect, __pyx_t_2) < 0) __PYX_ERR(0, 822, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":825
 *     return ''.join(sorted(list(set(a) & set(b))))
 * 
 * def interval_dis_calcu_max(pos_check):             # <<<<<<<<<<<<<<
 *     #eg of pos_check=[97,98]
 *     if len(pos_check)>1:
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_10vapor_vali_15Simple_function_117interval_dis_calcu_max, NULL, __pyx_n_s_vapor_vali_Simple_function); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 825, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_interval_dis_calcu_max, __pyx_t_2) < 0) __PYX_ERR(0, 825, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":833
 *         return 'NA'
 * 
 * def kept_lines_size_filter(size_list,square_size=400):             # <<<<<<<<<<<<<<
 *     #eg of size_list=[(1582, 415), (1677, 506)]
 *     if abs((size_list[1][0]-size_list[0][0])*(size_list[1][1]-size_list[0][1]))>square_size:    return 'TRUE'
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_10vapor_vali_15Simple_function_119kept_lines_size_filter, NULL, __pyx_n_s_vapor_vali_Simple_function); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 833, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_kept_lines_size_filter, __pyx_t_2) < 0) __PYX_ERR(0, 833, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":838
 *     else:                                                                                       return 'FALSE'
 * 
 * def k_means_cluster(data_list):             # <<<<<<<<<<<<<<
 *     if max(data_list[0])-min(data_list[0])>10 and max(data_list[1])-min(data_list[1])>10:
 *         array_diagnal=np.array([[data_list[0][x],data_list[1][x]] for x in range(len(data_list[0]))])
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_10vapor_vali_15Simple_function_121k_means_cluster, NULL, __pyx_n_s_vapor_vali_Simple_function); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 838, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_k_means_cluster, __pyx_t_2) < 0) __PYX_ERR(0, 838, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":871
 *         return [data_list]
 * 
 * def k_means_cluster_Predict(data_list,info):             # <<<<<<<<<<<<<<
 *     array_diagnal=np.array([[data_list[0][x],data_list[1][x]] for x in range(len(data_list[0]))])
 *     ks = list(range(1,len(info)))
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_10vapor_vali_15Simple_function_123k_means_cluster_Predict, NULL, __pyx_n_s_vapor_vali_Simple_function); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 871, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_k_means_cluster_Predict, __pyx_t_2) < 0) __PYX_ERR(0, 871, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":890
 *         return out
 * 
 * def key_modify(key):             # <<<<<<<<<<<<<<
 *     if 'R' in key:
 *             key=key.replace('R','N')
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_10vapor_vali_15Simple_function_125key_modify, NULL, __pyx_n_s_vapor_vali_Simple_function); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 890, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_key_modify, __pyx_t_2) < 0) __PYX_ERR(0, 890, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":933
 *     return key
 * 
 * def kmerhits(seq1, seq2, kmerlen, nth_base=1, inversions=False):             # <<<<<<<<<<<<<<
 *     # hash table for finding hits
 *     lookup = {}
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_10vapor_vali_15Simple_function_127kmerhits, NULL, __pyx_n_s_vapor_vali_Simple_function); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 933, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_kmerhits, __pyx_t_2) < 0) __PYX_ERR(0, 933, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":967
 *     return hits
 * 
 * def let_to_block_info(let,let_hash,chromos):             # <<<<<<<<<<<<<<
 *     #eg of let='ab'; eg of let_hash={'a': ['chrY', '10818935', '10819073'], 'b': ['chrY', '10819073', '10926507'], '+': ['chrY', '10926507', '10927007'], '-': ['chrY', '10818435', 10818935]}
 *     out=[]
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_10vapor_vali_15Simple_function_129let_to_block_info, NULL, __pyx_n_s_vapor_vali_Simple_function); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 967, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_let_to_block_info, __pyx_t_2) < 0) __PYX_ERR(0, 967, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":975
 *     return(block_modify(out,chromos))
 * 
 * def letter_subgroup(k2_hap):             # <<<<<<<<<<<<<<
 *     #eg of k2_hap='ac^b^'
 *     inverted_sv=[]
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_10vapor_vali_15Simple_function_131letter_subgroup, NULL, __pyx_n_s_vapor_vali_Simple_function); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 975, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_letter_subgroup, __pyx_t_2) < 0) __PYX_ERR(0, 975, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":995
 *     return inverted_sv_3
 * 
 * def letter_split(let):             # <<<<<<<<<<<<<<
 *     #eg of let='c^ba'
 *     out=[]
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_10vapor_vali_15Simple_function_133letter_split, NULL, __pyx_n_s_vapor_vali_Simple_function); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 995, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_letter_split, __pyx_t_2) < 0) __PYX_ERR(0, 995, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":1003
 *     return out
 * 
 * def list_unify(list):             # <<<<<<<<<<<<<<
 *     out=[]
 *     for i in list:
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_10vapor_vali_15Simple_function_135list_unify, NULL, __pyx_n_s_vapor_vali_Simple_function); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1003, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_list_unify, __pyx_t_2) < 0) __PYX_ERR(0, 1003, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":1009
 *     return out
 * 
 * def make_event_figure_1(vapor_score_list,best_read_rec,window_size,ref_seq,alt_seq,out_figure_name):             # <<<<<<<<<<<<<<
 *     if not best_read_rec=='':
 *         if not best_read_rec==[]:
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_10vapor_vali_15Simple_function_137make_event_figure_1, NULL, __pyx_n_s_vapor_vali_Simple_function); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1009, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_make_event_figure_1, __pyx_t_2) < 0) __PYX_ERR(0, 1009, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":1034
 *                 grdevices.dev_off()
 * 
 * def minimize_pacbio_read_list(x,ideal_list_length=20):             # <<<<<<<<<<<<<<
 *     #eg of x=chop_pacbio_read_by_pos(bam_in_new,chrom,start,end,flank_length)
 *     if len(x)>ideal_list_length:
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_10vapor_vali_15Simple_function_139minimize_pacbio_read_list, NULL, __pyx_n_s_vapor_vali_Simple_function); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1034, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_minimize_pacbio_read_list, __pyx_t_2) < 0) __PYX_ERR(0, 1034, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":1047
 *     else: return x
 * 
 * def number_cluster(dis_to_diagnal_list,dis_range):             # <<<<<<<<<<<<<<
 *     dis_clu=[[] for i in dis_range]
 *     reca=0
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_10vapor_vali_15Simple_function_141number_cluster, NULL, __pyx_n_s_vapor_vali_Simple_function); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1047, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_number_cluster, __pyx_t_2) < 0) __PYX_ERR(0, 1047, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":1063
 *     return dis_clu
 * 
 * def one_dimention_cluster_by_gap(dim1,gap,length):             # <<<<<<<<<<<<<<
 *     out_hash={}
 *     for k1 in range(len(dim1)):
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_10vapor_vali_15Simple_function_143one_dimention_cluster_by_gap, NULL, __pyx_n_s_vapor_vali_Simple_function); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1063, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_one_dimention_cluster_by_gap, __pyx_t_2) < 0) __PYX_ERR(0, 1063, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":1081
 *     return out2
 * 
 * def path_mkdir(path):             # <<<<<<<<<<<<<<
 *     if not os.path.isdir(path):
 *         os.system(r'''mkdir %s'''%(path))
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_10vapor_vali_15Simple_function_145path_mkdir, NULL, __pyx_n_s_vapor_vali_Simple_function); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1081, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_path_mkdir, __pyx_t_2) < 0) __PYX_ERR(0, 1081, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":1085
 *         os.system(r'''mkdir %s'''%(path))
 * 
 * def path_modify(path):             # <<<<<<<<<<<<<<
 *     if not path[-1]=='/':
 *         path+='/'
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_10vapor_vali_15Simple_function_147path_modify, NULL, __pyx_n_s_vapor_vali_Simple_function); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1085, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_path_modify, __pyx_t_2) < 0) __PYX_ERR(0, 1085, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":1090
 *     return path
 * 
 * def polarity_detect(pin):             # <<<<<<<<<<<<<<
 *     out='+'
 *     for x in pin[7].split(';'):
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_10vapor_vali_15Simple_function_149polarity_detect, NULL, __pyx_n_s_vapor_vali_Simple_function); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1090, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_polarity_detect, __pyx_t_2) < 0) __PYX_ERR(0, 1090, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":1097
 *     return out
 * 
 * def qual_check_repetitive_region(dotdata_qual_check):             # <<<<<<<<<<<<<<
 *     #qual_check_R_2(dotdata_qual_check,txt_file)  #not necessary for validator
 *     diagnal=0
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_10vapor_vali_15Simple_function_151qual_check_repetitive_region, NULL, __pyx_n_s_vapor_vali_Simple_function); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1097, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_qual_check_repetitive_region, __pyx_t_2) < 0) __PYX_ERR(0, 1097, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":1116
 *     return [float(diagnal)/float(len(dotdata_qual_check)),size_cluster]
 * 
 * def reverse(seq):             # <<<<<<<<<<<<<<
 *     return seq[::-1]
 * 
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_10vapor_vali_15Simple_function_153reverse, NULL, __pyx_n_s_vapor_vali_Simple_function); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1116, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_reverse, __pyx_t_2) < 0) __PYX_ERR(0, 1116, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":1119
 *     return seq[::-1]
 * 
 * def ref_ref_deviate_lines_calcu(list_dotdata):             # <<<<<<<<<<<<<<
 *     ref_kept_deviate=[i for i in list_dotdata if eu_dis_single_dot(i) > 0 and i[1]>i[0]]
 *     ref_left_wings=dot_to_line(ref_kept_deviate)
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_10vapor_vali_15Simple_function_155ref_ref_deviate_lines_calcu, NULL, __pyx_n_s_vapor_vali_Simple_function); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1119, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_ref_ref_deviate_lines_calcu, __pyx_t_2) < 0) __PYX_ERR(0, 1119, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":1132
 *     return [i for i in out if kept_lines_size_filter(i)=='TRUE']
 * 
 * def ref_ref_deviate_lines_describe(list_dotdata):             # <<<<<<<<<<<<<<
 *     ref_ref_lines=ref_ref_deviate_lines_calcu(list_dotdata)
 *     out=[]
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_10vapor_vali_15Simple_function_157ref_ref_deviate_lines_describe, NULL, __pyx_n_s_vapor_vali_Simple_function); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1132, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_ref_ref_deviate_lines_describe, __pyx_t_2) < 0) __PYX_ERR(0, 1132, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":1141
 *     return out
 * 
 * def ref_deviate_lines_calcu(list_dotdata):             # <<<<<<<<<<<<<<
 *     ref_kept_deviate=[i for i in list_dotdata if eu_dis_single_dot(i) > 0.15]
 *     ref_left_wings=dot_to_line(ref_kept_deviate)
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_10vapor_vali_15Simple_function_159ref_deviate_lines_calcu, NULL, __pyx_n_s_vapor_vali_Simple_function); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1141, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_ref_deviate_lines_calcu, __pyx_t_2) < 0) __PYX_ERR(0, 1141, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":1146
 *     return    [i for i in ref_left_wings if kept_lines_size_filter(i)=='TRUE']
 * 
 * def ref_seq_readin(ref,chrom,start,end,reverse_flag='FALSE'):             # <<<<<<<<<<<<<<
 *     #reverse=='TRUE': return rev-comp-seq   ; if not specified, default as 'FALSE'
 *     #else: return original seq
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_10vapor_vali_15Simple_function_161ref_seq_readin, NULL, __pyx_n_s_vapor_vali_Simple_function); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1146, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_ref_seq_readin, __pyx_t_2) < 0) __PYX_ERR(0, 1146, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":1162
 *         return reverse(complementary(seq))
 * 
 * def result_organize_ins(info_list):             # <<<<<<<<<<<<<<
 *     #eg of info_list=[key_event,vapor_score_event]=['chr2_82961201', [-9.228366096827557, -106.46718851834126, -667.0858781654538, -38.56838396416415, -64.87185751169045, -147.77261544769615, -28.29536680099185, -25.378519434143666, -17.23542013374081, -113.00564782332029, -64.53043553409316]]
 *     if len(info_list[1])>0:
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_10vapor_vali_15Simple_function_163result_organize_ins, NULL, __pyx_n_s_vapor_vali_Simple_function); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1162, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_result_organize_ins, __pyx_t_2) < 0) __PYX_ERR(0, 1162, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":1176
 *         return [info_list[0]]+['NA' for i in range(3)]
 * 
 * def simple_del_diploid_decide(k1,k2):             # <<<<<<<<<<<<<<
 *     #eg of k1='ab/ab'   ; eg of k2='a/a'
 *     k2_haps=k2.split('/')
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_10vapor_vali_15Simple_function_165simple_del_diploid_decide, NULL, __pyx_n_s_vapor_vali_Simple_function); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1176, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_simple_del_diploid_decide, __pyx_t_2) < 0) __PYX_ERR(0, 1176, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":1187
 *     return out
 * 
 * def simple_del_haploid_decide(k1_hap,k2_hap):             # <<<<<<<<<<<<<<
 *     #eg of k1_hap='ab'  ;    eg of k2_hap='b'
 *     if k1_hap==k2_hap: return 'FALSE'   #no alt
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_10vapor_vali_15Simple_function_167simple_del_haploid_decide, NULL, __pyx_n_s_vapor_vali_Simple_function); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1187, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_simple_del_haploid_decide, __pyx_t_2) < 0) __PYX_ERR(0, 1187, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":1199
 *     return letter_subgroup(''.join([i for i in k1_hap if not i in k2_hap]))
 * 
 * def simple_inv_diploid_decide(k1,k2):             # <<<<<<<<<<<<<<
 *     #eg of k1='ab/ab'   ; eg of k2='ab^/ab'
 *     k2_haps=k2.split('/')
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_10vapor_vali_15Simple_function_169simple_inv_diploid_decide, NULL, __pyx_n_s_vapor_vali_Simple_function); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1199, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_simple_inv_diploid_decide, __pyx_t_2) < 0) __PYX_ERR(0, 1199, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":1210
 *     return out
 * 
 * def simple_inv_haploid_decide(k1_hap,k2_hap):             # <<<<<<<<<<<<<<
 *     #eg of k1_hap='ab'  ;    eg of k2_hap='b^a^'
 *     if not '^' in k2_hap:   return 'FALSE'      #if not block inverted
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_10vapor_vali_15Simple_function_171simple_inv_haploid_decide, NULL, __pyx_n_s_vapor_vali_Simple_function); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1210, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_simple_inv_haploid_decide, __pyx_t_2) < 0) __PYX_ERR(0, 1210, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":1220
 *     else:   return 'FALSE'
 * 
 * def simple_tandup_diploid_decide(k1,k2):             # <<<<<<<<<<<<<<
 *     #eg of k1='ab/ab'   ; eg of k2='abb/ab'
 *     k2_haps=k2.split('/')
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_10vapor_vali_15Simple_function_173simple_tandup_diploid_decide, NULL, __pyx_n_s_vapor_vali_Simple_function); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1220, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_simple_tandup_diploid_decide, __pyx_t_2) < 0) __PYX_ERR(0, 1220, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":1231
 *     return out
 * 
 * def simple_tandup_haploid_decide(k1_hap,k2_hap):             # <<<<<<<<<<<<<<
 *     if '^' in k2_hap:   return 'FALSE'
 *     dup_count=[k2_hap.count(i) for i in k1_hap]
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_10vapor_vali_15Simple_function_175simple_tandup_haploid_decide, NULL, __pyx_n_s_vapor_vali_Simple_function); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1231, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_simple_tandup_haploid_decide, __pyx_t_2) < 0) __PYX_ERR(0, 1231, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":1264
 *     return 'FALSE'
 * 
 * def simple_disdup_diploid_decide(k1,k2):             # <<<<<<<<<<<<<<
 *     #eg of k1='ab/ab'   ; eg of k2='bab/ab'
 *     k2_haps=k2.split('/')
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_10vapor_vali_15Simple_function_177simple_disdup_diploid_decide, NULL, __pyx_n_s_vapor_vali_Simple_function); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1264, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_simple_disdup_diploid_decide, __pyx_t_2) < 0) __PYX_ERR(0, 1264, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":1275
 *     return out
 * 
 * def simple_disdup_haploid_decide(k1_hap,k2_hap):             # <<<<<<<<<<<<<<
 *     #eg of k1_hap='abcd'    ;   eg of k2_hap='babdcd'
 *     if not '^' in k2_hap:
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_10vapor_vali_15Simple_function_179simple_disdup_haploid_decide, NULL, __pyx_n_s_vapor_vali_Simple_function); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1275, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_simple_disdup_haploid_decide, __pyx_t_2) < 0) __PYX_ERR(0, 1275, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":1321
 *     return 'FALSE'
 * 
 * def simple_del_chop_pacbio_read_simple_short(bam_in,sv_info,flank_length):             # <<<<<<<<<<<<<<
 *     #eg of info = ['a/a','/','chr1', 101553562, 101553905]
 *     #pick read around left breakpoints
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_10vapor_vali_15Simple_function_181simple_del_chop_pacbio_read_simple_short, NULL, __pyx_n_s_vapor_vali_Simple_function); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1321, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_simple_del_chop_pacbio_read_simp, __pyx_t_2) < 0) __PYX_ERR(0, 1321, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":1335
 *     return x
 * 
 * def simple_chop_pacbio_read_simple_short(bam_in,sv_info,flank_length):             # <<<<<<<<<<<<<<
 *     #eg of info = ['a/a','/','chr1', 101553562, 101553905]
 *     #eg of sv_info=['chr1', 101553562, 101553905]
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_10vapor_vali_15Simple_function_183simple_chop_pacbio_read_simple_short, NULL, __pyx_n_s_vapor_vali_Simple_function); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1335, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_simple_chop_pacbio_read_simple_s, __pyx_t_2) < 0) __PYX_ERR(0, 1335, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":1346
 *     return x
 * 
 * def subkeys(key, nth_base, inversions):             # <<<<<<<<<<<<<<
 *     subkeys_info = []
 *     key=key_modify(key)
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_10vapor_vali_15Simple_function_185subkeys, NULL, __pyx_n_s_vapor_vali_Simple_function); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1346, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_subkeys, __pyx_t_2) < 0) __PYX_ERR(0, 1346, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":1367
 *     return subkeys_info
 * 
 * def svtype_extract(pin):             # <<<<<<<<<<<<<<
 *     svtype=''
 *     for x in pin[7].split(';'):
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_10vapor_vali_15Simple_function_187svtype_extract, NULL, __pyx_n_s_vapor_vali_Simple_function); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1367, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_svtype_extract, __pyx_t_2) < 0) __PYX_ERR(0, 1367, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":1376
 *     return svtype
 * 
 * def sv_len_extract(pin):             # <<<<<<<<<<<<<<
 *     svtype=''
 *     for x in pin[7].split(';'):
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_10vapor_vali_15Simple_function_189sv_len_extract, NULL, __pyx_n_s_vapor_vali_Simple_function); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1376, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_sv_len_extract, __pyx_t_2) < 0) __PYX_ERR(0, 1376, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":1385
 *     return svtype
 * 
 * def sv_seq_extract(pin):             # <<<<<<<<<<<<<<
 *     seq=''
 *     for x in pin[7].split(';'):
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_10vapor_vali_15Simple_function_191sv_seq_extract, NULL, __pyx_n_s_vapor_vali_Simple_function); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1385, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_sv_seq_extract, __pyx_t_2) < 0) __PYX_ERR(0, 1385, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":1392
 *     return seq
 * 
 * def sv_insert_point_define(pin):             # <<<<<<<<<<<<<<
 *     svtype=[0,0]
 *     for x in pin[7].split(';'):
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_10vapor_vali_15Simple_function_193sv_insert_point_define, NULL, __pyx_n_s_vapor_vali_Simple_function); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1392, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_sv_insert_point_define, __pyx_t_2) < 0) __PYX_ERR(0, 1392, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":1401
 *     return svtype
 * 
 * def take_off_symmetric_dots(list_dotdata):             # <<<<<<<<<<<<<<
 *     left_part=[list_dotdata[i] for i in range(len(list_dotdata)/2)]
 *     right_part=[list_dotdata[i][::-1] for i in [len(list_dotdata)-1-i for i in range(len(list_dotdata)/2)]]
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_10vapor_vali_15Simple_function_195take_off_symmetric_dots, NULL, __pyx_n_s_vapor_vali_Simple_function); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1401, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_take_off_symmetric_dots, __pyx_t_2) < 0) __PYX_ERR(0, 1401, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":1415
 *     return out_dots
 * 
 * def two_dimention_cluster_by_gap(dim1,dim2,gap,length):             # <<<<<<<<<<<<<<
 *     ####dim1 and dim2 are both one-dimention data list,of the same length;
 *     ####dots with distance >gap on any dimention would be clustered into different group
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_10vapor_vali_15Simple_function_197two_dimention_cluster_by_gap, NULL, __pyx_n_s_vapor_vali_Simple_function); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1415, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_two_dimention_cluster_by_gap, __pyx_t_2) < 0) __PYX_ERR(0, 1415, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":1426
 *     return out
 * 
 * def unify_list(list):             # <<<<<<<<<<<<<<
 *     out=[]
 *     for x in list:
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_10vapor_vali_15Simple_function_199unify_list, NULL, __pyx_n_s_vapor_vali_Simple_function); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1426, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_unify_list, __pyx_t_2) < 0) __PYX_ERR(0, 1426, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":1433
 *     return out
 * 
 * def vapor_CANNOT_CLASSIFY_VapoR(bam_in,ref,sv_info,out_figure_name):             # <<<<<<<<<<<<<<
 *     #eg of sv_info=['ab_ab', 'b_b^', 'chr7', '70955990', '70961199', '70973901']
 *     ref_sv=sv_info[0].split('_')
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_10vapor_vali_15Simple_function_201vapor_CANNOT_CLASSIFY_VapoR, NULL, __pyx_n_s_vapor_vali_Simple_function); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1433, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_vapor_CANNOT_CLASSIFY_VapoR, __pyx_t_2) < 0) __PYX_ERR(0, 1433, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":1500
 *     return vapor_score_list
 * 
 * def vapor_del_inv_Vapor(bam_in,ref,sv_info,out_figure_name):             # <<<<<<<<<<<<<<
 *     sv_block=[sv_info[0][0],sv_info[0][1],sv_info[-1][2]]
 *     flank_length=flank_length_calculate(sv_block)
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_10vapor_vali_15Simple_function_203vapor_del_inv_Vapor, NULL, __pyx_n_s_vapor_vali_Simple_function); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1500, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_vapor_del_inv_Vapor, __pyx_t_2) < 0) __PYX_ERR(0, 1500, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":1538
 *     return vapor_score_list
 * 
 * def vapor_dup_inv_VapoR(bam_in,ref,sv_info,out_figure_name):             # <<<<<<<<<<<<<<
 *     #eg of sv_info=['chr1', 114103333, 114103408, 'chr1', 114111746]
 *     sv_info[1:3]=[int(i) for i in sv_info[1:3]]
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_10vapor_vali_15Simple_function_205vapor_dup_inv_VapoR, NULL, __pyx_n_s_vapor_vali_Simple_function); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1538, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_vapor_dup_inv_VapoR, __pyx_t_2) < 0) __PYX_ERR(0, 1538, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":1614
 *     return vapor_score_list
 * 
 * def vapor_long_del_inv(bam_in,ref,sv_info,out_figure_name):             # <<<<<<<<<<<<<<
 *     #eg of sv_info=[['chr19', 46275941, 46314150, 'del'], ['chr19', 46314150, 46314312, 'inv']]
 *     vapor_score_list=[]
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_10vapor_vali_15Simple_function_207vapor_long_del_inv, NULL, __pyx_n_s_vapor_vali_Simple_function); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1614, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_vapor_long_del_inv, __pyx_t_2) < 0) __PYX_ERR(0, 1614, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":1636
 *     return vapor_score_list
 * 
 * def vapor_simple_del_Vapor(bam_in,ref,sv_info,out_figure_name):             # <<<<<<<<<<<<<<
 *     #eg of sv_info=['chr1', 101553562, 101553905]
 *     flank_length=flank_length_calculate(sv_info)
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_10vapor_vali_15Simple_function_209vapor_simple_del_Vapor, NULL, __pyx_n_s_vapor_vali_Simple_function); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1636, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_vapor_simple_del_Vapor, __pyx_t_2) < 0) __PYX_ERR(0, 1636, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":1674
 *     return vapor_score_list
 * 
 * def vapor_simple_tandup_Vapor(bam_in,ref,sv_info,out_figure_name):             # <<<<<<<<<<<<<<
 *    #vapor_simple_del_Vapor(bam_in,ref,x[:-2],out_path+sample_name+'.TANDUP.'+key_event+'.png')
 *     flank_length=flank_length_calculate(sv_info)
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_10vapor_vali_15Simple_function_211vapor_simple_tandup_Vapor, NULL, __pyx_n_s_vapor_vali_Simple_function); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1674, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_vapor_simple_tandup_Vapor, __pyx_t_2) < 0) __PYX_ERR(0, 1674, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":1713
 *     return vapor_score_list
 * 
 * def vapor_simple_disdup_Vapor(bam_in,ref,sv_info,out_figure_name):             # <<<<<<<<<<<<<<
 *     sv_info[1:3]=[int(i) for i in sv_info[1:3]]
 *     dup_block=sv_info[:3]
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_10vapor_vali_15Simple_function_213vapor_simple_disdup_Vapor, NULL, __pyx_n_s_vapor_vali_Simple_function); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1713, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_vapor_simple_disdup_Vapor, __pyx_t_2) < 0) __PYX_ERR(0, 1713, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":1783
 *     return vapor_score_list
 * 
 * def vapor_simple_ins_Vapor(bam_in,ref,ins_pos,ins_seq,out_figure_name,POLARITY):             # <<<<<<<<<<<<<<
 *     #eg of ins_pos='chr1_83144055'
 *     #eg of bam_in='/nfs/turbo/remillsscr/scratch2_trans/datasets/1000genomes/vol1/ftp/data_collections/hgsv_sv_discovery/PacBio/alignment/HG00512.XXX.bam'
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_10vapor_vali_15Simple_function_215vapor_simple_ins_Vapor, NULL, __pyx_n_s_vapor_vali_Simple_function); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1783, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_vapor_simple_ins_Vapor, __pyx_t_2) < 0) __PYX_ERR(0, 1783, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":1821
 *     return vapor_score_list
 * 
 * def vapor_simple_inv_Vapor(bam_in,ref,sv_info,out_figure_name):             # <<<<<<<<<<<<<<
 *     #eg of sv_info=['chr1', 101553562, 101553905]
 *     flank_length=flank_length_calculate(sv_info)
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_10vapor_vali_15Simple_function_217vapor_simple_inv_Vapor, NULL, __pyx_n_s_vapor_vali_Simple_function); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1821, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_vapor_simple_inv_Vapor, __pyx_t_2) < 0) __PYX_ERR(0, 1821, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":1860
 *     return vapor_score_list
 * 
 * def vcf_rec_hash_modify(vcf_rec_hash):             # <<<<<<<<<<<<<<
 *     out={}
 *     for k1 in list(vcf_rec_hash.keys()):
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_10vapor_vali_15Simple_function_219vcf_rec_hash_modify, NULL, __pyx_n_s_vapor_vali_Simple_function); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1860, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_vcf_rec_hash_modify, __pyx_t_2) < 0) __PYX_ERR(0, 1860, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":1867
 *     return out
 * 
 * def vcf_vapor_modify(vcf_input,vcf_rec_hash_new):             # <<<<<<<<<<<<<<
 *     vapor_input=vcf_input+'.vapor'
 *     vapor_rec={}
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_10vapor_vali_15Simple_function_221vcf_vapor_modify, NULL, __pyx_n_s_vapor_vali_Simple_function); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1867, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_vcf_vapor_modify, __pyx_t_2) < 0) __PYX_ERR(0, 1867, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":1897
 *     fo.close()
 * 
 * def window_size_refine(seq2,region_QC_Cff=0.4):             # <<<<<<<<<<<<<<
 *     window_size=10
 *     if not seq2.count('N')+seq2.count('n')>100:
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_10vapor_vali_15Simple_function_223window_size_refine, NULL, __pyx_n_s_vapor_vali_Simple_function); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1897, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_window_size_refine, __pyx_t_2) < 0) __PYX_ERR(0, 1897, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":1914
 *     else:       return ['Error','Error']
 * 
 * def write_dotdata_to_file(file_out,dotdata_list):             # <<<<<<<<<<<<<<
 *     fo=open(file_out,'w')
 *     for k1 in dotdata_list:
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_10vapor_vali_15Simple_function_225write_dotdata_to_file, NULL, __pyx_n_s_vapor_vali_Simple_function); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1914, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_write_dotdata_to_file, __pyx_t_2) < 0) __PYX_ERR(0, 1914, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":1920
 *     fo.close()
 * 
 * def write_output_initiate(out_name):             # <<<<<<<<<<<<<<
 *     fo=open(out_name,'w')
 *     print('\t'.join(['chr','start','end','SV_description','VaPoR_quality_score','VaPoR_genotype_score','other']), file=fo)
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_10vapor_vali_15Simple_function_227write_output_initiate, NULL, __pyx_n_s_vapor_vali_Simple_function); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1920, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_write_output_initiate, __pyx_t_2) < 0) __PYX_ERR(0, 1920, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":1925
 *     fo.close()
 * 
 * def write_output_main(out_name,out_list):             # <<<<<<<<<<<<<<
 *     fo=open(out_name,'a')
 *     print('\t'.join([str(i) for i in out_list]), file=fo)
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_10vapor_vali_15Simple_function_229write_output_main, NULL, __pyx_n_s_vapor_vali_Simple_function); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1925, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_write_output_main, __pyx_t_2) < 0) __PYX_ERR(0, 1925, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":1930
 *     fo.close()
 * 
 * def x_to_x_modify_new(x,dup_block_combined):             # <<<<<<<<<<<<<<
 *     x_modify=[[i] for i in list(x)]
 *     block_rec=-1
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_10vapor_vali_15Simple_function_231x_to_x_modify_new, NULL, __pyx_n_s_vapor_vali_Simple_function); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1930, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_x_to_x_modify_new, __pyx_t_2) < 0) __PYX_ERR(0, 1930, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":1941
 *     return x_modify_new
 * 
 * def X_means_cluster(data_list):             # <<<<<<<<<<<<<<
 *     temp_result=[i for i in k_means_cluster(data_list) if not i==[[],[]]]
 *     if temp_result==[data_list]:
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_10vapor_vali_15Simple_function_233X_means_cluster, NULL, __pyx_n_s_vapor_vali_Simple_function); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1941, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_X_means_cluster, __pyx_t_2) < 0) __PYX_ERR(0, 1941, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":1951
 *         return out
 * 
 * def X_means_cluster_reformat(data_list):             # <<<<<<<<<<<<<<
 *     out=X_means_cluster(data_list)
 *     out2=[]
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_10vapor_vali_15Simple_function_235X_means_cluster_reformat, NULL, __pyx_n_s_vapor_vali_Simple_function); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1951, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_X_means_cluster_reformat, __pyx_t_2) < 0) __PYX_ERR(0, 1951, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "vapor_vali/Simple_function.pyx":1
 * from __future__ import print_function             # <<<<<<<<<<<<<<
 * 
 * import os,sysm,itertools
 */
  __pyx_t_2 = PyDict_New(); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_test_2, __pyx_t_2) < 0) __PYX_ERR(0, 1, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /*--- Wrapped vars code ---*/

  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  if (__pyx_m) {
    if (__pyx_d) {
      __Pyx_AddTraceback("init vapor_vali.Simple_function", __pyx_clineno, __pyx_lineno, __pyx_filename);
    }
    Py_DECREF(__pyx_m); __pyx_m = 0;
  } else if (!PyErr_Occurred()) {
    PyErr_SetString(PyExc_ImportError, "init vapor_vali.Simple_function");
  }
  __pyx_L0:;
  __Pyx_RefNannyFinishContext();
  #if PY_MAJOR_VERSION < 3
  return;
  #else
  return __pyx_m;
  #endif
}

/* --- Runtime support code --- */
/* Refnanny */
#if CYTHON_REFNANNY
static __Pyx_RefNannyAPIStruct *__Pyx_RefNannyImportAPI(const char *modname) {
    PyObject *m = NULL, *p = NULL;
    void *r = NULL;
    m = PyImport_ImportModule((char *)modname);
    if (!m) goto end;
    p = PyObject_GetAttrString(m, (char *)"RefNannyAPI");
    if (!p) goto end;
    r = PyLong_AsVoidPtr(p);
end:
    Py_XDECREF(p);
    Py_XDECREF(m);
    return (__Pyx_RefNannyAPIStruct *)r;
}
#endif

/* GetBuiltinName */
static PyObject *__Pyx_GetBuiltinName(PyObject *name) {
    PyObject* result = __Pyx_PyObject_GetAttrStr(__pyx_b, name);
    if (unlikely(!result)) {
        PyErr_Format(PyExc_NameError,
#if PY_MAJOR_VERSION >= 3
            "name '%U' is not defined", name);
#else
            "name '%.200s' is not defined", PyString_AS_STRING(name));
#endif
    }
    return result;
}

/* RaiseArgTupleInvalid */
static void __Pyx_RaiseArgtupleInvalid(
    const char* func_name,
    int exact,
    Py_ssize_t num_min,
    Py_ssize_t num_max,
    Py_ssize_t num_found)
{
    Py_ssize_t num_expected;
    const char *more_or_less;
    if (num_found < num_min) {
        num_expected = num_min;
        more_or_less = "at least";
    } else {
        num_expected = num_max;
        more_or_less = "at most";
    }
    if (exact) {
        more_or_less = "exactly";
    }
    PyErr_Format(PyExc_TypeError,
                 "%.200s() takes %.8s %" CYTHON_FORMAT_SSIZE_T "d positional argument%.1s (%" CYTHON_FORMAT_SSIZE_T "d given)",
                 func_name, more_or_less, num_expected,
                 (num_expected == 1) ? "" : "s", num_found);
}

/* RaiseDoubleKeywords */
static void __Pyx_RaiseDoubleKeywordsError(
    const char* func_name,
    PyObject* kw_name)
{
    PyErr_Format(PyExc_TypeError,
        #if PY_MAJOR_VERSION >= 3
        "%s() got multiple values for keyword argument '%U'", func_name, kw_name);
        #else
        "%s() got multiple values for keyword argument '%s'", func_name,
        PyString_AsString(kw_name));
        #endif
}

/* ParseKeywords */
static int __Pyx_ParseOptionalKeywords(
    PyObject *kwds,
    PyObject **argnames[],
    PyObject *kwds2,
    PyObject *values[],
    Py_ssize_t num_pos_args,
    const char* function_name)
{
    PyObject *key = 0, *value = 0;
    Py_ssize_t pos = 0;
    PyObject*** name;
    PyObject*** first_kw_arg = argnames + num_pos_args;
    while (PyDict_Next(kwds, &pos, &key, &value)) {
        name = first_kw_arg;
        while (*name && (**name != key)) name++;
        if (*name) {
            values[name-argnames] = value;
            continue;
        }
        name = first_kw_arg;
        #if PY_MAJOR_VERSION < 3
        if (likely(PyString_CheckExact(key)) || likely(PyString_Check(key))) {
            while (*name) {
                if ((CYTHON_COMPILING_IN_PYPY || PyString_GET_SIZE(**name) == PyString_GET_SIZE(key))
                        && _PyString_Eq(**name, key)) {
                    values[name-argnames] = value;
                    break;
                }
                name++;
            }
            if (*name) continue;
            else {
                PyObject*** argname = argnames;
                while (argname != first_kw_arg) {
                    if ((**argname == key) || (
                            (CYTHON_COMPILING_IN_PYPY || PyString_GET_SIZE(**argname) == PyString_GET_SIZE(key))
                             && _PyString_Eq(**argname, key))) {
                        goto arg_passed_twice;
                    }
                    argname++;
                }
            }
        } else
        #endif
        if (likely(PyUnicode_Check(key))) {
            while (*name) {
                int cmp = (**name == key) ? 0 :
                #if !CYTHON_COMPILING_IN_PYPY && PY_MAJOR_VERSION >= 3
                    (PyUnicode_GET_SIZE(**name) != PyUnicode_GET_SIZE(key)) ? 1 :
                #endif
                    PyUnicode_Compare(**name, key);
                if (cmp < 0 && unlikely(PyErr_Occurred())) goto bad;
                if (cmp == 0) {
                    values[name-argnames] = value;
                    break;
                }
                name++;
            }
            if (*name) continue;
            else {
                PyObject*** argname = argnames;
                while (argname != first_kw_arg) {
                    int cmp = (**argname == key) ? 0 :
                    #if !CYTHON_COMPILING_IN_PYPY && PY_MAJOR_VERSION >= 3
                        (PyUnicode_GET_SIZE(**argname) != PyUnicode_GET_SIZE(key)) ? 1 :
                    #endif
                        PyUnicode_Compare(**argname, key);
                    if (cmp < 0 && unlikely(PyErr_Occurred())) goto bad;
                    if (cmp == 0) goto arg_passed_twice;
                    argname++;
                }
            }
        } else
            goto invalid_keyword_type;
        if (kwds2) {
            if (unlikely(PyDict_SetItem(kwds2, key, value))) goto bad;
        } else {
            goto invalid_keyword;
        }
    }
    return 0;
arg_passed_twice:
    __Pyx_RaiseDoubleKeywordsError(function_name, key);
    goto bad;
invalid_keyword_type:
    PyErr_Format(PyExc_TypeError,
        "%.200s() keywords must be strings", function_name);
    goto bad;
invalid_keyword:
    PyErr_Format(PyExc_TypeError,
    #if PY_MAJOR_VERSION < 3
        "%.200s() got an unexpected keyword argument '%.200s'",
        function_name, PyString_AsString(key));
    #else
        "%s() got an unexpected keyword argument '%U'",
        function_name, key);
    #endif
bad:
    return -1;
}

/* PyObjectCall */
#if CYTHON_COMPILING_IN_CPYTHON
static CYTHON_INLINE PyObject* __Pyx_PyObject_Call(PyObject *func, PyObject *arg, PyObject *kw) {
    PyObject *result;
    ternaryfunc call = func->ob_type->tp_call;
    if (unlikely(!call))
        return PyObject_Call(func, arg, kw);
    if (unlikely(Py_EnterRecursiveCall((char*)" while calling a Python object")))
        return NULL;
    result = (*call)(func, arg, kw);
    Py_LeaveRecursiveCall();
    if (unlikely(!result) && unlikely(!PyErr_Occurred())) {
        PyErr_SetString(
            PyExc_SystemError,
            "NULL result without error in PyObject_Call");
    }
    return result;
}
#endif

/* GetItemInt */
static CYTHON_INLINE PyObject *__Pyx_GetItemInt_Generic(PyObject *o, PyObject* j) {
    PyObject *r;
    if (!j) return NULL;
    r = PyObject_GetItem(o, j);
    Py_DECREF(j);
    return r;
}
static CYTHON_INLINE PyObject *__Pyx_GetItemInt_List_Fast(PyObject *o, Py_ssize_t i,
                                                              CYTHON_NCP_UNUSED int wraparound,
                                                              CYTHON_NCP_UNUSED int boundscheck) {
#if CYTHON_COMPILING_IN_CPYTHON
    if (wraparound & unlikely(i < 0)) i += PyList_GET_SIZE(o);
    if ((!boundscheck) || likely((0 <= i) & (i < PyList_GET_SIZE(o)))) {
        PyObject *r = PyList_GET_ITEM(o, i);
        Py_INCREF(r);
        return r;
    }
    return __Pyx_GetItemInt_Generic(o, PyInt_FromSsize_t(i));
#else
    return PySequence_GetItem(o, i);
#endif
}
static CYTHON_INLINE PyObject *__Pyx_GetItemInt_Tuple_Fast(PyObject *o, Py_ssize_t i,
                                                              CYTHON_NCP_UNUSED int wraparound,
                                                              CYTHON_NCP_UNUSED int boundscheck) {
#if CYTHON_COMPILING_IN_CPYTHON
    if (wraparound & unlikely(i < 0)) i += PyTuple_GET_SIZE(o);
    if ((!boundscheck) || likely((0 <= i) & (i < PyTuple_GET_SIZE(o)))) {
        PyObject *r = PyTuple_GET_ITEM(o, i);
        Py_INCREF(r);
        return r;
    }
    return __Pyx_GetItemInt_Generic(o, PyInt_FromSsize_t(i));
#else
    return PySequence_GetItem(o, i);
#endif
}
static CYTHON_INLINE PyObject *__Pyx_GetItemInt_Fast(PyObject *o, Py_ssize_t i, int is_list,
                                                     CYTHON_NCP_UNUSED int wraparound,
                                                     CYTHON_NCP_UNUSED int boundscheck) {
#if CYTHON_COMPILING_IN_CPYTHON
    if (is_list || PyList_CheckExact(o)) {
        Py_ssize_t n = ((!wraparound) | likely(i >= 0)) ? i : i + PyList_GET_SIZE(o);
        if ((!boundscheck) || (likely((n >= 0) & (n < PyList_GET_SIZE(o))))) {
            PyObject *r = PyList_GET_ITEM(o, n);
            Py_INCREF(r);
            return r;
        }
    }
    else if (PyTuple_CheckExact(o)) {
        Py_ssize_t n = ((!wraparound) | likely(i >= 0)) ? i : i + PyTuple_GET_SIZE(o);
        if ((!boundscheck) || likely((n >= 0) & (n < PyTuple_GET_SIZE(o)))) {
            PyObject *r = PyTuple_GET_ITEM(o, n);
            Py_INCREF(r);
            return r;
        }
    } else {
        PySequenceMethods *m = Py_TYPE(o)->tp_as_sequence;
        if (likely(m && m->sq_item)) {
            if (wraparound && unlikely(i < 0) && likely(m->sq_length)) {
                Py_ssize_t l = m->sq_length(o);
                if (likely(l >= 0)) {
                    i += l;
                } else {
                    if (!PyErr_ExceptionMatches(PyExc_OverflowError))
                        return NULL;
                    PyErr_Clear();
                }
            }
            return m->sq_item(o, i);
        }
    }
#else
    if (is_list || PySequence_Check(o)) {
        return PySequence_GetItem(o, i);
    }
#endif
    return __Pyx_GetItemInt_Generic(o, PyInt_FromSsize_t(i));
}

/* PyIntBinop */
#if CYTHON_COMPILING_IN_CPYTHON
static PyObject* __Pyx_PyInt_AddObjC(PyObject *op1, PyObject *op2, CYTHON_UNUSED long intval, CYTHON_UNUSED int inplace) {
    #if PY_MAJOR_VERSION < 3
    if (likely(PyInt_CheckExact(op1))) {
        const long b = intval;
        long x;
        long a = PyInt_AS_LONG(op1);
            x = (long)((unsigned long)a + b);
            if (likely((x^a) >= 0 || (x^b) >= 0))
                return PyInt_FromLong(x);
            return PyLong_Type.tp_as_number->nb_add(op1, op2);
    }
    #endif
    #if CYTHON_USE_PYLONG_INTERNALS && PY_MAJOR_VERSION >= 3
    if (likely(PyLong_CheckExact(op1))) {
        const long b = intval;
        long a, x;
        const PY_LONG_LONG llb = intval;
        PY_LONG_LONG lla, llx;
        const digit* digits = ((PyLongObject*)op1)->ob_digit;
        const Py_ssize_t size = Py_SIZE(op1);
        if (likely(__Pyx_sst_abs(size) <= 1)) {
            a = likely(size) ? digits[0] : 0;
            if (size == -1) a = -a;
        } else {
            switch (size) {
                case -2:
                    if (8 * sizeof(long) - 1 > 2 * PyLong_SHIFT) {
                        a = -(long) (((((unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0]));
                        break;
                    } else if (8 * sizeof(PY_LONG_LONG) - 1 > 2 * PyLong_SHIFT) {
                        lla = -(PY_LONG_LONG) (((((unsigned PY_LONG_LONG)digits[1]) << PyLong_SHIFT) | (unsigned PY_LONG_LONG)digits[0]));
                        goto long_long;
                    }
                case 2:
                    if (8 * sizeof(long) - 1 > 2 * PyLong_SHIFT) {
                        a = (long) (((((unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0]));
                        break;
                    } else if (8 * sizeof(PY_LONG_LONG) - 1 > 2 * PyLong_SHIFT) {
                        lla = (PY_LONG_LONG) (((((unsigned PY_LONG_LONG)digits[1]) << PyLong_SHIFT) | (unsigned PY_LONG_LONG)digits[0]));
                        goto long_long;
                    }
                case -3:
                    if (8 * sizeof(long) - 1 > 3 * PyLong_SHIFT) {
                        a = -(long) (((((((unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0]));
                        break;
                    } else if (8 * sizeof(PY_LONG_LONG) - 1 > 3 * PyLong_SHIFT) {
                        lla = -(PY_LONG_LONG) (((((((unsigned PY_LONG_LONG)digits[2]) << PyLong_SHIFT) | (unsigned PY_LONG_LONG)digits[1]) << PyLong_SHIFT) | (unsigned PY_LONG_LONG)digits[0]));
                        goto long_long;
                    }
                case 3:
                    if (8 * sizeof(long) - 1 > 3 * PyLong_SHIFT) {
                        a = (long) (((((((unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0]));
                        break;
                    } else if (8 * sizeof(PY_LONG_LONG) - 1 > 3 * PyLong_SHIFT) {
                        lla = (PY_LONG_LONG) (((((((unsigned PY_LONG_LONG)digits[2]) << PyLong_SHIFT) | (unsigned PY_LONG_LONG)digits[1]) << PyLong_SHIFT) | (unsigned PY_LONG_LONG)digits[0]));
                        goto long_long;
                    }
                case -4:
                    if (8 * sizeof(long) - 1 > 4 * PyLong_SHIFT) {
                        a = -(long) (((((((((unsigned long)digits[3]) << PyLong_SHIFT) | (unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0]));
                        break;
                    } else if (8 * sizeof(PY_LONG_LONG) - 1 > 4 * PyLong_SHIFT) {
                        lla = -(PY_LONG_LONG) (((((((((unsigned PY_LONG_LONG)digits[3]) << PyLong_SHIFT) | (unsigned PY_LONG_LONG)digits[2]) << PyLong_SHIFT) | (unsigned PY_LONG_LONG)digits[1]) << PyLong_SHIFT) | (unsigned PY_LONG_LONG)digits[0]));
                        goto long_long;
                    }
                case 4:
                    if (8 * sizeof(long) - 1 > 4 * PyLong_SHIFT) {
                        a = (long) (((((((((unsigned long)digits[3]) << PyLong_SHIFT) | (unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0]));
                        break;
                    } else if (8 * sizeof(PY_LONG_LONG) - 1 > 4 * PyLong_SHIFT) {
                        lla = (PY_LONG_LONG) (((((((((unsigned PY_LONG_LONG)digits[3]) << PyLong_SHIFT) | (unsigned PY_LONG_LONG)digits[2]) << PyLong_SHIFT) | (unsigned PY_LONG_LONG)digits[1]) << PyLong_SHIFT) | (unsigned PY_LONG_LONG)digits[0]));
                        goto long_long;
                    }
                default: return PyLong_Type.tp_as_number->nb_add(op1, op2);
            }
        }
                x = a + b;
            return PyLong_FromLong(x);
        long_long:
                llx = lla + llb;
            return PyLong_FromLongLong(llx);
    }
    #endif
    if (PyFloat_CheckExact(op1)) {
        const long b = intval;
        double a = PyFloat_AS_DOUBLE(op1);
            double result;
            PyFPE_START_PROTECT("add", return NULL)
            result = ((double)a) + (double)b;
            PyFPE_END_PROTECT(result)
            return PyFloat_FromDouble(result);
    }
    return (inplace ? PyNumber_InPlaceAdd : PyNumber_Add)(op1, op2);
}
#endif

/* PyIntBinop */
#if CYTHON_COMPILING_IN_CPYTHON
static PyObject* __Pyx_PyInt_AddCObj(PyObject *op1, PyObject *op2, CYTHON_UNUSED long intval, CYTHON_UNUSED int inplace) {
    #if PY_MAJOR_VERSION < 3
    if (likely(PyInt_CheckExact(op2))) {
        const long a = intval;
        long x;
        long b = PyInt_AS_LONG(op2);
            x = (long)((unsigned long)a + b);
            if (likely((x^a) >= 0 || (x^b) >= 0))
                return PyInt_FromLong(x);
            return PyLong_Type.tp_as_number->nb_add(op1, op2);
    }
    #endif
    #if CYTHON_USE_PYLONG_INTERNALS && PY_MAJOR_VERSION >= 3
    if (likely(PyLong_CheckExact(op2))) {
        const long a = intval;
        long b, x;
        const PY_LONG_LONG lla = intval;
        PY_LONG_LONG llb, llx;
        const digit* digits = ((PyLongObject*)op2)->ob_digit;
        const Py_ssize_t size = Py_SIZE(op2);
        if (likely(__Pyx_sst_abs(size) <= 1)) {
            b = likely(size) ? digits[0] : 0;
            if (size == -1) b = -b;
        } else {
            switch (size) {
                case -2:
                    if (8 * sizeof(long) - 1 > 2 * PyLong_SHIFT) {
                        b = -(long) (((((unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0]));
                        break;
                    } else if (8 * sizeof(PY_LONG_LONG) - 1 > 2 * PyLong_SHIFT) {
                        llb = -(PY_LONG_LONG) (((((unsigned PY_LONG_LONG)digits[1]) << PyLong_SHIFT) | (unsigned PY_LONG_LONG)digits[0]));
                        goto long_long;
                    }
                case 2:
                    if (8 * sizeof(long) - 1 > 2 * PyLong_SHIFT) {
                        b = (long) (((((unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0]));
                        break;
                    } else if (8 * sizeof(PY_LONG_LONG) - 1 > 2 * PyLong_SHIFT) {
                        llb = (PY_LONG_LONG) (((((unsigned PY_LONG_LONG)digits[1]) << PyLong_SHIFT) | (unsigned PY_LONG_LONG)digits[0]));
                        goto long_long;
                    }
                case -3:
                    if (8 * sizeof(long) - 1 > 3 * PyLong_SHIFT) {
                        b = -(long) (((((((unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0]));
                        break;
                    } else if (8 * sizeof(PY_LONG_LONG) - 1 > 3 * PyLong_SHIFT) {
                        llb = -(PY_LONG_LONG) (((((((unsigned PY_LONG_LONG)digits[2]) << PyLong_SHIFT) | (unsigned PY_LONG_LONG)digits[1]) << PyLong_SHIFT) | (unsigned PY_LONG_LONG)digits[0]));
                        goto long_long;
                    }
                case 3:
                    if (8 * sizeof(long) - 1 > 3 * PyLong_SHIFT) {
                        b = (long) (((((((unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0]));
                        break;
                    } else if (8 * sizeof(PY_LONG_LONG) - 1 > 3 * PyLong_SHIFT) {
                        llb = (PY_LONG_LONG) (((((((unsigned PY_LONG_LONG)digits[2]) << PyLong_SHIFT) | (unsigned PY_LONG_LONG)digits[1]) << PyLong_SHIFT) | (unsigned PY_LONG_LONG)digits[0]));
                        goto long_long;
                    }
                case -4:
                    if (8 * sizeof(long) - 1 > 4 * PyLong_SHIFT) {
                        b = -(long) (((((((((unsigned long)digits[3]) << PyLong_SHIFT) | (unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0]));
                        break;
                    } else if (8 * sizeof(PY_LONG_LONG) - 1 > 4 * PyLong_SHIFT) {
                        llb = -(PY_LONG_LONG) (((((((((unsigned PY_LONG_LONG)digits[3]) << PyLong_SHIFT) | (unsigned PY_LONG_LONG)digits[2]) << PyLong_SHIFT) | (unsigned PY_LONG_LONG)digits[1]) << PyLong_SHIFT) | (unsigned PY_LONG_LONG)digits[0]));
                        goto long_long;
                    }
                case 4:
                    if (8 * sizeof(long) - 1 > 4 * PyLong_SHIFT) {
                        b = (long) (((((((((unsigned long)digits[3]) << PyLong_SHIFT) | (unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0]));
                        break;
                    } else if (8 * sizeof(PY_LONG_LONG) - 1 > 4 * PyLong_SHIFT) {
                        llb = (PY_LONG_LONG) (((((((((unsigned PY_LONG_LONG)digits[3]) << PyLong_SHIFT) | (unsigned PY_LONG_LONG)digits[2]) << PyLong_SHIFT) | (unsigned PY_LONG_LONG)digits[1]) << PyLong_SHIFT) | (unsigned PY_LONG_LONG)digits[0]));
                        goto long_long;
                    }
                default: return PyLong_Type.tp_as_number->nb_add(op1, op2);
            }
        }
                x = a + b;
            return PyLong_FromLong(x);
        long_long:
                llx = lla + llb;
            return PyLong_FromLongLong(llx);
    }
    #endif
    if (PyFloat_CheckExact(op2)) {
        const long a = intval;
        double b = PyFloat_AS_DOUBLE(op2);
            double result;
            PyFPE_START_PROTECT("add", return NULL)
            result = ((double)a) + (double)b;
            PyFPE_END_PROTECT(result)
            return PyFloat_FromDouble(result);
    }
    return (inplace ? PyNumber_InPlaceAdd : PyNumber_Add)(op1, op2);
}
#endif

/* GetModuleGlobalName */
static CYTHON_INLINE PyObject *__Pyx_GetModuleGlobalName(PyObject *name) {
    PyObject *result;
#if CYTHON_COMPILING_IN_CPYTHON
    result = PyDict_GetItem(__pyx_d, name);
    if (likely(result)) {
        Py_INCREF(result);
    } else {
#else
    result = PyObject_GetItem(__pyx_d, name);
    if (!result) {
        PyErr_Clear();
#endif
        result = __Pyx_GetBuiltinName(name);
    }
    return result;
}

/* BytesEquals */
  static CYTHON_INLINE int __Pyx_PyBytes_Equals(PyObject* s1, PyObject* s2, int equals) {
#if CYTHON_COMPILING_IN_PYPY
    return PyObject_RichCompareBool(s1, s2, equals);
#else
    if (s1 == s2) {
        return (equals == Py_EQ);
    } else if (PyBytes_CheckExact(s1) & PyBytes_CheckExact(s2)) {
        const char *ps1, *ps2;
        Py_ssize_t length = PyBytes_GET_SIZE(s1);
        if (length != PyBytes_GET_SIZE(s2))
            return (equals == Py_NE);
        ps1 = PyBytes_AS_STRING(s1);
        ps2 = PyBytes_AS_STRING(s2);
        if (ps1[0] != ps2[0]) {
            return (equals == Py_NE);
        } else if (length == 1) {
            return (equals == Py_EQ);
        } else {
            int result = memcmp(ps1, ps2, (size_t)length);
            return (equals == Py_EQ) ? (result == 0) : (result != 0);
        }
    } else if ((s1 == Py_None) & PyBytes_CheckExact(s2)) {
        return (equals == Py_NE);
    } else if ((s2 == Py_None) & PyBytes_CheckExact(s1)) {
        return (equals == Py_NE);
    } else {
        int result;
        PyObject* py_result = PyObject_RichCompare(s1, s2, equals);
        if (!py_result)
            return -1;
        result = __Pyx_PyObject_IsTrue(py_result);
        Py_DECREF(py_result);
        return result;
    }
#endif
}

/* UnicodeEquals */
  static CYTHON_INLINE int __Pyx_PyUnicode_Equals(PyObject* s1, PyObject* s2, int equals) {
#if CYTHON_COMPILING_IN_PYPY
    return PyObject_RichCompareBool(s1, s2, equals);
#else
#if PY_MAJOR_VERSION < 3
    PyObject* owned_ref = NULL;
#endif
    int s1_is_unicode, s2_is_unicode;
    if (s1 == s2) {
        goto return_eq;
    }
    s1_is_unicode = PyUnicode_CheckExact(s1);
    s2_is_unicode = PyUnicode_CheckExact(s2);
#if PY_MAJOR_VERSION < 3
    if ((s1_is_unicode & (!s2_is_unicode)) && PyString_CheckExact(s2)) {
        owned_ref = PyUnicode_FromObject(s2);
        if (unlikely(!owned_ref))
            return -1;
        s2 = owned_ref;
        s2_is_unicode = 1;
    } else if ((s2_is_unicode & (!s1_is_unicode)) && PyString_CheckExact(s1)) {
        owned_ref = PyUnicode_FromObject(s1);
        if (unlikely(!owned_ref))
            return -1;
        s1 = owned_ref;
        s1_is_unicode = 1;
    } else if (((!s2_is_unicode) & (!s1_is_unicode))) {
        return __Pyx_PyBytes_Equals(s1, s2, equals);
    }
#endif
    if (s1_is_unicode & s2_is_unicode) {
        Py_ssize_t length;
        int kind;
        void *data1, *data2;
        if (unlikely(__Pyx_PyUnicode_READY(s1) < 0) || unlikely(__Pyx_PyUnicode_READY(s2) < 0))
            return -1;
        length = __Pyx_PyUnicode_GET_LENGTH(s1);
        if (length != __Pyx_PyUnicode_GET_LENGTH(s2)) {
            goto return_ne;
        }
        kind = __Pyx_PyUnicode_KIND(s1);
        if (kind != __Pyx_PyUnicode_KIND(s2)) {
            goto return_ne;
        }
        data1 = __Pyx_PyUnicode_DATA(s1);
        data2 = __Pyx_PyUnicode_DATA(s2);
        if (__Pyx_PyUnicode_READ(kind, data1, 0) != __Pyx_PyUnicode_READ(kind, data2, 0)) {
            goto return_ne;
        } else if (length == 1) {
            goto return_eq;
        } else {
            int result = memcmp(data1, data2, (size_t)(length * kind));
            #if PY_MAJOR_VERSION < 3
            Py_XDECREF(owned_ref);
            #endif
            return (equals == Py_EQ) ? (result == 0) : (result != 0);
        }
    } else if ((s1 == Py_None) & s2_is_unicode) {
        goto return_ne;
    } else if ((s2 == Py_None) & s1_is_unicode) {
        goto return_ne;
    } else {
        int result;
        PyObject* py_result = PyObject_RichCompare(s1, s2, equals);
        if (!py_result)
            return -1;
        result = __Pyx_PyObject_IsTrue(py_result);
        Py_DECREF(py_result);
        return result;
    }
return_eq:
    #if PY_MAJOR_VERSION < 3
    Py_XDECREF(owned_ref);
    #endif
    return (equals == Py_EQ);
return_ne:
    #if PY_MAJOR_VERSION < 3
    Py_XDECREF(owned_ref);
    #endif
    return (equals == Py_NE);
#endif
}

/* SetItemInt */
  static CYTHON_INLINE int __Pyx_SetItemInt_Generic(PyObject *o, PyObject *j, PyObject *v) {
    int r;
    if (!j) return -1;
    r = PyObject_SetItem(o, j, v);
    Py_DECREF(j);
    return r;
}
static CYTHON_INLINE int __Pyx_SetItemInt_Fast(PyObject *o, Py_ssize_t i, PyObject *v, int is_list,
                                               CYTHON_NCP_UNUSED int wraparound, CYTHON_NCP_UNUSED int boundscheck) {
#if CYTHON_COMPILING_IN_CPYTHON
    if (is_list || PyList_CheckExact(o)) {
        Py_ssize_t n = (!wraparound) ? i : ((likely(i >= 0)) ? i : i + PyList_GET_SIZE(o));
        if ((!boundscheck) || likely((n >= 0) & (n < PyList_GET_SIZE(o)))) {
            PyObject* old = PyList_GET_ITEM(o, n);
            Py_INCREF(v);
            PyList_SET_ITEM(o, n, v);
            Py_DECREF(old);
            return 1;
        }
    } else {
        PySequenceMethods *m = Py_TYPE(o)->tp_as_sequence;
        if (likely(m && m->sq_ass_item)) {
            if (wraparound && unlikely(i < 0) && likely(m->sq_length)) {
                Py_ssize_t l = m->sq_length(o);
                if (likely(l >= 0)) {
                    i += l;
                } else {
                    if (!PyErr_ExceptionMatches(PyExc_OverflowError))
                        return -1;
                    PyErr_Clear();
                }
            }
            return m->sq_ass_item(o, i, v);
        }
    }
#else
#if CYTHON_COMPILING_IN_PYPY
    if (is_list || (PySequence_Check(o) && !PyDict_Check(o))) {
#else
    if (is_list || PySequence_Check(o)) {
#endif
        return PySequence_SetItem(o, i, v);
    }
#endif
    return __Pyx_SetItemInt_Generic(o, PyInt_FromSsize_t(i), v);
}

/* PyObjectCallMethO */
    #if CYTHON_COMPILING_IN_CPYTHON
static CYTHON_INLINE PyObject* __Pyx_PyObject_CallMethO(PyObject *func, PyObject *arg) {
    PyObject *self, *result;
    PyCFunction cfunc;
    cfunc = PyCFunction_GET_FUNCTION(func);
    self = PyCFunction_GET_SELF(func);
    if (unlikely(Py_EnterRecursiveCall((char*)" while calling a Python object")))
        return NULL;
    result = cfunc(self, arg);
    Py_LeaveRecursiveCall();
    if (unlikely(!result) && unlikely(!PyErr_Occurred())) {
        PyErr_SetString(
            PyExc_SystemError,
            "NULL result without error in PyObject_Call");
    }
    return result;
}
#endif

/* PyObjectCallOneArg */
    #if CYTHON_COMPILING_IN_CPYTHON
static PyObject* __Pyx__PyObject_CallOneArg(PyObject *func, PyObject *arg) {
    PyObject *result;
    PyObject *args = PyTuple_New(1);
    if (unlikely(!args)) return NULL;
    Py_INCREF(arg);
    PyTuple_SET_ITEM(args, 0, arg);
    result = __Pyx_PyObject_Call(func, args, NULL);
    Py_DECREF(args);
    return result;
}
static CYTHON_INLINE PyObject* __Pyx_PyObject_CallOneArg(PyObject *func, PyObject *arg) {
#ifdef __Pyx_CyFunction_USED
    if (likely(PyCFunction_Check(func) || PyObject_TypeCheck(func, __pyx_CyFunctionType))) {
#else
    if (likely(PyCFunction_Check(func))) {
#endif
        if (likely(PyCFunction_GET_FLAGS(func) & METH_O)) {
            return __Pyx_PyObject_CallMethO(func, arg);
        }
    }
    return __Pyx__PyObject_CallOneArg(func, arg);
}
#else
static CYTHON_INLINE PyObject* __Pyx_PyObject_CallOneArg(PyObject *func, PyObject *arg) {
    PyObject *result;
    PyObject *args = PyTuple_Pack(1, arg);
    if (unlikely(!args)) return NULL;
    result = __Pyx_PyObject_Call(func, args, NULL);
    Py_DECREF(args);
    return result;
}
#endif

/* StringJoin */
      #if !CYTHON_COMPILING_IN_CPYTHON
static CYTHON_INLINE PyObject* __Pyx_PyBytes_Join(PyObject* sep, PyObject* values) {
    return PyObject_CallMethodObjArgs(sep, __pyx_n_s_join, values, NULL);
}
#endif

/* SliceObject */
      static CYTHON_INLINE PyObject* __Pyx_PyObject_GetSlice(PyObject* obj,
        Py_ssize_t cstart, Py_ssize_t cstop,
        PyObject** _py_start, PyObject** _py_stop, PyObject** _py_slice,
        int has_cstart, int has_cstop, CYTHON_UNUSED int wraparound) {
#if CYTHON_COMPILING_IN_CPYTHON
    PyMappingMethods* mp;
#if PY_MAJOR_VERSION < 3
    PySequenceMethods* ms = Py_TYPE(obj)->tp_as_sequence;
    if (likely(ms && ms->sq_slice)) {
        if (!has_cstart) {
            if (_py_start && (*_py_start != Py_None)) {
                cstart = __Pyx_PyIndex_AsSsize_t(*_py_start);
                if ((cstart == (Py_ssize_t)-1) && PyErr_Occurred()) goto bad;
            } else
                cstart = 0;
        }
        if (!has_cstop) {
            if (_py_stop && (*_py_stop != Py_None)) {
                cstop = __Pyx_PyIndex_AsSsize_t(*_py_stop);
                if ((cstop == (Py_ssize_t)-1) && PyErr_Occurred()) goto bad;
            } else
                cstop = PY_SSIZE_T_MAX;
        }
        if (wraparound && unlikely((cstart < 0) | (cstop < 0)) && likely(ms->sq_length)) {
            Py_ssize_t l = ms->sq_length(obj);
            if (likely(l >= 0)) {
                if (cstop < 0) {
                    cstop += l;
                    if (cstop < 0) cstop = 0;
                }
                if (cstart < 0) {
                    cstart += l;
                    if (cstart < 0) cstart = 0;
                }
            } else {
                if (!PyErr_ExceptionMatches(PyExc_OverflowError))
                    goto bad;
                PyErr_Clear();
            }
        }
        return ms->sq_slice(obj, cstart, cstop);
    }
#endif
    mp = Py_TYPE(obj)->tp_as_mapping;
    if (likely(mp && mp->mp_subscript))
#endif
    {
        PyObject* result;
        PyObject *py_slice, *py_start, *py_stop;
        if (_py_slice) {
            py_slice = *_py_slice;
        } else {
            PyObject* owned_start = NULL;
            PyObject* owned_stop = NULL;
            if (_py_start) {
                py_start = *_py_start;
            } else {
                if (has_cstart) {
                    owned_start = py_start = PyInt_FromSsize_t(cstart);
                    if (unlikely(!py_start)) goto bad;
                } else
                    py_start = Py_None;
            }
            if (_py_stop) {
                py_stop = *_py_stop;
            } else {
                if (has_cstop) {
                    owned_stop = py_stop = PyInt_FromSsize_t(cstop);
                    if (unlikely(!py_stop)) {
                        Py_XDECREF(owned_start);
                        goto bad;
                    }
                } else
                    py_stop = Py_None;
            }
            py_slice = PySlice_New(py_start, py_stop, Py_None);
            Py_XDECREF(owned_start);
            Py_XDECREF(owned_stop);
            if (unlikely(!py_slice)) goto bad;
        }
#if CYTHON_COMPILING_IN_CPYTHON
        result = mp->mp_subscript(obj, py_slice);
#else
        result = PyObject_GetItem(obj, py_slice);
#endif
        if (!_py_slice) {
            Py_DECREF(py_slice);
        }
        return result;
    }
    PyErr_Format(PyExc_TypeError,
        "'%.200s' object is unsliceable", Py_TYPE(obj)->tp_name);
bad:
    return NULL;
}

/* None */
      static CYTHON_INLINE void __Pyx_RaiseUnboundLocalError(const char *varname) {
    PyErr_Format(PyExc_UnboundLocalError, "local variable '%s' referenced before assignment", varname);
}

/* PyIntBinop */
      #if CYTHON_COMPILING_IN_CPYTHON
static PyObject* __Pyx_PyInt_EqObjC(PyObject *op1, PyObject *op2, CYTHON_UNUSED long intval, CYTHON_UNUSED int inplace) {
    if (op1 == op2) {
        Py_RETURN_TRUE;
    }
    #if PY_MAJOR_VERSION < 3
    if (likely(PyInt_CheckExact(op1))) {
        const long b = intval;
        long a = PyInt_AS_LONG(op1);
        if (a == b) {
            Py_RETURN_TRUE;
        } else {
            Py_RETURN_FALSE;
        }
    }
    #endif
    #if CYTHON_USE_PYLONG_INTERNALS && PY_MAJOR_VERSION >= 3
    if (likely(PyLong_CheckExact(op1))) {
        const long b = intval;
        long a;
        const digit* digits = ((PyLongObject*)op1)->ob_digit;
        const Py_ssize_t size = Py_SIZE(op1);
        if (likely(__Pyx_sst_abs(size) <= 1)) {
            a = likely(size) ? digits[0] : 0;
            if (size == -1) a = -a;
        } else {
            switch (size) {
                case -2:
                    if (8 * sizeof(long) - 1 > 2 * PyLong_SHIFT) {
                        a = -(long) (((((unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0]));
                        break;
                    }
                case 2:
                    if (8 * sizeof(long) - 1 > 2 * PyLong_SHIFT) {
                        a = (long) (((((unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0]));
                        break;
                    }
                case -3:
                    if (8 * sizeof(long) - 1 > 3 * PyLong_SHIFT) {
                        a = -(long) (((((((unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0]));
                        break;
                    }
                case 3:
                    if (8 * sizeof(long) - 1 > 3 * PyLong_SHIFT) {
                        a = (long) (((((((unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0]));
                        break;
                    }
                case -4:
                    if (8 * sizeof(long) - 1 > 4 * PyLong_SHIFT) {
                        a = -(long) (((((((((unsigned long)digits[3]) << PyLong_SHIFT) | (unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0]));
                        break;
                    }
                case 4:
                    if (8 * sizeof(long) - 1 > 4 * PyLong_SHIFT) {
                        a = (long) (((((((((unsigned long)digits[3]) << PyLong_SHIFT) | (unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0]));
                        break;
                    }
                #if PyLong_SHIFT < 30 && PyLong_SHIFT != 15
                default: return PyLong_Type.tp_richcompare(op1, op2, Py_EQ);
                #else
                default: Py_RETURN_FALSE;
                #endif
            }
        }
            if (a == b) {
                Py_RETURN_TRUE;
            } else {
                Py_RETURN_FALSE;
            }
    }
    #endif
    if (PyFloat_CheckExact(op1)) {
        const long b = intval;
        double a = PyFloat_AS_DOUBLE(op1);
            if ((double)a == (double)b) {
                Py_RETURN_TRUE;
            } else {
                Py_RETURN_FALSE;
            }
    }
    return PyObject_RichCompare(op1, op2, Py_EQ);
}
#endif

/* PyObjectCallMethod1 */
      static PyObject* __Pyx_PyObject_CallMethod1(PyObject* obj, PyObject* method_name, PyObject* arg) {
    PyObject *method, *result = NULL;
    method = __Pyx_PyObject_GetAttrStr(obj, method_name);
    if (unlikely(!method)) goto bad;
#if CYTHON_COMPILING_IN_CPYTHON
    if (likely(PyMethod_Check(method))) {
        PyObject *self = PyMethod_GET_SELF(method);
        if (likely(self)) {
            PyObject *args;
            PyObject *function = PyMethod_GET_FUNCTION(method);
            args = PyTuple_New(2);
            if (unlikely(!args)) goto bad;
            Py_INCREF(self);
            PyTuple_SET_ITEM(args, 0, self);
            Py_INCREF(arg);
            PyTuple_SET_ITEM(args, 1, arg);
            Py_INCREF(function);
            Py_DECREF(method); method = NULL;
            result = __Pyx_PyObject_Call(function, args, NULL);
            Py_DECREF(args);
            Py_DECREF(function);
            return result;
        }
    }
#endif
    result = __Pyx_PyObject_CallOneArg(method, arg);
bad:
    Py_XDECREF(method);
    return result;
}

/* append */
      static CYTHON_INLINE int __Pyx_PyObject_Append(PyObject* L, PyObject* x) {
    if (likely(PyList_CheckExact(L))) {
        if (unlikely(__Pyx_PyList_Append(L, x) < 0)) return -1;
    } else {
        PyObject* retval = __Pyx_PyObject_CallMethod1(L, __pyx_n_s_append, x);
        if (unlikely(!retval))
            return -1;
        Py_DECREF(retval);
    }
    return 0;
}

/* UnpackUnboundCMethod */
      static int __Pyx_TryUnpackUnboundCMethod(__Pyx_CachedCFunction* target) {
    PyObject *method;
    method = __Pyx_PyObject_GetAttrStr(target->type, *target->method_name);
    if (unlikely(!method))
        return -1;
    target->method = method;
#if CYTHON_COMPILING_IN_CPYTHON
    #if PY_MAJOR_VERSION >= 3
    if (likely(PyObject_TypeCheck(method, &PyMethodDescr_Type)))
    #endif
    {
        PyMethodDescrObject *descr = (PyMethodDescrObject*) method;
        target->func = descr->d_method->ml_meth;
        target->flag = descr->d_method->ml_flags & (METH_VARARGS | METH_KEYWORDS | METH_O | METH_NOARGS);
    }
#endif
    return 0;
}

/* CallUnboundCMethod0 */
      static PyObject* __Pyx__CallUnboundCMethod0(__Pyx_CachedCFunction* cfunc, PyObject* self) {
    PyObject *args, *result = NULL;
    if (unlikely(!cfunc->method) && unlikely(__Pyx_TryUnpackUnboundCMethod(cfunc) < 0)) return NULL;
#if CYTHON_COMPILING_IN_CPYTHON
    args = PyTuple_New(1);
    if (unlikely(!args)) goto bad;
    Py_INCREF(self);
    PyTuple_SET_ITEM(args, 0, self);
#else
    args = PyTuple_Pack(1, self);
    if (unlikely(!args)) goto bad;
#endif
    result = __Pyx_PyObject_Call(cfunc->method, args, NULL);
    Py_DECREF(args);
bad:
    return result;
}

/* py_dict_keys */
      static CYTHON_INLINE PyObject* __Pyx_PyDict_Keys(PyObject* d) {
    if (PY_MAJOR_VERSION >= 3)
        return __Pyx_CallUnboundCMethod0(&__pyx_umethod_PyDict_Type_keys, d);
    else
        return PyDict_Keys(d);
}

/* None */
      static CYTHON_INLINE Py_ssize_t __Pyx_div_Py_ssize_t(Py_ssize_t a, Py_ssize_t b) {
    Py_ssize_t q = a / b;
    Py_ssize_t r = a - q*b;
    q -= ((r != 0) & ((r ^ b) < 0));
    return q;
}

/* pyobject_as_double */
      static double __Pyx__PyObject_AsDouble(PyObject* obj) {
    PyObject* float_value;
#if CYTHON_COMPILING_IN_PYPY
    float_value = PyNumber_Float(obj);  if (0) goto bad;
#else
    PyNumberMethods *nb = Py_TYPE(obj)->tp_as_number;
    if (likely(nb) && likely(nb->nb_float)) {
        float_value = nb->nb_float(obj);
        if (likely(float_value) && unlikely(!PyFloat_Check(float_value))) {
            PyErr_Format(PyExc_TypeError,
                "__float__ returned non-float (type %.200s)",
                Py_TYPE(float_value)->tp_name);
            Py_DECREF(float_value);
            goto bad;
        }
    } else if (PyUnicode_CheckExact(obj) || PyBytes_CheckExact(obj)) {
#if PY_MAJOR_VERSION >= 3
        float_value = PyFloat_FromString(obj);
#else
        float_value = PyFloat_FromString(obj, 0);
#endif
    } else {
        PyObject* args = PyTuple_New(1);
        if (unlikely(!args)) goto bad;
        PyTuple_SET_ITEM(args, 0, obj);
        float_value = PyObject_Call((PyObject*)&PyFloat_Type, args, 0);
        PyTuple_SET_ITEM(args, 0, 0);
        Py_DECREF(args);
    }
#endif
    if (likely(float_value)) {
        double value = PyFloat_AS_DOUBLE(float_value);
        Py_DECREF(float_value);
        return value;
    }
bad:
    return (double)-1;
}

/* RaiseTooManyValuesToUnpack */
      static CYTHON_INLINE void __Pyx_RaiseTooManyValuesError(Py_ssize_t expected) {
    PyErr_Format(PyExc_ValueError,
                 "too many values to unpack (expected %" CYTHON_FORMAT_SSIZE_T "d)", expected);
}

/* RaiseNeedMoreValuesToUnpack */
      static CYTHON_INLINE void __Pyx_RaiseNeedMoreValuesError(Py_ssize_t index) {
    PyErr_Format(PyExc_ValueError,
                 "need more than %" CYTHON_FORMAT_SSIZE_T "d value%.1s to unpack",
                 index, (index == 1) ? "" : "s");
}

/* IterFinish */
      static CYTHON_INLINE int __Pyx_IterFinish(void) {
#if CYTHON_COMPILING_IN_CPYTHON
    PyThreadState *tstate = PyThreadState_GET();
    PyObject* exc_type = tstate->curexc_type;
    if (unlikely(exc_type)) {
        if (likely(exc_type == PyExc_StopIteration) || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration)) {
            PyObject *exc_value, *exc_tb;
            exc_value = tstate->curexc_value;
            exc_tb = tstate->curexc_traceback;
            tstate->curexc_type = 0;
            tstate->curexc_value = 0;
            tstate->curexc_traceback = 0;
            Py_DECREF(exc_type);
            Py_XDECREF(exc_value);
            Py_XDECREF(exc_tb);
            return 0;
        } else {
            return -1;
        }
    }
    return 0;
#else
    if (unlikely(PyErr_Occurred())) {
        if (likely(PyErr_ExceptionMatches(PyExc_StopIteration))) {
            PyErr_Clear();
            return 0;
        } else {
            return -1;
        }
    }
    return 0;
#endif
}

/* UnpackItemEndCheck */
      static int __Pyx_IternextUnpackEndCheck(PyObject *retval, Py_ssize_t expected) {
    if (unlikely(retval)) {
        Py_DECREF(retval);
        __Pyx_RaiseTooManyValuesError(expected);
        return -1;
    } else {
        return __Pyx_IterFinish();
    }
    return 0;
}

/* Import */
      static PyObject *__Pyx_Import(PyObject *name, PyObject *from_list, int level) {
    PyObject *empty_list = 0;
    PyObject *module = 0;
    PyObject *global_dict = 0;
    PyObject *empty_dict = 0;
    PyObject *list;
    #if PY_VERSION_HEX < 0x03030000
    PyObject *py_import;
    py_import = __Pyx_PyObject_GetAttrStr(__pyx_b, __pyx_n_s_import);
    if (!py_import)
        goto bad;
    #endif
    if (from_list)
        list = from_list;
    else {
        empty_list = PyList_New(0);
        if (!empty_list)
            goto bad;
        list = empty_list;
    }
    global_dict = PyModule_GetDict(__pyx_m);
    if (!global_dict)
        goto bad;
    empty_dict = PyDict_New();
    if (!empty_dict)
        goto bad;
    {
        #if PY_MAJOR_VERSION >= 3
        if (level == -1) {
            if (strchr(__Pyx_MODULE_NAME, '.')) {
                #if PY_VERSION_HEX < 0x03030000
                PyObject *py_level = PyInt_FromLong(1);
                if (!py_level)
                    goto bad;
                module = PyObject_CallFunctionObjArgs(py_import,
                    name, global_dict, empty_dict, list, py_level, NULL);
                Py_DECREF(py_level);
                #else
                module = PyImport_ImportModuleLevelObject(
                    name, global_dict, empty_dict, list, 1);
                #endif
                if (!module) {
                    if (!PyErr_ExceptionMatches(PyExc_ImportError))
                        goto bad;
                    PyErr_Clear();
                }
            }
            level = 0;
        }
        #endif
        if (!module) {
            #if PY_VERSION_HEX < 0x03030000
            PyObject *py_level = PyInt_FromLong(level);
            if (!py_level)
                goto bad;
            module = PyObject_CallFunctionObjArgs(py_import,
                name, global_dict, empty_dict, list, py_level, NULL);
            Py_DECREF(py_level);
            #else
            module = PyImport_ImportModuleLevelObject(
                name, global_dict, empty_dict, list, level);
            #endif
        }
    }
bad:
    #if PY_VERSION_HEX < 0x03030000
    Py_XDECREF(py_import);
    #endif
    Py_XDECREF(empty_list);
    Py_XDECREF(empty_dict);
    return module;
}

/* PyObjectCallNoArg */
      #if CYTHON_COMPILING_IN_CPYTHON
static CYTHON_INLINE PyObject* __Pyx_PyObject_CallNoArg(PyObject *func) {
#ifdef __Pyx_CyFunction_USED
    if (likely(PyCFunction_Check(func) || PyObject_TypeCheck(func, __pyx_CyFunctionType))) {
#else
    if (likely(PyCFunction_Check(func))) {
#endif
        if (likely(PyCFunction_GET_FLAGS(func) & METH_NOARGS)) {
            return __Pyx_PyObject_CallMethO(func, NULL);
        }
    }
    return __Pyx_PyObject_Call(func, __pyx_empty_tuple, NULL);
}
#endif

/* PyIntBinop */
        #if CYTHON_COMPILING_IN_CPYTHON
static PyObject* __Pyx_PyInt_SubtractObjC(PyObject *op1, PyObject *op2, CYTHON_UNUSED long intval, CYTHON_UNUSED int inplace) {
    #if PY_MAJOR_VERSION < 3
    if (likely(PyInt_CheckExact(op1))) {
        const long b = intval;
        long x;
        long a = PyInt_AS_LONG(op1);
            x = (long)((unsigned long)a - b);
            if (likely((x^a) >= 0 || (x^~b) >= 0))
                return PyInt_FromLong(x);
            return PyLong_Type.tp_as_number->nb_subtract(op1, op2);
    }
    #endif
    #if CYTHON_USE_PYLONG_INTERNALS && PY_MAJOR_VERSION >= 3
    if (likely(PyLong_CheckExact(op1))) {
        const long b = intval;
        long a, x;
        const PY_LONG_LONG llb = intval;
        PY_LONG_LONG lla, llx;
        const digit* digits = ((PyLongObject*)op1)->ob_digit;
        const Py_ssize_t size = Py_SIZE(op1);
        if (likely(__Pyx_sst_abs(size) <= 1)) {
            a = likely(size) ? digits[0] : 0;
            if (size == -1) a = -a;
        } else {
            switch (size) {
                case -2:
                    if (8 * sizeof(long) - 1 > 2 * PyLong_SHIFT) {
                        a = -(long) (((((unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0]));
                        break;
                    } else if (8 * sizeof(PY_LONG_LONG) - 1 > 2 * PyLong_SHIFT) {
                        lla = -(PY_LONG_LONG) (((((unsigned PY_LONG_LONG)digits[1]) << PyLong_SHIFT) | (unsigned PY_LONG_LONG)digits[0]));
                        goto long_long;
                    }
                case 2:
                    if (8 * sizeof(long) - 1 > 2 * PyLong_SHIFT) {
                        a = (long) (((((unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0]));
                        break;
                    } else if (8 * sizeof(PY_LONG_LONG) - 1 > 2 * PyLong_SHIFT) {
                        lla = (PY_LONG_LONG) (((((unsigned PY_LONG_LONG)digits[1]) << PyLong_SHIFT) | (unsigned PY_LONG_LONG)digits[0]));
                        goto long_long;
                    }
                case -3:
                    if (8 * sizeof(long) - 1 > 3 * PyLong_SHIFT) {
                        a = -(long) (((((((unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0]));
                        break;
                    } else if (8 * sizeof(PY_LONG_LONG) - 1 > 3 * PyLong_SHIFT) {
                        lla = -(PY_LONG_LONG) (((((((unsigned PY_LONG_LONG)digits[2]) << PyLong_SHIFT) | (unsigned PY_LONG_LONG)digits[1]) << PyLong_SHIFT) | (unsigned PY_LONG_LONG)digits[0]));
                        goto long_long;
                    }
                case 3:
                    if (8 * sizeof(long) - 1 > 3 * PyLong_SHIFT) {
                        a = (long) (((((((unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0]));
                        break;
                    } else if (8 * sizeof(PY_LONG_LONG) - 1 > 3 * PyLong_SHIFT) {
                        lla = (PY_LONG_LONG) (((((((unsigned PY_LONG_LONG)digits[2]) << PyLong_SHIFT) | (unsigned PY_LONG_LONG)digits[1]) << PyLong_SHIFT) | (unsigned PY_LONG_LONG)digits[0]));
                        goto long_long;
                    }
                case -4:
                    if (8 * sizeof(long) - 1 > 4 * PyLong_SHIFT) {
                        a = -(long) (((((((((unsigned long)digits[3]) << PyLong_SHIFT) | (unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0]));
                        break;
                    } else if (8 * sizeof(PY_LONG_LONG) - 1 > 4 * PyLong_SHIFT) {
                        lla = -(PY_LONG_LONG) (((((((((unsigned PY_LONG_LONG)digits[3]) << PyLong_SHIFT) | (unsigned PY_LONG_LONG)digits[2]) << PyLong_SHIFT) | (unsigned PY_LONG_LONG)digits[1]) << PyLong_SHIFT) | (unsigned PY_LONG_LONG)digits[0]));
                        goto long_long;
                    }
                case 4:
                    if (8 * sizeof(long) - 1 > 4 * PyLong_SHIFT) {
                        a = (long) (((((((((unsigned long)digits[3]) << PyLong_SHIFT) | (unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0]));
                        break;
                    } else if (8 * sizeof(PY_LONG_LONG) - 1 > 4 * PyLong_SHIFT) {
                        lla = (PY_LONG_LONG) (((((((((unsigned PY_LONG_LONG)digits[3]) << PyLong_SHIFT) | (unsigned PY_LONG_LONG)digits[2]) << PyLong_SHIFT) | (unsigned PY_LONG_LONG)digits[1]) << PyLong_SHIFT) | (unsigned PY_LONG_LONG)digits[0]));
                        goto long_long;
                    }
                default: return PyLong_Type.tp_as_number->nb_subtract(op1, op2);
            }
        }
                x = a - b;
            return PyLong_FromLong(x);
        long_long:
                llx = lla - llb;
            return PyLong_FromLongLong(llx);
    }
    #endif
    if (PyFloat_CheckExact(op1)) {
        const long b = intval;
        double a = PyFloat_AS_DOUBLE(op1);
            double result;
            PyFPE_START_PROTECT("subtract", return NULL)
            result = ((double)a) - (double)b;
            PyFPE_END_PROTECT(result)
            return PyFloat_FromDouble(result);
    }
    return (inplace ? PyNumber_InPlaceSubtract : PyNumber_Subtract)(op1, op2);
}
#endif

/* PyFloatBinop */
        #if CYTHON_COMPILING_IN_CPYTHON
static PyObject* __Pyx_PyFloat_DivideCObj(PyObject *op1, PyObject *op2, double floatval, CYTHON_UNUSED int inplace) {
    const double a = floatval;
    double b, result;
    if (likely(PyFloat_CheckExact(op2))) {
        b = PyFloat_AS_DOUBLE(op2);
    } else
    #if PY_MAJOR_VERSION < 3
    if (likely(PyInt_CheckExact(op2))) {
        b = (double) PyInt_AS_LONG(op2);
    } else
    #endif
    if (likely(PyLong_CheckExact(op2))) {
        #if CYTHON_USE_PYLONG_INTERNALS && PY_MAJOR_VERSION >= 3
        const digit* digits = ((PyLongObject*)op2)->ob_digit;
        const Py_ssize_t size = Py_SIZE(op2);
        switch (size) {
            case  0: b = 0.0; break;
            case -1: b = -(double) digits[0]; break;
            case  1: b = (double) digits[0]; break;
            case -2:
            case 2:
                if (8 * sizeof(unsigned long) > 2 * PyLong_SHIFT && ((8 * sizeof(unsigned long) < 53) || (1 * PyLong_SHIFT < 53))) {
                    b = (double) (((((unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0]));
                    if ((8 * sizeof(unsigned long) < 53) || (2 * PyLong_SHIFT < 53) || (b < (double) (1L<<53))) {
                        if (size == -2)
                            b = -b;
                        break;
                    }
                }
            case -3:
            case 3:
                if (8 * sizeof(unsigned long) > 3 * PyLong_SHIFT && ((8 * sizeof(unsigned long) < 53) || (2 * PyLong_SHIFT < 53))) {
                    b = (double) (((((((unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0]));
                    if ((8 * sizeof(unsigned long) < 53) || (3 * PyLong_SHIFT < 53) || (b < (double) (1L<<53))) {
                        if (size == -3)
                            b = -b;
                        break;
                    }
                }
            case -4:
            case 4:
                if (8 * sizeof(unsigned long) > 4 * PyLong_SHIFT && ((8 * sizeof(unsigned long) < 53) || (3 * PyLong_SHIFT < 53))) {
                    b = (double) (((((((((unsigned long)digits[3]) << PyLong_SHIFT) | (unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0]));
                    if ((8 * sizeof(unsigned long) < 53) || (4 * PyLong_SHIFT < 53) || (b < (double) (1L<<53))) {
                        if (size == -4)
                            b = -b;
                        break;
                    }
                }
            default:
        #else
        {
        #endif
            b = PyLong_AsDouble(op2);
            if (unlikely(b == -1.0 && PyErr_Occurred())) return NULL;
        }
    } else {
        return (inplace ? __Pyx_PyNumber_InPlaceDivide(op1, op2) : __Pyx_PyNumber_Divide(op1, op2));
    }
        PyFPE_START_PROTECT("divide", return NULL)
        result = a / b;
        PyFPE_END_PROTECT(result)
        return PyFloat_FromDouble(result);
}
#endif

/* SliceTupleAndList */
          #if CYTHON_COMPILING_IN_CPYTHON
static CYTHON_INLINE void __Pyx_crop_slice(Py_ssize_t* _start, Py_ssize_t* _stop, Py_ssize_t* _length) {
    Py_ssize_t start = *_start, stop = *_stop, length = *_length;
    if (start < 0) {
        start += length;
        if (start < 0)
            start = 0;
    }
    if (stop < 0)
        stop += length;
    else if (stop > length)
        stop = length;
    *_length = stop - start;
    *_start = start;
    *_stop = stop;
}
static CYTHON_INLINE void __Pyx_copy_object_array(PyObject** CYTHON_RESTRICT src, PyObject** CYTHON_RESTRICT dest, Py_ssize_t length) {
    PyObject *v;
    Py_ssize_t i;
    for (i = 0; i < length; i++) {
        v = dest[i] = src[i];
        Py_INCREF(v);
    }
}
static CYTHON_INLINE PyObject* __Pyx_PyList_GetSlice(
            PyObject* src, Py_ssize_t start, Py_ssize_t stop) {
    PyObject* dest;
    Py_ssize_t length = PyList_GET_SIZE(src);
    __Pyx_crop_slice(&start, &stop, &length);
    if (unlikely(length <= 0))
        return PyList_New(0);
    dest = PyList_New(length);
    if (unlikely(!dest))
        return NULL;
    __Pyx_copy_object_array(
        ((PyListObject*)src)->ob_item + start,
        ((PyListObject*)dest)->ob_item,
        length);
    return dest;
}
static CYTHON_INLINE PyObject* __Pyx_PyTuple_GetSlice(
            PyObject* src, Py_ssize_t start, Py_ssize_t stop) {
    PyObject* dest;
    Py_ssize_t length = PyTuple_GET_SIZE(src);
    __Pyx_crop_slice(&start, &stop, &length);
    if (unlikely(length <= 0))
        return PyTuple_New(0);
    dest = PyTuple_New(length);
    if (unlikely(!dest))
        return NULL;
    __Pyx_copy_object_array(
        ((PyTupleObject*)src)->ob_item + start,
        ((PyTupleObject*)dest)->ob_item,
        length);
    return dest;
}
#endif

/* PyFloatBinop */
          #if CYTHON_COMPILING_IN_CPYTHON
static PyObject* __Pyx_PyFloat_DivideObjC(PyObject *op1, PyObject *op2, double floatval, CYTHON_UNUSED int inplace) {
    const double b = floatval;
    double a, result;
    if (likely(PyFloat_CheckExact(op1))) {
        a = PyFloat_AS_DOUBLE(op1);
    } else
    #if PY_MAJOR_VERSION < 3
    if (likely(PyInt_CheckExact(op1))) {
        a = (double) PyInt_AS_LONG(op1);
    } else
    #endif
    if (likely(PyLong_CheckExact(op1))) {
        #if CYTHON_USE_PYLONG_INTERNALS && PY_MAJOR_VERSION >= 3
        const digit* digits = ((PyLongObject*)op1)->ob_digit;
        const Py_ssize_t size = Py_SIZE(op1);
        switch (size) {
            case  0: a = 0.0; break;
            case -1: a = -(double) digits[0]; break;
            case  1: a = (double) digits[0]; break;
            case -2:
            case 2:
                if (8 * sizeof(unsigned long) > 2 * PyLong_SHIFT && ((8 * sizeof(unsigned long) < 53) || (1 * PyLong_SHIFT < 53))) {
                    a = (double) (((((unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0]));
                    if ((8 * sizeof(unsigned long) < 53) || (2 * PyLong_SHIFT < 53) || (a < (double) (1L<<53))) {
                        if (size == -2)
                            a = -a;
                        break;
                    }
                }
            case -3:
            case 3:
                if (8 * sizeof(unsigned long) > 3 * PyLong_SHIFT && ((8 * sizeof(unsigned long) < 53) || (2 * PyLong_SHIFT < 53))) {
                    a = (double) (((((((unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0]));
                    if ((8 * sizeof(unsigned long) < 53) || (3 * PyLong_SHIFT < 53) || (a < (double) (1L<<53))) {
                        if (size == -3)
                            a = -a;
                        break;
                    }
                }
            case -4:
            case 4:
                if (8 * sizeof(unsigned long) > 4 * PyLong_SHIFT && ((8 * sizeof(unsigned long) < 53) || (3 * PyLong_SHIFT < 53))) {
                    a = (double) (((((((((unsigned long)digits[3]) << PyLong_SHIFT) | (unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0]));
                    if ((8 * sizeof(unsigned long) < 53) || (4 * PyLong_SHIFT < 53) || (a < (double) (1L<<53))) {
                        if (size == -4)
                            a = -a;
                        break;
                    }
                }
            default:
        #else
        {
        #endif
            a = PyLong_AsDouble(op1);
            if (unlikely(a == -1.0 && PyErr_Occurred())) return NULL;
        }
    } else {
        return (inplace ? __Pyx_PyNumber_InPlaceDivide(op1, op2) : __Pyx_PyNumber_Divide(op1, op2));
    }
        PyFPE_START_PROTECT("divide", return NULL)
        result = a / b;
        PyFPE_END_PROTECT(result)
        return PyFloat_FromDouble(result);
}
#endif

/* UnicodeAsUCS4 */
            static CYTHON_INLINE Py_UCS4 __Pyx_PyUnicode_AsPy_UCS4(PyObject* x) {
   Py_ssize_t length;
   #if CYTHON_PEP393_ENABLED
   length = PyUnicode_GET_LENGTH(x);
   if (likely(length == 1)) {
       return PyUnicode_READ_CHAR(x, 0);
   }
   #else
   length = PyUnicode_GET_SIZE(x);
   if (likely(length == 1)) {
       return PyUnicode_AS_UNICODE(x)[0];
   }
   #if Py_UNICODE_SIZE == 2
   else if (PyUnicode_GET_SIZE(x) == 2) {
       Py_UCS4 high_val = PyUnicode_AS_UNICODE(x)[0];
       if (high_val >= 0xD800 && high_val <= 0xDBFF) {
           Py_UCS4 low_val = PyUnicode_AS_UNICODE(x)[1];
           if (low_val >= 0xDC00 && low_val <= 0xDFFF) {
               return 0x10000 + (((high_val & ((1<<10)-1)) << 10) | (low_val & ((1<<10)-1)));
           }
       }
   }
   #endif
   #endif
   PyErr_Format(PyExc_ValueError,
                "only single character unicode strings can be converted to Py_UCS4, "
                "got length %" CYTHON_FORMAT_SSIZE_T "d", length);
   return (Py_UCS4)-1;
}

/* object_ord */
            static long __Pyx__PyObject_Ord(PyObject* c) {
    Py_ssize_t size;
    if (PyBytes_Check(c)) {
        size = PyBytes_GET_SIZE(c);
        if (likely(size == 1)) {
            return (unsigned char) PyBytes_AS_STRING(c)[0];
        }
#if PY_MAJOR_VERSION < 3
    } else if (PyUnicode_Check(c)) {
        return (long)__Pyx_PyUnicode_AsPy_UCS4(c);
#endif
#if (!CYTHON_COMPILING_IN_PYPY) || (defined(PyByteArray_AS_STRING) && defined(PyByteArray_GET_SIZE))
    } else if (PyByteArray_Check(c)) {
        size = PyByteArray_GET_SIZE(c);
        if (likely(size == 1)) {
            return (unsigned char) PyByteArray_AS_STRING(c)[0];
        }
#endif
    } else {
        PyErr_Format(PyExc_TypeError,
            "ord() expected string of length 1, but %.200s found", c->ob_type->tp_name);
        return (long)(Py_UCS4)-1;
    }
    PyErr_Format(PyExc_TypeError,
        "ord() expected a character, but string of length %zd found", size);
    return (long)(Py_UCS4)-1;
}

/* PyIntBinop */
            #if CYTHON_COMPILING_IN_CPYTHON
static PyObject* __Pyx_PyInt_SubtractCObj(PyObject *op1, PyObject *op2, CYTHON_UNUSED long intval, CYTHON_UNUSED int inplace) {
    #if PY_MAJOR_VERSION < 3
    if (likely(PyInt_CheckExact(op2))) {
        const long a = intval;
        long x;
        long b = PyInt_AS_LONG(op2);
            x = (long)((unsigned long)a - b);
            if (likely((x^a) >= 0 || (x^~b) >= 0))
                return PyInt_FromLong(x);
            return PyLong_Type.tp_as_number->nb_subtract(op1, op2);
    }
    #endif
    #if CYTHON_USE_PYLONG_INTERNALS && PY_MAJOR_VERSION >= 3
    if (likely(PyLong_CheckExact(op2))) {
        const long a = intval;
        long b, x;
        const PY_LONG_LONG lla = intval;
        PY_LONG_LONG llb, llx;
        const digit* digits = ((PyLongObject*)op2)->ob_digit;
        const Py_ssize_t size = Py_SIZE(op2);
        if (likely(__Pyx_sst_abs(size) <= 1)) {
            b = likely(size) ? digits[0] : 0;
            if (size == -1) b = -b;
        } else {
            switch (size) {
                case -2:
                    if (8 * sizeof(long) - 1 > 2 * PyLong_SHIFT) {
                        b = -(long) (((((unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0]));
                        break;
                    } else if (8 * sizeof(PY_LONG_LONG) - 1 > 2 * PyLong_SHIFT) {
                        llb = -(PY_LONG_LONG) (((((unsigned PY_LONG_LONG)digits[1]) << PyLong_SHIFT) | (unsigned PY_LONG_LONG)digits[0]));
                        goto long_long;
                    }
                case 2:
                    if (8 * sizeof(long) - 1 > 2 * PyLong_SHIFT) {
                        b = (long) (((((unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0]));
                        break;
                    } else if (8 * sizeof(PY_LONG_LONG) - 1 > 2 * PyLong_SHIFT) {
                        llb = (PY_LONG_LONG) (((((unsigned PY_LONG_LONG)digits[1]) << PyLong_SHIFT) | (unsigned PY_LONG_LONG)digits[0]));
                        goto long_long;
                    }
                case -3:
                    if (8 * sizeof(long) - 1 > 3 * PyLong_SHIFT) {
                        b = -(long) (((((((unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0]));
                        break;
                    } else if (8 * sizeof(PY_LONG_LONG) - 1 > 3 * PyLong_SHIFT) {
                        llb = -(PY_LONG_LONG) (((((((unsigned PY_LONG_LONG)digits[2]) << PyLong_SHIFT) | (unsigned PY_LONG_LONG)digits[1]) << PyLong_SHIFT) | (unsigned PY_LONG_LONG)digits[0]));
                        goto long_long;
                    }
                case 3:
                    if (8 * sizeof(long) - 1 > 3 * PyLong_SHIFT) {
                        b = (long) (((((((unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0]));
                        break;
                    } else if (8 * sizeof(PY_LONG_LONG) - 1 > 3 * PyLong_SHIFT) {
                        llb = (PY_LONG_LONG) (((((((unsigned PY_LONG_LONG)digits[2]) << PyLong_SHIFT) | (unsigned PY_LONG_LONG)digits[1]) << PyLong_SHIFT) | (unsigned PY_LONG_LONG)digits[0]));
                        goto long_long;
                    }
                case -4:
                    if (8 * sizeof(long) - 1 > 4 * PyLong_SHIFT) {
                        b = -(long) (((((((((unsigned long)digits[3]) << PyLong_SHIFT) | (unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0]));
                        break;
                    } else if (8 * sizeof(PY_LONG_LONG) - 1 > 4 * PyLong_SHIFT) {
                        llb = -(PY_LONG_LONG) (((((((((unsigned PY_LONG_LONG)digits[3]) << PyLong_SHIFT) | (unsigned PY_LONG_LONG)digits[2]) << PyLong_SHIFT) | (unsigned PY_LONG_LONG)digits[1]) << PyLong_SHIFT) | (unsigned PY_LONG_LONG)digits[0]));
                        goto long_long;
                    }
                case 4:
                    if (8 * sizeof(long) - 1 > 4 * PyLong_SHIFT) {
                        b = (long) (((((((((unsigned long)digits[3]) << PyLong_SHIFT) | (unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0]));
                        break;
                    } else if (8 * sizeof(PY_LONG_LONG) - 1 > 4 * PyLong_SHIFT) {
                        llb = (PY_LONG_LONG) (((((((((unsigned PY_LONG_LONG)digits[3]) << PyLong_SHIFT) | (unsigned PY_LONG_LONG)digits[2]) << PyLong_SHIFT) | (unsigned PY_LONG_LONG)digits[1]) << PyLong_SHIFT) | (unsigned PY_LONG_LONG)digits[0]));
                        goto long_long;
                    }
                default: return PyLong_Type.tp_as_number->nb_subtract(op1, op2);
            }
        }
                x = a - b;
            return PyLong_FromLong(x);
        long_long:
                llx = lla - llb;
            return PyLong_FromLongLong(llx);
    }
    #endif
    if (PyFloat_CheckExact(op2)) {
        const long a = intval;
        double b = PyFloat_AS_DOUBLE(op2);
            double result;
            PyFPE_START_PROTECT("subtract", return NULL)
            result = ((double)a) - (double)b;
            PyFPE_END_PROTECT(result)
            return PyFloat_FromDouble(result);
    }
    return (inplace ? PyNumber_InPlaceSubtract : PyNumber_Subtract)(op1, op2);
}
#endif

/* None */
            static CYTHON_INLINE void __Pyx_RaiseClosureNameError(const char *varname) {
    PyErr_Format(PyExc_NameError, "free variable '%s' referenced before assignment in enclosing scope", varname);
}

/* FetchCommonType */
            static PyTypeObject* __Pyx_FetchCommonType(PyTypeObject* type) {
    PyObject* fake_module;
    PyTypeObject* cached_type = NULL;
    fake_module = PyImport_AddModule((char*) "_cython_" CYTHON_ABI);
    if (!fake_module) return NULL;
    Py_INCREF(fake_module);
    cached_type = (PyTypeObject*) PyObject_GetAttrString(fake_module, type->tp_name);
    if (cached_type) {
        if (!PyType_Check((PyObject*)cached_type)) {
            PyErr_Format(PyExc_TypeError,
                "Shared Cython type %.200s is not a type object",
                type->tp_name);
            goto bad;
        }
        if (cached_type->tp_basicsize != type->tp_basicsize) {
            PyErr_Format(PyExc_TypeError,
                "Shared Cython type %.200s has the wrong size, try recompiling",
                type->tp_name);
            goto bad;
        }
    } else {
        if (!PyErr_ExceptionMatches(PyExc_AttributeError)) goto bad;
        PyErr_Clear();
        if (PyType_Ready(type) < 0) goto bad;
        if (PyObject_SetAttrString(fake_module, type->tp_name, (PyObject*) type) < 0)
            goto bad;
        Py_INCREF(type);
        cached_type = type;
    }
done:
    Py_DECREF(fake_module);
    return cached_type;
bad:
    Py_XDECREF(cached_type);
    cached_type = NULL;
    goto done;
}

/* CythonFunction */
            static PyObject *
__Pyx_CyFunction_get_doc(__pyx_CyFunctionObject *op, CYTHON_UNUSED void *closure)
{
    if (unlikely(op->func_doc == NULL)) {
        if (op->func.m_ml->ml_doc) {
#if PY_MAJOR_VERSION >= 3
            op->func_doc = PyUnicode_FromString(op->func.m_ml->ml_doc);
#else
            op->func_doc = PyString_FromString(op->func.m_ml->ml_doc);
#endif
            if (unlikely(op->func_doc == NULL))
                return NULL;
        } else {
            Py_INCREF(Py_None);
            return Py_None;
        }
    }
    Py_INCREF(op->func_doc);
    return op->func_doc;
}
static int
__Pyx_CyFunction_set_doc(__pyx_CyFunctionObject *op, PyObject *value)
{
    PyObject *tmp = op->func_doc;
    if (value == NULL) {
        value = Py_None;
    }
    Py_INCREF(value);
    op->func_doc = value;
    Py_XDECREF(tmp);
    return 0;
}
static PyObject *
__Pyx_CyFunction_get_name(__pyx_CyFunctionObject *op)
{
    if (unlikely(op->func_name == NULL)) {
#if PY_MAJOR_VERSION >= 3
        op->func_name = PyUnicode_InternFromString(op->func.m_ml->ml_name);
#else
        op->func_name = PyString_InternFromString(op->func.m_ml->ml_name);
#endif
        if (unlikely(op->func_name == NULL))
            return NULL;
    }
    Py_INCREF(op->func_name);
    return op->func_name;
}
static int
__Pyx_CyFunction_set_name(__pyx_CyFunctionObject *op, PyObject *value)
{
    PyObject *tmp;
#if PY_MAJOR_VERSION >= 3
    if (unlikely(value == NULL || !PyUnicode_Check(value))) {
#else
    if (unlikely(value == NULL || !PyString_Check(value))) {
#endif
        PyErr_SetString(PyExc_TypeError,
                        "__name__ must be set to a string object");
        return -1;
    }
    tmp = op->func_name;
    Py_INCREF(value);
    op->func_name = value;
    Py_XDECREF(tmp);
    return 0;
}
static PyObject *
__Pyx_CyFunction_get_qualname(__pyx_CyFunctionObject *op)
{
    Py_INCREF(op->func_qualname);
    return op->func_qualname;
}
static int
__Pyx_CyFunction_set_qualname(__pyx_CyFunctionObject *op, PyObject *value)
{
    PyObject *tmp;
#if PY_MAJOR_VERSION >= 3
    if (unlikely(value == NULL || !PyUnicode_Check(value))) {
#else
    if (unlikely(value == NULL || !PyString_Check(value))) {
#endif
        PyErr_SetString(PyExc_TypeError,
                        "__qualname__ must be set to a string object");
        return -1;
    }
    tmp = op->func_qualname;
    Py_INCREF(value);
    op->func_qualname = value;
    Py_XDECREF(tmp);
    return 0;
}
static PyObject *
__Pyx_CyFunction_get_self(__pyx_CyFunctionObject *m, CYTHON_UNUSED void *closure)
{
    PyObject *self;
    self = m->func_closure;
    if (self == NULL)
        self = Py_None;
    Py_INCREF(self);
    return self;
}
static PyObject *
__Pyx_CyFunction_get_dict(__pyx_CyFunctionObject *op)
{
    if (unlikely(op->func_dict == NULL)) {
        op->func_dict = PyDict_New();
        if (unlikely(op->func_dict == NULL))
            return NULL;
    }
    Py_INCREF(op->func_dict);
    return op->func_dict;
}
static int
__Pyx_CyFunction_set_dict(__pyx_CyFunctionObject *op, PyObject *value)
{
    PyObject *tmp;
    if (unlikely(value == NULL)) {
        PyErr_SetString(PyExc_TypeError,
               "function's dictionary may not be deleted");
        return -1;
    }
    if (unlikely(!PyDict_Check(value))) {
        PyErr_SetString(PyExc_TypeError,
               "setting function's dictionary to a non-dict");
        return -1;
    }
    tmp = op->func_dict;
    Py_INCREF(value);
    op->func_dict = value;
    Py_XDECREF(tmp);
    return 0;
}
static PyObject *
__Pyx_CyFunction_get_globals(__pyx_CyFunctionObject *op)
{
    Py_INCREF(op->func_globals);
    return op->func_globals;
}
static PyObject *
__Pyx_CyFunction_get_closure(CYTHON_UNUSED __pyx_CyFunctionObject *op)
{
    Py_INCREF(Py_None);
    return Py_None;
}
static PyObject *
__Pyx_CyFunction_get_code(__pyx_CyFunctionObject *op)
{
    PyObject* result = (op->func_code) ? op->func_code : Py_None;
    Py_INCREF(result);
    return result;
}
static int
__Pyx_CyFunction_init_defaults(__pyx_CyFunctionObject *op) {
    int result = 0;
    PyObject *res = op->defaults_getter((PyObject *) op);
    if (unlikely(!res))
        return -1;
    #if CYTHON_COMPILING_IN_CPYTHON
    op->defaults_tuple = PyTuple_GET_ITEM(res, 0);
    Py_INCREF(op->defaults_tuple);
    op->defaults_kwdict = PyTuple_GET_ITEM(res, 1);
    Py_INCREF(op->defaults_kwdict);
    #else
    op->defaults_tuple = PySequence_ITEM(res, 0);
    if (unlikely(!op->defaults_tuple)) result = -1;
    else {
        op->defaults_kwdict = PySequence_ITEM(res, 1);
        if (unlikely(!op->defaults_kwdict)) result = -1;
    }
    #endif
    Py_DECREF(res);
    return result;
}
static int
__Pyx_CyFunction_set_defaults(__pyx_CyFunctionObject *op, PyObject* value) {
    PyObject* tmp;
    if (!value) {
        value = Py_None;
    } else if (value != Py_None && !PyTuple_Check(value)) {
        PyErr_SetString(PyExc_TypeError,
                        "__defaults__ must be set to a tuple object");
        return -1;
    }
    Py_INCREF(value);
    tmp = op->defaults_tuple;
    op->defaults_tuple = value;
    Py_XDECREF(tmp);
    return 0;
}
static PyObject *
__Pyx_CyFunction_get_defaults(__pyx_CyFunctionObject *op) {
    PyObject* result = op->defaults_tuple;
    if (unlikely(!result)) {
        if (op->defaults_getter) {
            if (__Pyx_CyFunction_init_defaults(op) < 0) return NULL;
            result = op->defaults_tuple;
        } else {
            result = Py_None;
        }
    }
    Py_INCREF(result);
    return result;
}
static int
__Pyx_CyFunction_set_kwdefaults(__pyx_CyFunctionObject *op, PyObject* value) {
    PyObject* tmp;
    if (!value) {
        value = Py_None;
    } else if (value != Py_None && !PyDict_Check(value)) {
        PyErr_SetString(PyExc_TypeError,
                        "__kwdefaults__ must be set to a dict object");
        return -1;
    }
    Py_INCREF(value);
    tmp = op->defaults_kwdict;
    op->defaults_kwdict = value;
    Py_XDECREF(tmp);
    return 0;
}
static PyObject *
__Pyx_CyFunction_get_kwdefaults(__pyx_CyFunctionObject *op) {
    PyObject* result = op->defaults_kwdict;
    if (unlikely(!result)) {
        if (op->defaults_getter) {
            if (__Pyx_CyFunction_init_defaults(op) < 0) return NULL;
            result = op->defaults_kwdict;
        } else {
            result = Py_None;
        }
    }
    Py_INCREF(result);
    return result;
}
static int
__Pyx_CyFunction_set_annotations(__pyx_CyFunctionObject *op, PyObject* value) {
    PyObject* tmp;
    if (!value || value == Py_None) {
        value = NULL;
    } else if (!PyDict_Check(value)) {
        PyErr_SetString(PyExc_TypeError,
                        "__annotations__ must be set to a dict object");
        return -1;
    }
    Py_XINCREF(value);
    tmp = op->func_annotations;
    op->func_annotations = value;
    Py_XDECREF(tmp);
    return 0;
}
static PyObject *
__Pyx_CyFunction_get_annotations(__pyx_CyFunctionObject *op) {
    PyObject* result = op->func_annotations;
    if (unlikely(!result)) {
        result = PyDict_New();
        if (unlikely(!result)) return NULL;
        op->func_annotations = result;
    }
    Py_INCREF(result);
    return result;
}
static PyGetSetDef __pyx_CyFunction_getsets[] = {
    {(char *) "func_doc", (getter)__Pyx_CyFunction_get_doc, (setter)__Pyx_CyFunction_set_doc, 0, 0},
    {(char *) "__doc__",  (getter)__Pyx_CyFunction_get_doc, (setter)__Pyx_CyFunction_set_doc, 0, 0},
    {(char *) "func_name", (getter)__Pyx_CyFunction_get_name, (setter)__Pyx_CyFunction_set_name, 0, 0},
    {(char *) "__name__", (getter)__Pyx_CyFunction_get_name, (setter)__Pyx_CyFunction_set_name, 0, 0},
    {(char *) "__qualname__", (getter)__Pyx_CyFunction_get_qualname, (setter)__Pyx_CyFunction_set_qualname, 0, 0},
    {(char *) "__self__", (getter)__Pyx_CyFunction_get_self, 0, 0, 0},
    {(char *) "func_dict", (getter)__Pyx_CyFunction_get_dict, (setter)__Pyx_CyFunction_set_dict, 0, 0},
    {(char *) "__dict__", (getter)__Pyx_CyFunction_get_dict, (setter)__Pyx_CyFunction_set_dict, 0, 0},
    {(char *) "func_globals", (getter)__Pyx_CyFunction_get_globals, 0, 0, 0},
    {(char *) "__globals__", (getter)__Pyx_CyFunction_get_globals, 0, 0, 0},
    {(char *) "func_closure", (getter)__Pyx_CyFunction_get_closure, 0, 0, 0},
    {(char *) "__closure__", (getter)__Pyx_CyFunction_get_closure, 0, 0, 0},
    {(char *) "func_code", (getter)__Pyx_CyFunction_get_code, 0, 0, 0},
    {(char *) "__code__", (getter)__Pyx_CyFunction_get_code, 0, 0, 0},
    {(char *) "func_defaults", (getter)__Pyx_CyFunction_get_defaults, (setter)__Pyx_CyFunction_set_defaults, 0, 0},
    {(char *) "__defaults__", (getter)__Pyx_CyFunction_get_defaults, (setter)__Pyx_CyFunction_set_defaults, 0, 0},
    {(char *) "__kwdefaults__", (getter)__Pyx_CyFunction_get_kwdefaults, (setter)__Pyx_CyFunction_set_kwdefaults, 0, 0},
    {(char *) "__annotations__", (getter)__Pyx_CyFunction_get_annotations, (setter)__Pyx_CyFunction_set_annotations, 0, 0},
    {0, 0, 0, 0, 0}
};
static PyMemberDef __pyx_CyFunction_members[] = {
    {(char *) "__module__", T_OBJECT, offsetof(__pyx_CyFunctionObject, func.m_module), PY_WRITE_RESTRICTED, 0},
    {0, 0, 0,  0, 0}
};
static PyObject *
__Pyx_CyFunction_reduce(__pyx_CyFunctionObject *m, CYTHON_UNUSED PyObject *args)
{
#if PY_MAJOR_VERSION >= 3
    return PyUnicode_FromString(m->func.m_ml->ml_name);
#else
    return PyString_FromString(m->func.m_ml->ml_name);
#endif
}
static PyMethodDef __pyx_CyFunction_methods[] = {
    {"__reduce__", (PyCFunction)__Pyx_CyFunction_reduce, METH_VARARGS, 0},
    {0, 0, 0, 0}
};
#if PY_VERSION_HEX < 0x030500A0
#define __Pyx_CyFunction_weakreflist(cyfunc) ((cyfunc)->func_weakreflist)
#else
#define __Pyx_CyFunction_weakreflist(cyfunc) ((cyfunc)->func.m_weakreflist)
#endif
static PyObject *__Pyx_CyFunction_New(PyTypeObject *type, PyMethodDef *ml, int flags, PyObject* qualname,
                                      PyObject *closure, PyObject *module, PyObject* globals, PyObject* code) {
    __pyx_CyFunctionObject *op = PyObject_GC_New(__pyx_CyFunctionObject, type);
    if (op == NULL)
        return NULL;
    op->flags = flags;
    __Pyx_CyFunction_weakreflist(op) = NULL;
    op->func.m_ml = ml;
    op->func.m_self = (PyObject *) op;
    Py_XINCREF(closure);
    op->func_closure = closure;
    Py_XINCREF(module);
    op->func.m_module = module;
    op->func_dict = NULL;
    op->func_name = NULL;
    Py_INCREF(qualname);
    op->func_qualname = qualname;
    op->func_doc = NULL;
    op->func_classobj = NULL;
    op->func_globals = globals;
    Py_INCREF(op->func_globals);
    Py_XINCREF(code);
    op->func_code = code;
    op->defaults_pyobjects = 0;
    op->defaults = NULL;
    op->defaults_tuple = NULL;
    op->defaults_kwdict = NULL;
    op->defaults_getter = NULL;
    op->func_annotations = NULL;
    PyObject_GC_Track(op);
    return (PyObject *) op;
}
static int
__Pyx_CyFunction_clear(__pyx_CyFunctionObject *m)
{
    Py_CLEAR(m->func_closure);
    Py_CLEAR(m->func.m_module);
    Py_CLEAR(m->func_dict);
    Py_CLEAR(m->func_name);
    Py_CLEAR(m->func_qualname);
    Py_CLEAR(m->func_doc);
    Py_CLEAR(m->func_globals);
    Py_CLEAR(m->func_code);
    Py_CLEAR(m->func_classobj);
    Py_CLEAR(m->defaults_tuple);
    Py_CLEAR(m->defaults_kwdict);
    Py_CLEAR(m->func_annotations);
    if (m->defaults) {
        PyObject **pydefaults = __Pyx_CyFunction_Defaults(PyObject *, m);
        int i;
        for (i = 0; i < m->defaults_pyobjects; i++)
            Py_XDECREF(pydefaults[i]);
        PyObject_Free(m->defaults);
        m->defaults = NULL;
    }
    return 0;
}
static void __Pyx_CyFunction_dealloc(__pyx_CyFunctionObject *m)
{
    PyObject_GC_UnTrack(m);
    if (__Pyx_CyFunction_weakreflist(m) != NULL)
        PyObject_ClearWeakRefs((PyObject *) m);
    __Pyx_CyFunction_clear(m);
    PyObject_GC_Del(m);
}
static int __Pyx_CyFunction_traverse(__pyx_CyFunctionObject *m, visitproc visit, void *arg)
{
    Py_VISIT(m->func_closure);
    Py_VISIT(m->func.m_module);
    Py_VISIT(m->func_dict);
    Py_VISIT(m->func_name);
    Py_VISIT(m->func_qualname);
    Py_VISIT(m->func_doc);
    Py_VISIT(m->func_globals);
    Py_VISIT(m->func_code);
    Py_VISIT(m->func_classobj);
    Py_VISIT(m->defaults_tuple);
    Py_VISIT(m->defaults_kwdict);
    if (m->defaults) {
        PyObject **pydefaults = __Pyx_CyFunction_Defaults(PyObject *, m);
        int i;
        for (i = 0; i < m->defaults_pyobjects; i++)
            Py_VISIT(pydefaults[i]);
    }
    return 0;
}
static PyObject *__Pyx_CyFunction_descr_get(PyObject *func, PyObject *obj, PyObject *type)
{
    __pyx_CyFunctionObject *m = (__pyx_CyFunctionObject *) func;
    if (m->flags & __Pyx_CYFUNCTION_STATICMETHOD) {
        Py_INCREF(func);
        return func;
    }
    if (m->flags & __Pyx_CYFUNCTION_CLASSMETHOD) {
        if (type == NULL)
            type = (PyObject *)(Py_TYPE(obj));
        return __Pyx_PyMethod_New(func, type, (PyObject *)(Py_TYPE(type)));
    }
    if (obj == Py_None)
        obj = NULL;
    return __Pyx_PyMethod_New(func, obj, type);
}
static PyObject*
__Pyx_CyFunction_repr(__pyx_CyFunctionObject *op)
{
#if PY_MAJOR_VERSION >= 3
    return PyUnicode_FromFormat("<cyfunction %U at %p>",
                                op->func_qualname, (void *)op);
#else
    return PyString_FromFormat("<cyfunction %s at %p>",
                               PyString_AsString(op->func_qualname), (void *)op);
#endif
}
#if CYTHON_COMPILING_IN_PYPY
static PyObject * __Pyx_CyFunction_Call(PyObject *func, PyObject *arg, PyObject *kw) {
    PyCFunctionObject* f = (PyCFunctionObject*)func;
    PyCFunction meth = f->m_ml->ml_meth;
    PyObject *self = f->m_self;
    Py_ssize_t size;
    switch (f->m_ml->ml_flags & (METH_VARARGS | METH_KEYWORDS | METH_NOARGS | METH_O)) {
    case METH_VARARGS:
        if (likely(kw == NULL || PyDict_Size(kw) == 0))
            return (*meth)(self, arg);
        break;
    case METH_VARARGS | METH_KEYWORDS:
        return (*(PyCFunctionWithKeywords)meth)(self, arg, kw);
    case METH_NOARGS:
        if (likely(kw == NULL || PyDict_Size(kw) == 0)) {
            size = PyTuple_GET_SIZE(arg);
            if (likely(size == 0))
                return (*meth)(self, NULL);
            PyErr_Format(PyExc_TypeError,
                "%.200s() takes no arguments (%" CYTHON_FORMAT_SSIZE_T "d given)",
                f->m_ml->ml_name, size);
            return NULL;
        }
        break;
    case METH_O:
        if (likely(kw == NULL || PyDict_Size(kw) == 0)) {
            size = PyTuple_GET_SIZE(arg);
            if (likely(size == 1)) {
                PyObject *result, *arg0 = PySequence_ITEM(arg, 0);
                if (unlikely(!arg0)) return NULL;
                result = (*meth)(self, arg0);
                Py_DECREF(arg0);
                return result;
            }
            PyErr_Format(PyExc_TypeError,
                "%.200s() takes exactly one argument (%" CYTHON_FORMAT_SSIZE_T "d given)",
                f->m_ml->ml_name, size);
            return NULL;
        }
        break;
    default:
        PyErr_SetString(PyExc_SystemError, "Bad call flags in "
                        "__Pyx_CyFunction_Call. METH_OLDARGS is no "
                        "longer supported!");
        return NULL;
    }
    PyErr_Format(PyExc_TypeError, "%.200s() takes no keyword arguments",
                 f->m_ml->ml_name);
    return NULL;
}
#else
static PyObject * __Pyx_CyFunction_Call(PyObject *func, PyObject *arg, PyObject *kw) {
	return PyCFunction_Call(func, arg, kw);
}
#endif
static PyTypeObject __pyx_CyFunctionType_type = {
    PyVarObject_HEAD_INIT(0, 0)
    "cython_function_or_method",
    sizeof(__pyx_CyFunctionObject),
    0,
    (destructor) __Pyx_CyFunction_dealloc,
    0,
    0,
    0,
#if PY_MAJOR_VERSION < 3
    0,
#else
    0,
#endif
    (reprfunc) __Pyx_CyFunction_repr,
    0,
    0,
    0,
    0,
    __Pyx_CyFunction_Call,
    0,
    0,
    0,
    0,
    Py_TPFLAGS_DEFAULT | Py_TPFLAGS_HAVE_GC,
    0,
    (traverseproc) __Pyx_CyFunction_traverse,
    (inquiry) __Pyx_CyFunction_clear,
    0,
#if PY_VERSION_HEX < 0x030500A0
    offsetof(__pyx_CyFunctionObject, func_weakreflist),
#else
    offsetof(PyCFunctionObject, m_weakreflist),
#endif
    0,
    0,
    __pyx_CyFunction_methods,
    __pyx_CyFunction_members,
    __pyx_CyFunction_getsets,
    0,
    0,
    __Pyx_CyFunction_descr_get,
    0,
    offsetof(__pyx_CyFunctionObject, func_dict),
    0,
    0,
    0,
    0,
    0,
    0,
    0,
    0,
    0,
    0,
    0,
    0,
#if PY_VERSION_HEX >= 0x030400a1
    0,
#endif
};
static int __pyx_CyFunction_init(void) {
#if !CYTHON_COMPILING_IN_PYPY
    __pyx_CyFunctionType_type.tp_call = PyCFunction_Call;
#endif
    __pyx_CyFunctionType = __Pyx_FetchCommonType(&__pyx_CyFunctionType_type);
    if (__pyx_CyFunctionType == NULL) {
        return -1;
    }
    return 0;
}
static CYTHON_INLINE void *__Pyx_CyFunction_InitDefaults(PyObject *func, size_t size, int pyobjects) {
    __pyx_CyFunctionObject *m = (__pyx_CyFunctionObject *) func;
    m->defaults = PyObject_Malloc(size);
    if (!m->defaults)
        return PyErr_NoMemory();
    memset(m->defaults, 0, size);
    m->defaults_pyobjects = pyobjects;
    return m->defaults;
}
static CYTHON_INLINE void __Pyx_CyFunction_SetDefaultsTuple(PyObject *func, PyObject *tuple) {
    __pyx_CyFunctionObject *m = (__pyx_CyFunctionObject *) func;
    m->defaults_tuple = tuple;
    Py_INCREF(tuple);
}
static CYTHON_INLINE void __Pyx_CyFunction_SetDefaultsKwDict(PyObject *func, PyObject *dict) {
    __pyx_CyFunctionObject *m = (__pyx_CyFunctionObject *) func;
    m->defaults_kwdict = dict;
    Py_INCREF(dict);
}
static CYTHON_INLINE void __Pyx_CyFunction_SetAnnotationsDict(PyObject *func, PyObject *dict) {
    __pyx_CyFunctionObject *m = (__pyx_CyFunctionObject *) func;
    m->func_annotations = dict;
    Py_INCREF(dict);
}

/* PyObjectCallMethod2 */
                static PyObject* __Pyx_PyObject_CallMethod2(PyObject* obj, PyObject* method_name, PyObject* arg1, PyObject* arg2) {
    PyObject *args, *method, *result = NULL;
    method = __Pyx_PyObject_GetAttrStr(obj, method_name);
#if CYTHON_COMPILING_IN_CPYTHON
    if (likely(PyMethod_Check(method)) && likely(PyMethod_GET_SELF(method))) {
        PyObject *self, *function;
        self = PyMethod_GET_SELF(method);
        function = PyMethod_GET_FUNCTION(method);
        args = PyTuple_New(3);
        if (unlikely(!args)) goto bad;
        Py_INCREF(self);
        PyTuple_SET_ITEM(args, 0, self);
        Py_INCREF(arg1);
        PyTuple_SET_ITEM(args, 1, arg1);
        Py_INCREF(arg2);
        PyTuple_SET_ITEM(args, 2, arg2);
        Py_INCREF(function);
        Py_DECREF(method);
        method = function;
    } else
#endif
    {
        args = PyTuple_New(2);
        if (unlikely(!args)) goto bad;
        Py_INCREF(arg1);
        PyTuple_SET_ITEM(args, 0, arg1);
        Py_INCREF(arg2);
        PyTuple_SET_ITEM(args, 1, arg2);
    }
    result = __Pyx_PyObject_Call(method, args, NULL);
    Py_DECREF(args);
    Py_DECREF(method);
    return result;
bad:
    Py_XDECREF(method);
    return result;
}

/* dict_setdefault */
                static CYTHON_INLINE PyObject *__Pyx_PyDict_SetDefault(PyObject *d, PyObject *key, PyObject *default_value,
                                                       CYTHON_UNUSED int is_safe_type) {
    PyObject* value;
#if PY_VERSION_HEX >= 0x030400A0
    if (1) {
        value = PyDict_SetDefault(d, key, default_value);
        if (unlikely(!value)) return NULL;
        Py_INCREF(value);
#else
    if (is_safe_type == 1 || (is_safe_type == -1 &&
#if PY_MAJOR_VERSION >= 3 && !CYTHON_COMPILING_IN_PYPY
            (PyUnicode_CheckExact(key) || PyString_CheckExact(key) || PyLong_CheckExact(key)))) {
        value = PyDict_GetItemWithError(d, key);
        if (unlikely(!value)) {
            if (unlikely(PyErr_Occurred()))
                return NULL;
            if (unlikely(PyDict_SetItem(d, key, default_value) == -1))
                return NULL;
            value = default_value;
        }
        Py_INCREF(value);
#else
            (PyString_CheckExact(key) || PyUnicode_CheckExact(key) || PyInt_CheckExact(key) || PyLong_CheckExact(key)))) {
        value = PyDict_GetItem(d, key);
        if (unlikely(!value)) {
            if (unlikely(PyDict_SetItem(d, key, default_value) == -1))
                return NULL;
            value = default_value;
        }
        Py_INCREF(value);
#endif
#endif
    } else {
        value = __Pyx_PyObject_CallMethod2(d, __pyx_n_s_setdefault, key, default_value);
    }
    return value;
}

/* dict_getitem_default */
                    static PyObject* __Pyx_PyDict_GetItemDefault(PyObject* d, PyObject* key, PyObject* default_value) {
    PyObject* value;
#if PY_MAJOR_VERSION >= 3 && !CYTHON_COMPILING_IN_PYPY
    value = PyDict_GetItemWithError(d, key);
    if (unlikely(!value)) {
        if (unlikely(PyErr_Occurred()))
            return NULL;
        value = default_value;
    }
    Py_INCREF(value);
#else
    if (PyString_CheckExact(key) || PyUnicode_CheckExact(key) || PyInt_CheckExact(key)) {
        value = PyDict_GetItem(d, key);
        if (unlikely(!value)) {
            value = default_value;
        }
        Py_INCREF(value);
    } else {
        if (default_value == Py_None)
            default_value = NULL;
        value = PyObject_CallMethodObjArgs(
            d, __pyx_n_s_get, key, default_value, NULL);
    }
#endif
    return value;
}

/* PyIntBinop */
                    #if CYTHON_COMPILING_IN_CPYTHON
static PyObject* __Pyx_PyInt_RemainderObjC(PyObject *op1, PyObject *op2, CYTHON_UNUSED long intval, CYTHON_UNUSED int inplace) {
    #if PY_MAJOR_VERSION < 3
    if (likely(PyInt_CheckExact(op1))) {
        const long b = intval;
        long x;
        long a = PyInt_AS_LONG(op1);
            x = a % b;
            x += ((x != 0) & ((x ^ b) < 0)) * b;
            return PyInt_FromLong(x);
    }
    #endif
    #if CYTHON_USE_PYLONG_INTERNALS && PY_MAJOR_VERSION >= 3
    if (likely(PyLong_CheckExact(op1))) {
        const long b = intval;
        long a, x;
        const PY_LONG_LONG llb = intval;
        PY_LONG_LONG lla, llx;
        const digit* digits = ((PyLongObject*)op1)->ob_digit;
        const Py_ssize_t size = Py_SIZE(op1);
        if (likely(__Pyx_sst_abs(size) <= 1)) {
            a = likely(size) ? digits[0] : 0;
            if (size == -1) a = -a;
        } else {
            switch (size) {
                case -2:
                    if (8 * sizeof(long) - 1 > 2 * PyLong_SHIFT) {
                        a = -(long) (((((unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0]));
                        break;
                    } else if (8 * sizeof(PY_LONG_LONG) - 1 > 2 * PyLong_SHIFT) {
                        lla = -(PY_LONG_LONG) (((((unsigned PY_LONG_LONG)digits[1]) << PyLong_SHIFT) | (unsigned PY_LONG_LONG)digits[0]));
                        goto long_long;
                    }
                case 2:
                    if (8 * sizeof(long) - 1 > 2 * PyLong_SHIFT) {
                        a = (long) (((((unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0]));
                        break;
                    } else if (8 * sizeof(PY_LONG_LONG) - 1 > 2 * PyLong_SHIFT) {
                        lla = (PY_LONG_LONG) (((((unsigned PY_LONG_LONG)digits[1]) << PyLong_SHIFT) | (unsigned PY_LONG_LONG)digits[0]));
                        goto long_long;
                    }
                case -3:
                    if (8 * sizeof(long) - 1 > 3 * PyLong_SHIFT) {
                        a = -(long) (((((((unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0]));
                        break;
                    } else if (8 * sizeof(PY_LONG_LONG) - 1 > 3 * PyLong_SHIFT) {
                        lla = -(PY_LONG_LONG) (((((((unsigned PY_LONG_LONG)digits[2]) << PyLong_SHIFT) | (unsigned PY_LONG_LONG)digits[1]) << PyLong_SHIFT) | (unsigned PY_LONG_LONG)digits[0]));
                        goto long_long;
                    }
                case 3:
                    if (8 * sizeof(long) - 1 > 3 * PyLong_SHIFT) {
                        a = (long) (((((((unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0]));
                        break;
                    } else if (8 * sizeof(PY_LONG_LONG) - 1 > 3 * PyLong_SHIFT) {
                        lla = (PY_LONG_LONG) (((((((unsigned PY_LONG_LONG)digits[2]) << PyLong_SHIFT) | (unsigned PY_LONG_LONG)digits[1]) << PyLong_SHIFT) | (unsigned PY_LONG_LONG)digits[0]));
                        goto long_long;
                    }
                case -4:
                    if (8 * sizeof(long) - 1 > 4 * PyLong_SHIFT) {
                        a = -(long) (((((((((unsigned long)digits[3]) << PyLong_SHIFT) | (unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0]));
                        break;
                    } else if (8 * sizeof(PY_LONG_LONG) - 1 > 4 * PyLong_SHIFT) {
                        lla = -(PY_LONG_LONG) (((((((((unsigned PY_LONG_LONG)digits[3]) << PyLong_SHIFT) | (unsigned PY_LONG_LONG)digits[2]) << PyLong_SHIFT) | (unsigned PY_LONG_LONG)digits[1]) << PyLong_SHIFT) | (unsigned PY_LONG_LONG)digits[0]));
                        goto long_long;
                    }
                case 4:
                    if (8 * sizeof(long) - 1 > 4 * PyLong_SHIFT) {
                        a = (long) (((((((((unsigned long)digits[3]) << PyLong_SHIFT) | (unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0]));
                        break;
                    } else if (8 * sizeof(PY_LONG_LONG) - 1 > 4 * PyLong_SHIFT) {
                        lla = (PY_LONG_LONG) (((((((((unsigned PY_LONG_LONG)digits[3]) << PyLong_SHIFT) | (unsigned PY_LONG_LONG)digits[2]) << PyLong_SHIFT) | (unsigned PY_LONG_LONG)digits[1]) << PyLong_SHIFT) | (unsigned PY_LONG_LONG)digits[0]));
                        goto long_long;
                    }
                default: return PyLong_Type.tp_as_number->nb_remainder(op1, op2);
            }
        }
                x = a % b;
                x += ((x != 0) & ((x ^ b) < 0)) * b;
            return PyLong_FromLong(x);
        long_long:
                llx = lla % llb;
                llx += ((llx != 0) & ((llx ^ llb) < 0)) * llb;
            return PyLong_FromLongLong(llx);
    }
    #endif
    return (inplace ? PyNumber_InPlaceRemainder : PyNumber_Remainder)(op1, op2);
}
#endif

/* SliceObject */
                    static CYTHON_INLINE int __Pyx_PyObject_SetSlice(PyObject* obj, PyObject* value,
        Py_ssize_t cstart, Py_ssize_t cstop,
        PyObject** _py_start, PyObject** _py_stop, PyObject** _py_slice,
        int has_cstart, int has_cstop, CYTHON_UNUSED int wraparound) {
#if CYTHON_COMPILING_IN_CPYTHON
    PyMappingMethods* mp;
#if PY_MAJOR_VERSION < 3
    PySequenceMethods* ms = Py_TYPE(obj)->tp_as_sequence;
    if (likely(ms && ms->sq_ass_slice)) {
        if (!has_cstart) {
            if (_py_start && (*_py_start != Py_None)) {
                cstart = __Pyx_PyIndex_AsSsize_t(*_py_start);
                if ((cstart == (Py_ssize_t)-1) && PyErr_Occurred()) goto bad;
            } else
                cstart = 0;
        }
        if (!has_cstop) {
            if (_py_stop && (*_py_stop != Py_None)) {
                cstop = __Pyx_PyIndex_AsSsize_t(*_py_stop);
                if ((cstop == (Py_ssize_t)-1) && PyErr_Occurred()) goto bad;
            } else
                cstop = PY_SSIZE_T_MAX;
        }
        if (wraparound && unlikely((cstart < 0) | (cstop < 0)) && likely(ms->sq_length)) {
            Py_ssize_t l = ms->sq_length(obj);
            if (likely(l >= 0)) {
                if (cstop < 0) {
                    cstop += l;
                    if (cstop < 0) cstop = 0;
                }
                if (cstart < 0) {
                    cstart += l;
                    if (cstart < 0) cstart = 0;
                }
            } else {
                if (!PyErr_ExceptionMatches(PyExc_OverflowError))
                    goto bad;
                PyErr_Clear();
            }
        }
        return ms->sq_ass_slice(obj, cstart, cstop, value);
    }
#endif
    mp = Py_TYPE(obj)->tp_as_mapping;
    if (likely(mp && mp->mp_ass_subscript))
#endif
    {
        int result;
        PyObject *py_slice, *py_start, *py_stop;
        if (_py_slice) {
            py_slice = *_py_slice;
        } else {
            PyObject* owned_start = NULL;
            PyObject* owned_stop = NULL;
            if (_py_start) {
                py_start = *_py_start;
            } else {
                if (has_cstart) {
                    owned_start = py_start = PyInt_FromSsize_t(cstart);
                    if (unlikely(!py_start)) goto bad;
                } else
                    py_start = Py_None;
            }
            if (_py_stop) {
                py_stop = *_py_stop;
            } else {
                if (has_cstop) {
                    owned_stop = py_stop = PyInt_FromSsize_t(cstop);
                    if (unlikely(!py_stop)) {
                        Py_XDECREF(owned_start);
                        goto bad;
                    }
                } else
                    py_stop = Py_None;
            }
            py_slice = PySlice_New(py_start, py_stop, Py_None);
            Py_XDECREF(owned_start);
            Py_XDECREF(owned_stop);
            if (unlikely(!py_slice)) goto bad;
        }
#if CYTHON_COMPILING_IN_CPYTHON
        result = mp->mp_ass_subscript(obj, py_slice, value);
#else
        result = value ? PyObject_SetItem(obj, py_slice, value) : PyObject_DelItem(obj, py_slice);
#endif
        if (!_py_slice) {
            Py_DECREF(py_slice);
        }
        return result;
    }
    PyErr_Format(PyExc_TypeError,
        "'%.200s' object does not support slice %.10s",
        Py_TYPE(obj)->tp_name, value ? "assignment" : "deletion");
bad:
    return -1;
}

/* ImportFrom */
                    static PyObject* __Pyx_ImportFrom(PyObject* module, PyObject* name) {
    PyObject* value = __Pyx_PyObject_GetAttrStr(module, name);
    if (unlikely(!value) && PyErr_ExceptionMatches(PyExc_AttributeError)) {
        PyErr_Format(PyExc_ImportError,
        #if PY_MAJOR_VERSION < 3
            "cannot import name %.230s", PyString_AS_STRING(name));
        #else
            "cannot import name %S", name);
        #endif
    }
    return value;
}

/* CodeObjectCache */
                    static int __pyx_bisect_code_objects(__Pyx_CodeObjectCacheEntry* entries, int count, int code_line) {
    int start = 0, mid = 0, end = count - 1;
    if (end >= 0 && code_line > entries[end].code_line) {
        return count;
    }
    while (start < end) {
        mid = start + (end - start) / 2;
        if (code_line < entries[mid].code_line) {
            end = mid;
        } else if (code_line > entries[mid].code_line) {
             start = mid + 1;
        } else {
            return mid;
        }
    }
    if (code_line <= entries[mid].code_line) {
        return mid;
    } else {
        return mid + 1;
    }
}
static PyCodeObject *__pyx_find_code_object(int code_line) {
    PyCodeObject* code_object;
    int pos;
    if (unlikely(!code_line) || unlikely(!__pyx_code_cache.entries)) {
        return NULL;
    }
    pos = __pyx_bisect_code_objects(__pyx_code_cache.entries, __pyx_code_cache.count, code_line);
    if (unlikely(pos >= __pyx_code_cache.count) || unlikely(__pyx_code_cache.entries[pos].code_line != code_line)) {
        return NULL;
    }
    code_object = __pyx_code_cache.entries[pos].code_object;
    Py_INCREF(code_object);
    return code_object;
}
static void __pyx_insert_code_object(int code_line, PyCodeObject* code_object) {
    int pos, i;
    __Pyx_CodeObjectCacheEntry* entries = __pyx_code_cache.entries;
    if (unlikely(!code_line)) {
        return;
    }
    if (unlikely(!entries)) {
        entries = (__Pyx_CodeObjectCacheEntry*)PyMem_Malloc(64*sizeof(__Pyx_CodeObjectCacheEntry));
        if (likely(entries)) {
            __pyx_code_cache.entries = entries;
            __pyx_code_cache.max_count = 64;
            __pyx_code_cache.count = 1;
            entries[0].code_line = code_line;
            entries[0].code_object = code_object;
            Py_INCREF(code_object);
        }
        return;
    }
    pos = __pyx_bisect_code_objects(__pyx_code_cache.entries, __pyx_code_cache.count, code_line);
    if ((pos < __pyx_code_cache.count) && unlikely(__pyx_code_cache.entries[pos].code_line == code_line)) {
        PyCodeObject* tmp = entries[pos].code_object;
        entries[pos].code_object = code_object;
        Py_DECREF(tmp);
        return;
    }
    if (__pyx_code_cache.count == __pyx_code_cache.max_count) {
        int new_max = __pyx_code_cache.max_count + 64;
        entries = (__Pyx_CodeObjectCacheEntry*)PyMem_Realloc(
            __pyx_code_cache.entries, (size_t)new_max*sizeof(__Pyx_CodeObjectCacheEntry));
        if (unlikely(!entries)) {
            return;
        }
        __pyx_code_cache.entries = entries;
        __pyx_code_cache.max_count = new_max;
    }
    for (i=__pyx_code_cache.count; i>pos; i--) {
        entries[i] = entries[i-1];
    }
    entries[pos].code_line = code_line;
    entries[pos].code_object = code_object;
    __pyx_code_cache.count++;
    Py_INCREF(code_object);
}

/* AddTraceback */
                    #include "compile.h"
#include "frameobject.h"
#include "traceback.h"
static PyCodeObject* __Pyx_CreateCodeObjectForTraceback(
            const char *funcname, int c_line,
            int py_line, const char *filename) {
    PyCodeObject *py_code = 0;
    PyObject *py_srcfile = 0;
    PyObject *py_funcname = 0;
    #if PY_MAJOR_VERSION < 3
    py_srcfile = PyString_FromString(filename);
    #else
    py_srcfile = PyUnicode_FromString(filename);
    #endif
    if (!py_srcfile) goto bad;
    if (c_line) {
        #if PY_MAJOR_VERSION < 3
        py_funcname = PyString_FromFormat( "%s (%s:%d)", funcname, __pyx_cfilenm, c_line);
        #else
        py_funcname = PyUnicode_FromFormat( "%s (%s:%d)", funcname, __pyx_cfilenm, c_line);
        #endif
    }
    else {
        #if PY_MAJOR_VERSION < 3
        py_funcname = PyString_FromString(funcname);
        #else
        py_funcname = PyUnicode_FromString(funcname);
        #endif
    }
    if (!py_funcname) goto bad;
    py_code = __Pyx_PyCode_New(
        0,
        0,
        0,
        0,
        0,
        __pyx_empty_bytes, /*PyObject *code,*/
        __pyx_empty_tuple, /*PyObject *consts,*/
        __pyx_empty_tuple, /*PyObject *names,*/
        __pyx_empty_tuple, /*PyObject *varnames,*/
        __pyx_empty_tuple, /*PyObject *freevars,*/
        __pyx_empty_tuple, /*PyObject *cellvars,*/
        py_srcfile,   /*PyObject *filename,*/
        py_funcname,  /*PyObject *name,*/
        py_line,
        __pyx_empty_bytes  /*PyObject *lnotab*/
    );
    Py_DECREF(py_srcfile);
    Py_DECREF(py_funcname);
    return py_code;
bad:
    Py_XDECREF(py_srcfile);
    Py_XDECREF(py_funcname);
    return NULL;
}
static void __Pyx_AddTraceback(const char *funcname, int c_line,
                               int py_line, const char *filename) {
    PyCodeObject *py_code = 0;
    PyFrameObject *py_frame = 0;
    py_code = __pyx_find_code_object(c_line ? c_line : py_line);
    if (!py_code) {
        py_code = __Pyx_CreateCodeObjectForTraceback(
            funcname, c_line, py_line, filename);
        if (!py_code) goto bad;
        __pyx_insert_code_object(c_line ? c_line : py_line, py_code);
    }
    py_frame = PyFrame_New(
        PyThreadState_GET(), /*PyThreadState *tstate,*/
        py_code,             /*PyCodeObject *code,*/
        __pyx_d,      /*PyObject *globals,*/
        0                    /*PyObject *locals*/
    );
    if (!py_frame) goto bad;
    py_frame->f_lineno = py_line;
    PyTraceBack_Here(py_frame);
bad:
    Py_XDECREF(py_code);
    Py_XDECREF(py_frame);
}

/* CIntToPy */
                    static CYTHON_INLINE PyObject* __Pyx_PyInt_From_long(long value) {
    const long neg_one = (long) -1, const_zero = (long) 0;
    const int is_unsigned = neg_one > const_zero;
    if (is_unsigned) {
        if (sizeof(long) < sizeof(long)) {
            return PyInt_FromLong((long) value);
        } else if (sizeof(long) <= sizeof(unsigned long)) {
            return PyLong_FromUnsignedLong((unsigned long) value);
        } else if (sizeof(long) <= sizeof(unsigned PY_LONG_LONG)) {
            return PyLong_FromUnsignedLongLong((unsigned PY_LONG_LONG) value);
        }
    } else {
        if (sizeof(long) <= sizeof(long)) {
            return PyInt_FromLong((long) value);
        } else if (sizeof(long) <= sizeof(PY_LONG_LONG)) {
            return PyLong_FromLongLong((PY_LONG_LONG) value);
        }
    }
    {
        int one = 1; int little = (int)*(unsigned char *)&one;
        unsigned char *bytes = (unsigned char *)&value;
        return _PyLong_FromByteArray(bytes, sizeof(long),
                                     little, !is_unsigned);
    }
}

/* CIntFromPyVerify */
                    #define __PYX_VERIFY_RETURN_INT(target_type, func_type, func_value)\
    __PYX__VERIFY_RETURN_INT(target_type, func_type, func_value, 0)
#define __PYX_VERIFY_RETURN_INT_EXC(target_type, func_type, func_value)\
    __PYX__VERIFY_RETURN_INT(target_type, func_type, func_value, 1)
#define __PYX__VERIFY_RETURN_INT(target_type, func_type, func_value, exc)\
    {\
        func_type value = func_value;\
        if (sizeof(target_type) < sizeof(func_type)) {\
            if (unlikely(value != (func_type) (target_type) value)) {\
                func_type zero = 0;\
                if (exc && unlikely(value == (func_type)-1 && PyErr_Occurred()))\
                    return (target_type) -1;\
                if (is_unsigned && unlikely(value < zero))\
                    goto raise_neg_overflow;\
                else\
                    goto raise_overflow;\
            }\
        }\
        return (target_type) value;\
    }

/* CIntFromPy */
                    static CYTHON_INLINE long __Pyx_PyInt_As_long(PyObject *x) {
    const long neg_one = (long) -1, const_zero = (long) 0;
    const int is_unsigned = neg_one > const_zero;
#if PY_MAJOR_VERSION < 3
    if (likely(PyInt_Check(x))) {
        if (sizeof(long) < sizeof(long)) {
            __PYX_VERIFY_RETURN_INT(long, long, PyInt_AS_LONG(x))
        } else {
            long val = PyInt_AS_LONG(x);
            if (is_unsigned && unlikely(val < 0)) {
                goto raise_neg_overflow;
            }
            return (long) val;
        }
    } else
#endif
    if (likely(PyLong_Check(x))) {
        if (is_unsigned) {
#if CYTHON_USE_PYLONG_INTERNALS
            const digit* digits = ((PyLongObject*)x)->ob_digit;
            switch (Py_SIZE(x)) {
                case  0: return (long) 0;
                case  1: __PYX_VERIFY_RETURN_INT(long, digit, digits[0])
                case 2:
                    if (8 * sizeof(long) > 1 * PyLong_SHIFT) {
                        if (8 * sizeof(unsigned long) > 2 * PyLong_SHIFT) {
                            __PYX_VERIFY_RETURN_INT(long, unsigned long, (((((unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
                        } else if (8 * sizeof(long) >= 2 * PyLong_SHIFT) {
                            return (long) (((((long)digits[1]) << PyLong_SHIFT) | (long)digits[0]));
                        }
                    }
                    break;
                case 3:
                    if (8 * sizeof(long) > 2 * PyLong_SHIFT) {
                        if (8 * sizeof(unsigned long) > 3 * PyLong_SHIFT) {
                            __PYX_VERIFY_RETURN_INT(long, unsigned long, (((((((unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
                        } else if (8 * sizeof(long) >= 3 * PyLong_SHIFT) {
                            return (long) (((((((long)digits[2]) << PyLong_SHIFT) | (long)digits[1]) << PyLong_SHIFT) | (long)digits[0]));
                        }
                    }
                    break;
                case 4:
                    if (8 * sizeof(long) > 3 * PyLong_SHIFT) {
                        if (8 * sizeof(unsigned long) > 4 * PyLong_SHIFT) {
                            __PYX_VERIFY_RETURN_INT(long, unsigned long, (((((((((unsigned long)digits[3]) << PyLong_SHIFT) | (unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
                        } else if (8 * sizeof(long) >= 4 * PyLong_SHIFT) {
                            return (long) (((((((((long)digits[3]) << PyLong_SHIFT) | (long)digits[2]) << PyLong_SHIFT) | (long)digits[1]) << PyLong_SHIFT) | (long)digits[0]));
                        }
                    }
                    break;
            }
#endif
#if CYTHON_COMPILING_IN_CPYTHON
            if (unlikely(Py_SIZE(x) < 0)) {
                goto raise_neg_overflow;
            }
#else
            {
                int result = PyObject_RichCompareBool(x, Py_False, Py_LT);
                if (unlikely(result < 0))
                    return (long) -1;
                if (unlikely(result == 1))
                    goto raise_neg_overflow;
            }
#endif
            if (sizeof(long) <= sizeof(unsigned long)) {
                __PYX_VERIFY_RETURN_INT_EXC(long, unsigned long, PyLong_AsUnsignedLong(x))
            } else if (sizeof(long) <= sizeof(unsigned PY_LONG_LONG)) {
                __PYX_VERIFY_RETURN_INT_EXC(long, unsigned PY_LONG_LONG, PyLong_AsUnsignedLongLong(x))
            }
        } else {
#if CYTHON_USE_PYLONG_INTERNALS
            const digit* digits = ((PyLongObject*)x)->ob_digit;
            switch (Py_SIZE(x)) {
                case  0: return (long) 0;
                case -1: __PYX_VERIFY_RETURN_INT(long, sdigit, (sdigit) (-(sdigit)digits[0]))
                case  1: __PYX_VERIFY_RETURN_INT(long,  digit, +digits[0])
                case -2:
                    if (8 * sizeof(long) - 1 > 1 * PyLong_SHIFT) {
                        if (8 * sizeof(unsigned long) > 2 * PyLong_SHIFT) {
                            __PYX_VERIFY_RETURN_INT(long, long, -(long) (((((unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
                        } else if (8 * sizeof(long) - 1 > 2 * PyLong_SHIFT) {
                            return (long) (((long)-1)*(((((long)digits[1]) << PyLong_SHIFT) | (long)digits[0])));
                        }
                    }
                    break;
                case 2:
                    if (8 * sizeof(long) > 1 * PyLong_SHIFT) {
                        if (8 * sizeof(unsigned long) > 2 * PyLong_SHIFT) {
                            __PYX_VERIFY_RETURN_INT(long, unsigned long, (((((unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
                        } else if (8 * sizeof(long) - 1 > 2 * PyLong_SHIFT) {
                            return (long) ((((((long)digits[1]) << PyLong_SHIFT) | (long)digits[0])));
                        }
                    }
                    break;
                case -3:
                    if (8 * sizeof(long) - 1 > 2 * PyLong_SHIFT) {
                        if (8 * sizeof(unsigned long) > 3 * PyLong_SHIFT) {
                            __PYX_VERIFY_RETURN_INT(long, long, -(long) (((((((unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
                        } else if (8 * sizeof(long) - 1 > 3 * PyLong_SHIFT) {
                            return (long) (((long)-1)*(((((((long)digits[2]) << PyLong_SHIFT) | (long)digits[1]) << PyLong_SHIFT) | (long)digits[0])));
                        }
                    }
                    break;
                case 3:
                    if (8 * sizeof(long) > 2 * PyLong_SHIFT) {
                        if (8 * sizeof(unsigned long) > 3 * PyLong_SHIFT) {
                            __PYX_VERIFY_RETURN_INT(long, unsigned long, (((((((unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
                        } else if (8 * sizeof(long) - 1 > 3 * PyLong_SHIFT) {
                            return (long) ((((((((long)digits[2]) << PyLong_SHIFT) | (long)digits[1]) << PyLong_SHIFT) | (long)digits[0])));
                        }
                    }
                    break;
                case -4:
                    if (8 * sizeof(long) - 1 > 3 * PyLong_SHIFT) {
                        if (8 * sizeof(unsigned long) > 4 * PyLong_SHIFT) {
                            __PYX_VERIFY_RETURN_INT(long, long, -(long) (((((((((unsigned long)digits[3]) << PyLong_SHIFT) | (unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
                        } else if (8 * sizeof(long) - 1 > 4 * PyLong_SHIFT) {
                            return (long) (((long)-1)*(((((((((long)digits[3]) << PyLong_SHIFT) | (long)digits[2]) << PyLong_SHIFT) | (long)digits[1]) << PyLong_SHIFT) | (long)digits[0])));
                        }
                    }
                    break;
                case 4:
                    if (8 * sizeof(long) > 3 * PyLong_SHIFT) {
                        if (8 * sizeof(unsigned long) > 4 * PyLong_SHIFT) {
                            __PYX_VERIFY_RETURN_INT(long, unsigned long, (((((((((unsigned long)digits[3]) << PyLong_SHIFT) | (unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
                        } else if (8 * sizeof(long) - 1 > 4 * PyLong_SHIFT) {
                            return (long) ((((((((((long)digits[3]) << PyLong_SHIFT) | (long)digits[2]) << PyLong_SHIFT) | (long)digits[1]) << PyLong_SHIFT) | (long)digits[0])));
                        }
                    }
                    break;
            }
#endif
            if (sizeof(long) <= sizeof(long)) {
                __PYX_VERIFY_RETURN_INT_EXC(long, long, PyLong_AsLong(x))
            } else if (sizeof(long) <= sizeof(PY_LONG_LONG)) {
                __PYX_VERIFY_RETURN_INT_EXC(long, PY_LONG_LONG, PyLong_AsLongLong(x))
            }
        }
        {
#if CYTHON_COMPILING_IN_PYPY && !defined(_PyLong_AsByteArray)
            PyErr_SetString(PyExc_RuntimeError,
                            "_PyLong_AsByteArray() not available in PyPy, cannot convert large numbers");
#else
            long val;
            PyObject *v = __Pyx_PyNumber_IntOrLong(x);
 #if PY_MAJOR_VERSION < 3
            if (likely(v) && !PyLong_Check(v)) {
                PyObject *tmp = v;
                v = PyNumber_Long(tmp);
                Py_DECREF(tmp);
            }
 #endif
            if (likely(v)) {
                int one = 1; int is_little = (int)*(unsigned char *)&one;
                unsigned char *bytes = (unsigned char *)&val;
                int ret = _PyLong_AsByteArray((PyLongObject *)v,
                                              bytes, sizeof(val),
                                              is_little, !is_unsigned);
                Py_DECREF(v);
                if (likely(!ret))
                    return val;
            }
#endif
            return (long) -1;
        }
    } else {
        long val;
        PyObject *tmp = __Pyx_PyNumber_IntOrLong(x);
        if (!tmp) return (long) -1;
        val = __Pyx_PyInt_As_long(tmp);
        Py_DECREF(tmp);
        return val;
    }
raise_overflow:
    PyErr_SetString(PyExc_OverflowError,
        "value too large to convert to long");
    return (long) -1;
raise_neg_overflow:
    PyErr_SetString(PyExc_OverflowError,
        "can't convert negative value to long");
    return (long) -1;
}

/* CIntFromPy */
                    static CYTHON_INLINE int __Pyx_PyInt_As_int(PyObject *x) {
    const int neg_one = (int) -1, const_zero = (int) 0;
    const int is_unsigned = neg_one > const_zero;
#if PY_MAJOR_VERSION < 3
    if (likely(PyInt_Check(x))) {
        if (sizeof(int) < sizeof(long)) {
            __PYX_VERIFY_RETURN_INT(int, long, PyInt_AS_LONG(x))
        } else {
            long val = PyInt_AS_LONG(x);
            if (is_unsigned && unlikely(val < 0)) {
                goto raise_neg_overflow;
            }
            return (int) val;
        }
    } else
#endif
    if (likely(PyLong_Check(x))) {
        if (is_unsigned) {
#if CYTHON_USE_PYLONG_INTERNALS
            const digit* digits = ((PyLongObject*)x)->ob_digit;
            switch (Py_SIZE(x)) {
                case  0: return (int) 0;
                case  1: __PYX_VERIFY_RETURN_INT(int, digit, digits[0])
                case 2:
                    if (8 * sizeof(int) > 1 * PyLong_SHIFT) {
                        if (8 * sizeof(unsigned long) > 2 * PyLong_SHIFT) {
                            __PYX_VERIFY_RETURN_INT(int, unsigned long, (((((unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
                        } else if (8 * sizeof(int) >= 2 * PyLong_SHIFT) {
                            return (int) (((((int)digits[1]) << PyLong_SHIFT) | (int)digits[0]));
                        }
                    }
                    break;
                case 3:
                    if (8 * sizeof(int) > 2 * PyLong_SHIFT) {
                        if (8 * sizeof(unsigned long) > 3 * PyLong_SHIFT) {
                            __PYX_VERIFY_RETURN_INT(int, unsigned long, (((((((unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
                        } else if (8 * sizeof(int) >= 3 * PyLong_SHIFT) {
                            return (int) (((((((int)digits[2]) << PyLong_SHIFT) | (int)digits[1]) << PyLong_SHIFT) | (int)digits[0]));
                        }
                    }
                    break;
                case 4:
                    if (8 * sizeof(int) > 3 * PyLong_SHIFT) {
                        if (8 * sizeof(unsigned long) > 4 * PyLong_SHIFT) {
                            __PYX_VERIFY_RETURN_INT(int, unsigned long, (((((((((unsigned long)digits[3]) << PyLong_SHIFT) | (unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
                        } else if (8 * sizeof(int) >= 4 * PyLong_SHIFT) {
                            return (int) (((((((((int)digits[3]) << PyLong_SHIFT) | (int)digits[2]) << PyLong_SHIFT) | (int)digits[1]) << PyLong_SHIFT) | (int)digits[0]));
                        }
                    }
                    break;
            }
#endif
#if CYTHON_COMPILING_IN_CPYTHON
            if (unlikely(Py_SIZE(x) < 0)) {
                goto raise_neg_overflow;
            }
#else
            {
                int result = PyObject_RichCompareBool(x, Py_False, Py_LT);
                if (unlikely(result < 0))
                    return (int) -1;
                if (unlikely(result == 1))
                    goto raise_neg_overflow;
            }
#endif
            if (sizeof(int) <= sizeof(unsigned long)) {
                __PYX_VERIFY_RETURN_INT_EXC(int, unsigned long, PyLong_AsUnsignedLong(x))
            } else if (sizeof(int) <= sizeof(unsigned PY_LONG_LONG)) {
                __PYX_VERIFY_RETURN_INT_EXC(int, unsigned PY_LONG_LONG, PyLong_AsUnsignedLongLong(x))
            }
        } else {
#if CYTHON_USE_PYLONG_INTERNALS
            const digit* digits = ((PyLongObject*)x)->ob_digit;
            switch (Py_SIZE(x)) {
                case  0: return (int) 0;
                case -1: __PYX_VERIFY_RETURN_INT(int, sdigit, (sdigit) (-(sdigit)digits[0]))
                case  1: __PYX_VERIFY_RETURN_INT(int,  digit, +digits[0])
                case -2:
                    if (8 * sizeof(int) - 1 > 1 * PyLong_SHIFT) {
                        if (8 * sizeof(unsigned long) > 2 * PyLong_SHIFT) {
                            __PYX_VERIFY_RETURN_INT(int, long, -(long) (((((unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
                        } else if (8 * sizeof(int) - 1 > 2 * PyLong_SHIFT) {
                            return (int) (((int)-1)*(((((int)digits[1]) << PyLong_SHIFT) | (int)digits[0])));
                        }
                    }
                    break;
                case 2:
                    if (8 * sizeof(int) > 1 * PyLong_SHIFT) {
                        if (8 * sizeof(unsigned long) > 2 * PyLong_SHIFT) {
                            __PYX_VERIFY_RETURN_INT(int, unsigned long, (((((unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
                        } else if (8 * sizeof(int) - 1 > 2 * PyLong_SHIFT) {
                            return (int) ((((((int)digits[1]) << PyLong_SHIFT) | (int)digits[0])));
                        }
                    }
                    break;
                case -3:
                    if (8 * sizeof(int) - 1 > 2 * PyLong_SHIFT) {
                        if (8 * sizeof(unsigned long) > 3 * PyLong_SHIFT) {
                            __PYX_VERIFY_RETURN_INT(int, long, -(long) (((((((unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
                        } else if (8 * sizeof(int) - 1 > 3 * PyLong_SHIFT) {
                            return (int) (((int)-1)*(((((((int)digits[2]) << PyLong_SHIFT) | (int)digits[1]) << PyLong_SHIFT) | (int)digits[0])));
                        }
                    }
                    break;
                case 3:
                    if (8 * sizeof(int) > 2 * PyLong_SHIFT) {
                        if (8 * sizeof(unsigned long) > 3 * PyLong_SHIFT) {
                            __PYX_VERIFY_RETURN_INT(int, unsigned long, (((((((unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
                        } else if (8 * sizeof(int) - 1 > 3 * PyLong_SHIFT) {
                            return (int) ((((((((int)digits[2]) << PyLong_SHIFT) | (int)digits[1]) << PyLong_SHIFT) | (int)digits[0])));
                        }
                    }
                    break;
                case -4:
                    if (8 * sizeof(int) - 1 > 3 * PyLong_SHIFT) {
                        if (8 * sizeof(unsigned long) > 4 * PyLong_SHIFT) {
                            __PYX_VERIFY_RETURN_INT(int, long, -(long) (((((((((unsigned long)digits[3]) << PyLong_SHIFT) | (unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
                        } else if (8 * sizeof(int) - 1 > 4 * PyLong_SHIFT) {
                            return (int) (((int)-1)*(((((((((int)digits[3]) << PyLong_SHIFT) | (int)digits[2]) << PyLong_SHIFT) | (int)digits[1]) << PyLong_SHIFT) | (int)digits[0])));
                        }
                    }
                    break;
                case 4:
                    if (8 * sizeof(int) > 3 * PyLong_SHIFT) {
                        if (8 * sizeof(unsigned long) > 4 * PyLong_SHIFT) {
                            __PYX_VERIFY_RETURN_INT(int, unsigned long, (((((((((unsigned long)digits[3]) << PyLong_SHIFT) | (unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
                        } else if (8 * sizeof(int) - 1 > 4 * PyLong_SHIFT) {
                            return (int) ((((((((((int)digits[3]) << PyLong_SHIFT) | (int)digits[2]) << PyLong_SHIFT) | (int)digits[1]) << PyLong_SHIFT) | (int)digits[0])));
                        }
                    }
                    break;
            }
#endif
            if (sizeof(int) <= sizeof(long)) {
                __PYX_VERIFY_RETURN_INT_EXC(int, long, PyLong_AsLong(x))
            } else if (sizeof(int) <= sizeof(PY_LONG_LONG)) {
                __PYX_VERIFY_RETURN_INT_EXC(int, PY_LONG_LONG, PyLong_AsLongLong(x))
            }
        }
        {
#if CYTHON_COMPILING_IN_PYPY && !defined(_PyLong_AsByteArray)
            PyErr_SetString(PyExc_RuntimeError,
                            "_PyLong_AsByteArray() not available in PyPy, cannot convert large numbers");
#else
            int val;
            PyObject *v = __Pyx_PyNumber_IntOrLong(x);
 #if PY_MAJOR_VERSION < 3
            if (likely(v) && !PyLong_Check(v)) {
                PyObject *tmp = v;
                v = PyNumber_Long(tmp);
                Py_DECREF(tmp);
            }
 #endif
            if (likely(v)) {
                int one = 1; int is_little = (int)*(unsigned char *)&one;
                unsigned char *bytes = (unsigned char *)&val;
                int ret = _PyLong_AsByteArray((PyLongObject *)v,
                                              bytes, sizeof(val),
                                              is_little, !is_unsigned);
                Py_DECREF(v);
                if (likely(!ret))
                    return val;
            }
#endif
            return (int) -1;
        }
    } else {
        int val;
        PyObject *tmp = __Pyx_PyNumber_IntOrLong(x);
        if (!tmp) return (int) -1;
        val = __Pyx_PyInt_As_int(tmp);
        Py_DECREF(tmp);
        return val;
    }
raise_overflow:
    PyErr_SetString(PyExc_OverflowError,
        "value too large to convert to int");
    return (int) -1;
raise_neg_overflow:
    PyErr_SetString(PyExc_OverflowError,
        "can't convert negative value to int");
    return (int) -1;
}

/* CheckBinaryVersion */
                    static int __Pyx_check_binary_version(void) {
    char ctversion[4], rtversion[4];
    PyOS_snprintf(ctversion, 4, "%d.%d", PY_MAJOR_VERSION, PY_MINOR_VERSION);
    PyOS_snprintf(rtversion, 4, "%s", Py_GetVersion());
    if (ctversion[0] != rtversion[0] || ctversion[2] != rtversion[2]) {
        char message[200];
        PyOS_snprintf(message, sizeof(message),
                      "compiletime version %s of module '%.100s' "
                      "does not match runtime version %s",
                      ctversion, __Pyx_MODULE_NAME, rtversion);
        return PyErr_WarnEx(NULL, message, 1);
    }
    return 0;
}

/* InitStrings */
                    static int __Pyx_InitStrings(__Pyx_StringTabEntry *t) {
    while (t->p) {
        #if PY_MAJOR_VERSION < 3
        if (t->is_unicode) {
            *t->p = PyUnicode_DecodeUTF8(t->s, t->n - 1, NULL);
        } else if (t->intern) {
            *t->p = PyString_InternFromString(t->s);
        } else {
            *t->p = PyString_FromStringAndSize(t->s, t->n - 1);
        }
        #else
        if (t->is_unicode | t->is_str) {
            if (t->intern) {
                *t->p = PyUnicode_InternFromString(t->s);
            } else if (t->encoding) {
                *t->p = PyUnicode_Decode(t->s, t->n - 1, t->encoding, NULL);
            } else {
                *t->p = PyUnicode_FromStringAndSize(t->s, t->n - 1);
            }
        } else {
            *t->p = PyBytes_FromStringAndSize(t->s, t->n - 1);
        }
        #endif
        if (!*t->p)
            return -1;
        ++t;
    }
    return 0;
}

static CYTHON_INLINE PyObject* __Pyx_PyUnicode_FromString(const char* c_str) {
    return __Pyx_PyUnicode_FromStringAndSize(c_str, (Py_ssize_t)strlen(c_str));
}
static CYTHON_INLINE char* __Pyx_PyObject_AsString(PyObject* o) {
    Py_ssize_t ignore;
    return __Pyx_PyObject_AsStringAndSize(o, &ignore);
}
static CYTHON_INLINE char* __Pyx_PyObject_AsStringAndSize(PyObject* o, Py_ssize_t *length) {
#if CYTHON_COMPILING_IN_CPYTHON && (__PYX_DEFAULT_STRING_ENCODING_IS_ASCII || __PYX_DEFAULT_STRING_ENCODING_IS_DEFAULT)
    if (
#if PY_MAJOR_VERSION < 3 && __PYX_DEFAULT_STRING_ENCODING_IS_ASCII
            __Pyx_sys_getdefaultencoding_not_ascii &&
#endif
            PyUnicode_Check(o)) {
#if PY_VERSION_HEX < 0x03030000
        char* defenc_c;
        PyObject* defenc = _PyUnicode_AsDefaultEncodedString(o, NULL);
        if (!defenc) return NULL;
        defenc_c = PyBytes_AS_STRING(defenc);
#if __PYX_DEFAULT_STRING_ENCODING_IS_ASCII
        {
            char* end = defenc_c + PyBytes_GET_SIZE(defenc);
            char* c;
            for (c = defenc_c; c < end; c++) {
                if ((unsigned char) (*c) >= 128) {
                    PyUnicode_AsASCIIString(o);
                    return NULL;
                }
            }
        }
#endif
        *length = PyBytes_GET_SIZE(defenc);
        return defenc_c;
#else
        if (__Pyx_PyUnicode_READY(o) == -1) return NULL;
#if __PYX_DEFAULT_STRING_ENCODING_IS_ASCII
        if (PyUnicode_IS_ASCII(o)) {
            *length = PyUnicode_GET_LENGTH(o);
            return PyUnicode_AsUTF8(o);
        } else {
            PyUnicode_AsASCIIString(o);
            return NULL;
        }
#else
        return PyUnicode_AsUTF8AndSize(o, length);
#endif
#endif
    } else
#endif
#if (!CYTHON_COMPILING_IN_PYPY) || (defined(PyByteArray_AS_STRING) && defined(PyByteArray_GET_SIZE))
    if (PyByteArray_Check(o)) {
        *length = PyByteArray_GET_SIZE(o);
        return PyByteArray_AS_STRING(o);
    } else
#endif
    {
        char* result;
        int r = PyBytes_AsStringAndSize(o, &result, length);
        if (unlikely(r < 0)) {
            return NULL;
        } else {
            return result;
        }
    }
}
static CYTHON_INLINE int __Pyx_PyObject_IsTrue(PyObject* x) {
   int is_true = x == Py_True;
   if (is_true | (x == Py_False) | (x == Py_None)) return is_true;
   else return PyObject_IsTrue(x);
}
static CYTHON_INLINE PyObject* __Pyx_PyNumber_IntOrLong(PyObject* x) {
  PyNumberMethods *m;
  const char *name = NULL;
  PyObject *res = NULL;
#if PY_MAJOR_VERSION < 3
  if (PyInt_Check(x) || PyLong_Check(x))
#else
  if (PyLong_Check(x))
#endif
    return __Pyx_NewRef(x);
  m = Py_TYPE(x)->tp_as_number;
#if PY_MAJOR_VERSION < 3
  if (m && m->nb_int) {
    name = "int";
    res = PyNumber_Int(x);
  }
  else if (m && m->nb_long) {
    name = "long";
    res = PyNumber_Long(x);
  }
#else
  if (m && m->nb_int) {
    name = "int";
    res = PyNumber_Long(x);
  }
#endif
  if (res) {
#if PY_MAJOR_VERSION < 3
    if (!PyInt_Check(res) && !PyLong_Check(res)) {
#else
    if (!PyLong_Check(res)) {
#endif
      PyErr_Format(PyExc_TypeError,
                   "__%.4s__ returned non-%.4s (type %.200s)",
                   name, name, Py_TYPE(res)->tp_name);
      Py_DECREF(res);
      return NULL;
    }
  }
  else if (!PyErr_Occurred()) {
    PyErr_SetString(PyExc_TypeError,
                    "an integer is required");
  }
  return res;
}
static CYTHON_INLINE Py_ssize_t __Pyx_PyIndex_AsSsize_t(PyObject* b) {
  Py_ssize_t ival;
  PyObject *x;
#if PY_MAJOR_VERSION < 3
  if (likely(PyInt_CheckExact(b))) {
    if (sizeof(Py_ssize_t) >= sizeof(long))
        return PyInt_AS_LONG(b);
    else
        return PyInt_AsSsize_t(x);
  }
#endif
  if (likely(PyLong_CheckExact(b))) {
    #if CYTHON_USE_PYLONG_INTERNALS
    const digit* digits = ((PyLongObject*)b)->ob_digit;
    const Py_ssize_t size = Py_SIZE(b);
    if (likely(__Pyx_sst_abs(size) <= 1)) {
        ival = likely(size) ? digits[0] : 0;
        if (size == -1) ival = -ival;
        return ival;
    } else {
      switch (size) {
         case 2:
           if (8 * sizeof(Py_ssize_t) > 2 * PyLong_SHIFT) {
             return (Py_ssize_t) (((((size_t)digits[1]) << PyLong_SHIFT) | (size_t)digits[0]));
           }
           break;
         case -2:
           if (8 * sizeof(Py_ssize_t) > 2 * PyLong_SHIFT) {
             return -(Py_ssize_t) (((((size_t)digits[1]) << PyLong_SHIFT) | (size_t)digits[0]));
           }
           break;
         case 3:
           if (8 * sizeof(Py_ssize_t) > 3 * PyLong_SHIFT) {
             return (Py_ssize_t) (((((((size_t)digits[2]) << PyLong_SHIFT) | (size_t)digits[1]) << PyLong_SHIFT) | (size_t)digits[0]));
           }
           break;
         case -3:
           if (8 * sizeof(Py_ssize_t) > 3 * PyLong_SHIFT) {
             return -(Py_ssize_t) (((((((size_t)digits[2]) << PyLong_SHIFT) | (size_t)digits[1]) << PyLong_SHIFT) | (size_t)digits[0]));
           }
           break;
         case 4:
           if (8 * sizeof(Py_ssize_t) > 4 * PyLong_SHIFT) {
             return (Py_ssize_t) (((((((((size_t)digits[3]) << PyLong_SHIFT) | (size_t)digits[2]) << PyLong_SHIFT) | (size_t)digits[1]) << PyLong_SHIFT) | (size_t)digits[0]));
           }
           break;
         case -4:
           if (8 * sizeof(Py_ssize_t) > 4 * PyLong_SHIFT) {
             return -(Py_ssize_t) (((((((((size_t)digits[3]) << PyLong_SHIFT) | (size_t)digits[2]) << PyLong_SHIFT) | (size_t)digits[1]) << PyLong_SHIFT) | (size_t)digits[0]));
           }
           break;
      }
    }
    #endif
    return PyLong_AsSsize_t(b);
  }
  x = PyNumber_Index(b);
  if (!x) return -1;
  ival = PyInt_AsSsize_t(x);
  Py_DECREF(x);
  return ival;
}
static CYTHON_INLINE PyObject * __Pyx_PyInt_FromSize_t(size_t ival) {
    return PyInt_FromSize_t(ival);
}


#endif /* Py_PYTHON_H */
